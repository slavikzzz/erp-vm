#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ОписаниеПеременных



#КонецОбласти

#Область ПрограммныйИнтерфейс



#КонецОбласти

#Область ОбработчикиСобытий

Процедура ПередЗаписью(Отказ)
	
	ТекущееЗначение = Константы.ОбновлениеЧерезКопиюСостояние.Получить();
	Если ТекущееЗначение = Перечисления.СостоянияОбновлениеЧерезКопию.ЗагрузкаОбновлениеЧерезКопию
		И Значение = Перечисления.СостоянияОбновлениеЧерезКопию.ОтключеноОбновлениеЧерезКопию Тогда
		
		УзелОбновления = ОбновлениеЧерезКопию.АктивныйУзелОбмена().УзелОбновленияКорреспондента;
		Если ЗначениеЗаполнено(УзелОбновления) Тогда
			
			Попытка
				
				УзелОбъект = УзелОбновления.ПолучитьОбъект();
				УзелОбъект.ОбновлениеЗавершено = Истина;
				УзелОбъект.Записать();
				
			Исключение
				
				ЗаписьЖурналаРегистрации(ОбновлениеЧерезКопию.ИмяСобытияЖР(),
					УровеньЖурналаРегистрации.Ошибка, , , ПодробноеПредставлениеОшибки(ИнформацияОбОшибке()));
				
				ВызватьИсключение;
					
			КонецПопытки;
			
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныйПрограммныйИнтерфейс



#КонецОбласти

#Область СлужебныеПроцедурыИФункции



#КонецОбласти

#Область Инициализация



#КонецОбласти

#Иначе

ВызватьИсключение НСтр("ru = 'Недопустимый вызов объекта на клиенте.';
						|en = 'Invalid object call on the client.'");

#КонецЕсли