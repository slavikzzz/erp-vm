#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

#Область ДляВызоваИзДругихПодсистем

// ТехнологияСервиса.ВыгрузкаЗагрузкаДанных

// Возвращает реквизиты справочника, которые образуют естественный ключ для элементов справочника.
//
// Возвращаемое значение:
//  Массив из Строка - имена реквизитов, образующих естественный ключ.
//
Функция ПоляЕстественногоКлюча() Экспорт
	
	Результат = Новый Массив;
	
	Результат.Добавить("Код");
	
	Возврат Результат;
	
КонецФункции

// Конец ТехнологияСервиса.ВыгрузкаЗагрузкаДанных

#КонецОбласти

#КонецОбласти

#Область СлужебныеПроцедурыИФункции
	
// Процедура выполняет первоначальное заполнение классификатора.
Процедура НачальноеЗаполнение() Экспорт
	
	Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ
	               |	УченыеЗвания.Наименование
	               |ИЗ
	               |	Справочник.УченыеЗвания КАК УченыеЗвания";
	
	ТаблицаСуществующих = Запрос.Выполнить().Выгрузить();
	
	КлассификаторТаблица = ДанныеКлассификатора();
	
	Для Каждого СтрокаКлассификатора Из КлассификаторТаблица Цикл
		Если ТаблицаСуществующих.Найти(СтрокаКлассификатора.Наименование,"Наименование")  = Неопределено Тогда
			СправочникОбъект = Справочники.УченыеЗвания.СоздатьЭлемент();
			ЗаполнитьЗначенияСвойств(СправочникОбъект, СтрокаКлассификатора);
			СправочникОбъект.ДополнительныеСвойства.Вставить("ЗаписьОбщихДанных");
			СправочникОбъект.Записать();
		КонецЕсли;
	КонецЦикла;
	
КонецПроцедуры

Функция ДанныеКлассификатора()
	
	КлассификаторТаблица = Новый ТаблицаЗначений;
	КлассификаторТаблица.Колонки.Добавить("Код");
	КлассификаторТаблица.Колонки.Добавить("Наименование");
	КлассификаторТаблица.Колонки.Добавить("КодЗванияЕФС1");
	
	НоваяСтрокаКлассификатора = КлассификаторТаблица.Добавить();
	НоваяСтрокаКлассификатора.Код = "01";
	НоваяСтрокаКлассификатора.Наименование = НСтр("ru = 'Академик Российской академии наук';
													|en = 'Member of the Russian Academy of Sciences'");
	НоваяСтрокаКлассификатора.КодЗванияЕФС1 = "АРАН";
	
	НоваяСтрокаКлассификатора = КлассификаторТаблица.Добавить();
	НоваяСтрокаКлассификатора.Код = "02";
	НоваяСтрокаКлассификатора.Наименование = НСтр("ru = 'Академик международной академии наук';
													|en = 'Member of the International Academy of Sciences'");
	НоваяСтрокаКлассификатора.КодЗванияЕФС1 = "АМАН";
	
	НоваяСтрокаКлассификатора = КлассификаторТаблица.Добавить();
	НоваяСтрокаКлассификатора.Код = "03";
	НоваяСтрокаКлассификатора.Наименование = НСтр("ru = 'Академик отраслевой академии наук';
													|en = 'Member of Discipline-Specific Academy of Sciences'");
	НоваяСтрокаКлассификатора.КодЗванияЕФС1 = "АДРА";
	
	НоваяСтрокаКлассификатора = КлассификаторТаблица.Добавить();
	НоваяСтрокаКлассификатора.Код = "04";
	НоваяСтрокаКлассификатора.Наименование = НСтр("ru = 'Член-корреспондент Российской академии наук';
													|en = 'Corresponding Member of the Russian Academy of Sciences'");
	НоваяСтрокаКлассификатора.КодЗванияЕФС1 = "ЧРАН";
	
	НоваяСтрокаКлассификатора = КлассификаторТаблица.Добавить();
	НоваяСтрокаКлассификатора.Код = "05";
	НоваяСтрокаКлассификатора.Наименование = НСтр("ru = 'Член-корреспондент международной академии наук';
													|en = 'Corresponding member of the International Academy of Science'");
	НоваяСтрокаКлассификатора.КодЗванияЕФС1 = "ЧМАН";
	
	НоваяСтрокаКлассификатора = КлассификаторТаблица.Добавить();
	НоваяСтрокаКлассификатора.Код = "06";
	НоваяСтрокаКлассификатора.Наименование = НСтр("ru = 'Член-корреспондент отраслевой академии наук';
													|en = 'Corresponding member of a Discipline-Specific Academy of Sciences'");
	НоваяСтрокаКлассификатора.КодЗванияЕФС1 = "ЧДРА";
	
	НоваяСтрокаКлассификатора = КлассификаторТаблица.Добавить();
	НоваяСтрокаКлассификатора.Код = "07";
	НоваяСтрокаКлассификатора.Наименование = НСтр("ru = 'Профессор';
													|en = 'Professor'");
	НоваяСтрокаКлассификатора.КодЗванияЕФС1 = "ПРФ";
	
	НоваяСтрокаКлассификатора = КлассификаторТаблица.Добавить();
	НоваяСтрокаКлассификатора.Код = "08";
	НоваяСтрокаКлассификатора.Наименование = НСтр("ru = 'Доцент';
													|en = 'Associate Professor'");
	НоваяСтрокаКлассификатора.КодЗванияЕФС1 = "ДЦ";
	
	НоваяСтрокаКлассификатора = КлассификаторТаблица.Добавить();
	НоваяСтрокаКлассификатора.Код = "09";
	НоваяСтрокаКлассификатора.Наименование = НСтр("ru = 'Старший научный сотрудник';
													|en = 'Senior research assistant'");
	НоваяСтрокаКлассификатора.КодЗванияЕФС1 = "СНС";
	
	НоваяСтрокаКлассификатора = КлассификаторТаблица.Добавить();
	НоваяСтрокаКлассификатора.Код = "10";
	НоваяСтрокаКлассификатора.Наименование = НСтр("ru = 'Младший научный сотрудник';
													|en = 'Junior research assistant'");
	НоваяСтрокаКлассификатора.КодЗванияЕФС1 = "МНС";
	
	НоваяСтрокаКлассификатора = КлассификаторТаблица.Добавить();
	НоваяСтрокаКлассификатора.Код = "11";
	НоваяСтрокаКлассификатора.Наименование = НСтр("ru = 'Ассистент';
													|en = 'Assistant'");
	НоваяСтрокаКлассификатора.КодЗванияЕФС1 = "АСС";
	
	НоваяСтрокаКлассификатора = КлассификаторТаблица.Добавить();
	НоваяСтрокаКлассификатора.Код = "12";
	НоваяСтрокаКлассификатора.Наименование = НСтр("ru = 'Член зарубежной академии наук';
													|en = 'Member of the International Academy of Science'");
	НоваяСтрокаКлассификатора.КодЗванияЕФС1 = "ЧЗАН";
	
	Возврат КлассификаторТаблица;
	
КонецФункции

Процедура ЗаполнитьКодыЕФС1() Экспорт
	
	КлассификаторТаблица = ДанныеКлассификатора();
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	УченыеЗвания.Ссылка КАК Ссылка,
	|	УченыеЗвания.Наименование КАК Наименование
	|ИЗ
	|	Справочник.УченыеЗвания КАК УченыеЗвания
	|ГДЕ
	|	УченыеЗвания.КодЗванияЕФС1 = """"";
	Выборка = Запрос.Выполнить().Выбрать();
	Пока Выборка.Следующий() Цикл
		СтрокаРеквизитов = КлассификаторТаблица.Найти(Выборка.Наименование, "Наименование");
		Если СтрокаРеквизитов <> Неопределено Тогда
			СправочникОбъект = Выборка.Ссылка.ПолучитьОбъект();
			СправочникОбъект.КодЗванияЕФС1 = СтрокаРеквизитов.КодЗванияЕФС1;
			СправочникОбъект.ДополнительныеСвойства.Вставить("ЗаписьОбщихДанных");
			СправочникОбъект.Записать();
		КонецЕсли;
	КонецЦикла;
		
КонецПроцедуры

#КонецОбласти

#КонецЕсли