#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Параметры.КлючВарианта = "ЗаполнениеСписковСотрудников";
	
КонецПроцедуры

&НаСервере
Процедура ПриЗагрузкеПользовательскихНастроекНаСервере(Настройки, ИспользуютсяСтандартныеНастройки)
	
	ОтчетОбъект = РеквизитФормыВЗначение("ОтчетПоСотрудникам");
	ОтчетОбъект.ИнициализироватьОтчет();
	
	АдресСхемы = ПоместитьВоВременноеХранилище(ОтчетОбъект.СхемаКомпоновкиДанных, УникальныйИдентификатор);
	ОтчетыСервер.ИнициализироватьКомпоновщикНастроек(
		ОтчетОбъект.КомпоновщикНастроек,
		АдресСхемы,
		ОтчетОбъект);
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиКомандФормы

&НаКлиенте
Процедура Ок(Команда)
	
	Если ВариантМодифицирован Тогда
		
		ВариантМодифицирован = Ложь;
		Закрыть(НастройкиОтчета());
		Возврат;
		
	КонецЕсли; 
	
	Закрыть();
	
КонецПроцедуры

#КонецОбласти


#Область СлужебныеПроцедурыИФункции

&НаСервере
Функция НастройкиОтчета()
	
	НастройкиСРезультатом = Новый Структура;
	НастройкиСРезультатом.Вставить("НастройкиЗаполнения", ОтчетПоСотрудникам.КомпоновщикНастроек.ПолучитьНастройки());
	
	Возврат НастройкиСРезультатом;
	
КонецФункции

#КонецОбласти
