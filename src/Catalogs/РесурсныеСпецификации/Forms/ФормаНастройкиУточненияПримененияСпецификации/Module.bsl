
#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	УстановитьУсловноеОформление();
	
	Если Параметры.Свойство("АвтоТест") Тогда // Возврат при получении формы для анализа.
		Возврат;
	КонецЕсли;
	
	Параметры.Свойство("ВидНоменклатуры", ВидНоменклатуры);
	Параметры.Свойство("Описание", Описание);
	
	ЗаполнитьСписокОтборовПоСвойствам();
	
КонецПроцедуры

&НаКлиенте
Процедура ПередЗакрытием(Отказ, ЗавершениеРаботы, ТекстПредупреждения, СтандартнаяОбработка)
	
	Оповещение = Новый ОписаниеОповещения("ЗаписатьИЗакрытьНаКлиенте", ЭтотОбъект);
	ОбщегоНазначенияКлиент.ПоказатьПодтверждениеЗакрытияФормы(Оповещение, Отказ, ЗавершениеРаботы);
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиСобытийЭлементовТаблицыФормыОтборПоСвойствам

&НаКлиенте
Процедура ОтборПоСвойствамПередНачаломДобавления(Элемент, Отказ, Копирование, Родитель, ЭтоГруппа, Параметр)
	
	Если Копирование Тогда
		Отказ = Истина;
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ОтборПоСвойствамПередНачаломИзменения(Элемент, Отказ)
	
	ТекущиеДанные = Элементы.ОтборПоСвойствам.ТекущиеДанные;
	
	//++ НЕ УТКА
	
	УправлениеДаннымиОбИзделияхКлиент.ОтборПоСвойствамПередНачаломИзменения(
		ЭтаФорма,
		ТекущиеДанные,
		ТаблицаДоступныхСвойств,
		СтруктураУсловий);
		
	//-- НЕ УТКА
	
КонецПроцедуры

&НаКлиенте
Процедура ОтборПоСвойствамСвойствоПриИзменении(Элемент)
	
	ТекущиеДанные = Элементы.ОтборПоСвойствам.ТекущиеДанные;
	
	//++ НЕ УТКА
	
	УправлениеДаннымиОбИзделияхКлиент.ОтборПоСвойствамСвойствоПриИзменении(
		ЭтаФорма,
		ТекущиеДанные,
		ТаблицаДоступныхСвойств,
		СтруктураУсловий);
		
	//-- НЕ УТКА
	
КонецПроцедуры

&НаКлиенте
Процедура ОтборПоСвойствамУсловиеПриИзменении(Элемент)
	
	ТекущиеДанные = Элементы.ОтборПоСвойствам.ТекущиеДанные;
	
	//++ НЕ УТКА
	
	УправлениеДаннымиОбИзделияхКлиент.ОтборПоСвойствамУсловиеПриИзменении(
		ЭтаФорма,
		ТекущиеДанные,
		ТаблицаДоступныхСвойств,
		СтруктураУсловий);
		
	//-- НЕ УТКА
	
КонецПроцедуры

&НаКлиенте
Процедура ОтборПоСвойствамУсловиеНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	
	ТекущиеДанные = Элементы.ОтборПоСвойствам.ТекущиеДанные;

	//++ НЕ УТКА
	
	УправлениеДаннымиОбИзделияхКлиент.ОтборПоСвойствамУсловиеНачалоВыбора(
		ЭтаФорма,
		ТекущиеДанные,
		ТаблицаДоступныхСвойств,
		СтруктураУсловий);
		
	//-- НЕ УТКА
	
КонецПроцедуры

&НаКлиенте
Процедура ОтборПоСвойствамУсловиеОчистка(Элемент, СтандартнаяОбработка)
	СтандартнаяОбработка = Ложь;
КонецПроцедуры

&НаКлиенте
Процедура ОтборПоСвойствамЗначениеИнтервалПриИзменении(Элемент)
	
	ТекущиеДанные = Элементы.ОтборПоСвойствам.ТекущиеДанные;
	
	//++ НЕ УТКА
	
	УправлениеДаннымиОбИзделияхКлиент.ОтборПоСвойствамЗначениеИнтервалПриИзменении(
		ТекущиеДанные,
		Элемент.Имя);
		
	//-- НЕ УТКА
		
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиКомандФормы

&НаКлиенте
Процедура СохранитьНастройку(Команда)
	
	ЗаписатьИЗакрытьНаКлиенте(Неопределено, Неопределено);
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаСервере
Процедура УстановитьУсловноеОформление()
	
	УсловноеОформление.Элементы.Очистить();
	
	//++ НЕ УТКА
	
	УправлениеДаннымиОбИзделиях.УстановитьУсловноеОформлениеТаблицыОтбораПоСвойствам(УсловноеОформление);
	
	//-- НЕ УТКА
	
КонецПроцедуры

&НаСервере
Процедура ЗаполнитьСписокОтборовПоСвойствам()
	
	//++ НЕ УТКА
	
	СтруктураУсловий = УправлениеДаннымиОбИзделияхКлиентСервер.СтруктураУсловийОтбораПоСвойствамНоменклатуры();
	
	// Свойства основного изделия
	СписокВсехДоступныхСвойств = УправлениеДаннымиОбИзделиях.ПолучитьСвойстваДляОтбораПоСвойствам(ВидНоменклатуры, Параметры.ВидНастройки);
		
	Для каждого ДанныеСвойства Из СписокВсехДоступныхСвойств Цикл
		ЗаполнитьЗначенияСвойств(ТаблицаДоступныхСвойств.Добавить(), ДанныеСвойства);
		Элементы.Свойство.СписокВыбора.Добавить(ДанныеСвойства.Свойство, ДанныеСвойства.Представление);
	КонецЦикла;
	
	УправлениеДаннымиОбИзделиях.ЗаполнитьСписокОтборовПоСвойствам(ОтборПоСвойствам, Параметры.ОтборПоСвойствам);
	
	//-- НЕ УТКА
	
	Возврат; // пустой обработчик
	
КонецПроцедуры

&НаКлиенте
Процедура ЗаписатьИЗакрытьНаКлиенте(Результат, ДополнительныеПараметры) Экспорт 
	
	ОчиститьСообщения();
	
	ЕстьОшибки = Ложь;
	ОтборПоСвойствамРезультат = Неопределено;
	
	//++ НЕ УТКА
	
	ОтборПоСвойствамРезультат = УправлениеДаннымиОбИзделияхКлиент.ОтборПоСвойствамПроизвестиКонтрольСформироватьРезультатНастройки(
		ОтборПоСвойствам,
		ТаблицаДоступныхСвойств,
		ЕстьОшибки);
		
	//-- НЕ УТКА
	
	Если ЕстьОшибки Тогда
		Возврат;
	КонецЕсли;
	
	Модифицированность = Ложь;
	
	Закрыть(Новый Структура("ОтборПоСвойствам,Описание",ОтборПоСвойствамРезультат,Описание));
	
КонецПроцедуры

#КонецОбласти