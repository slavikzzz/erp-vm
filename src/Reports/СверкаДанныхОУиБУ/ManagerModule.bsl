#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

// СтандартныеПодсистемы.ВариантыОтчетов

// Настройки вариантов этого отчета.
// Параметры:
//   Настройки - Коллекция - Используется для описания настроек отчетов и вариантов
//   	подробнее см. ВариантыОтчетовПереопределяемый.НастроитьВариантыОтчетов.
// 	 ОписаниеОтчета - СтрокаДереваЗначений - Настройки отчета и настройки "по умолчанию".
//	 	подробнее см. ВариантыОтчетов.ОписаниеОтчета().
//
Процедура НастроитьВариантыОтчета(Настройки, ОписаниеОтчета) Экспорт
	
	ВариантыОтчетовУТПереопределяемый.ОтключитьОтчет(ОписаниеОтчета);
	
КонецПроцедуры

// Конец СтандартныеПодсистемы.ВариантыОтчетов

#КонецОбласти

#Область СлужебныйПрограммныйИнтерфейс

Процедура ДополнитьПараметрамиПоУмолчанию(ПараметрыПоУмолчанию) Экспорт
	
	Если ПараметрыПоУмолчанию.Свойство("КонецПериода") Тогда
		ПараметрыПоУмолчанию.Вставить("КонецПериодаОстатков", Новый Граница(ПараметрыПоУмолчанию.КонецПериода, ВидГраницы.Включая));
	КонецЕсли;
	
	ПараметрыПоУмолчанию.Вставить("ПустойСчет", ПланыСчетов.Хозрасчетный.ПустаяСсылка());
	
	Если ПараметрыПоУмолчанию.РазделУчета = "Все" Или ПараметрыПоУмолчанию.РазделУчета = "Себестоимость" Тогда
		ПараметрыПоУмолчанию.Вставить("ФормироватьВидыЗапасовПоГруппамФинансовогоУчета",
			ПолучитьФункциональнуюОпцию("ФормироватьВидыЗапасовПоГруппамФинансовогоУчета"));
		ПараметрыПоУмолчанию.Вставить("ВидыСубконтоНоменклатураСклад", МассивВидовСубконто());
		ПараметрыПоУмолчанию.Вставить("СчетаБезСубконтоНоменклатураСклад", МассивСчетовСНестандартнымиСубконто());
		ПараметрыПоУмолчанию.Вставить("ЗабалансовыеРазделыУчета", Перечисления.РазделыУчетаСебестоимостиТоваров.ЗабалансовыеРазделыУчета());
	КонецЕсли;
	
	Если ПараметрыПоУмолчанию.РазделУчета = "Все" Или ПараметрыПоУмолчанию.РазделУчета = "Поставщики"
		 Или ПараметрыПоУмолчанию.РазделУчета = "Клиенты" Или ПараметрыПоУмолчанию.РазделУчета = "КредитыДепозиты"
		 Или ПараметрыПоУмолчанию.РазделУчета = "Лизинг" Или ПараметрыПоУмолчанию.РазделУчета = "ПрочиеСКонтрагентами" Тогда
		ПараметрыПоУмолчанию.Вставить("НоваяАрхитектураВзаиморасчетов",
			ПолучитьФункциональнуюОпцию("НоваяАрхитектураВзаиморасчетов"));
		ПараметрыПоУмолчанию.Вставить("СчетаУчетаРасчетов5", СчетаУчетаРасчетовКредитовДепозитов());
		ПараметрыПоУмолчанию.Вставить("ВидыСубконтоКонтрагентыДоговоры", ВидыСубконтоКонтрагентыДоговоры());
		ПараметрыПоУмолчанию.Вставить("СчетаУчетаРасчетов7", СчетаУчетаПрочихРасчетовСКонтрагентами(ПараметрыПоУмолчанию.СчетаУчетаРасчетов5));
		ПараметрыПоУмолчанию.Вставить("ХозОперацииВозврата", ХозОперацииВозврата());
		ПараметрыПоУмолчанию.Вставить("ИсключаемыеХозОперацииПоАвансам", ИсключаемыеХозОперацииПоАвансам());
	КонецЕсли;
	
	Если ПараметрыПоУмолчанию.РазделУчета = "Все" Или ПараметрыПоУмолчанию.РазделУчета = "Расходы" Тогда
		ПараметрыПоУмолчанию.Вставить("СчетаУчетаРасходов", СчетаУчетаРасходов());
		ПараметрыПоУмолчанию.Вставить("ЗабалансовыеРазделыУчета", Перечисления.РазделыУчетаСебестоимостиТоваров.ЗабалансовыеРазделыУчета());
		ПараметрыПоУмолчанию.Вставить("НастройкаСчетовУчетаПроизводстваПоГруппамПродукции",
			ПолучитьФункциональнуюОпцию("НастройкаСчетовУчетаПроизводстваПоГруппамПродукции"));
	КонецЕсли;
	
КонецПроцедуры

Функция ТекстЗапроса(Раздел, КлючВарианта) Экспорт
	
	ВерсияКонфигурации = Лев(Метаданные.Версия, 3);
	
	ТекстЗапроса = "";
	
	Если Раздел = "Себестоимость" Тогда
		ТекстЗапроса = ?(КлючВарианта = "СверкаПоРегистраторам", ТекстЗапросаСебестоимостьПоРегистраторам(), ТекстЗапросаСебестоимость());
		СтрокаПодразделения = "Подзапрос.Подразделение,";
	КонецЕсли;
	
	Если Раздел = "ДенежныеСредства" Тогда
		ТекстЗапроса = ?(КлючВарианта = "СверкаПоРегистраторам", ТекстЗапросаДенежныеСредстваПоРегистраторам(), ТекстЗапросаДенежныеСредства());
		СтрокаПодразделения = "ВТ_ДенежныеСредстваИсходныеДанные.Подразделение,";
	КонецЕсли;
	
	Если Раздел = "Все" Или Раздел = "Поставщики"
		 Или Раздел = "Клиенты" Или Раздел = "КредитыДепозиты"
		 Или Раздел = "Лизинг" Или Раздел = "ПрочиеСКонтрагентами" Тогда
		ТекстЗапроса = ?(КлючВарианта = "СверкаПоРегистраторам", ТекстЗапросаРасчетыСКонтрагентамиПоРегистраторам(), ТекстЗапросаРасчетыСКонтрагентами());
		Если ВерсияКонфигурации = "2.0" И Не ПолучитьФункциональнуюОпцию("КомплекснаяАвтоматизация") Тогда
			ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "РасчетыПоКредитамДепозитам.СуммаРеглНачальныйОстаток", "0");
			ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "РасчетыПоКредитамДепозитам.СуммаРеглПриход", "0");
			ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "РасчетыПоКредитамДепозитам.СуммаРеглРасход", "0");
			ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "РасчетыПоКредитамДепозитам.СуммаРеглКонечныйОстаток", "0");
		КонецЕсли;
		СтрокаПодразделения = "Подзапрос.Подразделение,";
	КонецЕсли;
	
	Если Раздел = "Расходы" Тогда
		ТекстЗапроса = ?(КлючВарианта = "СверкаПоРегистраторам", ТекстЗапросаПроизводственныеЗатратыПоРегистраторам(), ТекстЗапросаПроизводственныеЗатраты());
		Если ВерсияКонфигурации = "2.0" И Не ПолучитьФункциональнуюОпцию("КомплекснаяАвтоматизация") Тогда
			ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "РегПрочиеРасходы.ДокументДвижения", "Неопределено");
		КонецЕсли;
		СтрокаПодразделения = "Подзапрос.Подразделение,";
	КонецЕсли;
	
	Если Найти(КлючВарианта, "БезПодразделений") <> 0 Или КлючВарианта = "СверкаПоРегистраторам" Тогда
		ТекстЗапроса = СтрЗаменить(ТекстЗапроса, СтрокаПодразделения, "");
	КонецЕсли;
	
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстЗапросаВТДолгосрочныеКакКраткосрочные() Экспорт
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ПорядокУчетаДолгосрочные.ВидСчета КАК ВидСчетаРеглУчета,
	|	ПорядокУчетаДолгосрочные.СчетУчета КАК СчетУчетаДолгосрочный,
	|	МАКСИМУМ(ЕСТЬNULL(ПорядокУчетаКраткосрочныеТочноеСоответствие.СчетУчета, ЕСТЬNULL(ПорядокУчетаКраткосрочныеПоОрганизации.СчетУчета,
	|		ЕСТЬNULL(ПорядокУчетаКраткосрочныеПоАналитике.СчетУчета, ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка))))) КАК СчетУчетаКраткосрочный
	|ПОМЕСТИТЬ ВТДолгосрочныеКакКраткосрочные
	|ИЗ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК ПорядокУчетаДолгосрочные
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК ПорядокУчетаКраткосрочныеТочноеСоответствие
	|	ПО ПорядокУчетаДолгосрочные.Организация = ПорядокУчетаКраткосрочныеТочноеСоответствие.Организация
	|		И ПорядокУчетаДолгосрочные.АналитикаУчета = ПорядокУчетаКраткосрочныеТочноеСоответствие.АналитикаУчета
	|		И ПорядокУчетаДолгосрочные.МестоУчета = ПорядокУчетаКраткосрочныеТочноеСоответствие.МестоУчета
	|		И ПорядокУчетаДолгосрочные.ВидСчета = ПорядокУчетаКраткосрочныеТочноеСоответствие.ВидСчета
	|		И НЕ ПорядокУчетаКраткосрочныеТочноеСоответствие.Долгосрочный
	|		И ПорядокУчетаДолгосрочные.МестоУчета <> НЕОПРЕДЕЛЕНО
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК ПорядокУчетаКраткосрочныеПоОрганизации
	|	ПО ПорядокУчетаДолгосрочные.Организация = ПорядокУчетаКраткосрочныеПоОрганизации.Организация
	|		И ПорядокУчетаДолгосрочные.АналитикаУчета = ПорядокУчетаКраткосрочныеПоОрганизации.АналитикаУчета
	|		И ПорядокУчетаКраткосрочныеПоОрганизации.МестоУчета = НЕОПРЕДЕЛЕНО
	|		И ПорядокУчетаДолгосрочные.ВидСчета = ПорядокУчетаКраткосрочныеПоОрганизации.ВидСчета
	|		И НЕ ПорядокУчетаКраткосрочныеПоОрганизации.Долгосрочный
	|		И ПорядокУчетаДолгосрочные.Организация <> ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК ПорядокУчетаКраткосрочныеПоАналитике
	|	ПО ПорядокУчетаКраткосрочныеПоАналитике.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|		И ПорядокУчетаДолгосрочные.АналитикаУчета = ПорядокУчетаКраткосрочныеПоАналитике.АналитикаУчета
	|		И ПорядокУчетаКраткосрочныеПоАналитике.МестоУчета = НЕОПРЕДЕЛЕНО
	|		И ПорядокУчетаДолгосрочные.ВидСчета = ПорядокУчетаКраткосрочныеПоАналитике.ВидСчета
	|		И НЕ ПорядокУчетаКраткосрочныеПоАналитике.Долгосрочный
	|ГДЕ
	|	ПорядокУчетаДолгосрочные.ВидСчета В (&ВидыСчетов)
	|	И ПорядокУчетаДолгосрочные.Долгосрочный
	|	И ПорядокУчетаДолгосрочные.СчетУчета.Долгосрочный
	|
	|СГРУППИРОВАТЬ ПО
	|	ПорядокУчетаДолгосрочные.ВидСчета,
	|	ПорядокУчетаДолгосрочные.СчетУчета";
	
	ВидыСчетов = ВидыДолгосрочныхСчетовСравниващиесяПоКраткосрочным();
	ТекстВидовСчетов = НастройкаСчетовУчетаСервер.ТекстПеречисленияВидовСчетов(ВидыСчетов);
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ВидыСчетов", ТекстВидовСчетов);
	
	Возврат ТекстЗапроса;
	
КонецФункции

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

#Область ИнициализацияПараметров

Функция МассивВидовСубконто()
	МассивВидовСубконто = Новый Массив;
	МассивВидовСубконто.Добавить(ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.Номенклатура);
	МассивВидовСубконто.Добавить(ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.Склады);
	Возврат МассивВидовСубконто;
КонецФункции

Функция МассивСчетовСНестандартнымиСубконто()
	МассивСчетовСНестандартнымиСубконто = Новый Массив;
	МассивСчетовСНестандартнымиСубконто.Добавить(ПланыСчетов.Хозрасчетный.МатериалыПереданныеВПереработку);
	МассивСчетовСНестандартнымиСубконто.Добавить(ПланыСчетов.Хозрасчетный.ЗаготовлениеИПриобретениеМЦ);
	МассивСчетовСНестандартнымиСубконто.Добавить(ПланыСчетов.Хозрасчетный.ТоварыОтгруженные);
	МассивСчетовСНестандартнымиСубконто.Добавить(ПланыСчетов.Хозрасчетный.ТМЦпринятыеНаОтветственноеХранение);
	МассивСчетовСНестандартнымиСубконто.Добавить(ПланыСчетов.Хозрасчетный.МатериалыПринятыеВПереработку_);
	МассивСчетовСНестандартнымиСубконто.Добавить(ПланыСчетов.Хозрасчетный.ТоварыПринятыеНаКомиссию);
	Возврат МассивСчетовСНестандартнымиСубконто;
КонецФункции

Функция СчетаУчетаРасчетовКредитовДепозитов()
	СчетаУчетаРасчетов5 = Новый Массив;
	СчетаУчетаРасчетов5.Добавить(ПланыСчетов.Хозрасчетный.ПредоставленныеЗаймы);
	СчетаУчетаРасчетов5.Добавить(ПланыСчетов.Хозрасчетный.ДепозитныеСчета);
	СчетаУчетаРасчетов5.Добавить(ПланыСчетов.Хозрасчетный.ДепозитныеСчетаВал);
	СчетаУчетаРасчетов5.Добавить(ПланыСчетов.Хозрасчетный.РасчетыПоКраткосрочнымКредитамИЗаймам);
	СчетаУчетаРасчетов5.Добавить(ПланыСчетов.Хозрасчетный.РасчетыПоДолгосрочнымКредитамИЗаймам);
	СчетаУчетаРасчетов5.Добавить(ПланыСчетов.Хозрасчетный.РасчетыПоПричитающимсяДивидендам);
	Возврат СчетаУчетаРасчетов5;
КонецФункции

Функция ВидыСубконтоКонтрагентыДоговоры()
	МассивВидовСубконто = Новый Массив;
	МассивВидовСубконто.Добавить(ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.Контрагенты);
	МассивВидовСубконто.Добавить(ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры);
	Возврат МассивВидовСубконто;
КонецФункции

Функция СчетаУчетаПрочихРасчетовСКонтрагентами(СчетаУчетаРасчетов5)
	
	СчетаУчетаРасчетов7 = Новый Массив;
	
	СчетаИсключения = Новый Массив;
	СчетаИсключения.Добавить(ПланыСчетов.Хозрасчетный.РасчетыСПоставщикамиИПодрядчиками);
	СчетаИсключения.Добавить(ПланыСчетов.Хозрасчетный.РасчетыСПокупателямиИЗаказчиками);
	СчетаИсключения.Добавить(ПланыСчетов.Хозрасчетный.РасчетыПоАренде);
	СчетаИсключения.Добавить(ПланыСчетов.Хозрасчетный.ТоварыКОформлениюОтчетовКомитенту);
	СчетаИсключения.Добавить(ПланыСчетов.Хозрасчетный.РасчетыПоБронированию);
	СчетаИсключения.Добавить(ПланыСчетов.Хозрасчетный.РасчетыПоБронированиюВал);
	ОбщегоНазначенияКлиентСервер.ДополнитьМассив(СчетаИсключения, СчетаУчетаРасчетов5);
	СчетаИсключения = БухгалтерскийУчет.СформироватьМассивСубсчетов(СчетаИсключения);
	
	СтруктураСчетовУчета = Обработки.НастройкаОтраженияДокументовВРеглУчете.ДоступныеСчетаУчетаРасчетов();
	Для каждого ЭлементСтруктуры Из СтруктураСчетовУчета Цикл
		Для каждого Счет Из ЭлементСтруктуры.Значение Цикл
			Если СчетаИсключения.Найти(Счет) = Неопределено Тогда
				СчетаУчетаРасчетов7.Добавить(Счет);
			КонецЕсли;
		КонецЦикла;
	КонецЦикла;
	
	Возврат СчетаУчетаРасчетов7;
	
КонецФункции

Функция ХозОперацииВозврата()
	
	ХозОперацииВозврата = Новый Массив;
	Для каждого ХозОперация Из Перечисления.ХозяйственныеОперации Цикл
		Если ВРег(Лев(ХозОперация, 7)) = "ВОЗВРАТ" Тогда
			ХозОперацииВозврата.Добавить(ХозОперация);
		КонецЕсли;
	КонецЦикла;
	
	Возврат ХозОперацииВозврата;
	
КонецФункции

Функция ИсключаемыеХозОперацииПоАвансам()
	ИсключаемыеХозОперацииПоАвансам = Новый Массив;
	ИсключаемыеХозОперацииПоАвансам.Добавить(Перечисления.ХозяйственныеОперации.ПереносАванса);
	Возврат ИсключаемыеХозОперацииПоАвансам;
КонецФункции

Функция СчетаУчетаРасходов()
	ДоступныеСчетаУчетаРасходов = Обработки.НастройкаОтраженияДокументовВРеглУчете.ДоступныеСчетаУчетаРасходов();
	СчетаУчетаРасходов = ОбщегоНазначенияКлиентСервер.РазностьМассивов(ДоступныеСчетаУчетаРасходов.СчетаРасходов, ДоступныеСчетаУчетаРасходов.СчетаСписания);
	Возврат СчетаУчетаРасходов;
КонецФункции

Функция ВидыДолгосрочныхСчетовСравниващиесяПоКраткосрочным()
	
	ВидыСчетовДолгосрочнойЗадолженности = НастройкаСчетовУчетаКлиентСервер.ВидыСчетовСНастройкамиДолгосрочнойЗадолженности();
	
	ВидыСчетовСравненияСПолучениемДолгосрочности = Новый Массив;
	ВидыСчетовСравненияСПолучениемДолгосрочности.Добавить("РасчетыСКлиентами");
	ВидыСчетовСравненияСПолучениемДолгосрочности.Добавить("АвансыПолученные");
	ВидыСчетовСравненияСПолучениемДолгосрочности.Добавить("РасчетыСПоставщиками");
	ВидыСчетовСравненияСПолучениемДолгосрочности.Добавить("АвансыВыданные");
	
	Возврат ОбщегоНазначенияКлиентСервер.РазностьМассивов(ВидыСчетовДолгосрочнойЗадолженности, ВидыСчетовСравненияСПолучениемДолгосрочности);
	
КонецФункции

#КонецОбласти

#Область ТекстыЗапросов

Функция ТекстЗапросаСебестоимость()
	
	МассивТекстовЗапроса = Новый Массив;
	
	#Область Себестоимость
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	Подзапрос.Организация,
	|	Подзапрос.АналитикаУчетаНоменклатуры,
	|	Подзапрос.ВидЗапасов,
	|	Подзапрос.РазделУчета,
	|	Подзапрос.Резерв,
	|	СУММА(Подзапрос.НачальныйОстаток) КАК НачальныйОстаток,
	|	СУММА(Подзапрос.Приход) КАК Приход,
	|	СУММА(Подзапрос.Расход) КАК Расход,
	|	СУММА(Подзапрос.КонечныйОстаток) КАК КонечныйОстаток
	|ПОМЕСТИТЬ ВТ_СебестоимостьТоваровОстаткиИОбороты
	|ИЗ
	|	(ВЫБРАТЬ
	|		СебестоимостьТоваров.Организация КАК Организация,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|		СебестоимостьТоваров.ВидЗапасов КАК ВидЗапасов,
	|		СебестоимостьТоваров.РазделУчета КАК РазделУчета,
	|		ЛОЖЬ КАК Резерв,
	|		ВЫБОР
	|			КОГДА СебестоимостьТоваров.ХозяйственнаяОперация В (
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратИзПроизводства),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзПроизводства),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзКладовой),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратТоваровОтКлиента),
	//++ Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратОтПереработчика),
	//-- Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратОтПереработчика2_5))
	|				И СебестоимостьТоваров.ТипЗаписи <> ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ВключениеИсключениеНДСВСтоимости)
	|			ТОГДА 0
	|			КОГДА СебестоимостьТоваров.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|			ТОГДА СебестоимостьТоваров.СтоимостьЗабалансоваяРегл
	|			ИНАЧЕ СебестоимостьТоваров.СтоимостьРегл
	|				+ СебестоимостьТоваров.ДопРасходыРегл + СебестоимостьТоваров.ТрудозатратыРегл
	|				+ СебестоимостьТоваров.ПостатейныеПостоянныеРегл + СебестоимостьТоваров.ПостатейныеПеременныеРегл
	|		КОНЕЦ КАК Приход,
	|		ВЫБОР
	|			КОГДА НЕ (СебестоимостьТоваров.ХозяйственнаяОперация В (
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратИзПроизводства),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзПроизводства),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзКладовой),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратТоваровОтКлиента),
	//++ Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратОтПереработчика),
	//-- Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратОтПереработчика2_5))
	|				И СебестоимостьТоваров.ТипЗаписи <> ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ВключениеИсключениеНДСВСтоимости))
	|			ТОГДА 0
	|			КОГДА СебестоимостьТоваров.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|			ТОГДА -СебестоимостьТоваров.СтоимостьЗабалансоваяРегл
	|			ИНАЧЕ -(СебестоимостьТоваров.СтоимостьРегл
	|					+ СебестоимостьТоваров.ДопРасходыРегл + СебестоимостьТоваров.ТрудозатратыРегл
	|					+ СебестоимостьТоваров.ПостатейныеПостоянныеРегл + СебестоимостьТоваров.ПостатейныеПеременныеРегл)
	|		КОНЕЦ КАК Расход,
	|		0 КАК НачальныйОстаток,
	|		0 КАК КонечныйОстаток
	|	ИЗ
	|		РегистрНакопления.СебестоимостьТоваров КАК СебестоимостьТоваров
	|	ГДЕ
	|		СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|		И СебестоимостьТоваров.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И СебестоимостьТоваров.Активность
	|		И СебестоимостьТоваров.Организация В(&МассивОрганизаций)
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		СебестоимостьТоваров.Организация КАК Организация,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|		СебестоимостьТоваров.ВидЗапасов КАК ВидЗапасов,
	|		СебестоимостьТоваров.РазделУчета КАК РазделУчета,
	|		ИСТИНА КАК Резерв,
	|		ВЫБОР
	|			КОГДА СебестоимостьТоваров.ХозяйственнаяОперация В (
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратИзПроизводства),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзПроизводства),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзКладовой),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратТоваровОтКлиента),
	//++ Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратОтПереработчика),
	//-- Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратОтПереработчика2_5))
	|			ТОГДА 0
	|			ИНАЧЕ СебестоимостьТоваров.РезервПодОбесценениеРегл
	|		КОНЕЦ КАК Приход,
	|		ВЫБОР
	|			КОГДА НЕ СебестоимостьТоваров.ХозяйственнаяОперация В (
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратИзПроизводства),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзПроизводства),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзКладовой),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратТоваровОтКлиента),
	//++ Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратОтПереработчика),
	//-- Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратОтПереработчика2_5))
	|			ТОГДА 0
	|			ИНАЧЕ -(СебестоимостьТоваров.РезервПодОбесценениеРегл)
	|		КОНЕЦ КАК Расход,
	|		0 КАК НачальныйОстаток,
	|		0 КАК КонечныйОстаток
	|	ИЗ
	|		РегистрНакопления.СебестоимостьТоваров КАК СебестоимостьТоваров
	|	ГДЕ
	|		СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|		И СебестоимостьТоваров.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И СебестоимостьТоваров.Активность
	|		И СебестоимостьТоваров.Организация В(&МассивОрганизаций)
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		СебестоимостьТоваров.Организация,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры,
	|		СебестоимостьТоваров.ВидЗапасов,
	|		СебестоимостьТоваров.РазделУчета,
	|		ЛОЖЬ КАК Резерв,       
	|		ВЫБОР
	|			КОГДА НЕ СебестоимостьТоваров.ХозяйственнаяОперация В (
	//++ Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДавальцу),
	//-- Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДавальцу2_5),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратТоваровКомитенту))
	|			ТОГДА 0
	|			КОГДА СебестоимостьТоваров.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|			ТОГДА -СебестоимостьТоваров.СтоимостьЗабалансоваяРегл
	|			ИНАЧЕ -(СебестоимостьТоваров.СтоимостьРегл
	|					+ СебестоимостьТоваров.ДопРасходыРегл + СебестоимостьТоваров.ТрудозатратыРегл
	|					+ СебестоимостьТоваров.ПостатейныеПостоянныеРегл + СебестоимостьТоваров.ПостатейныеПеременныеРегл)
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА СебестоимостьТоваров.ХозяйственнаяОперация В (
	//++ Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДавальцу),
	//-- Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДавальцу2_5),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратТоваровКомитенту))
	|			ТОГДА 0
	|			КОГДА СебестоимостьТоваров.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|			ТОГДА СебестоимостьТоваров.СтоимостьЗабалансоваяРегл
	|			ИНАЧЕ СебестоимостьТоваров.СтоимостьРегл
	|				+ СебестоимостьТоваров.ДопРасходыРегл + СебестоимостьТоваров.ТрудозатратыРегл
	|				+ СебестоимостьТоваров.ПостатейныеПостоянныеРегл + СебестоимостьТоваров.ПостатейныеПеременныеРегл
	|		КОНЕЦ,
	|		0,
	|		0
	|	ИЗ
	|		РегистрНакопления.СебестоимостьТоваров КАК СебестоимостьТоваров
	|	ГДЕ
	|		СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И СебестоимостьТоваров.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И СебестоимостьТоваров.Активность
	|		И СебестоимостьТоваров.Организация В(&МассивОрганизаций)
	|
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		СебестоимостьТоваров.Организация,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры,
	|		СебестоимостьТоваров.ВидЗапасов,
	|		СебестоимостьТоваров.РазделУчета,
	|		ИСТИНА КАК Резерв,
	|		ВЫБОР
	|			КОГДА НЕ СебестоимостьТоваров.ХозяйственнаяОперация В (
	//++ Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДавальцу),
	//-- Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДавальцу2_5),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратТоваровКомитенту))
	|			ТОГДА 0
	|			КОГДА СебестоимостьТоваров.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|			ТОГДА 0
	|			ИНАЧЕ -СебестоимостьТоваров.РезервПодОбесценениеРегл
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА СебестоимостьТоваров.ХозяйственнаяОперация В (
	//++ Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДавальцу),
	//-- Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДавальцу2_5),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратТоваровКомитенту))
	|			ТОГДА 0
	|			КОГДА СебестоимостьТоваров.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|			ТОГДА 0
	|			ИНАЧЕ СебестоимостьТоваров.РезервПодОбесценениеРегл
	|		КОНЕЦ,
	|		0,
	|		0
	|	ИЗ
	|		РегистрНакопления.СебестоимостьТоваров КАК СебестоимостьТоваров
	|	ГДЕ
	|		СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И СебестоимостьТоваров.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И СебестоимостьТоваров.Активность
	|		И СебестоимостьТоваров.Организация В(&МассивОрганизаций)
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		СебестоимостьТоваровОстатки.Организация,
	|		СебестоимостьТоваровОстатки.АналитикаУчетаНоменклатуры,
	|		СебестоимостьТоваровОстатки.ВидЗапасов,
	|		СебестоимостьТоваровОстатки.РазделУчета,
	|		ЛОЖЬ КАК Резерв,
	|		0,
	|		0,
	|		ВЫБОР
	|			КОГДА &НачалоПериода = ДАТАВРЕМЯ(1, 1, 1)
	|			ТОГДА 0
	|			КОГДА СебестоимостьТоваровОстатки.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРеглОстаток
	|			ИНАЧЕ СебестоимостьТоваровОстатки.СтоимостьРеглОстаток
	|				+ СебестоимостьТоваровОстатки.ДопРасходыРеглОстаток + СебестоимостьТоваровОстатки.ТрудозатратыРеглОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеРеглОстаток + СебестоимостьТоваровОстатки.ПостатейныеПеременныеРеглОстаток
	|		КОНЕЦ,
	|		0
	|	ИЗ
	|		РегистрНакопления.СебестоимостьТоваров.Остатки(&НачалоПериода, Организация В (&МассивОрганизаций)) КАК СебестоимостьТоваровОстатки
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		СебестоимостьТоваровОстатки.Организация,
	|		СебестоимостьТоваровОстатки.АналитикаУчетаНоменклатуры,
	|		СебестоимостьТоваровОстатки.ВидЗапасов,
	|		СебестоимостьТоваровОстатки.РазделУчета,
	|		ЛОЖЬ КАК Резерв,
	|		0,
	|		0,
	|		0,
	|		ВЫБОР
	|			КОГДА СебестоимостьТоваровОстатки.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРеглОстаток
	|			ИНАЧЕ СебестоимостьТоваровОстатки.СтоимостьРеглОстаток
	|				+ СебестоимостьТоваровОстатки.ДопРасходыРеглОстаток + СебестоимостьТоваровОстатки.ТрудозатратыРеглОстаток
	|				+ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеРеглОстаток + СебестоимостьТоваровОстатки.ПостатейныеПеременныеРеглОстаток
	|		КОНЕЦ
	|	ИЗ
	|		РегистрНакопления.СебестоимостьТоваров.Остатки(&КонецПериодаОстатков, Организация В (&МассивОрганизаций)) КАК СебестоимостьТоваровОстатки
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		СебестоимостьТоваровОстатки.Организация,
	|		СебестоимостьТоваровОстатки.АналитикаУчетаНоменклатуры,
	|		СебестоимостьТоваровОстатки.ВидЗапасов,
	|		СебестоимостьТоваровОстатки.РазделУчета,
	|		ИСТИНА КАК Резерв,
	|		0,
	|		0,
	|		ВЫБОР
	|			КОГДА &НачалоПериода = ДАТАВРЕМЯ(1, 1, 1)
	|				ТОГДА 0
	|			ИНАЧЕ СебестоимостьТоваровОстатки.РезервПодОбесценениеРеглОстаток
	|		КОНЕЦ,
	|		0
	|	ИЗ
	|		РегистрНакопления.СебестоимостьТоваров.Остатки(&НачалоПериода, Организация В (&МассивОрганизаций)) КАК СебестоимостьТоваровОстатки
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		СебестоимостьТоваровОстатки.Организация,
	|		СебестоимостьТоваровОстатки.АналитикаУчетаНоменклатуры,
	|		СебестоимостьТоваровОстатки.ВидЗапасов,
	|		СебестоимостьТоваровОстатки.РазделУчета,
	|		ИСТИНА КАК Резерв,
	|		0,
	|		0,
	|		0,
	|		СебестоимостьТоваровОстатки.РезервПодОбесценениеРеглОстаток
	|	ИЗ
	|		РегистрНакопления.СебестоимостьТоваров.Остатки(&КонецПериодаОстатков, Организация В (&МассивОрганизаций)) КАК СебестоимостьТоваровОстатки) КАК Подзапрос
	|ГДЕ
	|	НЕ Подзапрос.РазделУчета В (
	|							ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|							ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|	И (НЕ Подзапрос.Резерв ИЛИ НЕ Подзапрос.РазделУчета В (
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)))
	|
	|СГРУППИРОВАТЬ ПО
	|	Подзапрос.Организация,
	|	Подзапрос.АналитикаУчетаНоменклатуры,
	|	Подзапрос.ВидЗапасов,
	|	Подзапрос.РазделУчета,
	|	Подзапрос.Резерв
	|
	|ИМЕЮЩИЕ
	|	СУММА(Подзапрос.НачальныйОстаток) <> 0
	|		ИЛИ СУММА(Подзапрос.Приход) <> 0
	|		ИЛИ СУММА(Подзапрос.Расход) <> 0
	|		ИЛИ СУММА(Подзапрос.КонечныйОстаток) <> 0";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область СебестоимостьСводно
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ДанныеСебестоимости.Организация КАК Организация,
	|	Аналитика.ТипМестаХранения КАК ТипМестаХранения,
	|	Аналитика.Номенклатура КАК Номенклатура,
	|	ЕСТЬNULL(Склады.Ссылка, ЗНАЧЕНИЕ(Справочник.Склады.ПустаяСсылка)) КАК Склад,
	|	ВЫБОР
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Аналитика.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА ЕСТЬNULL(Аналитика.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		ИНАЧЕ ЕСТЬNULL(Склады.Подразделение, НЕОПРЕДЕЛЕНО)
	|	КОНЕЦ КАК Подразделение,
	|	ВЫБОР
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|		ТОГДА ДанныеСебестоимости.ВидЗапасов.ГруппаФинансовогоУчета
	|		ИНАЧЕ Аналитика.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК ГруппаФинансовогоУчета,
	|	НЕОПРЕДЕЛЕНО КАК Валюта,
	|	СУММА(ДанныеСебестоимости.НачальныйОстаток) КАК НачальныйОстаток,
	|	СУММА(ДанныеСебестоимости.Приход) КАК Приход,
	|	СУММА(ДанныеСебестоимости.Расход) КАК Расход,
	|	СУММА(ДанныеСебестоимости.КонечныйОстаток) КАК КонечныйОстаток,
	|	ДанныеСебестоимости.РазделУчета,
	|	ДанныеСебестоимости.Резерв,
	|	ВЫБОР
	|		КОГДА ДанныеСебестоимости.Резерв
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеТМЦ)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		КОГДА НЕ ЕСТЬNULL(Склады.ЦеховаяКладовая, ЛОЖЬ) И Аналитика.ТипМестаХранения <> ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|			И ДанныеСебестоимости.РазделУчета В (
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦНаСкладах)
	|		КОГДА ЕСТЬNULL(Склады.ЦеховаяКладовая, ЛОЖЬ) И ДанныеСебестоимости.РазделУчета В
	|			(ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦВПроизводстве)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение) И ДанныеСебестоимости.РазделУчета В
	|			(ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦПотребленныеВПроизводстве)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦУХранителей)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиКОформлениюСписания)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦКСписанию)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработкуКОформлениюСписания)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуКСписанию)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработкуПереданныеПартнерам)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуУХранителей)
	|		КОГДА НЕ ЕСТЬNULL(Склады.ЦеховаяКладовая, ЛОЖЬ) И Аналитика.ТипМестаХранения <> ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|			И ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработку)
	|		КОГДА ЕСТЬNULL(Склады.ЦеховаяКладовая, ЛОЖЬ)
	|			И ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуВПроизводстве)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|			И ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПотребленныеВПроизводстве)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию) И НЕ Аналитика.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыНаСкладе)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию) И Аналитика.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыПереданныеНаКомиссию)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РеализацияБезПереходаПраваСобственности)
	|		КОГДА ДанныеСебестоимости.РазделУчета В
	|			(ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию), ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗатратыНаПриобретениеТМЦ)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|	КОНЕЦ КАК ВидСчета
	|ПОМЕСТИТЬ ВТ_СебестоимостьТоваров
	|ИЗ
	|	ВТ_СебестоимостьТоваровОстаткиИОбороты КАК ДанныеСебестоимости
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.КлючиАналитикиУчетаНоменклатуры КАК Аналитика
	|	ПО Аналитика.Ссылка = ДанныеСебестоимости.АналитикаУчетаНоменклатуры
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Склады КАК Склады
	|	ПО Склады.Ссылка = Аналитика.СкладскаяТерритория
	|		И Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|
	|СГРУППИРОВАТЬ ПО
	|	ДанныеСебестоимости.Организация,
	|	Аналитика.ТипМестаХранения,
	|	Аналитика.Номенклатура,
	|	ЕСТЬNULL(Склады.Ссылка, ЗНАЧЕНИЕ(Справочник.Склады.ПустаяСсылка)),
	|	ВЫБОР
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Аналитика.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА ЕСТЬNULL(Аналитика.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		ИНАЧЕ ЕСТЬNULL(Склады.Подразделение, НЕОПРЕДЕЛЕНО)
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|		ТОГДА ДанныеСебестоимости.ВидЗапасов.ГруппаФинансовогоУчета
	|		ИНАЧЕ Аналитика.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ,
	|	ДанныеСебестоимости.РазделУчета,
	|	ДанныеСебестоимости.Резерв,
	|	ВЫБОР
	|		КОГДА ДанныеСебестоимости.Резерв
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеТМЦ)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		КОГДА НЕ ЕСТЬNULL(Склады.ЦеховаяКладовая, ЛОЖЬ) И Аналитика.ТипМестаХранения <> ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|			И ДанныеСебестоимости.РазделУчета В (
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦНаСкладах)
	|		КОГДА ЕСТЬNULL(Склады.ЦеховаяКладовая, ЛОЖЬ) И ДанныеСебестоимости.РазделУчета В
	|			(ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦВПроизводстве)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение) И ДанныеСебестоимости.РазделУчета В
	|			(ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦПотребленныеВПроизводстве)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦУХранителей)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиКОформлениюСписания)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦКСписанию)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработкуКОформлениюСписания)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуКСписанию)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработкуПереданныеПартнерам)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуУХранителей)
	|		КОГДА НЕ ЕСТЬNULL(Склады.ЦеховаяКладовая, ЛОЖЬ) И Аналитика.ТипМестаХранения <> ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|			И ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработку)
	|		КОГДА ЕСТЬNULL(Склады.ЦеховаяКладовая, ЛОЖЬ)
	|			И ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуВПроизводстве)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|			И ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПотребленныеВПроизводстве)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию) И НЕ Аналитика.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыНаСкладе)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию) И Аналитика.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыПереданныеНаКомиссию)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РеализацияБезПереходаПраваСобственности)
	|		КОГДА ДанныеСебестоимости.РазделУчета В
	|			(ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию), ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗатратыНаПриобретениеТМЦ)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|	КОНЕЦ
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ВидСчета,
	|	Организация,
	|	Номенклатура,
	|	Подразделение,
	|	Склад";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область СебестоимостьОУ
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ВТ_СебестоимостьТоваров.Организация КАК Организация,
	|	ВТ_СебестоимостьТоваров.Номенклатура КАК Номенклатура,
	|	ВТ_СебестоимостьТоваров.Подразделение КАК Подразделение,
	|	ВТ_СебестоимостьТоваров.Склад КАК Склад,
	|	ВТ_СебестоимостьТоваров.Валюта КАК Валюта,
	|	ВТ_СебестоимостьТоваров.РазделУчета,
	|	ВТ_СебестоимостьТоваров.Резерв,
	|	ВТ_СебестоимостьТоваров.ТипМестаХранения,
	|	ВТ_СебестоимостьТоваров.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	ЕСТЬNULL(НастройкиПоМестуУчета.СчетУчета, ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, НЕОПРЕДЕЛЕНО))) КАК Счет
	|ПОМЕСТИТЬ ВТ_СебестоимостьТоваровНастройки
	|ИЗ
	|	ВТ_СебестоимостьТоваров КАК ВТ_СебестоимостьТоваров
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоМестуУчета
	|	ПО НастройкиПоМестуУчета.ВидСчета = ВТ_СебестоимостьТоваров.ВидСчета
	|		И НастройкиПоМестуУчета.Организация = ВТ_СебестоимостьТоваров.Организация
	|		И НастройкиПоМестуУчета.АналитикаУчета = ВТ_СебестоимостьТоваров.ГруппаФинансовогоУчета
	|		И НастройкиПоМестуУчета.МестоУчета = ВТ_СебестоимостьТоваров.Склад
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоОрганизации
	|	ПО НастройкиПоОрганизации.ВидСчета = ВТ_СебестоимостьТоваров.ВидСчета
	|		И НастройкиПоОрганизации.Организация = ВТ_СебестоимостьТоваров.Организация
	|		И НастройкиПоОрганизации.АналитикаУчета = ВТ_СебестоимостьТоваров.ГруппаФинансовогоУчета
	|		И НастройкиПоОрганизации.МестоУчета = НЕОПРЕДЕЛЕНО
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоАналитике
	|	ПО НастройкиПоАналитике.ВидСчета = ВТ_СебестоимостьТоваров.ВидСчета
	|		И НастройкиПоАналитике.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|		И НастройкиПоАналитике.АналитикаУчета = ВТ_СебестоимостьТоваров.ГруппаФинансовогоУчета
	|		И НастройкиПоАналитике.МестоУчета = НЕОПРЕДЕЛЕНО";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область СебестоимостьБУ
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ХозрасчетныйОстаткиИОбороты.Организация,
	|	ХозрасчетныйОстаткиИОбороты.Счет,
	|	ХозрасчетныйОстаткиИОбороты.Субконто1,
	|	ХозрасчетныйОстаткиИОбороты.Субконто2,
	|	ХозрасчетныйОстаткиИОбороты.Подразделение,
	|	ХозрасчетныйОстаткиИОбороты.СуммаНачальныйОстаток,
	|	ХозрасчетныйОстаткиИОбороты.СуммаОборотДт,
	|	ХозрасчетныйОстаткиИОбороты.СуммаОборотКт,
	|	ХозрасчетныйОстаткиИОбороты.СуммаКонечныйОстаток
	|ПОМЕСТИТЬ ВТ_СебестоимостьНоменклатурыРегл
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОстаткиИОбороты(&НачалоПериода, &КонецПериода,,, НЕ Счет.Забалансовый И НЕ Счет В ИЕРАРХИИ (&СчетаБезСубконтоНоменклатураСклад),
	|		&ВидыСубконтоНоменклатураСклад, Организация В (&МассивОрганизаций)) КАК ХозрасчетныйОстаткиИОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ // счета 10.07, 15, 45
	|	ХозрасчетныйОстаткиИОбороты.Организация,
	|	ХозрасчетныйОстаткиИОбороты.Счет,
	|	ХозрасчетныйОстаткиИОбороты.Субконто1,
	|	ЗНАЧЕНИЕ(Справочник.Склады.ПустаяСсылка),
	|	ЕСТЬNULL(ХозрасчетныйОстаткиИОбороты.Подразделение, НЕОПРЕДЕЛЕНО),
	|	ХозрасчетныйОстаткиИОбороты.СуммаНачальныйОстаток,
	|	ХозрасчетныйОстаткиИОбороты.СуммаОборотДт,
	|	ХозрасчетныйОстаткиИОбороты.СуммаОборотКт,
	|	ХозрасчетныйОстаткиИОбороты.СуммаКонечныйОстаток
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОстаткиИОбороты(&НачалоПериода, &КонецПериода,,, Счет В ИЕРАРХИИ (&СчетаБезСубконтоНоменклатураСклад),
	|		ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Номенклатура), Организация В (&МассивОрганизаций)) КАК ХозрасчетныйОстаткиИОбороты";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область Результат
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	""Себестоимость"" КАК РазделУчета,
	|	Подзапрос.Организация,
	|	Подзапрос.Аналитика1,
	|	Подзапрос.Аналитика2,
	|	Подзапрос.Подразделение,
	|	Подзапрос.СчетБУ,
	|	СУММА(Подзапрос.НачальныйОстаток) КАК НачальныйОстаток,
	|	СУММА(Подзапрос.Приход) КАК Приход,
	|	СУММА(Подзапрос.Расход) КАК Расход,
	|	СУММА(Подзапрос.КонечныйОстаток) КАК КонечныйОстаток,
	|	СУММА(Подзапрос.НачальноеСальдо) КАК НачальноеСальдо,
	|	СУММА(Подзапрос.ОборотДт) КАК ОборотДт,
	|	СУММА(Подзапрос.ОборотКт) КАК ОборотКт,
	|	СУММА(Подзапрос.КонечноеСальдо) КАК КонечноеСальдо
	|ИЗ
	|	(ВЫБРАТЬ
	|		ВТ_СебестоимостьТоваровНастройки.Организация КАК Организация,
	|		ВТ_СебестоимостьТоваровНастройки.Номенклатура КАК Аналитика1,
	|		ВЫБОР
	|			КОГДА ВТ_СебестоимостьТоваровНастройки.Счет В ИЕРАРХИИ (&СчетаБезСубконтоНоменклатураСклад)
	|				ТОГДА ЗНАЧЕНИЕ(Справочник.Склады.ПустаяСсылка)
	|			ИНАЧЕ ВТ_СебестоимостьТоваровНастройки.Склад
	|		КОНЕЦ КАК Аналитика2,
	|		ВЫБОР
	|			КОГДА ПланХозрасчетный.УчетПоПодразделениям
	|				ТОГДА ВТ_СебестоимостьТоваровНастройки.Подразделение
	|			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)
	|		КОНЕЦ КАК Подразделение,
	|		ВТ_СебестоимостьТоваровНастройки.Счет КАК СчетБУ,
	|		ЕСТЬNULL(ВТ_СебестоимостьТоваров.НачальныйОстаток, 0) КАК НачальныйОстаток,
	|		ЕСТЬNULL(ВТ_СебестоимостьТоваров.Приход, 0) КАК Приход,
	|		ЕСТЬNULL(ВТ_СебестоимостьТоваров.Расход, 0) КАК Расход,
	|		ЕСТЬNULL(ВТ_СебестоимостьТоваров.КонечныйОстаток, 0) КАК КонечныйОстаток,
	|		0 КАК НачальноеСальдо,
	|		0 КАК ОборотДт,
	|		0 КАК ОборотКт,
	|		0 КАК КонечноеСальдо
	|	ИЗ
	|		ВТ_СебестоимостьТоваровНастройки КАК ВТ_СебестоимостьТоваровНастройки
	|			ЛЕВОЕ СОЕДИНЕНИЕ ВТ_СебестоимостьТоваров КАК ВТ_СебестоимостьТоваров
	|			ПО ВТ_СебестоимостьТоваровНастройки.Организация = ВТ_СебестоимостьТоваров.Организация
	|				И ВТ_СебестоимостьТоваровНастройки.Номенклатура = ВТ_СебестоимостьТоваров.Номенклатура
	|				И ВТ_СебестоимостьТоваровНастройки.Подразделение = ВТ_СебестоимостьТоваров.Подразделение
	|				И ВТ_СебестоимостьТоваровНастройки.РазделУчета = ВТ_СебестоимостьТоваров.РазделУчета
	|				И ВТ_СебестоимостьТоваровНастройки.Резерв = ВТ_СебестоимостьТоваров.Резерв
	|				И ВТ_СебестоимостьТоваровНастройки.Валюта = ВТ_СебестоимостьТоваров.Валюта
	|				И ВТ_СебестоимостьТоваровНастройки.Склад = ВТ_СебестоимостьТоваров.Склад
	|				И ВТ_СебестоимостьТоваровНастройки.ГруппаФинансовогоУчета = ВТ_СебестоимостьТоваров.ГруппаФинансовогоУчета
	|				И ВТ_СебестоимостьТоваровНастройки.ТипМестаХранения = ВТ_СебестоимостьТоваров.ТипМестаХранения
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПланХозрасчетный КАК ПланХозрасчетный
	|			ПО ВТ_СебестоимостьТоваровНастройки.Счет = ПланХозрасчетный.Ссылка
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ВТ_СебестоимостьНоменклатурыРегл.Организация,
	|		ВТ_СебестоимостьНоменклатурыРегл.Субконто1,
	|		ВТ_СебестоимостьНоменклатурыРегл.Субконто2,
	|		ВТ_СебестоимостьНоменклатурыРегл.Подразделение,
	|		ВТ_СебестоимостьНоменклатурыРегл.Счет,
	|		0,
	|		0,
	|		0,
	|		0,
	|		ВТ_СебестоимостьНоменклатурыРегл.СуммаНачальныйОстаток,
	|		ВТ_СебестоимостьНоменклатурыРегл.СуммаОборотДт,
	|		ВТ_СебестоимостьНоменклатурыРегл.СуммаОборотКт,
	|		ВТ_СебестоимостьНоменклатурыРегл.СуммаКонечныйОстаток
	|	ИЗ
	|		ВТ_СебестоимостьНоменклатурыРегл КАК ВТ_СебестоимостьНоменклатурыРегл) КАК Подзапрос
	|
	|СГРУППИРОВАТЬ ПО
	|	Подзапрос.Организация,
	|	Подзапрос.Аналитика1,
	|	Подзапрос.Аналитика2,
	|	Подзапрос.Подразделение,
	|	Подзапрос.СчетБУ
	|ИМЕЮЩИЕ
	|	НЕ (СУММА(Подзапрос.НачальныйОстаток) = 0
	|		И СУММА(Подзапрос.Приход) = 0
	|		И СУММА(Подзапрос.Расход) = 0
	|		И СУММА(Подзапрос.КонечныйОстаток) = 0
	|		И СУММА(Подзапрос.НачальноеСальдо) = 0
	|		И СУММА(Подзапрос.ОборотДт) = 0
	|		И СУММА(Подзапрос.ОборотКт) = 0
	|		И СУММА(Подзапрос.КонечноеСальдо) = 0)";
	
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	ТекстЗапроса = СтрСоединить(МассивТекстовЗапроса, ОбщегоНазначения.РазделительПакетаЗапросов());
	
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстЗапросаСебестоимостьПоРегистраторам()
	
	МассивТекстовЗапроса = Новый Массив;
	
	#Область Себестоимость
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	Подзапрос.Организация,
	|	Подзапрос.АналитикаУчетаНоменклатуры,
	|	Подзапрос.ПодразделениеПродаж КАК Подразделение,
	|	Подзапрос.ВидЗапасов,
	|	Подзапрос.РазделУчета,
	|	Подзапрос.Резерв,
	|	Подзапрос.Регистратор,
	|	СУММА(Подзапрос.Приход) КАК Приход,
	|	СУММА(Подзапрос.Расход) КАК Расход
	|ПОМЕСТИТЬ ВТ_СебестоимостьТоваровОстаткиИОбороты
	|ИЗ
	|	(ВЫБРАТЬ
	|		СебестоимостьТоваров.Организация КАК Организация,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|		СебестоимостьТоваров.Подразделение КАК ПодразделениеПродаж,
	|		СебестоимостьТоваров.ВидЗапасов КАК ВидЗапасов,
	|		СебестоимостьТоваров.РазделУчета КАК РазделУчета,
	|		ЛОЖЬ КАК Резерв,
	|		ВЫБОР
	|			КОГДА (СебестоимостьТоваров.Регистратор ССЫЛКА Документ.РасчетСебестоимостиТоваров ИЛИ СебестоимостьТоваров.РасчетСебестоимости)
	|				И СебестоимостьТоваров.ДокументДвижения <> НЕОПРЕДЕЛЕНО
	|				ТОГДА СебестоимостьТоваров.ДокументДвижения
	|			ИНАЧЕ СебестоимостьТоваров.Регистратор
	|		КОНЕЦ КАК Регистратор,
	|		ВЫБОР
	|			КОГДА СебестоимостьТоваров.ХозяйственнаяОперация В (
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратИзПроизводства),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзПроизводства),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзКладовой),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратТоваровОтКлиента),
	//++ Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратОтПереработчика),
	//-- Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратОтПереработчика2_5))
	|				И СебестоимостьТоваров.ТипЗаписи <> ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ВключениеИсключениеНДСВСтоимости)
	|			ТОГДА 0
	|			КОГДА СебестоимостьТоваров.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|			ТОГДА СебестоимостьТоваров.СтоимостьЗабалансоваяРегл
	|			ИНАЧЕ СебестоимостьТоваров.СтоимостьРегл
	|				+ СебестоимостьТоваров.ДопРасходыРегл + СебестоимостьТоваров.ТрудозатратыРегл + СебестоимостьТоваров.ПостатейныеПостоянныеРегл
	|               + СебестоимостьТоваров.ПостатейныеПеременныеРегл
	|		КОНЕЦ КАК Приход,
	|		ВЫБОР
	|			КОГДА НЕ (СебестоимостьТоваров.ХозяйственнаяОперация В (
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратИзПроизводства),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзПроизводства),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзКладовой),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратТоваровОтКлиента),
	//++ Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратОтПереработчика),
	//-- Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратОтПереработчика2_5))
	|				И СебестоимостьТоваров.ТипЗаписи <> ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ВключениеИсключениеНДСВСтоимости))
	|			ТОГДА 0
	|			КОГДА СебестоимостьТоваров.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|			ТОГДА -СебестоимостьТоваров.СтоимостьЗабалансоваяРегл
	|			ИНАЧЕ -(СебестоимостьТоваров.СтоимостьРегл
	|					+ СебестоимостьТоваров.ДопРасходыРегл + СебестоимостьТоваров.ТрудозатратыРегл
	|					+ СебестоимостьТоваров.ПостатейныеПостоянныеРегл + СебестоимостьТоваров.ПостатейныеПеременныеРегл)
	|		КОНЕЦ КАК Расход,
	|		0 КАК НачальныйОстаток,
	|		0 КАК КонечныйОстаток
	|	ИЗ
	|		РегистрНакопления.СебестоимостьТоваров КАК СебестоимостьТоваров
	|	ГДЕ
	|		СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|		И СебестоимостьТоваров.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И СебестоимостьТоваров.Активность
	|		И СебестоимостьТоваров.Организация В (&МассивОрганизаций)
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		СебестоимостьТоваров.Организация КАК Организация,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|		СебестоимостьТоваров.Подразделение КАК ПодразделениеПродаж,
	|		СебестоимостьТоваров.ВидЗапасов КАК ВидЗапасов,
	|		СебестоимостьТоваров.РазделУчета КАК РазделУчета,
	|		ИСТИНА КАК Резерв,
	|		ВЫБОР
	|			КОГДА (СебестоимостьТоваров.Регистратор ССЫЛКА Документ.РасчетСебестоимостиТоваров ИЛИ СебестоимостьТоваров.РасчетСебестоимости)
	|				И СебестоимостьТоваров.ДокументДвижения <> НЕОПРЕДЕЛЕНО
	|				ТОГДА СебестоимостьТоваров.ДокументДвижения
	|			ИНАЧЕ СебестоимостьТоваров.Регистратор
	|		КОНЕЦ КАК Регистратор,
	|		ВЫБОР
	|			КОГДА СебестоимостьТоваров.ХозяйственнаяОперация В (
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратИзПроизводства),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзПроизводства),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзКладовой),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратТоваровОтКлиента),
	//++ Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратОтПереработчика),
	//-- Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратОтПереработчика2_5))
	|				ТОГДА 0
	|			ИНАЧЕ СебестоимостьТоваров.РезервПодОбесценениеРегл
	|		КОНЕЦ КАК Приход,
	|		ВЫБОР
	|			КОГДА СебестоимостьТоваров.ХозяйственнаяОперация В (
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратИзПроизводства),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзПроизводства),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзКладовой),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратТоваровОтКлиента),
	//++ Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратОтПереработчика),
	//-- Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратОтПереработчика2_5))
	|				ТОГДА -(СебестоимостьТоваров.РезервПодОбесценениеРегл)
	|			ИНАЧЕ 0
	|		КОНЕЦ КАК Расход,
	|		0 КАК НачальныйОстаток,
	|		0 КАК КонечныйОстаток
	|	ИЗ
	|		РегистрНакопления.СебестоимостьТоваров КАК СебестоимостьТоваров
	|	ГДЕ
	|		СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|		И СебестоимостьТоваров.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И СебестоимостьТоваров.Активность
	|		И СебестоимостьТоваров.Организация В (&МассивОрганизаций)
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		СебестоимостьТоваров.Организация,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры,
	|		СебестоимостьТоваров.Подразделение,
	|		СебестоимостьТоваров.ВидЗапасов,
	|		СебестоимостьТоваров.РазделУчета,
	|		ЛОЖЬ КАК Резерв,
	|		ВЫБОР
	|			КОГДА (СебестоимостьТоваров.Регистратор ССЫЛКА Документ.РасчетСебестоимостиТоваров ИЛИ СебестоимостьТоваров.РасчетСебестоимости)
	|				И СебестоимостьТоваров.ДокументДвижения <> НЕОПРЕДЕЛЕНО	
	|				ТОГДА СебестоимостьТоваров.ДокументДвижения
	|			ИНАЧЕ СебестоимостьТоваров.Регистратор
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА НЕ СебестоимостьТоваров.ХозяйственнаяОперация В (
	//++ Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДавальцу),
	//-- Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДавальцу2_5),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратТоваровКомитенту))
	|			ТОГДА 0
	|			КОГДА СебестоимостьТоваров.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|			ТОГДА -СебестоимостьТоваров.СтоимостьЗабалансоваяРегл
	|			ИНАЧЕ -(СебестоимостьТоваров.СтоимостьРегл
	|					+ СебестоимостьТоваров.ДопРасходыРегл + СебестоимостьТоваров.ТрудозатратыРегл
	|					+ СебестоимостьТоваров.ПостатейныеПостоянныеРегл + СебестоимостьТоваров.ПостатейныеПеременныеРегл)
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА СебестоимостьТоваров.ХозяйственнаяОперация В (
	//++ Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДавальцу),
	//-- Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДавальцу2_5),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратТоваровКомитенту))
	|			ТОГДА 0
	|			КОГДА СебестоимостьТоваров.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|			ТОГДА СебестоимостьТоваров.СтоимостьЗабалансоваяРегл
	|			ИНАЧЕ СебестоимостьТоваров.СтоимостьРегл
	|				+ СебестоимостьТоваров.ДопРасходыРегл + СебестоимостьТоваров.ТрудозатратыРегл + СебестоимостьТоваров.ПостатейныеПостоянныеРегл
	|               + СебестоимостьТоваров.ПостатейныеПеременныеРегл
	|		КОНЕЦ,
	|		0,
	|		0
	|	ИЗ
	|		РегистрНакопления.СебестоимостьТоваров КАК СебестоимостьТоваров
	|	ГДЕ
	|		СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И СебестоимостьТоваров.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И СебестоимостьТоваров.Активность
	|		И СебестоимостьТоваров.Организация В (&МассивОрганизаций)
	|
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		СебестоимостьТоваров.Организация,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры,
	|		СебестоимостьТоваров.Подразделение,
	|		СебестоимостьТоваров.ВидЗапасов,
	|		СебестоимостьТоваров.РазделУчета,
	|		ИСТИНА КАК Резерв,
	|		ВЫБОР
	|			КОГДА (СебестоимостьТоваров.Регистратор ССЫЛКА Документ.РасчетСебестоимостиТоваров ИЛИ СебестоимостьТоваров.РасчетСебестоимости)
	|				И СебестоимостьТоваров.ДокументДвижения <> НЕОПРЕДЕЛЕНО	
	|				ТОГДА СебестоимостьТоваров.ДокументДвижения
	|			ИНАЧЕ СебестоимостьТоваров.Регистратор
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА НЕ СебестоимостьТоваров.ХозяйственнаяОперация В (
	//++ Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДавальцу),
	//-- Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДавальцу2_5),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратТоваровКомитенту))
	|			ТОГДА 0
	|			КОГДА СебестоимостьТоваров.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|			ТОГДА 0
	|			ИНАЧЕ -СебестоимостьТоваров.РезервПодОбесценениеРегл
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА СебестоимостьТоваров.ХозяйственнаяОперация В (
	//++ Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДавальцу),
	//-- Устарело_Переработка24
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДавальцу2_5),
	|									ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратТоваровКомитенту))
	|			ТОГДА 0
	|			КОГДА СебестоимостьТоваров.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|			ТОГДА 0
	|			ИНАЧЕ СебестоимостьТоваров.РезервПодОбесценениеРегл
	|		КОНЕЦ,
	|		0,
	|		0
	|	ИЗ
	|		РегистрНакопления.СебестоимостьТоваров КАК СебестоимостьТоваров
	|	ГДЕ
	|		СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И СебестоимостьТоваров.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И СебестоимостьТоваров.Активность
	|		И СебестоимостьТоваров.Организация В (&МассивОрганизаций)
	|) КАК Подзапрос
	|ГДЕ
	|	НЕ Подзапрос.РазделУчета В (
	|							ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|							ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|	И (НЕ Подзапрос.Резерв ИЛИ НЕ Подзапрос.РазделУчета В (
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)))
	|
	|СГРУППИРОВАТЬ ПО
	|	Подзапрос.Организация,
	|	Подзапрос.АналитикаУчетаНоменклатуры,
	|	Подзапрос.ПодразделениеПродаж,
	|	Подзапрос.ВидЗапасов,
	|	Подзапрос.РазделУчета,
	|	Подзапрос.Резерв,
	|	Подзапрос.Регистратор";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область СебестоимостьСводно
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ДанныеСебестоимости.Организация КАК Организация,
	|	Аналитика.ТипМестаХранения КАК ТипМестаХранения,
	|	Аналитика.Номенклатура КАК Номенклатура,
	|	ЕСТЬNULL(Склады.Ссылка, ЗНАЧЕНИЕ(Справочник.Склады.ПустаяСсылка)) КАК Склад,
	|	ВЫБОР
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Аналитика.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА ЕСТЬNULL(Аналитика.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		ИНАЧЕ ЕСТЬNULL(Склады.Подразделение, НЕОПРЕДЕЛЕНО)
	|	КОНЕЦ КАК Подразделение,
	|	ВЫБОР
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|		ТОГДА ДанныеСебестоимости.ВидЗапасов.ГруппаФинансовогоУчета
	|		ИНАЧЕ Аналитика.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК ГруппаФинансовогоУчета,
	|	НЕОПРЕДЕЛЕНО КАК Валюта,
	|	ДанныеСебестоимости.Регистратор КАК Регистратор,
	|	СУММА(ДанныеСебестоимости.Приход) КАК Приход,
	|	СУММА(ДанныеСебестоимости.Расход) КАК Расход,
	|	ДанныеСебестоимости.РазделУчета,
	|	ДанныеСебестоимости.Резерв,
	|	ВЫБОР
	|		КОГДА ДанныеСебестоимости.Резерв
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеТМЦ)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		КОГДА НЕ ЕСТЬNULL(Склады.ЦеховаяКладовая, ЛОЖЬ) И Аналитика.ТипМестаХранения <> ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|			И ДанныеСебестоимости.РазделУчета В (
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦНаСкладах)
	|		КОГДА ЕСТЬNULL(Склады.ЦеховаяКладовая, ЛОЖЬ) И ДанныеСебестоимости.РазделУчета В
	|			(ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦВПроизводстве)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение) И ДанныеСебестоимости.РазделУчета В
	|			(ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦПотребленныеВПроизводстве)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦУХранителей)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиКОформлениюСписания)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦКСписанию)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработкуКОформлениюСписания)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуКСписанию)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработкуПереданныеПартнерам)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуУХранителей)
	|		КОГДА НЕ ЕСТЬNULL(Склады.ЦеховаяКладовая, ЛОЖЬ) И Аналитика.ТипМестаХранения <> ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|			И ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработку)
	|		КОГДА ЕСТЬNULL(Склады.ЦеховаяКладовая, ЛОЖЬ)
	|			И ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуВПроизводстве)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|			И ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПотребленныеВПроизводстве)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию) И НЕ Аналитика.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыНаСкладе)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию) И Аналитика.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыПереданныеНаКомиссию)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РеализацияБезПереходаПраваСобственности)
	|		КОГДА ДанныеСебестоимости.РазделУчета В
	|			(ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию), ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗатратыНаПриобретениеТМЦ)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|	КОНЕЦ КАК ВидСчета
	|ПОМЕСТИТЬ ВТ_СебестоимостьТоваров
	|ИЗ
	|	ВТ_СебестоимостьТоваровОстаткиИОбороты КАК ДанныеСебестоимости
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.КлючиАналитикиУчетаНоменклатуры КАК Аналитика
	|	ПО Аналитика.Ссылка = ДанныеСебестоимости.АналитикаУчетаНоменклатуры
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Склады КАК Склады
	|	ПО Склады.Ссылка = Аналитика.СкладскаяТерритория
	|		И Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|
	|СГРУППИРОВАТЬ ПО
	|	ДанныеСебестоимости.Организация,
	|	Аналитика.ТипМестаХранения,
	|	Аналитика.Номенклатура,
	|	ЕСТЬNULL(Склады.Ссылка, ЗНАЧЕНИЕ(Справочник.Склады.ПустаяСсылка)),
	|	ВЫБОР
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Аналитика.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА ЕСТЬNULL(Аналитика.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		ИНАЧЕ ЕСТЬNULL(Склады.Подразделение, НЕОПРЕДЕЛЕНО)
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|		ТОГДА ДанныеСебестоимости.ВидЗапасов.ГруппаФинансовогоУчета
	|		ИНАЧЕ Аналитика.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ,
	|	ДанныеСебестоимости.РазделУчета,
	|	ДанныеСебестоимости.Резерв,
	|	ДанныеСебестоимости.Регистратор,
	|	ВЫБОР
	|		КОГДА ДанныеСебестоимости.Резерв
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеТМЦ)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		КОГДА НЕ ЕСТЬNULL(Склады.ЦеховаяКладовая, ЛОЖЬ) И Аналитика.ТипМестаХранения <> ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|			И ДанныеСебестоимости.РазделУчета В (
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦНаСкладах)
	|		КОГДА ЕСТЬNULL(Склады.ЦеховаяКладовая, ЛОЖЬ) И ДанныеСебестоимости.РазделУчета В
	|			(ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦВПроизводстве)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение) И ДанныеСебестоимости.РазделУчета В
	|			(ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦПотребленныеВПроизводстве)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦУХранителей)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиКОформлениюСписания)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦКСписанию)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработкуКОформлениюСписания)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуКСписанию)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработкуПереданныеПартнерам)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуУХранителей)
	|		КОГДА НЕ ЕСТЬNULL(Склады.ЦеховаяКладовая, ЛОЖЬ) И Аналитика.ТипМестаХранения <> ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|			И ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработку)
	|		КОГДА ЕСТЬNULL(Склады.ЦеховаяКладовая, ЛОЖЬ)
	|			И ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуВПроизводстве)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|			И ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПотребленныеВПроизводстве)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию) И НЕ Аналитика.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыНаСкладе)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию) И Аналитика.ТипМестаХранения В
	|			(ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыПереданныеНаКомиссию)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РеализацияБезПереходаПраваСобственности)
	|		КОГДА ДанныеСебестоимости.РазделУчета В
	|			(ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию), ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА ДанныеСебестоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗатратыНаПриобретениеТМЦ)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|	КОНЕЦ
	|ИНДЕКСИРОВАТЬ ПО
	|	ВидСчета,
	|	Организация,
	|	Номенклатура,
	|	Подразделение,
	|	Склад";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область СебестоимостьОУ
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ВТ_СебестоимостьТоваров.Организация КАК Организация,
	|	ВТ_СебестоимостьТоваров.Номенклатура КАК Номенклатура,
	|	ВТ_СебестоимостьТоваров.Подразделение КАК Подразделение,
	|	ВТ_СебестоимостьТоваров.Склад КАК Склад,
	|	ВТ_СебестоимостьТоваров.Валюта КАК Валюта,
	|	ВТ_СебестоимостьТоваров.РазделУчета,
	|	ВТ_СебестоимостьТоваров.Резерв,
	|	ВТ_СебестоимостьТоваров.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	ВТ_СебестоимостьТоваров.ТипМестаХранения,
	|	ВТ_СебестоимостьТоваров.Регистратор КАК Регистратор,
	|	ЕСТЬNULL(НастройкиПоМестуУчета.СчетУчета, ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, НЕОПРЕДЕЛЕНО))) КАК Счет
	|ПОМЕСТИТЬ ВТ_СебестоимостьТоваровНастройки
	|ИЗ
	|	ВТ_СебестоимостьТоваров КАК ВТ_СебестоимостьТоваров
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоМестуУчета
	|	ПО НастройкиПоМестуУчета.ВидСчета = ВТ_СебестоимостьТоваров.ВидСчета
	|		И НастройкиПоМестуУчета.Организация = ВТ_СебестоимостьТоваров.Организация
	|		И НастройкиПоМестуУчета.АналитикаУчета = ВТ_СебестоимостьТоваров.ГруппаФинансовогоУчета
	|		И НастройкиПоМестуУчета.МестоУчета = ВТ_СебестоимостьТоваров.Склад
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоОрганизации
	|	ПО НастройкиПоОрганизации.ВидСчета = ВТ_СебестоимостьТоваров.ВидСчета
	|		И НастройкиПоОрганизации.Организация = ВТ_СебестоимостьТоваров.Организация
	|		И НастройкиПоОрганизации.АналитикаУчета = ВТ_СебестоимостьТоваров.ГруппаФинансовогоУчета
	|		И НастройкиПоОрганизации.МестоУчета = НЕОПРЕДЕЛЕНО
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоАналитике
	|	ПО НастройкиПоАналитике.ВидСчета = ВТ_СебестоимостьТоваров.ВидСчета
	|		И НастройкиПоАналитике.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|		И НастройкиПоАналитике.АналитикаУчета = ВТ_СебестоимостьТоваров.ГруппаФинансовогоУчета
	|		И НастройкиПоАналитике.МестоУчета = НЕОПРЕДЕЛЕНО";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область СебестоимостьБУ
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ХозрасчетныйОстаткиИОбороты.Организация,
	|	ХозрасчетныйОстаткиИОбороты.Счет,
	|	ХозрасчетныйОстаткиИОбороты.Субконто1,
	|	ХозрасчетныйОстаткиИОбороты.Субконто2,
	|	ХозрасчетныйОстаткиИОбороты.Подразделение,
	|	ХозрасчетныйОстаткиИОбороты.Регистратор,
	|	ХозрасчетныйОстаткиИОбороты.СуммаОборотДт,
	|	ХозрасчетныйОстаткиИОбороты.СуммаОборотКт
	|ПОМЕСТИТЬ ВТ_СебестоимостьНоменклатурыРегл
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(&НачалоПериода, &КонецПериода, Регистратор, НЕ Счет.Забалансовый И НЕ Счет В ИЕРАРХИИ (&СчетаБезСубконтоНоменклатураСклад),
	|		&ВидыСубконтоНоменклатураСклад, Организация В (&МассивОрганизаций),,) КАК ХозрасчетныйОстаткиИОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ // счета 10.07, 15, 45
	|	ХозрасчетныйОстаткиИОбороты.Организация,
	|	ХозрасчетныйОстаткиИОбороты.Счет,
	|	ХозрасчетныйОстаткиИОбороты.Субконто1,
	|	ЗНАЧЕНИЕ(Справочник.Склады.ПустаяСсылка),
	|	ЕСТЬNULL(ХозрасчетныйОстаткиИОбороты.Подразделение, НЕОПРЕДЕЛЕНО),
	|	ХозрасчетныйОстаткиИОбороты.Регистратор,
	|	ХозрасчетныйОстаткиИОбороты.СуммаОборотДт,
	|	ХозрасчетныйОстаткиИОбороты.СуммаОборотКт
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(&НачалоПериода, &КонецПериода, Регистратор, Счет В ИЕРАРХИИ (&СчетаБезСубконтоНоменклатураСклад),
	|		ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Номенклатура), Организация В (&МассивОрганизаций), , ) КАК ХозрасчетныйОстаткиИОбороты";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область СебестоимостьОУиБУ
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ВТ_СебестоимостьТоваровНастройки.Организация КАК Организация,
	|	ВТ_СебестоимостьТоваровНастройки.Номенклатура КАК Аналитика1,
	|	ВЫБОР
	|		КОГДА ВТ_СебестоимостьТоваровНастройки.Счет В ИЕРАРХИИ (&СчетаБезСубконтоНоменклатураСклад)
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.Склады.ПустаяСсылка)
	|		ИНАЧЕ ВТ_СебестоимостьТоваровНастройки.Склад
	|	КОНЕЦ КАК Аналитика2,
	|	ВЫБОР
	|		КОГДА ПланХозрасчетный.УчетПоПодразделениям
	|			ТОГДА ВТ_СебестоимостьТоваровНастройки.Подразделение
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)
	|	КОНЕЦ КАК Подразделение,
	|	ВТ_СебестоимостьТоваровНастройки.Счет КАК СчетБУ,
	|	ВТ_СебестоимостьТоваров.Регистратор КАК Регистратор,
	|	ЕСТЬNULL(ВТ_СебестоимостьТоваров.Приход, 0) КАК Приход,
	|	ЕСТЬNULL(ВТ_СебестоимостьТоваров.Расход, 0) КАК Расход,
	|	0 КАК ОборотДт,
	|	0 КАК ОборотКт
	|ПОМЕСТИТЬ ВТ_СверкаОборотов
	|ИЗ
	|	ВТ_СебестоимостьТоваровНастройки КАК ВТ_СебестоимостьТоваровНастройки
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_СебестоимостьТоваров КАК ВТ_СебестоимостьТоваров
	|		ПО ВТ_СебестоимостьТоваровНастройки.Организация = ВТ_СебестоимостьТоваров.Организация
	|			И ВТ_СебестоимостьТоваровНастройки.Номенклатура = ВТ_СебестоимостьТоваров.Номенклатура
	|			И ВТ_СебестоимостьТоваровНастройки.Подразделение = ВТ_СебестоимостьТоваров.Подразделение
	|			И ВТ_СебестоимостьТоваровНастройки.Валюта = ВТ_СебестоимостьТоваров.Валюта
	|			И ВТ_СебестоимостьТоваровНастройки.Склад = ВТ_СебестоимостьТоваров.Склад
	|			И ВТ_СебестоимостьТоваровНастройки.РазделУчета = ВТ_СебестоимостьТоваров.РазделУчета
	|			И ВТ_СебестоимостьТоваровНастройки.Резерв = ВТ_СебестоимостьТоваров.Резерв
	|			И ВТ_СебестоимостьТоваровНастройки.ГруппаФинансовогоУчета = ВТ_СебестоимостьТоваров.ГруппаФинансовогоУчета
	|			И ВТ_СебестоимостьТоваровНастройки.Регистратор = ВТ_СебестоимостьТоваров.Регистратор
	|			И ВТ_СебестоимостьТоваровНастройки.ТипМестаХранения = ВТ_СебестоимостьТоваров.ТипМестаХранения
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланХозрасчетный КАК ПланХозрасчетный
	|		ПО ВТ_СебестоимостьТоваровНастройки.Счет = ПланХозрасчетный.Ссылка
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ВТ_СебестоимостьНоменклатурыРегл.Организация,
	|	ВТ_СебестоимостьНоменклатурыРегл.Субконто1,
	|	ВТ_СебестоимостьНоменклатурыРегл.Субконто2,
	|	ВТ_СебестоимостьНоменклатурыРегл.Подразделение,
	|	ВТ_СебестоимостьНоменклатурыРегл.Счет,
	|	ВТ_СебестоимостьНоменклатурыРегл.Регистратор,
	|	0,
	|	0,
	|	ВТ_СебестоимостьНоменклатурыРегл.СуммаОборотДт,
	|	ВТ_СебестоимостьНоменклатурыРегл.СуммаОборотКт
	|ИЗ
	|	ВТ_СебестоимостьНоменклатурыРегл КАК ВТ_СебестоимостьНоменклатурыРегл
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Организация,
	|	Регистратор
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	МАКСИМУМ(ОтражениеДокументовВРеглУчете.Статус) КАК Статус,
	|	ОтражениеДокументовВРеглУчете.Организация КАК Организация,
	|	ОтражениеДокументовВРеглУчете.Регистратор КАК Регистратор
	|ПОМЕСТИТЬ ВТ_СтатусыОтражения
	|ИЗ
	|	РегистрСведений.ОтражениеДокументовВРеглУчете КАК ОтражениеДокументовВРеглУчете
	|ГДЕ
	|	ОтражениеДокументовВРеглУчете.Регистратор В
	|			(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|				Т.Регистратор КАК Регистратор
	|			ИЗ
	|				ВТ_СверкаОборотов КАК Т)
	|
	|СГРУППИРОВАТЬ ПО
	|	ОтражениеДокументовВРеглУчете.Организация,
	|	ОтражениеДокументовВРеглУчете.Регистратор
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Организация,
	|	Регистратор";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область Результат
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	""Себестоимость"" КАК РазделУчета,
	|	ВТ_СверкаОборотов.Организация КАК Организация,
	|	ВТ_СверкаОборотов.Аналитика1 КАК Аналитика1,
	|	ВТ_СверкаОборотов.Аналитика2 КАК Аналитика2,
	|	ВТ_СверкаОборотов.Подразделение КАК Подразделение,
	|	ВТ_СверкаОборотов.СчетБУ КАК СчетБУ,
	|	ВТ_СверкаОборотов.Регистратор КАК Регистратор,
	|	СУММА(ВТ_СверкаОборотов.Приход) КАК Приход,
	|	СУММА(ВТ_СверкаОборотов.Расход) КАК Расход,
	|	СУММА(ВТ_СверкаОборотов.ОборотДт) КАК ОборотДт,
	|	СУММА(ВТ_СверкаОборотов.ОборотКт) КАК ОборотКт,
	|	ВТ_СтатусыОтражения.Статус КАК Статус
	|ИЗ
	|	ВТ_СверкаОборотов КАК ВТ_СверкаОборотов
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_СтатусыОтражения КАК ВТ_СтатусыОтражения
	|		ПО ВТ_СверкаОборотов.Организация = ВТ_СтатусыОтражения.Организация
	|			И ВТ_СверкаОборотов.Регистратор = ВТ_СтатусыОтражения.Регистратор
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ_СверкаОборотов.Организация,
	|	ВТ_СверкаОборотов.Аналитика1,
	|	ВТ_СверкаОборотов.Аналитика2,
	|	ВТ_СверкаОборотов.Подразделение,
	|	ВТ_СверкаОборотов.СчетБУ,
	|	ВТ_СверкаОборотов.Регистратор,
	|	ВТ_СтатусыОтражения.Статус
	|
	|ИМЕЮЩИЕ
	|	НЕ(СУММА(ВТ_СверкаОборотов.Приход) = 0
	|			И СУММА(ВТ_СверкаОборотов.Расход) = 0
	|			И СУММА(ВТ_СверкаОборотов.ОборотДт) = 0
	|			И СУММА(ВТ_СверкаОборотов.ОборотКт) = 0)
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|УНИЧТОЖИТЬ ВТ_СтатусыОтражения
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|УНИЧТОЖИТЬ ВТ_СверкаОборотов";
	
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	ТекстЗапроса = СтрСоединить(МассивТекстовЗапроса, ОбщегоНазначения.РазделительПакетаЗапросов());
	
	Возврат ТекстЗапроса;

КонецФункции

Функция ТекстЗапросаДенежныеСредства()
	
	Возврат
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	Организации.Ссылка КАК Организация,
	|	Организации.ВалютаРегламентированногоУчета
	|ПОМЕСТИТЬ ВТВалютыРеглОрганизаций
	|ИЗ
	|	Справочник.Организации КАК Организации
	|ГДЕ
	|	Организации.Ссылка В (&МассивОрганизаций)
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ДенежныеСредстваБезналичныеОстаткиИОбороты.Организация КАК Организация,
	|	БанковскиеСчетаОрганизаций.Подразделение,
	|	БанковскиеСчетаОрганизаций.Ссылка КАК Аналитика1,
	|	ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)) КАК СчетУчета,
	|	БанковскиеСчетаОрганизаций.ВалютаДенежныхСредств КАК Валюта,
	|	ДенежныеСредстваБезналичныеОстаткиИОбороты.СуммаРеглНачальныйОстаток КАК НачальныйОстаток,
	|	ДенежныеСредстваБезналичныеОстаткиИОбороты.СуммаРеглПриход КАК Приход,
	|	ДенежныеСредстваБезналичныеОстаткиИОбороты.СуммаРеглРасход КАК Расход,
	|	ДенежныеСредстваБезналичныеОстаткиИОбороты.СуммаРеглКонечныйОстаток КАК КонечныйОстаток,
	|	0 КАК НачальноеСальдо,
	|	0 КАК ОборотДт,
	|	0 КАК ОборотКт,
	|	0 КАК КонечноеСальдо
	|ПОМЕСТИТЬ ВТ_ДенежныеСредстваИсходныеДанные
	|ИЗ
	|	РегистрНакопления.ДенежныеСредстваБезналичные.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, , , Организация В (&МассивОрганизаций)) КАК ДенежныеСредстваБезналичныеОстаткиИОбороты
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.БанковскиеСчетаОрганизаций КАК БанковскиеСчетаОрганизаций
	|		ПО ДенежныеСредстваБезналичныеОстаткиИОбороты.БанковскийСчет = БанковскиеСчетаОрганизаций.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоАналитике
	|	ПО 
	|		НастройкиПоАналитике.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ДенежныеСредства)
	|		И НастройкиПоАналитике.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|		И НастройкиПоАналитике.АналитикаУчета = БанковскиеСчетаОрганизаций.Ссылка
	|		И НастройкиПоАналитике.МестоУчета = НЕОПРЕДЕЛЕНО
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ДенежныеСредстваНаличныеОстаткиИОбороты.Организация КАК Организация,
	|	Кассы.Подразделение,
	|	NULL,
	|	ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)),
	|	Кассы.ВалютаДенежныхСредств,
	|	ДенежныеСредстваНаличныеОстаткиИОбороты.СуммаРеглНачальныйОстаток,
	|	ДенежныеСредстваНаличныеОстаткиИОбороты.СуммаРеглПриход,
	|	ДенежныеСредстваНаличныеОстаткиИОбороты.СуммаРеглРасход,
	|	ДенежныеСредстваНаличныеОстаткиИОбороты.СуммаРеглКонечныйОстаток,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	РегистрНакопления.ДенежныеСредстваНаличные.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, , , Организация В (&МассивОрганизаций)) КАК ДенежныеСредстваНаличныеОстаткиИОбороты
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Кассы КАК Кассы
	|		ПО ДенежныеСредстваНаличныеОстаткиИОбороты.Касса = Кассы.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоАналитике
	|	ПО 
	|		НастройкиПоАналитике.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ДенежныеСредства)
	|		И НастройкиПоАналитике.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|		И НастройкиПоАналитике.АналитикаУчета = Кассы.Ссылка
	|		И НастройкиПоАналитике.МестоУчета = НЕОПРЕДЕЛЕНО
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ДенежныеСредстваВКассахККМОстаткиИОбороты.Организация,
	|	КассыККМ.Подразделение,
	|	NULL,
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОперационнаяКасса),
	|	КассыККМ.ВалютаДенежныхСредств,
	|	ДенежныеСредстваВКассахККМОстаткиИОбороты.СуммаРеглНачальныйОстаток,
	|	ДенежныеСредстваВКассахККМОстаткиИОбороты.СуммаРеглПриход,
	|	ДенежныеСредстваВКассахККМОстаткиИОбороты.СуммаРеглРасход,
	|	ДенежныеСредстваВКассахККМОстаткиИОбороты.СуммаРеглКонечныйОстаток,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	РегистрНакопления.ДенежныеСредстваВКассахККМ.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, , , Организация В (&МассивОрганизаций)) КАК ДенежныеСредстваВКассахККМОстаткиИОбороты
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.КассыККМ КАК КассыККМ
	|		ПО ДенежныеСредстваВКассахККМОстаткиИОбороты.КассаККМ = КассыККМ.Ссылка
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ДенежныеСредстваУПодотчетныхЛицОстаткиИОбороты.Организация,
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка),
	|	ДенежныеСредстваУПодотчетныхЛицОстаткиИОбороты.ПодотчетноеЛицо,
	|	ВЫБОР
	|		КОГДА ДенежныеСредстваУПодотчетныхЛицОстаткиИОбороты.Валюта = ВТВалютыРеглОрганизаций.ВалютаРегламентированногоУчета
	|			ТОГДА ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПодотчетнымиЛицами)
	|		ИНАЧЕ ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПодотчетнымиЛицамиВал)
	|	КОНЕЦ,
	|	ДенежныеСредстваУПодотчетныхЛицОстаткиИОбороты.Валюта,
	|	ДенежныеСредстваУПодотчетныхЛицОстаткиИОбороты.СуммаРеглНачальныйОстаток,
	|	ДенежныеСредстваУПодотчетныхЛицОстаткиИОбороты.СуммаРеглПриход,
	|	ДенежныеСредстваУПодотчетныхЛицОстаткиИОбороты.СуммаРеглРасход,
	|	ДенежныеСредстваУПодотчетныхЛицОстаткиИОбороты.СуммаРеглКонечныйОстаток,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	РегистрНакопления.ДенежныеСредстваУПодотчетныхЛиц.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, , , Организация В (&МассивОрганизаций)) КАК ДенежныеСредстваУПодотчетныхЛицОстаткиИОбороты
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТВалютыРеглОрганизаций КАК ВТВалютыРеглОрганизаций
	|		ПО ДенежныеСредстваУПодотчетныхЛицОстаткиИОбороты.Организация = ВТВалютыРеглОрганизаций.Организация
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ДенежныеДокументыОстаткиИОбороты.Организация,
	|	ДенежныеДокументыОстаткиИОбороты.Подразделение,
	|	ДенежныеДокументыОстаткиИОбороты.ДенежныйДокумент,
	|	ВЫБОР
	|		КОГДА ДенежныеДокументы.Валюта = ВТВалютыРеглОрганизаций.ВалютаРегламентированногоУчета
	|			ТОГДА ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДенежныеДокументы)
	|		ИНАЧЕ ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДенежныеДокументыВал)
	|	КОНЕЦ,
	|	ДенежныеДокументы.Валюта,
	|	ДенежныеДокументыОстаткиИОбороты.СуммаРеглНачальныйОстаток,
	|	ДенежныеДокументыОстаткиИОбороты.СуммаРеглПриход,
	|	ДенежныеДокументыОстаткиИОбороты.СуммаРеглРасход,
	|	ДенежныеДокументыОстаткиИОбороты.СуммаРеглКонечныйОстаток,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	РегистрНакопления.ДенежныеДокументы.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, , , Организация В (&МассивОрганизаций)) КАК ДенежныеДокументыОстаткиИОбороты
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ДенежныеДокументы КАК ДенежныеДокументы
	|		ПО ДенежныеДокументыОстаткиИОбороты.ДенежныйДокумент = ДенежныеДокументы.Ссылка
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТВалютыРеглОрганизаций КАК ВТВалютыРеглОрганизаций
	|		ПО ДенежныеДокументыОстаткиИОбороты.Организация = ВТВалютыРеглОрганизаций.Организация
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ДенежныеСредстваВПутиОстаткиИОбороты.Организация,
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка),
	|	ВЫБОР
	|		КОГДА ДенежныеСредстваВПутиОстаткиИОбороты.ВидПереводаДенежныхСредств = ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.ПоступлениеОтБанкаПоЭквайрингу)
	|			ТОГДА ДенежныеСредстваВПутиОстаткиИОбороты.Договор
	|		ИНАЧЕ NULL
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ДенежныеСредстваВПутиОстаткиИОбороты.ВидПереводаДенежныхСредств В (ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.ИнкассацияВБанк), ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.ПеречислениеНаДругойСчет), ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.ИнкассацияИзБанка), ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.ПеремещениеВДругуюКассу))
	|				И ДенежныеСредстваВПутиОстаткиИОбороты.Валюта = ВТВалютыРеглОрганизаций.ВалютаРегламентированногоУчета
	|			ТОГДА ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереводыВПути)
	|		КОГДА ДенежныеСредстваВПутиОстаткиИОбороты.ВидПереводаДенежныхСредств В (ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.ИнкассацияВБанк), ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.ПеречислениеНаДругойСчет), ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.ИнкассацияИзБанка), ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.ПеремещениеВДругуюКассу))
	|				И ДенежныеСредстваВПутиОстаткиИОбороты.Валюта <> ВТВалютыРеглОрганизаций.ВалютаРегламентированногоУчета
	|			ТОГДА ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереводыВПутиВал)
	|		КОГДА ДенежныеСредстваВПутиОстаткиИОбороты.ВидПереводаДенежныхСредств = ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.ПриобретениеВалюты)
	|			ТОГДА ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПриобретениеИностраннойВалюты)
	|		КОГДА ДенежныеСредстваВПутиОстаткиИОбороты.ВидПереводаДенежныхСредств = ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.РеализацияВалюты)
	|			ТОГДА ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РеализацияИностраннойВалюты)
	|		КОГДА ДенежныеСредстваВПутиОстаткиИОбороты.ВидПереводаДенежныхСредств = ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.ПоступлениеОтБанкаПоЭквайрингу)
	|			ТОГДА ЕСТЬNULL(НастройкиИсключений.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)))
	|	КОНЕЦ,
	|	ДенежныеСредстваВПутиОстаткиИОбороты.Валюта,
	|	ДенежныеСредстваВПутиОстаткиИОбороты.СуммаРеглНачальныйОстаток,
	|	ДенежныеСредстваВПутиОстаткиИОбороты.СуммаРеглПриход,
	|	ДенежныеСредстваВПутиОстаткиИОбороты.СуммаРеглРасход,
	|	ДенежныеСредстваВПутиОстаткиИОбороты.СуммаРеглКонечныйОстаток,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	РегистрНакопления.ДенежныеСредстваВПути.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, , , Организация В (&МассивОрганизаций)) КАК ДенежныеСредстваВПутиОстаткиИОбороты
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТВалютыРеглОрганизаций КАК ВТВалютыРеглОрганизаций
	|		ПО ДенежныеСредстваВПутиОстаткиИОбороты.Организация = ВТВалютыРеглОрганизаций.Организация
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоАналитике
	|	ПО 
	|		ДенежныеСредстваВПутиОстаткиИОбороты.ВидПереводаДенежныхСредств = ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.ПоступлениеОтБанкаПоЭквайрингу)
	|		И НастройкиПоАналитике.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПродажиПоЭквайрингу)
	|		И НастройкиПоАналитике.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|		И НастройкиПоАналитике.АналитикаУчета = ДенежныеСредстваВПутиОстаткиИОбороты.Договор
	|		И НастройкиПоАналитике.МестоУчета = НЕОПРЕДЕЛЕНО
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиИсключений
	|	ПО 
	|		ДенежныеСредстваВПутиОстаткиИОбороты.ВидПереводаДенежныхСредств = ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.ПоступлениеОтБанкаПоЭквайрингу)
	|		И ДенежныеСредстваВПутиОстаткиИОбороты.Договор = ЗНАЧЕНИЕ(Справочник.ДоговорыЭквайринга.ПустаяСсылка)
	|		И НастройкиИсключений.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПродажиПоЭквайрингу)
	|		И НастройкиИсключений.Организация = ДенежныеСредстваВПутиОстаткиИОбороты.Организация
	|		И НастройкиИсключений.АналитикаУчета = ДенежныеСредстваВПутиОстаткиИОбороты.Договор
	|		И НастройкиИсключений.МестоУчета = НЕОПРЕДЕЛЕНО
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ 
	|	ХозрасчетныйОстаткиИОбороты.Организация,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОстаткиИОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереводыВПути_))
	|		ТОГДА ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)
	|		ИНАЧЕ ХозрасчетныйОстаткиИОбороты.Подразделение
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ТИПЗНАЧЕНИЯ(ХозрасчетныйОстаткиИОбороты.Субконто1) = ТИП(Справочник.БанковскиеСчетаКонтрагентов)
	|			ИЛИ ТИПЗНАЧЕНИЯ(ХозрасчетныйОстаткиИОбороты.Субконто1) = ТИП(Справочник.БанковскиеСчетаОрганизаций)
	|			ИЛИ ТИПЗНАЧЕНИЯ(ХозрасчетныйОстаткиИОбороты.Субконто1) = ТИП(Справочник.ФизическиеЛица)
	|			ИЛИ ТИПЗНАЧЕНИЯ(ХозрасчетныйОстаткиИОбороты.Субконто1) = ТИП(Справочник.ДенежныеДокументы)
	|		ТОГДА ХозрасчетныйОстаткиИОбороты.Субконто1
	|		КОГДА ТИПЗНАЧЕНИЯ(ХозрасчетныйОстаткиИОбороты.Субконто2) = ТИП(Справочник.ДоговорыЭквайринга)
	|		ТОГДА ХозрасчетныйОстаткиИОбороты.Субконто2
	|		ИНАЧЕ NULL
	|	КОНЕЦ,
	|	ЕСТЬNULL(ДолгосрочныеКакКраткосрочные.СчетУчетаКраткосрочный, ХозрасчетныйОстаткиИОбороты.Счет),
	|	ЕСТЬNULL(ХозрасчетныйОстаткиИОбороты.Валюта, ВТВалютыРеглОрганизаций.ВалютаРегламентированногоУчета),
	|	0,
	|	0,
	|	0,
	|	0,
	|	ХозрасчетныйОстаткиИОбороты.СуммаНачальныйОстаток,
	|	ХозрасчетныйОстаткиИОбороты.СуммаОборотДт,
	|	ХозрасчетныйОстаткиИОбороты.СуммаОборотКт,
	|	ХозрасчетныйОстаткиИОбороты.СуммаКонечныйОстаток
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, , , Счет В ИЕРАРХИИ (
	|		ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Касса),
	|		ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетныеСчета),
	|		ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВалютныеСчета),
	|		ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СпециальныеСчета),
	|		ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереводыВПути_),
	|		ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПодотчетнымиЛицами_)), , Организация В (&МассивОрганизаций)
	|		И ТИПЗНАЧЕНИЯ(Субконто1) <> ТИП(Справочник.ДоговорыКредитовИДепозитов)) КАК ХозрасчетныйОстаткиИОбороты
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТВалютыРеглОрганизаций КАК ВТВалютыРеглОрганизаций
	|		ПО ХозрасчетныйОстаткиИОбороты.Организация = ВТВалютыРеглОрганизаций.Организация
	|	ЛЕВОЕ СОЕДИНЕНИЕ ВТДолгосрочныеКакКраткосрочные КАК ДолгосрочныеКакКраткосрочные
	|		ПО ХозрасчетныйОстаткиИОбороты.Счет = ДолгосрочныеКакКраткосрочные.СчетУчетаДолгосрочный
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	""ДенежныеСредства"" КАК РазделУчета,
	|	ВТ_ДенежныеСредстваИсходныеДанные.Организация,
	|	ВТ_ДенежныеСредстваИсходныеДанные.Подразделение,
	|	ВТ_ДенежныеСредстваИсходныеДанные.Аналитика1,
	|	ВТ_ДенежныеСредстваИсходныеДанные.СчетУчета КАК СчетБУ,
	|	ВТ_ДенежныеСредстваИсходныеДанные.Валюта,
	|	СУММА(ВТ_ДенежныеСредстваИсходныеДанные.НачальныйОстаток) КАК НачальныйОстаток,
	|	СУММА(ВТ_ДенежныеСредстваИсходныеДанные.Приход) КАК Приход,
	|	СУММА(ВТ_ДенежныеСредстваИсходныеДанные.Расход) КАК Расход,
	|	СУММА(ВТ_ДенежныеСредстваИсходныеДанные.КонечныйОстаток) КАК КонечныйОстаток,
	|	СУММА(ВТ_ДенежныеСредстваИсходныеДанные.НачальноеСальдо) КАК НачальноеСальдо,
	|	СУММА(ВТ_ДенежныеСредстваИсходныеДанные.ОборотДт) КАК ОборотДт,
	|	СУММА(ВТ_ДенежныеСредстваИсходныеДанные.ОборотКт) КАК ОборотКт,
	|	СУММА(ВТ_ДенежныеСредстваИсходныеДанные.КонечноеСальдо) КАК КонечноеСальдо
	|ИЗ
	|	ВТ_ДенежныеСредстваИсходныеДанные КАК ВТ_ДенежныеСредстваИсходныеДанные
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ_ДенежныеСредстваИсходныеДанные.Организация,
	|	ВТ_ДенежныеСредстваИсходныеДанные.Подразделение,
	|	ВТ_ДенежныеСредстваИсходныеДанные.Аналитика1,
	|	ВТ_ДенежныеСредстваИсходныеДанные.СчетУчета,
	|	ВТ_ДенежныеСредстваИсходныеДанные.Валюта;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|УНИЧТОЖИТЬ ВТВалютыРеглОрганизаций";
	
КонецФункции

Функция ТекстЗапросаДенежныеСредстваПоРегистраторам()
	
	Возврат
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	Организации.Ссылка КАК Организация,
	|	Организации.ВалютаРегламентированногоУчета
	|ПОМЕСТИТЬ ВТВалютыРеглОрганизаций
	|ИЗ
	|	Справочник.Организации КАК Организации
	|ГДЕ
	|	Организации.Ссылка В (&МассивОрганизаций)
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ДенежныеСредстваБезналичныеОстаткиИОбороты.Организация КАК Организация,
	|	БанковскиеСчетаОрганизаций.Подразделение,
	|	БанковскиеСчетаОрганизаций.Ссылка КАК Аналитика1,
	|	ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)) КАК СчетУчета,
	|	БанковскиеСчетаОрганизаций.ВалютаДенежныхСредств КАК Валюта,
	|	ДенежныеСредстваБезналичныеОстаткиИОбороты.Регистратор КАК Регистратор,
	|	ДенежныеСредстваБезналичныеОстаткиИОбороты.СуммаРеглПриход КАК Приход,
	|	ДенежныеСредстваБезналичныеОстаткиИОбороты.СуммаРеглРасход КАК Расход,
	|	0 КАК ОборотДт,
	|	0 КАК ОборотКт
	|ПОМЕСТИТЬ ВТ_ДенежныеСредстваИсходныеДанные
	|ИЗ
	|	РегистрНакопления.ДенежныеСредстваБезналичные.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, Регистратор, Движения, Организация В (&МассивОрганизаций)) КАК ДенежныеСредстваБезналичныеОстаткиИОбороты
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.БанковскиеСчетаОрганизаций КАК БанковскиеСчетаОрганизаций
	|		ПО ДенежныеСредстваБезналичныеОстаткиИОбороты.БанковскийСчет = БанковскиеСчетаОрганизаций.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоАналитике
	|	ПО 
	|		НастройкиПоАналитике.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ДенежныеСредства)
	|		И НастройкиПоАналитике.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|		И НастройкиПоАналитике.АналитикаУчета = БанковскиеСчетаОрганизаций.Ссылка
	|		И НастройкиПоАналитике.МестоУчета = НЕОПРЕДЕЛЕНО
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ДенежныеСредстваНаличныеОстаткиИОбороты.Организация КАК Организация,
	|	Кассы.Подразделение,
	|	NULL,
	|	ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)),
	|	Кассы.ВалютаДенежныхСредств,
	|	ДенежныеСредстваНаличныеОстаткиИОбороты.Регистратор,
	|	ДенежныеСредстваНаличныеОстаткиИОбороты.СуммаРеглПриход,
	|	ДенежныеСредстваНаличныеОстаткиИОбороты.СуммаРеглРасход,
	|	0,
	|	0
	|ИЗ
	|	РегистрНакопления.ДенежныеСредстваНаличные.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, Регистратор, Движения, Организация В (&МассивОрганизаций)) КАК ДенежныеСредстваНаличныеОстаткиИОбороты
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Кассы КАК Кассы
	|		ПО ДенежныеСредстваНаличныеОстаткиИОбороты.Касса = Кассы.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоАналитике
	|	ПО 
	|		НастройкиПоАналитике.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ДенежныеСредства)
	|		И НастройкиПоАналитике.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|		И НастройкиПоАналитике.АналитикаУчета = Кассы.Ссылка
	|		И НастройкиПоАналитике.МестоУчета = НЕОПРЕДЕЛЕНО
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ДенежныеСредстваВКассахККМОстаткиИОбороты.Организация,
	|	КассыККМ.Подразделение,
	|	NULL,
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОперационнаяКасса),
	|	КассыККМ.ВалютаДенежныхСредств,
	|	ДенежныеСредстваВКассахККМОстаткиИОбороты.Регистратор,
	|	ДенежныеСредстваВКассахККМОстаткиИОбороты.СуммаРеглПриход,
	|	ДенежныеСредстваВКассахККМОстаткиИОбороты.СуммаРеглРасход,
	|	0,
	|	0
	|ИЗ
	|	РегистрНакопления.ДенежныеСредстваВКассахККМ.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, Регистратор, Движения, Организация В (&МассивОрганизаций)) КАК ДенежныеСредстваВКассахККМОстаткиИОбороты
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.КассыККМ КАК КассыККМ
	|		ПО ДенежныеСредстваВКассахККМОстаткиИОбороты.КассаККМ = КассыККМ.Ссылка
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ДенежныеСредстваУПодотчетныхЛицОстаткиИОбороты.Организация,
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка),
	|	ДенежныеСредстваУПодотчетныхЛицОстаткиИОбороты.ПодотчетноеЛицо,
	|	ВЫБОР
	|		КОГДА ДенежныеСредстваУПодотчетныхЛицОстаткиИОбороты.Валюта = ВТВалютыРеглОрганизаций.ВалютаРегламентированногоУчета
	|			ТОГДА ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПодотчетнымиЛицами)
	|		ИНАЧЕ ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПодотчетнымиЛицамиВал)
	|	КОНЕЦ,
	|	ДенежныеСредстваУПодотчетныхЛицОстаткиИОбороты.Валюта,
	|	ДенежныеСредстваУПодотчетныхЛицОстаткиИОбороты.Регистратор,
	|	ДенежныеСредстваУПодотчетныхЛицОстаткиИОбороты.СуммаРеглПриход,
	|	ДенежныеСредстваУПодотчетныхЛицОстаткиИОбороты.СуммаРеглРасход,
	|	0,
	|	0
	|ИЗ
	|	РегистрНакопления.ДенежныеСредстваУПодотчетныхЛиц.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, Регистратор, Движения, Организация В (&МассивОрганизаций)) КАК ДенежныеСредстваУПодотчетныхЛицОстаткиИОбороты
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТВалютыРеглОрганизаций КАК ВТВалютыРеглОрганизаций
	|		ПО ДенежныеСредстваУПодотчетныхЛицОстаткиИОбороты.Организация = ВТВалютыРеглОрганизаций.Организация
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ДенежныеДокументыОстаткиИОбороты.Организация,
	|	ДенежныеДокументыОстаткиИОбороты.Подразделение,
	|	ДенежныеДокументыОстаткиИОбороты.ДенежныйДокумент,
	|	ВЫБОР
	|		КОГДА ДенежныеДокументы.Валюта = ВТВалютыРеглОрганизаций.ВалютаРегламентированногоУчета
	|			ТОГДА ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДенежныеДокументы)
	|		ИНАЧЕ ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДенежныеДокументыВал)
	|	КОНЕЦ,
	|	ДенежныеДокументы.Валюта,
	|	ДенежныеДокументыОстаткиИОбороты.Регистратор,
	|	ДенежныеДокументыОстаткиИОбороты.СуммаРеглПриход,
	|	ДенежныеДокументыОстаткиИОбороты.СуммаРеглРасход,
	|	0,
	|	0
	|ИЗ
	|	РегистрНакопления.ДенежныеДокументы.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, Регистратор, Движения, Организация В (&МассивОрганизаций)) КАК ДенежныеДокументыОстаткиИОбороты
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ДенежныеДокументы КАК ДенежныеДокументы
	|		ПО ДенежныеДокументыОстаткиИОбороты.ДенежныйДокумент = ДенежныеДокументы.Ссылка
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТВалютыРеглОрганизаций КАК ВТВалютыРеглОрганизаций
	|		ПО ДенежныеДокументыОстаткиИОбороты.Организация = ВТВалютыРеглОрганизаций.Организация
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ДенежныеСредстваВПутиОстаткиИОбороты.Организация,
	|	НЕОПРЕДЕЛЕНО,
	|	ВЫБОР
	|		КОГДА ДенежныеСредстваВПутиОстаткиИОбороты.ВидПереводаДенежныхСредств = ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.ПоступлениеОтБанкаПоЭквайрингу)
	|			ТОГДА ДенежныеСредстваВПутиОстаткиИОбороты.Договор
	|		ИНАЧЕ NULL
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ДенежныеСредстваВПутиОстаткиИОбороты.ВидПереводаДенежныхСредств В (ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.ИнкассацияВБанк), ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.ПеречислениеНаДругойСчет), ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.ИнкассацияИзБанка), ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.ПеремещениеВДругуюКассу))
	|				И ДенежныеСредстваВПутиОстаткиИОбороты.Валюта = ВТВалютыРеглОрганизаций.ВалютаРегламентированногоУчета
	|			ТОГДА ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереводыВПути)
	|		КОГДА ДенежныеСредстваВПутиОстаткиИОбороты.ВидПереводаДенежныхСредств В (ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.ИнкассацияВБанк), ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.ПеречислениеНаДругойСчет), ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.ИнкассацияИзБанка), ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.ПеремещениеВДругуюКассу))
	|				И ДенежныеСредстваВПутиОстаткиИОбороты.Валюта <> ВТВалютыРеглОрганизаций.ВалютаРегламентированногоУчета
	|			ТОГДА ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереводыВПутиВал)
	|		КОГДА ДенежныеСредстваВПутиОстаткиИОбороты.ВидПереводаДенежныхСредств = ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.ПриобретениеВалюты)
	|			ТОГДА ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПриобретениеИностраннойВалюты)
	|		КОГДА ДенежныеСредстваВПутиОстаткиИОбороты.ВидПереводаДенежныхСредств = ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.РеализацияВалюты)
	|			ТОГДА ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РеализацияИностраннойВалюты)
	|		КОГДА ДенежныеСредстваВПутиОстаткиИОбороты.ВидПереводаДенежныхСредств = ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.ПоступлениеОтБанкаПоЭквайрингу)
	|			ТОГДА ЕСТЬNULL(НастройкиИсключений.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)))
	|	КОНЕЦ,
	|	ДенежныеСредстваВПутиОстаткиИОбороты.Валюта,
	|	ДенежныеСредстваВПутиОстаткиИОбороты.Регистратор,
	|	ДенежныеСредстваВПутиОстаткиИОбороты.СуммаРеглПриход,
	|	ДенежныеСредстваВПутиОстаткиИОбороты.СуммаРеглРасход,
	|	0,
	|	0
	|ИЗ
	|	РегистрНакопления.ДенежныеСредстваВПути.Обороты(&НачалоПериода, &КонецПериода, Регистратор, Организация В (&МассивОрганизаций)) КАК ДенежныеСредстваВПутиОстаткиИОбороты
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТВалютыРеглОрганизаций КАК ВТВалютыРеглОрганизаций
	|		ПО ДенежныеСредстваВПутиОстаткиИОбороты.Организация = ВТВалютыРеглОрганизаций.Организация
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоАналитике
	|	ПО 
	|		ДенежныеСредстваВПутиОстаткиИОбороты.ВидПереводаДенежныхСредств = ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.ПоступлениеОтБанкаПоЭквайрингу)
	|		И НастройкиПоАналитике.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПродажиПоЭквайрингу)
	|		И НастройкиПоАналитике.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|		И НастройкиПоАналитике.АналитикаУчета = ДенежныеСредстваВПутиОстаткиИОбороты.Договор
	|		И НастройкиПоАналитике.МестоУчета = НЕОПРЕДЕЛЕНО
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиИсключений
	|	ПО 
	|		ДенежныеСредстваВПутиОстаткиИОбороты.ВидПереводаДенежныхСредств = ЗНАЧЕНИЕ(Перечисление.ВидыПереводовДенежныхСредств.ПоступлениеОтБанкаПоЭквайрингу)
	|		И ДенежныеСредстваВПутиОстаткиИОбороты.Договор = ЗНАЧЕНИЕ(Справочник.ДоговорыЭквайринга.ПустаяСсылка)
	|		И НастройкиИсключений.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПродажиПоЭквайрингу)
	|		И НастройкиИсключений.Организация = ДенежныеСредстваВПутиОстаткиИОбороты.Организация
	|		И НастройкиИсключений.АналитикаУчета = ДенежныеСредстваВПутиОстаткиИОбороты.Договор
	|		И НастройкиИсключений.МестоУчета = НЕОПРЕДЕЛЕНО
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ХозрасчетныйОстаткиИОбороты.Организация,
	|	ВЫБОР
	|		КОГДА ХозрасчетныйОстаткиИОбороты.Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереводыВПути_))
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ХозрасчетныйОстаткиИОбороты.Подразделение
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ТИПЗНАЧЕНИЯ(ХозрасчетныйОстаткиИОбороты.Субконто1) = ТИП(Справочник.БанковскиеСчетаКонтрагентов)
	|			ИЛИ ТИПЗНАЧЕНИЯ(ХозрасчетныйОстаткиИОбороты.Субконто1) = ТИП(Справочник.БанковскиеСчетаОрганизаций)
	|			ИЛИ ТИПЗНАЧЕНИЯ(ХозрасчетныйОстаткиИОбороты.Субконто1) = ТИП(Справочник.ФизическиеЛица)
	|			ИЛИ ТИПЗНАЧЕНИЯ(ХозрасчетныйОстаткиИОбороты.Субконто1) = ТИП(Справочник.ДенежныеДокументы)
	|		ТОГДА ХозрасчетныйОстаткиИОбороты.Субконто1
	|		КОГДА ТИПЗНАЧЕНИЯ(ХозрасчетныйОстаткиИОбороты.Субконто2) = ТИП(Справочник.ДоговорыЭквайринга)
	|		ТОГДА ХозрасчетныйОстаткиИОбороты.Субконто2
	|		ИНАЧЕ NULL
	|	КОНЕЦ,
	|	ЕСТЬNULL(ДолгосрочныеКакКраткосрочные.СчетУчетаКраткосрочный, ХозрасчетныйОстаткиИОбороты.Счет),
	|	ЕСТЬNULL(ХозрасчетныйОстаткиИОбороты.Валюта, ВТВалютыРеглОрганизаций.ВалютаРегламентированногоУчета),
	|	ХозрасчетныйОстаткиИОбороты.Регистратор,
	|	0,
	|	0,
	|	ХозрасчетныйОстаткиИОбороты.СуммаОборотДт,
	|	ХозрасчетныйОстаткиИОбороты.СуммаОборотКт
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, Регистратор, Движения, Счет В ИЕРАРХИИ (
	|		ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Касса),
	|		ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетныеСчета),
	|		ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВалютныеСчета),
	|		ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СпециальныеСчета),
	|		ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПереводыВПути_),
	|		ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПодотчетнымиЛицами_)), , Организация В (&МассивОрганизаций)
	|		И ТИПЗНАЧЕНИЯ(Субконто1) <> ТИП(Справочник.ДоговорыКредитовИДепозитов)) КАК ХозрасчетныйОстаткиИОбороты
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТВалютыРеглОрганизаций КАК ВТВалютыРеглОрганизаций
	|		ПО ХозрасчетныйОстаткиИОбороты.Организация = ВТВалютыРеглОрганизаций.Организация
	|	ЛЕВОЕ СОЕДИНЕНИЕ ВТДолгосрочныеКакКраткосрочные КАК ДолгосрочныеКакКраткосрочные
	|		ПО ХозрасчетныйОстаткиИОбороты.Счет = ДолгосрочныеКакКраткосрочные.СчетУчетаДолгосрочный
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Организация,
	|	Регистратор
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	МАКСИМУМ(ОтражениеДокументовВРеглУчете.Статус) КАК Статус,
	|	ОтражениеДокументовВРеглУчете.Организация КАК Организация,
	|	ОтражениеДокументовВРеглУчете.Регистратор КАК Регистратор
	|ПОМЕСТИТЬ ВТ_СтатусыОтражения
	|ИЗ
	|	РегистрСведений.ОтражениеДокументовВРеглУчете КАК ОтражениеДокументовВРеглУчете
	|ГДЕ
	|	ОтражениеДокументовВРеглУчете.Регистратор В
	|			(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|				Т.Регистратор КАК Регистратор
	|			ИЗ
	|				ВТ_ДенежныеСредстваИсходныеДанные КАК Т)
	|
	|СГРУППИРОВАТЬ ПО
	|	ОтражениеДокументовВРеглУчете.Организация,
	|	ОтражениеДокументовВРеглУчете.Регистратор
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Организация,
	|	Регистратор
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	""ДенежныеСредства"" КАК РазделУчета,
	|	ВТ_ДенежныеСредстваИсходныеДанные.Организация КАК Организация,
	|	ВТ_ДенежныеСредстваИсходныеДанные.Подразделение,
	|	ВТ_ДенежныеСредстваИсходныеДанные.Аналитика1 КАК Аналитика1,
	|	ВТ_ДенежныеСредстваИсходныеДанные.СчетУчета КАК СчетБУ,
	|	ВТ_ДенежныеСредстваИсходныеДанные.Валюта КАК Валюта,
	|	ВТ_ДенежныеСредстваИсходныеДанные.Регистратор КАК Регистратор,
	|	СУММА(ВТ_ДенежныеСредстваИсходныеДанные.Приход) КАК Приход,
	|	СУММА(ВТ_ДенежныеСредстваИсходныеДанные.Расход) КАК Расход,
	|	СУММА(ВТ_ДенежныеСредстваИсходныеДанные.ОборотДт) КАК ОборотДт,
	|	СУММА(ВТ_ДенежныеСредстваИсходныеДанные.ОборотКт) КАК ОборотКт,
	|	ВТ_СтатусыОтражения.Статус КАК Статус
	|ИЗ
	|	ВТ_ДенежныеСредстваИсходныеДанные КАК ВТ_ДенежныеСредстваИсходныеДанные
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_СтатусыОтражения КАК ВТ_СтатусыОтражения
	|		ПО ВТ_ДенежныеСредстваИсходныеДанные.Организация = ВТ_СтатусыОтражения.Организация
	|			И ВТ_ДенежныеСредстваИсходныеДанные.Регистратор = ВТ_СтатусыОтражения.Регистратор
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ_ДенежныеСредстваИсходныеДанные.Организация,
	|	ВТ_ДенежныеСредстваИсходныеДанные.Подразделение,
	|	ВТ_ДенежныеСредстваИсходныеДанные.Аналитика1,
	|	ВТ_ДенежныеСредстваИсходныеДанные.СчетУчета,
	|	ВТ_ДенежныеСредстваИсходныеДанные.Валюта,
	|	ВТ_ДенежныеСредстваИсходныеДанные.Регистратор,
	|	ВТ_СтатусыОтражения.Статус
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|УНИЧТОЖИТЬ ВТ_СтатусыОтражения;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|УНИЧТОЖИТЬ ВТВалютыРеглОрганизаций";

КонецФункции

Функция ТекстЗапросаРасчетыСКонтрагентами()
	
	МассивТекстовЗапроса = Новый Массив;
	
	#Область РасчетыСПоставщиками
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ОбъектыРасчетов.Ссылка КАК ОбъектРасчетов,
	|	ОбъектыРасчетов.Организация КАК Организация,
	|	ОбъектыРасчетов.Подразделение КАК Подразделение,
	|	ОбъектыРасчетов.Контрагент КАК Контрагент,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	ОбъектыРасчетов.Объект ССЫЛКА Документ.ВозвратТоваровПоставщику ИЛИ ОбъектыРасчетов.Объект ССЫЛКА Документ.ВозвратТоваровМеждуОрганизациями КАК РасчетыПоПретензиям,
	|	РасчетыСПоставщиками.Долгосрочный КАК Долгосрочный,
	|	СУММА(РасчетыСПоставщиками.ДолгРеглНачальныйОстаток) КАК ДолгРеглНачальныйОстаток,
	|	СУММА(РасчетыСПоставщиками.ДолгРеглПриход) КАК ДолгРеглПриход,
	|	СУММА(РасчетыСПоставщиками.ДолгРеглРасход) КАК ДолгРеглРасход,
	|	СУММА(РасчетыСПоставщиками.ДолгРеглНачальныйОстаток + РасчетыСПоставщиками.ДолгРеглПриход - РасчетыСПоставщиками.ДолгРеглРасход) КАК ДолгРеглКонечныйОстаток,
	|	СУММА(РасчетыСПоставщиками.ПредоплатаРеглНачальныйОстаток) КАК ПредоплатаРеглНачальныйОстаток,
	|	СУММА(РасчетыСПоставщиками.ПредоплатаРеглПриход) КАК ПредоплатаРеглПриход,
	|	СУММА(РасчетыСПоставщиками.ПредоплатаРеглРасход) КАК ПредоплатаРеглРасход,
	|	СУММА(РасчетыСПоставщиками.ПредоплатаРеглНачальныйОстаток + РасчетыСПоставщиками.ПредоплатаРеглПриход - РасчетыСПоставщиками.ПредоплатаРеглРасход) КАК ПредоплатаРеглКонечныйОстаток
	|ПОМЕСТИТЬ ВТ_РасчетыСПоставщикамиРег
	|ИЗ
	|	(ВЫБРАТЬ
	|		РасчетыСПоставщикамиПоДокументам.ЗаказПоставщику КАК ОбъектРасчетов,
	|		ЛОЖЬ КАК Долгосрочный,
	|		РасчетыСПоставщикамиПоДокументам.Валюта КАК Валюта,
	|		ВЫБОР
	|			КОГДА РасчетыСПоставщикамиПоДокументам.ДолгРегл < 0
	|				ТОГДА 0
	|			ИНАЧЕ РасчетыСПоставщикамиПоДокументам.ДолгРегл
	|		КОНЕЦ КАК ДолгРеглПриход,
	|		ВЫБОР
	|			КОГДА РасчетыСПоставщикамиПоДокументам.ДолгРегл < 0
	|				ТОГДА -РасчетыСПоставщикамиПоДокументам.ДолгРегл
	|			ИНАЧЕ 0
	|		КОНЕЦ КАК ДолгРеглРасход,
	|		0 КАК ДолгРеглНачальныйОстаток,
	|		0 КАК ДолгРеглКонечныйОстаток,
	|		ВЫБОР
	|			КОГДА РасчетыСПоставщикамиПоДокументам.ПредоплатаРегл < 0
	|				ТОГДА 0
	|			ИНАЧЕ РасчетыСПоставщикамиПоДокументам.ПредоплатаРегл
	|		КОНЕЦ КАК ПредоплатаРеглПриход,
	|		ВЫБОР
	|			КОГДА РасчетыСПоставщикамиПоДокументам.ПредоплатаРегл < 0
	|				ТОГДА -РасчетыСПоставщикамиПоДокументам.ПредоплатаРегл
	|			ИНАЧЕ 0
	|		КОНЕЦ КАК ПредоплатаРеглРасход,
	|		0 КАК ПредоплатаРеглНачальныйОстаток,
	|		0 КАК ПредоплатаРеглКонечныйОстаток,
	|		РасчетыСПоставщикамиПоДокументам.ХозяйственнаяОперация КАК ХозяйственнаяОперация
	|	ИЗ
	|		РегистрНакопления.РасчетыСПоставщикамиПоДокументам КАК РасчетыСПоставщикамиПоДокументам
	|	ГДЕ
	|		РасчетыСПоставщикамиПоДокументам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|		И РасчетыСПоставщикамиПоДокументам.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И НЕ РасчетыСПоставщикамиПоДокументам.ХозяйственнаяОперация В (&ИсключаемыеХозОперацииПоАвансам)
	|		И РасчетыСПоставщикамиПоДокументам.Активность
	|		И НЕ &НоваяАрхитектураВзаиморасчетов
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		РасчетыСПоставщикамиПоДокументам.ЗаказПоставщику,
	|		ЛОЖЬ КАК Долгосрочный,
	|		РасчетыСПоставщикамиПоДокументам.Валюта,
	|		0,
	|		РасчетыСПоставщикамиПоДокументам.ДолгРегл,
	|		0,
	|		0,
	|		0,
	|		ВЫБОР
	|		КОГДА РасчетыСПоставщикамиПоДокументам.Регистратор <> РасчетыСПоставщикамиПоДокументам.РасчетныйДокумент
	|		ТОГДА РасчетыСПоставщикамиПоДокументам.ПредоплатаРегл
	|		ИНАЧЕ 0 КОНЕЦ,
	|		0,
	|		0,
	|		РасчетыСПоставщикамиПоДокументам.ХозяйственнаяОперация
	|	ИЗ
	|		РегистрНакопления.РасчетыСПоставщикамиПоДокументам КАК РасчетыСПоставщикамиПоДокументам
	|	ГДЕ
	|		РасчетыСПоставщикамиПоДокументам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И РасчетыСПоставщикамиПоДокументам.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И РасчетыСПоставщикамиПоДокументам.Активность
	|		И НЕ &НоваяАрхитектураВзаиморасчетов
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		РасчетыСПоставщикамиПоДокументам.ЗаказПоставщику,
	|		ЛОЖЬ КАК Долгосрочный,
	|		РасчетыСПоставщикамиПоДокументам.Валюта,
	|		РасчетыСПоставщикамиПоДокументам.ПредоплатаРегл,
	|		РасчетыСПоставщикамиПоДокументам.ПредоплатаРегл,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0,
	|		РасчетыСПоставщикамиПоДокументам.ХозяйственнаяОперация
	|	ИЗ
	|		РегистрНакопления.РасчетыСПоставщикамиПоДокументам КАК РасчетыСПоставщикамиПоДокументам
	|	ГДЕ
	|		НЕ(РасчетыСПоставщикамиПоДокументам.Регистратор ССЫЛКА Документ.КорректировкаПриобретения
	|					ИЛИ РасчетыСПоставщикамиПоДокументам.Регистратор ССЫЛКА Документ.ВзаимозачетЗадолженности)
	|		И РасчетыСПоставщикамиПоДокументам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И РасчетыСПоставщикамиПоДокументам.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И РасчетыСПоставщикамиПоДокументам.Регистратор = РасчетыСПоставщикамиПоДокументам.РасчетныйДокумент
	|		И РасчетыСПоставщикамиПоДокументам.Активность
	|		И РасчетыСПоставщикамиПоДокументам.ПредоплатаРегл <> 0
	|		И НЕ &НоваяАрхитектураВзаиморасчетов
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		РасчетыСПоставщикамиПоДокументам.ЗаказПоставщику,
	|		ЛОЖЬ КАК Долгосрочный,
	|		РасчетыСПоставщикамиПоДокументам.Валюта,
	|		0,
	|		0,
	|		ВЫБОР
	|			КОГДА &НачалоПериода = ДАТАВРЕМЯ(1, 1, 1)
	|				ТОГДА 0
	|			ИНАЧЕ РасчетыСПоставщикамиПоДокументам.ДолгРеглОстаток
	|		КОНЕЦ,
	|		0,
	|		0,
	|		0,
	|		ВЫБОР
	|			КОГДА &НачалоПериода = ДАТАВРЕМЯ(1, 1, 1)
	|				ТОГДА 0
	|			ИНАЧЕ РасчетыСПоставщикамиПоДокументам.ПредоплатаРеглОстаток
	|		КОНЕЦ,
	|		0,
	|		NULL
	|	ИЗ
	|		РегистрНакопления.РасчетыСПоставщикамиПоДокументам.Остатки(&НачалоПериода, ) КАК РасчетыСПоставщикамиПоДокументам
	|	ГДЕ
	|		НЕ &НоваяАрхитектураВзаиморасчетов
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		Расчеты.ОбъектРасчетов,
	|		РАЗНОСТЬДАТ(&НачалоПериода, Расчеты.ДатаПлановогоПогашения, МЕСЯЦ) >= ЕСТЬNULL(УчетнаяПолитикаОрганизаций.МесяцыДолгосрочнойЗадолженности, 999) КАК Долгосрочный,
	|		Расчеты.Валюта,
	|		0,
	|		0,
	|		-Расчеты.ДолгРеглОстаток,
	|		0,
	|		0,
	|		0,
	|		Расчеты.ПредоплатаРеглОстаток,
	|		0,
	|		NULL
	|	ИЗ
	|		РегистрНакопления.РасчетыСПоставщикамиПоСрокам.Остатки(&НачалоПериода) КАК Расчеты
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТУчетнаяПолитикаОрганизацийПоПериодам КАК УчетнаяПолитикаОрганизаций
	|		ПО Расчеты.АналитикаУчетаПоПартнерам.Организация = УчетнаяПолитикаОрганизаций.Организация
	|			И &НачалоПериода = УчетнаяПолитикаОрганизаций.НачалоДействия
	|			И УчетнаяПолитикаОрганизаций.ДолгосрочныеАктивыОбязательства
	|	ГДЕ
	|		&НоваяАрхитектураВзаиморасчетов
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		Расчеты.ОбъектРасчетов,
	|		РАЗНОСТЬДАТ(&КонецПериода, Расчеты.ДатаПлановогоПогашения, МЕСЯЦ) >= ЕСТЬNULL(УчетнаяПолитикаОрганизаций.МесяцыДолгосрочнойЗадолженности, 999) КАК Долгосрочный,
	|		Расчеты.Валюта,
	|		0,
	|		0,
	|		0,
	|		-Расчеты.ДолгРеглОстаток,
	|		0,
	|		0,
	|		0,
	|		Расчеты.ПредоплатаРеглОстаток,
	|		NULL
	|	ИЗ
	|		РегистрНакопления.РасчетыСПоставщикамиПоСрокам.Остатки(&КонецПериодаОстатков) КАК Расчеты
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТУчетнаяПолитикаОрганизацийПоПериодам КАК УчетнаяПолитикаОрганизаций
	|		ПО Расчеты.АналитикаУчетаПоПартнерам.Организация = УчетнаяПолитикаОрганизаций.Организация
	|			И &КонецПериода = УчетнаяПолитикаОрганизаций.ОкончаниеДействия
	|			И УчетнаяПолитикаОрганизаций.ДолгосрочныеАктивыОбязательства
	|	ГДЕ
	|		&НоваяАрхитектураВзаиморасчетов
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		Расчеты.ОбъектРасчетов,
	|		РАЗНОСТЬДАТ(Расчеты.Период, Расчеты.ДатаПлановогоПогашения, МЕСЯЦ) >= ЕСТЬNULL(УчетнаяПолитикаОрганизаций.МесяцыДолгосрочнойЗадолженности, 999) КАК Долгосрочный,
	|		Расчеты.Валюта,
	|		ВЫБОР
	|			КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|				ТОГДА Расчеты.ДолгРегл
	|			ИНАЧЕ
	|				0
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|				ТОГДА Расчеты.ДолгРегл
	|			ИНАЧЕ
	|				0
	|		КОНЕЦ,
	|		0,
	|		0,
	|		ВЫБОР
	|			КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|				И (НЕ Расчеты.ХозяйственнаяОперация В (&ИсключаемыеХозОперацииПоАвансам) ИЛИ Расчеты.ДокументРегистратор ССЫЛКА Документ.ВзаимозачетЗадолженности
	|					ИЛИ ВЫРАЗИТЬ(Расчеты.ОбъектРасчетов.Объект КАК Документ.ПоступлениеБезналичныхДенежныхСредств).ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДенежныхСредствОтПоставщика)
	|					ИЛИ ВЫРАЗИТЬ(Расчеты.ОбъектРасчетов.Объект КАК Документ.ПриходныйКассовыйОрдер).ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДенежныхСредствОтПоставщика))
	|				ТОГДА Расчеты.ПредоплатаРегл
	|			ИНАЧЕ
	|				0
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|				И (НЕ Расчеты.ХозяйственнаяОперация В (&ИсключаемыеХозОперацииПоАвансам) ИЛИ Расчеты.ДокументРегистратор ССЫЛКА Документ.ВзаимозачетЗадолженности
	|					ИЛИ ВЫРАЗИТЬ(Расчеты.ДокументРегистратор КАК Документ.ПоступлениеБезналичныхДенежныхСредств).ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДенежныхСредствОтПоставщика)
	|					ИЛИ ВЫРАЗИТЬ(Расчеты.ДокументРегистратор КАК Документ.ПриходныйКассовыйОрдер).ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДенежныхСредствОтПоставщика))
	|				ТОГДА Расчеты.ПредоплатаРегл
	|			ИНАЧЕ
	|				0
	|		КОНЕЦ,
	|		0,
	|		0,
	|		ВЫБОР 
	|			КОГДА ВЫРАЗИТЬ(Расчеты.ОбъектРасчетов.Объект КАК Документ.ПоступлениеБезналичныхДенежныхСредств).ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДенежныхСредствОтПоставщика)
	|					ИЛИ ВЫРАЗИТЬ(Расчеты.ОбъектРасчетов.Объект КАК Документ.ПриходныйКассовыйОрдер).ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДенежныхСредствОтПоставщика) 
	|				ТОГДА ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДенежныхСредствОтПоставщика)
	|			ИНАЧЕ
	|				Расчеты.ХозяйственнаяОперация
	|		КОНЕЦ
	|	ИЗ
	|		РегистрНакопления.РасчетыСПоставщикамиПоСрокам КАК Расчеты
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТУчетнаяПолитикаОрганизацийПоПериодам КАК УчетнаяПолитикаОрганизаций
	|		ПО Расчеты.АналитикаУчетаПоПартнерам.Организация = УчетнаяПолитикаОрганизаций.Организация
	|			И Расчеты.Период >= УчетнаяПолитикаОрганизаций.НачалоДействия
	|			И Расчеты.Период <= УчетнаяПолитикаОрганизаций.ОкончаниеДействия
	|			И УчетнаяПолитикаОрганизаций.ДолгосрочныеАктивыОбязательства
	|	ГДЕ
	|		Расчеты.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И Расчеты.Активность
	|		И &НоваяАрхитектураВзаиморасчетов
	|		И НЕ (Расчеты.ДокументРегистратор ССЫЛКА Документ.Бронирование И Расчеты.ОбъектРасчетов.ТипОбъектаРасчетов <> Значение(Перечисление.ТипыОбъектовРасчетов.Договор))
	|
	|	) КАК РасчетыСПоставщиками
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ОбъектыРасчетов КАК ОбъектыРасчетов
	|		ПО (ОбъектыРасчетов.Ссылка = РасчетыСПоставщиками.ОбъектРасчетов)
	|ГДЕ
	|	ОбъектыРасчетов.Организация В(&МассивОрганизаций)
	|
	|СГРУППИРОВАТЬ ПО
	|	ОбъектыРасчетов.Ссылка,
	|	ОбъектыРасчетов.Организация,
	|	ОбъектыРасчетов.Контрагент,
	|	РасчетыСПоставщиками.Долгосрочный,
	|	РасчетыСПоставщиками.ХозяйственнаяОперация,
	|	ОбъектыРасчетов.Подразделение,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета,
	|	ОбъектыРасчетов.Объект ССЫЛКА Документ.ВозвратТоваровПоставщику ИЛИ ОбъектыРасчетов.Объект ССЫЛКА Документ.ВозвратТоваровМеждуОрганизациями
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ОбъектыРасчетов.Ссылка,
	|	ДвиженияКонтрагентКонтрагент.Организация,
	|	ДвиженияКонтрагентКонтрагент.Подразделение,
	|	ДвиженияКонтрагентКонтрагент.Контрагент,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета,
	|	ОбъектыРасчетов.Объект ССЫЛКА Документ.ВозвратТоваровПоставщику ИЛИ ОбъектыРасчетов.Объект ССЫЛКА Документ.ВозвратТоваровМеждуОрганизациями,
	|	ЛОЖЬ,
	|	СУММА(0),
	|	СУММА(ВЫБОР
	|			КОГДА ДвиженияКонтрагентКонтрагент.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммЗадолженности.ДолгПоставщику)
	|				ТОГДА ДвиженияКонтрагентКонтрагент.СуммаРеглОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ),
	|	СУММА(ВЫБОР
	|			КОГДА ДвиженияКонтрагентКонтрагент.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммЗадолженности.ДолгПоставщику)
	|				ТОГДА ДвиженияКонтрагентКонтрагент.СуммаРеглОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ),
	|	СУММА(0),
	|	СУММА(0),
	|	СУММА(ВЫБОР
	|			КОГДА ДвиженияКонтрагентКонтрагент.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммЗадолженности.АвансВыданный)
	|				ТОГДА ДвиженияКонтрагентКонтрагент.СуммаРеглОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ),
	|	СУММА(ВЫБОР
	|			КОГДА ДвиженияКонтрагентКонтрагент.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммЗадолженности.АвансВыданный)
	|				ТОГДА ДвиженияКонтрагентКонтрагент.СуммаРеглОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ),
	|	СУММА(0)
	|ИЗ
	|	РегистрНакопления.ДвиженияКонтрагентКонтрагент.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			Регистратор,
	|			ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВзаимозачетЗадолженности)
	|				И ТипСуммы В (ЗНАЧЕНИЕ(Перечисление.ТипыСуммЗадолженности.АвансВыданный), ЗНАЧЕНИЕ(Перечисление.ТипыСуммЗадолженности.ДолгПоставщику))
	|				И Организация В (&МассивОрганизаций)) КАК ДвиженияКонтрагентКонтрагент
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ОбъектыРасчетов КАК ОбъектыРасчетов
	|		ПО (ОбъектыРасчетов.Ссылка = ДвиженияКонтрагентКонтрагент.ОбъектРасчетов)
	|ГДЕ
	|	ДвиженияКонтрагентКонтрагент.Организация <> ОбъектыРасчетов.Организация
	|	И НЕ &НоваяАрхитектураВзаиморасчетов
	|
	|СГРУППИРОВАТЬ ПО
	|	ДвиженияКонтрагентКонтрагент.ХозяйственнаяОперация,
	|	ДвиженияКонтрагентКонтрагент.Организация,
	|	ДвиженияКонтрагентКонтрагент.Контрагент,
	|	ДвиженияКонтрагентКонтрагент.Подразделение,
	|	ОбъектыРасчетов.Ссылка,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета,
	|	ОбъектыРасчетов.Объект ССЫЛКА Документ.ВозвратТоваровПоставщику ИЛИ ОбъектыРасчетов.Объект ССЫЛКА Документ.ВозвратТоваровМеждуОрганизациями";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область РасчетыСКлиентами
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ОбъектыРасчетов.Ссылка КАК ОбъектРасчетов,
	|	ОбъектыРасчетов.Организация КАК Организация,
	|	ОбъектыРасчетов.Подразделение КАК Подразделение,
	|	ОбъектыРасчетов.Контрагент КАК Контрагент,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	РасчетыСКлиентами.Долгосрочный КАК Долгосрочный,
	|	СУММА(РасчетыСКлиентами.ДолгРеглНачальныйОстаток) КАК ДолгРеглНачальныйОстаток,
	|	СУММА(РасчетыСКлиентами.ДолгРеглПриход) КАК ДолгРеглПриход,
	|	СУММА(РасчетыСКлиентами.ДолгРеглРасход) КАК ДолгРеглРасход,
	|	СУММА(РасчетыСКлиентами.ДолгРеглКонечныйОстаток) КАК ДолгРеглКонечныйОстаток,
	|	СУММА(РасчетыСКлиентами.ПредоплатаРеглНачальныйОстаток) КАК ПредоплатаРеглНачальныйОстаток,
	|	СУММА(РасчетыСКлиентами.ПредоплатаРеглПриход) КАК ПредоплатаРеглПриход,
	|	СУММА(РасчетыСКлиентами.ПредоплатаРеглРасход) КАК ПредоплатаРеглРасход,
	|	СУММА(РасчетыСКлиентами.ПредоплатаРеглКонечныйОстаток) КАК ПредоплатаРеглКонечныйОстаток
	|ПОМЕСТИТЬ ВТ_РасчетыСКлиентамиРег
	|ИЗ
	|	(ВЫБРАТЬ
	|		РасчетыСКлиентамиПоДокументам.ЗаказКлиента КАК ОбъектРасчетов,
	|		ЛОЖЬ КАК Долгосрочный,
	|		РасчетыСКлиентамиПоДокументам.Валюта КАК Валюта,
	|		РасчетыСКлиентамиПоДокументам.ДолгРегл КАК ДолгРеглПриход,
	|		0 КАК ДолгРеглРасход,
	|		0 КАК ДолгРеглНачальныйОстаток,
	|		0 КАК ДолгРеглКонечныйОстаток,
	|		ВЫБОР
	|		КОГДА РасчетыСКлиентамиПоДокументам.Регистратор <> РасчетыСКлиентамиПоДокументам.РасчетныйДокумент
	|		ТОГДА РасчетыСКлиентамиПоДокументам.ПредоплатаРегл
	|		ИНАЧЕ 0 КОНЕЦ КАК ПредоплатаРеглПриход,
	|		0 КАК ПредоплатаРеглРасход,
	|		0 КАК ПредоплатаРеглНачальныйОстаток,
	|		0 КАК ПредоплатаРеглКонечныйОстаток
	|	ИЗ
	|		РегистрНакопления.РасчетыСКлиентамиПоДокументам КАК РасчетыСКлиентамиПоДокументам
	|	ГДЕ
	|		РасчетыСКлиентамиПоДокументам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|		И РасчетыСКлиентамиПоДокументам.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И РасчетыСКлиентамиПоДокументам.Активность
	|		И НЕ &НоваяАрхитектураВзаиморасчетов
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		РасчетыСКлиентамиПоДокументам.ЗаказКлиента,
	|		ЛОЖЬ КАК Долгосрочный,
	|		РасчетыСКлиентамиПоДокументам.Валюта,
	|		ВЫБОР
	|			КОГДА РасчетыСКлиентамиПоДокументам.ДолгРегл < 0
	|				ТОГДА -РасчетыСКлиентамиПоДокументам.ДолгРегл
	|			ИНАЧЕ 0
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА РасчетыСКлиентамиПоДокументам.ДолгРегл < 0
	|				ТОГДА 0
	|			ИНАЧЕ РасчетыСКлиентамиПоДокументам.ДолгРегл
	|		КОНЕЦ,
	|		0,
	|		0,
	|		ВЫБОР
	|			КОГДА РасчетыСКлиентамиПоДокументам.ПредоплатаРегл < 0
	|				ТОГДА -РасчетыСКлиентамиПоДокументам.ПредоплатаРегл
	|			ИНАЧЕ 0
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА РасчетыСКлиентамиПоДокументам.ПредоплатаРегл < 0
	|				ТОГДА 0
	|			ИНАЧЕ РасчетыСКлиентамиПоДокументам.ПредоплатаРегл
	|		КОНЕЦ,
	|		0,
	|		0
	|	ИЗ
	|		РегистрНакопления.РасчетыСКлиентамиПоДокументам КАК РасчетыСКлиентамиПоДокументам
	|	ГДЕ
	|		НЕ(РасчетыСКлиентамиПоДокументам.Регистратор ССЫЛКА Документ.КорректировкаРеализации
	|					ИЛИ РасчетыСКлиентамиПоДокументам.Регистратор ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|					ИЛИ РасчетыСКлиентамиПоДокументам.Регистратор ССЫЛКА Документ.ВозвратТоваровМеждуОрганизациями)
	|		И РасчетыСКлиентамиПоДокументам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И РасчетыСКлиентамиПоДокументам.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И НЕ РасчетыСКлиентамиПоДокументам.ХозяйственнаяОперация В (&ИсключаемыеХозОперацииПоАвансам)
	|		И РасчетыСКлиентамиПоДокументам.Активность
	|		И НЕ &НоваяАрхитектураВзаиморасчетов
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		РасчетыСКлиентамиПоДокументам.ЗаказКлиента,
	|		ЛОЖЬ КАК Долгосрочный,
	|		РасчетыСКлиентамиПоДокументам.Валюта,
	|		РасчетыСКлиентамиПоДокументам.ПредоплатаРегл,
	|		РасчетыСКлиентамиПоДокументам.ПредоплатаРегл,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0
	|	ИЗ
	|		РегистрНакопления.РасчетыСКлиентамиПоДокументам КАК РасчетыСКлиентамиПоДокументам
	|	ГДЕ
	|		РасчетыСКлиентамиПоДокументам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|		И РасчетыСКлиентамиПоДокументам.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И РасчетыСКлиентамиПоДокументам.Регистратор = РасчетыСКлиентамиПоДокументам.РасчетныйДокумент
	|		И РасчетыСКлиентамиПоДокументам.Активность
	|		И РасчетыСКлиентамиПоДокументам.ПредоплатаРегл <> 0
	|		И НЕ &НоваяАрхитектураВзаиморасчетов
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		РасчетыСКлиентамиПоДокументам.ЗаказКлиента,
	|		ЛОЖЬ КАК Долгосрочный,
	|		РасчетыСКлиентамиПоДокументам.Валюта,
	|		-РасчетыСКлиентамиПоДокументам.ПредоплатаРегл - РасчетыСКлиентамиПоДокументам.ДолгРегл,
	|		0,
	|		0,
	|		0,
	|		-РасчетыСКлиентамиПоДокументам.ПредоплатаРегл,
	|		0,
	|		0,
	|		РасчетыСКлиентамиПоДокументам.ПредоплатаРегл
	|	ИЗ
	|		РегистрНакопления.РасчетыСКлиентамиПоДокументам КАК РасчетыСКлиентамиПоДокументам
	|	ГДЕ
	|		(РасчетыСКлиентамиПоДокументам.Регистратор ССЫЛКА Документ.КорректировкаРеализации
	|				ИЛИ РасчетыСКлиентамиПоДокументам.Регистратор ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|				ИЛИ РасчетыСКлиентамиПоДокументам.Регистратор ССЫЛКА Документ.ВозвратТоваровМеждуОрганизациями)
	|		И РасчетыСКлиентамиПоДокументам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И РасчетыСКлиентамиПоДокументам.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И РасчетыСКлиентамиПоДокументам.Активность
	|		И НЕ &НоваяАрхитектураВзаиморасчетов
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		РасчетыСКлиентамиПоДокументам.ЗаказКлиента,
	|		ЛОЖЬ КАК Долгосрочный,
	|		РасчетыСКлиентамиПоДокументам.Валюта,
	|		0,
	|		-РасчетыСКлиентамиПоДокументам.ПредоплатаРегл,
	|		0,
	|		-РасчетыСКлиентамиПоДокументам.ПредоплатаРегл,
	|		0,
	|		0,
	|		0,
	|		0
	|	ИЗ
	|		РегистрНакопления.РасчетыСКлиентамиПоДокументам КАК РасчетыСКлиентамиПоДокументам
	|	ГДЕ
	|		(РасчетыСКлиентамиПоДокументам.Регистратор ССЫЛКА Документ.КорректировкаРеализации
	|				ИЛИ РасчетыСКлиентамиПоДокументам.Регистратор ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|				ИЛИ РасчетыСКлиентамиПоДокументам.Регистратор ССЫЛКА Документ.ВозвратТоваровМеждуОрганизациями)
	|		И РасчетыСКлиентамиПоДокументам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И РасчетыСКлиентамиПоДокументам.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И РасчетыСКлиентамиПоДокументам.Активность
	|		И РасчетыСКлиентамиПоДокументам.ПредоплатаРегл <> 0
	|		И НЕ &НоваяАрхитектураВзаиморасчетов
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		РасчетыСКлиентамиПоДокументам.ЗаказКлиента,
	|		ЛОЖЬ КАК Долгосрочный,
	|		РасчетыСКлиентамиПоДокументам.Валюта,
	|		0,
	|		0,
	|		ВЫБОР
	|			КОГДА &НачалоПериода = ДАТАВРЕМЯ(1, 1, 1)
	|				ТОГДА 0
	|			ИНАЧЕ РасчетыСКлиентамиПоДокументам.ДолгРеглОстаток
	|		КОНЕЦ,
	|		0,
	|		0,
	|		0,
	|		ВЫБОР
	|			КОГДА &НачалоПериода = ДАТАВРЕМЯ(1, 1, 1)
	|				ТОГДА 0
	|			ИНАЧЕ РасчетыСКлиентамиПоДокументам.ПредоплатаРеглОстаток
	|		КОНЕЦ,
	|		0
	|	ИЗ
	|		РегистрНакопления.РасчетыСКлиентамиПоДокументам.Остатки(&НачалоПериода, ) КАК РасчетыСКлиентамиПоДокументам
	|	ГДЕ
	|		НЕ &НоваяАрхитектураВзаиморасчетов
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		РасчетыСКлиентамиПоДокументам.ЗаказКлиента,
	|		ЛОЖЬ КАК Долгосрочный,
	|		РасчетыСКлиентамиПоДокументам.Валюта,
	|		0,
	|		0,
	|		0,
	|		РасчетыСКлиентамиПоДокументам.ДолгРеглОстаток,
	|		0,
	|		0,
	|		0,
	|		РасчетыСКлиентамиПоДокументам.ПредоплатаРеглОстаток
	|	ИЗ
	|		РегистрНакопления.РасчетыСКлиентамиПоДокументам.Остатки(&КонецПериодаОстатков, ) КАК РасчетыСКлиентамиПоДокументам
	|	ГДЕ
	|		НЕ &НоваяАрхитектураВзаиморасчетов
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		Расчеты.ОбъектРасчетов,
	|		РАЗНОСТЬДАТ(&НачалоПериода, Расчеты.ДатаПлановогоПогашения, МЕСЯЦ) >= ЕСТЬNULL(УчетнаяПолитикаОрганизаций.МесяцыДолгосрочнойЗадолженности, 999) КАК Долгосрочный,
	|		Расчеты.Валюта,
	|		0,
	|		0,
	|		Расчеты.ДолгРеглОстаток,
	|		0,
	|		0,
	|		0,
	|		-Расчеты.ПредоплатаРеглОстаток,
	|		0
	|	ИЗ
	|		РегистрНакопления.РасчетыСКлиентамиПоСрокам.Остатки(&НачалоПериода) КАК Расчеты
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТУчетнаяПолитикаОрганизацийПоПериодам КАК УчетнаяПолитикаОрганизаций
	|		ПО Расчеты.АналитикаУчетаПоПартнерам.Организация = УчетнаяПолитикаОрганизаций.Организация
	|			И &НачалоПериода = УчетнаяПолитикаОрганизаций.НачалоДействия
	|			И УчетнаяПолитикаОрганизаций.ДолгосрочныеАктивыОбязательства
	|	ГДЕ
	|		&НоваяАрхитектураВзаиморасчетов
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		Расчеты.ОбъектРасчетов,
	|		РАЗНОСТЬДАТ(&КонецПериода, Расчеты.ДатаПлановогоПогашения, МЕСЯЦ) >= ЕСТЬNULL(УчетнаяПолитикаОрганизаций.МесяцыДолгосрочнойЗадолженности, 999) КАК Долгосрочный,
	|		Расчеты.Валюта,
	|		0,
	|		0,
	|		0,
	|		Расчеты.ДолгРеглОстаток,
	|		0,
	|		0,
	|		0,
	|		-Расчеты.ПредоплатаРеглОстаток
	|	ИЗ
	|		РегистрНакопления.РасчетыСКлиентамиПоСрокам.Остатки(&КонецПериодаОстатков) КАК Расчеты
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТУчетнаяПолитикаОрганизацийПоПериодам КАК УчетнаяПолитикаОрганизаций
	|		ПО Расчеты.АналитикаУчетаПоПартнерам.Организация = УчетнаяПолитикаОрганизаций.Организация
	|			И &КонецПериода = УчетнаяПолитикаОрганизаций.ОкончаниеДействия
	|			И УчетнаяПолитикаОрганизаций.ДолгосрочныеАктивыОбязательства
	|	ГДЕ
	|		&НоваяАрхитектураВзаиморасчетов
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		Расчеты.ОбъектРасчетов,
	|		РАЗНОСТЬДАТ(Расчеты.Период, Расчеты.ДатаПлановогоПогашения, МЕСЯЦ) >= ЕСТЬNULL(УчетнаяПолитикаОрганизаций.МесяцыДолгосрочнойЗадолженности, 999) КАК Долгосрочный,
	|		Расчеты.Валюта,
	|		ВЫБОР
	|			КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|				ТОГДА Расчеты.ДолгРегл
	|			ИНАЧЕ
	|				0
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|				ТОГДА Расчеты.ДолгРегл
	|			ИНАЧЕ
	|				0
	|		КОНЕЦ,
	|		0,
	|		0,
	|		ВЫБОР
	|			КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|				ТОГДА Расчеты.ПредоплатаРегл
	|			ИНАЧЕ
	|				0
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|				ТОГДА Расчеты.ПредоплатаРегл
	|			ИНАЧЕ
	|				0
	|		КОНЕЦ,
	|		0,
	|		0
	|	ИЗ
	|		РегистрНакопления.РасчетыСКлиентамиПоСрокам КАК Расчеты
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТУчетнаяПолитикаОрганизацийПоПериодам КАК УчетнаяПолитикаОрганизаций
	|		ПО Расчеты.АналитикаУчетаПоПартнерам.Организация = УчетнаяПолитикаОрганизаций.Организация
	|			И Расчеты.Период >= УчетнаяПолитикаОрганизаций.НачалоДействия
	|			И Расчеты.Период <= УчетнаяПолитикаОрганизаций.ОкончаниеДействия
	|			И УчетнаяПолитикаОрганизаций.ДолгосрочныеАктивыОбязательства
	|	ГДЕ
	|		Расчеты.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И Расчеты.Активность
	|		И &НоваяАрхитектураВзаиморасчетов) КАК РасчетыСКлиентами
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ОбъектыРасчетов КАК ОбъектыРасчетов
	|		ПО (ОбъектыРасчетов.Ссылка = РасчетыСКлиентами.ОбъектРасчетов)
	|ГДЕ
	|	ОбъектыРасчетов.Организация В (&МассивОрганизаций)
	|
	|СГРУППИРОВАТЬ ПО
	|	ОбъектыРасчетов.Ссылка,
	|	РасчетыСКлиентами.Долгосрочный,
	|	ОбъектыРасчетов.Организация,
	|	ОбъектыРасчетов.Подразделение,
	|	ОбъектыРасчетов.Контрагент,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ОбъектыРасчетов.Ссылка,
	|	ДвиженияКонтрагентКонтрагент.Организация,
	|	ДвиженияКонтрагентКонтрагент.Подразделение,
	|	ДвиженияКонтрагентКонтрагент.КорКонтрагент,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета,
	|	ЛОЖЬ,
	|	СУММА(0),
	|	СУММА(ВЫБОР
	|			КОГДА ДвиженияКонтрагентКонтрагент.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммЗадолженности.ДолгКлиента)
	|				ТОГДА ДвиженияКонтрагентКонтрагент.СуммаРеглОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ),
	|	СУММА(ВЫБОР
	|			КОГДА ДвиженияКонтрагентКонтрагент.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммЗадолженности.ДолгКлиента)
	|				ТОГДА ДвиженияКонтрагентКонтрагент.СуммаРеглОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ),
	|	СУММА(0),
	|	СУММА(0),
	|	СУММА(ВЫБОР
	|			КОГДА ДвиженияКонтрагентКонтрагент.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммЗадолженности.АвансПолученный)
	|				ТОГДА ДвиженияКонтрагентКонтрагент.СуммаРеглОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ),
	|	СУММА(ВЫБОР
	|			КОГДА ДвиженияКонтрагентКонтрагент.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммЗадолженности.АвансПолученный)
	|				ТОГДА ДвиженияКонтрагентКонтрагент.СуммаРеглОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ),
	|	СУММА(0)
	|ИЗ
	|	РегистрНакопления.ДвиженияКонтрагентКонтрагент.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВзаимозачетЗадолженности)
	|				И ТипСуммы В (ЗНАЧЕНИЕ(Перечисление.ТипыСуммЗадолженности.АвансПолученный), ЗНАЧЕНИЕ(Перечисление.ТипыСуммЗадолженности.ДолгКлиента))
	|				И Организация В (&МассивОрганизаций)) КАК ДвиженияКонтрагентКонтрагент
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ОбъектыРасчетов КАК ОбъектыРасчетов
	|		ПО (ОбъектыРасчетов.Ссылка = ДвиженияКонтрагентКонтрагент.ОбъектРасчетов)
	|ГДЕ
	|	ДвиженияКонтрагентКонтрагент.Организация <> ОбъектыРасчетов.Организация
	|	И НЕ &НоваяАрхитектураВзаиморасчетов
	|
	|СГРУППИРОВАТЬ ПО
	|	ОбъектыРасчетов.Ссылка,
	|	ДвиженияКонтрагентКонтрагент.Организация,
	|	ДвиженияКонтрагентКонтрагент.КорКонтрагент,
	|	ДвиженияКонтрагентКонтрагент.Подразделение,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область РасчетыПоКредитамДепозитам
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	КлючиАналитики.Организация КАК Организация,
	|	РасчетыПоКредитамДепозитам.Договор КАК Договор,
	|	РасчетыПоКредитамДепозитам.ТипСуммы КАК ТипСуммы,
	|	ЛОЖЬ КАК Долгосрочный,
	|	СУММА(РасчетыПоКредитамДепозитам.СуммаРеглНачальныйОстаток) КАК СуммаРеглНачальныйОстаток,
	|	СУММА(РасчетыПоКредитамДепозитам.СуммаРеглПриход) КАК СуммаРеглПриход,
	|	СУММА(РасчетыПоКредитамДепозитам.СуммаРеглРасход) КАК СуммаРеглРасход,
	|	СУММА(РасчетыПоКредитамДепозитам.СуммаРеглКонечныйОстаток) КАК СуммаРеглКонечныйОстаток
	|ПОМЕСТИТЬ ВТ_РасчетыПоКредитамДепозитамРег
	|ИЗ
	|	РегистрНакопления.РасчетыПоФинансовымИнструментам.ОстаткиИОбороты(&НачалоПериода, &КонецПериода,,,) КАК РасчетыПоКредитамДепозитам
	|		
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.КлючиАналитикиУчетаПоПартнерам КАК КлючиАналитики
	|		ПО (КлючиАналитики.Ссылка = РасчетыПоКредитамДепозитам.АналитикаУчетаПоПартнерам)
	|ГДЕ
	|	КлючиАналитики.Организация В(&МассивОрганизаций)
	|
	|СГРУППИРОВАТЬ ПО
	|	РасчетыПоКредитамДепозитам.ТипСуммы,
	|	РасчетыПоКредитамДепозитам.Договор,
	|	КлючиАналитики.Организация";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область РасчетыПоЛизингу
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	КлючиАналитики.Организация КАК Организация,
	|	КлючиАналитики.Контрагент КАК Контрагент,
	|	РасчетыПоЛизингу.ТипСуммы КАК ТипСуммы,
	|	ДанныеДоговора.Ссылка КАК Договор,
	|	ДанныеДоговора.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	ДанныеДоговора.Подразделение КАК Подразделение,
	|	ЛОЖЬ КАК Долгосрочный,
	|	СУММА(РасчетыПоЛизингу.СуммаРеглНачальныйОстаток) КАК СуммаРеглНачальныйОстаток,
	|	СУММА(РасчетыПоЛизингу.СуммаРеглПриход) КАК СуммаРеглПриход,
	|	СУММА(РасчетыПоЛизингу.СуммаРеглРасход) КАК СуммаРеглРасход,
	|	СУММА(РасчетыПоЛизингу.СуммаРеглКонечныйОстаток) КАК СуммаРеглКонечныйОстаток
	|ПОМЕСТИТЬ ВТ_РасчетыПоЛизингуРег
	|ИЗ
	|	РегистрНакопления.РасчетыПоФинансовымИнструментам.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, , , ) КАК РасчетыПоЛизингу
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.КлючиАналитикиУчетаПоПартнерам КАК КлючиАналитики
	|		ПО (КлючиАналитики.Ссылка = РасчетыПоЛизингу.АналитикаУчетаПоПартнерам)
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ДоговорыАренды КАК ДанныеДоговора
	|		ПО (ДанныеДоговора.Ссылка = РасчетыПоЛизингу.Договор)
	|ГДЕ
	|	КлючиАналитики.Организация В(&МассивОрганизаций)
	|
	|СГРУППИРОВАТЬ ПО
	|	ДанныеДоговора.ГруппаФинансовогоУчета,
	|	КлючиАналитики.Контрагент,
	|	РасчетыПоЛизингу.ТипСуммы,
	|	ДанныеДоговора.Ссылка,
	|	ДанныеДоговора.Подразделение,
	|	КлючиАналитики.Организация";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область НеотфактурованныеПоставки
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	НеотфактурованныеПоставки.Организация КАК Организация,
	|	АналитикаПартии.Контрагент КАК Контрагент,
	|	АналитикаПартии.Договор КАК Договор,
	|	ДанныеДоговора.НаправлениеДеятельности,
	|	ДанныеДоговора.Подразделение КАК Подразделение,
	|	ДанныеДоговора.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	ЛОЖЬ КАК Долгосрочный,
	|	СУММА(НеотфактурованныеПоставки.СтоимостьРеглНачальныйОстаток) КАК СтоимостьРеглНачальныйОстаток,
	|	СУММА(НеотфактурованныеПоставки.СтоимостьРеглПриход) КАК СтоимостьРеглПриход,
	|	СУММА(НеотфактурованныеПоставки.СтоимостьРеглРасход) КАК СтоимостьРеглРасход,
	|	СУММА(НеотфактурованныеПоставки.СтоимостьРеглКонечныйОстаток) КАК СтоимостьРеглКонечныйОстаток
	|ПОМЕСТИТЬ ВТ_НеотфактурованныеПоставкиРег
	|ИЗ
	|	РегистрНакопления.СебестоимостьТоваров.ОстаткиИОбороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			,
	|			Организация В (&МассивОрганизаций)
	|				И РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НеотфактурованныеПоставки)) КАК НеотфактурованныеПоставки
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ПоступлениеТоваровНаСклад КАК АналитикаПартии
	|		ПО (АналитикаПартии.Ссылка = НеотфактурованныеПоставки.Партия)
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ДоговорыКонтрагентов КАК ДанныеДоговора
	|		ПО (ДанныеДоговора.Ссылка = АналитикаПартии.Договор)
	|
	|СГРУППИРОВАТЬ ПО
	|	ДанныеДоговора.ГруппаФинансовогоУчета,
	|	ДанныеДоговора.НаправлениеДеятельности,
	|	АналитикаПартии.Контрагент,
	|	АналитикаПартии.Договор,
	|	НеотфактурованныеПоставки.Организация,
	|	ДанныеДоговора.Подразделение";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область РасчетыСПоставщикамиОУ
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ВТ_РасчетыСПоставщикамиРег.ОбъектРасчетов КАК ОбъектРасчетов,
	|	ВТ_РасчетыСПоставщикамиРег.Организация КАК Организация,
	|	ВТ_РасчетыСПоставщикамиРег.Контрагент КАК Контрагент,
	|	МАКСИМУМ(ВЫБОР
	|		КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО)) = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками)
	|		ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|		ИНАЧЕ &ПустойСчет
	|	КОНЕЦ) КАК СчетУчетаРасчетов,
	|	ВЫБОР
	|		КОГДА ВТ_РасчетыСПоставщикамиРег.РасчетыПоПретензиям
	|			ТОГДА МАКСИМУМ(ВЫБОР
	|					КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО)) = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками)
	|					ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|					ИНАЧЕ &ПустойСчет
	|				КОНЕЦ)
	|		ИНАЧЕ МАКСИМУМ(ВЫБОР
	|					КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО)) = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыВыданные)
	|					ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|					ИНАЧЕ &ПустойСчет
	|				КОНЕЦ)
	|	КОНЕЦ КАК СчетУчетаАванса,
	|	ВТ_РасчетыСПоставщикамиРег.Подразделение КАК Подразделение,
	|	ВТ_РасчетыСПоставщикамиРег.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	(ВТ_РасчетыСПоставщикамиРег.ДолгРеглНачальныйОстаток) КАК ДолгРеглНачальныйОстаток,
	|	(ВТ_РасчетыСПоставщикамиРег.ДолгРеглПриход) КАК ДолгРеглПриход,
	|	(ВТ_РасчетыСПоставщикамиРег.ДолгРеглРасход) КАК ДолгРеглРасход,
	|	(ВТ_РасчетыСПоставщикамиРег.ДолгРеглКонечныйОстаток) КАК ДолгРеглКонечныйОстаток,
	|	(ВТ_РасчетыСПоставщикамиРег.ПредоплатаРеглНачальныйОстаток) КАК ПредоплатаРеглНачальныйОстаток,
	|	(ВТ_РасчетыСПоставщикамиРег.ПредоплатаРеглПриход) КАК ПредоплатаРеглПриход,
	|	(ВТ_РасчетыСПоставщикамиРег.ПредоплатаРеглРасход) КАК ПредоплатаРеглРасход,
	|	(ВТ_РасчетыСПоставщикамиРег.ПредоплатаРеглКонечныйОстаток) КАК ПредоплатаРеглКонечныйОстаток
	|ПОМЕСТИТЬ ВТ_РасчетыСПоставщиками
	|ИЗ
	|	ВТ_РасчетыСПоставщикамиРег КАК ВТ_РасчетыСПоставщикамиРег
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоОрганизации
	|		ПО (НастройкиПоОрганизации.ВидСчета В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыВыданные)))
	|			И (НастройкиПоОрганизации.Организация = ВТ_РасчетыСПоставщикамиРег.Организация)
	|			И (НастройкиПоОрганизации.АналитикаУчета = ВТ_РасчетыСПоставщикамиРег.ГруппаФинансовогоУчета)
	|			И (НастройкиПоОрганизации.МестоУчета = НЕОПРЕДЕЛЕНО)
	|			И (НастройкиПоОрганизации.Долгосрочный = ВТ_РасчетыСПоставщикамиРег.Долгосрочный)
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоАналитике
	|		ПО (НастройкиПоАналитике.ВидСчета В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыВыданные)))
	|			И (НастройкиПоАналитике.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))
	|			И (НастройкиПоАналитике.АналитикаУчета = ВТ_РасчетыСПоставщикамиРег.ГруппаФинансовогоУчета)
	|			И (НастройкиПоАналитике.МестоУчета = НЕОПРЕДЕЛЕНО)
	|			И (НастройкиПоАналитике.Долгосрочный = ВТ_РасчетыСПоставщикамиРег.Долгосрочный)
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ_РасчетыСПоставщикамиРег.ОбъектРасчетов,
	|	ВТ_РасчетыСПоставщикамиРег.Организация,
	|	ВТ_РасчетыСПоставщикамиРег.РасчетыПоПретензиям,
	|	ВТ_РасчетыСПоставщикамиРег.Контрагент,
	|	ВТ_РасчетыСПоставщикамиРег.Подразделение,
	|	ВТ_РасчетыСПоставщикамиРег.ГруппаФинансовогоУчета,
	|	(ВТ_РасчетыСПоставщикамиРег.ДолгРеглНачальныйОстаток),
	|	(ВТ_РасчетыСПоставщикамиРег.ДолгРеглПриход),
	|	(ВТ_РасчетыСПоставщикамиРег.ДолгРеглРасход),
	|	(ВТ_РасчетыСПоставщикамиРег.ДолгРеглКонечныйОстаток),
	|	(ВТ_РасчетыСПоставщикамиРег.ПредоплатаРеглНачальныйОстаток),
	|	(ВТ_РасчетыСПоставщикамиРег.ПредоплатаРеглПриход),
	|	(ВТ_РасчетыСПоставщикамиРег.ПредоплатаРеглРасход),
	|	(ВТ_РасчетыСПоставщикамиРег.ПредоплатаРеглКонечныйОстаток)";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область РасчетыСКлиентамиОУ
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ВТ_РасчетыСКлиентамиРег.ОбъектРасчетов КАК ОбъектРасчетов,
	|	ВТ_РасчетыСКлиентамиРег.Организация КАК Организация,
	|	ВТ_РасчетыСКлиентамиРег.Контрагент КАК Контрагент,
	|	МАКСИМУМ(ВЫБОР
	|			КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО)) = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами)
	|				ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|			ИНАЧЕ &ПустойСчет
	|		КОНЕЦ) КАК СчетУчетаРасчетов,
	|	МАКСИМУМ(ВЫБОР
	|			КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО)) = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыПолученные)
	|				ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|			ИНАЧЕ &ПустойСчет
	|		КОНЕЦ) КАК СчетУчетаАванса,
	|	ВТ_РасчетыСКлиентамиРег.Подразделение КАК Подразделение,
	|	ВТ_РасчетыСКлиентамиРег.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	(ВТ_РасчетыСКлиентамиРег.ДолгРеглНачальныйОстаток) КАК ДолгРеглНачальныйОстаток,
	|	(ВТ_РасчетыСКлиентамиРег.ДолгРеглПриход) КАК ДолгРеглПриход,
	|	(ВТ_РасчетыСКлиентамиРег.ДолгРеглРасход) КАК ДолгРеглРасход,
	|	(ВТ_РасчетыСКлиентамиРег.ДолгРеглКонечныйОстаток) КАК ДолгРеглКонечныйОстаток,
	|	(ВТ_РасчетыСКлиентамиРег.ПредоплатаРеглНачальныйОстаток) КАК ПредоплатаРеглНачальныйОстаток,
	|	(ВТ_РасчетыСКлиентамиРег.ПредоплатаРеглПриход) КАК ПредоплатаРеглПриход,
	|	(ВТ_РасчетыСКлиентамиРег.ПредоплатаРеглРасход) КАК ПредоплатаРеглРасход,
	|	(ВТ_РасчетыСКлиентамиРег.ПредоплатаРеглКонечныйОстаток) КАК ПредоплатаРеглКонечныйОстаток
	|ПОМЕСТИТЬ ВТ_РасчетыСКлиентами
	|ИЗ
	|	ВТ_РасчетыСКлиентамиРег КАК ВТ_РасчетыСКлиентамиРег
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоОрганизации
	|		ПО (НастройкиПоОрганизации.ВидСчета В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыПолученные)))
	|			И (НастройкиПоОрганизации.Организация = ВТ_РасчетыСКлиентамиРег.Организация)
	|			И (НастройкиПоОрганизации.АналитикаУчета = ВТ_РасчетыСКлиентамиРег.ГруппаФинансовогоУчета)
	|			И (НастройкиПоОрганизации.МестоУчета = НЕОПРЕДЕЛЕНО)
	|			И (НастройкиПоОрганизации.Долгосрочный = ВТ_РасчетыСКлиентамиРег.Долгосрочный)
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоАналитике
	|		ПО (НастройкиПоАналитике.ВидСчета В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыПолученные)))
	|			И (НастройкиПоАналитике.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))
	|			И (НастройкиПоАналитике.АналитикаУчета = ВТ_РасчетыСКлиентамиРег.ГруппаФинансовогоУчета)
	|			И (НастройкиПоАналитике.МестоУчета = НЕОПРЕДЕЛЕНО)
	|			И (НастройкиПоАналитике.Долгосрочный = ВТ_РасчетыСКлиентамиРег.Долгосрочный)
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ_РасчетыСКлиентамиРег.ОбъектРасчетов,
	|	ВТ_РасчетыСКлиентамиРег.Организация,
	|	ВТ_РасчетыСКлиентамиРег.Контрагент,
	|	ВТ_РасчетыСКлиентамиРег.Подразделение,
	|	ВТ_РасчетыСКлиентамиРег.ГруппаФинансовогоУчета,
	|	(ВТ_РасчетыСКлиентамиРег.ДолгРеглНачальныйОстаток),
	|	(ВТ_РасчетыСКлиентамиРег.ДолгРеглПриход),
	|	(ВТ_РасчетыСКлиентамиРег.ДолгРеглРасход),
	|	(ВТ_РасчетыСКлиентамиРег.ДолгРеглКонечныйОстаток),
	|	(ВТ_РасчетыСКлиентамиРег.ПредоплатаРеглНачальныйОстаток),
	|	(ВТ_РасчетыСКлиентамиРег.ПредоплатаРеглПриход),
	|	(ВТ_РасчетыСКлиентамиРег.ПредоплатаРеглРасход),
	|	(ВТ_РасчетыСКлиентамиРег.ПредоплатаРеглКонечныйОстаток)";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область РасчетыПоКредитамДепозитамОУ
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ВТ_РасчетыПоКредитамДепозитамРег.Организация КАК Организация,
	|	ВТ_РасчетыПоКредитамДепозитамРег.Договор КАК Договор,
	|	ВЫБОР
	|		КОГДА ДанныеДоговора.ХарактерДоговора = ЗНАЧЕНИЕ(Перечисление.ХарактерыДоговоровФинансовыхИнструментов.КредитИлиЗайм)
	|				И ВТ_РасчетыПоКредитамДепозитамРег.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммГрафикаКредитовИДепозитов.ОсновнойДолг)
	|			ТОГДА МАКСИМУМ(ВЫБОР
	|						КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО)) = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКредиторамиОсновнойДолг)
	|							ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|						ИНАЧЕ &ПустойСчет
	|					КОНЕЦ)
	|		КОГДА ДанныеДоговора.ХарактерДоговора = ЗНАЧЕНИЕ(Перечисление.ХарактерыДоговоровФинансовыхИнструментов.КредитИлиЗайм)
	|				И ВТ_РасчетыПоКредитамДепозитамРег.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммГрафикаКредитовИДепозитов.Проценты)
	|			ТОГДА МАКСИМУМ(ВЫБОР
	|						КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО)) = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКредиторамиПроценты)
	|							ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|						ИНАЧЕ &ПустойСчет
	|					КОНЕЦ)
	|		КОГДА ДанныеДоговора.ХарактерДоговора = ЗНАЧЕНИЕ(Перечисление.ХарактерыДоговоровФинансовыхИнструментов.КредитИлиЗайм)
	|				И ВТ_РасчетыПоКредитамДепозитамРег.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммГрафикаКредитовИДепозитов.Комиссия)
	|			ТОГДА МАКСИМУМ(ВЫБОР
	|						КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО)) = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКредиторамиКомиссия)
	|							ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|						ИНАЧЕ &ПустойСчет
	|					КОНЕЦ)
	|		КОГДА ДанныеДоговора.ХарактерДоговора <> ЗНАЧЕНИЕ(Перечисление.ХарактерыДоговоровФинансовыхИнструментов.КредитИлиЗайм)
	|				И ВТ_РасчетыПоКредитамДепозитамРег.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммГрафикаКредитовИДепозитов.ОсновнойДолг)
	|			ТОГДА МАКСИМУМ(ВЫБОР
	|						КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО)) = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСДебиторамиОсновнойДолг)
	|							ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|						ИНАЧЕ &ПустойСчет
	|					КОНЕЦ)
	|		КОГДА ДанныеДоговора.ХарактерДоговора <> ЗНАЧЕНИЕ(Перечисление.ХарактерыДоговоровФинансовыхИнструментов.КредитИлиЗайм)
	|				И ВТ_РасчетыПоКредитамДепозитамРег.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммГрафикаКредитовИДепозитов.Проценты)
	|			ТОГДА МАКСИМУМ(ВЫБОР
	|						КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО)) = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСДебиторамиПроценты)
	|							ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|						ИНАЧЕ &ПустойСчет
	|					КОНЕЦ)
	|		КОГДА ДанныеДоговора.ХарактерДоговора <> ЗНАЧЕНИЕ(Перечисление.ХарактерыДоговоровФинансовыхИнструментов.КредитИлиЗайм)
	|				И ВТ_РасчетыПоКредитамДепозитамРег.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммГрафикаКредитовИДепозитов.Комиссия)
	|			ТОГДА МАКСИМУМ(ВЫБОР
	|						КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО)) = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСДебиторамиКомиссия)
	|							ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|						ИНАЧЕ &ПустойСчет
	|					КОНЕЦ)
	|	КОНЕЦ КАК Счет,
	|	ДанныеДоговора.Подразделение КАК Подразделение,
	|	ДанныеДоговора.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	(ВТ_РасчетыПоКредитамДепозитамРег.СуммаРеглНачальныйОстаток) КАК СуммаРеглНачальныйОстаток,
	|	(ВТ_РасчетыПоКредитамДепозитамРег.СуммаРеглПриход) КАК СуммаРеглПриход,
	|	(ВТ_РасчетыПоКредитамДепозитамРег.СуммаРеглРасход) КАК СуммаРеглРасход,
	|	(ВТ_РасчетыПоКредитамДепозитамРег.СуммаРеглКонечныйОстаток) КАК СуммаРеглКонечныйОстаток
	|ПОМЕСТИТЬ ВТ_РасчетыПоКредитамДепозитам
	|ИЗ
	|	ВТ_РасчетыПоКредитамДепозитамРег КАК ВТ_РасчетыПоКредитамДепозитамРег
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ДоговорыКредитовИДепозитов КАК ДанныеДоговора
	|		ПО (ДанныеДоговора.Ссылка = ВТ_РасчетыПоКредитамДепозитамРег.Договор)
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоОрганизации
	|		ПО (НастройкиПоОрганизации.ВидСчета В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКредиторамиОсновнойДолг), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКредиторамиКомиссия), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКредиторамиПроценты), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСДебиторамиОсновнойДолг), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСДебиторамиКомиссия), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСДебиторамиПроценты)))
	|			И (НастройкиПоОрганизации.Организация = ВТ_РасчетыПоКредитамДепозитамРег.Организация)
	|			И (НастройкиПоОрганизации.АналитикаУчета = ДанныеДоговора.ГруппаФинансовогоУчета)
	|			И (НастройкиПоОрганизации.МестоУчета = НЕОПРЕДЕЛЕНО)
	|			И (НастройкиПоОрганизации.Долгосрочный = ВТ_РасчетыПоКредитамДепозитамРег.Долгосрочный)
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоАналитике
	|		ПО (НастройкиПоАналитике.ВидСчета В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКредиторамиОсновнойДолг), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКредиторамиКомиссия), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКредиторамиПроценты), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСДебиторамиОсновнойДолг), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСДебиторамиКомиссия), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСДебиторамиПроценты)))
	|			И (НастройкиПоАналитике.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))
	|			И (НастройкиПоАналитике.АналитикаУчета = ДанныеДоговора.ГруппаФинансовогоУчета)
	|			И (НастройкиПоАналитике.МестоУчета = НЕОПРЕДЕЛЕНО)
	|			И (НастройкиПоАналитике.Долгосрочный = ВТ_РасчетыПоКредитамДепозитамРег.Долгосрочный)
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ_РасчетыПоКредитамДепозитамРег.Организация,
	|	ВТ_РасчетыПоКредитамДепозитамРег.Договор,
	|	ДанныеДоговора.Подразделение,
	|	ДанныеДоговора.ХарактерДоговора,
	|	ВТ_РасчетыПоКредитамДепозитамРег.ТипСуммы,
	|	ДанныеДоговора.ГруппаФинансовогоУчета,
	|	(ВТ_РасчетыПоКредитамДепозитамРег.СуммаРеглНачальныйОстаток),
	|	(ВТ_РасчетыПоКредитамДепозитамРег.СуммаРеглПриход),
	|	(ВТ_РасчетыПоКредитамДепозитамРег.СуммаРеглРасход),
	|	(ВТ_РасчетыПоКредитамДепозитамРег.СуммаРеглКонечныйОстаток)";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область РасчетыПоЛизингуОУ
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ВТ_РасчетыПоЛизингуРег.Договор КАК Договор,
	|	ВТ_РасчетыПоЛизингуРег.Организация КАК Организация,
	|	ВТ_РасчетыПоЛизингуРег.Контрагент КАК Контрагент,
	|	ВЫБОР
	|		КОГДА ВТ_РасчетыПоЛизингуРег.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.УслугаПоАренде)
	|			ИЛИ ВТ_РасчетыПоЛизингуРег.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.УслугаПоАрендеАванс)
	|		ТОГДА МАКСИМУМ(ВЫБОР
	|				КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО))
	|					= ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.УслугаПоАренде)
	|				ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|				ИНАЧЕ &ПустойСчет
	|			КОНЕЦ)
	|		КОГДА ВТ_РасчетыПоЛизингуРег.ТипСуммы В (ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.ВыкупнаяСтоимость),
	|												ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.ВыкупнаяСтоимостьАванс))
	|		ТОГДА МАКСИМУМ(ВЫБОР
	|				КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО))
	|					= ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ВыкупнаяСтоимость)
	|				ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|				ИНАЧЕ &ПустойСчет
	|			КОНЕЦ)
	|		КОГДА ВТ_РасчетыПоЛизингуРег.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.ОбеспечительныйПлатеж)
	|		ТОГДА МАКСИМУМ(ВЫБОР
	|				КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО))
	|					= ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ОбеспечительныйПлатеж)
	|				ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|				ИНАЧЕ &ПустойСчет
	|			КОНЕЦ)
	|		КОГДА ВТ_РасчетыПоЛизингуРег.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.АрендныеОбязательства)
	|		ТОГДА МАКСИМУМ(ВЫБОР
	|				КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО))
	|					= ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АрендныеОбязательства)
	|				ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|				ИНАЧЕ &ПустойСчет
	|			КОНЕЦ)
	|		КОГДА ВТ_РасчетыПоЛизингуРег.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.Проценты)
	|		ТОГДА МАКСИМУМ(ВЫБОР
	|				КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО))
	|					= ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НачислениеПроцентовПоАренде)
	|				ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|				ИНАЧЕ &ПустойСчет
	|			КОНЕЦ)
	|		КОГДА ВТ_РасчетыПоЛизингуРег.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.НДС)
	|		ТОГДА МАКСИМУМ(ВЫБОР
	|				КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО))
	|					= ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НДСПриАренде)
	|				ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|				ИНАЧЕ &ПустойСчет
	|			КОНЕЦ)
	|	КОНЕЦ КАК Счет,
	|	ВТ_РасчетыПоЛизингуРег.Подразделение КАК Подразделение,
	|	ВТ_РасчетыПоЛизингуРег.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	(ВТ_РасчетыПоЛизингуРег.СуммаРеглНачальныйОстаток) КАК СуммаРеглНачальныйОстаток,
	|	(ВТ_РасчетыПоЛизингуРег.СуммаРеглПриход) КАК СуммаРеглПриход,
	|	(ВТ_РасчетыПоЛизингуРег.СуммаРеглРасход) КАК СуммаРеглРасход,
	|	(ВТ_РасчетыПоЛизингуРег.СуммаРеглКонечныйОстаток) КАК СуммаРеглКонечныйОстаток
	|ПОМЕСТИТЬ ВТ_РасчетыПоЛизингу
	|ИЗ
	|	ВТ_РасчетыПоЛизингуРег КАК ВТ_РасчетыПоЛизингуРег
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоОрганизации
	|		ПО (НастройкиПоОрганизации.ВидСчета В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.УслугаПоАренде),
	|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ОбеспечительныйПлатеж),
	|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ВыкупнаяСтоимость),
	|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АрендныеОбязательства),
	|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НачислениеПроцентовПоАренде),
	|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НДСПриАренде)))
	|			И (НастройкиПоОрганизации.Организация = ВТ_РасчетыПоЛизингуРег.Организация)
	|			И (НастройкиПоОрганизации.АналитикаУчета = ВТ_РасчетыПоЛизингуРег.ГруппаФинансовогоУчета)
	|			И (НастройкиПоОрганизации.МестоУчета = НЕОПРЕДЕЛЕНО)
	|			И (НастройкиПоОрганизации.Долгосрочный = ВТ_РасчетыПоЛизингуРег.Долгосрочный)
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоАналитике
	|		ПО (НастройкиПоАналитике.ВидСчета В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.УслугаПоАренде),
	|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ОбеспечительныйПлатеж),
	|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ВыкупнаяСтоимость),
	|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АрендныеОбязательства),
	|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НачислениеПроцентовПоАренде),
	|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НДСПриАренде)))
	|			И (НастройкиПоАналитике.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))
	|			И (НастройкиПоАналитике.АналитикаУчета = ВТ_РасчетыПоЛизингуРег.ГруппаФинансовогоУчета)
	|			И (НастройкиПоАналитике.МестоУчета = НЕОПРЕДЕЛЕНО)
	|			И (НастройкиПоАналитике.Долгосрочный = ВТ_РасчетыПоЛизингуРег.Долгосрочный)
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ_РасчетыПоЛизингуРег.Договор,
	|	ВТ_РасчетыПоЛизингуРег.Организация,
	|	ВТ_РасчетыПоЛизингуРег.Контрагент,
	|	ВТ_РасчетыПоЛизингуРег.Подразделение,
	|	ВТ_РасчетыПоЛизингуРег.ТипСуммы,
	|	ВТ_РасчетыПоЛизингуРег.ГруппаФинансовогоУчета,
	|	(ВТ_РасчетыПоЛизингуРег.СуммаРеглНачальныйОстаток),
	|	(ВТ_РасчетыПоЛизингуРег.СуммаРеглПриход),
	|	(ВТ_РасчетыПоЛизингуРег.СуммаРеглРасход),
	|	(ВТ_РасчетыПоЛизингуРег.СуммаРеглКонечныйОстаток)";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область НеотфактурованныеПоставкиОУ
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ВТ_НеотфактурованныеПоставкиРег.Организация КАК Организация,
	|	ВТ_НеотфактурованныеПоставкиРег.Контрагент КАК Контрагент,
	|	ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет)) КАК Счет,
	|	ВТ_НеотфактурованныеПоставкиРег.Подразделение КАК Подразделение,
	|	ВТ_НеотфактурованныеПоставкиРег.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	ВТ_НеотфактурованныеПоставкиРег.СтоимостьРеглНачальныйОстаток КАК СтоимостьРеглНачальныйОстаток,
	|	ВТ_НеотфактурованныеПоставкиРег.СтоимостьРеглПриход КАК СтоимостьРеглПриход,
	|	ВТ_НеотфактурованныеПоставкиРег.СтоимостьРеглРасход КАК СтоимостьРеглРасход,
	|	ВТ_НеотфактурованныеПоставкиРег.СтоимостьРеглКонечныйОстаток КАК СтоимостьРеглКонечныйОстаток
	|ПОМЕСТИТЬ ВТ_НеотфактурованныеПоставки
	|ИЗ
	|	ВТ_НеотфактурованныеПоставкиРег КАК ВТ_НеотфактурованныеПоставкиРег
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоОрганизации
	|		ПО (НастройкиПоОрганизации.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НеотфактурованныеПоставки))
	|			И (НастройкиПоОрганизации.Организация = ВТ_НеотфактурованныеПоставкиРег.Организация)
	|			И (НастройкиПоОрганизации.АналитикаУчета = ВТ_НеотфактурованныеПоставкиРег.ГруппаФинансовогоУчета)
	|			И (НастройкиПоОрганизации.МестоУчета = НЕОПРЕДЕЛЕНО)
	|			И (НастройкиПоОрганизации.Долгосрочный = ВТ_НеотфактурованныеПоставкиРег.Долгосрочный)
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоАналитике
	|		ПО (НастройкиПоАналитике.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НеотфактурованныеПоставки))
	|			И (НастройкиПоАналитике.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))
	|			И (НастройкиПоАналитике.АналитикаУчета = ВТ_НеотфактурованныеПоставкиРег.ГруппаФинансовогоУчета)
	|			И (НастройкиПоАналитике.МестоУчета = НЕОПРЕДЕЛЕНО)
	|			И (НастройкиПоАналитике.Долгосрочный = ВТ_НеотфактурованныеПоставкиРег.Долгосрочный)";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область ПрочиеРасчеты
	
	ТекстЗапроса = РегистрыСведений.ПорядокОтраженияНаСчетахУчета.ТекстЗапросаДанныеПрочихРасчетов(Истина);
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ДанныеПрочихРасчетов.Организация КАК Организация,
	|	ДанныеПрочихРасчетов.Контрагент КАК Контрагент,
	|	ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет)) КАК Счет,
	|	ДанныеПрочихРасчетов.Подразделение КАК Подразделение,
	|	ДанныеПрочихРасчетов.АналитикаУчета КАК ГруппаФинансовогоУчета,
	|	ДанныеПрочихРасчетов.СуммаРеглНачальныйОстаток КАК СтоимостьРеглНачальныйОстаток,
	|	ДанныеПрочихРасчетов.СуммаРеглПриход КАК СтоимостьРеглПриход,
	|	ДанныеПрочихРасчетов.СуммаРеглРасход КАК СтоимостьРеглРасход,
	|	ДанныеПрочихРасчетов.СуммаРеглКонечныйОстаток КАК СтоимостьРеглКонечныйОстаток
	|ПОМЕСТИТЬ ВТ_ПрочиеРасчетыСКонтрагентами
	|ИЗ
	|	ВТ_ДанныеПрочихРасчетов КАК ДанныеПрочихРасчетов
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоОрганизации
	|		ПО НастройкиПоОрганизации.ВидСчета = ДанныеПрочихРасчетов.ВидСчета
	|			И НастройкиПоОрганизации.Организация = ДанныеПрочихРасчетов.Организация
	|			И НастройкиПоОрганизации.АналитикаУчета = ДанныеПрочихРасчетов.АналитикаУчета
	|			И НастройкиПоОрганизации.МестоУчета = НЕОПРЕДЕЛЕНО
	|			И НастройкиПоОрганизации.Долгосрочный = ДанныеПрочихРасчетов.Долгосрочный
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоАналитике
	|		ПО НастройкиПоАналитике.ВидСчета = ДанныеПрочихРасчетов.ВидСчета
	|			И НастройкиПоАналитике.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|			И НастройкиПоАналитике.АналитикаУчета = ДанныеПрочихРасчетов.АналитикаУчета
	|			И НастройкиПоАналитике.МестоУчета = НЕОПРЕДЕЛЕНО
	|			И НастройкиПоАналитике.Долгосрочный = ДанныеПрочихРасчетов.Долгосрочный";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область РасчетыСПартнерамиБУ
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	""Поставщики"" КАК РазделУчета,
	|	ХозрасчетныйОстаткиИОбороты.Организация КАК Организация,
	|	ХозрасчетныйОстаткиИОбороты.Подразделение КАК Подразделение,
	|	ХозрасчетныйОстаткиИОбороты.Счет КАК Счет,
	|	ХозрасчетныйОстаткиИОбороты.Субконто1 КАК Субконто1,
	|	ХозрасчетныйОстаткиИОбороты.СуммаНачальныйОстаток КАК СуммаНачальныйОстаток,
	|	ХозрасчетныйОстаткиИОбороты.СуммаОборотДт КАК СуммаОборотДт,
	|	ХозрасчетныйОстаткиИОбороты.СуммаОборотКт КАК СуммаОборотКт,
	|	ХозрасчетныйОстаткиИОбороты.СуммаКонечныйОстаток КАК СуммаКонечныйОстаток
	|ПОМЕСТИТЬ ВТ_РасчетыСКонтрагентамиРегл
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, , , Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПоставщикамиИПодрядчиками)), , Организация В (&МассивОрганизаций)) КАК ХозрасчетныйОстаткиИОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	""Клиенты"",
	|	ХозрасчетныйОстаткиИОбороты.Организация,
	|	ХозрасчетныйОстаткиИОбороты.Подразделение,
	|	ХозрасчетныйОстаткиИОбороты.Счет,
	|	ХозрасчетныйОстаткиИОбороты.Субконто1,
	|	ХозрасчетныйОстаткиИОбороты.СуммаНачальныйОстаток,
	|	ХозрасчетныйОстаткиИОбороты.СуммаОборотДт,
	|	ХозрасчетныйОстаткиИОбороты.СуммаОборотКт,
	|	ХозрасчетныйОстаткиИОбороты.СуммаКонечныйОстаток
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, , , Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПокупателямиИЗаказчиками)), , Организация В (&МассивОрганизаций)) КАК ХозрасчетныйОстаткиИОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	""КредитыДепозиты"",
	|	ХозрасчетныйОстаткиИОбороты.Организация,
	|	ХозрасчетныйОстаткиИОбороты.Подразделение,
	|	ХозрасчетныйОстаткиИОбороты.Счет,
	|	ВЫБОР
	|		КОГДА ТИПЗНАЧЕНИЯ(ХозрасчетныйОстаткиИОбороты.Субконто1) = ТИП(Справочник.ДоговорыКредитовИДепозитов)
	|			ТОГДА ХозрасчетныйОстаткиИОбороты.Субконто1
	|		КОГДА ТИПЗНАЧЕНИЯ(ХозрасчетныйОстаткиИОбороты.Субконто2) = ТИП(Справочник.ДоговорыКредитовИДепозитов)
	|			ТОГДА ХозрасчетныйОстаткиИОбороты.Субконто2
	|		ИНАЧЕ NULL
	|	КОНЕЦ,
	|	ХозрасчетныйОстаткиИОбороты.СуммаНачальныйОстаток,
	|	ХозрасчетныйОстаткиИОбороты.СуммаОборотДт,
	|	ХозрасчетныйОстаткиИОбороты.СуммаОборотКт,
	|	ХозрасчетныйОстаткиИОбороты.СуммаКонечныйОстаток
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, , , Счет В ИЕРАРХИИ (&СчетаУчетаРасчетов5), , Организация В (&МассивОрганизаций)
	|		И (ТИПЗНАЧЕНИЯ(Субконто1) = ТИП(Справочник.ДоговорыКредитовИДепозитов) ИЛИ ТИПЗНАЧЕНИЯ(Субконто2) = ТИП(Справочник.ДоговорыКредитовИДепозитов))) КАК ХозрасчетныйОстаткиИОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	""Лизинг"",
	|	ХозрасчетныйОстаткиИОбороты.Организация,
	|	ХозрасчетныйОстаткиИОбороты.Подразделение,
	|	ХозрасчетныйОстаткиИОбороты.Счет,
	|	ХозрасчетныйОстаткиИОбороты.Субконто1,
	|	ХозрасчетныйОстаткиИОбороты.СуммаНачальныйОстаток,
	|	ХозрасчетныйОстаткиИОбороты.СуммаОборотДт,
	|	ХозрасчетныйОстаткиИОбороты.СуммаОборотКт,
	|	ХозрасчетныйОстаткиИОбороты.СуммаКонечныйОстаток
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОстаткиИОбороты(&НачалоПериода, &КонецПериода,,,,
	|		&ВидыСубконтоКонтрагентыДоговоры, Организация В (&МассивОрганизаций)
	|			И Субконто2 ССЫЛКА Справочник.ДоговорыАренды) КАК ХозрасчетныйОстаткиИОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	""ПрочиеСКонтрагентами"",
	|	ХозрасчетныйОстаткиИОбороты.Организация,
	|	ХозрасчетныйОстаткиИОбороты.Подразделение,
	|	ХозрасчетныйОстаткиИОбороты.Счет,
	|	ХозрасчетныйОстаткиИОбороты.Субконто1,
	|	ХозрасчетныйОстаткиИОбороты.СуммаНачальныйОстаток,
	|	0,
	|	0,
	|	ХозрасчетныйОстаткиИОбороты.СуммаКонечныйОстаток
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.ОстаткиИОбороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			,
	|			,
	|			Счет В ИЕРАРХИИ (&СчетаУчетаРасчетов7),
	|			,
	|			Организация В (&МассивОрганизаций)
	|				И НЕ Субконто2 ССЫЛКА Справочник.ДоговорыАренды) КАК ХозрасчетныйОстаткиИОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	""ПрочиеСКонтрагентами"",
	|	ХозрасчетныйОбороты.Организация,
	|	ХозрасчетныйОбороты.Подразделение,
	|	ХозрасчетныйОбороты.Счет,
	|	ХозрасчетныйОбороты.Субконто1,
	|	0,
	|	СУММА(ХозрасчетныйОбороты.СуммаОборотДт),
	|	СУММА(ХозрасчетныйОбороты.СуммаОборотКт),
	|	0
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			Регистратор,
	|			Счет В ИЕРАРХИИ (&СчетаУчетаРасчетов7),
	|			,
	|			Организация В (&МассивОрганизаций)
	|				И НЕ Субконто2 ССЫЛКА Справочник.ДоговорыАренды,
	|			) КАК ХозрасчетныйОбороты
	|
	|ГДЕ
	|	НЕ (ХозрасчетныйОбороты.Регистратор ССЫЛКА Документ.СчетФактураПолученныйАванс
	|		И ХозрасчетныйОбороты.Счет = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДСпоАвансамИПредоплатам))
	|
	|СГРУППИРОВАТЬ ПО
	|	ХозрасчетныйОбороты.Организация,
	|	ХозрасчетныйОбороты.Подразделение,
	|	ХозрасчетныйОбороты.Счет,
	|	ХозрасчетныйОбороты.Субконто1";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область РасчетыСПартнерамиОУиБУ
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ВЫБОР
	|		КОГДА ВТ_РасчетыСПоставщиками.СчетУчетаРасчетов В ИЕРАРХИИ (&СчетаУчетаРасчетов7)
	|			ТОГДА ""ПрочиеСКонтрагентами""
	|		ИНАЧЕ ""Поставщики""
	|	КОНЕЦ КАК РазделУчета,
	|	ВТ_РасчетыСПоставщиками.Организация КАК Организация,
	|	ВТ_РасчетыСПоставщиками.Подразделение КАК Подразделение,
	|	ВТ_РасчетыСПоставщиками.СчетУчетаРасчетов КАК СчетУчета,
	|	ВТ_РасчетыСПоставщиками.Контрагент КАК Аналитика1,
	|	СУММА(ВТ_РасчетыСПоставщиками.ДолгРеглНачальныйОстаток) КАК НачальныйОстаток,
	|	СУММА(ВТ_РасчетыСПоставщиками.ДолгРеглПриход) КАК Приход,
	|	СУММА(ВТ_РасчетыСПоставщиками.ДолгРеглРасход) КАК Расход,
	|	СУММА(ВТ_РасчетыСПоставщиками.ДолгРеглКонечныйОстаток) КАК КонечныйОстаток,
	|	0 КАК НачальноеСальдо,
	|	0 КАК ОборотДт,
	|	0 КАК ОборотКт,
	|	0 КАК КонечноеСальдо
	|ПОМЕСТИТЬ ВТ_Расчеты
	|ИЗ
	|	ВТ_РасчетыСПоставщиками КАК ВТ_РасчетыСПоставщиками
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ_РасчетыСПоставщиками.Организация,
	|	ВТ_РасчетыСПоставщиками.Подразделение,
	|	ВТ_РасчетыСПоставщиками.СчетУчетаРасчетов,
	|	ВТ_РасчетыСПоставщиками.Контрагент
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ВЫБОР
	|		КОГДА ВТ_РасчетыСПоставщиками.СчетУчетаАванса В ИЕРАРХИИ (&СчетаУчетаРасчетов7)
	|			ТОГДА ""ПрочиеСКонтрагентами""
	|		ИНАЧЕ ""Поставщики""
	|	КОНЕЦ,
	|	ВТ_РасчетыСПоставщиками.Организация,
	|	ВТ_РасчетыСПоставщиками.Подразделение,
	|	ВТ_РасчетыСПоставщиками.СчетУчетаАванса,
	|	ВТ_РасчетыСПоставщиками.Контрагент,
	|	СУММА(ВТ_РасчетыСПоставщиками.ПредоплатаРеглНачальныйОстаток),
	|	СУММА(ВТ_РасчетыСПоставщиками.ПредоплатаРеглПриход),
	|	СУММА(ВТ_РасчетыСПоставщиками.ПредоплатаРеглРасход),
	|	СУММА(ВТ_РасчетыСПоставщиками.ПредоплатаРеглКонечныйОстаток),
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	ВТ_РасчетыСПоставщиками КАК ВТ_РасчетыСПоставщиками
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ_РасчетыСПоставщиками.Организация,
	|	ВТ_РасчетыСПоставщиками.Подразделение,
	|	ВТ_РасчетыСПоставщиками.СчетУчетаАванса,
	|	ВТ_РасчетыСПоставщиками.Контрагент
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ВЫБОР
	|		КОГДА ВТ_РасчетыСКлиентами.СчетУчетаРасчетов В ИЕРАРХИИ (&СчетаУчетаРасчетов7)
	|			ТОГДА ""ПрочиеСКонтрагентами""
	|		ИНАЧЕ ""Клиенты""
	|	КОНЕЦ,
	|	ВТ_РасчетыСКлиентами.Организация,
	|	ВТ_РасчетыСКлиентами.Подразделение,
	|	ВТ_РасчетыСКлиентами.СчетУчетаРасчетов,
	|	ВТ_РасчетыСКлиентами.Контрагент,
	|	СУММА(ВТ_РасчетыСКлиентами.ДолгРеглНачальныйОстаток),
	|	СУММА(ВТ_РасчетыСКлиентами.ДолгРеглПриход),
	|	СУММА(ВТ_РасчетыСКлиентами.ДолгРеглРасход),
	|	СУММА(ВТ_РасчетыСКлиентами.ДолгРеглКонечныйОстаток),
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	ВТ_РасчетыСКлиентами КАК ВТ_РасчетыСКлиентами
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ_РасчетыСКлиентами.Организация,
	|	ВТ_РасчетыСКлиентами.Подразделение,
	|	ВТ_РасчетыСКлиентами.СчетУчетаРасчетов,
	|	ВТ_РасчетыСКлиентами.Контрагент
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ВЫБОР
	|		КОГДА ВТ_РасчетыСКлиентами.СчетУчетаАванса В ИЕРАРХИИ (&СчетаУчетаРасчетов7)
	|			ТОГДА ""ПрочиеСКонтрагентами""
	|		ИНАЧЕ ""Клиенты""
	|	КОНЕЦ,
	|	ВТ_РасчетыСКлиентами.Организация,
	|	ВТ_РасчетыСКлиентами.Подразделение,
	|	ВТ_РасчетыСКлиентами.СчетУчетаАванса,
	|	ВТ_РасчетыСКлиентами.Контрагент,
	|	СУММА(ВТ_РасчетыСКлиентами.ПредоплатаРеглНачальныйОстаток),
	|	СУММА(ВТ_РасчетыСКлиентами.ПредоплатаРеглПриход),
	|	СУММА(ВТ_РасчетыСКлиентами.ПредоплатаРеглРасход),
	|	СУММА(ВТ_РасчетыСКлиентами.ПредоплатаРеглКонечныйОстаток),
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	ВТ_РасчетыСКлиентами КАК ВТ_РасчетыСКлиентами
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ_РасчетыСКлиентами.Организация,
	|	ВТ_РасчетыСКлиентами.Подразделение,
	|	ВТ_РасчетыСКлиентами.СчетУчетаАванса,
	|	ВТ_РасчетыСКлиентами.Контрагент
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	""КредитыДепозиты"",
	|	РасчетыПоКредитамДепозитам.Организация,
	|	РасчетыПоКредитамДепозитам.Подразделение,
	|	РасчетыПоКредитамДепозитам.Счет,
	|	РасчетыПоКредитамДепозитам.Договор,
	|	РасчетыПоКредитамДепозитам.СуммаРеглНачальныйОстаток КАК СуммаРеглНачальныйОстаток,
	|	РасчетыПоКредитамДепозитам.СуммаРеглПриход КАК СуммаРеглПриход,
	|	РасчетыПоКредитамДепозитам.СуммаРеглРасход КАК СуммаРеглРасход,
	|	РасчетыПоКредитамДепозитам.СуммаРеглКонечныйОстаток КАК СуммаРеглКонечныйОстаток,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	ВТ_РасчетыПоКредитамДепозитам КАК РасчетыПоКредитамДепозитам
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	""Лизинг"",
	|	РасчетыПоЛизингу.Организация,
	|	РасчетыПоЛизингу.Подразделение,
	|	РасчетыПоЛизингу.Счет,
	|	РасчетыПоЛизингу.Контрагент,
	|	СУММА(РасчетыПоЛизингу.СуммаРеглНачальныйОстаток),
	|	СУММА(РасчетыПоЛизингу.СуммаРеглПриход),
	|	СУММА(РасчетыПоЛизингу.СуммаРеглРасход),
	|	СУММА(РасчетыПоЛизингу.СуммаРеглКонечныйОстаток),
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	ВТ_РасчетыПоЛизингу КАК РасчетыПоЛизингу
	|
	|СГРУППИРОВАТЬ ПО
	|	РасчетыПоЛизингу.Организация,
	|	РасчетыПоЛизингу.Подразделение,
	|	РасчетыПоЛизингу.Счет,
	|	РасчетыПоЛизингу.Контрагент
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	""Поставщики"",
	|	НеотфактурованныеПоставки.Организация,
	|	НеотфактурованныеПоставки.Подразделение,
	|	НеотфактурованныеПоставки.Счет,
	|	НеотфактурованныеПоставки.Контрагент,
	|	НеотфактурованныеПоставки.СтоимостьРеглНачальныйОстаток,
	|	НеотфактурованныеПоставки.СтоимостьРеглПриход,
	|	НеотфактурованныеПоставки.СтоимостьРеглРасход,
	|	НеотфактурованныеПоставки.СтоимостьРеглКонечныйОстаток,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	ВТ_НеотфактурованныеПоставки КАК НеотфактурованныеПоставки
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	""ПрочиеСКонтрагентами"",
	|	ПрочиеРасчетыСКонтрагентами.Организация,
	|	ПрочиеРасчетыСКонтрагентами.Подразделение,
	|	ПрочиеРасчетыСКонтрагентами.Счет,
	|	ПрочиеРасчетыСКонтрагентами.Контрагент,
	|	ПрочиеРасчетыСКонтрагентами.СтоимостьРеглНачальныйОстаток,
	|	ПрочиеРасчетыСКонтрагентами.СтоимостьРеглПриход,
	|	ПрочиеРасчетыСКонтрагентами.СтоимостьРеглРасход,
	|	ПрочиеРасчетыСКонтрагентами.СтоимостьРеглКонечныйОстаток,
	|	0,
	|	0,
	|	0,
	|	0
	|ИЗ
	|	ВТ_ПрочиеРасчетыСКонтрагентами КАК ПрочиеРасчетыСКонтрагентами
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ВТ_РасчетыСКонтрагентамиРегл.РазделУчета,
	|	ВТ_РасчетыСКонтрагентамиРегл.Организация,
	|	ВТ_РасчетыСКонтрагентамиРегл.Подразделение,
	|	ЕСТЬNULL(ДолгосрочныеКакКраткосрочные.СчетУчетаКраткосрочный, ВТ_РасчетыСКонтрагентамиРегл.Счет),
	|	ВТ_РасчетыСКонтрагентамиРегл.Субконто1,
	|	0,
	|	0,
	|	0,
	|	0,
	|	ВТ_РасчетыСКонтрагентамиРегл.СуммаНачальныйОстаток,
	|	ВТ_РасчетыСКонтрагентамиРегл.СуммаОборотДт,
	|	ВТ_РасчетыСКонтрагентамиРегл.СуммаОборотКт,
	|	ВТ_РасчетыСКонтрагентамиРегл.СуммаКонечныйОстаток
	|ИЗ
	|	ВТ_РасчетыСКонтрагентамиРегл КАК ВТ_РасчетыСКонтрагентамиРегл
	|	ЛЕВОЕ СОЕДИНЕНИЕ ВТДолгосрочныеКакКраткосрочные КАК ДолгосрочныеКакКраткосрочные
	|		ПО ВТ_РасчетыСКонтрагентамиРегл.Счет = ДолгосрочныеКакКраткосрочные.СчетУчетаДолгосрочный";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область Результат
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	Подзапрос.РазделУчета КАК РазделУчета,
	|	Подзапрос.Организация КАК Организация,
	|	Подзапрос.Подразделение,
	|	Подзапрос.СчетУчета КАК СчетБУ,
	|	Подзапрос.Аналитика1 КАК Аналитика1,
	|	СУММА(Подзапрос.НачальныйОстаток) КАК НачальныйОстаток,
	|	СУММА(Подзапрос.Приход) КАК Приход,
	|	СУММА(Подзапрос.Расход) КАК Расход,
	|	СУММА(Подзапрос.КонечныйОстаток) КАК КонечныйОстаток,
	|	СУММА(Подзапрос.НачальноеСальдо) КАК НачальноеСальдо,
	|	СУММА(Подзапрос.ОборотДт) КАК ОборотДт,
	|	СУММА(Подзапрос.ОборотКт) КАК ОборотКт,
	|	СУММА(Подзапрос.КонечноеСальдо) КАК КонечноеСальдо
	|ИЗ
	|	ВТ_Расчеты КАК Подзапрос
	|ГДЕ
	|	Подзапрос.РазделУчета = &РазделУчета
	|
	|СГРУППИРОВАТЬ ПО
	|	Подзапрос.РазделУчета,
	|	Подзапрос.Организация,
	|	Подзапрос.Подразделение,
	|	Подзапрос.СчетУчета,
	|	Подзапрос.Аналитика1
	|
	|ИМЕЮЩИЕ
	|	(СУММА(Подзапрос.НачальныйОстаток) <> 0
	|		ИЛИ СУММА(Подзапрос.Приход) <> 0
	|		ИЛИ СУММА(Подзапрос.Расход) <> 0
	|		ИЛИ СУММА(Подзапрос.КонечныйОстаток) <> 0
	|		ИЛИ СУММА(Подзапрос.НачальноеСальдо) <> 0
	|		ИЛИ СУММА(Подзапрос.ОборотДт) <> 0
	|		ИЛИ СУММА(Подзапрос.ОборотКт) <> 0
	|		ИЛИ СУММА(Подзапрос.КонечноеСальдо) <> 0)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Подзапрос.РазделУчета,
	|	Подзапрос.Организация,
	|	Подзапрос.Подразделение,
	|	Подзапрос.СчетУчета,
	|	Подзапрос.Аналитика1,
	|	СУММА(Подзапрос.НачальныйОстаток),
	|	СУММА(Подзапрос.Приход),
	|	СУММА(Подзапрос.Расход),
	|	СУММА(Подзапрос.КонечныйОстаток),
	|	СУММА(Подзапрос.НачальноеСальдо),
	|	СУММА(Подзапрос.ОборотДт),
	|	СУММА(Подзапрос.ОборотКт),
	|	СУММА(Подзапрос.КонечноеСальдо)
	|ИЗ
	|	ВТ_Расчеты КАК Подзапрос
	|ГДЕ
	|	&РазделУчета = ""Все""
	|
	|СГРУППИРОВАТЬ ПО
	|	Подзапрос.РазделУчета,
	|	Подзапрос.Организация,
	|	Подзапрос.Подразделение,
	|	Подзапрос.СчетУчета,
	|	Подзапрос.Аналитика1
	|
	|ИМЕЮЩИЕ
	|	(СУММА(Подзапрос.НачальныйОстаток) <> 0
	|		ИЛИ СУММА(Подзапрос.Приход) <> 0
	|		ИЛИ СУММА(Подзапрос.Расход) <> 0
	|		ИЛИ СУММА(Подзапрос.КонечныйОстаток) <> 0
	|		ИЛИ СУММА(Подзапрос.НачальноеСальдо) <> 0
	|		ИЛИ СУММА(Подзапрос.ОборотДт) <> 0
	|		ИЛИ СУММА(Подзапрос.ОборотКт) <> 0
	|		ИЛИ СУММА(Подзапрос.КонечноеСальдо) <> 0)";
	
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	ТекстЗапроса = СтрСоединить(МассивТекстовЗапроса, ОбщегоНазначения.РазделительПакетаЗапросов());
	
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстЗапросаРасчетыСКонтрагентамиПоРегистраторам()
	
	МассивТекстовЗапроса = Новый Массив;
	
	#Область РасчетыСПоставщиками
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ОбъектыРасчетов.Ссылка КАК ОбъектРасчетов,
	|	ОбъектыРасчетов.Организация КАК Организация,
	|	ОбъектыРасчетов.Подразделение КАК Подразделение,
	|	ОбъектыРасчетов.Контрагент КАК Контрагент,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	ОбъектыРасчетов.Объект ССЫЛКА Документ.ВозвратТоваровПоставщику ИЛИ ОбъектыРасчетов.Объект ССЫЛКА Документ.ВозвратТоваровМеждуОрганизациями КАК РасчетыПоПретензиям,
	|	РасчетыСПоставщиками.Долгосрочный КАК Долгосрочный,
	|	СУММА(РасчетыСПоставщиками.ДолгРеглПриход) КАК ДолгРеглПриход,
	|	СУММА(РасчетыСПоставщиками.ДолгРеглРасход) КАК ДолгРеглРасход,
	|	СУММА(РасчетыСПоставщиками.ПредоплатаРеглПриход) КАК ПредоплатаРеглПриход,
	|	СУММА(РасчетыСПоставщиками.ПредоплатаРеглРасход) КАК ПредоплатаРеглРасход,
	|	РасчетыСПоставщиками.Регистратор КАК Регистратор
	|ПОМЕСТИТЬ ВТ_РасчетыСПоставщикамиРег
	|ИЗ
	|	(ВЫБРАТЬ
	|		РасчетыСПоставщикамиПоДокументам.ЗаказПоставщику КАК ОбъектРасчетов,
	|		ЛОЖЬ КАК Долгосрочный,
	|		РасчетыСПоставщикамиПоДокументам.Валюта КАК Валюта,
	|		ВЫБОР
	|			КОГДА РасчетыСПоставщикамиПоДокументам.ДолгРегл < 0
	|				ТОГДА 0
	|			ИНАЧЕ РасчетыСПоставщикамиПоДокументам.ДолгРегл
	|		КОНЕЦ КАК ДолгРеглПриход,
	|		ВЫБОР
	|			КОГДА РасчетыСПоставщикамиПоДокументам.ДолгРегл < 0
	|				ТОГДА -РасчетыСПоставщикамиПоДокументам.ДолгРегл
	|			ИНАЧЕ 0
	|		КОНЕЦ КАК ДолгРеглРасход,
	|		ВЫБОР
	|			КОГДА РасчетыСПоставщикамиПоДокументам.ПредоплатаРегл < 0
	|				ТОГДА 0
	|			ИНАЧЕ РасчетыСПоставщикамиПоДокументам.ПредоплатаРегл
	|		КОНЕЦ КАК ПредоплатаРеглПриход,
	|		ВЫБОР
	|			КОГДА РасчетыСПоставщикамиПоДокументам.ПредоплатаРегл < 0
	|				ТОГДА -РасчетыСПоставщикамиПоДокументам.ПредоплатаРегл
	|			ИНАЧЕ 0
	|		КОНЕЦ КАК ПредоплатаРеглРасход,
	|		РасчетыСПоставщикамиПоДокументам.ХозяйственнаяОперация КАК ХозяйственнаяОперация,
	|		РасчетыСПоставщикамиПоДокументам.Регистратор КАК Регистратор
	|	ИЗ
	|		РегистрНакопления.РасчетыСПоставщикамиПоДокументам КАК РасчетыСПоставщикамиПоДокументам
	|	ГДЕ
	|		РасчетыСПоставщикамиПоДокументам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|		И РасчетыСПоставщикамиПоДокументам.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И НЕ РасчетыСПоставщикамиПоДокументам.ХозяйственнаяОперация В (&ИсключаемыеХозОперацииПоАвансам)
	|		И РасчетыСПоставщикамиПоДокументам.Активность
	|		И НЕ &НоваяАрхитектураВзаиморасчетов
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		РасчетыСПоставщикамиПоДокументам.ЗаказПоставщику,
	|		ЛОЖЬ КАК Долгосрочный,
	|		РасчетыСПоставщикамиПоДокументам.Валюта,
	|		0,
	|		РасчетыСПоставщикамиПоДокументам.ДолгРегл,
	|		0,
	|		ВЫБОР
	|		КОГДА РасчетыСПоставщикамиПоДокументам.Регистратор <> РасчетыСПоставщикамиПоДокументам.РасчетныйДокумент
	|		ТОГДА РасчетыСПоставщикамиПоДокументам.ПредоплатаРегл
	|		ИНАЧЕ 0 КОНЕЦ,
	|		РасчетыСПоставщикамиПоДокументам.ХозяйственнаяОперация,
	|		РасчетыСПоставщикамиПоДокументам.Регистратор
	|	ИЗ
	|		РегистрНакопления.РасчетыСПоставщикамиПоДокументам КАК РасчетыСПоставщикамиПоДокументам
	|	ГДЕ
	|		РасчетыСПоставщикамиПоДокументам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И РасчетыСПоставщикамиПоДокументам.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И РасчетыСПоставщикамиПоДокументам.Активность
	|		И НЕ &НоваяАрхитектураВзаиморасчетов
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		РасчетыСПоставщикамиПоДокументам.ЗаказПоставщику,
	|		ЛОЖЬ КАК Долгосрочный,
	|		РасчетыСПоставщикамиПоДокументам.Валюта,
	|		РасчетыСПоставщикамиПоДокументам.ПредоплатаРегл,
	|		РасчетыСПоставщикамиПоДокументам.ПредоплатаРегл,
	|		0,
	|		0,
	|		РасчетыСПоставщикамиПоДокументам.ХозяйственнаяОперация,
	|		РасчетыСПоставщикамиПоДокументам.Регистратор
	|	ИЗ
	|		РегистрНакопления.РасчетыСПоставщикамиПоДокументам КАК РасчетыСПоставщикамиПоДокументам
	|	ГДЕ
	|		НЕ(РасчетыСПоставщикамиПоДокументам.Регистратор ССЫЛКА Документ.КорректировкаПриобретения
	|					ИЛИ РасчетыСПоставщикамиПоДокументам.Регистратор ССЫЛКА Документ.ВзаимозачетЗадолженности)
	|		И РасчетыСПоставщикамиПоДокументам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И РасчетыСПоставщикамиПоДокументам.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И РасчетыСПоставщикамиПоДокументам.Регистратор = РасчетыСПоставщикамиПоДокументам.РасчетныйДокумент
	|		И РасчетыСПоставщикамиПоДокументам.Активность
	|		И РасчетыСПоставщикамиПоДокументам.ПредоплатаРегл <> 0
	|		И НЕ &НоваяАрхитектураВзаиморасчетов
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		РасчетыСПоставщикамиПоДокументам.ЗаказПоставщику,
	|		ЛОЖЬ КАК Долгосрочный,
	|		РасчетыСПоставщикамиПоДокументам.Валюта,
	|		0,
	|		РасчетыСПоставщикамиПоДокументам.ПредоплатаРегл,
	|		0,
	|		-РасчетыСПоставщикамиПоДокументам.ПредоплатаРегл,
	|		РасчетыСПоставщикамиПоДокументам.ХозяйственнаяОперация,
	|		РасчетыСПоставщикамиПоДокументам.Регистратор
	|	ИЗ
	|		РегистрНакопления.РасчетыСПоставщикамиПоДокументам КАК РасчетыСПоставщикамиПоДокументам
	|	ГДЕ
	|		РасчетыСПоставщикамиПоДокументам.Регистратор ССЫЛКА Документ.КорректировкаПриобретения
	|		И РасчетыСПоставщикамиПоДокументам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И РасчетыСПоставщикамиПоДокументам.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И РасчетыСПоставщикамиПоДокументам.Активность
	|		И РасчетыСПоставщикамиПоДокументам.ПредоплатаРегл <> 0
	|		И НЕ &НоваяАрхитектураВзаиморасчетов
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		Расчеты.ОбъектРасчетов,
	|		РАЗНОСТЬДАТ(Расчеты.Период, Расчеты.ДатаПлановогоПогашения, МЕСЯЦ) >= ЕСТЬNULL(УчетнаяПолитикаОрганизаций.МесяцыДолгосрочнойЗадолженности, 999) КАК Долгосрочный,
	|		Расчеты.Валюта,
	|		ВЫБОР
	|			КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			ТОГДА Расчеты.ДолгРегл
	|			ИНАЧЕ 0
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|			ТОГДА Расчеты.ДолгРегл
	|			ИНАЧЕ 0
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|				И (НЕ Расчеты.ХозяйственнаяОперация В (&ИсключаемыеХозОперацииПоАвансам) ИЛИ Расчеты.ДокументРегистратор ССЫЛКА Документ.ВзаимозачетЗадолженности
	|					ИЛИ ВЫРАЗИТЬ(Расчеты.ОбъектРасчетов.Объект КАК Документ.ПоступлениеБезналичныхДенежныхСредств).ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДенежныхСредствОтПоставщика)
	|					ИЛИ ВЫРАЗИТЬ(Расчеты.ОбъектРасчетов.Объект КАК Документ.ПриходныйКассовыйОрдер).ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДенежныхСредствОтПоставщика))
	|			ТОГДА Расчеты.ПредоплатаРегл
	|			ИНАЧЕ 0
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|				И (НЕ Расчеты.ХозяйственнаяОперация В (&ИсключаемыеХозОперацииПоАвансам) ИЛИ Расчеты.ДокументРегистратор ССЫЛКА Документ.ВзаимозачетЗадолженности
	|					ИЛИ ВЫРАЗИТЬ(Расчеты.ДокументРегистратор КАК Документ.ПоступлениеБезналичныхДенежныхСредств).ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДенежныхСредствОтПоставщика)
	|					ИЛИ ВЫРАЗИТЬ(Расчеты.ДокументРегистратор КАК Документ.ПриходныйКассовыйОрдер).ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДенежныхСредствОтПоставщика))
	|			ТОГДА Расчеты.ПредоплатаРегл
	|			ИНАЧЕ 0
	|		КОНЕЦ,
	|		ВЫБОР 
	|			КОГДА ВЫРАЗИТЬ(Расчеты.ОбъектРасчетов.Объект КАК Документ.ПоступлениеБезналичныхДенежныхСредств).ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДенежныхСредствОтПоставщика)
	|					ИЛИ ВЫРАЗИТЬ(Расчеты.ОбъектРасчетов.Объект КАК Документ.ПриходныйКассовыйОрдер).ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДенежныхСредствОтПоставщика)
	|				ТОГДА ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДенежныхСредствОтПоставщика)
	|			ИНАЧЕ
	|				Расчеты.ХозяйственнаяОперация
	|		КОНЕЦ,
	|		Расчеты.ДокументРегистратор
	|	ИЗ
	|		РегистрНакопления.РасчетыСПоставщикамиПоСрокам КАК Расчеты
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТУчетнаяПолитикаОрганизацийПоПериодам КАК УчетнаяПолитикаОрганизаций
	|		ПО Расчеты.АналитикаУчетаПоПартнерам.Организация = УчетнаяПолитикаОрганизаций.Организация
	|			И Расчеты.Период >= УчетнаяПолитикаОрганизаций.НачалоДействия
	|			И Расчеты.Период <= УчетнаяПолитикаОрганизаций.ОкончаниеДействия
	|			И УчетнаяПолитикаОрганизаций.ДолгосрочныеАктивыОбязательства
	|	ГДЕ
	|		Расчеты.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И Расчеты.Активность
	|		И &НоваяАрхитектураВзаиморасчетов
	|		И НЕ (Расчеты.ДокументРегистратор ССЫЛКА Документ.Бронирование И Расчеты.ОбъектРасчетов.ТипОбъектаРасчетов <> Значение(Перечисление.ТипыОбъектовРасчетов.Договор))
	|	
	|	) КАК РасчетыСПоставщиками
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ОбъектыРасчетов КАК ОбъектыРасчетов
	|		ПО (ОбъектыРасчетов.Ссылка = РасчетыСПоставщиками.ОбъектРасчетов)
	|ГДЕ
	|	ОбъектыРасчетов.Организация В(&МассивОрганизаций)
	|
	|СГРУППИРОВАТЬ ПО
	|	ОбъектыРасчетов.Объект ССЫЛКА Документ.ВозвратТоваровПоставщику ИЛИ ОбъектыРасчетов.Объект ССЫЛКА Документ.ВозвратТоваровМеждуОрганизациями,
	|	РасчетыСПоставщиками.Регистратор,
	|	ОбъектыРасчетов.Ссылка,
	|	ОбъектыРасчетов.Организация,
	|	ОбъектыРасчетов.Контрагент,
	|	ОбъектыРасчетов.Подразделение,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета,
	|	РасчетыСПоставщиками.Долгосрочный
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ОбъектыРасчетов.Ссылка,
	|	ДвиженияКонтрагентКонтрагент.Организация,
	|	ДвиженияКонтрагентКонтрагент.Подразделение,
	|	ДвиженияКонтрагентКонтрагент.Контрагент,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета,
	|	ОбъектыРасчетов.Объект ССЫЛКА Документ.ВозвратТоваровПоставщику ИЛИ ОбъектыРасчетов.Объект ССЫЛКА Документ.ВозвратТоваровМеждуОрганизациями КАК РасчетыПоПретензиям,
	|	ЛОЖЬ,
	|	СУММА(ВЫБОР
	|			КОГДА ДвиженияКонтрагентКонтрагент.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммЗадолженности.ДолгПоставщику)
	|				ТОГДА ДвиженияКонтрагентКонтрагент.СуммаРеглОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ),
	|	СУММА(ВЫБОР
	|			КОГДА ДвиженияКонтрагентКонтрагент.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммЗадолженности.ДолгПоставщику)
	|				ТОГДА ДвиженияКонтрагентКонтрагент.СуммаРеглОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ),
	|	СУММА(ВЫБОР
	|			КОГДА ДвиженияКонтрагентКонтрагент.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммЗадолженности.АвансВыданный)
	|				ТОГДА ДвиженияКонтрагентКонтрагент.СуммаРеглОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ),
	|	СУММА(ВЫБОР
	|			КОГДА ДвиженияКонтрагентКонтрагент.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммЗадолженности.АвансВыданный)
	|				ТОГДА ДвиженияКонтрагентКонтрагент.СуммаРеглОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ),
	|	ДвиженияКонтрагентКонтрагент.Регистратор
	|ИЗ
	|	РегистрНакопления.ДвиженияКонтрагентКонтрагент.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			Регистратор,
	|			ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВзаимозачетЗадолженности)
	|				И ТипСуммы В (ЗНАЧЕНИЕ(Перечисление.ТипыСуммЗадолженности.АвансВыданный), ЗНАЧЕНИЕ(Перечисление.ТипыСуммЗадолженности.ДолгПоставщику))
	|				И Организация В (&МассивОрганизаций)) КАК ДвиженияКонтрагентКонтрагент
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ОбъектыРасчетов КАК ОбъектыРасчетов
	|		ПО (ОбъектыРасчетов.Ссылка = ДвиженияКонтрагентКонтрагент.ОбъектРасчетов)
	|ГДЕ
	|	ДвиженияКонтрагентКонтрагент.Организация <> ОбъектыРасчетов.Организация
	|	И НЕ &НоваяАрхитектураВзаиморасчетов
	|
	|СГРУППИРОВАТЬ ПО
	|	ОбъектыРасчетов.Объект ССЫЛКА Документ.ВозвратТоваровПоставщику ИЛИ ОбъектыРасчетов.Объект ССЫЛКА Документ.ВозвратТоваровМеждуОрганизациями,
	|	ДвиженияКонтрагентКонтрагент.Регистратор,
	|	ДвиженияКонтрагентКонтрагент.Контрагент,
	|	ДвиженияКонтрагентКонтрагент.Подразделение,
	|	ДвиженияКонтрагентКонтрагент.Организация,
	|	ОбъектыРасчетов.Ссылка,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область РасчетыСКлиентами
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ОбъектыРасчетов.Ссылка КАК ОбъектРасчетов,
	|	ОбъектыРасчетов.Организация КАК Организация,
	|	ОбъектыРасчетов.Подразделение КАК Подразделение,
	|	ОбъектыРасчетов.Контрагент КАК Контрагент,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	РасчетыСКлиентами.Долгосрочный КАК Долгосрочный,
	|	СУММА(РасчетыСКлиентами.ДолгРеглПриход) КАК ДолгРеглПриход,
	|	СУММА(РасчетыСКлиентами.ДолгРеглРасход) КАК ДолгРеглРасход,
	|	СУММА(РасчетыСКлиентами.ПредоплатаРеглПриход) КАК ПредоплатаРеглПриход,
	|	СУММА(РасчетыСКлиентами.ПредоплатаРеглРасход) КАК ПредоплатаРеглРасход,
	|	РасчетыСКлиентами.Регистратор КАК Регистратор
	|ПОМЕСТИТЬ ВТ_РасчетыСКлиентамиРег
	|ИЗ
	|	(ВЫБРАТЬ
	|		РасчетыСКлиентамиПоДокументам.ЗаказКлиента КАК ОбъектРасчетов,
	|		ЛОЖЬ КАК Долгосрочный,
	|		РасчетыСКлиентамиПоДокументам.Валюта КАК Валюта,
	|		РасчетыСКлиентамиПоДокументам.ДолгРегл КАК ДолгРеглПриход,
	|		0 КАК ДолгРеглРасход,
	|		ВЫБОР
	|		КОГДА РасчетыСКлиентамиПоДокументам.Регистратор <> РасчетыСКлиентамиПоДокументам.РасчетныйДокумент
	|		ТОГДА РасчетыСКлиентамиПоДокументам.ПредоплатаРегл
	|		ИНАЧЕ 0 КОНЕЦ КАК ПредоплатаРеглПриход,
	|		0 КАК ПредоплатаРеглРасход,
	|		РасчетыСКлиентамиПоДокументам.Регистратор КАК Регистратор
	|	ИЗ
	|		РегистрНакопления.РасчетыСКлиентамиПоДокументам КАК РасчетыСКлиентамиПоДокументам
	|	ГДЕ
	|		РасчетыСКлиентамиПоДокументам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|		И РасчетыСКлиентамиПоДокументам.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И РасчетыСКлиентамиПоДокументам.Активность
	|		И НЕ &НоваяАрхитектураВзаиморасчетов
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		РасчетыСКлиентамиПоДокументам.ЗаказКлиента,
	|		ЛОЖЬ КАК Долгосрочный,
	|		РасчетыСКлиентамиПоДокументам.Валюта,
	|		ВЫБОР
	|			КОГДА РасчетыСКлиентамиПоДокументам.ДолгРегл < 0
	|				ТОГДА -РасчетыСКлиентамиПоДокументам.ДолгРегл
	|			ИНАЧЕ 0
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА РасчетыСКлиентамиПоДокументам.ДолгРегл < 0
	|				ТОГДА 0
	|			ИНАЧЕ РасчетыСКлиентамиПоДокументам.ДолгРегл
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА РасчетыСКлиентамиПоДокументам.ПредоплатаРегл < 0
	|				ТОГДА -РасчетыСКлиентамиПоДокументам.ПредоплатаРегл
	|			ИНАЧЕ 0
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА РасчетыСКлиентамиПоДокументам.ПредоплатаРегл < 0
	|				ТОГДА 0
	|			ИНАЧЕ РасчетыСКлиентамиПоДокументам.ПредоплатаРегл
	|		КОНЕЦ,
	|		РасчетыСКлиентамиПоДокументам.Регистратор
	|	ИЗ
	|		РегистрНакопления.РасчетыСКлиентамиПоДокументам КАК РасчетыСКлиентамиПоДокументам
	|	ГДЕ
	|		НЕ(РасчетыСКлиентамиПоДокументам.Регистратор ССЫЛКА Документ.КорректировкаРеализации
	|					ИЛИ РасчетыСКлиентамиПоДокументам.Регистратор ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|					ИЛИ РасчетыСКлиентамиПоДокументам.Регистратор ССЫЛКА Документ.ВозвратТоваровМеждуОрганизациями)
	|		И РасчетыСКлиентамиПоДокументам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И РасчетыСКлиентамиПоДокументам.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И НЕ РасчетыСКлиентамиПоДокументам.ХозяйственнаяОперация В (&ИсключаемыеХозОперацииПоАвансам)
	|		И РасчетыСКлиентамиПоДокументам.Активность
	|		И НЕ &НоваяАрхитектураВзаиморасчетов
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		РасчетыСКлиентамиПоДокументам.ЗаказКлиента,
	|		ЛОЖЬ КАК Долгосрочный,
	|		РасчетыСКлиентамиПоДокументам.Валюта,
	|		РасчетыСКлиентамиПоДокументам.ПредоплатаРегл,
	|		РасчетыСКлиентамиПоДокументам.ПредоплатаРегл,
	|		0,
	|		0,
	|		РасчетыСКлиентамиПоДокументам.Регистратор
	|	ИЗ
	|		РегистрНакопления.РасчетыСКлиентамиПоДокументам КАК РасчетыСКлиентамиПоДокументам
	|	ГДЕ
	|		НЕ(РасчетыСКлиентамиПоДокументам.Регистратор ССЫЛКА Документ.КорректировкаРеализации
	|					ИЛИ РасчетыСКлиентамиПоДокументам.Регистратор ССЫЛКА Документ.ВзаимозачетЗадолженности)
	|		И РасчетыСКлиентамиПоДокументам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|		И РасчетыСКлиентамиПоДокументам.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И РасчетыСКлиентамиПоДокументам.Регистратор = РасчетыСКлиентамиПоДокументам.РасчетныйДокумент
	|		И РасчетыСКлиентамиПоДокументам.Активность
	|		И РасчетыСКлиентамиПоДокументам.ПредоплатаРегл <> 0
	|		И НЕ &НоваяАрхитектураВзаиморасчетов
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		РасчетыСКлиентамиПоДокументам.ЗаказКлиента,
	|		ЛОЖЬ КАК Долгосрочный,
	|		РасчетыСКлиентамиПоДокументам.Валюта,
	|		-РасчетыСКлиентамиПоДокументам.ПредоплатаРегл - РасчетыСКлиентамиПоДокументам.ДолгРегл,
	|		0,
	|		0,
	|		0,
	|		РасчетыСКлиентамиПоДокументам.Регистратор
	|	ИЗ
	|		РегистрНакопления.РасчетыСКлиентамиПоДокументам КАК РасчетыСКлиентамиПоДокументам
	|	ГДЕ
	|		(РасчетыСКлиентамиПоДокументам.Регистратор ССЫЛКА Документ.КорректировкаРеализации
	|				ИЛИ РасчетыСКлиентамиПоДокументам.Регистратор ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|				ИЛИ РасчетыСКлиентамиПоДокументам.Регистратор ССЫЛКА Документ.ВозвратТоваровМеждуОрганизациями)
	|		И РасчетыСКлиентамиПоДокументам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И РасчетыСКлиентамиПоДокументам.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И РасчетыСКлиентамиПоДокументам.Активность
	|		И НЕ &НоваяАрхитектураВзаиморасчетов
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		РасчетыСКлиентамиПоДокументам.ЗаказКлиента,
	|		ЛОЖЬ КАК Долгосрочный,
	|		РасчетыСКлиентамиПоДокументам.Валюта,
	|		0,
	|		-РасчетыСКлиентамиПоДокументам.ПредоплатаРегл,
	|		-РасчетыСКлиентамиПоДокументам.ПредоплатаРегл,
	|		0,
	|		РасчетыСКлиентамиПоДокументам.Регистратор
	|	ИЗ
	|		РегистрНакопления.РасчетыСКлиентамиПоДокументам КАК РасчетыСКлиентамиПоДокументам
	|	ГДЕ
	|		(РасчетыСКлиентамиПоДокументам.Регистратор ССЫЛКА Документ.КорректировкаРеализации
	|				ИЛИ РасчетыСКлиентамиПоДокументам.Регистратор ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|				ИЛИ РасчетыСКлиентамиПоДокументам.Регистратор ССЫЛКА Документ.ВозвратТоваровМеждуОрганизациями)
	|		И РасчетыСКлиентамиПоДокументам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И РасчетыСКлиентамиПоДокументам.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И РасчетыСКлиентамиПоДокументам.Активность
	|		И РасчетыСКлиентамиПоДокументам.ПредоплатаРегл <> 0
	|		И НЕ &НоваяАрхитектураВзаиморасчетов
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		Расчеты.ОбъектРасчетов,
	|		РАЗНОСТЬДАТ(Расчеты.Период, Расчеты.ДатаПлановогоПогашения, МЕСЯЦ) >= ЕСТЬNULL(УчетнаяПолитикаОрганизаций.МесяцыДолгосрочнойЗадолженности, 999) КАК Долгосрочный,
	|		Расчеты.Валюта,
	|		ВЫБОР
	|			КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|			ТОГДА Расчеты.ДолгРегл
	|			ИНАЧЕ 0
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			ТОГДА Расчеты.ДолгРегл
	|			ИНАЧЕ 0
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			ТОГДА Расчеты.ПредоплатаРегл
	|			ИНАЧЕ 0
	|		КОНЕЦ,
	|		ВЫБОР
	|			КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|			ТОГДА Расчеты.ПредоплатаРегл
	|			ИНАЧЕ 0
	|		КОНЕЦ,
	|		Расчеты.ДокументРегистратор
	|	ИЗ
	|		РегистрНакопления.РасчетыСКлиентамиПоСрокам КАК Расчеты
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТУчетнаяПолитикаОрганизацийПоПериодам КАК УчетнаяПолитикаОрганизаций
	|		ПО Расчеты.АналитикаУчетаПоПартнерам.Организация = УчетнаяПолитикаОрганизаций.Организация
	|			И Расчеты.Период >= УчетнаяПолитикаОрганизаций.НачалоДействия
	|			И Расчеты.Период <= УчетнаяПолитикаОрганизаций.ОкончаниеДействия
	|			И УчетнаяПолитикаОрганизаций.ДолгосрочныеАктивыОбязательства
	|	ГДЕ
	|		Расчеты.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И Расчеты.Активность
	|		И &НоваяАрхитектураВзаиморасчетов) КАК РасчетыСКлиентами
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ОбъектыРасчетов КАК ОбъектыРасчетов
	|		ПО (ОбъектыРасчетов.Ссылка = РасчетыСКлиентами.ОбъектРасчетов)
	|ГДЕ
	|	ОбъектыРасчетов.Организация В (&МассивОрганизаций)
	|
	|СГРУППИРОВАТЬ ПО
	|	ОбъектыРасчетов.Организация,
	|	ОбъектыРасчетов.Подразделение,
	|	ОбъектыРасчетов.Ссылка,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета,
	|	РасчетыСКлиентами.Регистратор,
	|	ОбъектыРасчетов.Контрагент,
	|	РасчетыСКлиентами.Долгосрочный
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ОбъектыРасчетов.Ссылка,
	|	ДвиженияКонтрагентКонтрагент.Организация,
	|	ДвиженияКонтрагентКонтрагент.Подразделение,
	|	ДвиженияКонтрагентКонтрагент.КорКонтрагент,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета,
	|	ЛОЖЬ,
	|	СУММА(ВЫБОР
	|			КОГДА ДвиженияКонтрагентКонтрагент.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммЗадолженности.ДолгКлиента)
	|				ТОГДА ДвиженияКонтрагентКонтрагент.СуммаРеглОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ),
	|	СУММА(ВЫБОР
	|			КОГДА ДвиженияКонтрагентКонтрагент.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммЗадолженности.ДолгКлиента)
	|				ТОГДА ДвиженияКонтрагентКонтрагент.СуммаРеглОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ),
	|	СУММА(ВЫБОР
	|			КОГДА ДвиженияКонтрагентКонтрагент.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммЗадолженности.АвансПолученный)
	|				ТОГДА ДвиженияКонтрагентКонтрагент.СуммаРеглОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ),
	|	СУММА(ВЫБОР
	|			КОГДА ДвиженияКонтрагентКонтрагент.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммЗадолженности.АвансПолученный)
	|				ТОГДА ДвиженияКонтрагентКонтрагент.СуммаРеглОборот
	|			ИНАЧЕ 0
	|		КОНЕЦ),
	|	ДвиженияКонтрагентКонтрагент.Регистратор
	|ИЗ
	|	РегистрНакопления.ДвиженияКонтрагентКонтрагент.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			Регистратор,
	|			ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВзаимозачетЗадолженности)
	|				И ТипСуммы В (ЗНАЧЕНИЕ(Перечисление.ТипыСуммЗадолженности.АвансПолученный), ЗНАЧЕНИЕ(Перечисление.ТипыСуммЗадолженности.ДолгКлиента))
	|				И Организация В (&МассивОрганизаций)) КАК ДвиженияКонтрагентКонтрагент
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ОбъектыРасчетов КАК ОбъектыРасчетов
	|		ПО (ОбъектыРасчетов.Ссылка = ДвиженияКонтрагентКонтрагент.ОбъектРасчетов)
	|ГДЕ
	|	ДвиженияКонтрагентКонтрагент.Организация <> ОбъектыРасчетов.Организация
	|	И НЕ &НоваяАрхитектураВзаиморасчетов
	|
	|СГРУППИРОВАТЬ ПО
	|	ДвиженияКонтрагентКонтрагент.Регистратор,
	|	ДвиженияКонтрагентКонтрагент.Организация,
	|	ОбъектыРасчетов.Ссылка,
	|	ДвиженияКонтрагентКонтрагент.КорКонтрагент,
	|	ДвиженияКонтрагентКонтрагент.Подразделение,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область РасчетыПоКредитамДепозитам
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	КлючиАналитики.Организация КАК Организация,
	|	РасчетыПоКредитамДепозитам.Договор КАК Договор,
	|	РасчетыПоКредитамДепозитам.ТипСуммы КАК ТипСуммы,
	|	ЛОЖЬ КАК Долгосрочный,
	|	СУММА(РасчетыПоКредитамДепозитам.СуммаРеглПриход) КАК СуммаРеглПриход,
	|	СУММА(РасчетыПоКредитамДепозитам.СуммаРеглРасход) КАК СуммаРеглРасход,
	|	РасчетыПоКредитамДепозитам.Регистратор КАК Регистратор
	|ПОМЕСТИТЬ ВТ_РасчетыПоКредитамДепозитамРег
	|ИЗ
	|	РегистрНакопления.РасчетыПоФинансовымИнструментам.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, Регистратор, Движения,) КАК РасчетыПоКредитамДепозитам
	|		
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.КлючиАналитикиУчетаПоПартнерам КАК КлючиАналитики
	|		ПО (КлючиАналитики.Ссылка = РасчетыПоКредитамДепозитам.АналитикаУчетаПоПартнерам)
	|ГДЕ
	|	КлючиАналитики.Организация В(&МассивОрганизаций)
	|
	|СГРУППИРОВАТЬ ПО
	|	КлючиАналитики.Организация,
	|	РасчетыПоКредитамДепозитам.Договор,
	|	РасчетыПоКредитамДепозитам.Регистратор,
	|	РасчетыПоКредитамДепозитам.ТипСуммы";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область РасчетыПоЛизингу
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	КлючиАналитики.Организация КАК Организация,
	|	КлючиАналитики.Контрагент КАК Контрагент,
	|	РасчетыПоЛизингу.ТипСуммы КАК ТипСуммы,
	|	ДанныеДоговора.Ссылка КАК Договор,
	|	ДанныеДоговора.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	ДанныеДоговора.Подразделение КАК Подразделение,
	|	ЛОЖЬ КАК Долгосрочный,
	|	СУММА(РасчетыПоЛизингу.СуммаРеглПриход) КАК СуммаРеглПриход,
	|	СУММА(РасчетыПоЛизингу.СуммаРеглРасход) КАК СуммаРеглРасход,
	|	РасчетыПоЛизингу.Регистратор КАК Регистратор
	|ПОМЕСТИТЬ ВТ_РасчетыПоЛизингуРег
	|ИЗ
	|	РегистрНакопления.РасчетыПоФинансовымИнструментам.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, Регистратор, Движения, ) КАК РасчетыПоЛизингу
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.КлючиАналитикиУчетаПоПартнерам КАК КлючиАналитики
	|		ПО (КлючиАналитики.Ссылка = РасчетыПоЛизингу.АналитикаУчетаПоПартнерам)
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ДоговорыАренды КАК ДанныеДоговора
	|		ПО (ДанныеДоговора.Ссылка = РасчетыПоЛизингу.Договор)
	|ГДЕ
	|	КлючиАналитики.Организация В(&МассивОрганизаций)
	|
	|СГРУППИРОВАТЬ ПО
	|	РасчетыПоЛизингу.Регистратор,
	|	КлючиАналитики.Организация,
	|	ДанныеДоговора.Ссылка,
	|	КлючиАналитики.Контрагент,
	|	РасчетыПоЛизингу.ТипСуммы,
	|	ДанныеДоговора.ГруппаФинансовогоУчета,
	|	ДанныеДоговора.Подразделение";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область НеотфактурованныеПоставки
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	НеотфактурованныеПоставки.Организация КАК Организация,
	|	АналитикаПартии.Контрагент КАК Контрагент,
	|	АналитикаПартии.Договор КАК Договор,
	|	ДанныеДоговора.Подразделение КАК Подразделение,
	|	ДанныеДоговора.НаправлениеДеятельности,
	|	ДанныеДоговора.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	ЛОЖЬ КАК Долгосрочный,
	|	СУММА(НеотфактурованныеПоставки.СтоимостьРеглПриход) КАК СтоимостьРеглПриход,
	|	СУММА(НеотфактурованныеПоставки.СтоимостьРеглРасход) КАК СтоимостьРеглРасход,
	|	НеотфактурованныеПоставки.Регистратор КАК Регистратор
	|ПОМЕСТИТЬ ВТ_НеотфактурованныеПоставкиРег
	|ИЗ
	|	РегистрНакопления.СебестоимостьТоваров.ОстаткиИОбороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			Регистратор,
	|			Движения,
	|			Организация В (&МассивОрганизаций)
	|				И РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НеотфактурованныеПоставки)) КАК НеотфактурованныеПоставки
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ПоступлениеТоваровНаСклад КАК АналитикаПартии
	|		ПО (АналитикаПартии.Ссылка = НеотфактурованныеПоставки.ВидЗапасов)
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ДоговорыКонтрагентов КАК ДанныеДоговора
	|		ПО (ДанныеДоговора.Ссылка = АналитикаПартии.Договор)
	|
	|СГРУППИРОВАТЬ ПО
	|	АналитикаПартии.Договор,
	|	НеотфактурованныеПоставки.Организация,
	|	ДанныеДоговора.НаправлениеДеятельности,
	|	ДанныеДоговора.Подразделение,
	|	НеотфактурованныеПоставки.Регистратор,
	|	АналитикаПартии.Контрагент,
	|	ДанныеДоговора.ГруппаФинансовогоУчета";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область РасчетыСПоставщикамиОУ
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ВТ_РасчетыСПоставщикамиРег.ОбъектРасчетов КАК ОбъектРасчетов,
	|	ВТ_РасчетыСПоставщикамиРег.Организация КАК Организация,
	|	ВТ_РасчетыСПоставщикамиРег.Контрагент КАК Контрагент,
	|	МАКСИМУМ(ВЫБОР
	|		КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО)) = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками)
	|		ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|		ИНАЧЕ &ПустойСчет
	|	КОНЕЦ) КАК СчетУчетаРасчетов,
	|	ВЫБОР
	|		КОГДА ВТ_РасчетыСПоставщикамиРег.РасчетыПоПретензиям
	|			ТОГДА МАКСИМУМ(ВЫБОР
	|						КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО)) = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками)
	|						ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|						ИНАЧЕ &ПустойСчет
	|					КОНЕЦ)
	|		ИНАЧЕ МАКСИМУМ(ВЫБОР
	|					КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО)) = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыВыданные)
	|					ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|					ИНАЧЕ &ПустойСчет
	|				КОНЕЦ)
	|	КОНЕЦ КАК СчетУчетаАванса,
	|	ВТ_РасчетыСПоставщикамиРег.Подразделение КАК Подразделение,
	|	ВТ_РасчетыСПоставщикамиРег.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	(ВТ_РасчетыСПоставщикамиРег.ДолгРеглПриход) КАК ДолгРеглПриход,
	|	(ВТ_РасчетыСПоставщикамиРег.ДолгРеглРасход) КАК ДолгРеглРасход,
	|	(ВТ_РасчетыСПоставщикамиРег.ПредоплатаРеглПриход) КАК ПредоплатаРеглПриход,
	|	(ВТ_РасчетыСПоставщикамиРег.ПредоплатаРеглРасход) КАК ПредоплатаРеглРасход,
	|	ВТ_РасчетыСПоставщикамиРег.Регистратор КАК Регистратор
	|ПОМЕСТИТЬ ВТ_РасчетыСПоставщиками
	|ИЗ
	|	ВТ_РасчетыСПоставщикамиРег КАК ВТ_РасчетыСПоставщикамиРег
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоОрганизации
	|		ПО (НастройкиПоОрганизации.ВидСчета В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыВыданные)))
	|			И (НастройкиПоОрганизации.Организация = ВТ_РасчетыСПоставщикамиРег.Организация)
	|			И (НастройкиПоОрганизации.АналитикаУчета = ВТ_РасчетыСПоставщикамиРег.ГруппаФинансовогоУчета)
	|			И (НастройкиПоОрганизации.МестоУчета = НЕОПРЕДЕЛЕНО)
	|			И (НастройкиПоОрганизации.Долгосрочный = ВТ_РасчетыСПоставщикамиРег.Долгосрочный)
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоАналитике
	|		ПО (НастройкиПоАналитике.ВидСчета В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыВыданные)))
	|			И (НастройкиПоАналитике.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))
	|			И (НастройкиПоАналитике.АналитикаУчета = ВТ_РасчетыСПоставщикамиРег.ГруппаФинансовогоУчета)
	|			И (НастройкиПоАналитике.МестоУчета = НЕОПРЕДЕЛЕНО)
	|			И (НастройкиПоАналитике.Долгосрочный = ВТ_РасчетыСПоставщикамиРег.Долгосрочный)
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ_РасчетыСПоставщикамиРег.ОбъектРасчетов,
	|	ВТ_РасчетыСПоставщикамиРег.Организация,
	|	ВТ_РасчетыСПоставщикамиРег.Контрагент,
	|	ВТ_РасчетыСПоставщикамиРег.РасчетыПоПретензиям,
	|	ВТ_РасчетыСПоставщикамиРег.Подразделение,
	|	ВТ_РасчетыСПоставщикамиРег.ГруппаФинансовогоУчета,
	|	ВТ_РасчетыСПоставщикамиРег.Регистратор,
	|	(ВТ_РасчетыСПоставщикамиРег.ДолгРеглПриход),
	|	(ВТ_РасчетыСПоставщикамиРег.ДолгРеглРасход),
	|	(ВТ_РасчетыСПоставщикамиРег.ПредоплатаРеглПриход),
	|	(ВТ_РасчетыСПоставщикамиРег.ПредоплатаРеглРасход)";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область РасчетыСКлиентамиОУ
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ВТ_РасчетыСКлиентамиРег.ОбъектРасчетов КАК ОбъектРасчетов,
	|	ВТ_РасчетыСКлиентамиРег.Организация КАК Организация,
	|	ВТ_РасчетыСКлиентамиРег.Контрагент КАК Контрагент,
	|	МАКСИМУМ(ВЫБОР
	|			КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО)) = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами)
	|				ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|			ИНАЧЕ &ПустойСчет
	|		КОНЕЦ) КАК СчетУчетаРасчетов,
	|	МАКСИМУМ(ВЫБОР
	|			КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО)) = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыПолученные)
	|				ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|			ИНАЧЕ &ПустойСчет
	|		КОНЕЦ) КАК СчетУчетаАванса,
	|	ВТ_РасчетыСКлиентамиРег.Подразделение КАК Подразделение,
	|	ВТ_РасчетыСКлиентамиРег.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	(ВТ_РасчетыСКлиентамиРег.ДолгРеглПриход) КАК ДолгРеглПриход,
	|	(ВТ_РасчетыСКлиентамиРег.ДолгРеглРасход) КАК ДолгРеглРасход,
	|	(ВТ_РасчетыСКлиентамиРег.ПредоплатаРеглПриход) КАК ПредоплатаРеглПриход,
	|	(ВТ_РасчетыСКлиентамиРег.ПредоплатаРеглРасход) КАК ПредоплатаРеглРасход,
	|	ВТ_РасчетыСКлиентамиРег.Регистратор КАК Регистратор
	|ПОМЕСТИТЬ ВТ_РасчетыСКлиентами
	|ИЗ
	|	ВТ_РасчетыСКлиентамиРег КАК ВТ_РасчетыСКлиентамиРег
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоОрганизации
	|		ПО (НастройкиПоОрганизации.ВидСчета В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыПолученные)))
	|			И (НастройкиПоОрганизации.Организация = ВТ_РасчетыСКлиентамиРег.Организация)
	|			И (НастройкиПоОрганизации.АналитикаУчета = ВТ_РасчетыСКлиентамиРег.ГруппаФинансовогоУчета)
	|			И (НастройкиПоОрганизации.МестоУчета = НЕОПРЕДЕЛЕНО)
	|			И (НастройкиПоОрганизации.Долгосрочный = ВТ_РасчетыСКлиентамиРег.Долгосрочный)
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоАналитике
	|		ПО (НастройкиПоАналитике.ВидСчета В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыПолученные)))
	|			И (НастройкиПоАналитике.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))
	|			И (НастройкиПоАналитике.АналитикаУчета = ВТ_РасчетыСКлиентамиРег.ГруппаФинансовогоУчета)
	|			И (НастройкиПоАналитике.МестоУчета = НЕОПРЕДЕЛЕНО)
	|			И (НастройкиПоАналитике.Долгосрочный = ВТ_РасчетыСКлиентамиРег.Долгосрочный)
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ_РасчетыСКлиентамиРег.ОбъектРасчетов,
	|	ВТ_РасчетыСКлиентамиРег.Организация,
	|	ВТ_РасчетыСКлиентамиРег.Контрагент,
	|	ВТ_РасчетыСКлиентамиРег.Подразделение,
	|	ВТ_РасчетыСКлиентамиРег.ГруппаФинансовогоУчета,
	|	ВТ_РасчетыСКлиентамиРег.Регистратор,
	|	(ВТ_РасчетыСКлиентамиРег.ДолгРеглПриход),
	|	(ВТ_РасчетыСКлиентамиРег.ДолгРеглРасход),
	|	(ВТ_РасчетыСКлиентамиРег.ПредоплатаРеглПриход),
	|	(ВТ_РасчетыСКлиентамиРег.ПредоплатаРеглРасход)";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область РасчетыПоКредитамДепозитамОУ
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ВТ_РасчетыПоКредитамДепозитамРег.Организация КАК Организация,
	|	ВТ_РасчетыПоКредитамДепозитамРег.Договор КАК Договор,
	|	ВЫБОР
	|		КОГДА ДанныеДоговора.ХарактерДоговора = ЗНАЧЕНИЕ(Перечисление.ХарактерыДоговоровФинансовыхИнструментов.КредитИлиЗайм)
	|				И ВТ_РасчетыПоКредитамДепозитамРег.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммГрафикаКредитовИДепозитов.ОсновнойДолг)
	|			ТОГДА МАКСИМУМ(ВЫБОР
	|						КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО)) = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКредиторамиОсновнойДолг)
	|							ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|						ИНАЧЕ &ПустойСчет
	|					КОНЕЦ)
	|		КОГДА ДанныеДоговора.ХарактерДоговора = ЗНАЧЕНИЕ(Перечисление.ХарактерыДоговоровФинансовыхИнструментов.КредитИлиЗайм)
	|				И ВТ_РасчетыПоКредитамДепозитамРег.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммГрафикаКредитовИДепозитов.Проценты)
	|			ТОГДА МАКСИМУМ(ВЫБОР
	|						КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО)) = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКредиторамиПроценты)
	|							ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|						ИНАЧЕ &ПустойСчет
	|					КОНЕЦ)
	|		КОГДА ДанныеДоговора.ХарактерДоговора = ЗНАЧЕНИЕ(Перечисление.ХарактерыДоговоровФинансовыхИнструментов.КредитИлиЗайм)
	|				И ВТ_РасчетыПоКредитамДепозитамРег.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммГрафикаКредитовИДепозитов.Комиссия)
	|			ТОГДА МАКСИМУМ(ВЫБОР
	|						КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО)) = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКредиторамиКомиссия)
	|							ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|						ИНАЧЕ &ПустойСчет
	|					КОНЕЦ)
	|		КОГДА ДанныеДоговора.ХарактерДоговора <> ЗНАЧЕНИЕ(Перечисление.ХарактерыДоговоровФинансовыхИнструментов.КредитИлиЗайм)
	|				И ВТ_РасчетыПоКредитамДепозитамРег.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммГрафикаКредитовИДепозитов.ОсновнойДолг)
	|			ТОГДА МАКСИМУМ(ВЫБОР
	|						КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО)) = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСДебиторамиОсновнойДолг)
	|							ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|						ИНАЧЕ &ПустойСчет
	|					КОНЕЦ)
	|		КОГДА ДанныеДоговора.ХарактерДоговора <> ЗНАЧЕНИЕ(Перечисление.ХарактерыДоговоровФинансовыхИнструментов.КредитИлиЗайм)
	|				И ВТ_РасчетыПоКредитамДепозитамРег.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммГрафикаКредитовИДепозитов.Проценты)
	|			ТОГДА МАКСИМУМ(ВЫБОР
	|						КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО)) = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКредиторамиПроценты)
	|							ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|						ИНАЧЕ &ПустойСчет
	|					КОНЕЦ)
	|		КОГДА ДанныеДоговора.ХарактерДоговора <> ЗНАЧЕНИЕ(Перечисление.ХарактерыДоговоровФинансовыхИнструментов.КредитИлиЗайм)
	|				И ВТ_РасчетыПоКредитамДепозитамРег.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммГрафикаКредитовИДепозитов.Комиссия)
	|			ТОГДА МАКСИМУМ(ВЫБОР
	|						КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО)) = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСДебиторамиКомиссия)
	|							ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|						ИНАЧЕ &ПустойСчет
	|					КОНЕЦ)
	|	КОНЕЦ КАК Счет,
	|	ДанныеДоговора.Подразделение КАК Подразделение,
	|	ДанныеДоговора.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	(ВТ_РасчетыПоКредитамДепозитамРег.СуммаРеглПриход) КАК СуммаРеглПриход,
	|	(ВТ_РасчетыПоКредитамДепозитамРег.СуммаРеглРасход) КАК СуммаРеглРасход,
	|	ВТ_РасчетыПоКредитамДепозитамРег.Регистратор КАК Регистратор
	|ПОМЕСТИТЬ ВТ_РасчетыПоКредитамДепозитам
	|ИЗ
	|	ВТ_РасчетыПоКредитамДепозитамРег КАК ВТ_РасчетыПоКредитамДепозитамРег
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ДоговорыКредитовИДепозитов КАК ДанныеДоговора
	|		ПО (ДанныеДоговора.Ссылка = ВТ_РасчетыПоКредитамДепозитамРег.Договор)
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоОрганизации
	|		ПО (НастройкиПоОрганизации.ВидСчета В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКредиторамиОсновнойДолг), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКредиторамиКомиссия), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКредиторамиПроценты), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСДебиторамиОсновнойДолг), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСДебиторамиКомиссия), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСДебиторамиПроценты)))
	|			И (НастройкиПоОрганизации.Организация = ВТ_РасчетыПоКредитамДепозитамРег.Организация)
	|			И (НастройкиПоОрганизации.АналитикаУчета = ДанныеДоговора.ГруппаФинансовогоУчета)
	|			И (НастройкиПоОрганизации.МестоУчета = НЕОПРЕДЕЛЕНО)
	|			И (НастройкиПоОрганизации.Долгосрочный = ВТ_РасчетыПоКредитамДепозитамРег.Долгосрочный)
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоАналитике
	|		ПО (НастройкиПоАналитике.ВидСчета В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКредиторамиОсновнойДолг), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКредиторамиКомиссия), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКредиторамиПроценты), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСДебиторамиОсновнойДолг), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСДебиторамиКомиссия), ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСДебиторамиПроценты)))
	|			И (НастройкиПоАналитике.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))
	|			И (НастройкиПоАналитике.АналитикаУчета = ДанныеДоговора.ГруппаФинансовогоУчета)
	|			И (НастройкиПоАналитике.МестоУчета = НЕОПРЕДЕЛЕНО)
	|			И (НастройкиПоАналитике.Долгосрочный = ВТ_РасчетыПоКредитамДепозитамРег.Долгосрочный)
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ_РасчетыПоКредитамДепозитамРег.Организация,
	|	ВТ_РасчетыПоКредитамДепозитамРег.Договор,
	|	ДанныеДоговора.Подразделение,
	|	ДанныеДоговора.ХарактерДоговора,
	|	ВТ_РасчетыПоКредитамДепозитамРег.ТипСуммы,
	|	ДанныеДоговора.ГруппаФинансовогоУчета,
	|	ВТ_РасчетыПоКредитамДепозитамРег.Регистратор,
	|	(ВТ_РасчетыПоКредитамДепозитамРег.СуммаРеглПриход),
	|	(ВТ_РасчетыПоКредитамДепозитамРег.СуммаРеглРасход)";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область РасчетыПоЛизингуОУ
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ВТ_РасчетыПоЛизингуРег.Договор КАК Договор,
	|	ВТ_РасчетыПоЛизингуРег.Организация КАК Организация,
	|	ВТ_РасчетыПоЛизингуРег.Контрагент КАК Контрагент,
	|	ВЫБОР
	|		КОГДА ВТ_РасчетыПоЛизингуРег.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.УслугаПоАренде)
	|			ИЛИ ВТ_РасчетыПоЛизингуРег.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.УслугаПоАрендеАванс)
	|		ТОГДА МАКСИМУМ(ВЫБОР
	|				КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО))
	|					= ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.УслугаПоАренде)
	|				ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|				ИНАЧЕ &ПустойСчет
	|			КОНЕЦ)
	|		КОГДА ВТ_РасчетыПоЛизингуРег.ТипСуммы В (ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.ВыкупнаяСтоимость),
	|												ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.ВыкупнаяСтоимостьАванс))
	|		ТОГДА МАКСИМУМ(ВЫБОР
	|				КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО))
	|					= ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ВыкупнаяСтоимость)
	|				ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|				ИНАЧЕ &ПустойСчет
	|			КОНЕЦ)
	|		КОГДА ВТ_РасчетыПоЛизингуРег.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.ОбеспечительныйПлатеж)
	|		ТОГДА МАКСИМУМ(ВЫБОР
	|				КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО))
	|					= ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ОбеспечительныйПлатеж)
	|				ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|				ИНАЧЕ &ПустойСчет
	|			КОНЕЦ)
	|		КОГДА ВТ_РасчетыПоЛизингуРег.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.АрендныеОбязательства)
	|		ТОГДА МАКСИМУМ(ВЫБОР
	|				КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО))
	|					= ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АрендныеОбязательства)
	|				ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|				ИНАЧЕ &ПустойСчет
	|			КОНЕЦ)
	|		КОГДА ВТ_РасчетыПоЛизингуРег.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.Проценты)
	|		ТОГДА МАКСИМУМ(ВЫБОР
	|				КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО))
	|					= ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НачислениеПроцентовПоАренде)
	|				ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|				ИНАЧЕ &ПустойСчет
	|			КОНЕЦ)
	|		КОГДА ВТ_РасчетыПоЛизингуРег.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.НДС)
	|		ТОГДА МАКСИМУМ(ВЫБОР
	|				КОГДА ЕСТЬNULL(НастройкиПоОрганизации.ВидСчета, ЕСТЬNULL(НастройкиПоАналитике.ВидСчета, НЕОПРЕДЕЛЕНО))
	|					= ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НДСПриАренде)
	|				ТОГДА ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет))
	|				ИНАЧЕ &ПустойСчет
	|			КОНЕЦ)
	|	КОНЕЦ КАК Счет,
	|	ВТ_РасчетыПоЛизингуРег.Подразделение КАК Подразделение,
	|	ВТ_РасчетыПоЛизингуРег.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	(ВТ_РасчетыПоЛизингуРег.СуммаРеглПриход) КАК СуммаРеглПриход,
	|	(ВТ_РасчетыПоЛизингуРег.СуммаРеглРасход) КАК СуммаРеглРасход,
	|	ВТ_РасчетыПоЛизингуРег.Регистратор КАК Регистратор
	|ПОМЕСТИТЬ ВТ_РасчетыПоЛизингу
	|ИЗ
	|	ВТ_РасчетыПоЛизингуРег КАК ВТ_РасчетыПоЛизингуРег
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоОрганизации
	|		ПО (НастройкиПоОрганизации.ВидСчета В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.УслугаПоАренде),
	|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ОбеспечительныйПлатеж),
	|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ВыкупнаяСтоимость),
	|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АрендныеОбязательства),
	|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НачислениеПроцентовПоАренде),
	|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НДСПриАренде)))
	|			И (НастройкиПоОрганизации.Организация = ВТ_РасчетыПоЛизингуРег.Организация)
	|			И (НастройкиПоОрганизации.АналитикаУчета = ВТ_РасчетыПоЛизингуРег.ГруппаФинансовогоУчета)
	|			И (НастройкиПоОрганизации.МестоУчета = НЕОПРЕДЕЛЕНО)
	|			И (НастройкиПоОрганизации.Долгосрочный = ВТ_РасчетыПоЛизингуРег.Долгосрочный)
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоАналитике
	|		ПО (НастройкиПоАналитике.ВидСчета В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.УслугаПоАренде),
	|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ОбеспечительныйПлатеж),
	|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ВыкупнаяСтоимость),
	|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АрендныеОбязательства),
	|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НачислениеПроцентовПоАренде),
	|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НДСПриАренде)))
	|			И (НастройкиПоАналитике.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))
	|			И (НастройкиПоАналитике.АналитикаУчета = ВТ_РасчетыПоЛизингуРег.ГруппаФинансовогоУчета)
	|			И (НастройкиПоАналитике.МестоУчета = НЕОПРЕДЕЛЕНО)
	|			И (НастройкиПоАналитике.Долгосрочный = ВТ_РасчетыПоЛизингуРег.Долгосрочный)
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ_РасчетыПоЛизингуРег.Договор,
	|	ВТ_РасчетыПоЛизингуРег.Организация,
	|	ВТ_РасчетыПоЛизингуРег.Контрагент,
	|	ВТ_РасчетыПоЛизингуРег.Подразделение,
	|	ВТ_РасчетыПоЛизингуРег.ТипСуммы,
	|	ВТ_РасчетыПоЛизингуРег.ГруппаФинансовогоУчета,
	|	ВТ_РасчетыПоЛизингуРег.Регистратор,
	|	(ВТ_РасчетыПоЛизингуРег.СуммаРеглПриход),
	|	(ВТ_РасчетыПоЛизингуРег.СуммаРеглРасход)";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область НеотфактурованныеПоставкиОУ
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ВТ_НеотфактурованныеПоставкиРег.Организация КАК Организация,
	|	ВТ_НеотфактурованныеПоставкиРег.Контрагент КАК Контрагент,
	|	ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет)) КАК Счет,
	|	ВТ_НеотфактурованныеПоставкиРег.Подразделение КАК Подразделение,
	|	ВТ_НеотфактурованныеПоставкиРег.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	ВТ_НеотфактурованныеПоставкиРег.СтоимостьРеглПриход КАК СтоимостьРеглПриход,
	|	ВТ_НеотфактурованныеПоставкиРег.СтоимостьРеглРасход КАК СтоимостьРеглРасход,
	|	ВТ_НеотфактурованныеПоставкиРег.Регистратор КАК Регистратор
	|ПОМЕСТИТЬ ВТ_НеотфактурованныеПоставки
	|ИЗ
	|	ВТ_НеотфактурованныеПоставкиРег КАК ВТ_НеотфактурованныеПоставкиРег
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоОрганизации
	|		ПО (НастройкиПоОрганизации.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НеотфактурованныеПоставки))
	|			И (НастройкиПоОрганизации.Организация = ВТ_НеотфактурованныеПоставкиРег.Организация)
	|			И (НастройкиПоОрганизации.АналитикаУчета = ВТ_НеотфактурованныеПоставкиРег.ГруппаФинансовогоУчета)
	|			И (НастройкиПоОрганизации.МестоУчета = НЕОПРЕДЕЛЕНО)
	|			И (НастройкиПоОрганизации.Долгосрочный = ВТ_НеотфактурованныеПоставкиРег.Долгосрочный)
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоАналитике
	|		ПО (НастройкиПоАналитике.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НеотфактурованныеПоставки))
	|			И (НастройкиПоАналитике.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))
	|			И (НастройкиПоАналитике.АналитикаУчета = ВТ_НеотфактурованныеПоставкиРег.ГруппаФинансовогоУчета)
	|			И (НастройкиПоАналитике.МестоУчета = НЕОПРЕДЕЛЕНО)
	|			И (НастройкиПоАналитике.Долгосрочный = ВТ_НеотфактурованныеПоставкиРег.Долгосрочный)";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область ПрочиеРасчеты
	
	ТекстЗапроса = РегистрыСведений.ПорядокОтраженияНаСчетахУчета.ТекстЗапросаДанныеПрочихРасчетов(Истина, Истина);
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ДанныеПрочихРасчетов.Организация КАК Организация,
	|	ДанныеПрочихРасчетов.Контрагент КАК Контрагент,
	|	ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, &ПустойСчет)) КАК Счет,
	|	ДанныеПрочихРасчетов.Подразделение КАК Подразделение,
	|	ДанныеПрочихРасчетов.АналитикаУчета КАК ГруппаФинансовогоУчета,
	|	ДанныеПрочихРасчетов.СуммаРеглНачальныйОстаток КАК СтоимостьРеглНачальныйОстаток,
	|	ДанныеПрочихРасчетов.СуммаРеглПриход КАК СтоимостьРеглПриход,
	|	ДанныеПрочихРасчетов.СуммаРеглРасход КАК СтоимостьРеглРасход,
	|	ДанныеПрочихРасчетов.СуммаРеглКонечныйОстаток КАК СтоимостьРеглКонечныйОстаток,
	|	ДанныеПрочихРасчетов.Регистратор КАК Регистратор
	|ПОМЕСТИТЬ ВТ_ПрочиеРасчетыСКонтрагентами
	|ИЗ
	|	ВТ_ДанныеПрочихРасчетов КАК ДанныеПрочихРасчетов
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоОрганизации
	|		ПО НастройкиПоОрганизации.ВидСчета = ДанныеПрочихРасчетов.ВидСчета
	|			И НастройкиПоОрганизации.Организация = ДанныеПрочихРасчетов.Организация
	|			И НастройкиПоОрганизации.АналитикаУчета = ДанныеПрочихРасчетов.АналитикаУчета
	|			И НастройкиПоОрганизации.МестоУчета = НЕОПРЕДЕЛЕНО
	|			И НастройкиПоОрганизации.Долгосрочный = ДанныеПрочихРасчетов.Долгосрочный
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоАналитике
	|		ПО НастройкиПоАналитике.ВидСчета = ДанныеПрочихРасчетов.ВидСчета
	|			И НастройкиПоАналитике.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|			И НастройкиПоАналитике.АналитикаУчета = ДанныеПрочихРасчетов.АналитикаУчета
	|			И НастройкиПоАналитике.МестоУчета = НЕОПРЕДЕЛЕНО
	|			И НастройкиПоАналитике.Долгосрочный = ДанныеПрочихРасчетов.Долгосрочный";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область РасчетыСПартнерамиБУ
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	""Поставщики"" КАК РазделУчета,
	|	ХозрасчетныйОбороты.Организация КАК Организация,
	|	ХозрасчетныйОбороты.Подразделение КАК Подразделение,
	|	ХозрасчетныйОбороты.Счет КАК Счет,
	|	ХозрасчетныйОбороты.Субконто1 КАК Субконто1,
	|	ХозрасчетныйОбороты.Регистратор КАК Регистратор,
	|	ХозрасчетныйОбороты.СуммаОборотДт КАК СуммаОборотДт,
	|	ХозрасчетныйОбороты.СуммаОборотКт КАК СуммаОборотКт
	|ПОМЕСТИТЬ ВТ_РасчетыСКонтрагентамиРегл
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(&НачалоПериода, &КонецПериода, Регистратор, Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПоставщикамиИПодрядчиками)), , Организация В (&МассивОрганизаций), , ) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	""Клиенты"",
	|	ХозрасчетныйОбороты.Организация,
	|	ХозрасчетныйОбороты.Подразделение,
	|	ХозрасчетныйОбороты.Счет,
	|	ХозрасчетныйОбороты.Субконто1,
	|	ХозрасчетныйОбороты.Регистратор,
	|	ХозрасчетныйОбороты.СуммаОборотДт,
	|	ХозрасчетныйОбороты.СуммаОборотКт
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(&НачалоПериода, &КонецПериода, Регистратор, Счет В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыСПокупателямиИЗаказчиками)), , Организация В (&МассивОрганизаций), , ) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	""КредитыДепозиты"",
	|	ХозрасчетныйОбороты.Организация,
	|	ХозрасчетныйОбороты.Подразделение,
	|	ХозрасчетныйОбороты.Счет,
	|	ВЫБОР
	|		КОГДА ТИПЗНАЧЕНИЯ(ХозрасчетныйОбороты.Субконто1) = ТИП(Справочник.ДоговорыКредитовИДепозитов)
	|			ТОГДА ХозрасчетныйОбороты.Субконто1
	|		КОГДА ТИПЗНАЧЕНИЯ(ХозрасчетныйОбороты.Субконто2) = ТИП(Справочник.ДоговорыКредитовИДепозитов)
	|			ТОГДА ХозрасчетныйОбороты.Субконто2
	|		ИНАЧЕ NULL
	|	КОНЕЦ,
	|	ХозрасчетныйОбороты.Регистратор,
	|	ХозрасчетныйОбороты.СуммаОборотДт,
	|	ХозрасчетныйОбороты.СуммаОборотКт
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(&НачалоПериода, &КонецПериода, Регистратор, Счет В ИЕРАРХИИ (&СчетаУчетаРасчетов5), , Организация В (&МассивОрганизаций)
	|		И (ТИПЗНАЧЕНИЯ(Субконто1) = ТИП(Справочник.ДоговорыКредитовИДепозитов) ИЛИ ТИПЗНАЧЕНИЯ(Субконто2) = ТИП(Справочник.ДоговорыКредитовИДепозитов)), , ) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	""Лизинг"",
	|	ХозрасчетныйОбороты.Организация,
	|	ХозрасчетныйОбороты.Подразделение,
	|	ХозрасчетныйОбороты.Счет,
	|	ХозрасчетныйОбороты.Субконто1,
	|	ХозрасчетныйОбороты.Регистратор,
	|	ХозрасчетныйОбороты.СуммаОборотДт,
	|	ХозрасчетныйОбороты.СуммаОборотКт
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(&НачалоПериода, &КонецПериода, Регистратор,,
	|		&ВидыСубконтоКонтрагентыДоговоры, Организация В (&МассивОрганизаций)
	|			И Субконто2 ССЫЛКА Справочник.ДоговорыАренды,,) КАК ХозрасчетныйОбороты
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	""ПрочиеСКонтрагентами"",
	|	ХозрасчетныйОбороты.Организация,
	|	ХозрасчетныйОбороты.Подразделение,
	|	ХозрасчетныйОбороты.Счет,
	|	ХозрасчетныйОбороты.Субконто1,
	|	ХозрасчетныйОбороты.Регистратор,
	|	ХозрасчетныйОбороты.СуммаОборотДт,
	|	ХозрасчетныйОбороты.СуммаОборотКт
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Обороты(
	|			&НачалоПериода,
	|			&КонецПериода,
	|			Регистратор,
	|			Счет В ИЕРАРХИИ (&СчетаУчетаРасчетов7),
	|			,
	|			Организация В (&МассивОрганизаций)
	|				И НЕ Субконто2 ССЫЛКА Справочник.ДоговорыАренды,
	|			,
	|			) КАК ХозрасчетныйОбороты
	|
	|ГДЕ
	|	НЕ (ХозрасчетныйОбороты.Регистратор ССЫЛКА Документ.СчетФактураПолученныйАванс
	|		И ХозрасчетныйОбороты.Счет = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДСпоАвансамИПредоплатам))";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область СтатусыОтражения
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ОтражениеДокументовВРеглУчете.Регистратор КАК Регистратор,
	|	ОтражениеДокументовВРеглУчете.Организация КАК Организация,
	|	МИНИМУМ(ОтражениеДокументовВРеглУчете.Статус) КАК Статус
	|ПОМЕСТИТЬ ВТ_СтатусыОтражения
	|ИЗ
	|	РегистрСведений.ОтражениеДокументовВРеглУчете КАК ОтражениеДокументовВРеглУчете
	|ГДЕ
	|	ОтражениеДокументовВРеглУчете.Регистратор В
	|			(ВЫБРАТЬ
	|				Т.Регистратор
	|			ИЗ
	|				ВТ_РасчетыСПоставщиками КАК Т
	|		
	|			ОБЪЕДИНИТЬ ВСЕ
	|		
	|			ВЫБРАТЬ
	|				Т.Регистратор
	|			ИЗ
	|				ВТ_РасчетыСКлиентами КАК Т
	|		
	|			ОБЪЕДИНИТЬ ВСЕ
	|		
	|			ВЫБРАТЬ
	|				Т.Регистратор
	|			ИЗ
	|				ВТ_РасчетыПоКредитамДепозитам КАК Т
	|		
	|			ОБЪЕДИНИТЬ ВСЕ
	|		
	|			ВЫБРАТЬ
	|				Т.Регистратор
	|			ИЗ
	|				ВТ_РасчетыПоЛизингу КАК Т
	|		
	|			ОБЪЕДИНИТЬ ВСЕ
	|		
	|			ВЫБРАТЬ
	|				Т.Регистратор
	|			ИЗ
	|				ВТ_РасчетыСКонтрагентамиРегл КАК Т)
	|
	|СГРУППИРОВАТЬ ПО
	|	ОтражениеДокументовВРеглУчете.Организация,
	|	ОтражениеДокументовВРеглУчете.Регистратор";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область РасчетыСПартнерамиОУиБУ
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ВЫБОР
	|		КОГДА ВТ_РасчетыСПоставщиками.СчетУчетаРасчетов В ИЕРАРХИИ (&СчетаУчетаРасчетов7)
	|			ТОГДА ""ПрочиеСКонтрагентами""
	|		ИНАЧЕ ""Поставщики""
	|	КОНЕЦ КАК РазделУчета,
	|	ВТ_РасчетыСПоставщиками.Организация КАК Организация,
	|	ВТ_РасчетыСПоставщиками.Подразделение КАК Подразделение,
	|	ВТ_РасчетыСПоставщиками.СчетУчетаРасчетов КАК СчетУчета,
	|	ВТ_РасчетыСПоставщиками.Контрагент КАК Аналитика1,
	|	ВТ_РасчетыСПоставщиками.Регистратор КАК Регистратор,
	|	СУММА(ВТ_РасчетыСПоставщиками.ДолгРеглПриход) КАК Приход,
	|	СУММА(ВТ_РасчетыСПоставщиками.ДолгРеглРасход) КАК Расход,
	|	0 КАК ОборотДт,
	|	0 КАК ОборотКт
	|ПОМЕСТИТЬ ВТ_Расчеты
	|ИЗ
	|	ВТ_РасчетыСПоставщиками КАК ВТ_РасчетыСПоставщиками
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ_РасчетыСПоставщиками.Организация,
	|	ВТ_РасчетыСПоставщиками.Подразделение,
	|	ВТ_РасчетыСПоставщиками.СчетУчетаРасчетов,
	|	ВТ_РасчетыСПоставщиками.Контрагент,
	|	ВТ_РасчетыСПоставщиками.Регистратор
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ВЫБОР
	|		КОГДА ВТ_РасчетыСПоставщиками.СчетУчетаАванса В ИЕРАРХИИ (&СчетаУчетаРасчетов7)
	|			ТОГДА ""ПрочиеСКонтрагентами""
	|		ИНАЧЕ ""Поставщики""
	|	КОНЕЦ,
	|	ВТ_РасчетыСПоставщиками.Организация,
	|	ВТ_РасчетыСПоставщиками.Подразделение,
	|	ВТ_РасчетыСПоставщиками.СчетУчетаАванса,
	|	ВТ_РасчетыСПоставщиками.Контрагент,
	|	ВТ_РасчетыСПоставщиками.Регистратор,
	|	СУММА(ВТ_РасчетыСПоставщиками.ПредоплатаРеглПриход),
	|	СУММА(ВТ_РасчетыСПоставщиками.ПредоплатаРеглРасход),
	|	0,
	|	0
	|ИЗ
	|	ВТ_РасчетыСПоставщиками КАК ВТ_РасчетыСПоставщиками
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ_РасчетыСПоставщиками.Организация,
	|	ВТ_РасчетыСПоставщиками.Подразделение,
	|	ВТ_РасчетыСПоставщиками.СчетУчетаАванса,
	|	ВТ_РасчетыСПоставщиками.Контрагент,
	|	ВТ_РасчетыСПоставщиками.Регистратор
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ВЫБОР
	|		КОГДА ВТ_РасчетыСКлиентами.СчетУчетаРасчетов В ИЕРАРХИИ (&СчетаУчетаРасчетов7)
	|			ТОГДА ""ПрочиеСКонтрагентами""
	|		ИНАЧЕ ""Клиенты""
	|	КОНЕЦ,
	|	ВТ_РасчетыСКлиентами.Организация,
	|	ВТ_РасчетыСКлиентами.Подразделение,
	|	ВТ_РасчетыСКлиентами.СчетУчетаРасчетов,
	|	ВТ_РасчетыСКлиентами.Контрагент,
	|	ВТ_РасчетыСКлиентами.Регистратор,
	|	СУММА(ВТ_РасчетыСКлиентами.ДолгРеглПриход),
	|	СУММА(ВТ_РасчетыСКлиентами.ДолгРеглРасход),
	|	0,
	|	0
	|ИЗ
	|	ВТ_РасчетыСКлиентами КАК ВТ_РасчетыСКлиентами
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ_РасчетыСКлиентами.Организация,
	|	ВТ_РасчетыСКлиентами.Подразделение,
	|	ВТ_РасчетыСКлиентами.СчетУчетаРасчетов,
	|	ВТ_РасчетыСКлиентами.Контрагент,
	|	ВТ_РасчетыСКлиентами.Регистратор
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ВЫБОР
	|		КОГДА ВТ_РасчетыСКлиентами.СчетУчетаАванса В ИЕРАРХИИ (&СчетаУчетаРасчетов7)
	|			ТОГДА ""ПрочиеСКонтрагентами""
	|		ИНАЧЕ ""Клиенты""
	|	КОНЕЦ,
	|	ВТ_РасчетыСКлиентами.Организация,
	|	ВТ_РасчетыСКлиентами.Подразделение,
	|	ВТ_РасчетыСКлиентами.СчетУчетаАванса,
	|	ВТ_РасчетыСКлиентами.Контрагент,
	|	ВТ_РасчетыСКлиентами.Регистратор,
	|	СУММА(ВТ_РасчетыСКлиентами.ПредоплатаРеглПриход),
	|	СУММА(ВТ_РасчетыСКлиентами.ПредоплатаРеглРасход),
	|	0,
	|	0
	|ИЗ
	|	ВТ_РасчетыСКлиентами КАК ВТ_РасчетыСКлиентами
	|
	|СГРУППИРОВАТЬ ПО
	|	ВТ_РасчетыСКлиентами.Организация,
	|	ВТ_РасчетыСКлиентами.Подразделение,
	|	ВТ_РасчетыСКлиентами.СчетУчетаАванса,
	|	ВТ_РасчетыСКлиентами.Контрагент,
	|	ВТ_РасчетыСКлиентами.Регистратор
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	""КредитыДепозиты"",
	|	РасчетыПоКредитамДепозитам.Организация,
	|	РасчетыПоКредитамДепозитам.Подразделение,
	|	РасчетыПоКредитамДепозитам.Счет,
	|	РасчетыПоКредитамДепозитам.Договор,
	|	РасчетыПоКредитамДепозитам.Регистратор,
	|	РасчетыПоКредитамДепозитам.СуммаРеглПриход,
	|	РасчетыПоКредитамДепозитам.СуммаРеглРасход,
	|	0,
	|	0
	|ИЗ
	|	ВТ_РасчетыПоКредитамДепозитам КАК РасчетыПоКредитамДепозитам
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	""Лизинг"",
	|	РасчетыПоЛизингу.Организация,
	|	РасчетыПоЛизингу.Подразделение,
	|	РасчетыПоЛизингу.Счет,
	|	РасчетыПоЛизингу.Контрагент,
	|	РасчетыПоЛизингу.Регистратор,
	|	СУММА(РасчетыПоЛизингу.СуммаРеглПриход),
	|	СУММА(РасчетыПоЛизингу.СуммаРеглРасход),
	|	0,
	|	0
	|ИЗ
	|	ВТ_РасчетыПоЛизингу КАК РасчетыПоЛизингу
	|
	|СГРУППИРОВАТЬ ПО
	|	РасчетыПоЛизингу.Организация,
	|	РасчетыПоЛизингу.Подразделение,
	|	РасчетыПоЛизингу.Счет,
	|	РасчетыПоЛизингу.Контрагент,
	|	РасчетыПоЛизингу.Регистратор
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	""Поставщики"",
	|	НеотфактурованныеПоставки.Организация,
	|	НеотфактурованныеПоставки.Подразделение,
	|	НеотфактурованныеПоставки.Счет,
	|	НеотфактурованныеПоставки.Контрагент,
	|	НеотфактурованныеПоставки.Регистратор,
	|	НеотфактурованныеПоставки.СтоимостьРеглПриход,
	|	НеотфактурованныеПоставки.СтоимостьРеглРасход,
	|	0,
	|	0
	|ИЗ
	|	ВТ_НеотфактурованныеПоставки КАК НеотфактурованныеПоставки
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	""ПрочиеСКонтрагентами"",
	|	ПрочиеРасчетыСКонтрагентами.Организация,
	|	ПрочиеРасчетыСКонтрагентами.Подразделение,
	|	ПрочиеРасчетыСКонтрагентами.Счет,
	|	ПрочиеРасчетыСКонтрагентами.Контрагент,
	|	ПрочиеРасчетыСКонтрагентами.Регистратор,
	|	ПрочиеРасчетыСКонтрагентами.СтоимостьРеглПриход,
	|	ПрочиеРасчетыСКонтрагентами.СтоимостьРеглРасход,
	|	0,
	|	0
	|ИЗ
	|	ВТ_ПрочиеРасчетыСКонтрагентами КАК ПрочиеРасчетыСКонтрагентами
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ВТ_РасчетыСКонтрагентамиРегл.РазделУчета,
	|	ВТ_РасчетыСКонтрагентамиРегл.Организация,
	|	ВТ_РасчетыСКонтрагентамиРегл.Подразделение,
	|	ЕСТЬNULL(ДолгосрочныеКакКраткосрочные.СчетУчетаКраткосрочный, ВТ_РасчетыСКонтрагентамиРегл.Счет),
	|	ВТ_РасчетыСКонтрагентамиРегл.Субконто1,
	|	ВТ_РасчетыСКонтрагентамиРегл.Регистратор,
	|	0,
	|	0,
	|	ВТ_РасчетыСКонтрагентамиРегл.СуммаОборотДт,
	|	ВТ_РасчетыСКонтрагентамиРегл.СуммаОборотКт
	|ИЗ
	|	ВТ_РасчетыСКонтрагентамиРегл КАК ВТ_РасчетыСКонтрагентамиРегл
	|	ЛЕВОЕ СОЕДИНЕНИЕ ВТДолгосрочныеКакКраткосрочные КАК ДолгосрочныеКакКраткосрочные
	|		ПО ВТ_РасчетыСКонтрагентамиРегл.Счет = ДолгосрочныеКакКраткосрочные.СчетУчетаДолгосрочный";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область Результат
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	Подзапрос.РазделУчета КАК РазделУчета,
	|	Подзапрос.Организация КАК Организация,
	|	Подзапрос.Подразделение,
	|	Подзапрос.СчетУчета КАК СчетБУ,
	|	Подзапрос.Аналитика1 КАК Аналитика1,
	|	СУММА(Подзапрос.Приход) КАК Приход,
	|	СУММА(Подзапрос.Расход) КАК Расход,
	|	СУММА(Подзапрос.ОборотДт) КАК ОборотДт,
	|	СУММА(Подзапрос.ОборотКт) КАК ОборотКт,
	|	Подзапрос.Регистратор КАК Регистратор,
	|	СтатусыОтражения.Статус КАК Статус
	|ИЗ
	|	ВТ_Расчеты КАК Подзапрос
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_СтатусыОтражения КАК СтатусыОтражения
	|		ПО Подзапрос.Организация = СтатусыОтражения.Организация
	|			И Подзапрос.Регистратор = СтатусыОтражения.Регистратор
	|ГДЕ
	|	Подзапрос.РазделУчета = &РазделУчета
	|
	|СГРУППИРОВАТЬ ПО
	|	Подзапрос.РазделУчета,
	|	Подзапрос.Организация,
	|	Подзапрос.Подразделение,
	|	Подзапрос.СчетУчета,
	|	Подзапрос.Аналитика1,
	|	Подзапрос.Регистратор,
	|	СтатусыОтражения.Статус
	|
	|ИМЕЮЩИЕ
	|	(СУММА(Подзапрос.Приход) <> 0
	|		ИЛИ СУММА(Подзапрос.Расход) <> 0
	|		ИЛИ СУММА(Подзапрос.ОборотДт) <> 0
	|		ИЛИ СУММА(Подзапрос.ОборотКт) <> 0)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Подзапрос.РазделУчета,
	|	Подзапрос.Организация,
	|	Подзапрос.Подразделение,
	|	Подзапрос.СчетУчета,
	|	Подзапрос.Аналитика1,
	|	СУММА(Подзапрос.Приход),
	|	СУММА(Подзапрос.Расход),
	|	СУММА(Подзапрос.ОборотДт),
	|	СУММА(Подзапрос.ОборотКт),
	|	Подзапрос.Регистратор,
	|	СтатусыОтражения.Статус
	|ИЗ
	|	ВТ_Расчеты КАК Подзапрос
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_СтатусыОтражения КАК СтатусыОтражения
	|		ПО Подзапрос.Организация = СтатусыОтражения.Организация
	|			И Подзапрос.Регистратор = СтатусыОтражения.Регистратор
	|ГДЕ
	|	&РазделУчета = ""Все""
	|
	|СГРУППИРОВАТЬ ПО
	|	Подзапрос.РазделУчета,
	|	Подзапрос.Организация,
	|	Подзапрос.Подразделение,
	|	Подзапрос.СчетУчета,
	|	Подзапрос.Аналитика1,
	|	Подзапрос.Регистратор,
	|	СтатусыОтражения.Статус
	|
	|ИМЕЮЩИЕ
	|	(СУММА(Подзапрос.Приход) <> 0
	|		ИЛИ СУММА(Подзапрос.Расход) <> 0
	|		ИЛИ СУММА(Подзапрос.ОборотДт) <> 0
	|		ИЛИ СУММА(Подзапрос.ОборотКт) <> 0)";
	
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	ТекстЗапроса = СтрСоединить(МассивТекстовЗапроса, ОбщегоНазначения.РазделительПакетаЗапросов());
	
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстЗапросаПроизводственныеЗатраты()
	
	МассивТекстовЗапроса = Новый Массив;
	
	#Область РасходыПроизводственныеЗатратыОстаткиОУ
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	СебестоимостьТоваров.Организация КАК Организация,
	|	ВЫБОР
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Аналитика.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА Аналитика.Договор.Подразделение
	|		КОГДА СебестоимостьТоваров.РазделУчета В (
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеПереданныеПартнерам))
	|		ТОГДА ЕСТЬNULL(СебестоимостьТоваров.ВидЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК МестоУчета,
	|	ЕСТЬNULL(АналитикиФинансовогоУчета.Ссылка, ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)) КАК АналитикаУчета,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.РезервПодОбесценениеРеглОстаток <> 0
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеПроизводства)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|	КОНЕЦ КАК ВидСчета,
	|	СУММА(СебестоимостьТоваров.СтоимостьРеглОстаток 
	|			+ СебестоимостьТоваров.ДопРасходыРеглОстаток 
	|			+ СебестоимостьТоваров.ТрудозатратыРеглОстаток
	|			+ СебестоимостьТоваров.ПостатейныеПостоянныеРеглОстаток
	|			+ СебестоимостьТоваров.ПостатейныеПеременныеРеглОстаток
	|			+ СебестоимостьТоваров.РезервПодОбесценениеРеглОстаток) КАК НачальныйОстаток,
	|	0 КАК КонечныйОстаток
	|ПОМЕСТИТЬ ВтРасходыОстатки
	|ИЗ
	|	РегистрНакопления.СебестоимостьТоваров.Остатки(
	|			&НачалоПериода,
	|			РазделУчета В (&ЗабалансовыеРазделыУчета,
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|				И Организация В (&МассивОрганизаций)) КАК СебестоимостьТоваров
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ГруппыАналитическогоУчетаНоменклатуры КАК АналитикиФинансовогоУчета
	|	ПО АналитикиФинансовогоУчета.Ссылка = СебестоимостьТоваров.АналитикаФинансовогоУчета
	|		И &НастройкаСчетовУчетаПроизводстваПоГруппамПродукции
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КлючиАналитикиУчетаНоменклатуры КАК Аналитика
	|	ПО СебестоимостьТоваров.АналитикаУчетаНоменклатуры = Аналитика.Ссылка
	|
	|СГРУППИРОВАТЬ ПО
	|	СебестоимостьТоваров.Организация,
	|	ЕСТЬNULL(АналитикиФинансовогоУчета.Ссылка, ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)),
	|	ВЫБОР
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Аналитика.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА Аналитика.Договор.Подразделение
	|		КОГДА СебестоимостьТоваров.РазделУчета В (
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеПереданныеПартнерам))
	|		ТОГДА ЕСТЬNULL(СебестоимостьТоваров.ВидЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.РезервПодОбесценениеРеглОстаток <> 0
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеПроизводства)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|	КОНЕЦ
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СебестоимостьТоваров.Организация КАК Организация,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение)
	|			ТОГДА ЕСТЬNULL(СебестоимостьТоваров.ВидЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА СебестоимостьТоваров.АналитикаУчетаНоменклатуры.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|			ТОГДА СебестоимостьТоваров.АналитикаУчетаНоменклатуры.СкладскаяТерритория.Подразделение
	|		ИНАЧЕ СебестоимостьТоваров.АналитикаУчетаНоменклатуры.МестоХранения
	|	КОНЕЦ,
	|	ЕСТЬNULL(АналитикиФинансовогоУчета.Ссылка, ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)),
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.РезервПодОбесценениеРеглОстаток <> 0
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеПроизводства)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|	КОНЕЦ КАК ВидСчета,
	|	0 КАК НачальныйОстаток,
	|	СУММА(СебестоимостьТоваров.СтоимостьРеглОстаток 
	|			+ СебестоимостьТоваров.ДопРасходыРеглОстаток 
	|			+ СебестоимостьТоваров.ТрудозатратыРеглОстаток
	|			+ СебестоимостьТоваров.ПостатейныеПостоянныеРеглОстаток
	|			+ СебестоимостьТоваров.ПостатейныеПеременныеРеглОстаток
	|			+ СебестоимостьТоваров.РезервПодОбесценениеРеглОстаток) КАК КонечныйОстаток
	|ИЗ
	|	РегистрНакопления.СебестоимостьТоваров.Остатки(
	|			&КонецПериодаОстатков,
	|			РазделУчета В (&ЗабалансовыеРазделыУчета,
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|				И Организация В (&МассивОрганизаций)) КАК СебестоимостьТоваров
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КлючиАналитикиУчетаНоменклатуры КАК КлючиАналитикиУчетаНоменклатуры
	|		ПО СебестоимостьТоваров.АналитикаУчетаНоменклатуры = КлючиАналитикиУчетаНоменклатуры.Ссылка
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ГруппыАналитическогоУчетаНоменклатуры КАК АналитикиФинансовогоУчета
	|	ПО АналитикиФинансовогоУчета.Ссылка = СебестоимостьТоваров.АналитикаФинансовогоУчета
	|		И &НастройкаСчетовУчетаПроизводстваПоГруппамПродукции
	|
	|СГРУППИРОВАТЬ ПО
	|	СебестоимостьТоваров.Организация,
	|	ЕСТЬNULL(АналитикиФинансовогоУчета.Ссылка, ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)),
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение)
	|			ТОГДА ЕСТЬNULL(СебестоимостьТоваров.ВидЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА СебестоимостьТоваров.АналитикаУчетаНоменклатуры.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|			ТОГДА СебестоимостьТоваров.АналитикаУчетаНоменклатуры.СкладскаяТерритория.Подразделение
	|		ИНАЧЕ СебестоимостьТоваров.АналитикаУчетаНоменклатуры.МестоХранения
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.РезервПодОбесценениеРеглОстаток <> 0
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеПроизводства)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|	КОНЕЦ
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ПрочиеРасходыОстатки.Организация КАК Организация,
	|	ПрочиеРасходыОстатки.Подразделение КАК Подразделение,
	|	ПрочиеРасходыОстатки.СтатьяРасходов КАК СтатьяРасходов,
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчета,
	|	СУММА(ПрочиеРасходыОстатки.СуммаРеглОстаток) КАК НачальныйОстаток,
	|	0 КАК КонечныйОстаток
	|ИЗ
	|	РегистрНакопления.ПрочиеРасходы.Остатки(&НачалоПериода, 
	|		Организация В (&МассивОрганизаций)) КАК ПрочиеРасходыОстатки
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиРасходов
	|	ПО ПрочиеРасходыОстатки.СтатьяРасходов = СтатьиРасходов.Ссылка
	|		И СтатьиРасходов.ВидДеятельностиРасходов <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиРасходов.ПрочаяДеятельность)
	|	
	|СГРУППИРОВАТЬ ПО
	|	ПрочиеРасходыОстатки.Организация,
	|	ПрочиеРасходыОстатки.Подразделение,
	|	ПрочиеРасходыОстатки.СтатьяРасходов
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ПрочиеРасходыОстатки.Организация КАК Организация,
	|	ПрочиеРасходыОстатки.Подразделение КАК Подразделение,
	|	ПрочиеРасходыОстатки.СтатьяРасходов КАК СтатьяРасходов,
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчета,
	|	0 КАК НачальныйОстаток,
	|	СУММА(ПрочиеРасходыОстатки.СуммаРеглОстаток) КАК КонечныйОстаток
	|ИЗ
	|	РегистрНакопления.ПрочиеРасходы.Остатки(&КонецПериодаОстатков, 
	|		Организация В (&МассивОрганизаций)) КАК ПрочиеРасходыОстатки
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиРасходов
	|	ПО ПрочиеРасходыОстатки.СтатьяРасходов = СтатьиРасходов.Ссылка
	|		И СтатьиРасходов.ВидДеятельностиРасходов <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиРасходов.ПрочаяДеятельность)
	|	
	|СГРУППИРОВАТЬ ПО
	|	ПрочиеРасходыОстатки.Организация,
	|	ПрочиеРасходыОстатки.Подразделение,
	|	ПрочиеРасходыОстатки.СтатьяРасходов
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ПрочиеРасходыНезавершенногоПроизводства.Организация КАК Организация,
	|	ПрочиеРасходыНезавершенногоПроизводства.Подразделение,
	|	ВЫБОР 
	|		КОГДА &НастройкаСчетовУчетаПроизводстваПоГруппамПродукции
	|		ТОГДА ПрочиеРасходыНезавершенногоПроизводства.ГруппаПродукции
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|	КОНЕЦ,
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство) КАК ВидСчета,
	|	СУММА(ПрочиеРасходыНезавершенногоПроизводства.СтоимостьРеглОстаток) КАК НачальныйОстаток,
	|	0 КАК КонечныйОстаток
	|ИЗ
	|	РегистрНакопления.ПрочиеРасходыНезавершенногоПроизводства.Остатки(&НачалоПериода, 
	|		Организация В (&МассивОрганизаций)) КАК ПрочиеРасходыНезавершенногоПроизводства
	|	
	|СГРУППИРОВАТЬ ПО
	|	ПрочиеРасходыНезавершенногоПроизводства.Организация,
	|	ПрочиеРасходыНезавершенногоПроизводства.Подразделение,
	|	ВЫБОР 
	|		КОГДА &НастройкаСчетовУчетаПроизводстваПоГруппамПродукции
	|		ТОГДА ПрочиеРасходыНезавершенногоПроизводства.ГруппаПродукции
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|	КОНЕЦ
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ПрочиеРасходыНезавершенногоПроизводства.Организация,
	|	ПрочиеРасходыНезавершенногоПроизводства.Подразделение,
	|	ВЫБОР 
	|		КОГДА &НастройкаСчетовУчетаПроизводстваПоГруппамПродукции
	|		ТОГДА ПрочиеРасходыНезавершенногоПроизводства.ГруппаПродукции
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|	КОНЕЦ,
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство) КАК ВидСчета,
	|	0 КАК НачальныйОстаток,
	|	СУММА(ПрочиеРасходыНезавершенногоПроизводства.СтоимостьРеглОстаток) КАК КонечныйОстаток
	|ИЗ
	|	РегистрНакопления.ПрочиеРасходыНезавершенногоПроизводства.Остатки(&КонецПериодаОстатков, 
	|		Организация В (&МассивОрганизаций)) КАК ПрочиеРасходыНезавершенногоПроизводства
	|	
	|СГРУППИРОВАТЬ ПО
	|	ПрочиеРасходыНезавершенногоПроизводства.Организация,
	|	ПрочиеРасходыНезавершенногоПроизводства.Подразделение,
	|	ВЫБОР 
	|		КОГДА &НастройкаСчетовУчетаПроизводстваПоГруппамПродукции
	|		ТОГДА ПрочиеРасходыНезавершенногоПроизводства.ГруппаПродукции
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|	КОНЕЦ
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ТрудозатратыНезавершенногоПроизводства.Организация КАК Организация,
	|	ТрудозатратыНезавершенногоПроизводства.Подразделение,
	|	ВЫБОР 
	|		КОГДА &НастройкаСчетовУчетаПроизводстваПоГруппамПродукции
	|		ТОГДА ТрудозатратыНезавершенногоПроизводства.ГруппаПродукции
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|	КОНЕЦ,
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство) КАК ВидСчета,
	|	СУММА(ТрудозатратыНезавершенногоПроизводства.СтоимостьРеглОстаток) КАК НачальныйОстаток,
	|	0 КАК КонечныйОстаток
	|ИЗ
	|	РегистрНакопления.ТрудозатратыНезавершенногоПроизводства.Остатки(&НачалоПериода, 
	|		Организация В (&МассивОрганизаций)) КАК ТрудозатратыНезавершенногоПроизводства
	|	
	|СГРУППИРОВАТЬ ПО
	|	ТрудозатратыНезавершенногоПроизводства.Организация,
	|	ТрудозатратыНезавершенногоПроизводства.Подразделение,
	|	ВЫБОР 
	|		КОГДА &НастройкаСчетовУчетаПроизводстваПоГруппамПродукции
	|		ТОГДА ТрудозатратыНезавершенногоПроизводства.ГруппаПродукции
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|	КОНЕЦ
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ТрудозатратыНезавершенногоПроизводства.Организация КАК Организация,
	|	ТрудозатратыНезавершенногоПроизводства.Подразделение КАК Подразделение,
	|	ВЫБОР 
	|		КОГДА &НастройкаСчетовУчетаПроизводстваПоГруппамПродукции
	|		ТОГДА ТрудозатратыНезавершенногоПроизводства.ГруппаПродукции
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|	КОНЕЦ КАК СтатьяРасходов,
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство) КАК ВидСчета,
	|	0 КАК НачальныйОстаток,
	|	СУММА(ТрудозатратыНезавершенногоПроизводства.СтоимостьРеглОстаток) КАК КонечныйОстаток
	|ИЗ
	|	РегистрНакопления.ТрудозатратыНезавершенногоПроизводства.Остатки(&КонецПериодаОстатков, 
	|		Организация В (&МассивОрганизаций)) КАК ТрудозатратыНезавершенногоПроизводства
	|	
	|СГРУППИРОВАТЬ ПО
	|	ТрудозатратыНезавершенногоПроизводства.Организация,
	|	ТрудозатратыНезавершенногоПроизводства.Подразделение,
	|	ВЫБОР 
	|		КОГДА &НастройкаСчетовУчетаПроизводстваПоГруппамПродукции
	|		ТОГДА ТрудозатратыНезавершенногоПроизводства.ГруппаПродукции
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|	КОНЕЦ";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область РасходыПроизводственныеЗатратыОборотыОУ
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ДокументДвижения = НЕОПРЕДЕЛЕНО
	|			ТОГДА СебестоимостьТоваров.Регистратор
	|		ИНАЧЕ СебестоимостьТоваров.ДокументДвижения
	|	КОНЕЦ КАК Регистратор,
	|	СебестоимостьТоваров.Организация КАК Организация,
	|	ВЫБОР
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Аналитика.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА Аналитика.Договор.Подразделение
	|		КОГДА СебестоимостьТоваров.РазделУчета В (
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеПереданныеПартнерам))
	|		ТОГДА ЕСТЬNULL(СебестоимостьТоваров.ВидЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК МестоУчета,
	|	ЕСТЬNULL(АналитикиФинансовогоУчета.Ссылка, ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)) КАК АналитикаУчета,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.РезервПодОбесценениеРегл <> 0
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеПроизводства)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|	КОНЕЦ КАК ВидСчета,
	|	ВЫБОР 
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	//++ НЕ УТКА
	
	//++ Устарело_Переработка24
	|		И НЕ СебестоимостьТоваров.Регистратор ССЫЛКА Документ.ОтчетПереработчика
	|		ИЛИ (СебестоимостьТоваров.Регистратор ССЫЛКА Документ.ОтчетПереработчика
	|		И СебестоимостьТоваров.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство)
	|		И (ЕСТЬNULL(ВЫРАЗИТЬ(СебестоимостьТоваров.Партия КАК Справочник.ПартииПроизводства).НаправлениеДеятельности,
	|				ЕСТЬNULL(Аналитика.Назначение.НаправлениеДеятельности, ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка))) <>
	|			ЕСТЬNULL(ВЫРАЗИТЬ(СебестоимостьТоваров.КорПартия КАК Справочник.ПартииПроизводства).НаправлениеДеятельности,
	|				ЕСТЬNULL(КорАналитика.Назначение.НаправлениеДеятельности, СебестоимостьТоваров.КорНаправлениеДеятельности))
	|			ИЛИ СебестоимостьТоваров.АналитикаФинансовогоУчета <> СебестоимостьТоваров.КорАналитикаФинансовогоУчета
	|			ИЛИ ТИПЗНАЧЕНИЯ(ЕСТЬNULL(КорАналитика.МестоХранения, Аналитика.МестоХранения)) = ТИП(Справочник.СтруктураПредприятия)
	|				И СебестоимостьТоваров.Подразделение <>
	|			ВЫРАЗИТЬ(ЕСТЬNULL(КорАналитика.МестоХранения, Аналитика.МестоХранения) КАК Справочник.СтруктураПредприятия)
	|			ИЛИ СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) И СебестоимостьТоваров.СтоимостьРегл > 0))
	//-- Устарело_Переработка24
	
	//-- НЕ УТКА
	|		ТОГДА СебестоимостьТоваров.СтоимостьРегл
	|			+ СебестоимостьТоваров.СтоимостьЗабалансоваяРегл
	|			+ СебестоимостьТоваров.ДопРасходыРегл 
	|			+ СебестоимостьТоваров.ТрудозатратыРегл
	|			+ СебестоимостьТоваров.ПостатейныеПостоянныеРегл
	|			+ СебестоимостьТоваров.ПостатейныеПеременныеРегл
	|			+ СебестоимостьТоваров.РезервПодОбесценениеРегл
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК Приход,
	|	ВЫБОР 
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	//++ НЕ УТКА
	
	//++ Устарело_Переработка24
	|		И НЕ СебестоимостьТоваров.Регистратор ССЫЛКА Документ.ОтчетПереработчика
	|		ИЛИ (СебестоимостьТоваров.Регистратор ССЫЛКА Документ.ОтчетПереработчика
	|		И СебестоимостьТоваров.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство)
	|		И СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И (ЕСТЬNULL(ВЫРАЗИТЬ(СебестоимостьТоваров.Партия КАК Справочник.ПартииПроизводства).НаправлениеДеятельности,
	|				ЕСТЬNULL(Аналитика.Назначение.НаправлениеДеятельности, ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка))) <>
	|			ЕСТЬNULL(ВЫРАЗИТЬ(СебестоимостьТоваров.КорПартия КАК Справочник.ПартииПроизводства).НаправлениеДеятельности,
	|				ЕСТЬNULL(КорАналитика.Назначение.НаправлениеДеятельности, СебестоимостьТоваров.КорНаправлениеДеятельности))
	|			ИЛИ СебестоимостьТоваров.АналитикаФинансовогоУчета <> СебестоимостьТоваров.КорАналитикаФинансовогоУчета
	|			ИЛИ ТИПЗНАЧЕНИЯ(ЕСТЬNULL(КорАналитика.МестоХранения, Аналитика.МестоХранения)) = ТИП(Справочник.СтруктураПредприятия)
	|				И СебестоимостьТоваров.Подразделение <>
	|			ВЫРАЗИТЬ(ЕСТЬNULL(КорАналитика.МестоХранения, Аналитика.МестоХранения) КАК Справочник.СтруктураПредприятия)))
	//-- Устарело_Переработка24
	
	//-- НЕ УТКА
	|		ТОГДА СебестоимостьТоваров.СтоимостьРегл
	|			+ СебестоимостьТоваров.СтоимостьЗабалансоваяРегл
	|			+ СебестоимостьТоваров.ДопРасходыРегл 
	|			+ СебестоимостьТоваров.ТрудозатратыРегл
	|			+ СебестоимостьТоваров.ПостатейныеПостоянныеРегл
	|			+ СебестоимостьТоваров.ПостатейныеПеременныеРегл
	|			+ СебестоимостьТоваров.РезервПодОбесценениеРегл
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК Расход
	|ПОМЕСТИТЬ втРасходыОбороты
	|ИЗ
	|	РегистрНакопления.СебестоимостьТоваров КАК СебестоимостьТоваров
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КлючиАналитикиУчетаНоменклатуры КАК Аналитика
	|	ПО СебестоимостьТоваров.АналитикаУчетаНоменклатуры = Аналитика.Ссылка
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КлючиАналитикиУчетаНоменклатуры КАК КорАналитика
	|	ПО СебестоимостьТоваров.КорАналитикаУчетаНоменклатуры = КорАналитика.Ссылка
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ГруппыАналитическогоУчетаНоменклатуры КАК АналитикиФинансовогоУчета
	|	ПО АналитикиФинансовогоУчета.Ссылка = СебестоимостьТоваров.АналитикаФинансовогоУчета
	|ГДЕ
	|	СебестоимостьТоваров.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|	И СебестоимостьТоваров.Организация В (&МассивОрганизаций)
	|	И СебестоимостьТоваров.Активность
	|	И СебестоимостьТоваров.РазделУчета В (&ЗабалансовыеРазделыУчета,
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ВЫБОР
	|		КОГДА ПрочиеРасходы.ДокументДвижения = ЗНАЧЕНИЕ(Документ.РаспределениеПрочихЗатрат.ПустаяСсылка)
	|			ТОГДА ПрочиеРасходы.Регистратор
	|		ИНАЧЕ ПрочиеРасходы.ДокументДвижения
	|	КОНЕЦ КАК Регистратор,
	|	ПрочиеРасходы.Организация КАК Организация,
	|	ПрочиеРасходы.Подразделение КАК Подразделение,
	|	ПрочиеРасходы.СтатьяРасходов КАК СтатьяРасходов,
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчета,
	|	ВЫБОР 
	|		КОГДА ПрочиеРасходы.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|			ТОГДА ПрочиеРасходы.СуммаРегл
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК Приход,
	|	ВЫБОР 
	|		КОГДА ПрочиеРасходы.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			И ПрочиеРасходы.СтатьяРасходов <> ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПогрешностьРасчетаСебестоимости)
	|			ТОГДА ПрочиеРасходы.СуммаРегл
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК Расход
	|ИЗ
	|	РегистрНакопления.ПрочиеРасходы КАК ПрочиеРасходы
	|ГДЕ
	|	ПрочиеРасходы.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|	И ПрочиеРасходы.Организация В (&МассивОрганизаций)
	|	И ПрочиеРасходы.Активность
	|	И ПрочиеРасходы.СтатьяРасходов.ВидДеятельностиРасходов <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиРасходов.ПрочаяДеятельность)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ВЫБОР
	|		КОГДА ПрочиеРасходыНезавершенногоПроизводства.ДокументДвижения = НЕОПРЕДЕЛЕНО
	|			ТОГДА ПрочиеРасходыНезавершенногоПроизводства.Регистратор
	|		ИНАЧЕ ПрочиеРасходыНезавершенногоПроизводства.ДокументДвижения
	|	КОНЕЦ КАК Регистратор,
	|	ПрочиеРасходыНезавершенногоПроизводства.Организация КАК Организация,
	|	ПрочиеРасходыНезавершенногоПроизводства.Подразделение КАК Подразделение,
	|	ПрочиеРасходыНезавершенногоПроизводства.ГруппаПродукции КАК СтатьяРасходов,
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство) КАК ВидСчета,
	|	ВЫБОР 
	|		КОГДА ПрочиеРасходыНезавершенногоПроизводства.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|			ТОГДА ПрочиеРасходыНезавершенногоПроизводства.СтоимостьРегл
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК Приход,
	|	ВЫБОР 
	|		КОГДА ПрочиеРасходыНезавершенногоПроизводства.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			ТОГДА ПрочиеРасходыНезавершенногоПроизводства.СтоимостьРегл
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК Расход
	|ИЗ
	|	РегистрНакопления.ПрочиеРасходыНезавершенногоПроизводства КАК ПрочиеРасходыНезавершенногоПроизводства
	|
	|ГДЕ
	|	ПрочиеРасходыНезавершенногоПроизводства.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|	И ПрочиеРасходыНезавершенногоПроизводства.Организация В (&МассивОрганизаций)
	|	И ПрочиеРасходыНезавершенногоПроизводства.Активность
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ТрудозатратыНезавершенногоПроизводства.Регистратор КАК Регистратор,
	|	ТрудозатратыНезавершенногоПроизводства.Организация КАК Организация,
	|	ТрудозатратыНезавершенногоПроизводства.Подразделение КАК Подразделение,
	|	ТрудозатратыНезавершенногоПроизводства.ГруппаПродукции КАК СтатьяРасходов,
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство) КАК ВидСчета,
	|	ВЫБОР 
	|		КОГДА ТрудозатратыНезавершенногоПроизводства.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|			ТОГДА ТрудозатратыНезавершенногоПроизводства.СтоимостьРегл
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК Приход,
	|	ВЫБОР 
	|		КОГДА ТрудозатратыНезавершенногоПроизводства.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			ТОГДА ТрудозатратыНезавершенногоПроизводства.СтоимостьРегл
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК Расход
	|ИЗ
	|	РегистрНакопления.ТрудозатратыНезавершенногоПроизводства КАК ТрудозатратыНезавершенногоПроизводства
	|ГДЕ
	|	ТрудозатратыНезавершенногоПроизводства.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|	И ТрудозатратыНезавершенногоПроизводства.Организация В (&МассивОрганизаций)
	|	И ТрудозатратыНезавершенногоПроизводства.Активность";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область Результат
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	""Расходы"" КАК РазделУчета,
	|	Подзапрос.Организация,
	|	Подзапрос.Подразделение,
	|	Подзапрос.СчетБУ,
	|	СУММА(Подзапрос.НачальныйОстаток) КАК НачальныйОстаток,
	|	СУММА(Подзапрос.Приход) КАК Приход,
	|	СУММА(Подзапрос.Расход) КАК Расход,
	|	СУММА(Подзапрос.КонечныйОстаток) КАК КонечныйОстаток,
	|	СУММА(Подзапрос.НачальныеСальдо) КАК НачальноеСальдо,
	|	СУММА(Подзапрос.ОборотДт) КАК ОборотДт,
	|	СУММА(Подзапрос.ОборотКт) КАК ОборотКт,
	|	СУММА(Подзапрос.КонечноеСальдо) КАК КонечноеСальдо
	|ИЗ
	|	(ВЫБРАТЬ
	|		РасходыОстатки.Организация КАК Организация,
	|		РасходыОстатки.МестоУчета КАК Подразделение,
	|		ЕСТЬNULL(НастройкиПоМестуУчета.СчетУчета, ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)))) КАК СчетБУ,
	|		РасходыОстатки.НачальныйОстаток КАК НачальныйОстаток,
	|		0 КАК Приход,
	|		0 КАК Расход,
	|		РасходыОстатки.КонечныйОстаток КАК КонечныйОстаток,
	|		0 КАК НачальныеСальдо,
	|		0 КАК ОборотДт,
	|		0 КАК ОборотКт,
	|		0 КАК КонечноеСальдо
	|	ИЗ
	|		втРасходыОстатки КАК РасходыОстатки
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиРасходов
	|	ПО
	|		РасходыОстатки.АналитикаУчета = СтатьиРасходов.Ссылка
	|		И РасходыОстатки.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы)
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоМестуУчета
	|	ПО 
	|		НастройкиПоМестуУчета.ВидСчета = РасходыОстатки.ВидСчета
	|		И НастройкиПоМестуУчета.Организация = РасходыОстатки.Организация
	|		И НастройкиПоМестуУчета.АналитикаУчета = ЕСТЬNULL(СтатьиРасходов.ГруппаФинансовогоУчетаРегл, РасходыОстатки.АналитикаУчета)
	|		И НастройкиПоМестуУчета.МестоУчета = РасходыОстатки.МестоУчета
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоОрганизации
	|	ПО 
	|		НастройкиПоОрганизации.ВидСчета = РасходыОстатки.ВидСчета
	|		И НастройкиПоОрганизации.Организация = РасходыОстатки.Организация
	|		И НастройкиПоОрганизации.АналитикаУчета = ЕСТЬNULL(СтатьиРасходов.ГруппаФинансовогоУчетаРегл, РасходыОстатки.АналитикаУчета)
	|		И НастройкиПоОрганизации.МестоУчета = НЕОПРЕДЕЛЕНО
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоАналитике
	|	ПО 
	|		НастройкиПоАналитике.ВидСчета = РасходыОстатки.ВидСчета
	|		И НастройкиПоАналитике.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|		И НастройкиПоАналитике.АналитикаУчета = ЕСТЬNULL(СтатьиРасходов.ГруппаФинансовогоУчетаРегл, РасходыОстатки.АналитикаУчета)
	|		И НастройкиПоАналитике.МестоУчета = НЕОПРЕДЕЛЕНО
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		РасходыОбороты.Организация КАК Организация,
	|		РасходыОбороты.МестоУчета КАК МестоУчета,
	|		ЕСТЬNULL(НастройкиПоМестуУчета.СчетУчета, ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)))) КАК СчетБУ,
	|		0 КАК НачальныйОстаток,
	|		РасходыОбороты.Приход КАК Приход,
	|		РасходыОбороты.Расход КАК Расход,
	|		0 КАК КонечныйОстаток,
	|		0 КАК НачальныеСальдо,
	|		0 КАК ОборотДт,
	|		0 КАК ОборотКт,
	|		0 КАК КонечноеСальдо
	|	ИЗ
	|		втРасходыОбороты КАК РасходыОбороты
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиРасходов
	|	ПО
	|		РасходыОбороты.АналитикаУчета = СтатьиРасходов.Ссылка
	|		И РасходыОбороты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы)
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоМестуУчета
	|	ПО 
	|		НастройкиПоМестуУчета.ВидСчета = РасходыОбороты.ВидСчета
	|		И НастройкиПоМестуУчета.Организация = РасходыОбороты.Организация
	|		И НастройкиПоМестуУчета.АналитикаУчета = ЕСТЬNULL(СтатьиРасходов.ГруппаФинансовогоУчетаРегл, РасходыОбороты.АналитикаУчета)
	|		И НастройкиПоМестуУчета.МестоУчета = РасходыОбороты.МестоУчета
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоОрганизации
	|	ПО 
	|		НастройкиПоОрганизации.ВидСчета = РасходыОбороты.ВидСчета
	|		И НастройкиПоОрганизации.Организация = РасходыОбороты.Организация
	|		И НастройкиПоОрганизации.АналитикаУчета = ЕСТЬNULL(СтатьиРасходов.ГруппаФинансовогоУчетаРегл, РасходыОбороты.АналитикаУчета)
	|		И НастройкиПоОрганизации.МестоУчета = НЕОПРЕДЕЛЕНО
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоАналитике
	|	ПО 
	|		НастройкиПоАналитике.ВидСчета = РасходыОбороты.ВидСчета
	|		И НастройкиПоАналитике.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|		И НастройкиПоАналитике.АналитикаУчета = ЕСТЬNULL(СтатьиРасходов.ГруппаФинансовогоУчетаРегл, РасходыОбороты.АналитикаУчета)
	|		И НастройкиПоАналитике.МестоУчета = НЕОПРЕДЕЛЕНО
	|
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ХозрасчетныйОстаткиИОбороты.Организация,
	|		ХозрасчетныйОстаткиИОбороты.Подразделение,
	|		ХозрасчетныйОстаткиИОбороты.Счет,
	|		0,
	|		0,
	|		0,
	|		0,
	|		СУММА(ХозрасчетныйОстаткиИОбороты.СуммаНачальныйОстаток),
	|		СУММА(ХозрасчетныйОстаткиИОбороты.СуммаОборотДт),
	|		СУММА(ХозрасчетныйОстаткиИОбороты.СуммаОборотКт),
	|		СУММА(ХозрасчетныйОстаткиИОбороты.СуммаКонечныйОстаток)
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, , Движения, 
	|						Счет В (&СчетаУчетаРасходов), , Организация В (&МассивОрганизаций)) КАК ХозрасчетныйОстаткиИОбороты
	|	
	|	СГРУППИРОВАТЬ ПО
	|		ХозрасчетныйОстаткиИОбороты.Подразделение,
	|		ХозрасчетныйОстаткиИОбороты.Счет,
	|		ХозрасчетныйОстаткиИОбороты.Организация
	|
	|	ОБЪЕДИНИТЬ ВСЕ
	|
	|	ВЫБРАТЬ
	|		Хозрасчетный.Организация,
	|		Хозрасчетный.ПодразделениеДт,
	|		Хозрасчетный.СчетДт,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0,
	|		СУММА(-Хозрасчетный.Сумма),
	|		0,
	|		0
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный КАК Хозрасчетный
	|	ГДЕ
	|		Хозрасчетный.СчетДт В(&СчетаУчетаРасходов)
	|		И Хозрасчетный.Организация В (&МассивОрганизаций)
	|		И Хозрасчетный.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И (Хозрасчетный.Регистратор ССЫЛКА Документ.ОтчетКомиссионера
	|				ИЛИ Хозрасчетный.Регистратор ССЫЛКА Документ.ОтчетПоКомиссииМеждуОрганизациями)
	|	
	|	СГРУППИРОВАТЬ ПО
	|		Хозрасчетный.Организация,
	|		Хозрасчетный.ПодразделениеДт,
	|		Хозрасчетный.СчетДт
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		Хозрасчетный.Организация,
	|		Хозрасчетный.ПодразделениеКт,
	|		Хозрасчетный.СчетКт,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0,
	|		0,
	|		СУММА(-Хозрасчетный.Сумма),
	|		0
	|	ИЗ
	|		РегистрБухгалтерии.Хозрасчетный КАК Хозрасчетный
	|	ГДЕ
	|		Хозрасчетный.СчетКт В(&СчетаУчетаРасходов)
	|		И Хозрасчетный.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|		И Хозрасчетный.Организация В (&МассивОрганизаций)
	|		И (Хозрасчетный.Регистратор ССЫЛКА Документ.ОтчетКомиссионера
	|				ИЛИ Хозрасчетный.Регистратор ССЫЛКА Документ.ОтчетПоКомиссииМеждуОрганизациями)
	|
	|	СГРУППИРОВАТЬ ПО
	|		Хозрасчетный.Организация,
	|		Хозрасчетный.ПодразделениеКт,
	|		Хозрасчетный.СчетКт) КАК Подзапрос
	|
	|СГРУППИРОВАТЬ ПО
	|	Подзапрос.Организация,
	|	Подзапрос.Подразделение,
	|	Подзапрос.СчетБУ";
	
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	ТекстЗапроса = СтрСоединить(МассивТекстовЗапроса, ОбщегоНазначения.РазделительПакетаЗапросов());
	
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстЗапросаПроизводственныеЗатратыПоРегистраторам()
	
	МассивТекстовЗапроса = Новый Массив;
	
	#Область РасходыПроизводственныеЗатратыОборотыОУ
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ДокументДвижения = НЕОПРЕДЕЛЕНО
	|			ТОГДА СебестоимостьТоваров.Регистратор
	|		ИНАЧЕ СебестоимостьТоваров.ДокументДвижения
	|	КОНЕЦ КАК Регистратор,
	|	СебестоимостьТоваров.Организация КАК Организация,
	|	ВЫБОР
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Аналитика.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА Аналитика.Договор.Подразделение
	|		КОГДА СебестоимостьТоваров.РазделУчета В (
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеПереданныеПартнерам))
	|		ТОГДА ЕСТЬNULL(СебестоимостьТоваров.ВидЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК Подразделение,
	|	ЕСТЬNULL(АналитикиФинансовогоУчета.Ссылка, ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)) КАК АналитикаУчета,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.РезервПодОбесценениеРегл <> 0
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеПроизводства)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|	КОНЕЦ КАК ВидСчета,
	|	ВЫБОР 
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	//++ НЕ УТКА
	
	//++ Устарело_Переработка24
	|		И НЕ СебестоимостьТоваров.Регистратор ССЫЛКА Документ.ОтчетПереработчика
	|		ИЛИ (СебестоимостьТоваров.Регистратор ССЫЛКА Документ.ОтчетПереработчика
	|		И СебестоимостьТоваров.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство)
	|		И (ЕСТЬNULL(ВЫРАЗИТЬ(СебестоимостьТоваров.Партия КАК Справочник.ПартииПроизводства).НаправлениеДеятельности,
	|				ЕСТЬNULL(Аналитика.Назначение.НаправлениеДеятельности, ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка))) <>
	|			ЕСТЬNULL(ВЫРАЗИТЬ(СебестоимостьТоваров.КорПартия КАК Справочник.ПартииПроизводства).НаправлениеДеятельности,
	|				ЕСТЬNULL(КорАналитика.Назначение.НаправлениеДеятельности, СебестоимостьТоваров.КорНаправлениеДеятельности))
	|			ИЛИ СебестоимостьТоваров.АналитикаФинансовогоУчета <> СебестоимостьТоваров.КорАналитикаФинансовогоУчета
	|			ИЛИ ТИПЗНАЧЕНИЯ(ЕСТЬNULL(КорАналитика.МестоХранения, Аналитика.МестоХранения)) = ТИП(Справочник.СтруктураПредприятия)
	|				И СебестоимостьТоваров.Подразделение <>
	|			ВЫРАЗИТЬ(ЕСТЬNULL(КорАналитика.МестоХранения, Аналитика.МестоХранения) КАК Справочник.СтруктураПредприятия)
	|			ИЛИ СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) И СебестоимостьТоваров.СтоимостьРегл > 0))
	//++ Устарело_Переработка24
	
	//-- НЕ УТКА
	|		ТОГДА СебестоимостьТоваров.СтоимостьРегл
	|			+ СебестоимостьТоваров.ДопРасходыРегл 
	|			+ СебестоимостьТоваров.ТрудозатратыРегл
	|			+ СебестоимостьТоваров.ПостатейныеПостоянныеРегл
	|			+ СебестоимостьТоваров.ПостатейныеПеременныеРегл
	|			+ СебестоимостьТоваров.РезервПодОбесценениеРегл
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК Приход,
	|	ВЫБОР 
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	//++ НЕ УТКА

	//++ Устарело_Переработка24
	|		И НЕ СебестоимостьТоваров.Регистратор ССЫЛКА Документ.ОтчетПереработчика
	|		ИЛИ (СебестоимостьТоваров.Регистратор ССЫЛКА Документ.ОтчетПереработчика
	|		И СебестоимостьТоваров.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство)
	|		И СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И (ЕСТЬNULL(ВЫРАЗИТЬ(СебестоимостьТоваров.Партия КАК Справочник.ПартииПроизводства).НаправлениеДеятельности,
	|				ЕСТЬNULL(Аналитика.Назначение.НаправлениеДеятельности, ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка))) <>
	|			ЕСТЬNULL(ВЫРАЗИТЬ(СебестоимостьТоваров.КорПартия КАК Справочник.ПартииПроизводства).НаправлениеДеятельности,
	|				ЕСТЬNULL(КорАналитика.Назначение.НаправлениеДеятельности, СебестоимостьТоваров.КорНаправлениеДеятельности))
	|			ИЛИ СебестоимостьТоваров.АналитикаФинансовогоУчета <> СебестоимостьТоваров.КорАналитикаФинансовогоУчета
	|			ИЛИ ТИПЗНАЧЕНИЯ(ЕСТЬNULL(КорАналитика.МестоХранения, Аналитика.МестоХранения)) = ТИП(Справочник.СтруктураПредприятия)
	|				И СебестоимостьТоваров.Подразделение <>
	|			ВЫРАЗИТЬ(ЕСТЬNULL(КорАналитика.МестоХранения, Аналитика.МестоХранения) КАК Справочник.СтруктураПредприятия)))
	//-- Устарело_Переработка24
	
	//-- НЕ УТКА
	|		ТОГДА СебестоимостьТоваров.СтоимостьРегл
	|			+ СебестоимостьТоваров.ДопРасходыРегл 
	|			+ СебестоимостьТоваров.ТрудозатратыРегл
	|			+ СебестоимостьТоваров.ПостатейныеПостоянныеРегл
	|			+ СебестоимостьТоваров.ПостатейныеПеременныеРегл
	|			+ СебестоимостьТоваров.РезервПодОбесценениеРегл
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК Расход
	|ПОМЕСТИТЬ втРасходыОбороты
	|ИЗ
	|	РегистрНакопления.СебестоимостьТоваров КАК СебестоимостьТоваров
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КлючиАналитикиУчетаНоменклатуры КАК Аналитика
	|		ПО СебестоимостьТоваров.АналитикаУчетаНоменклатуры = Аналитика.Ссылка
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КлючиАналитикиУчетаНоменклатуры КАК КорАналитика
	|		ПО СебестоимостьТоваров.КорАналитикаУчетаНоменклатуры = КорАналитика.Ссылка
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ГруппыАналитическогоУчетаНоменклатуры КАК АналитикиФинансовогоУчета
	|	ПО АналитикиФинансовогоУчета.Ссылка = СебестоимостьТоваров.АналитикаФинансовогоУчета
	|		И &НастройкаСчетовУчетаПроизводстваПоГруппамПродукции
	|ГДЕ
	|	СебестоимостьТоваров.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|	И СебестоимостьТоваров.Организация В (&МассивОрганизаций)
	|	И СебестоимостьТоваров.Активность
	|	И СебестоимостьТоваров.РазделУчета В (&ЗабалансовыеРазделыУчета,
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ВЫБОР
	|		КОГДА ПрочиеРасходы.ДокументДвижения = ЗНАЧЕНИЕ(Документ.РаспределениеПрочихЗатрат.ПустаяСсылка)
	|			ТОГДА ПрочиеРасходы.Регистратор
	|		ИНАЧЕ ПрочиеРасходы.ДокументДвижения
	|	КОНЕЦ КАК Регистратор,
	|	ПрочиеРасходы.Организация КАК Организация,
	|	ПрочиеРасходы.Подразделение КАК Подразделение,
	|	ПрочиеРасходы.СтатьяРасходов КАК СтатьяРасходов,
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчета,
	|	ВЫБОР 
	|		КОГДА ПрочиеРасходы.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|			ТОГДА ПрочиеРасходы.СуммаРегл
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК Приход,
	|	ВЫБОР 
	|		КОГДА ПрочиеРасходы.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			И ПрочиеРасходы.СтатьяРасходов <> ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПогрешностьРасчетаСебестоимости)
	|			ТОГДА ПрочиеРасходы.СуммаРегл
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК Расход
	|ИЗ
	|	РегистрНакопления.ПрочиеРасходы КАК ПрочиеРасходы
	|ГДЕ
	|	ПрочиеРасходы.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|	И ПрочиеРасходы.Организация В (&МассивОрганизаций)
	|	И ПрочиеРасходы.Активность
	|	И ПрочиеРасходы.СтатьяРасходов.ВидДеятельностиРасходов <> ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиРасходов.ПрочаяДеятельность)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ВЫБОР
	|		КОГДА ПрочиеРасходыНезавершенногоПроизводства.ДокументДвижения = НЕОПРЕДЕЛЕНО
	|			ТОГДА ПрочиеРасходыНезавершенногоПроизводства.Регистратор
	|		ИНАЧЕ ПрочиеРасходыНезавершенногоПроизводства.ДокументДвижения
	|	КОНЕЦ КАК Регистратор,
	|	ПрочиеРасходыНезавершенногоПроизводства.Организация КАК Организация,
	|	ПрочиеРасходыНезавершенногоПроизводства.Подразделение КАК Подразделение,
	|	ВЫБОР 
	|		КОГДА &НастройкаСчетовУчетаПроизводстваПоГруппамПродукции
	|		ТОГДА ПрочиеРасходыНезавершенногоПроизводства.ГруппаПродукции
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|	КОНЕЦ КАК СтатьяРасходов,
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство) КАК ВидСчета,
	|	ВЫБОР 
	|		КОГДА ПрочиеРасходыНезавершенногоПроизводства.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|			ТОГДА ПрочиеРасходыНезавершенногоПроизводства.СтоимостьРегл
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК Приход,
	|	ВЫБОР 
	|		КОГДА ПрочиеРасходыНезавершенногоПроизводства.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			ТОГДА ПрочиеРасходыНезавершенногоПроизводства.СтоимостьРегл
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК Расход
	|ИЗ
	|	РегистрНакопления.ПрочиеРасходыНезавершенногоПроизводства КАК ПрочиеРасходыНезавершенногоПроизводства
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КлючиАналитикиУчетаНоменклатуры КАК КорКлючиАналитикиУчетаНоменклатуры
	|		ПО ПрочиеРасходыНезавершенногоПроизводства.АналитикаУчетаПродукции = КорКлючиАналитикиУчетаНоменклатуры.Ссылка

	|ГДЕ
	|	ПрочиеРасходыНезавершенногоПроизводства.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|	И ПрочиеРасходыНезавершенногоПроизводства.Организация В (&МассивОрганизаций)
	|	И ПрочиеРасходыНезавершенногоПроизводства.Активность
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ТрудозатратыНезавершенногоПроизводства.Регистратор КАК Регистратор,
	|	ТрудозатратыНезавершенногоПроизводства.Организация КАК Организация,
	|	ТрудозатратыНезавершенногоПроизводства.Подразделение КАК Подразделение,
	|	ВЫБОР 
	|		КОГДА &НастройкаСчетовУчетаПроизводстваПоГруппамПродукции
	|		ТОГДА ТрудозатратыНезавершенногоПроизводства.ГруппаПродукции
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|	КОНЕЦ,
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство) КАК ВидСчета,
	|	ВЫБОР 
	|		КОГДА ТрудозатратыНезавершенногоПроизводства.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|			ТОГДА ТрудозатратыНезавершенногоПроизводства.СтоимостьРегл
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК Приход,
	|	ВЫБОР 
	|		КОГДА ТрудозатратыНезавершенногоПроизводства.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			ТОГДА ТрудозатратыНезавершенногоПроизводства.СтоимостьРегл
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК Расход
	|ИЗ
	|	РегистрНакопления.ТрудозатратыНезавершенногоПроизводства КАК ТрудозатратыНезавершенногоПроизводства
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КлючиАналитикиУчетаНоменклатуры КАК КорКлючиАналитикиУчетаНоменклатуры
	|		ПО ТрудозатратыНезавершенногоПроизводства.КорАналитикаУчетаПродукции = КорКлючиАналитикиУчетаНоменклатуры.Ссылка
	|ГДЕ
	|	ТрудозатратыНезавершенногоПроизводства.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|	И ТрудозатратыНезавершенногоПроизводства.Организация В (&МассивОрганизаций)
	|	И ТрудозатратыНезавершенногоПроизводства.Активность";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область РасходыПроизводственныеЗатратыОУиБУ
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	РасходыОбороты.Организация КАК Организация,
	|	РасходыОбороты.Подразделение КАК Подразделение,
	|	ЕСТЬNULL(НастройкиПоМестуУчета.СчетУчета, ЕСТЬNULL(НастройкиПоОрганизации.СчетУчета, ЕСТЬNULL(НастройкиПоАналитике.СчетУчета, ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)))) КАК СчетБУ,
	|	РасходыОбороты.Приход КАК Приход,
	|	РасходыОбороты.Расход КАК Расход,
	|	0 КАК ОборотДт,
	|	0 КАК ОборотКт,
	|	РасходыОбороты.Регистратор КАК Регистратор
	|ПОМЕСТИТЬ втСверкаОборотов
	|ИЗ
	|	втРасходыОбороты КАК РасходыОбороты
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиРасходов
	|	ПО
	|		РасходыОбороты.АналитикаУчета = СтатьиРасходов.Ссылка
	|		И РасходыОбороты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы)
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоМестуУчета
	|	ПО 
	|		НастройкиПоМестуУчета.ВидСчета = РасходыОбороты.ВидСчета
	|		И НастройкиПоМестуУчета.Организация = РасходыОбороты.Организация
	|		И НастройкиПоМестуУчета.АналитикаУчета = ЕСТЬNULL(СтатьиРасходов.ГруппаФинансовогоУчетаРегл, РасходыОбороты.АналитикаУчета)
	|		И НастройкиПоМестуУчета.МестоУчета = РасходыОбороты.Подразделение
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоОрганизации
	|	ПО 
	|		НастройкиПоОрганизации.ВидСчета = РасходыОбороты.ВидСчета
	|		И НастройкиПоОрганизации.Организация = РасходыОбороты.Организация
	|		И НастройкиПоОрганизации.АналитикаУчета = ЕСТЬNULL(СтатьиРасходов.ГруппаФинансовогоУчетаРегл, РасходыОбороты.АналитикаУчета)
	|		И НастройкиПоОрганизации.МестоУчета = НЕОПРЕДЕЛЕНО
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК НастройкиПоАналитике
	|	ПО 
	|		НастройкиПоАналитике.ВидСчета = РасходыОбороты.ВидСчета
	|		И НастройкиПоАналитике.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|		И НастройкиПоАналитике.АналитикаУчета = ЕСТЬNULL(СтатьиРасходов.ГруппаФинансовогоУчетаРегл, РасходыОбороты.АналитикаУчета)
	|		И НастройкиПоАналитике.МестоУчета = НЕОПРЕДЕЛЕНО
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ХозрасчетныйОстаткиИОбороты.Организация,
	|	ХозрасчетныйОстаткиИОбороты.Подразделение,
	|	ХозрасчетныйОстаткиИОбороты.Счет,
	|	0,
	|	0,
	|	СУММА(ХозрасчетныйОстаткиИОбороты.СуммаОборотДт),
	|	СУММА(ХозрасчетныйОстаткиИОбороты.СуммаОборотКт),
	|	ХозрасчетныйОстаткиИОбороты.Регистратор
	|ИЗ
	|		РегистрБухгалтерии.Хозрасчетный.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, Регистратор, Движения, 
	|						Счет В (&СчетаУчетаРасходов), , Организация В (&МассивОрганизаций)) КАК ХозрасчетныйОстаткиИОбороты
	|
	|СГРУППИРОВАТЬ ПО
	|	ХозрасчетныйОстаткиИОбороты.Подразделение,
	|	ХозрасчетныйОстаткиИОбороты.Счет,
	|	ХозрасчетныйОстаткиИОбороты.Организация,
	|	ХозрасчетныйОстаткиИОбороты.Регистратор
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Хозрасчетный.Организация,
	|	Хозрасчетный.ПодразделениеДт,
	|	Хозрасчетный.СчетДт,
	|	0,
	|	0,
	|	СУММА(-Хозрасчетный.Сумма),
	|	0,
	|	Хозрасчетный.Регистратор
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный КАК Хозрасчетный
	|ГДЕ
	|	Хозрасчетный.СчетДт В(&СчетаУчетаРасходов)
	|	И Хозрасчетный.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|	И Хозрасчетный.Организация В (&МассивОрганизаций)
	|	И (Хозрасчетный.Регистратор ССЫЛКА Документ.ОтчетКомиссионера
	|			ИЛИ Хозрасчетный.Регистратор ССЫЛКА Документ.ОтчетПоКомиссииМеждуОрганизациями)
	|
	|СГРУППИРОВАТЬ ПО
	|	Хозрасчетный.Организация,
	|	Хозрасчетный.ПодразделениеДт,
	|	Хозрасчетный.СчетДт,
	|	Хозрасчетный.Регистратор
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Хозрасчетный.Организация,
	|	Хозрасчетный.ПодразделениеКт,
	|	Хозрасчетный.СчетКт,
	|	0,
	|	0,
	|	0,
	|	СУММА(-Хозрасчетный.Сумма),
	|	Хозрасчетный.Регистратор
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный КАК Хозрасчетный
	|ГДЕ
	|	Хозрасчетный.СчетКт В(&СчетаУчетаРасходов)
	|	И Хозрасчетный.Период МЕЖДУ &НачалоПериода И &КонецПериода
	|	И Хозрасчетный.Организация В (&МассивОрганизаций)
	|	И (Хозрасчетный.Регистратор ССЫЛКА Документ.ОтчетКомиссионера
	|			ИЛИ Хозрасчетный.Регистратор ССЫЛКА Документ.ОтчетПоКомиссииМеждуОрганизациями)
	|
	|СГРУППИРОВАТЬ ПО
	|	Хозрасчетный.Организация,
	|	Хозрасчетный.ПодразделениеКт,
	|	Хозрасчетный.СчетКт,
	|	Хозрасчетный.Регистратор
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Организация,
	|	Регистратор";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область втСтатусыОтражения
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	МАКСИМУМ(ОтражениеДокументовВРеглУчете.Статус) КАК Статус,
	|	ОтражениеДокументовВРеглУчете.Регистратор КАК Регистратор,
	|	ОтражениеДокументовВРеглУчете.Организация КАК Организация
	|ПОМЕСТИТЬ втСтатусыОтражения
	|ИЗ
	|	РегистрСведений.ОтражениеДокументовВРеглУчете КАК ОтражениеДокументовВРеглУчете
	|ГДЕ
	|	ОтражениеДокументовВРеглУчете.Регистратор В
	|			(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|				Т.Регистратор КАК Регистратор
	|			ИЗ
	|				втРасходыОбороты КАК Т)
	|
	|СГРУППИРОВАТЬ ПО
	|	ОтражениеДокументовВРеглУчете.Регистратор,
	|	ОтражениеДокументовВРеглУчете.Организация
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Организация,
	|	Регистратор";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область Результат
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	""Расходы"" КАК РазделУчета,
	|	Подзапрос.Организация,
	|	Подзапрос.Подразделение,
	|	Подзапрос.СчетБУ,
	|	СУММА(Подзапрос.Приход) КАК Приход,
	|	СУММА(Подзапрос.Расход) КАК Расход,
	|	СУММА(Подзапрос.ОборотДт) КАК ОборотДт,
	|	СУММА(Подзапрос.ОборотКт) КАК ОборотКт,
	|	Подзапрос.Регистратор КАК Регистратор,
	|	втСтатусыОтражения.Статус КАК Статус
	|ИЗ
	|	втСверкаОборотов КАК Подзапрос
	|		ЛЕВОЕ СОЕДИНЕНИЕ втСтатусыОтражения КАК втСтатусыОтражения
	|		ПО Подзапрос.Организация = втСтатусыОтражения.Организация
	|			И Подзапрос.Регистратор = втСтатусыОтражения.Регистратор
	|
	|СГРУППИРОВАТЬ ПО
	|	Подзапрос.Организация,
	|	Подзапрос.Подразделение,
	|	Подзапрос.СчетБУ,
	|	Подзапрос.Регистратор,
	|	втСтатусыОтражения.Статус";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область УничтожениеТаблиц
	
	ТекстЗапроса =
	"УНИЧТОЖИТЬ втСтатусыОтражения";
	
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	ТекстЗапроса = СтрСоединить(МассивТекстовЗапроса, ОбщегоНазначения.РазделительПакетаЗапросов());
	
	Возврат ТекстЗапроса;
	
КонецФункции

#КонецОбласти

#КонецОбласти

#КонецЕсли
