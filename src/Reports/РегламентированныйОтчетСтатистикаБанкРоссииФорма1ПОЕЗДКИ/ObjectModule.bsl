#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

Перем ИменаРазделовИТаблицСтр;

Перем ИменаСправочниковИСсылки;

#Область СлужебныеПроцедурыИФункции

#Область ФормированиеРегламентированногоОтчета

Процедура ИнициализацияПеременныхМодуля()
	
	// В каждой группе <Имя раздела>,<Имя таблицы шаблона>.
	ИменаРазделовИТаблицСтр = "Раздел1,INTOUR;Раздел2,OUTTOUR;Раздел3,NREZ;Раздел4,REZ";
	
	ИменаСправочниковИСсылки = Новый СписокЗначений;
	ИменаСправочниковИСсылки.Добавить("OKVED",     "ОКВЭД2", Истина); // ОКВЭД2
	ИменаСправочниковИСсылки.Добавить("OKOPF",     "F:G");            // ОКОПФ
	ИменаСправочниковИСсылки.Добавить("OKFS",      "H:I");            // ОКФС
	ИменаСправочниковИСсылки.Добавить("OKSM",      "L:M");            // КодыСтран
	ИменаСправочниковИСсылки.Добавить("OKSM_1",    "R:S");            // КодыСтран2
	ИменаСправочниковИСсылки.Добавить("OKV",       "N:O");            // КодыВалют
	ИменаСправочниковИСсылки.Добавить("REGION",    "J:K");            // Регионы
	ИменаСправочниковИСсылки.Добавить("OPERATION", "P:Q");            // КодыОпераций
	
	ИменаСправочниковИСсылки.Добавить("OKTMO",     "ОКТМО",  Истина); // ОКТМО
	
КонецПроцедуры

#КонецОбласти

#Область ВыгрузкаРегламентированногоОтчета

Процедура ПрочитатьМетаданныеШаблона(МакетМетаданныхШаблона, МакетСписковВыбора, МетаданныеШаблона) Экспорт
	
	Если ТипЗнч(МетаданныеШаблона) <> Тип("Структура") Тогда
		МетаданныеШаблона = Новый Структура();
	КонецЕсли;
	
	Для Каждого Область Из МакетМетаданныхШаблона.Области Цикл
		Если Область.ТипОбласти = ТипОбластиЯчеекТабличногоДокумента.Строки Тогда
			
			ВерхОбласти  = Область.Верх;
			НизОбласти   = Область.Низ;
			ЛевоОбласти  = 1;
			ПравоОбласти = 256;
			
			Если Область.Имя = "Question_Meta" Тогда
				
				ТаблВопросовШаблона = Новый ТаблицаЗначений;
				Для НомКол = ЛевоОбласти По ПравоОбласти Цикл
					ИмяКолонки = СокрЛП(МакетМетаданныхШаблона.Область(ВерхОбласти, НомКол).Текст);
					Если ПустаяСтрока(ИмяКолонки) Тогда
						ПравоОбласти = НомКол - 1;
						Прервать;
					КонецЕсли;
					ТаблВопросовШаблона.Колонки.Добавить(ИмяКолонки, Новый ОписаниеТипов("Строка"));
				КонецЦикла;
				
				Для НомСтр = ВерхОбласти + 1 По НизОбласти Цикл
					ЗначениеОбластиВПервойКолонке = СокрЛП(МакетМетаданныхШаблона.Область(НомСтр, ЛевоОбласти).Текст);
					Если НЕ ПустаяСтрока(ЗначениеОбластиВПервойКолонке) Тогда
						ИндКолонки = 0;
						НовСтрока = ТаблВопросовШаблона.Добавить();
						Для НомКол = ЛевоОбласти По ПравоОбласти Цикл
							ЗначениеОбласти = СокрП(МакетМетаданныхШаблона.Область(НомСтр, НомКол, НомСтр, НомКол).Текст);
							НовСтрока.Установить(ИндКолонки, ЗначениеОбласти);
							ИндКолонки = ИндКолонки + 1;
						КонецЦикла;
					КонецЕсли;
				КонецЦикла;
				
				МетаданныеШаблона.Вставить(Область.Имя, ТаблВопросовШаблона);
				
			ИначеЕсли Область.Имя = "Period_Check_Meta" Тогда
				
				ТаблПроверкиПериодаШаблона = Новый ТаблицаЗначений;
				Для НомКол = ЛевоОбласти По ПравоОбласти Цикл
					ИмяКолонки = СокрЛП(МакетМетаданныхШаблона.Область(ВерхОбласти, НомКол).Текст);
					Если ПустаяСтрока(ИмяКолонки) Тогда
						ПравоОбласти = НомКол - 1;
						Прервать;
					КонецЕсли;
					ТаблПроверкиПериодаШаблона.Колонки.Добавить(ИмяКолонки, Новый ОписаниеТипов("Строка"));
				КонецЦикла;
				
				Для НомСтр = ВерхОбласти + 1 По НизОбласти Цикл
					ЗначениеОбластиВПервойКолонке = СокрЛП(МакетМетаданныхШаблона.Область(НомСтр, ЛевоОбласти).Текст);
					Если НЕ ПустаяСтрока(ЗначениеОбластиВПервойКолонке) Тогда
						ИндКолонки = 0;
						НовСтрока = ТаблПроверкиПериодаШаблона.Добавить();
						Для НомКол = ЛевоОбласти По ПравоОбласти Цикл
							ЗначениеОбласти = СокрП(МакетМетаданныхШаблона.Область(НомСтр, НомКол, НомСтр, НомКол).Текст);
							НовСтрока.Установить(ИндКолонки, ЗначениеОбласти);
							ИндКолонки = ИндКолонки + 1;
						КонецЦикла;
					КонецЕсли;
				КонецЦикла;
				
				МетаданныеШаблона.Вставить(Область.Имя, ТаблПроверкиПериодаШаблона);
				
			ИначеЕсли Область.Имя = "Survey_Meta" Тогда
				
				СписокОпросШаблона = Новый СписокЗначений;
				
				Для НомСтр = ВерхОбласти По НизОбласти Цикл
					ЗначениеОбластиВПервойКолонке = СокрЛП(МакетМетаданныхШаблона.Область(НомСтр, ЛевоОбласти).Текст);
					Если НЕ ПустаяСтрока(ЗначениеОбластиВПервойКолонке) Тогда
						ЗначениеОбластиВоВторойКолонке = СокрП(МакетМетаданныхШаблона.Область(НомСтр, ЛевоОбласти + 1).Текст);
						СписокОпросШаблона.Добавить(ЗначениеОбластиВоВторойКолонке, ЗначениеОбластиВПервойКолонке);
					КонецЕсли;
				КонецЦикла;
				
				МетаданныеШаблона.Вставить(Область.Имя, СписокОпросШаблона);
				
			ИначеЕсли Область.Имя = "KeyValuePair_Meta" Тогда
				
				СправочникиКлючИЗначение = Новый Структура;
				
				Для НомСтр = ВерхОбласти По НизОбласти Цикл
					ЗначениеОбластиВПервойКолонке = СокрЛП(МакетМетаданныхШаблона.Область(НомСтр, ЛевоОбласти).Текст);
					Если НЕ ПустаяСтрока(ЗначениеОбластиВПервойКолонке) Тогда
						ЗначениеОбластиВоВторойКолонке = СокрП(МакетМетаданныхШаблона.Область(НомСтр, ЛевоОбласти + 1).Текст);
						СпрКоординатыОбласти = РегламентированнаяОтчетностьБанкРоссии.КоординатыОбласти(ЗначениеОбластиВоВторойКолонке);
						
						ТаблСправочникКлючИЗначение = Новый ТаблицаЗначений;
						ТаблСправочникКлючИЗначение.Колонки.Добавить("Ключ",     Новый ОписаниеТипов("Строка"));
						ТаблСправочникКлючИЗначение.Колонки.Добавить("Значение", Новый ОписаниеТипов("Строка"));
						Для НомСтрСпр = ВерхОбласти По НизОбласти Цикл
							Ключ = СокрЛП(МакетМетаданныхШаблона.Область(НомСтрСпр, СпрКоординатыОбласти.Столбец1).Текст);
							Значение = СокрЛП(МакетМетаданныхШаблона.Область(НомСтрСпр, СпрКоординатыОбласти.Столбец2).Текст);
							Если НЕ ПустаяСтрока(Ключ) Тогда
								НовСтрока = ТаблСправочникКлючИЗначение.Добавить();
								НовСтрока.Ключ = Ключ;
								НовСтрока.Значение = Значение;
							Иначе
								Прервать;
							КонецЕсли;
						КонецЦикла;
						
						СправочникиКлючИЗначение.Вставить(ЗначениеОбластиВПервойКолонке, ТаблСправочникКлючИЗначение);
					Иначе
						Прервать;
					КонецЕсли;
				КонецЦикла;
				
				МетаданныеШаблона.Вставить(Область.Имя, СправочникиКлючИЗначение);
				
			ИначеЕсли Область.Имя = "NSI_Meta" Тогда
				
				СправочникиКлючИЗначение = Новый Структура;
				
				Для Каждого ЭлементИмяИСсылка Из ИменаСправочниковИСсылки Цикл
					
					ИмяСправочника   = ЭлементИмяИСсылка.Значение;
					СсылкаНаДиапазон = ЭлементИмяИСсылка.Представление;
					
					ТекМакетМетаданных = МакетМетаданныхШаблона;
					ВерхОбластиСпр = ВерхОбласти;
					НизОбластиСпр  = НизОбласти;
					НомерКолонкиКлюч = 1;
					НомерКолонкиЗначение = 2;
					Если ЭлементИмяИСсылка.Пометка Тогда // справочник загружаем из макета "СпискиВыбора*"
						Если МакетСписковВыбора = Неопределено Тогда
							Продолжить;
						КонецЕсли;
						ТекМакетМетаданных = МакетСписковВыбора;
						ОбластьСправочника = ТекМакетМетаданных.Области.Найти(СсылкаНаДиапазон);
						Если ОбластьСправочника = Неопределено Тогда
							Продолжить;
						КонецЕсли;
						ВерхОбластиСпр = ОбластьСправочника.Верх;
						НизОбластиСпр  = ОбластьСправочника.Низ;
						// Выполним следующие действия, если справочник размещен в сжатом макете.
						Ключ = СокрЛП(ТекМакетМетаданных.Область(ВерхОбластиСпр, НомерКолонкиКлюч).Текст);
						Если Лев(Ключ, 1) = "@" Тогда
							Если НРег(Прав(Ключ, 3) = "zip") Тогда
								ИмяСжатогоМакета = Сред(Ключ, 2);
								ИмяОбласти = СокрЛП(ТекМакетМетаданных.Область(ВерхОбластиСпр, НомерКолонкиЗначение).Текст);
								ТекМакетМетаданных = РаспакованныйМакетМетаданных(ИмяСжатогоМакета, ИмяОбласти, ВерхОбластиСпр, НизОбластиСпр);
							Иначе
								Продолжить;
							КонецЕсли;
						КонецЕсли;
					Иначе
						СпрКоординатыОбласти = РегламентированнаяОтчетностьБанкРоссии.КоординатыОбласти(СсылкаНаДиапазон);
						НомерКолонкиКлюч     = СпрКоординатыОбласти.Столбец1;
						НомерКолонкиЗначение = СпрКоординатыОбласти.Столбец2;
					КонецЕсли;
					
					ТаблСправочникКлючИЗначение = Новый ТаблицаЗначений;
					ТаблСправочникКлючИЗначение.Колонки.Добавить("Ключ",     Новый ОписаниеТипов("Строка"));
					ТаблСправочникКлючИЗначение.Колонки.Добавить("Значение", Новый ОписаниеТипов("Строка"));
					
					Для НомСтрСпр = ВерхОбластиСпр + 1 По НизОбластиСпр Цикл
						Ключ = СокрЛП(ТекМакетМетаданных.Область(НомСтрСпр, НомерКолонкиКлюч).Текст);
						Значение = СокрЛП(ТекМакетМетаданных.Область(НомСтрСпр, НомерКолонкиЗначение).Текст);
						Если НЕ ПустаяСтрока(Ключ) Тогда
							НовСтрока = ТаблСправочникКлючИЗначение.Добавить();
							НовСтрока.Ключ = Ключ;
							НовСтрока.Значение = Значение;
						Иначе
							Прервать;
						КонецЕсли;
					КонецЦикла;
					
					СправочникиКлючИЗначение.Вставить(ИмяСправочника, ТаблСправочникКлючИЗначение);
					
				КонецЦикла;
				
				МетаданныеШаблона.Вставить(Область.Имя, СправочникиКлючИЗначение);
				
			КонецЕсли;
			
		КонецЕсли;
	КонецЦикла;
	
	// Создадим таблицу данных листа ответов анкеты.
	ТаблОтветовШаблона = Новый ТаблицаЗначений;
	ТаблОтветовШаблона.Колонки.Добавить("ИДВопроса",      Новый ОписаниеТипов("Строка"));
	ТаблОтветовШаблона.Колонки.Добавить("ЗначениеОтвета", Новый ОписаниеТипов("Строка"));
	ТаблОтветовШаблона.Колонки.Добавить("НомСтрокиЛиста", Новый ОписаниеТипов("Число", Новый КвалификаторыЧисла(6, 0)));
	ТаблОтветовШаблона.Добавить();
	
	МетаданныеШаблона.Вставить("Answer_Meta", ТаблОтветовШаблона);
	
	// Создадим таблицу данных листа ошибок анкеты.
	ТаблОшибокШаблона = Новый ТаблицаЗначений;
	ТаблОшибокШаблона.Колонки.Добавить("АдресОшибки",    Новый ОписаниеТипов("Строка"));
	ТаблОшибокШаблона.Колонки.Добавить("МестоОшибки",    Новый ОписаниеТипов("Строка"));
	ТаблОшибокШаблона.Колонки.Добавить("ОписаниеОшибки", Новый ОписаниеТипов("Строка"));
	ТаблОшибокШаблона.Добавить();
	
	МетаданныеШаблона.Вставить("Errors_Meta", ТаблОшибокШаблона);
	
КонецПроцедуры

Процедура ПодготовитьТаблицыРазделов(Форма, МетаданныеШаблона, ИменаРазделовИТаблиц)
	
	МетаданныеШаблона.Вставить("ТаблицыРазделов", Новый Структура());
	
	Для Каждого ИмяРазделаИТаблицыСтр Из ИменаРазделовИТаблиц Цикл
		ИмяРазделаИТаблицы = СтрРазделить(ИмяРазделаИТаблицыСтр, ",");
		
		ТаблицаРаздела = Новый ТаблицаЗначений;
		ТаблицаРаздела.Колонки.Добавить("НС", Новый ОписаниеТипов("Число", Новый КвалификаторыЧисла(7,0)));
		
		МетаданныеШаблона.ТаблицыРазделов.Вставить(ИмяРазделаИТаблицы[1], ТаблицаРаздела);
		
		Для Каждого ЭлементСтруктуры Из Форма.мДанныеОтчета[ИмяРазделаИТаблицы[0]] Цикл
			
			Для НомСтр = 1 По ЭлементСтруктуры.Значение.Количество() Цикл
				ДанныеСтроки = ЭлементСтруктуры.Значение[НомСтр - 1];
				
				СтрокаНеПустая = Ложь;
				НовСтрока = ТаблицаРаздела.Добавить();
				Для Каждого ЭлементДанных Из ДанныеСтроки Цикл
					ГрафаПоказателя = СтрЗаменить(ЭлементДанных.Ключ, ЭлементСтруктуры.Ключ, "");
					Если НЕ ПустаяСтрока(ГрафаПоказателя) Тогда
						НомерГрафыПоказателя = Число(" " + ГрафаПоказателя);
						
						КоличествоКолонок = ТаблицаРаздела.Колонки.Количество();
						Если НомерГрафыПоказателя >= КоличествоКолонок Тогда
							Для НомКол = КоличествоКолонок + 1 По НомерГрафыПоказателя Цикл
								ТаблицаРаздела.Колонки.Добавить();
							КонецЦикла;
							ТаблицаРаздела.Колонки.Добавить(ЭлементДанных.Ключ);
						ИначеЕсли ПустаяСтрока(ТаблицаРаздела.Колонки[НомерГрафыПоказателя].Имя) Тогда
							ТаблицаРаздела.Колонки[НомерГрафыПоказателя].Имя = ЭлементДанных.Ключ; 
						КонецЕсли;
						
						НовСтрока[НомерГрафыПоказателя] = ЭлементДанных.Значение;
						Если ЗначениеЗаполнено(ЭлементДанных.Значение) Тогда
							СтрокаНеПустая  = Истина;
						КонецЕсли;
					КонецЕсли;
				КонецЦикла;
				
				Если НЕ СтрокаНеПустая Тогда
					ТаблицаРаздела.Удалить(НовСтрока);
				Иначе
					НовСтрока.НС = НомСтр;
				КонецЕсли;
			КонецЦикла;
			
			Прервать;
		КонецЦикла;
	КонецЦикла;
	
КонецПроцедуры

Функция РаспакованныйМакетМетаданных(ИмяСжатогоМакета, ИмяОбласти, ВерхОбластиСпр, НизОбластиСпр)
	
	АрхивМакетаМетаданных = ПолучитьМакет(ИмяСжатогоМакета);
	
	Попытка
		ЧтениеАрхиваМетаданных = Новый ЧтениеZipФайла(АрхивМакетаМетаданных.ОткрытьПотокДляЧтения());
	Исключение
		ВызватьИсключение НСтр("ru = 'В макете отсутствуют сжатые данные.';
								|en = 'В макете отсутствуют сжатые данные.'");
	КонецПопытки;
	
	МакетМетаданных = Новый ТабличныйДокумент;

	ИмяВременнойПапкиZIP = ОбщегоНазначенияКлиентСервер.ДобавитьКонечныйРазделительПути(ПолучитьИмяВременногоФайла());
	СоздатьКаталог(ИмяВременнойПапкиZIP);
	
	ИмяФайлаМакетаМетаданных = ИмяВременнойПапкиZIP + ЧтениеАрхиваМетаданных.Элементы[0].Имя;
	
	ЧтениеАрхиваМетаданных.Извлечь(ЧтениеАрхиваМетаданных.Элементы[0], ИмяВременнойПапкиZIP,
		РежимВосстановленияПутейФайловZIP.НеВосстанавливать);
	ЧтениеАрхиваМетаданных.Закрыть();
	
	МакетМетаданных.Прочитать(ИмяФайлаМакетаМетаданных);
	
	Если ЗначениеЗаполнено(ИмяОбласти) Тогда
		ОбластьСправочника = МакетМетаданных.Область(ИмяОбласти);
	Иначе
		ОбластьСправочника = МакетМетаданных.Область();
	КонецЕсли;
	ВерхОбластиСпр = ОбластьСправочника.Верх;
	НизОбластиСпр  = ОбластьСправочника.Низ;
	
	УдалитьФайлы(ИмяВременнойПапкиZIP);
	
	Возврат МакетМетаданных;
	
КонецФункции

Функция ВыполнитьПроверкуДанных(Форма, ПараметрыВыгрузки, ЕстьПредупреждения = Ложь) Экспорт
	
	СтатусПроверки = Истина;
	
	ИменаРазделовИТаблиц = СтрРазделить(ИменаРазделовИТаблицСтр, ";");
	
	ТаблВопросы = ПараметрыВыгрузки.МетаданныеШаблона["Question_Meta"];
	
	// Подготовка таблиц для обработки и контроля, добавление их в метаданные шаблона.
	ПодготовитьТаблицыРазделов(Форма, ПараметрыВыгрузки.МетаданныеШаблона, ИменаРазделовИТаблиц);
	
	// Обработаем вопросы анкеты для титульного листа.
	СтруктураДанныхТитульный = Форма.мДанныеОтчета.Титульный;
	ВопросыТитульный = ТаблВопросы.НайтиСтроки(Новый Структура("QUESTION_TYPE", "HEADER"));
	Для Каждого ТекВопрос Из ВопросыТитульный Цикл
		ИмяПоказателя = ТекВопрос["QUESTION_NAME_ID"];
		ЗначениеПоказателя = Неопределено;
		Если СтруктураДанныхТитульный.Свойство(ИмяПоказателя, ЗначениеПоказателя) Тогда
			Описание = "";
			РезультатПроверки = РегламентированнаяОтчетностьБанкРоссии.ВыполнитьПроверкуЗначения(
				Форма, ПараметрыВыгрузки, Описание, ТекВопрос, ЗначениеПоказателя);
			Если РезультатПроверки > 0 Тогда
				Если РезультатПроверки = 1 Тогда // Предупреждение
					ЕстьПредупреждения = Истина;
				ИначеЕсли РезультатПроверки = 2 Тогда // Ошибка
					СтатусПроверки = Ложь;
				КонецЕсли;
				
				МестоОшибки = "Титульный лист" + ": """ + ТекВопрос["QUESTION_TEXT"] + """";
				ТекстОшибки = Описание + Символы.ПС + Символы.Таб + "<" + МестоОшибки + ">";
				РегламентированнаяОтчетность.СообщитьВТаблицуСообщений(
					Форма, ТекстОшибки, "Титульный", ИмяПоказателя);
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
	
	// Обновим необходимые данные опроса, если существует поле "NamePeriod".
	Если СтруктураДанныхТитульный.Свойство("NamePeriod") Тогда
		ОбновитьДанныеОпросаПоПериоду(ПараметрыВыгрузки);
	КонецЕсли;
	
	// Обработаем вопросы анкеты для листов с таблицами.
	Для Каждого ИмяРазделаИТаблицыСтр Из ИменаРазделовИТаблиц Цикл
		
		ИмяРазделаИТаблицы = СтрРазделить(ИмяРазделаИТаблицыСтр, ",");
		
		ВопросыРаздела = ТаблВопросы.НайтиСтроки(
			Новый Структура("QUESTION_TYPE,QUESTION_ENTITY", "TABLE", ИмяРазделаИТаблицы[1]));
		
		ТаблицаРаздела = ПараметрыВыгрузки.МетаданныеШаблона.ТаблицыРазделов[ИмяРазделаИТаблицы[1]]; 
		КоличествоКолонокТаблицы = ТаблицаРаздела.Колонки.Количество();
		
		Для НомСтр = 1 По ТаблицаРаздела.Количество() Цикл
			ДанныеСтрокиТаблицы = ТаблицаРаздела[НомСтр - 1];
			СтрНомСтроки = Формат(ДанныеСтрокиТаблицы.НС, "ЧГ=");
			
			ВопросыРазделаИЗначения = Новый Соответствие;
			Для НомВопроса = 1 По ВопросыРаздела.Количество() Цикл
				ТекВопрос = ВопросыРаздела[НомВопроса - 1];
				
				НомКолонки = Число(" " + ТекВопрос["QUESTION_SORT"]);
				НомКолонки = ?(НомКолонки > 0, НомКолонки, НомВопроса);
				
				Если КоличествоКолонокТаблицы > НомКолонки Тогда
					Описание = "";
					ЗначениеОтвета = ДанныеСтрокиТаблицы[НомКолонки];
					
					РезультатПроверки = РегламентированнаяОтчетностьБанкРоссии.ВыполнитьПроверкуЗначения(
						Форма, ПараметрыВыгрузки, Описание, ТекВопрос, ЗначениеОтвета, НомСтр);
					Если РезультатПроверки > 0 Тогда
						Если РезультатПроверки = 1 Тогда // Предупреждение
							ЕстьПредупреждения = Истина;
						ИначеЕсли РезультатПроверки = 2 Тогда // Ошибка
							СтатусПроверки = Ложь;
						КонецЕсли;
						
						МестоОшибки = "Раздел " + Прав(ИмяРазделаИТаблицы[0], 1)
							+ " [строка " + СтрНомСтроки  + "]: """ + ТекВопрос["QUESTION_TEXT"] + """";
						ТекстОшибки = Описание + Символы.ПС + Символы.Таб + "<" + МестоОшибки + ">";
						РегламентированнаяОтчетность.СообщитьВТаблицуСообщений(Форма, ТекстОшибки, ИмяРазделаИТаблицы[0],
							ТаблицаРаздела.Колонки[НомКолонки].Имя + "_" + СтрНомСтроки);
					КонецЕсли;
					
					// Преобразовываем необязательные к заполнению числовые значения в зависимости от ограничений.
					Если РегламентированнаяОтчетностьБанкРоссии.ПреобразоватьЗначениеЕслиНеобходимо(ЗначениеОтвета, ТекВопрос) Тогда
						ДанныеСтрокиТаблицы[НомКолонки] = ЗначениеОтвета;
					КонецЕсли;
					
					ВопросыРазделаИЗначения.Вставить(ТекВопрос["QUESTION_NAME_ID"],
						Новый Структура("ИмяКолонки,Значение,Результат,Вопрос",
							ТаблицаРаздела.Колонки[НомКолонки].Имя, ЗначениеОтвета, РезультатПроверки, ТекВопрос));
				КонецЕсли;
			КонецЦикла;
			
			РезультатПроверки = ВыполнитьПроверкуСтроки(Форма, ИмяРазделаИТаблицы,
				ТаблицаРаздела, ВопросыРазделаИЗначения, ПараметрыВыгрузки, НомСтр);
			Если РезультатПроверки = 1 Тогда      // предупреждения
				ЕстьПредупреждения = Истина;
			ИначеЕсли РезультатПроверки = 2 Тогда // ошибки
				СтатусПроверки = Ложь;
			ИначеЕсли РезультатПроверки = 3 Тогда // ошибки и предупреждения
				ЕстьПредупреждения = Истина;
				СтатусПроверки = Ложь;
			КонецЕсли;
		КонецЦикла;
		
	КонецЦикла;
	
	Возврат СтатусПроверки;
	
КонецФункции

Функция ВыполнитьПроверкуСтроки(Форма, ИмяРазделаИТаблицы,
			ТаблицаРаздела, ВопросыРазделаИЗначения, ПараметрыВыгрузки, НомСтр)
	
	РезультатПроверки = 0;
	
	ДанныеСтрокиТаблицы = ТаблицаРаздела[НомСтр - 1];
	СтрНомСтроки = Формат(ДанныеСтрокиТаблицы.НС, "ЧГ=");
	
	// Проверка строки раздела 1.
	Если ИмяРазделаИТаблицы[1] = "INTOUR" Тогда
		
		ЭлементыПолей = Новый Массив(1); // индексы полей начинаются с 1
		ЭлементыПолей.Добавить(ВопросыРазделаИЗначения["RowNum_INTOUR"]);
		Для НомПоля = 1 По ВопросыРазделаИЗначения.Количество() - 1 Цикл
			ЭлементыПолей.Добавить(ВопросыРазделаИЗначения[ИмяРазделаИТаблицы[1] + Строка(НомПоля)]);
		КонецЦикла;
		
		Если ЭлементыПолей[4] <> Неопределено И ЭлементыПолей[4].Результат = 0 Тогда
			Значение4 = ЭлементыПолей[4].Значение;
			Для ИндПоля = 5 По 36 Цикл
				ЭлементПоля = ЭлементыПолей[ИндПоля];
				Если ЭлементПоля <> Неопределено Тогда
					Если Значение4 < ЭлементПоля.Значение Тогда
						Описание = НСтр("ru='ОШИБКА: "
							+ "Значение должно быть меньше или равно общему количеству туристов-нерезидентов, "
							+ "принятых на территории Российской Федерации'");
						РезультатПроверки = РезультатПроверки + ?(РезультатПроверки < 2, 2, 0);
						
						ЗаписатьСообщениеОбОшибкеВСтроке(Форма, ПараметрыВыгрузки,
							ЭлементПоля, Описание, ИмяРазделаИТаблицы[0], СтрНомСтроки, НомСтр);
					КонецЕсли;
				КонецЕсли;
			КонецЦикла;
		КонецЕсли;
		
		ИндексПоляПримечание = 38;
		Если ПараметрыВыгрузки.ИмяМакетаШаблона = "ШаблонБанка2022Кв1" Тогда
			ИндексПоляПримечание = 43;
		КонецЕсли;
		
		Если (ЭлементыПолей[18] <> Неопределено И ЭлементыПолей[18].Значение <> 0)
		 ИЛИ (ЭлементыПолей[23] <> Неопределено И ЭлементыПолей[23].Значение <> 0)
		 ИЛИ (ЭлементыПолей[33] <> Неопределено И ЭлементыПолей[33].Значение <> 0) Тогда
		 Если ЭлементыПолей[ИндексПоляПримечание] <> Неопределено 
			И ПустаяСтрока(ЭлементыПолей[ИндексПоляПримечание].Значение) Тогда
				Описание = НСтр("ru = 'ОШИБКА: Поле не заполнено!';
								|en = 'ОШИБКА: Поле не заполнено!'");
				РезультатПроверки = РезультатПроверки + ?(РезультатПроверки < 2, 2, 0);
				
				ЗаписатьСообщениеОбОшибкеВСтроке(Форма, ПараметрыВыгрузки,
					ЭлементыПолей[ИндексПоляПримечание], Описание, ИмяРазделаИТаблицы[0], СтрНомСтроки, НомСтр);
			КонецЕсли;
		КонецЕсли;
		
		Если (ЭлементыПолей[18] <> Неопределено И ЭлементыПолей[18].Значение = 0)
		   И (ЭлементыПолей[23] <> Неопределено И ЭлементыПолей[23].Значение = 0)
		   И (ЭлементыПолей[33] <> Неопределено И ЭлементыПолей[33].Значение = 0) Тогда
		   Если ЭлементыПолей[ИндексПоляПримечание] <> Неопределено 
				И НЕ ПустаяСтрока(ЭлементыПолей[ИндексПоляПримечание].Значение) Тогда
				Описание = НСтр(
					"ru = 'ОШИБКА: Не соблюдено условие заполнения поля. Значения в графе 18, 23 или 33 не должны быть 0!';
					|en = 'ОШИБКА: Не соблюдено условие заполнения поля. Значения в графе 18, 23 или 33 не должны быть 0!'");
				РезультатПроверки = РезультатПроверки + ?(РезультатПроверки < 2, 2, 0);
				
				ЗаписатьСообщениеОбОшибкеВСтроке(Форма, ПараметрыВыгрузки,
					ЭлементыПолей[ИндексПоляПримечание], Описание, ИмяРазделаИТаблицы[0], СтрНомСтроки, НомСтр);
			КонецЕсли;
		КонецЕсли;
		
		// Проверка соотношения: "графа 6 + графа 7 + графа 8 + графа 9 + графа 10 = графа 4".
		Если  ЭлементыПолей[4] <> Неопределено И ЭлементыПолей[6]  <> Неопределено
			И ЭлементыПолей[7] <> Неопределено И ЭлементыПолей[8]  <> Неопределено
			И ЭлементыПолей[9] <> Неопределено И ЭлементыПолей[10] <> Неопределено Тогда
			Если  ЭлементыПолей[6].Значение  < ЭлементыПолей[4].Значение
				И ЭлементыПолей[7].Значение  < ЭлементыПолей[4].Значение
				И ЭлементыПолей[8].Значение  < ЭлементыПолей[4].Значение
				И ЭлементыПолей[9].Значение  < ЭлементыПолей[4].Значение
				И ЭлементыПолей[10].Значение < ЭлементыПолей[4].Значение Тогда
				Если  ЭлементыПолей[6].Значение  +  ЭлементыПолей[7].Значение
					+ ЭлементыПолей[8].Значение  +  ЭлементыПолей[9].Значение
					+ ЭлементыПолей[10].Значение <> ЭлементыПолей[4].Значение Тогда
					Для Инд = 6 По 10 Цикл
						Описание = СтрШаблон(
							НСтр("ru = 'ОШИБКА: Не выполняется условие: ""''%1'' + ''%2'' + ''%3'' + ''%4'' + ''%5'' = ''%6''"".';
								|en = 'ОШИБКА: Не выполняется условие: ""''%1'' + ''%2'' + ''%3'' + ''%4'' + ''%5'' = ''%6''"".'"),
								ЭлементыПолей[6].Вопрос["QUESTION_TEXT"],  ЭлементыПолей[7].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[8].Вопрос["QUESTION_TEXT"],  ЭлементыПолей[9].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[10].Вопрос["QUESTION_TEXT"], ЭлементыПолей[4].Вопрос["QUESTION_TEXT"]);
						РезультатПроверки = РезультатПроверки + ?(РезультатПроверки < 2, 2, 0);
						
						ЗаписатьСообщениеОбОшибкеВСтроке(Форма, ПараметрыВыгрузки,
							ЭлементыПолей[Инд], Описание, ИмяРазделаИТаблицы[0], СтрНомСтроки, НомСтр);
					КонецЦикла; 
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		
		// Проверка соотношения:
		// "графа 11 + графа 12 + графа 13 + графа 14 + графа 15 + графа 16 + графа 17 + граф 18 = графа 4".
		Если  ЭлементыПолей[4]  <> Неопределено
			И ЭлементыПолей[11] <> Неопределено И ЭлементыПолей[12] <> Неопределено
			И ЭлементыПолей[13] <> Неопределено И ЭлементыПолей[14] <> Неопределено
			И ЭлементыПолей[15] <> Неопределено И ЭлементыПолей[16] <> Неопределено 
			И ЭлементыПолей[17] <> Неопределено И ЭлементыПолей[18] <> Неопределено Тогда
			Если  ЭлементыПолей[11].Значение < ЭлементыПолей[4].Значение
				И ЭлементыПолей[12].Значение < ЭлементыПолей[4].Значение
				И ЭлементыПолей[13].Значение < ЭлементыПолей[4].Значение
				И ЭлементыПолей[14].Значение < ЭлементыПолей[4].Значение
				И ЭлементыПолей[15].Значение < ЭлементыПолей[4].Значение
				И ЭлементыПолей[16].Значение < ЭлементыПолей[4].Значение
				И ЭлементыПолей[17].Значение < ЭлементыПолей[4].Значение
				И ЭлементыПолей[18].Значение < ЭлементыПолей[4].Значение Тогда
				Если  ЭлементыПолей[11].Значение + ЭлементыПолей[12].Значение
					+ ЭлементыПолей[13].Значение + ЭлементыПолей[14].Значение
					+ ЭлементыПолей[15].Значение + ЭлементыПолей[16].Значение
					+ ЭлементыПолей[17].Значение + ЭлементыПолей[18].Значение <> ЭлементыПолей[4].Значение Тогда
					Для Инд = 11 По 18 Цикл
						Описание = СтрШаблон(
							НСтр("ru='ОШИБКА: Не выполняется условие: "
							+ """''%1'' + ''%2'' + ''%3'' + ''%4'' + ''%5'' + ''%6'' + ''%7'' + ''%8'' = ''%9''"".'"),
								ЭлементыПолей[11].Вопрос["QUESTION_TEXT"], ЭлементыПолей[12].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[13].Вопрос["QUESTION_TEXT"], ЭлементыПолей[14].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[15].Вопрос["QUESTION_TEXT"], ЭлементыПолей[16].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[17].Вопрос["QUESTION_TEXT"], ЭлементыПолей[18].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[4].Вопрос[ "QUESTION_TEXT"]);
						РезультатПроверки = РезультатПроверки + ?(РезультатПроверки < 2, 2, 0);
						
						ЗаписатьСообщениеОбОшибкеВСтроке(Форма, ПараметрыВыгрузки,
							ЭлементыПолей[Инд], Описание, ИмяРазделаИТаблицы[0], СтрНомСтроки, НомСтр);
					КонецЦикла; 
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		
		// Проверка соотношения: "графа 19 + графа 20 + графа 21 + графа 22 + графа 23 = графа 4".
		Если  ЭлементыПолей[4]  <> Неопределено И ЭлементыПолей[19] <> Неопределено
			И ЭлементыПолей[20] <> Неопределено И ЭлементыПолей[21] <> Неопределено
			И ЭлементыПолей[22] <> Неопределено И ЭлементыПолей[23] <> Неопределено Тогда
			Если  ЭлементыПолей[19].Значение < ЭлементыПолей[4].Значение
				И ЭлементыПолей[20].Значение < ЭлементыПолей[4].Значение
				И ЭлементыПолей[21].Значение < ЭлементыПолей[4].Значение
				И ЭлементыПолей[22].Значение < ЭлементыПолей[4].Значение
				И ЭлементыПолей[23].Значение < ЭлементыПолей[4].Значение Тогда
				Если  ЭлементыПолей[19].Значение +  ЭлементыПолей[20].Значение
					+ ЭлементыПолей[21].Значение +  ЭлементыПолей[22].Значение
					+ ЭлементыПолей[23].Значение <> ЭлементыПолей[4].Значение Тогда
					Для Инд = 19 По 23 Цикл
						Описание = СтрШаблон(
							НСтр("ru = 'ОШИБКА: Не выполняется условие: ""''%1'' + ''%2'' + ''%3'' + ''%4'' + ''%5'' = ''%6''"".';
								|en = 'ОШИБКА: Не выполняется условие: ""''%1'' + ''%2'' + ''%3'' + ''%4'' + ''%5'' = ''%6''"".'"),
								ЭлементыПолей[19].Вопрос["QUESTION_TEXT"], ЭлементыПолей[20].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[21].Вопрос["QUESTION_TEXT"], ЭлементыПолей[22].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[23].Вопрос["QUESTION_TEXT"], ЭлементыПолей[4].Вопрос["QUESTION_TEXT"]);
						РезультатПроверки = РезультатПроверки + ?(РезультатПроверки < 2, 2, 0);
						
						ЗаписатьСообщениеОбОшибкеВСтроке(Форма, ПараметрыВыгрузки,
							ЭлементыПолей[Инд], Описание, ИмяРазделаИТаблицы[0], СтрНомСтроки, НомСтр);
					КонецЦикла; 
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		
		// Проверка соотношения: "графа 24 + графа 25 + графа 26 + графа 27 + графа 28 = графа 4".
		Если  ЭлементыПолей[4]  <> Неопределено И ЭлементыПолей[24] <> Неопределено
			И ЭлементыПолей[25] <> Неопределено И ЭлементыПолей[26] <> Неопределено
			И ЭлементыПолей[27] <> Неопределено И ЭлементыПолей[28] <> Неопределено Тогда
			Если  ЭлементыПолей[24].Значение < ЭлементыПолей[4].Значение
				И ЭлементыПолей[25].Значение < ЭлементыПолей[4].Значение
				И ЭлементыПолей[26].Значение < ЭлементыПолей[4].Значение
				И ЭлементыПолей[27].Значение < ЭлементыПолей[4].Значение
				И ЭлементыПолей[28].Значение < ЭлементыПолей[4].Значение Тогда
				Если  ЭлементыПолей[24].Значение +  ЭлементыПолей[25].Значение
					+ ЭлементыПолей[26].Значение +  ЭлементыПолей[27].Значение
					+ ЭлементыПолей[28].Значение <> ЭлементыПолей[4].Значение Тогда
					Для Инд = 24 По 28 Цикл
						Описание = СтрШаблон(
							НСтр("ru = 'ОШИБКА: Не выполняется условие: ""''%1'' + ''%2'' + ''%3'' + ''%4'' + ''%5'' = ''%6''"".';
								|en = 'ОШИБКА: Не выполняется условие: ""''%1'' + ''%2'' + ''%3'' + ''%4'' + ''%5'' = ''%6''"".'"),
								ЭлементыПолей[24].Вопрос["QUESTION_TEXT"], ЭлементыПолей[25].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[26].Вопрос["QUESTION_TEXT"], ЭлементыПолей[27].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[28].Вопрос["QUESTION_TEXT"], ЭлементыПолей[4].Вопрос["QUESTION_TEXT"]);
						РезультатПроверки = РезультатПроверки + ?(РезультатПроверки < 2, 2, 0);
						
						ЗаписатьСообщениеОбОшибкеВСтроке(Форма, ПараметрыВыгрузки,
							ЭлементыПолей[Инд], Описание, ИмяРазделаИТаблицы[0], СтрНомСтроки, НомСтр);
					КонецЦикла; 
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		
		// Проверка соотношения: "графа 29 + графа 30 + графа 31 + графа 32 + графа 33 = графа 4".
		Если  ЭлементыПолей[4]  <> Неопределено И ЭлементыПолей[29] <> Неопределено
			И ЭлементыПолей[30] <> Неопределено И ЭлементыПолей[31] <> Неопределено
			И ЭлементыПолей[32] <> Неопределено И ЭлементыПолей[33] <> Неопределено Тогда
			Если  ЭлементыПолей[29].Значение < ЭлементыПолей[4].Значение
				И ЭлементыПолей[30].Значение < ЭлементыПолей[4].Значение
				И ЭлементыПолей[31].Значение < ЭлементыПолей[4].Значение
				И ЭлементыПолей[32].Значение < ЭлементыПолей[4].Значение
				И ЭлементыПолей[33].Значение < ЭлементыПолей[4].Значение Тогда
				Если  ЭлементыПолей[29].Значение +  ЭлементыПолей[30].Значение
					+ ЭлементыПолей[31].Значение +  ЭлементыПолей[32].Значение
					+ ЭлементыПолей[33].Значение <> ЭлементыПолей[4].Значение Тогда
					Для Инд = 29 По 33 Цикл
						Описание = СтрШаблон(
							НСтр("ru = 'ОШИБКА: Не выполняется условие: ""''%1'' + ''%2'' + ''%3'' + ''%4'' + ''%5'' = ''%6''"".';
								|en = 'ОШИБКА: Не выполняется условие: ""''%1'' + ''%2'' + ''%3'' + ''%4'' + ''%5'' = ''%6''"".'"),
								ЭлементыПолей[29].Вопрос["QUESTION_TEXT"], ЭлементыПолей[30].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[31].Вопрос["QUESTION_TEXT"], ЭлементыПолей[32].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[33].Вопрос["QUESTION_TEXT"], ЭлементыПолей[4].Вопрос["QUESTION_TEXT"]);
						РезультатПроверки = РезультатПроверки + ?(РезультатПроверки < 2, 2, 0);
						
						ЗаписатьСообщениеОбОшибкеВСтроке(Форма, ПараметрыВыгрузки,
							ЭлементыПолей[Инд], Описание, ИмяРазделаИТаблицы[0], СтрНомСтроки, НомСтр);
					КонецЦикла; 
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		
		// Проверка соотношения: "графа 34 + графа 35 + графа 36 = графа 4".
		Если  ЭлементыПолей[4]  <> Неопределено И ЭлементыПолей[34] <> Неопределено
			И ЭлементыПолей[35] <> Неопределено И ЭлементыПолей[36] <> Неопределено Тогда
			Если  ЭлементыПолей[34].Значение < ЭлементыПолей[4].Значение
				И ЭлементыПолей[35].Значение < ЭлементыПолей[4].Значение
				И ЭлементыПолей[36].Значение < ЭлементыПолей[4].Значение Тогда
				Если  ЭлементыПолей[34].Значение +  ЭлементыПолей[35].Значение
					+ ЭлементыПолей[36].Значение <> ЭлементыПолей[4].Значение Тогда
					Для Инд = 34 По 36 Цикл
						Описание = СтрШаблон(
							НСтр("ru = 'ОШИБКА: Не выполняется условие: ""''%1'' + ''%2'' + ''%3'' = ''%4''"".';
								|en = 'ОШИБКА: Не выполняется условие: ""''%1'' + ''%2'' + ''%3'' = ''%4''"".'"),
								ЭлементыПолей[34].Вопрос["QUESTION_TEXT"], ЭлементыПолей[35].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[36].Вопрос["QUESTION_TEXT"], ЭлементыПолей[4].Вопрос["QUESTION_TEXT"]);
						РезультатПроверки = РезультатПроверки + ?(РезультатПроверки < 2, 2, 0);
						
						ЗаписатьСообщениеОбОшибкеВСтроке(Форма, ПараметрыВыгрузки,
							ЭлементыПолей[Инд], Описание, ИмяРазделаИТаблицы[0], СтрНомСтроки, НомСтр);
					КонецЦикла; 
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		
	// Проверка строки раздела 2.
	ИначеЕсли ИмяРазделаИТаблицы[1] = "OUTTOUR" Тогда
		
		ЭлементыПолей = Новый Массив(1); // индексы полей начинаются с 1
		ЭлементыПолей.Добавить(ВопросыРазделаИЗначения["RowNum_OUTTOUR"]);
		Для НомПоля = 1 По ВопросыРазделаИЗначения.Количество() - 1 Цикл
			ЭлементыПолей.Добавить(ВопросыРазделаИЗначения[ИмяРазделаИТаблицы[1] + Строка(НомПоля)]);
		КонецЦикла;
		
		Если ЭлементыПолей[5] <> Неопределено И ЭлементыПолей[5].Результат = 0 Тогда
			Значение5 = ЭлементыПолей[5].Значение;
			Для ИндПоля = 6 По 38 Цикл
				ЭлементПоля = ЭлементыПолей[ИндПоля];
				Если ЭлементПоля <> Неопределено Тогда
					Если Значение5 < ЭлементПоля.Значение Тогда
						Описание = НСтр("ru='ОШИБКА: "
							+ "Значение должно быть меньше или равно общему количеству туристов-нерезидентов, "
							+ "принятых на территории Российской Федерации'");
						РезультатПроверки = РезультатПроверки + ?(РезультатПроверки < 2, 2, 0);
						
						ЗаписатьСообщениеОбОшибкеВСтроке(Форма, ПараметрыВыгрузки,
							ЭлементПоля, Описание, ИмяРазделаИТаблицы[0], СтрНомСтроки, НомСтр);
					КонецЕсли;
				КонецЕсли;
			КонецЦикла;
		КонецЕсли;
		
		ИндексПоляПримечание = 40;
		Если ПараметрыВыгрузки.ИмяМакетаШаблона = "ШаблонБанка2022Кв1" Тогда
			ИндексПоляПримечание = 45;
		КонецЕсли;
	
		Если (ЭлементыПолей[19] <> Неопределено И ЭлементыПолей[19].Значение <> 0)
		 ИЛИ (ЭлементыПолей[25] <> Неопределено И ЭлементыПолей[25].Значение <> 0)
		 ИЛИ (ЭлементыПолей[35] <> Неопределено И ЭлементыПолей[35].Значение <> 0) Тогда
		 Если ЭлементыПолей[ИндексПоляПримечание] <> Неопределено 
			И ПустаяСтрока(ЭлементыПолей[ИндексПоляПримечание].Значение) Тогда
				Описание = НСтр("ru = 'ОШИБКА: Поле не заполнено!';
								|en = 'ОШИБКА: Поле не заполнено!'");
				РезультатПроверки = РезультатПроверки + ?(РезультатПроверки < 2, 2, 0);
				
				ЗаписатьСообщениеОбОшибкеВСтроке(Форма, ПараметрыВыгрузки,
					ЭлементыПолей[ИндексПоляПримечание], Описание, ИмяРазделаИТаблицы[0], СтрНомСтроки, НомСтр);
			КонецЕсли;
		КонецЕсли;
		
		Если (ЭлементыПолей[19] <> Неопределено И ЭлементыПолей[19].Значение = 0)
		   И (ЭлементыПолей[25] <> Неопределено И ЭлементыПолей[25].Значение = 0)
		   И (ЭлементыПолей[35] <> Неопределено И ЭлементыПолей[35].Значение = 0) Тогда
		   Если ЭлементыПолей[ИндексПоляПримечание] <> Неопределено 
			  И НЕ ПустаяСтрока(ЭлементыПолей[ИндексПоляПримечание].Значение) Тогда
				Описание = НСтр(
					"ru = 'ОШИБКА: Не соблюдено условие заполнения поля. Значения в графе 19, 25 или 35 не должны быть 0!';
					|en = 'ОШИБКА: Не соблюдено условие заполнения поля. Значения в графе 19, 25 или 35 не должны быть 0!'");
				РезультатПроверки = РезультатПроверки + ?(РезультатПроверки < 2, 2, 0);
				
				ЗаписатьСообщениеОбОшибкеВСтроке(Форма, ПараметрыВыгрузки,
					ЭлементыПолей[ИндексПоляПримечание], Описание, ИмяРазделаИТаблицы[0], СтрНомСтроки, НомСтр);
			КонецЕсли;
		КонецЕсли;
		
		// Проверка соотношения: "графа 7 + графа 8 + графа 9 + графа 10 + графа 11 = графа 5".
		Если  ЭлементыПолей[5]  <> Неопределено И ЭлементыПолей[7]  <> Неопределено
			И ЭлементыПолей[8]  <> Неопределено И ЭлементыПолей[9]  <> Неопределено
			И ЭлементыПолей[10] <> Неопределено И ЭлементыПолей[11] <> Неопределено Тогда
			Если  ЭлементыПолей[7].Значение  < ЭлементыПолей[5].Значение
				И ЭлементыПолей[8].Значение  < ЭлементыПолей[5].Значение
				И ЭлементыПолей[9].Значение  < ЭлементыПолей[5].Значение
				И ЭлементыПолей[10].Значение < ЭлементыПолей[5].Значение
				И ЭлементыПолей[11].Значение < ЭлементыПолей[5].Значение Тогда
				Если  ЭлементыПолей[7].Значение  +  ЭлементыПолей[8].Значение
					+ ЭлементыПолей[9].Значение  +  ЭлементыПолей[10].Значение
					+ ЭлементыПолей[11].Значение <> ЭлементыПолей[5].Значение Тогда
					Для Инд = 7 По 11 Цикл
						Описание = СтрШаблон(
							НСтр("ru = 'ОШИБКА: Не выполняется условие: ""''%1'' + ''%2'' + ''%3'' + ''%4'' + ''%5'' = ''%6''"".';
								|en = 'ОШИБКА: Не выполняется условие: ""''%1'' + ''%2'' + ''%3'' + ''%4'' + ''%5'' = ''%6''"".'"),
								ЭлементыПолей[7].Вопрос["QUESTION_TEXT"],  ЭлементыПолей[8].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[9].Вопрос["QUESTION_TEXT"],  ЭлементыПолей[10].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[11].Вопрос["QUESTION_TEXT"], ЭлементыПолей[4].Вопрос["QUESTION_TEXT"]);
						РезультатПроверки = РезультатПроверки + ?(РезультатПроверки < 2, 2, 0);
						
						ЗаписатьСообщениеОбОшибкеВСтроке(Форма, ПараметрыВыгрузки,
							ЭлементыПолей[Инд], Описание, ИмяРазделаИТаблицы[0], СтрНомСтроки, НомСтр);
					КонецЦикла; 
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		
		// Проверка соотношения:
		// "графа 12 + графа 13 + графа 14 + графа 15 + графа 16 + графа 17 + графа 18 + граф 19 = графа 5".
		Если  ЭлементыПолей[5]  <> Неопределено
			И ЭлементыПолей[12] <> Неопределено И ЭлементыПолей[13] <> Неопределено
			И ЭлементыПолей[14] <> Неопределено И ЭлементыПолей[15] <> Неопределено
			И ЭлементыПолей[16] <> Неопределено И ЭлементыПолей[17] <> Неопределено 
			И ЭлементыПолей[18] <> Неопределено И ЭлементыПолей[19] <> Неопределено Тогда
			Если  ЭлементыПолей[12].Значение < ЭлементыПолей[5].Значение
				И ЭлементыПолей[13].Значение < ЭлементыПолей[5].Значение
				И ЭлементыПолей[14].Значение < ЭлементыПолей[5].Значение
				И ЭлементыПолей[15].Значение < ЭлементыПолей[5].Значение
				И ЭлементыПолей[16].Значение < ЭлементыПолей[5].Значение
				И ЭлементыПолей[17].Значение < ЭлементыПолей[5].Значение
				И ЭлементыПолей[18].Значение < ЭлементыПолей[5].Значение
				И ЭлементыПолей[19].Значение < ЭлементыПолей[5].Значение Тогда
				Если  ЭлементыПолей[12].Значение + ЭлементыПолей[13].Значение
					+ ЭлементыПолей[14].Значение + ЭлементыПолей[15].Значение
					+ ЭлементыПолей[16].Значение + ЭлементыПолей[17].Значение
					+ ЭлементыПолей[18].Значение + ЭлементыПолей[19].Значение <> ЭлементыПолей[5].Значение Тогда
					Для Инд = 12 По 19 Цикл
						Описание = СтрШаблон(
							НСтр("ru='ОШИБКА: Не выполняется условие: "
							+ """''%1'' + ''%2'' + ''%3'' + ''%4'' + ''%5'' + ''%6'' + ''%7'' + ''%8'' = ''%9''"".'"),
								ЭлементыПолей[12].Вопрос["QUESTION_TEXT"], ЭлементыПолей[13].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[14].Вопрос["QUESTION_TEXT"], ЭлементыПолей[15].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[16].Вопрос["QUESTION_TEXT"], ЭлементыПолей[17].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[18].Вопрос["QUESTION_TEXT"], ЭлементыПолей[19].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[5].Вопрос[ "QUESTION_TEXT"]);
						РезультатПроверки = РезультатПроверки + ?(РезультатПроверки < 2, 2, 0);
						
						ЗаписатьСообщениеОбОшибкеВСтроке(Форма, ПараметрыВыгрузки,
							ЭлементыПолей[Инд], Описание, ИмяРазделаИТаблицы[0], СтрНомСтроки, НомСтр);
					КонецЦикла; 
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		
		// Проверка соотношения: "графа 20 + графа 21 + графа 22 + графа 23 + графа 24 + графа 25 = графа 5".
		Если  ЭлементыПолей[5]  <> Неопределено
			И ЭлементыПолей[20] <> Неопределено И ЭлементыПолей[21] <> Неопределено
			И ЭлементыПолей[22] <> Неопределено И ЭлементыПолей[23] <> Неопределено
			И ЭлементыПолей[24] <> Неопределено И ЭлементыПолей[25] <> Неопределено Тогда
			Если  ЭлементыПолей[20].Значение < ЭлементыПолей[5].Значение
				И ЭлементыПолей[21].Значение < ЭлементыПолей[5].Значение
				И ЭлементыПолей[22].Значение < ЭлементыПолей[5].Значение
				И ЭлементыПолей[23].Значение < ЭлементыПолей[5].Значение
				И ЭлементыПолей[24].Значение < ЭлементыПолей[5].Значение
				И ЭлементыПолей[25].Значение < ЭлементыПолей[5].Значение Тогда
				Если  ЭлементыПолей[20].Значение + ЭлементыПолей[21].Значение
					+ ЭлементыПолей[22].Значение + ЭлементыПолей[23].Значение
					+ ЭлементыПолей[24].Значение + ЭлементыПолей[25].Значение <> ЭлементыПолей[5].Значение Тогда
					Для Инд = 20 По 25 Цикл
						Описание = СтрШаблон(
							НСтр("ru = 'ОШИБКА: Не выполняется условие: ""''%1'' + ''%2'' + ''%3'' + ''%4'' + ''%5'' + ''%6'' = ''%7''"".';
								|en = 'ОШИБКА: Не выполняется условие: ""''%1'' + ''%2'' + ''%3'' + ''%4'' + ''%5'' + ''%6'' = ''%7''"".'"),
								ЭлементыПолей[20].Вопрос["QUESTION_TEXT"], ЭлементыПолей[21].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[22].Вопрос["QUESTION_TEXT"], ЭлементыПолей[23].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[24].Вопрос["QUESTION_TEXT"], ЭлементыПолей[25].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[5].Вопрос["QUESTION_TEXT"]);
						РезультатПроверки = РезультатПроверки + ?(РезультатПроверки < 2, 2, 0);
						
						ЗаписатьСообщениеОбОшибкеВСтроке(Форма, ПараметрыВыгрузки,
							ЭлементыПолей[Инд], Описание, ИмяРазделаИТаблицы[0], СтрНомСтроки, НомСтр);
					КонецЦикла; 
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		
		// Проверка соотношения: "графа 26 + графа 27 + графа 28 + графа 29 + графа 30 = графа 5".
		Если  ЭлементыПолей[5]  <> Неопределено И ЭлементыПолей[26] <> Неопределено
			И ЭлементыПолей[27] <> Неопределено И ЭлементыПолей[28] <> Неопределено
			И ЭлементыПолей[29] <> Неопределено И ЭлементыПолей[30] <> Неопределено Тогда
			Если  ЭлементыПолей[26].Значение < ЭлементыПолей[5].Значение
				И ЭлементыПолей[27].Значение < ЭлементыПолей[5].Значение
				И ЭлементыПолей[28].Значение < ЭлементыПолей[5].Значение
				И ЭлементыПолей[29].Значение < ЭлементыПолей[5].Значение
				И ЭлементыПолей[30].Значение < ЭлементыПолей[5].Значение Тогда
				Если  ЭлементыПолей[26].Значение +  ЭлементыПолей[27].Значение
					+ ЭлементыПолей[28].Значение +  ЭлементыПолей[29].Значение
					+ ЭлементыПолей[30].Значение <> ЭлементыПолей[5].Значение Тогда
					Для Инд = 26 По 30 Цикл
						Описание = СтрШаблон(
							НСтр("ru = 'ОШИБКА: Не выполняется условие: ""''%1'' + ''%2'' + ''%3'' + ''%4'' + ''%5'' = ''%6''"".';
								|en = 'ОШИБКА: Не выполняется условие: ""''%1'' + ''%2'' + ''%3'' + ''%4'' + ''%5'' = ''%6''"".'"),
								ЭлементыПолей[26].Вопрос["QUESTION_TEXT"], ЭлементыПолей[27].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[28].Вопрос["QUESTION_TEXT"], ЭлементыПолей[29].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[30].Вопрос["QUESTION_TEXT"], ЭлементыПолей[5].Вопрос["QUESTION_TEXT"]);
						РезультатПроверки = РезультатПроверки + ?(РезультатПроверки < 2, 2, 0);
						
						ЗаписатьСообщениеОбОшибкеВСтроке(Форма, ПараметрыВыгрузки,
							ЭлементыПолей[Инд], Описание, ИмяРазделаИТаблицы[0], СтрНомСтроки, НомСтр);
					КонецЦикла; 
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		
		// Проверка соотношения: "графа 31 + графа 32 + графа 33 + графа 34 + графа 35 = графа 5".
		Если  ЭлементыПолей[5]  <> Неопределено И ЭлементыПолей[31] <> Неопределено
			И ЭлементыПолей[32] <> Неопределено И ЭлементыПолей[33] <> Неопределено
			И ЭлементыПолей[34] <> Неопределено И ЭлементыПолей[35] <> Неопределено Тогда
			Если  ЭлементыПолей[31].Значение < ЭлементыПолей[5].Значение
				И ЭлементыПолей[32].Значение < ЭлементыПолей[5].Значение
				И ЭлементыПолей[33].Значение < ЭлементыПолей[5].Значение
				И ЭлементыПолей[34].Значение < ЭлементыПолей[5].Значение
				И ЭлементыПолей[35].Значение < ЭлементыПолей[5].Значение Тогда
				Если  ЭлементыПолей[31].Значение +  ЭлементыПолей[32].Значение
					+ ЭлементыПолей[33].Значение +  ЭлементыПолей[34].Значение
					+ ЭлементыПолей[35].Значение <> ЭлементыПолей[5].Значение Тогда
					Для Инд = 31 По 35 Цикл
						Описание = СтрШаблон(
							НСтр("ru = 'ОШИБКА: Не выполняется условие: ""''%1'' + ''%2'' + ''%3'' + ''%4'' + ''%5'' = ''%6''"".';
								|en = 'ОШИБКА: Не выполняется условие: ""''%1'' + ''%2'' + ''%3'' + ''%4'' + ''%5'' = ''%6''"".'"),
								ЭлементыПолей[31].Вопрос["QUESTION_TEXT"], ЭлементыПолей[32].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[33].Вопрос["QUESTION_TEXT"], ЭлементыПолей[34].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[35].Вопрос["QUESTION_TEXT"], ЭлементыПолей[5].Вопрос["QUESTION_TEXT"]);
						РезультатПроверки = РезультатПроверки + ?(РезультатПроверки < 2, 2, 0);
						
						ЗаписатьСообщениеОбОшибкеВСтроке(Форма, ПараметрыВыгрузки,
							ЭлементыПолей[Инд], Описание, ИмяРазделаИТаблицы[0], СтрНомСтроки, НомСтр);
					КонецЦикла; 
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		
		// Проверка соотношения: "графа 36 + графа 37 + графа 38 = графа 5".
		Если  ЭлементыПолей[5]  <> Неопределено И ЭлементыПолей[36] <> Неопределено
			И ЭлементыПолей[37] <> Неопределено И ЭлементыПолей[38] <> Неопределено Тогда
			Если  ЭлементыПолей[36].Значение < ЭлементыПолей[5].Значение
				И ЭлементыПолей[37].Значение < ЭлементыПолей[5].Значение
				И ЭлементыПолей[38].Значение < ЭлементыПолей[5].Значение Тогда
				Если  ЭлементыПолей[36].Значение +  ЭлементыПолей[37].Значение
					+ ЭлементыПолей[38].Значение <> ЭлементыПолей[5].Значение Тогда
					Для Инд = 36 По 38 Цикл
						Описание = СтрШаблон(
							НСтр("ru = 'ОШИБКА: Не выполняется условие: ""''%1'' + ''%2'' + ''%3'' = ''%4''"".';
								|en = 'ОШИБКА: Не выполняется условие: ""''%1'' + ''%2'' + ''%3'' = ''%4''"".'"),
								ЭлементыПолей[34].Вопрос["QUESTION_TEXT"], ЭлементыПолей[35].Вопрос["QUESTION_TEXT"],
								ЭлементыПолей[36].Вопрос["QUESTION_TEXT"], ЭлементыПолей[5].Вопрос["QUESTION_TEXT"]);
						РезультатПроверки = РезультатПроверки + ?(РезультатПроверки < 2, 2, 0);
						
						ЗаписатьСообщениеОбОшибкеВСтроке(Форма, ПараметрыВыгрузки,
							ЭлементыПолей[Инд], Описание, ИмяРазделаИТаблицы[0], СтрНомСтроки, НомСтр);
					КонецЦикла; 
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
		
	КонецЕсли;
	
	Возврат РезультатПроверки;
	
КонецФункции

Процедура ВыполнитьПроверкуЗначения(РезультатПроверки, Описание,
									ВопросАнкеты,      ПараметрыВыгрузки,
									ЗначениеОтвета,    НомСтроки = 0) Экспорт
	
	Если СтрДлина(ЗначениеОтвета) = 0 Тогда
		Возврат;
	КонецЕсли;
	
	ИмяПоказателя = ВопросАнкеты["QUESTION_NAME_ID"];
	
	Если ИмяПоказателя = "Storage_place" ИЛИ ИмяПоказателя = "Child_Storage_place" Тогда
		// Для данных вопросов можно использовать значения отсутствующие в справочнике.
		ОписаниеОш = НСтр("ru = 'Указанное значение отсутствует в справочнике';
							|en = 'Указанное значение отсутствует в справочнике'");
		Если Описание = ОписаниеОш Тогда
			Описание = "";
			РезультатПроверки = 0;
		КонецЕсли;
	КонецЕсли;
	
	Если РезультатПроверки > 0 Тогда
		Возврат;
	КонецЕсли;
	
	// Проверка титульного листа.
	Если ИмяПоказателя = "Inn" Тогда
		Если НЕ РегламентированнаяОтчетностьБанкРоссии.ИННСоответствуетТребованиям(ЗначениеОтвета) Тогда
			Описание = НСтр("ru = 'Некорректный код, проверьте правильность ввода!';
							|en = 'Некорректный код, проверьте правильность ввода!'");
			РезультатПроверки = 2;
		КонецЕсли;
	ИначеЕсли ИмяПоказателя = "Okpo" Тогда
		Если НЕ РегламентированнаяОтчетностьБанкРоссии.КодПоОКПОСоответствуетТребованиям(ЗначениеОтвета) Тогда
			Описание = НСтр("ru = 'Некорректный код, проверьте правильность ввода!';
							|en = 'Некорректный код, проверьте правильность ввода!'");
			РезультатПроверки = 2;
		КонецЕсли;
	ИначеЕсли ИмяПоказателя = "Ogrn" Тогда
		Если НЕ РегламентированнаяОтчетностьБанкРоссии.ОГРНСоответствуетТребованиям(ЗначениеОтвета) Тогда
			Описание = НСтр("ru = 'Некорректный код, проверьте правильность ввода!';
							|en = 'Некорректный код, проверьте правильность ввода!'");
			РезультатПроверки = 2;
		КонецЕсли;
	ИначеЕсли ИмяПоказателя = "FIOUser" Тогда
		Если НЕ РегламентированнаяОтчетностьБанкРоссии.НетЦифрВСтроке(ЗначениеОтвета) Тогда
			Описание = НСтр("ru = 'Значение не должно содержать цифры';
							|en = 'Значение не должно содержать цифры'");
			РезультатПроверки = 1;
		КонецЕсли;
	ИначеЕсли ИмяПоказателя = "SignFIO" Тогда
		Если НЕ РегламентированнаяОтчетностьБанкРоссии.НетЦифрВСтроке(ЗначениеОтвета) Тогда
			Описание = НСтр("ru = 'Значение не должно содержать цифры';
							|en = 'Значение не должно содержать цифры'");
			РезультатПроверки = 1;
		КонецЕсли;
	ИначеЕсли ИмяПоказателя = "EmailUser" Тогда
		Если НЕ РегламентированнаяОтчетностьБанкРоссии.АдресЭлектроннойПочтыСоответствуетТребованиям(ЗначениеОтвета) Тогда
			Описание = НСтр("ru = 'Некорректный адрес эл. почты';
							|en = 'Некорректный адрес эл. почты'");
			РезультатПроверки = 1;
		КонецЕсли;
	ИначеЕсли ИмяПоказателя = "EmailRespondent" Тогда
		Если НЕ РегламентированнаяОтчетностьБанкРоссии.АдресЭлектроннойПочтыСоответствуетТребованиям(ЗначениеОтвета) Тогда
			Описание = НСтр("ru = 'Некорректный адрес эл. почты';
							|en = 'Некорректный адрес эл. почты'");
			РезультатПроверки = 1;
		КонецЕсли;
	ИначеЕсли ИмяПоказателя = "Web" Тогда
		Если НЕ РегламентированнаяОтчетностьБанкРоссии.АдресВебСервераСоответствуетТребованиям(ЗначениеОтвета) Тогда
			Описание = НСтр("ru = 'Некорректный адрес веб сайта';
							|en = 'Некорректный адрес веб сайта'");
			РезультатПроверки = 1;
		КонецЕсли;
	ИначеЕсли ИмяПоказателя = "Phone" Тогда
		Если НЕ РегламентированнаяОтчетностьБанкРоссии.НомерТелефонаСоответствуетТребованиям(ЗначениеОтвета) Тогда
			Описание = НСтр("ru = 'Недопустимые символы в номере телефона';
							|en = 'Недопустимые символы в номере телефона'");
			РезультатПроверки = 2;
		КонецЕсли;
	ИначеЕсли ИмяПоказателя = "Fax" Тогда
		Если НЕ РегламентированнаяОтчетностьБанкРоссии.НомерТелефонаСоответствуетТребованиям(ЗначениеОтвета) Тогда
			Описание = НСтр("ru = 'Недопустимые символы в номере Факса';
							|en = 'Недопустимые символы в номере Факса'");
			РезультатПроверки = 1;
		КонецЕсли;
	ИначеЕсли ИмяПоказателя = "Razdel1" Тогда
		ТаблицаРаздела1 = ПараметрыВыгрузки.МетаданныеШаблона.ТаблицыРазделов["INTOUR"];
		Если ЗначениеОтвета = "00" Тогда
			Если ТаблицаРаздела1.Количество() > 0 Тогда
				Описание = НСтр("ru = 'В разделе 1 присутствуют записи в таблице';
								|en = 'В разделе 1 присутствуют записи в таблице'");
				РезультатПроверки = 2;
			КонецЕсли;
		Иначе
			Если ТаблицаРаздела1.Количество() = 0 Тогда
				Описание = НСтр("ru = 'В разделе 1 отсутствуют записи в таблице';
								|en = 'В разделе 1 отсутствуют записи в таблице'");
				РезультатПроверки = 2;
			КонецЕсли;
		КонецЕсли;
	ИначеЕсли ИмяПоказателя = "Razdel2" Тогда
		ТаблицаРаздела2 = ПараметрыВыгрузки.МетаданныеШаблона.ТаблицыРазделов["OUTTOUR"];
		Если ЗначениеОтвета = "00" Тогда
			Если ТаблицаРаздела2.Количество() > 0 Тогда
				Описание = НСтр("ru = 'В разделе 2 присутствуют записи в таблице';
								|en = 'В разделе 2 присутствуют записи в таблице'");
				РезультатПроверки = 2;
			КонецЕсли;
		Иначе
			Если ТаблицаРаздела2.Количество() = 0 Тогда
				Описание = НСтр("ru = 'В разделе 2 отсутствуют записи в таблице';
								|en = 'В разделе 2 отсутствуют записи в таблице'");
				РезультатПроверки = 2;
			КонецЕсли;
		КонецЕсли;
	ИначеЕсли ИмяПоказателя = "Razdel3" Тогда
		ТаблицаРаздела2 = ПараметрыВыгрузки.МетаданныеШаблона.ТаблицыРазделов["NREZ"];
		Если ЗначениеОтвета = "00" Тогда
			Если ТаблицаРаздела2.Количество() > 0 Тогда
				Описание = НСтр("ru = 'В разделе 3 присутствуют записи в таблице';
								|en = 'В разделе 3 присутствуют записи в таблице'");
				РезультатПроверки = 2;
			КонецЕсли;
		Иначе
			Если ТаблицаРаздела2.Количество() = 0 Тогда
				Описание = НСтр("ru = 'В разделе 3 отсутствуют записи в таблице';
								|en = 'В разделе 3 отсутствуют записи в таблице'");
				РезультатПроверки = 2;
			КонецЕсли;
		КонецЕсли;
	ИначеЕсли ИмяПоказателя = "Razdel4" Тогда
		ТаблицаРаздела2 = ПараметрыВыгрузки.МетаданныеШаблона.ТаблицыРазделов["REZ"];
		Если ЗначениеОтвета = "00" Тогда
			Если ТаблицаРаздела2.Количество() > 0 Тогда
				Описание = НСтр("ru = 'В разделе 4 присутствуют записи в таблице';
								|en = 'В разделе 4 присутствуют записи в таблице'");
				РезультатПроверки = 2;
			КонецЕсли;
		Иначе
			Если ТаблицаРаздела2.Количество() = 0 Тогда
				Описание = НСтр("ru = 'В разделе 4 отсутствуют записи в таблице';
								|en = 'В разделе 4 отсутствуют записи в таблице'");
				РезультатПроверки = 2;
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры

Процедура ОбновитьДанныеОпросаПоПериоду(ПараметрыВыгрузки)
	
	КодПериода = "0";
	ГодПериода = "0";
	
	КодПериодичности = Число(" " + РегламентированнаяОтчетностьБанкРоссии.ЗначениеДанныхОпросаПоКлючу(
		ПараметрыВыгрузки, "PERIODTYPE"));
	
	Если КодПериодичности > 0 Тогда
		КодПериода = Строка(ПараметрыВыгрузки.ОтчетКвартал);
		ГодПериода = Формат(ПараметрыВыгрузки.ОтчетГод, "ЧГ=");
	КонецЕсли;
	
	РегламентированнаяОтчетностьБанкРоссии.ЗаписатьДанныеОпросаПоКлючу(
		ПараметрыВыгрузки, "PERIODVALUE", КодПериода);
	РегламентированнаяОтчетностьБанкРоссии.ЗаписатьДанныеОпросаПоКлючу(
		ПараметрыВыгрузки, "PERIODYEAR", ГодПериода);
	
КонецПроцедуры

Процедура ЗаписатьСообщениеОбОшибкеВСтроке(Форма, ПараметрыВыгрузки,
		ЗначенияВопроса, Описание, ИмяРаздела, СтрНомСтр, НомСтрНовТаб)
	
	РегламентированнаяОтчетностьБанкРоссии.ЗаписатьСообщениеОбОшибке(
		ЗначенияВопроса.Вопрос, ПараметрыВыгрузки, Описание, НомСтрНовТаб);
	
	МестоОшибки = "Раздел " + Прав(ИмяРаздела, 1)
		+ " [строка " + СтрНомСтр + "]: """ + ЗначенияВопроса.Вопрос["QUESTION_TEXT"] + """";
	ТекстОшибки = Описание + Символы.ПС + Символы.Таб + "<" + МестоОшибки + ">";
	РегламентированнаяОтчетность.СообщитьВТаблицуСообщений(Форма, ТекстОшибки, ИмяРаздела,
		ЗначенияВопроса.ИмяКолонки + "_" + СтрНомСтр);
	
КонецПроцедуры

#КонецОбласти

#КонецОбласти

ИнициализацияПеременныхМодуля();

#КонецЕсли