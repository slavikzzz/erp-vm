#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область СлужебныеПрограммныйИнтерфейс

Процедура ИнициализироватьОтчет() Экспорт
	
	Для Каждого НаборДанных Из СхемаКомпоновкиДанных.НаборыДанных Цикл
		
		Если ТипЗнч(НаборДанных) <> Тип("НаборДанныхОбъектМакетаКомпоновкиДанных") Тогда
			Продолжить;
		КонецЕсли;
		
		Для Каждого ПолеНабораДанных Из СхемаКомпоновкиДанных.НаборыДанных.Поля Цикл
			
			Если ТипЗнч(ПолеНабораДанных) <> Тип("ПолеНабораДанныхСхемыКомпоновкиДанных") Тогда
				Продолжить;
			КонецЕсли;
			
			Для Каждого ТипПоля Из ПолеНабораДанных.ТипЗначения.Типы() Цикл
				Если ОбщегоНазначения.ЭтоСсылка(ТипПоля) Тогда
					МетаданныеОбъекта = Метаданные.НайтиПоТипу(ТипПоля);
					Если ОбщегоНазначенияКлиентСервер.ЕстьРеквизитИлиСвойствоОбъекта(МетаданныеОбъекта, "Реквизиты") Тогда
						Для Каждого Реквизит Из МетаданныеОбъекта.Реквизиты Цикл
							НовоеПоле = СхемаКомпоновкиДанных.НаборыДанных[0].Поля.Добавить(Тип("ПолеНабораДанныхСхемыКомпоновкиДанных"));
							НовоеПоле.Поле = ПолеНабораДанных.Поле + "." + Реквизит.Имя;
							НовоеПоле.ПутьКДанным = ПолеНабораДанных.ПутьКДанным + "." + Реквизит.Имя;
							НовоеПоле.ОграничениеИспользования.Группировка = Истина;
							НовоеПоле.ОграничениеИспользования.Поле = Истина;
							НовоеПоле.ОграничениеИспользования.Порядок = Истина;
							НовоеПоле.ОграничениеИспользования.Условие = Истина;
							НовоеПоле.ОграничениеИспользованияРеквизитов.Группировка = Истина;
							НовоеПоле.ОграничениеИспользованияРеквизитов.Поле = Истина;
							НовоеПоле.ОграничениеИспользованияРеквизитов.Порядок = Истина;
							НовоеПоле.ОграничениеИспользованияРеквизитов.Условие = Истина;
						КонецЦикла;
					КонецЕсли;
				КонецЕсли;
			КонецЦикла;
		КонецЦикла;
	КонецЦикла;
	
КонецПроцедуры

#КонецОбласти

#Иначе
ВызватьИсключение НСтр("ru = 'Недопустимый вызов объекта на клиенте.';
						|en = 'Invalid object call on the client.'");
#КонецЕсли

