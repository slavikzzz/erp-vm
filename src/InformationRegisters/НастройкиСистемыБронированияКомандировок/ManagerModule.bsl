#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область СлужебныйПрограммныйИнтерфейс

Процедура ЗарегистрироватьИзмененияНастроекСистемыБронирования(СистемаБронирования, ИспользоватьОтборПоПодразделениям = Истина) Экспорт

	Если СистемаБронирования = Неопределено Тогда
		Возврат;
	КонецЕсли;
	
	НаборЗаписей = РегистрыСведений.НастройкиСистемыБронированияКомандировок.СоздатьНаборЗаписей();
	НаборЗаписей.Отбор.СистемаБронирования.Установить(СистемаБронирования);
	НаборЗаписей.Прочитать();
	
	Если НаборЗаписей.Количество() = 0 Тогда
		
		НоваяЗапись = НаборЗаписей.Добавить();
		НоваяЗапись.СистемаБронирования = СистемаБронирования;
		НоваяЗапись.ИспользоватьОтборПоПодразделениям = ИспользоватьОтборПоПодразделениям;
		
	Иначе
		
		Запись = НаборЗаписей[0];
		Запись.ИспользоватьОтборПоПодразделениям = ИспользоватьОтборПоПодразделениям;
		
	КонецЕсли;

	ОбновлениеИнформационнойБазы.ЗаписатьНаборЗаписей(НаборЗаписей);

КонецПроцедуры

Функция ИспользуетсяОтборПоПодразделениям(СистемаБронирования) Экспорт

	Если СистемаБронирования = Неопределено Тогда
		Возврат Ложь;
	КонецЕсли;

	Запись = РегистрыСведений.НастройкиСистемыБронированияКомандировок.СоздатьМенеджерЗаписи();
	Запись.СистемаБронирования = СистемаБронирования;
	Запись.Прочитать();
	Если Запись.Выбран() Тогда
		Возврат Запись.ИспользоватьОтборПоПодразделениям;
	Иначе
		Возврат Ложь;
	КонецЕсли;

КонецФункции

#КонецОбласти

#КонецЕсли