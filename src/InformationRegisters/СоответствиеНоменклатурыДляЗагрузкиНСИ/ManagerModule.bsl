
#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

// Добавляет запись в регистр соответствия объектов
// 
// Параметры:
//  ИсточникДанных - СправочникСсылка.ИсточникиЗагрузкиПроизводственнойНСИ
//  Идентификатор - Строка
//  Номенклатура - СправочникСсылка.Номенклатура
//  Характеристика - СправочникСсылка.ХарактеристикиНоменклатуры
// 
// Возвращаемое значение:
//  РегистрСведенийМенеджерЗаписи.СоответствиеОбъектовДляЗагрузкиНСИ
//
Функция ДобавитьЗапись(ИсточникДанных, Идентификатор, Номенклатура, Характеристика) Экспорт
	
	Запись = СоздатьМенеджерЗаписи();
	Запись.ИсточникДанных   = ИсточникДанных;
	Запись.Идентификатор    = Идентификатор;
	Запись.Номенклатура     = Номенклатура;
	Запись.Характеристика   = Характеристика;
	Запись.ДатаЗаписи       = ТекущаяДатаСеанса();
	
	Запись.Записать();
	
	Возврат Запись;
	
КонецФункции

// Добавляет запись в регистр соответствия номенклатуры со значениями полей из источника свойств
// 
// Параметры:
//  ИсточникДанных - СправочникСсылка.ИсточникиЗагрузкиПроизводственнойНСИ
//  ИсточникСвойств - Структура
// 
// Возвращаемое значение:
//  РегистрСведенийМенеджерЗаписи.СоответствиеОбъектовДляЗагрузкиНСИ
//  
Функция ДобавитьЗаписьПоСвойствам(ИсточникДанных, ИсточникСвойств) Экспорт
	
	Запись = СоздатьМенеджерЗаписи();
	Запись.ИсточникДанных = ИсточникДанных;
	Запись.ДатаЗаписи     = ТекущаяДатаСеанса();
	ЗаполнитьЗначенияСвойств(Запись, ИсточникСвойств);
	
	Запись.Записать();
	
	Возврат Запись;
	
КонецФункции

#КонецОбласти

#КонецЕсли
