
#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс	

// Записывает состояние калькуляции.
// Параметры:
//	Калькуляция - ДокументСсылка.ПлановаяКалькуляция2_2 - калькуляция по которой необходимо установить статус.
//	Состояние - ПеречислениеСсылка.СостоянияРасчетаПлановойКалькуляции - новое состояние.
//
Процедура УстановитьСостояние(Калькуляция, Состояние) Экспорт
	
	НаборЗаписей = РегистрыСведений.СостоянияПлановыхКалькуляций.СоздатьНаборЗаписей();
	НаборЗаписей.Отбор.Калькуляция.Установить(Калькуляция);
	
	Если ЗначениеЗаполнено(Состояние) Тогда
		
		НоваяЗапись = НаборЗаписей.Добавить();
		НоваяЗапись.Калькуляция = Калькуляция;
		НоваяЗапись.Состояние = Состояние;
		
	КонецЕсли;
	
	УстановитьПривилегированныйРежим(Истина);
	НаборЗаписей.Записать();
	УстановитьПривилегированныйРежим(Ложь);
	
КонецПроцедуры

#КонецОбласти

#КонецЕсли
