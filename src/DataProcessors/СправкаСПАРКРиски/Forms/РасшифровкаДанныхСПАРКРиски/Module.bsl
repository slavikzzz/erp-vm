///////////////////////////////////////////////////////////////////////////////////////////////////////
// Copyright (c) 2023, ООО 1С-Софт
// Все права защищены. Эта программа и сопроводительные материалы предоставляются 
// в соответствии с условиями лицензии Attribution 4.0 International (CC BY 4.0)
// Текст лицензии доступен по ссылке:
// https://creativecommons.org/licenses/by/4.0/legalcode
///////////////////////////////////////////////////////////////////////////////////////////////////////

#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Если Параметры.ВидФормы = "SPARK:WhatIsCompositeIndex" Тогда
		Элементы.ДекорацияИнформация.Заголовок = ОписаниеЧтоТакоеСводныйИндикаторРиска();
		ЭтотОбъект.Заголовок = НСтр("ru = 'Что такое сводный индикатор риска?';
									|en = 'What is summary id?'");
	ИначеЕсли Параметры.ВидФормы = "SPARK:WhatIsPaymentIndex" Тогда
		Элементы.ДекорацияИнформация.Заголовок = ОписаниеЧтоТакоеИндексПлатежнойДисциплины();
		ЭтотОбъект.Заголовок = НСтр("ru = 'Что такое Индекс платежной дисциплины?';
									|en = 'What is Payment Discipline Index?'");
	ИначеЕсли Параметры.ВидФормы = "SPARK:WhatIsFailureScore" Тогда
		Элементы.ДекорацияИнформация.Заголовок = ОписаниеЧтоТакоеИндексФинансовогоРиска();
		ЭтотОбъект.Заголовок = НСтр("ru = 'Что такое индекс финансового риска?';
									|en = 'What is financial risk index?'");
	ИначеЕсли Параметры.ВидФормы = "SPARK:WhatIsIndexOfDueDiligence" Тогда
		Элементы.ДекорацияИнформация.Заголовок = ОписаниеЧтоТакоеИндексДолжнойОсмотрительности();
		ЭтотОбъект.Заголовок = НСтр("ru = 'Что такое Индекс должной осмотрительности?';
									|en = 'What is Due Diligence Index?'");
	ИначеЕсли Параметры.ВидФормы = "SPARK:StatusDescription" Тогда
		Элементы.ДекорацияИнформация.Заголовок = ОписаниеРасшифровкаСтатуса(Параметры.Статус);
		ЭтотОбъект.Заголовок = НСтр("ru = 'Текущий статус контрагента';
									|en = 'Current counterparty status'");
	ИначеЕсли Параметры.ВидФормы = "SPARK:NoInfo" Тогда
		Элементы.ДекорацияИнформация.Заголовок = ОписаниеНетИнформации();
		ЭтотОбъект.Заголовок = НСтр("ru = 'Почему нет информации о контрагенте?';
									|en = 'Why is there no information about the counterparty?'");
	ИначеЕсли Параметры.ВидФормы = "SPARK:WhatIsAccountingStatements" Тогда
		Элементы.ДекорацияИнформация.Заголовок = ОписаниеБухгалтерскаяОтчетность();
		ЭтотОбъект.Заголовок = НСтр("ru = 'Что означает Передана бух. отчетность в СПАРК?';
									|en = 'What does Acc. reporting is transmitted to SPARK mean?'");
	Иначе
		ВызватьИсключение НСтр("ru = 'Некорректные параметры формы.';
								|en = 'Incorrect parameters of the form.'");
	КонецЕсли;
	
	КлючСохраненияПоложенияОкна = Параметры.ВидФормы;
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаСервереБезКонтекста
Функция ОписаниеЧтоТакоеСводныйИндикаторРиска()
	
	ОписаниеИндекса = НСтр("ru = 'Индикатор представляет собой оценку на основе трех аналитических';
							|en = 'ID is an assessment based on three analytical'")
		+ " " + НСтр("ru = 'показателей СПАРК: Индекса платежной дисциплины, Индекса должной осмотрительности,';
					|en = 'SPARK indicators: Payment Discipline Index, Due Diligence Index,'")
		+ " " + НСтр("ru = 'Индекса финансового риска. Особенность методологии сводного индикатора заключается в учете';
					|en = 'Financial Risk Index. Summary ID methodology takes into account'")
		+ " " + НСтр("ru = 'Статуса компании (ликвидация, банкротство и т.д.), что позволяет правильно оценить';
					|en = 'Company status (liquidation, bankruptcy, etc.) which allows you to correctly estimate'")
		+ " " + НСтр("ru = 'риск по предприятию даже при наличии положительных значений остальных индексов.';
					|en = 'the risk for the company even if other indexes have positive values.'")
		+ Символы.ПС
		+ Символы.ПС
		+ НСтр("ru = 'Для оценки риска используется следующая шкала значений:';
				|en = 'To evaluate risk, the following value scale is used:'");
	
	Возврат СтроковыеФункции.ФорматированнаяСтрока(
		НСтр("ru = '<b>Сводный индикатор</b> - является совокупной оценкой аналитических показателей СПАРК.
			|
			|" + ОписаниеИндекса + "
			|  <span style=""color: ЦветГрадацияСПАРКНизкийРиск"">Низкий риск;</span>
			|  <span style=""color: ЦветГрадацияСПАРКСреднийРиск"">Средний риск;</span>
			|  <span style=""color: ЦветГрадацияСПАРКВысокийРиск"">Высокий риск.</span>'"));
	
КонецФункции

&НаСервереБезКонтекста
Функция ОписаниеЧтоТакоеИндексПлатежнойДисциплины()
	
	ОписаниеИндекса = НСтр("ru = 'Данные о счетах, предполагаемых сроках оплаты и о фактах оплаты поступают';
							|en = 'Data about bills, estimated payment due dates and actual payments is transferred'")
		+ " " + НСтр("ru = 'в систему от компаний-участников проекта ""Мониторинг платежей"".';
					|en = 'to the system from the companies participating in the Payment Monitoring project.'")
		+ " " + НСтр("ru = 'На основе собранных данных система рассчитывает индекс по компаниям-плательщикам.';
					|en = 'The system calculates the index of payers using the collected data.'")
		+ Символы.ПС
		+ Символы.ПС
		+ НСтр("ru = 'Риск задержки оплаты счетов в зависимости от значения индекса:';
				|en = 'Risk of payment delays depending on the index value:'");
	
	Возврат СтроковыеФункции.ФорматированнаяСтрока(
		НСтр("ru = '<b>Индекс платежной дисциплины</b> - это оценка своевременности оплаты компанией счетов.
			|
			|" + ОписаниеИндекса + "
			|  <span style=""color: ЦветГрадацияСПАРКВысокийРиск"">0 - 49 -  высокий риск просрочки платежа;</span>
			|  <span style=""color: ЦветГрадацияСПАРКСреднийРиск"">50 - 79 - есть вероятность возникновения задержки оплаты;</span>
			|  <span style=""color: ЦветГрадацияСПАРКНизкийРиск"">80 - 100 - счета оплачиваются вовремя.</span>'"));
	
КонецФункции

&НаСервереБезКонтекста
Функция ОписаниеЧтоТакоеИндексФинансовогоРиска()
	
	ОписаниеИндекса = НСтр("ru = 'Для расчета индекса используются финансовые показатели из годовой бухгалтерской отчетности компаний,';
							|en = 'To calculate the index, financial indicators from the annual company accounting reporting are used'")
		+ " " + НСтр("ru = 'а также комбинированные финансовые коэффициенты компании, такие как коэффициент ликвидности, достаточности.';
					|en = 'as well as combined company financial factors such as liquidity factor, capital adequacy factor.'")
		+ " " + НСтр("ru = 'оборотных средств,  автономии и другие.';
					|en = 'capital adequacy factor, equity factor, etc.'")
		+ Символы.ПС
		+ Символы.ПС
		+ НСтр("ru = 'Риск несостоятельности в зависимости от значения индекса:';
				|en = 'Insolvency risk depending on the index values:'");
	
	Возврат СтроковыеФункции.ФорматированнаяСтрока(
		НСтр("ru = '<b>Индекс финансового риска</b> - это вероятностная оценка несостоятельности компании.
			|
			|" + ОписаниеИндекса + "
			|  <span style=""color: ЦветГрадацияСПАРКНизкийРиск"">0 - 30 - низкий риск;</span>
			|  <span style=""color: ЦветГрадацияСПАРКСреднийРиск"">31 - 70 - средний риск;</span>
			|  <span style=""color: ЦветГрадацияСПАРКВысокийРиск"">71 - 99 - высокий риск.</span>'"));
	
КонецФункции

&НаСервереБезКонтекста
Функция ОписаниеЧтоТакоеИндексДолжнойОсмотрительности()
	
	ОписаниеИндекса = НСтр("ru = 'Аналитическая модель для расчета индекса использует совокупность алгоритмов нейронной сети,';
							|en = 'Analytical model for calculating the index uses a combination of neural network algorithms'")
		+ " " + НСтр("ru = 'и логистической  регрессии и учитывает более 40 различных факторов , включая массовость адреса, директора,';
					|en = 'and logistic regression and considers over 40 different factors including address mass character, CEO,'")
		+ " " + НСтр("ru = 'наличие исполнительных производств, арбитражных дел и многие другие.';
					|en = 'execution, arbitration cases, etc.'")
		+ Символы.ПС
		+ Символы.ПС
		+ НСтр("ru = 'Для оценки риска используется следующая шкала значений:';
				|en = 'To evaluate risk, the following value scale is used:'");
	
	Возврат СтроковыеФункции.ФорматированнаяСтрока(
		НСтр("ru = '<b>Индекс должной осмотрительности</b> - это вероятностная оценка, показывающая, что компания может являться однодневкой.
			|
			|" + ОписаниеИндекса + "
			|  <span style=""color: ЦветГрадацияСПАРКНизкийРиск"">0 - 40 - низкий риск;</span>
			|  <span style=""color: ЦветГрадацияСПАРКСреднийРиск"">41 - 71 - средний риск;</span>
			|  <span style=""color: ЦветГрадацияСПАРКВысокийРиск"">72 - 100 - высокий риск.</span>'"));
	
КонецФункции

&НаСервереБезКонтекста
Функция ОписаниеРасшифровкаСтатуса(Статус)
	
	ЗначениеРеквизитов = ОбщегоНазначения.ЗначенияРеквизитовОбъекта(
			Статус,
			"Название, Описание");
	
	Возврат СтроковыеФункции.ФорматированнаяСтрока(
		СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
			НСтр("ru = '<b>%1</b> - %2.
				|
				|<a href = ""%3"">Подробнее о сервисе</a>';
				|en = '<b>%1</b> - %2.
				|
				|<a href = ""%3"">Learn more about the service</a>'"),
			ЗначениеРеквизитов.Название,
			ЗначениеРеквизитов.Описание,
			СПАРКРискиКлиентСервер.АдресСтраницыОписанияСервисаСПАРКРиски()));
	
КонецФункции

&НаСервереБезКонтекста
Функция ОписаниеНетИнформации()
	
	Возврат СтроковыеФункции.ФорматированнаяСтрока(
			СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
				НСтр("ru = 'Получение справок, индексов и событий мониторинга возможно не по всем типам организаций. 
					|
					|1. Индекс должной осмотрительности (ИДО)  не рассчитывается для следующих типов организаций:
					|     ● Бюджетные учреждения
					|     ● Общественные и религиозные организации: приходы храмов, СОРОО, МОНОО
					|     ● Автономные некоммерческие организации
					|     ● Товарищества собственников жилья
					|     ● Садоводческие, огороднические или дачные некоммерческие товарищества
					|     ● Некоммерческие партнерства: НП, ДНП, СРО
					|     ● Прочие некоммерческие организации: казачьи общества, коллегии адвокатов
					|     ● Экстерриториальные организации
					|     ● Органы общественной самодеятельности
					|     ● Общественные движения
					|     ● Ассоциации и союзы
					|     ● Унитарные предприятия
					|2. Индекс финансового риска (ИФР) и Индекс платежной дисциплины (ИПД) рассчитываются для любых юр. лиц, если есть необходимые исходные данные. Т.к. у банков и страховых компаний свой формат отчетности, Индекс финансового риска (ИФР)  по ним не считается. Также Индекс финансового риска (ИФР) отсутствует для НКО.
					|3. Введен некорректный ИНН.
					|
					|<a href = ""%1"">Подробнее о сервисе</a>';
					|en = 'You can receive information sheets, indexes and monitoring events not by all company types. 
					|
					|1. Due Diligence Index (DDI) is not calculated for the following company types:
					|     ● Budgetary institutions
					|     ● Non-governmental and religious organizations: parishes, SOROO, MONOO
					|     ● Autonomous non-profit organizations
					|     ● Homeowner associations
					|     ● Horticultural, market-gardening or dacha non-commercial associations
					|     ● Non-profit partnerships: NP, DNP, SRO
					|     ● Other non-commercial organizations: Cossack organizations and bar associations
					|     ● Extraterritorial companies
					|     ● Community associations
					|     ● Social movements
					|     ● Associations and unions
					|     ● Unitary enterprises
					|2. Financial Risk Index (FRI) and Payment Discipline Index (PDI) can be calculated for any business entity if there is necessary source data. Since banks and insurance companies have their own reporting format, you cannot calculate Financial Risk Index (FRI) for them. There is no Financial Risk Index (FRI) for NBFI as well.
					|3. TIN is invalid.
					|
					|<a href = ""%1"">More about the service</a>'"),
				СПАРКРискиКлиентСервер.АдресСтраницыОписанияСервисаСПАРКРиски()));
	
КонецФункции

&НаСервереБезКонтекста
Функция ОписаниеБухгалтерскаяОтчетность()
	
	Возврат СтроковыеФункции.ФорматированнаяСтрока(
		НСтр("ru = '<b>Бухгалтерская отчетность</b> компании в СПАРК увеличивает точность"
		+ " оценки компании в системе, повышает шанс на одобрение кредита банком и снижение процентной ставки."
		+ Символы.ПС
		+ Символы.ПС
		+ "Компания публикует свою бухгалтерскую отчетность в крупнейшей информационной системе СПАРК,"
		+ " источнике информации для сервиса 1СПАРК Риски."
		+ " Компании, которые делятся своими данными из 1С, получают отметку об этом в признаках хозяйственной"
		+ " деятельности в системе СПАРК и бизнес-справке 1СПАРК Риски. По оценке Deloitte, 74,5% крупных"
		+ " и средних российских компаний используют СПАРК для проверки партнеров и заемщиков.'"));
	
КонецФункции

#КонецОбласти