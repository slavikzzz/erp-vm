#Область ОбработчикиСобытий

&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	
	ОкноОткрыто = Ложь;
	Если ТипЗнч(ПараметрыВыполненияКоманды.Источник) = Тип("ОкноКлиентскогоПриложения") Тогда
		Уникальность = "ДлительнаяОперацияЕдиныйНалоговыйСчетЛичныйКабинет";
	Иначе
		Для Каждого ОткрытоеОкно Из ПараметрыВыполненияКоманды.Окно.Содержимое Цикл
			Если СтрНайти(ОткрытоеОкно.ИмяФормы, "Обработка.ЕдиныйНалоговыйСчетЛичныйКабинет") <> 0 Тогда
				ОкноОткрыто = Истина;
				Прервать;
			КонецЕсли;
		КонецЦикла;
		Уникальность = ПараметрыВыполненияКоманды.Уникальность;
	КонецЕсли;
	Если ОкноОткрыто Тогда
		ПараметрыФормы = Новый Структура;
		ПараметрыФормы.Вставить("Организация", ОсновнаяОрганизация());
		ОткрытьФорму("Обработка.ЕдиныйНалоговыйСчетЛичныйКабинет.Форма.Форма",
			ПараметрыФормы,
			ПараметрыВыполненияКоманды.Источник,
			Уникальность,
			ПараметрыВыполненияКоманды.Окно);
	Иначе
		ОткрытьФорму("Обработка.ЕдиныйНалоговыйСчетЛичныйКабинет.Форма.ФормаДлительнаяОперация",
			Новый Структура("РабочийРежим,ИмяФормы,", Истина, "Форма"),
			ПараметрыВыполненияКоманды.Источник,
			Уникальность,
			ПараметрыВыполненияКоманды.Окно);
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаСервере
Функция ОсновнаяОрганизация()
	
	Возврат ЕдиныйНалоговыйСчетЛичныйКабинет.ОсновнаяОрганизация();
	
КонецФункции

#КонецОбласти
