
Функция ДатаИстеченияЛицензииКриптоПро() Экспорт
	
	CPCSPLicense = Неопределено;
	#Если НЕ МобильныйКлиент Тогда
		Попытка
			CPCSPLicense = Новый COMОбъект("CPCSPLicense.CPCSPLicense");
		Исключение
			Возврат Неопределено;
		КонецПопытки;
	#КонецЕсли
	
	Если CPCSPLicense = Неопределено Тогда
		Возврат Неопределено;
	КонецЕсли;
	
	Попытка
		
		ДатаИстеченияЛицензии = CPCSPLicense.GetExpireDate("{54A08450-B343-40B0-924E-68F031450996}");//3.6
		
	Исключение
		
		Попытка
			
			ДатаИстеченияЛицензии = CPCSPLicense.GetExpireDate("{39D25A86-A5E6-42FC-9C8F-EFA4C138B08C}");//3.9
			
		Исключение
			
			Попытка
				
				ДатаИстеченияЛицензии = CPCSPLicense.GetExpireDate("{407E5BA7-6406-40BF-A4DC-3654B8F584C1}");//4.0
				
			Исключение
				
				Попытка
					
					ДатаИстеченияЛицензии = CPCSPLicense.GetExpireDate("{50F91F80-D397-437C-B0C8-62128DE3B55E}");//5.0
					
				Исключение
				
				КонецПопытки;
				
			КонецПопытки;
			
		КонецПопытки;
	
	КонецПопытки;
	
	Возврат ДатаИстеченияЛицензии;
	
КонецФункции
