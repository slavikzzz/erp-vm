////////////////////////////////////////////////////////////////////////////////
// Подсистема "Документооборот с Министерством обороны России".
// 
////////////////////////////////////////////////////////////////////////////////

#Область ПрограммныйИнтерфейс

Функция ПолучитьНастройки(Организация) Экспорт
	
	Возврат ДокументооборотСМинобороны.ПолучитьНастройки(Организация);
	
КонецФункции

Функция СохранитьНастройки(Организация, Сертификат, Доверенность) Экспорт
	
	Возврат ДокументооборотСМинобороны.СохранитьНастройки(Организация, Сертификат, Доверенность);
	
КонецФункции

Функция СформироватьАрхивПакета(ПараметрыАрхивации) Экспорт 
	
	Возврат ДокументооборотСМинобороны.СформироватьАрхивПакета(ПараметрыАрхивации);
	
КонецФункции

Функция ТекущаяДатаНаСервере() Экспорт
	
	Возврат ДокументооборотСМинобороны.ТекущаяДатаНаСервере();
	
КонецФункции

Функция СтрокаОтпечаткаВДвоичныеДанные(Строка) Экспорт
	
	Возврат ДокументооборотСМинобороны.СтрокаОтпечаткаВДвоичныеДанные(Строка);
	
КонецФункции

Функция СохранитьПакет(Параметры) Экспорт
	
	Возврат ДокументооборотСМинобороны.СохранитьПакет(Параметры);
	
КонецФункции

Функция СохранитьОтвет(Параметры) Экспорт
	
	Возврат ДокументооборотСМинобороны.СохранитьОтвет(Параметры);
	
КонецФункции
 
Функция ПрочитатьАрхивОтвета(Адрес) Экспорт
	
	Возврат ДокументооборотСМинобороны.ПрочитатьАрхивОтвета(Адрес);
	
КонецФункции

Функция ПолучитьПоследнююОтправкуОтчета(ОтчетСсылка) Экспорт
	
	Возврат ДокументооборотСМинобороны.ПолучитьПоследнююОтправкуОтчета(ОтчетСсылка);
	
КонецФункции

Функция ПолучитьНеЗавершенныеОтправки(Организация) Экспорт
	
	Возврат ДокументооборотСМинобороны.ПолучитьНеЗавершенныеОтправки(Организация);
	
КонецФункции

Функция ТекущееСостояниеОтправки(Знач Ссылка, Знач ДополнительныеПараметры) Экспорт
	
	КонтекстЭДОСервер = ДокументооборотСКО.ПолучитьОбработкуЭДО();
	Возврат КонтекстЭДОСервер.ТекущееСостояниеОтправки(Ссылка, "Минобороны", ДополнительныеПараметры);
	
КонецФункции

Функция ПолучитьАдресДереваПротоколаСдачи(ИсточникСсылка) Экспорт
	
	Возврат ДокументооборотСМинобороны.ПолучитьАдресДереваПротоколаСдачи(ИсточникСсылка);
	
КонецФункции

Функция ПолучитьРеквизитыПоСсылке(Ссылка, Реквизиты) Экспорт
	
	Возврат ОбщегоНазначения.ЗначенияРеквизитовОбъекта(Ссылка, Реквизиты);
	
КонецФункции

Процедура ЗаписьОбъектовРегламентированнойОтчетности(ОтчетСсылка, Отказ) Экспорт
	
	РегламентированнаяОтчетность.ЗаписьОбъектовРегламентированнойОтчетности(ОтчетСсылка, Отказ);
	
КонецПроцедуры

Функция СохранитьСтатусОтправки(Отправка, Статус) Экспорт
	
	Возврат ДокументооборотСМинобороны.СохранитьСтатусОтправки(Отправка, Статус);
	
КонецФункции

Функция УстановитьНовыйСтатус(Отчет, Статус) Экспорт
	
	Возврат ДокументооборотСМинобороны.УстановитьНовыйСтатус(Отчет, Статус);
	
КонецФункции

Функция СтатусУстановленВручную(Отправка, Знач СтатусИзЖурнала) Экспорт
	
	Возврат ДокументооборотСМинобороны.СтатусУстановленВручную(Отправка, СтатусИзЖурнала);
	
КонецФункции

Функция ПроверитьВозможностьВыполненияОперации(ПараметрыАутентификации) Экспорт
	
	Возврат ДокументооборотСМинобороны.ПроверитьВозможностьВыполненияОперации(ПараметрыАутентификации);
	
КонецФункции

Функция ЗагрузитьСертификатыМинобороны() Экспорт
	
	Возврат ДокументооборотСМинобороны.ЗагрузитьСертификатыМинобороны();
	
конецФункции

Процедура ЗаписатьВЖурналРегистрации(ТекстОшибки) Экспорт
	
	ДокументооборотСМинобороны.ЗаписатьВЖурналРегистрации(УровеньЖурналаРегистрации.Ошибка, ТекстОшибки);
	
КонецПроцедуры

Функция ПолучитьКоличествоОтправокМинобороныНаДату(Организация, Дата) Экспорт
	
	Возврат ДокументооборотСМинобороны.ПолучитьКоличествоОтправокМинобороныНаДату(Организация, Дата);
	
КонецФункции

Функция СтатусОтчетаУстановленВручную(СсылкаНаОтчет, Статус) Экспорт
	
	Возврат ДокументооборотСМинобороны.СтатусОтчетаУстановленВручную(СсылкаНаОтчет, Статус);
	
КонецФункции

Функция ДоступныеСправочникиМЧД(Подсистема = "", ФорматСписка = "Тип") Экспорт
	
	ПоддерживаемыеСправочники = Новый Массив;
	
	// Формируем список справочников, которые могут использоваться при обмене с банками.
	ВозможныеСправочники = Новый Структура;
	
	СправочникиПодсистемы = Новый Массив;
	СправочникиПодсистемы.Добавить("МашиночитаемыеДоверенности");
	ВозможныеСправочники.Вставить("СтандартныеПодсистемы", СправочникиПодсистемы);
	
	ЕстьПоддержкаДоверенностейФНС = Истина;
	Если ЕстьПоддержкаДоверенностейФНС Тогда
		СправочникиПодсистемы = Новый Массив;
		СправочникиПодсистемы.Добавить("МашиночитаемыеДоверенностиРаспределенныйРеестр");
		СправочникиПодсистемы.Добавить("МашиночитаемыеДоверенностиФНС");
		ВозможныеСправочники.Вставить("РегламентированнаяОтчетность", СправочникиПодсистемы);
	КонецЕсли;
	
	// Проверяем, используются ли справочники в текущей конфигурации.
	СуществующиеСправочники = Метаданные.Справочники;
	
	Для Каждого ПодсистемаСправочников Из ВозможныеСправочники Цикл
		
		Если Не ПустаяСтрока(Подсистема) И Подсистема <> ПодсистемаСправочников.Ключ Тогда
			Продолжить;
		КонецЕсли;
		
		Для Каждого ИмяСправочника Из ПодсистемаСправочников.Значение Цикл
			
			СуществующийСправочник = СуществующиеСправочники.Найти(ИмяСправочника);
			Если СуществующийСправочник <> Неопределено
			   И ПравоДоступа("Просмотр", СуществующийСправочник) Тогда
			   
				УказаниеНаСправочник = ?(ФорматСписка = "Тип", Тип("СправочникСсылка." + ИмяСправочника), ИмяСправочника);
				ПоддерживаемыеСправочники.Добавить(УказаниеНаСправочник);
				
			КонецЕсли;
			
		КонецЦикла;
		
	КонецЦикла;
	
	Возврат ПоддерживаемыеСправочники;
	
КонецФункции

#КонецОбласти