
#Область СлужебныйПрограммныйИнтерфейс

#Область ДеревоСпецификаций

// Возвращает структуру - информацию об остатках товара
//
// Параметры:
//  ДанныеОНоменклатуре - Структура - информация о номенклатуре и характеристике:
//  * Номенклатура	 	- СправочникСсылка.Номенклатура	- номенклатура,
//  * Характеристика	- СправочникСсылка.ХарактеристикиНоменклатуры - характеристика номенклатуры
// 
// Возвращаемое значение:
//  см. ПодборТоваровВызовСервера.ЦенаПродажиИОстаткиТовара
//
Функция СтруктураЗаполненияОстаткиТоваров(ДанныеОНоменклатуре) Экспорт
	
	МассивСкладов = Новый Массив;
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	Склады.Ссылка КАК Склад
		|ИЗ
		|	Справочник.Склады КАК Склады
		|ГДЕ
		|	НЕ Склады.ЭтоГруппа";
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Выборка = РезультатЗапроса.Выбрать();
	
	Пока Выборка.Следующий() Цикл
		МассивСкладов.Добавить(Выборка.Склад);
	КонецЦикла;
	
	СтруктураЗаполнения = ПодборТоваровВызовСервера.ЦенаПродажиИОстаткиТовара(
		ДанныеОНоменклатуре.Номенклатура,
		ДанныеОНоменклатуре.Характеристика,
		Справочники.СоглашенияСКлиентами.ПустаяСсылка(),
		Справочники.Валюты.ПустаяСсылка(),
		МассивСкладов,
		Справочники.ВидыЦен.ПустаяСсылка());
	
	Возврат СтруктураЗаполнения;
	
КонецФункции

#КонецОбласти

#КонецОбласти