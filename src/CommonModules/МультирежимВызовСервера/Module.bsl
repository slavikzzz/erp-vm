#Область ПрограммныйИнтерфейс

Функция ЕстьПравоНаОтправкуОбъекта(СсылкаНаОбъект) Экспорт
	
	Возврат Мультирежим.ЕстьПравоНаОтправкуОбъекта(СсылкаНаОбъект);

КонецФункции

Функция ЕстьПравоНаОрган(УчетнаяЗапись, Направление) Экспорт
	
	Возврат Мультирежим.ЕстьПравоНаОрган(УчетнаяЗапись, Направление);

КонецФункции

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

Функция СНИЛСФизЛица(ФизическоеЛицо, Организация = Неопределено) Экспорт
	
	ДанныеВладельца = ЭлектронныйДокументооборотСКонтролирующимиОрганамиВызовСервераПереопределяемый.ПолучитьДанныеИсполнителя(
		ФизическоеЛицо, Организация);
		
	Если ДанныеВладельца = Неопределено Тогда
		СНИЛС = "";
	Иначе
		СНИЛС = ДанныеВладельца.СНИЛС;
	КонецЕсли;
	
	Возврат СНИЛС;
	
КонецФункции

Функция ДанныеПриглашенияПользователяИзРегистра(Пользователь) Экспорт
	
	УстановитьПривилегированныйРежим(Истина);
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	*
		|ИЗ
		|	РегистрСведений.ПриглашенияПользователей1СОтчетности КАК ПриглашенияПользователей1СОтчетности
		|ГДЕ
		|	ПриглашенияПользователей1СОтчетности.Пользователь = &Пользователь
		|	И ПриглашенияПользователей1СОтчетности.Дата > &МесяцНазад
		|	И НЕ ПриглашенияПользователей1СОтчетности.УчетнаяЗапись.ПометкаУдаления";
	
	Запрос.УстановитьПараметр("Пользователь", Пользователь);
	Запрос.УстановитьПараметр("МесяцНазад", ТекущаяДатаСеанса() - 30 * 24 * 60 * 60);
	
	РезультатЗапроса = Запрос.Выполнить().Выгрузить();
	
	Результат = Новый Массив;
	Для каждого Строка Из РезультатЗапроса Цикл
	
		Результат.Добавить(ОбщегоНазначения.СтрокаТаблицыЗначенийВСтруктуру(Строка));
	
	КонецЦикла;
	
	Возврат Результат;
	
КонецФункции

Функция ПользовательПоФизЛицуИзСправочникаПользователи(ФизическоеЛицо) Экспорт
	
	Возврат Мультирежим.ПользовательПоФизЛицуИзСправочникаПользователи(ФизическоеЛицо);
	
КонецФункции

Функция ФизЛицоПоПользователюИзСправочникаПользователи(Пользователь = Неопределено, ВызыватьИсключение = Ложь, ЭтоВладелецЭЦП = Ложь) Экспорт
	
	Возврат Мультирежим.ФизЛицоПоПользователюИзСправочникаПользователи(Пользователь, ВызыватьИсключение, ЭтоВладелецЭЦП);
	
КонецФункции

Функция СертификатПользователя(УчетнаяЗапись, Знач Пользователь = Неопределено) Экспорт
	
	Возврат Мультирежим.СертификатПользователя(УчетнаяЗапись, Пользователь);
	
КонецФункции

Функция ПраваНаУчетнуюЗапись(УчетнаяЗапись, Знач Сотрудник = Неопределено) Экспорт
	
	Возврат Мультирежим.ПраваНаУчетнуюЗапись(УчетнаяЗапись, Сотрудник);

КонецФункции

Функция ОбменПоУчетнойЗаписиРазрешен(УчетнаяЗапись, Знач Сотрудник = Неопределено) Экспорт
	
	УстановитьПривилегированныйРежим(Истина);
	
	Если НЕ Мультирежим.ЭтоМультиРежим(УчетнаяЗапись) Тогда
		Возврат Истина;
	КонецЕсли;
	
	Если Сотрудник = Неопределено Тогда
		Сотрудник = Пользователи.ТекущийПользователь();
	КонецЕсли;
	
	Сертификат = Мультирежим.СертификатПользователя(УчетнаяЗапись, "Отпечаток", Сотрудник);
	Если НЕ Сертификат.Найден Тогда
		Возврат Ложь;
	КонецЕсли;
	
	Права = Мультирежим.ПраваНаУчетнуюЗапись(УчетнаяЗапись, Сотрудник);
	ОбменРазрешен = 
		Права.СдаватьВФНС 
		ИЛИ Права.СдаватьВРосстат 
		ИЛИ Права.СдаватьВПФР 
		ИЛИ Права.СдаватьВЦБ;
	
	Возврат ОбменРазрешен;
	
КонецФункции

Функция ЕстьПравоНаТранспортноеСообщение(Сообщение, ВыводитьСообщения = Истина) Экспорт
	
	Возврат Мультирежим.ЕстьПравоНаТранспортноеСообщение(Сообщение, ВыводитьСообщения);
	
КонецФункции

Функция ЭтоМультиРежимПоОрганизации(Организация) Экспорт
	
	Возврат Мультирежим.ЭтоМультиРежимПоОрганизации(Организация);

КонецФункции

Функция ЭтоМультиРежимПоИдентификаторуАбонента(ИдентификаторАбонента) Экспорт
	
	Возврат Мультирежим.ЭтоМультиРежимПоИдентификаторуАбонента(ИдентификаторАбонента);

КонецФункции

Функция ПользовательПодключенК1СОтчетности(Организация, Пользователь = Неопределено) Экспорт
	
	Возврат Мультирежим.ПользовательПодключенК1СОтчетности(Организация, Пользователь);
		
КонецФункции

Функция ЭтоПотенциальныйПользователь(Организация, Знач Сотрудник = Неопределено) Экспорт
	
	Возврат Мультирежим.ЭтоПотенциальныйПользователь(Организация, Сотрудник);
	
КонецФункции

Функция ФизЛицоПоФИОиСНИЛС(Фамилия, Имя, Отчество, СНИЛС) Экспорт
	
	Возврат Мультирежим.ФизЛицоПоФИОиСНИЛС(Фамилия, Имя, Отчество, СНИЛС);
	
КонецФункции

#КонецОбласти