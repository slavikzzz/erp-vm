////////////////////////////////////////////////////////////////////////////////
//
// Серверные процедуры и функции регламентированных отчетов общего назначения 
// с кешируемым результатом на время сеанса.
//  
////////////////////////////////////////////////////////////////////////////////

#Область СлужебныеПроцедурыИФункции

Функция РеквизитыКонтрагента(Знач ИНН) Экспорт
	
	Возврат ОбработкаЗаявленийАбонента.РеквизитыКонтрагента(ИНН);
	
КонецФункции

Функция РеквизитыКонтрагентаДляПроверки(Знач ИНН) Экспорт
	
	Если НЕ ОбщегоНазначения.ПодсистемаСуществует("ИнтернетПоддержкаПользователей.РаботаСКонтрагентами") Тогда
		Возврат Неопределено;
	КонецЕсли;
	
	Модуль = ОбщегоНазначения.ОбщийМодуль("РаботаСКонтрагентами");
	
	ЭтоЮЛ = СтрДлина(ИНН) = 10;
	Если ЭтоЮЛ Тогда
		РеквизитыКонтрагента = Модуль.ДанныеЮридическогоЛицаДляЗаполненияСертификата(ИНН).ЕГРЮЛ;
	Иначе
		РеквизитыКонтрагента = Модуль.ДанныеПредпринимателяДляЗаполненияСертификата(ИНН);
	КонецЕсли;
	
	Если РеквизитыКонтрагента = Неопределено 
		ИЛИ ЗначениеЗаполнено(РеквизитыКонтрагента.ОписаниеОшибки) Тогда
		Возврат Неопределено;
	КонецЕсли;
	
	Возврат РеквизитыКонтрагента;
	
КонецФункции

Функция НазваниеРегионаПоКоду(КодРегиона) Экспорт
	
	Название = РегламентированнаяОтчетностьВызовСервера.ПолучитьНазваниеРегионаПоКоду(КодРегиона);
	
	Если Не ЗначениеЗаполнено(Название) Тогда
		// затем пробуем найти в таблице регионов
		МакетРегионы = Обработки.ОбщиеОбъектыРеглОтчетности.ПолучитьМакет("Регионы");
		нрегАдресРегион = нрег(Название);
		Для Индекс = 1 По МакетРегионы.ВысотаТаблицы Цикл
			ТекущийКодРегиона = СокрЛП(МакетРегионы.Область(Индекс, 2, Индекс, 2).Текст);
			Если ТекущийКодРегиона = КодРегиона Тогда
				Название = СокрЛП(МакетРегионы.Область(Индекс, 1, Индекс, 1).Текст);
				Прервать;
			КонецЕсли;
		КонецЦикла;
	КонецЕсли;
	
	Возврат Название;
	
КонецФункции

Функция КодИНазваниеРегионаДляСертификата(КодРегиона) Экспорт
	
	Возврат ОбработкаЗаявленийАбонента.КодИНазваниеРегионаДляСертификата(КодРегиона);
	
КонецФункции

#КонецОбласти