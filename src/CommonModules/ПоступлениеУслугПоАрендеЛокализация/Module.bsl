////////////////////////////////////////////////////////////////////////////////
// Процедуры, используемые для локализации документа "Заключение договора аренды".
// 
////////////////////////////////////////////////////////////////////////////////

#Область СлужебныеПроцедурыИФункции

#Область ПроводкиРегУчета

Функция ТекстОтраженияВРеглУчете() Экспорт

	ТекстЗапроса = "";
	
	//++ Локализация

	СписокЗапросов = Новый Массив;	
	
	ВнеоборотныеАктивыЛокализация.ТекстОтраженияВРеглУчетеУслугПоАренде(СписокЗапросов);
	
	// Общие фрагменты проводок по включению в стоимость НДС
	СписокЗапросов.Добавить(РеглУчетВыборкиСерверПовтИсп.ТекстВключениеНДСпоПриобретеннымЦенностям());
	
	#Область ОбеспечительныйПлатежПриУчетеЗаБалансомБезНДС // (Дт <76.07.2> :: Кт <76.07.3>)
	ТекстЗапроса =
	"ВЫБРАТЬ // Зачет обеспечительного платежа (имущество за балансом) (Дт <76.07.2> :: Кт <76.07.3>)
	|
	|	Строки.Регистратор КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.АналитикаУчетаПоПартнерам.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Строки.СуммаРегл КАК Сумма,
	|	Строки.СуммаУпр КАК СуммаУУ,
	|	
	|	// Дт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.УслугаПоАренде) КАК ВидСчетаДт,
	|	ВЫРАЗИТЬ(Строки.Договор КАК Справочник.ДоговорыАренды).ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|	
	|	Строки.Валюта КАК ВалютаДт,
	|	ВЫРАЗИТЬ(Строки.Договор КАК Справочник.ДоговорыАренды).Подразделение КАК ПодразделениеДт,
	|	ВЫРАЗИТЬ(Строки.Договор КАК Справочник.ДоговорыАренды).НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	Строки.АналитикаУчетаПоПартнерам.Контрагент КАК СубконтоДт1,
	|	Строки.Договор КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	Строки.Сумма КАК ВалютнаяСуммаДт,
	|
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	// Кт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ОбеспечительныйПлатеж) КАК ВидСчетаКт,
	|	ВЫРАЗИТЬ(Строки.Договор КАК Справочник.ДоговорыАренды).ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	Строки.Валюта КАК ВалютаКт,
	|	ВЫРАЗИТЬ(Строки.Договор КАК Справочник.ДоговорыАренды).Подразделение КАК ПодразделениеКт,
	|	ВЫРАЗИТЬ(Строки.Договор КАК Справочник.ДоговорыАренды).НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	Строки.АналитикаУчетаПоПартнерам.Контрагент КАК СубконтоКт1,
	|	Строки.Договор КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	Строки.Сумма КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Зачет обеспечительного платежа (имущество за балансом)"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.РасчетыПоФинансовымИнструментам КАК Строки
	|	ПО Строки.Регистратор = ДокументыКОтражению.Ссылка
	|		И Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|ГДЕ
	|	Строки.НастройкаХозяйственнойОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ОбеспечительныйПлатежПриУчетеЗаБалансом)";
	СписокЗапросов.Добавить(ТекстЗапроса);
	#КонецОбласти

	#Область ТекстПрочееПоступление // (Дт <ХХ.ХХ> :: Кт <76.2, 76.4>)
	// Поддержка статей расходов с устаревшим направлением распределения "НаПрочиеАктивы".
	ТекстЗапроса =
	"ВЫБРАТЬ // Поступление по аренде на прочие активы (имущество за балансом) (Дт <ХХ.ХХ> :: Кт <76.2, 76.4> )
	|
	|	СтрокиДт.Регистратор КАК Ссылка,
	|	СтрокиДт.Период КАК Период,
	|	СтрокиДт.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	СтрокиДт.СуммаРегл КАК Сумма,
	|	СтрокиДт.СуммаУпр КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеОперации) КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	СтрокиДт.Подразделение КАК ПодразделениеДт,
	|	СтрокиДт.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	// Кт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ВЫБОР СтрокиКт.ТипСуммы
	|		КОГДА ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.УслугаПоАренде) ТОГДА
	|			ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.УслугаПоАренде)
	|		КОГДА ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.УслугаПоАрендеАванс) ТОГДА
	|			ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.УслугаПоАренде)
	|		КОГДА ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.ОбеспечительныйПлатеж) ТОГДА
	|			ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.УслугаПоАренде)
	|		КОГДА ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.ВыкупнаяСтоимость) ТОГДА
	|			ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ВыкупнаяСтоимость)
	|	КОНЕЦ КАК ВидСчетаКт,
	|	ВЫРАЗИТЬ(СтрокиКт.Договор КАК Справочник.ДоговорыАренды).ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	СтрокиКт.Валюта КАК ВалютаКт,
	|	ВЫРАЗИТЬ(СтрокиКт.Договор КАК Справочник.ДоговорыАренды).Подразделение КАК ПодразделениеКт,
	|	ВЫРАЗИТЬ(СтрокиКт.Договор КАК Справочник.ДоговорыАренды).НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	СтрокиКт.АналитикаУчетаПоПартнерам.Контрагент КАК СубконтоКт1,
	|	СтрокиКт.Договор КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	СтрокиКт.Сумма КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР СтрокиКт.ТипСуммы
	|		КОГДА ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.УслугаПоАренде)
	|			ТОГДА ""Поступление услуг по аренде на прочие активы (имущество за балансом)""
	|		КОГДА ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.УслугаПоАрендеАванс)
	|			ТОГДА ""Поступление услуг по аренде на прочие активы (имущество за балансом)""  
	|		КОГДА ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.ОбеспечительныйПлатеж)
	|			ТОГДА ""Поступление услуг по аренде на прочие активы (имущество за балансом)"" 
	|		КОГДА ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.ВыкупнаяСтоимость)
	|			ТОГДА ""Выкуп предмета аренды (имущество за балансом)""
	|	КОНЕЦ КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.ПрочиеРасходы КАК СтрокиДт
	|	ПО СтрокиДт.Регистратор = ДокументыКОтражению.Ссылка
	|		И СтрокиДт.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.РасчетыПоФинансовымИнструментам КАК СтрокиКт
	|	ПО СтрокиКт.Регистратор = СтрокиДт.Регистратор
	|		И СтрокиКт.ИдентификаторФинЗаписи = СтрокиДт.ИдентификаторФинЗаписи
	|		И СтрокиКт.НастройкаХозяйственнойОперации = СтрокиДт.НастройкаХозяйственнойОперации
	|		И СтрокиКт.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиПрочихОпераций
	|	ПО СтрокиДт.СтатьяРасходов = СтатьиПрочихОпераций.Ссылка
	|		И СтатьиПрочихОпераций.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы)";
	СписокЗапросов.Добавить(ТекстЗапроса);
	#КонецОбласти

	ТекстЗапроса = СтрСоединить(СписокЗапросов, ОбщегоНазначенияУТ.РазделительЗапросовВОбъединении());
	
	//-- Локализация
	
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстЗапросаВТОтраженияВРеглУчете() Экспорт
	
	Возврат "";
	
КонецФункции

#КонецОбласти

#Область Проведение

Процедура ПриЗаписи(Объект, Отказ) Экспорт
	
	//++ Локализация
	
	Если ПроведениеДокументов.СвойстваДокумента(Объект).РежимЗаписи <> РежимЗаписиДокумента.Запись Тогда
		Документы.СчетФактураПолученный.АктуализироватьСчетФактуру(Объект.Ссылка, Объект.Проведен);
	КонецЕсли;
	
	//-- Локализация
	
КонецПроцедуры

// 
// Параметры:
// 	МеханизмыДокумента - Массив -
Процедура ЗарегистрироватьУчетныеМеханизмы(МеханизмыДокумента) Экспорт

	//++ Локализация
	МеханизмыДокумента.Добавить("РегламентированныйУчет");
	//-- Локализация
	
КонецПроцедуры

// Процедура дополняет тексты запросов проведения документа.
//
// Параметры:
//  Запрос - Запрос - Общий запрос проведения документа.
//  ТекстыЗапроса - СписокЗначений - Список текстов запроса проведения.
//  Регистры - Строка, Структура - Список регистров проведения документа через запятую или в ключах структуры.
//
Процедура ДополнитьТекстыЗапросовПроведения(Запрос, ТекстыЗапроса, Регистры) Экспорт
	
	//++ Локализация
	ТекстЗапросаТаблицаОтражениеДокументовВРеглУчете(Запрос, ТекстыЗапроса, Регистры);
	//-- Локализация
	
КонецПроцедуры

Процедура ДополнитьЗначенияПараметровПроведения(Реквизиты, ЗначенияПараметровПроведения) Экспорт
	
	//++ Локализация
	
	Если Реквизиты <> Неопределено Тогда
		
		ЗначенияПараметровПроведения.Вставить("ПрименяетсяУСН", УчетнаяПолитика.ПрименяетсяУСН(Реквизиты.Организация, Реквизиты.Период));
		ЗначенияПараметровПроведения.Вставить("ОсновноеНалогообложениеНДСПродажи",
			УчетНДСУП.ПараметрыУчетаПоОрганизации(Реквизиты.Организация, Реквизиты.Период).ОсновноеНалогообложениеНДСПродажи);
		
	КонецЕсли;
	
	//-- Локализация
	
КонецПроцедуры

Функция ТекстЗапросаТаблицаВтРасходы() Экспорт
	
	ТекстЗапроса = Неопределено;
	
	//++ Локализация
	ТекстЗапроса =
	"// Суммы без НДС.
	|ВЫБРАТЬ
	|	&Период                                    КАК Период,
	|	&Организация                               КАК Организация,
	|	ТаблицаНачисления.Ссылка                   КАК Ссылка,
	|	ТаблицаНачисления.НомерСтроки              КАК НомерСтроки,
	|	ТаблицаНачисления.ИдентификаторСтроки      КАК ИдентификаторСтроки,
	|	ТаблицаНачисления.СтатьяРасходов           КАК СтатьяРасходов,
	|	ТаблицаНачисления.АналитикаРасходов        КАК АналитикаРасходов,
	|	ТаблицаНачисления.АналитикаАктивовПассивов КАК АналитикаАктивовПассивов,
	|	ТаблицаНачисления.НастройкаСчетовУчета     КАК НастройкаСчетовУчета,
	|	ТаблицаНачисления.Подразделение            КАК Подразделение,
	|	ТаблицаНачисления.НаправлениеДеятельности  КАК НаправлениеДеятельности,
	|	ТаблицаАналитикУчетаПартий.ВидЦенности     КАК ВидЦенности,
	|	&НастройкаХО_ОтражениеУслугПоАрендеВРасходах КАК НастройкаХозяйственнойОперации,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС) КАК ВидДеятельностиНДС,
	|	ТаблицаАналитикУчетаПартий.АналитикаУчетаПартий                    КАК АналитикаУчетаПартий,
	|
	|	ТаблицаНачисления.СтавкаНДС                КАК СтавкаНДС,
	|
	|	ВЫБОР
	|		КОГДА &ОтразитьУслугиВРасходахУпр
	|			ТОГДА ТаблицаСуммы.СуммаБезНДСУпр + ТаблицаСуммы.СуммаНДСУпр
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаУпр,
	|
	|	ВЫБОР
	|		КОГДА &ОтразитьУслугиВРасходахУпр
	|			ТОГДА ТаблицаСуммы.СуммаСНДС
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаСНДС,
	|
	|	ВЫБОР
	|		КОГДА &ОтразитьУслугиВРасходахУпр
	|			ТОГДА ТаблицаСуммы.СуммаНДС
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаНДС,
	|
	|	ВЫБОР
	|		КОГДА &ОтразитьУслугиВРасходахУпр
	|			ТОГДА ТаблицаСуммы.СуммаБезНДСУпр
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаБезНДСУпр,
	|
	|	ВЫБОР
	|		КОГДА &ОтразитьУслугиВРасходахУпр
	|			ТОГДА ТаблицаСуммы.СуммаНДСУпр
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаНДСУпр,
	|
	|	ВЫБОР
	|		КОГДА &ОтразитьУслугиВРасходахРегл
	|			ТОГДА ТаблицаСуммы.СуммаБезНДСРегл + ТаблицаСуммы.СуммаНДСРегл
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаРегл,
	|
	|	ВЫБОР
	|		КОГДА &ОтразитьУслугиВРасходахРегл
	|			ТОГДА ТаблицаСуммы.СуммаБезНДСРегл
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаБезНДСРегл,
	|
	|	ВЫБОР
	|		КОГДА &ОтразитьУслугиВРасходахРегл
	|			ТОГДА ТаблицаСуммы.СуммаНДСРегл
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаНДСРегл,
	|
	|	ВЫБОР
	|		КОГДА НЕ &ОтразитьУслугиВРасходахРегл
	|				И &Балансодержатель = ЗНАЧЕНИЕ(Перечисление.БалансодержательПредметовАренды.Арендодатель)
	|			ТОГДА -ТаблицаСуммы.СуммаНУ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ВременнаяРазница,
	|
	|	ТаблицаСуммы.СуммаВзаиморасчетов    КАК СуммаВзаиморасчетов,
	|	ТаблицаСуммы.СуммаНДСВзаиморасчетов КАК СуммаНДСВзаиморасчетов
	|
	|ПОМЕСТИТЬ втРасходы
	|
	|ИЗ
	|	Документ.ПоступлениеУслугПоАренде.Начисления КАК ТаблицаНачисления
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВтСуммыДокументовВВалютахУчета КАК ТаблицаСуммы
	|		ПО (ТаблицаСуммы.ИдентификаторСтроки = ТаблицаНачисления.ИдентификаторСтроки)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВтТаблицаАналитикУчетаПартий КАК ТаблицаАналитикУчетаПартий
	|		ПО (ТаблицаАналитикУчетаПартий.НомерСтроки = ТаблицаНачисления.НомерСтроки)
	|			И (ТаблицаАналитикУчетаПартий.ИмяТабличнойЧасти = ""Начисления"")
	|ГДЕ
	|	ТаблицаНачисления.Ссылка = &Ссылка
	|	И (&ОтразитьУслугиВРасходахРегл
	|			ИЛИ &ОтразитьУслугиВРасходахУпр
	|			ИЛИ НЕ &ОтразитьУслугиВРасходахРегл
	|				И &Балансодержатель = ЗНАЧЕНИЕ(Перечисление.БалансодержательПредметовАренды.Арендодатель))
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|// Суммы НДС при УСН.
	|ВЫБРАТЬ
	|	&Период                                    КАК Период,
	|	&Организация                               КАК Организация,
	|	ТаблицаНачисления.Ссылка                   КАК Ссылка,
	|	ТаблицаНачисления.НомерСтроки              КАК НомерСтроки,
	|	ТаблицаНачисления.ИдентификаторСтроки      КАК ИдентификаторСтроки,
	|	ТаблицаНачисления.СтатьяРасходов           КАК СтатьяРасходов,
	|	ТаблицаНачисления.АналитикаРасходов        КАК АналитикаРасходов,
	|	ТаблицаНачисления.АналитикаАктивовПассивов КАК АналитикаАктивовПассивов,
	|	ТаблицаНачисления.НастройкаСчетовУчета     КАК НастройкаСчетовУчета,
	|	ТаблицаНачисления.Подразделение            КАК Подразделение,
	|	ТаблицаНачисления.НаправлениеДеятельности  КАК НаправлениеДеятельности,
	|	ТаблицаАналитикУчетаПартий.ВидЦенности     КАК ВидЦенности,
	|	ВЫБОР
	|		КОГДА ТаблицаНачисления.ТипНачисления = ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.УслугаПоАренде)
	|			ТОГДА &НастройкаХО_ПоступлениеНДСВЧастиУслугиПоАренде
	|		КОГДА ТаблицаНачисления.ТипНачисления = ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.УслугаПоАрендеАванс)
	|			ТОГДА &НастройкаХО_ПоступлениеНДСВЧастиУслугиПоАренде
	|		КОГДА ТаблицаНачисления.ТипНачисления = ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.ОбеспечительныйПлатеж)
	|			ТОГДА &НастройкаХО_ПоступлениеНДСВЧастиОбеспечительногоПлатежа
	|		КОГДА ТаблицаНачисления.ТипНачисления = ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.ВыкупнаяСтоимость)
	|				ТОГДА &НастройкаХО_ПоступлениеНДСВЧастиВыкупнойСтоимости
	|	КОНЕЦ КАК НастройкаХозяйственнойОперации,
	|
	|	ТаблицаАналитикУчетаПартий.НалогообложениеНДС   КАК ВидДеятельностиНДС,
	|	ТаблицаАналитикУчетаПартий.АналитикаУчетаПартий КАК АналитикаУчетаПартий,
	|
	|	ТаблицаНачисления.СтавкаНДС                КАК СтавкаНДС,
	|
	|	ВЫБОР 
	|		КОГДА НЕ &ОтразитьУслугиВРасходахУпр
	|			ТОГДА ТаблицаСуммы.СуммаНДСУпр 
	|		ИНАЧЕ 0
	|	КОНЕЦ                      КАК СуммаУпр,
	|
	|	ТаблицаСуммы.СуммаНДС      КАК СуммаСНДС,
	|	ТаблицаСуммы.СуммаНДС      КАК СуммаНДС,
	|	ВЫБОР 
	|		КОГДА НЕ &ОтразитьУслугиВРасходахУпр
	|			ТОГДА ТаблицаСуммы.СуммаНДСУпр
	|		ИНАЧЕ 0
	|	КОНЕЦ                      КАК СуммаБезНДСУпр,
	|
	|	ВЫБОР 
	|		КОГДА НЕ &ОтразитьУслугиВРасходахУпр
	|			ТОГДА ТаблицаСуммы.СуммаНДСУпр 
	|		ИНАЧЕ 
	|			0 КОНЕЦ            КАК СуммаНДСУпр,
	|
	|	ТаблицаСуммы.СуммаНДСРегл  КАК СуммаРегл,
	|	ВЫБОР 
	|		КОГДА НЕ &ОтразитьУслугиВРасходахРегл
	|			ТОГДА ТаблицаСуммы.СуммаНДСРегл
	|		ИНАЧЕ 0
	|	КОНЕЦ                      КАК СуммаБезНДСРегл,
	|	ТаблицаСуммы.СуммаНДСРегл  КАК СуммаНДСРегл,
	|	0                          КАК ВременнаяРазница,
	|	0                          КАК СуммаВзаиморасчетов,
	|	0                          КАК СуммаНДСВзаиморасчетов
	|
	|ИЗ
	|	Документ.ПоступлениеУслугПоАренде.Начисления КАК ТаблицаНачисления
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВтСуммыДокументовВВалютахУчета КАК ТаблицаСуммы
	|		ПО (ТаблицаСуммы.ИдентификаторСтроки = ТаблицаНачисления.ИдентификаторСтроки)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВтТаблицаАналитикУчетаПартий КАК ТаблицаАналитикУчетаПартий
	|		ПО (ТаблицаАналитикУчетаПартий.НомерСтроки = ТаблицаНачисления.НомерСтроки)
	|			И (ТаблицаАналитикУчетаПартий.ИмяТабличнойЧасти = ""Начисления"")
	|ГДЕ
	|	ТаблицаНачисления.Ссылка = &Ссылка
	|	И &ПрименяетсяУСН
	|	И &ОсновноеНалогообложениеНДСПродажи <> ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|// Суммы НДС при ОСНО.
	|ВЫБРАТЬ
	|	&Период                                    КАК Период,
	|	&Организация                               КАК Организация,
	|	ТаблицаНачисления.Ссылка                   КАК Ссылка,
	|	ТаблицаНачисления.НомерСтроки              КАК НомерСтроки,
	|	ТаблицаНачисления.ИдентификаторСтроки      КАК ИдентификаторСтроки,
	|	ТаблицаНачисления.СтатьяРасходов           КАК СтатьяРасходов,
	|	ТаблицаНачисления.АналитикаРасходов        КАК АналитикаРасходов,
	|	ТаблицаНачисления.АналитикаАктивовПассивов КАК АналитикаАктивовПассивов,
	|	ТаблицаНачисления.НастройкаСчетовУчета     КАК НастройкаСчетовУчета,
	|	ТаблицаНачисления.Подразделение            КАК Подразделение,
	|	ТаблицаНачисления.НаправлениеДеятельности  КАК НаправлениеДеятельности,
	|	ТаблицаАналитикУчетаПартий.ВидЦенности     КАК ВидЦенности,
	|	&НастройкаХО_ПоступлениеНДСВЧастиУслугиПоАренде КАК НастройкаХозяйственнойОперации,
	|
	|	ТаблицаАналитикУчетаПартий.НалогообложениеНДС   КАК ВидДеятельностиНДС,
	|	ТаблицаАналитикУчетаПартий.АналитикаУчетаПартий КАК АналитикаУчетаПартий,
	|
	|	ТаблицаНачисления.СтавкаНДС                КАК СтавкаНДС,
	|
	|	ВЫБОР 
	|		КОГДА &ЗакупкаПодДеятельность = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
	|			ТОГДА ТаблицаСуммы.СуммаНДСУпр 
	|		ИНАЧЕ 
	|			0 
	|		КОНЕЦ                  КАК СуммаУпр,
	|
	|	ТаблицаСуммы.СуммаНДС      КАК СуммаСНДС,
	|	ТаблицаСуммы.СуммаНДС      КАК СуммаНДС,
	|	0                          КАК СуммаБезНДСУпр,
	|
	|	ВЫБОР
	|		КОГДА &ЗакупкаПодДеятельность = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
	|			ТОГДА ТаблицаСуммы.СуммаНДСУпр
	|		ИНАЧЕ 
	|			0 
	|		КОНЕЦ                  КАК СуммаНДСУпр,
	|
	|	ТаблицаСуммы.СуммаНДСРегл  КАК СуммаРегл,
	|	0                          КАК СуммаБезНДСРегл,
	|	ТаблицаСуммы.СуммаНДСРегл  КАК СуммаНДСРегл,
	|	0                          КАК ВременнаяРазница,
	|	0                          КАК СуммаВзаиморасчетов,
	|	0                          КАК СуммаНДСВзаиморасчетов
	|
	|ИЗ
	|	Документ.ПоступлениеУслугПоАренде.Начисления КАК ТаблицаНачисления
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВтСуммыДокументовВВалютахУчета КАК ТаблицаСуммы
	|		ПО (ТаблицаСуммы.ИдентификаторСтроки = ТаблицаНачисления.ИдентификаторСтроки)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВтТаблицаАналитикУчетаПартий КАК ТаблицаАналитикУчетаПартий
	|		ПО (ТаблицаАналитикУчетаПартий.НомерСтроки = ТаблицаНачисления.НомерСтроки)
	|			И (ТаблицаАналитикУчетаПартий.ИмяТабличнойЧасти = ""Начисления"")
	|ГДЕ
	|	ТаблицаНачисления.Ссылка = &Ссылка
	|	И НЕ (&ПрименяетсяУСН И &ОсновноеНалогообложениеНДСПродажи <> ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС))
	|";

	//-- Локализация
	
	Возврат ТекстЗапроса;
	
КонецФункции

#КонецОбласти

//++ Локализация

#Область Локализация

Процедура ТекстЗапросаТаблицаОтражениеДокументовВРеглУчете(Запрос, ТекстыЗапроса, Регистры)
	
	ИмяРегистра = "ОтражениеДокументовВРеглУчете";
	
	Если Не ПроведениеДокументов.ТребуетсяТаблицаДляДвижений(ИмяРегистра, Регистры) Тогда
		Возврат;
	КонецЕсли; 
	
	Если Не ПроведениеДокументов.ЕстьТаблицаЗапроса("ВтПрочиеРасходы", ТекстыЗапроса) Тогда
		Документы.ПоступлениеУслугПоАренде.ТекстЗапросаТаблицаВтПрочиеРасходы(Запрос, ТекстыЗапроса);
	КонецЕсли;
	
	ТекстЗапроса = "
	|ВЫБРАТЬ
	|	&Период                      КАК Период,
	|	&Организация                 КАК Организация,
	|	НАЧАЛОПЕРИОДА(&Период, ДЕНЬ) КАК ДатаОтражения
	|";
	ТекстЗапроса = ТекстЗапроса + "ОБЪЕДИНИТЬ ВСЕ"
		+ ДоходыИРасходыСервер.ДополнитьТекстЗапросаТаблицаОтражениеДокументовВРеглУчете(Ложь);
	
	ТекстыЗапроса.Добавить(ТекстЗапроса, ИмяРегистра);
	
КонецПроцедуры

#КонецОбласти

//-- Локализация

#КонецОбласти
