//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// В модуле описаны контекстные запросы данных из оперативных документов в формате (протоколе), необходимом
// для проведения по регламентированному учету (по регистру бухгалтерии Хозрасчетный).
//
// Экспорт в служебных процедурах и функциях указан для включения повторного использования.
//
//////////////////////////////////////////////////////////////////////////////////////////////////////////////

#Область ПрограммныйИнтерфейс

// Возвращает параметры учетной политики, значимые для заполнения сумм НУ, ПР, ВР в проводках.
//
// Параметры:
// 	Организация - СправочникСсылка.Организации - Организация, для которой получаются параметры учетной политики
// 	Период - Дата - Период действия учетной политики.
// 
// Возвращаемое значение:
// 	 Структура - значения параметров учетной политики:
// 		* ПлательщикНалогаНаПрибыль - Булево - Признак, что организация является плательщиком налога на прибыль
// 		* ПоддержкаПБУ18 - Булево - Признак, что организация применяет ПБУ 18/02.
// 		* ВедетсяУчетПостоянныхИВременныхРазниц - Булево - Признак, что ведется учет разниц при применении ПБУ 18/02.
//
Функция ДанныеУчетнойПолитики(Организация, Период) Экспорт
	
	Результат = Новый Структура;
	Результат.Вставить("ПлательщикНалогаНаПрибыль");
	Результат.Вставить("ПоддержкаПБУ18");
	Результат.Вставить("ВедетсяУчетПостоянныхИВременныхРазниц");
	
	Если УчетнаяПолитика.Существует(Организация, Период) Тогда
		Результат.ПлательщикНалогаНаПрибыль             =
			УчетнаяПолитика.ПлательщикНалогаНаПрибыль(Организация, Период);
		Результат.ПоддержкаПБУ18                        =
			УчетнаяПолитика.ПоддержкаПБУ18(Организация, Период);
		Результат.ВедетсяУчетПостоянныхИВременныхРазниц =
			УчетнаяПолитика.ВедетсяУчетПостоянныхИВременныхРазниц(Организация, Период);
	Иначе
		// Если нет учетной политики, то считаем, что все включено, 
		// для того, чтобы избежать потери данных, подготовленным прикладным кодом.
		// Это может быть полезно, например, при вводе начальных остатков.
		// В этом случае документ сам заботится о правильности интерпретации учетной политики.
		Результат.ПлательщикНалогаНаПрибыль             = Истина;
		Результат.ПоддержкаПБУ18                        = Истина;
		Результат.ВедетсяУчетПостоянныхИВременныхРазниц = Истина;
	КонецЕсли;
	
	Возврат Результат;
	
КонецФункции

// Возвращает субсчета 90 и 91.
// 
// Возвращаемое значение
// 	 СписокСчетов - СписокЗначений - Субсчета 90 и 91.
//
Функция Счета90и91() Экспорт
	
	СчетаФинансовогоРезультата = Новый Массив;
	СчетаФинансовогоРезультата.Добавить(ПланыСчетов.Хозрасчетный.ПрочиеДоходыИРасходы);
	СчетаФинансовогоРезультата.Добавить(ПланыСчетов.Хозрасчетный.Продажи_РасходыНаПродажу);
	СчетаФинансовогоРезультата.Добавить(ПланыСчетов.Хозрасчетный.Продажи_УправленческиеРасходы);
	СчетаФинансовогоРезультата = БухгалтерскийУчет.СформироватьМассивСубсчетов(СчетаФинансовогоРезультата);
	
	СписокСчетов = Новый СписокЗначений();
	СписокСчетов.ЗагрузитьЗначения(СчетаФинансовогоРезультата);
	
	Возврат СписокСчетов;
	
КонецФункции

#КонецОбласти

#Область СлужебныйПрограммныйИнтерфейс

#Область ОбщиеФрагментыЗапросовОтражения

// Возвращает текст запроса проводки по включению НДС в стоимость по приобретенным ценностям.
// 
// Возвращаемое значение:
//  Строка - текст проводки по ключению НДС 
Функция ТекстВключениеНДСпоПриобретеннымЦенностям() Экспорт
	
	#Область ВключениеНДСВСебестоимость
	
	ТекстВключениеНДСВСебестоимость =
	"ВЫБРАТЬ //// Включение НДС в себестоимость (Дт 20, 41.01, 76.06 :: Кт 19)
	|
	|	Строки.Ссылка      КАК Ссылка,
	|	Строки.Период      КАК Период,
	|	Строки.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО       КАК ИдентификаторСтроки,
	|
	|	НДСПредъявленный.НДС    КАК Сумма,
	|	НДСПредъявленный.НДСУпр КАК СуммаУУ,
	|
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НеотфактурованныеПоставки)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НеотфактурованныеПоставки)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗатратыНаПриобретениеТМЦ)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|	КОНЕЦ КАК ВидСчетаДт,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НеотфактурованныеПоставки)
	|		ТОГДА Строки.ГруппаФинансовогоУчетаРасчетов
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты)
	|		ТОГДА Строки.ГруппаПродукции
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство)
	|		ТОГДА Строки.ГруппаПродукции
	|		ИНАЧЕ Строки.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК АналитикаУчетаДт,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты)
	|			ИЛИ Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство)
	|			ИЛИ Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НеотфактурованныеПоставки)
	|			ИЛИ Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|		ТОГДА Строки.ПодразделениеАналитики
	|		ИНАЧЕ Строки.Склад
	|	КОНЕЦ КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.ПодразделениеАналитики            КАК ПодразделениеДт,
	|	Строки.НаправлениеДеятельности           КАК НаправлениеДеятельностиДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НеотфактурованныеПоставки)
	|			ИЛИ Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА Строки.Контрагент
	|		ИНАЧЕ Строки.Номенклатура
	|	КОНЕЦ КАК СубконтоДт1,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты)
	|		ТОГДА Строки.ГруппаПродукции
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство)
	|		ТОГДА Строки.ГруппаПродукции
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|		ТОГДА Строки.Контрагент
	|		ИНАЧЕ Строки.Склад
	|	КОНЕЦ КАК СубконтоДт2,
	|	ВЫБОР КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|		ТОГДА Строки.Контрагент
	|		ИНАЧЕ Строки.ТипЗатрат
	|	КОНЕЦ КАК СубконтоДт3,
	|
	|	0                                           КАК ВалютнаяСуммаДт,
	|	Строки.Количество                           КАК КоличествоДт,
	|	ЕСТЬNULL(Стоимости.СуммаНУ, Строки.СуммаНУ) КАК СуммаНУДт,
	|	ЕСТЬNULL(Стоимости.СуммаПР, Строки.СуммаПР) КАК СуммаПРДт,
	|	ЕСТЬNULL(Стоимости.СуммаВР, Строки.СуммаВР) КАК СуммаВРДт,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НДСпоПриобретеннымЦенностям) КАК ВидСчетаКт,
	|	НДСПредъявленный.ВидДеятельностиНДС                                    КАК АналитикаУчетаКт,
	|	НДСПредъявленный.ВидЦенности                                           КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)                               КАК ВалютаКт,
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)                 КАК ПодразделениеКт,
	|	НДСПредъявленный.НаправлениеДеятельности                               КАК НаправлениеДеятельностиКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	НДСПредъявленный.Поставщик   КАК СубконтоКт1,
	|	НДСПредъявленный.СчетФактура КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО                 КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|
	|	""Включение НДС в стоимость"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ВтСтроки КАК Строки
	|	ПО
	|		Строки.Ссылка = ДокументыКОтражению.Ссылка
	|		И Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|		И Строки.НастройкаХозяйственнойОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ВключениеНДСВСтоимость)
	|
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВтСтоимости КАК Стоимости
	|	ПО
	|		Строки.Ссылка = Стоимости.Ссылка
	|		И Строки.Период = Стоимости.Период
	|		И Строки.Организация = Стоимости.Организация
	|		И Строки.Склад = Стоимости.Склад
	|		И Строки.РазделУчета = Стоимости.РазделУчета
	|		И Строки.ИдентификаторСтроки = Стоимости.ИдентификаторСтроки
	|		И Строки.ИдентификаторФинЗаписи = Стоимости.ИдентификаторФинЗаписи
	|		И Строки.НастройкаХозяйственнойОперации = Стоимости.НастройкаХозяйственнойОперации
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.НДСПредъявленный КАК НДСПредъявленный
	|	ПО
	|		НДСПредъявленный.Регистратор = Строки.Ссылка
	|		И НДСПредъявленный.ИдентификаторФинЗаписи = Строки.ИдентификаторФинЗаписи
	|		И НДСПредъявленный.НастройкаХозяйственнойОперации = Строки.НастройкаХозяйственнойОперации
	|		И НЕ НДСПредъявленный.РегламентнаяОперация
	|ГДЕ
	|	Строки.РазделУчета В (
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаСкладах),
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НеотфактурованныеПоставки),
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|		ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику))
	|";
	
	#КонецОбласти

	#Область ВключениеНДСПрочиеРасходы
	
	ТекстВключениеНДСПрочиеРасходы =
	"ВЫБРАТЬ //// Включение НДС в прочие расходы (Дт 91 :: Кт 19)
	|
	|	Расходы.Регистратор КАК Ссылка,
	|	Расходы.Период КАК Период,
	|	Расходы.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	НДСПредъявленный.НДС    КАК Сумма,
	|	НДСПредъявленный.НДСУпр КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаДт,
	|	Расходы.СтатьяРасходов                             КАК АналитикаУчетаДт,
	|	Расходы.Подразделение                              КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Расходы.Подразделение                    КАК ПодразделениеДт,
	|	Расходы.НаправлениеДеятельности          КАК НаправлениеДеятельностиДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	Расходы.СтатьяРасходов    КАК СубконтоДт1,
	|	Расходы.АналитикаРасходов КАК СубконтоДт2,
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|		ТОГДА ЕСТЬNULL(ОбъектыСтроительства.СпособСтроительства, ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.Подрядный))
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее)
	|	КОНЕЦ                     КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.ПринятиеКНалоговомуУчету
	|		ТОГДА Расходы.СуммаРегл - Расходы.ПостояннаяРазница - Расходы.ВременнаяРазница
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаНУДт,
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.ПринятиеКНалоговомуУчету
	|		ТОГДА Расходы.ПостояннаяРазница
	|		ИНАЧЕ Расходы.ПостояннаяРазница + Расходы.СуммаРегл - Расходы.ПостояннаяРазница - Расходы.ВременнаяРазница
	|	КОНЕЦ КАК СуммаПРДт,
	|	Расходы.ВременнаяРазница КАК СуммаВРДт,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НДСпоПриобретеннымЦенностям) КАК ВидСчетаКт,
	|	НДСПредъявленный.ВидДеятельностиНДС                                    КАК АналитикаУчетаКт,
	|	НДСПредъявленный.ВидЦенности                                           КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)                               КАК ВалютаКт,
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)                 КАК ПодразделениеКт,
	|	НДСПредъявленный.НаправлениеДеятельности                               КАК НаправлениеДеятельностиКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	НДСПредъявленный.Поставщик   КАК СубконтоКт1,
	|	НДСПредъявленный.СчетФактура КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО                 КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|
	|	""Включение НДС в стоимость"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ПрочиеРасходы КАК Расходы
	|	ПО
	|		ДокументыКОтражению.Ссылка = Расходы.Регистратор
	| 		И Расходы.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|		И Расходы.Активность И НЕ Расходы.Сторно
	|		И Расходы.НастройкаХозяйственнойОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ВключениеНДСВСтоимость)
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.НДСПредъявленный КАК НДСПредъявленный
	|	ПО
	|		НДСПредъявленный.Регистратор = Расходы.Регистратор
	|		И НДСПредъявленный.ИдентификаторФинЗаписи = Расходы.ИдентификаторФинЗаписи
	|		И НДСПредъявленный.НастройкаХозяйственнойОперации = Расходы.НастройкаХозяйственнойОперации
	|		И НЕ НДСПредъявленный.РегламентнаяОперация
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиРасходов
	|	ПО
	|		Расходы.СтатьяРасходов = СтатьиРасходов.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		Справочник.ОбъектыСтроительства КАК ОбъектыСтроительства
	|	ПО
	|		ОбъектыСтроительства.Ссылка = Расходы.АналитикаРасходов
	|		И СтатьиРасходов.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|";
	
	#КонецОбласти
	
	#Область ВключениеНДСАктивыПассивы
	
	ТекстВключениеНДСАктивыПассивы =
	"ВЫБРАТЬ //// Включение НДС в прочие активы/пассивы (Дт ХХ.ХХ :: Кт 19)
	|
	|	ПрочиеАктивыПассивы.Регистратор КАК Ссылка,
	|	ПрочиеАктивыПассивы.Период КАК Период,
	|	ПрочиеАктивыПассивы.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	НДСПредъявленный.НДС    КАК Сумма,
	|	НДСПредъявленный.НДСУпр КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеАктивыПассивы) КАК ВидСчетаДт,
	|	ПрочиеАктивыПассивы.Статья                                     КАК АналитикаУчетаДт,
	|	ПрочиеАктивыПассивы.Подразделение                              КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)    КАК ВалютаДт,
	|	ПрочиеАктивыПассивы.Подразделение           КАК ПодразделениеДт,
	|	ПрочиеАктивыПассивы.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	ЕСТЬNULL(НастройкиСчетовУчета.СчетУчета, НЕОПРЕДЕЛЕНО) КАК СчетДт,
	|
	|	ЕСТЬNULL(НастройкиСчетовУчета.Субконто1, НЕОПРЕДЕЛЕНО) КАК СубконтоДт1,
	|	ЕСТЬNULL(НастройкиСчетовУчета.Субконто2, НЕОПРЕДЕЛЕНО) КАК СубконтоДт2,
	|	ЕСТЬNULL(НастройкиСчетовУчета.Субконто3, НЕОПРЕДЕЛЕНО) КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НДСпоПриобретеннымЦенностям) КАК ВидСчетаКт,
	|	НДСПредъявленный.ВидДеятельностиНДС                                    КАК АналитикаУчетаКт,
	|	НДСПредъявленный.ВидЦенности                                           КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)                               КАК ВалютаКт,
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)                 КАК ПодразделениеКт,
	|	НДСПредъявленный.НаправлениеДеятельности                               КАК НаправлениеДеятельностиКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	НДСПредъявленный.Поставщик   КАК СубконтоКт1,
	|	НДСПредъявленный.СчетФактура КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО                 КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|
	|	""Включение НДС в стоимость"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ДвиженияПоПрочимАктивамПассивам КАК ПрочиеАктивыПассивы
	|	ПО
	|		ДокументыКОтражению.Ссылка = ПрочиеАктивыПассивы.Регистратор
	|		И ПрочиеАктивыПассивы.Активность И НЕ ПрочиеАктивыПассивы.Сторно
	|		И ПрочиеАктивыПассивы.НастройкаХозяйственнойОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ВключениеНДСВСтоимость)
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		Справочник.НастройкиСчетовУчетаПрочихОпераций КАК НастройкиСчетовУчета
	|	ПО
	|		ПрочиеАктивыПассивы.НастройкаСчетовУчета = НастройкиСчетовУчета.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.НДСПредъявленный КАК НДСПредъявленный
	|	ПО
	|		НДСПредъявленный.Регистратор = ПрочиеАктивыПассивы.Регистратор
	|		И НДСПредъявленный.ИдентификаторФинЗаписи = ПрочиеАктивыПассивы.ИдентификаторФинЗаписи
	|		И НДСПредъявленный.НастройкаХозяйственнойОперации = ПрочиеАктивыПассивы.НастройкаХозяйственнойОперации
	|		И НЕ НДСПредъявленный.РегламентнаяОперация
	|";
	
	#КонецОбласти

	ТекстыОтражения = Новый Массив;
	
	ТекстыОтражения.Добавить(ТекстВключениеНДСВСебестоимость);
	ТекстыОтражения.Добавить(ТекстВключениеНДСПрочиеРасходы);
	ТекстыОтражения.Добавить(ТекстВключениеНДСАктивыПассивы);

	Возврат СтрСоединить(ТекстыОтражения, ОбщегоНазначенияУТ.РазделительЗапросовВОбъединении());
	
КонецФункции

// Возвращает текст запроса проводки по отклонение в стоимости возвращенных товаров (расходы).
//
// Параметры:
// 	СодержаниеПоУмолчанию - булево, признак того, что при возвращении текста сразу переназначать содержание проводки,
// 		значение по умолчанию - Истина;
// 	ПереопределениеОтбора - булево, признак того, что при возвращении текста необходимо добавить условия отбора,
// 		значение по умолчанию - Ложь;
// 
// Возвращаемое значение:
//  Строка - текст проводки по отклонению в расходы
Функция ТекстОтклонениеВСтоимостиРасходы(СодержаниеПоУмолчанию = Истина, ПереопределениеОтбора = Ложь) Экспорт
	
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Отклонение в стоимости возвращенных товаров (расходы) (Дт 44.01 :: Кт 41.01, 20, 76.ОК)
	|	
	|	Стоимости.Ссылка КАК Ссылка,
	|	Стоимости.Период КАК Период,
	|	Стоимости.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Стоимости.СуммаБалансовая КАК Сумма,
	|	Стоимости.СуммаБалансоваяУУ КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаДт,
	|	Расходы.СтатьяРасходов КАК АналитикаУчетаДт,
	|	Расходы.Подразделение КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Расходы.Подразделение КАК ПодразделениеДт,
	|	Расходы.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	Расходы.СтатьяРасходов КАК СубконтоДт1,
	|	Расходы.АналитикаРасходов КАК СубконтоДт2,
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|		ТОГДА ЕСТЬNULL(ОбъектыСтроительства.СпособСтроительства, ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.Подрядный))
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее)
	|	КОНЕЦ КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	Стоимости.СуммаНУ КАК СуммаНУДт,
	|	Стоимости.СуммаПР КАК СуммаПРДт,
	|	Стоимости.СуммаВР КАК СуммаВРДт,
	|
	|	ВЫБОР
	|		КОГДА Стоимости.ПроизводственныеЗатраты ИЛИ Стоимости.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|		КОГДА Стоимости.Склад ССЫЛКА Справочник.Партнеры ИЛИ Стоимости.Склад ССЫЛКА Справочник.Организации
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоПродаже)
	|		КОГДА Стоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА Стоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|	КОНЕЦ КАК ВидСчетаКт,
	|	ВЫБОР
	|		КОГДА Стоимости.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоПродаже)
	|		ТОГДА Стоимости.ГруппаФинансовогоУчетаРасчетов
	|		КОГДА Стоимости.ПроизводственныеЗатраты ИЛИ Стоимости.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|		ТОГДА Стоимости.ГруппаПродукции
	|		ИНАЧЕ Стоимости.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК АналитикаУчетаКт,
	|	ВЫБОР
	|		КОГДА Стоимости.ПроизводственныеЗатраты ИЛИ Стоимости.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|		ТОГДА Стоимости.ПодразделениеАналитики
	|		ИНАЧЕ Стоимости.Склад
	|	КОНЕЦ КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Стоимости.ПодразделениеАналитики КАК ПодразделениеКт,
	|	Стоимости.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	Стоимости.Номенклатура КАК СубконтоКт1,
	|	ВЫБОР
	|		КОГДА Стоимости.ПроизводственныеЗатраты ИЛИ Стоимости.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|		ТОГДА Стоимости.ГруппаПродукции
	|		КОГДА Стоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаСкладах)
	|		ТОГДА Стоимости.Склад
	|		ИНАЧЕ Стоимости.Контрагент
	|	КОНЕЦ КАК СубконтоКт2,
	|	Стоимости.ТипЗатрат КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	Стоимости.СуммаНУ КАК СуммаНУКт,
	|	Стоимости.СуммаПР КАК СуммаПРКт,
	|	Стоимости.СуммаВР КАК СуммаВРКт,
	|	&Содержание КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ВтСтоимости КАК Стоимости
	|	ПО
	|		ДокументыКОтражению.Ссылка = Стоимости.Ссылка
	|		И Стоимости.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И Стоимости.РазделУчета В (
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаСкладах),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|			&ЗабалансовыеРазделыУчета)
	|		И Стоимости.СуммаБалансовая > 0
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ПрочиеРасходы КАК Расходы
	|	ПО
	|		Расходы.Регистратор = Стоимости.Ссылка
	|		И Расходы.Активность И НЕ Расходы.Сторно
	|		И Расходы.ИдентификаторФинЗаписи = Стоимости.ИдентификаторФинЗаписи
	|		И Расходы.НастройкаХозяйственнойОперации = Стоимости.НастройкаХозяйственнойОперации
	|		И Расходы.СтатьяРасходов = Стоимости.СтатьяРасходов
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиРасходов
	|	ПО
	|		Расходы.СтатьяРасходов = СтатьиРасходов.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		Справочник.ОбъектыСтроительства КАК ОбъектыСтроительства
	|	ПО
	|		ОбъектыСтроительства.Ссылка = Расходы.АналитикаРасходов
	|		И СтатьиРасходов.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|		И ОбъектыСтроительства.СпособСтроительства <> ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.ПустаяСсылка)
	|ГДЕ
	|	&ОтборПоУмолчанию";
	
	Если СодержаниеПоУмолчанию Тогда
		ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&Содержание", """Отклонение в стоимости возвращенных товаров (расходы)""");
	КонецЕсли;
	
	Если Не ПереопределениеОтбора Тогда
		ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ОтборПоУмолчанию", "ИСТИНА");
	КонецЕсли;
	
	Возврат ТекстЗапроса;
	
КонецФункции

// Возвращает текст запроса проводки по отклонение в стоимости возвращенных товаров (доходы).
//
// Параметры:
// 	СодержаниеПоУмолчанию - булево, признак того, что при возвращении текста сразу переназначать содержание проводки,
// 		значение по умолчанию - Истина;
// 	ПереопределениеОтбора - булево, признак того, что при возвращении текста необходимо добавить условия отбора,
// 		значение по умолчанию - Ложь;
// 
// Возвращаемое значение:
//  Строка - текст проводки по отклонению в доходы
Функция ТекстОтклонениеВСтоимостиДоходы(СодержаниеПоУмолчанию = Истина, ПереопределениеОтбора = Ложь) Экспорт
	
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Отклонение в стоимости возвращенных товаров (доходы) (Дт 41.01, 20, 76.ОК :: Кт 91.01)
	|	
	|	Стоимости.Ссылка КАК Ссылка,
	|	Стоимости.Период КАК Период,
	|	Стоимости.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	-Стоимости.СуммаБалансовая КАК Сумма,
	|	-Стоимости.СуммаБалансоваяУУ КАК СуммаУУ,
	|
	|	ВЫБОР
	|		КОГДА Стоимости.ПроизводственныеЗатраты ИЛИ Стоимости.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|		КОГДА Стоимости.Склад ССЫЛКА Справочник.Партнеры ИЛИ Стоимости.Склад ССЫЛКА Справочник.Организации
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоПродаже)
	|		КОГДА Стоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА Стоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|	КОНЕЦ КАК ВидСчетаДт,
	|	ВЫБОР
	|		КОГДА Стоимости.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоПродаже)
	|		ТОГДА Стоимости.ГруппаФинансовогоУчетаРасчетов
	|		КОГДА Стоимости.ПроизводственныеЗатраты ИЛИ Стоимости.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|		ТОГДА Стоимости.ГруппаПродукции
	|		ИНАЧЕ Стоимости.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК АналитикаУчетаДт,
	|	ВЫБОР
	|		КОГДА Стоимости.ПроизводственныеЗатраты ИЛИ Стоимости.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|		ТОГДА Стоимости.ПодразделениеАналитики
	|		ИНАЧЕ Стоимости.Склад
	|	КОНЕЦ КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Стоимости.ПодразделениеАналитики КАК ПодразделениеДт,
	|	Стоимости.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	Стоимости.Номенклатура КАК СубконтоДт1,
	|	ВЫБОР
	|		КОГДА Стоимости.ПроизводственныеЗатраты ИЛИ Стоимости.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|		ТОГДА Стоимости.ГруппаПродукции
	|		КОГДА Стоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаСкладах)
	|		ТОГДА Стоимости.Склад
	|		ИНАЧЕ Стоимости.Контрагент
	|	КОНЕЦ КАК СубконтоДт2,
	|	Стоимости.ТипЗатрат КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	-Стоимости.СуммаНУ КАК СуммаНУДт,
	|	-Стоимости.СуммаПР КАК СуммаПРДт,
	|	-Стоимости.СуммаВР КАК СуммаВРДт,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Доходы) КАК ВидСчетаКт,
	|	ПрочиеДоходы.СтатьяДоходов КАК АналитикаУчетаКт,
	|	ПрочиеДоходы.Подразделение КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	ПрочиеДоходы.Подразделение КАК ПодразделениеКт,
	|	ПрочиеДоходы.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	ПрочиеДоходы.СтатьяДоходов КАК СубконтоКт1,
	|	ПрочиеДоходы.АналитикаДоходов КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	-Стоимости.СуммаНУ КАК СуммаНУКт,
	|	-Стоимости.СуммаПР КАК СуммаПРКт,
	|	-Стоимости.СуммаВР КАК СуммаВРКт,
	|	&Содержание КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ВтСтоимости КАК Стоимости
	|	ПО
	|		ДокументыКОтражению.Ссылка = Стоимости.Ссылка
	|		И Стоимости.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И Стоимости.РазделУчета В (
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаСкладах),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|			&ЗабалансовыеРазделыУчета)
	|		И Стоимости.СуммаБалансовая < 0
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ПрочиеДоходы КАК ПрочиеДоходы
	|	ПО
	|		ПрочиеДоходы.Регистратор = Стоимости.Ссылка
	|		И ПрочиеДоходы.Активность И НЕ ПрочиеДоходы.Сторно
	|		И ПрочиеДоходы.ИдентификаторФинЗаписи = Стоимости.ИдентификаторФинЗаписи
	|		И ПрочиеДоходы.НастройкаХозяйственнойОперации = Стоимости.НастройкаХозяйственнойОперации
	|		И ПрочиеДоходы.СтатьяДоходов = Стоимости.СтатьяДоходов
	|ГДЕ
	|	&ОтборПоУмолчанию";
	
	Если СодержаниеПоУмолчанию Тогда
		ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&Содержание", """Отклонение в стоимости возвращенных товаров (доходы)""");
	КонецЕсли;
	
	Если Не ПереопределениеОтбора Тогда
		ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ОтборПоУмолчанию", "ИСТИНА");
	КонецЕсли;
	
	Возврат ТекстЗапроса;
	
КонецФункции

#КонецОбласти

#Область ВременныеТаблицы

// Возвращает текст запроса получения временной таблицы по первой записи регистра с установленным отбором.
// 
// Параметры:
// 	ИмяРегистра - Строка - имя метаданных регистра, по которому будут получаться первые записи;
// 	Условие - Строка - Строка запроса для подстановки в условие "ГДЕ".
// Возвращаемое значение:
//  Строка - текст запроса получения временной таблицы. 
Функция ТекстВТПерваяЗаписьРегистра(ИмяРегистра, Условие = Неопределено) Экспорт
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	МИНИМУМ(ДанныеРегистра.НомерСтроки) КАК НомерСтроки,
	|	ДанныеРегистра.Регистратор КАК Регистратор
	|ПОМЕСТИТЬ ВТПерваяЗаписьИмяРегистра
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ИмяРегистра КАК ДанныеРегистра
	|	ПО
	|		ДокументыКОтражению.Ссылка = ДанныеРегистра.Регистратор
	|		И ДанныеРегистра.Активность И НЕ ДанныеРегистра.Сторно
	|
	|ГДЕ
	|	ИСТИНА
	|
	|СГРУППИРОВАТЬ ПО
	|	ДанныеРегистра.Регистратор
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Регистратор";
	
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "ИмяРегистра", ИмяРегистра);
	Если Условие <> Неопределено Тогда
		ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "ИСТИНА", Условие);
	КонецЕсли;
	
	Возврат ТекстЗапроса;
	
КонецФункции

// Возвращает текст запроса проводки по списанию косвенных расходов.
// 
// Возвращаемое значение:
//  Строка - текст проводки по списанию косвенных расходов 
Функция ТекстКосвенныеРасходы() Экспорт
	
	#Область ТекстКосвенныеРасходыВрем
	
	ТекстКосвенныеРасходыВрем = "
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ДокументыКОтражению.Ссылка КАК Регистратор,
	|	КосвенныеРасходы.Организация КАК Организация,
	|	КосвенныеРасходы.Подразделение КАК Подразделение,
	|	КосвенныеРасходы.СтатьяРасходов КАК СтатьяРасходов,
	|	КосвенныеРасходы.АналитикаРасходов КАК АналитикаРасходов,
	|	КосвенныеРасходы.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	КосвенныеРасходы.КорНаправлениеДеятельности КАК КорНаправлениеДеятельности,
	|	КосвенныеРасходы.ХозяйственнаяОперация,
	|	ВЫБОР 
	|		КОГДА НЕ ЕСТЬNULL(УчетнаяПолитикаОрганизаций.ПрименяетсяЕНВД, ЛОЖЬ)
	|			И НЕ ЕСТЬNULL(УчетнаяПолитикаОрганизаций.ПрименяетсяПСН, ЛОЖЬ)
	|			ИЛИ СтатьиРасходов.ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|			ТОГДА КосвенныеРасходы.СуммаРегл
	|		КОГДА СтатьиРасходов.ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА 0
	|		КОГДА СтатьиРасходов.ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.РаспределяемыеЗатраты)
	|			ТОГДА КосвенныеРасходы.СуммаРегл - ВЫРАЗИТЬ(КосвенныеРасходы.СуммаРегл * ЕСТЬNULL(Доли.ДоляЕНВД, 0) КАК ЧИСЛО(31,2))
	|	КОНЕЦ КАК СуммаРеглОСНО,
	|	ВЫБОР 
	|		КОГДА НЕ ЕСТЬNULL(УчетнаяПолитикаОрганизаций.ПрименяетсяЕНВД, ЛОЖЬ)
	|			И НЕ ЕСТЬNULL(УчетнаяПолитикаОрганизаций.ПрименяетсяПСН, ЛОЖЬ)
	|			ИЛИ СтатьиРасходов.ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|			ТОГДА 0
	|		КОГДА СтатьиРасходов.ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА КосвенныеРасходы.СуммаРегл
	|		КОГДА СтатьиРасходов.ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.РаспределяемыеЗатраты)
	|			ТОГДА ВЫРАЗИТЬ(КосвенныеРасходы.СуммаРегл * ЕСТЬNULL(Доли.ДоляЕНВД, 0) КАК ЧИСЛО(31,2))
	|	КОНЕЦ КАК СуммаРеглЕНВД,
	|	ВЫБОР 
	|		КОГДА НЕ ЕСТЬNULL(УчетнаяПолитикаОрганизаций.ПрименяетсяЕНВД, ЛОЖЬ)
	|			И НЕ ЕСТЬNULL(УчетнаяПолитикаОрганизаций.ПрименяетсяПСН, ЛОЖЬ)
	|			ИЛИ СтатьиРасходов.ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|			ТОГДА КосвенныеРасходы.СуммаУпр
	|		КОГДА СтатьиРасходов.ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА 0
	|		КОГДА СтатьиРасходов.ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.РаспределяемыеЗатраты)
	|			ТОГДА КосвенныеРасходы.СуммаУпр - ВЫРАЗИТЬ(КосвенныеРасходы.СуммаУпр * ЕСТЬNULL(Доли.ДоляЕНВД, 0) / КурсВалютыУпрУчета.Курс КАК ЧИСЛО(31,2))
	|	КОНЕЦ КАК СуммаУпрОСНО,
	|	ВЫБОР 
	|		КОГДА НЕ ЕСТЬNULL(УчетнаяПолитикаОрганизаций.ПрименяетсяЕНВД, ЛОЖЬ)
	|			И НЕ ЕСТЬNULL(УчетнаяПолитикаОрганизаций.ПрименяетсяПСН, ЛОЖЬ)
	|			ИЛИ СтатьиРасходов.ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|			ТОГДА 0
	|		КОГДА СтатьиРасходов.ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА КосвенныеРасходы.СуммаУпр
	|		КОГДА СтатьиРасходов.ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.РаспределяемыеЗатраты)
	|			ТОГДА ВЫРАЗИТЬ(КосвенныеРасходы.СуммаУпр * ЕСТЬNULL(Доли.ДоляЕНВД, 0) / КурсВалютыУпрУчета.Курс КАК ЧИСЛО(31,2))
	|	КОНЕЦ КАК СуммаУпрЕНВД,
	|	
	|	ВЫБОР 
	|		КОГДА НЕ ЕСТЬNULL(УчетнаяПолитикаОрганизаций.ПрименяетсяЕНВД, ЛОЖЬ)
	|			И НЕ ЕСТЬNULL(УчетнаяПолитикаОрганизаций.ПрименяетсяПСН, ЛОЖЬ)
	|			ИЛИ СтатьиРасходов.ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|			ТОГДА КосвенныеРасходы.ПостояннаяРазница
	|		КОГДА СтатьиРасходов.ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА 0
	|		КОГДА СтатьиРасходов.ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.РаспределяемыеЗатраты)
	|			ТОГДА КосвенныеРасходы.ПостояннаяРазница - ВЫРАЗИТЬ(КосвенныеРасходы.ПостояннаяРазница * ЕСТЬNULL(Доли.ДоляЕНВД, 0) КАК ЧИСЛО(31,2))
	|	КОНЕЦ КАК ПостояннаяРазницаОСНО,
	|	ВЫБОР 
	|		КОГДА НЕ ЕСТЬNULL(УчетнаяПолитикаОрганизаций.ПрименяетсяЕНВД, ЛОЖЬ)
	|			И НЕ ЕСТЬNULL(УчетнаяПолитикаОрганизаций.ПрименяетсяПСН, ЛОЖЬ)
	|			ИЛИ СтатьиРасходов.ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|			ТОГДА 0
	|		КОГДА СтатьиРасходов.ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА КосвенныеРасходы.ПостояннаяРазница
	|		КОГДА СтатьиРасходов.ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.РаспределяемыеЗатраты)
	|			ТОГДА ВЫРАЗИТЬ(КосвенныеРасходы.ПостояннаяРазница * ЕСТЬNULL(Доли.ДоляЕНВД, 0) КАК ЧИСЛО(31,2))
	|	КОНЕЦ КАК ПостояннаяРазницаЕНВД,
	|	
	|	ВЫБОР 
	|		КОГДА НЕ ЕСТЬNULL(УчетнаяПолитикаОрганизаций.ПрименяетсяЕНВД, ЛОЖЬ)
	|			И НЕ ЕСТЬNULL(УчетнаяПолитикаОрганизаций.ПрименяетсяПСН, ЛОЖЬ)
	|			ИЛИ СтатьиРасходов.ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|			ТОГДА КосвенныеРасходы.ВременнаяРазница
	|		КОГДА СтатьиРасходов.ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА 0
	|		КОГДА СтатьиРасходов.ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.РаспределяемыеЗатраты)
	|			ТОГДА КосвенныеРасходы.ВременнаяРазница - ВЫРАЗИТЬ(КосвенныеРасходы.ВременнаяРазница * ЕСТЬNULL(Доли.ДоляЕНВД, 0) КАК ЧИСЛО(31,2))
	|	КОНЕЦ КАК ВременнаяРазницаОСНО,
	|	ВЫБОР 
	|		КОГДА НЕ ЕСТЬNULL(УчетнаяПолитикаОрганизаций.ПрименяетсяЕНВД, ЛОЖЬ)
	|			И НЕ ЕСТЬNULL(УчетнаяПолитикаОрганизаций.ПрименяетсяПСН, ЛОЖЬ)
	|			ИЛИ СтатьиРасходов.ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|			ТОГДА 0
	|		КОГДА СтатьиРасходов.ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|			ТОГДА КосвенныеРасходы.ВременнаяРазница
	|		КОГДА СтатьиРасходов.ВидДеятельностиДляНалоговогоУчетаЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.РаспределяемыеЗатраты)
	|			ТОГДА ВЫРАЗИТЬ(КосвенныеРасходы.ВременнаяРазница * ЕСТЬNULL(Доли.ДоляЕНВД, 0) КАК ЧИСЛО(31,2))
	|	КОНЕЦ КАК ВременнаяРазницаЕНВД
	|
	|ПОМЕСТИТЬ КосвенныеРасходыВрем 
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ПрочиеРасходы КАК КосвенныеРасходы
	|	ПО
	|		ДокументыКОтражению.Ссылка = КосвенныеРасходы.Регистратор
	|		И КосвенныеРасходы.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И (КосвенныеРасходы.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.РаспределениеРасходовПоНаправлениямДеятельности)
	|			ИЛИ КосвенныеРасходы.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.РаспределениеНормируемыхРасходовПоНУ))
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиРасходов
	|	ПО
	|		КосвенныеРасходы.СтатьяРасходов = СтатьиРасходов.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		УчетнаяПолитикаОрганизаций КАК УчетнаяПолитикаОрганизаций
	|	ПО
	|		ДокументыКОтражению.Ссылка = УчетнаяПолитикаОрганизаций.Ссылка
	|		И КосвенныеРасходы.Организация = УчетнаяПолитикаОрганизаций.Организация
	|		И НАЧАЛОПЕРИОДА(ДокументыКОтражению.Период, ДЕНЬ) = УчетнаяПолитикаОрганизаций.ДатаОтражения
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		РегистрСведений.ДолиСписанияКосвенныхРасходов КАК Доли
	|	ПО
	|		Доли.Период МЕЖДУ НАЧАЛОПЕРИОДА(ДокументыКОтражению.Период, МЕСЯЦ) И КОНЕЦПЕРИОДА(ДокументыКОтражению.Период, МЕСЯЦ)
	|		И Доли.Организация = КосвенныеРасходы.Организация 
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		КурсыВалют КАК КурсВалютыУпрУчета
	|	ПО
	|		КурсВалютыУпрУчета.Валюта = &ВалютаУпрУчета
	|		И КурсВалютыУпрУчета.Дата = Доли.ПериодРасчета
	|";
	
	#КонецОбласти

	#Область ТекстКосвенныеРасходы
	
	ТекстКосвенныеРасходыРегл = "
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	КосвенныеРасходыРегл.Регистратор КАК Регистратор,
	|	КосвенныеРасходыРегл.Организация КАК Организация,
	|	КосвенныеРасходыРегл.Подразделение КАК Подразделение,
	|	КосвенныеРасходыРегл.СтатьяРасходов КАК СтатьяРасходов,
	|	КосвенныеРасходыРегл.АналитикаРасходов КАК АналитикаРасходов,
	|	КосвенныеРасходыРегл.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	КосвенныеРасходыРегл.КорНаправлениеДеятельности КАК КорНаправлениеДеятельности,
	|	КосвенныеРасходыРегл.ХозяйственнаяОперация,
	|	КосвенныеРасходыРегл.СуммаРеглОСНО КАК СуммаРеглОСНО,
	|	КосвенныеРасходыРегл.СуммаРеглЕНВД КАК СуммаРеглЕНВД,
	|	0 КАК СуммаУпрОСНО,
	|	0 КАК СуммаУпрЕНВД,
	|	
	|	0 КАК ПостояннаяРазницаОСНО,
	|	0 КАК ПостояннаяРазницаЕНВД,
	|	
	|	КосвенныеРасходыРегл.СуммаРеглОСНО КАК ВременнаяРазницаОСНО,
	|	КосвенныеРасходыРегл.СуммаРеглЕНВД КАК ВременнаяРазницаЕНВД
	|ИЗ
	|	КосвенныеРасходыВрем КАК КосвенныеРасходыРегл
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиРасходов
	|	ПО
	|		КосвенныеРасходыРегл.СтатьяРасходов = СтатьиРасходов.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПорядокОтраженияНаСчетахУчетаПереопределяемый КАК ПорядокОтраженияНаСчетахУчетаПереопределяемый
	|			ПО ПорядокОтраженияНаСчетахУчетаПереопределяемый.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы)
	|				И ПорядокОтраженияНаСчетахУчетаПереопределяемый.Организация = КосвенныеРасходыРегл.Организация
	|				И ПорядокОтраженияНаСчетахУчетаПереопределяемый.АналитикаУчета = СтатьиРасходов.ГруппаФинансовогоУчетаРегл
	|				И ПорядокОтраженияНаСчетахУчетаПереопределяемый.МестоУчета = КосвенныеРасходыРегл.Подразделение
	|		
	|ГДЕ
	|	НЕ ПорядокОтраженияНаСчетахУчетаПереопределяемый.СчетУчета В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеДоходыИРасходы), 
	|						  ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи))
	|";
	РегистрыСведений.ПорядокОтраженияНаСчетахУчета.ПереопределитьВТекстеЗапросаПорядокОтраженияСчетаУчета(ТекстКосвенныеРасходыРегл);
	
	ТекстКосвенныеРасходыУпр = "
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	КосвенныеРасходыУпр.Регистратор КАК Регистратор,
	|	КосвенныеРасходыУпр.Организация КАК Организация,
	|	КосвенныеРасходыУпр.Подразделение КАК Подразделение,
	|	КосвенныеРасходыУпр.СтатьяРасходов КАК СтатьяРасходов,
	|	КосвенныеРасходыУпр.АналитикаРасходов КАК АналитикаРасходов,
	|	КосвенныеРасходыУпр.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	КосвенныеРасходыУпр.КорНаправлениеДеятельности КАК КорНаправлениеДеятельности,
	|	КосвенныеРасходыУпр.ХозяйственнаяОперация,
	|	0 КАК СуммаРеглОСНО,
	|	0 КАК СуммаРеглЕНВД,
	|	КосвенныеРасходыУпр.СуммаУпрОСНО КАК СуммаУпрОСНО,
	|	КосвенныеРасходыУпр.СуммаУпрЕНВД КАК СуммаУпрЕНВД,
	|	
	|	0 КАК ПостояннаяРазницаОСНО,
	|	0 КАК ПостояннаяРазницаЕНВД,
	|	
	|	0 КАК ВременнаяРазницаОСНО,
	|	0 КАК ВременнаяРазницаЕНВД
	|ИЗ
	|	КосвенныеРасходыВрем КАК КосвенныеРасходыУпр
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиРасходов
	|	ПО
	|		КосвенныеРасходыУпр.СтатьяРасходов = СтатьиРасходов.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПорядокОтраженияНаСчетахУчетаПереопределяемый КАК ПорядокОтраженияНаСчетахУчетаПереопределяемый
	|			ПО ПорядокОтраженияНаСчетахУчетаПереопределяемый.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы)
	|				И ПорядокОтраженияНаСчетахУчетаПереопределяемый.Организация = КосвенныеРасходыУпр.Организация
	|				И ПорядокОтраженияНаСчетахУчетаПереопределяемый.АналитикаУчета = СтатьиРасходов.ГруппаФинансовогоУчета
	|				И ПорядокОтраженияНаСчетахУчетаПереопределяемый.МестоУчета = КосвенныеРасходыУпр.Подразделение
	|		
	|ГДЕ
	|	НЕ ПорядокОтраженияНаСчетахУчетаПереопределяемый.СчетУчета В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеДоходыИРасходы), 
	|						  ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи))
	|";
	РегистрыСведений.ПорядокОтраженияНаСчетахУчета.ПереопределитьВТекстеЗапросаПорядокОтраженияСчетаУчета(ТекстКосвенныеРасходыУпр);
	
	ТекстКосвенныеРасходыНУ = "
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	КосвенныеРасходыНУ.Регистратор КАК Регистратор,
	|	КосвенныеРасходыНУ.Организация КАК Организация,
	|	КосвенныеРасходыНУ.Подразделение КАК Подразделение,
	|	КосвенныеРасходыНУ.СтатьяРасходов КАК СтатьяРасходов,
	|	КосвенныеРасходыНУ.АналитикаРасходов КАК АналитикаРасходов,
	|	КосвенныеРасходыНУ.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	КосвенныеРасходыНУ.КорНаправлениеДеятельности КАК КорНаправлениеДеятельности,
	|	КосвенныеРасходыНУ.ХозяйственнаяОперация,
	|	0 КАК СуммаРеглОСНО,
	|	0 КАК СуммаРеглЕНВД,
	|	0 КАК СуммаУпрОСНО,
	|	0 КАК СуммаУпрЕНВД,
	|	
	|	КосвенныеРасходыНУ.ПостояннаяРазницаОСНО КАК ПостояннаяРазницаОСНО,
	|	КосвенныеРасходыНУ.ПостояннаяРазницаЕНВД КАК ПостояннаяРазницаЕНВД,
	|	
	|	-КосвенныеРасходыНУ.СуммаРеглОСНО + КосвенныеРасходыНУ.ВременнаяРазницаОСНО КАК ВременнаяРазницаОСНО,
	|	-КосвенныеРасходыНУ.СуммаРеглЕНВД + КосвенныеРасходыНУ.ВременнаяРазницаЕНВД КАК ВременнаяРазницаЕНВД
	|ИЗ
	|	КосвенныеРасходыВрем КАК КосвенныеРасходыНУ
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиРасходов
	|	ПО
	|		КосвенныеРасходыНУ.СтатьяРасходов = СтатьиРасходов.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПорядокОтраженияНаСчетахУчетаПереопределяемый КАК ПорядокОтраженияНаСчетахУчетаПереопределяемый
	|			ПО ПорядокОтраженияНаСчетахУчетаПереопределяемый.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы)
	|				И ПорядокОтраженияНаСчетахУчетаПереопределяемый.Организация = КосвенныеРасходыНУ.Организация
	|				И ПорядокОтраженияНаСчетахУчетаПереопределяемый.АналитикаУчета = СтатьиРасходов.ГруппаФинансовогоУчетаНУ
	|				И ПорядокОтраженияНаСчетахУчетаПереопределяемый.МестоУчета = КосвенныеРасходыНУ.Подразделение
	|		
	|ГДЕ
	|	НЕ ПорядокОтраженияНаСчетахУчетаПереопределяемый.СчетУчета В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеДоходыИРасходы), 
	|						  ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи))
	|";
	РегистрыСведений.ПорядокОтраженияНаСчетахУчета.ПереопределитьВТекстеЗапросаПорядокОтраженияСчетаУчета(ТекстКосвенныеРасходыНУ);
	
	ТекстыОтраженияКосвенныеРасходы = Новый Массив;
	ТекстыОтраженияКосвенныеРасходы.Добавить(ТекстКосвенныеРасходыРегл);
	ТекстыОтраженияКосвенныеРасходы.Добавить(ТекстКосвенныеРасходыУпр);
	ТекстыОтраженияКосвенныеРасходы.Добавить(ТекстКосвенныеРасходыНУ);
	
	ТекстВТКосвенныеРасходы = СтрСоединить(ТекстыОтраженияКосвенныеРасходы, ОбщегоНазначенияУТ.РазделительЗапросовВОбъединении(Истина));
	
	ТекстКосвенныеРасходы = "
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	КосвенныеРасходы.Регистратор КАК Регистратор,
	|	КосвенныеРасходы.Организация КАК Организация,
	|	КосвенныеРасходы.Подразделение КАК Подразделение,
	|	КосвенныеРасходы.СтатьяРасходов КАК СтатьяРасходов,
	|	КосвенныеРасходы.АналитикаРасходов КАК АналитикаРасходов,
	|	КосвенныеРасходы.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	КосвенныеРасходы.КорНаправлениеДеятельности КАК КорНаправлениеДеятельности,
	|	КосвенныеРасходы.ХозяйственнаяОперация,
	|	СУММА(КосвенныеРасходы.СуммаРеглОСНО) КАК СуммаРеглОСНО,
	|	СУММА(КосвенныеРасходы.СуммаРеглЕНВД) КАК СуммаРеглЕНВД,
	|	СУММА(КосвенныеРасходы.СуммаУпрОСНО) КАК СуммаУпрОСНО,
	|	СУММА(КосвенныеРасходы.СуммаУпрЕНВД) КАК СуммаУпрЕНВД,
	|	
	|	СУММА(КосвенныеРасходы.ПостояннаяРазницаОСНО) КАК ПостояннаяРазницаОСНО,
	|	СУММА(КосвенныеРасходы.ПостояннаяРазницаЕНВД) КАК ПостояннаяРазницаЕНВД,
	|	
	|	СУММА(КосвенныеРасходы.ВременнаяРазницаОСНО) КАК ВременнаяРазницаОСНО,
	|	СУММА(КосвенныеРасходы.ВременнаяРазницаЕНВД) КАК ВременнаяРазницаЕНВД
	|
	|ПОМЕСТИТЬ КосвенныеРасходы
	|ИЗ 
	|	#ВТКосвенныеРасходы КАК КосвенныеРасходы
	|
	|СГРУППИРОВАТЬ ПО
	|	КосвенныеРасходы.Регистратор,
	|	КосвенныеРасходы.Организация,
	|	КосвенныеРасходы.Подразделение,
	|	КосвенныеРасходы.СтатьяРасходов,
	|	КосвенныеРасходы.АналитикаРасходов,
	|	КосвенныеРасходы.НаправлениеДеятельности,
	|	КосвенныеРасходы.КорНаправлениеДеятельности,
	|	КосвенныеРасходы.ХозяйственнаяОперация";
	
	ТекстКосвенныеРасходы = СтрЗаменить(ТекстКосвенныеРасходы, "#ВТКосвенныеРасходы", "(" + ТекстВТКосвенныеРасходы + ")");
	
	#КонецОбласти

	ТекстыОтражения = Новый Массив;
	
	ТекстыОтражения.Добавить(ТекстКосвенныеРасходыВрем);
	ТекстыОтражения.Добавить(ТекстКосвенныеРасходы);
	
	Возврат СтрСоединить(ТекстыОтражения, ОбщегоНазначения.РазделительПакетаЗапросов());
	
КонецФункции

#КонецОбласти

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

#Область ЗапросыОтражения

Функция ЗапросДанных(ДокументИмя, ЭтоОбъектРасчетов = Истина, ВременныеТаблицыДокументаПодготовлены = Ложь) Экспорт
	
	ТаблицаДокумента = "Документ." + ДокументИмя;
	
	МассивПустыхВТ = Новый Массив;
	ТекстыСозданияВременныхТаблиц = Новый Массив;
	ТекстыСозданияВременныхТаблиц.Добавить(ТекстУчетнаяПолитика());
	Если ДокументИмя = "РегистраторРасчетов" Тогда
		МассивПустыхВТ.Добавить("ВТСтоимостьПартийНДС");
		МассивПустыхВТ.Добавить("ВтСтроки");
		МассивПустыхВТ.Добавить("ВтСтоимости");
		МассивПустыхВТ.Добавить("Партии");
	Иначе
		
		СтруктураПолей  = Новый Структура;
		СтруктураПолей.Вставить("Ссылка", "Регистратор");

		СтруктураОтбора = Новый Структура;
		СтруктураОтбора.Вставить("ДокументыКОтражению", СтруктураПолей);
		
		СтруктураДанных = РасчетСебестоимостиНДС.ИнициализироватьСтруктуруДанныхДетализацииПартийНДСДляРеглУчета();
		
		ТекстыСозданияВременныхТаблиц.Добавить(РасчетСебестоимостиНДС.ТекстЗапросаДетализацияПартийНДС(,,, СтруктураОтбора, СтруктураДанных) + ";" + Символы.ПС);
		
		ТекстыСозданияВременныхТаблиц.Добавить(ТекстСебестоимость());

		ТекстыСозданияВременныхТаблиц.Добавить(ТекстПартии());

	КонецЕсли;
	
	Если ЭтоРасчетныйДокумент(ДокументИмя) ИЛИ ДокументИмя = "РасчетКурсовыхРазниц" Тогда
		ТекстыСозданияВременныхТаблиц.Добавить(ТекстРасчетовПоНовойАрхитектуреДетально());
		ТекстыСозданияВременныхТаблиц.Добавить(ТекстРасчетовПоНовойАрхитектуре());
	Иначе
		МассивПустыхВТ.Добавить("РасчетыСКлиентамиНоваяАрхитектураДетально");
		МассивПустыхВТ.Добавить("РасчетыСПоставщикамиНоваяАрхитектураДетально");
		МассивПустыхВТ.Добавить("РасчетыСКлиентамиНоваяАрхитектураПереносыАвансов");
		МассивПустыхВТ.Добавить("РасчетыСПоставщикамиНоваяАрхитектураПереносыАвансов");
		МассивПустыхВТ.Добавить("РасчетыСКлиентамиНоваяАрхитектура");
		МассивПустыхВТ.Добавить("РасчетыСПоставщикамиНоваяАрхитектура");
	КонецЕсли;
	
	Если ДокументыИспользующиеВыручкуИСебестоимостьПродаж().Найти(ДокументИмя) = Неопределено Тогда
		МассивПустыхВТ.Добавить("ВТВыручкаИСебестоимостьПродаж");
	Иначе
		ТекстыСозданияВременныхТаблиц.Добавить(ТекстВТВыручкаИСебестоимостьПродаж());
	КонецЕсли;
	
	Если ЭтоРасчетныйДокумент(ДокументИмя) Тогда
		ТекстыСозданияВременныхТаблиц.Добавить(ТекстВТРасчетов());
		ТекстыСозданияВременныхТаблиц.Добавить(ТекстВтВосстановлениеРасчетовПоСторно());
	Иначе
		МассивПустыхВТ.Добавить("ВТРасчетыСКлиентами");
		МассивПустыхВТ.Добавить("ВТРасчетыСПоставщиками");
		МассивПустыхВТ.Добавить("ВтВосстановлениеРасчетовСКлиентамиПоСторно");
		МассивПустыхВТ.Добавить("ВтВосстановлениеРасчетовСПоставщикамиПоСторно");
	КонецЕсли;
	
	Если ЭтоОбъектРасчетов Тогда
		ТекстыСозданияВременныхТаблиц.Добавить(ТекстВТРасчетовПоДокументам(ТаблицаДокумента));
	Иначе
		МассивПустыхВТ.Добавить("ВТРасчетыСКлиентамиПоДокументам");
		МассивПустыхВТ.Добавить("ВТРасчетыСПоставщикамиПоДокументам");
	КонецЕсли;
	
	Если ДокументИмя <> "РегистраторРасчетов" Тогда
		ТекстыСозданияВременныхТаблиц.Добавить(ТекстРаздельныйУчетНастройкиНалогообложенияПрибыли());
	Иначе
		МассивПустыхВТ.Добавить("РаздельныйУчетНастройкиНалогообложенияПрибыли");
	КонецЕсли;
	
	Если МассивПустыхВТ.Количество() Тогда
		ТекстыСозданияВременныхТаблиц.Добавить(ТекстПустыеВТ(МассивПустыхВТ));
	КонецЕсли;
		
	ТекстыСозданияВременныхТаблиц.Добавить(ТекстВТВводСобственныхСредств());
	ТекстыСозданияВременныхТаблиц.Добавить(ТекстКурсыВалют());
	ТекстыСозданияВременныхТаблиц.Добавить(ТекстДолгосрочнаяЗадолженность(ДокументИмя));
	ТекстыСозданияВременныхТаблиц.Добавить(ТекстНастройкиСтатейРасходов());
	Если Не ВременныеТаблицыДокументаПодготовлены Тогда
		ТекстыСозданияВременныхТаблиц.Добавить(ТекстВТОтраженияДокумента(ДокументИмя));
	КонецЕсли;
	
	ТекстыСозданияЗапросаДанных = Новый Массив;
	ТекстыСозданияЗапросаДанных.Добавить(ТекстИнициализации());
	Если ДокументИмя <> "РегистраторРасчетов" Тогда
		Если ЭтоРасчетныйДокумент(ДокументИмя) Тогда
			ТекстыСозданияЗапросаДанных.Добавить(ТекстЗачетАвансов(ТаблицаДокумента));
			ТекстыСозданияЗапросаДанных.Добавить(ТекстВосстановлениеРасчетовПоСторно(ТаблицаДокумента));
			ТекстыСозданияЗапросаДанных.Добавить(ТекстПереносАвансовМеждуФилиалами(ТаблицаДокумента));
			ТекстыСозданияЗапросаДанных.Добавить(ТекстПереносПлатежаМеждуФилиалами(ТаблицаДокумента));
			ТекстыСозданияЗапросаДанных.Добавить(ТекстПереносДолгаМеждуФилиалами(ТаблицаДокумента));
		КонецЕсли;
		ТекстыСозданияЗапросаДанных.Добавить(ТекстРаспределениеРасходов(ТаблицаДокумента));
		ТекстыСозданияЗапросаДанных.Добавить(ТекстСписаниеРасходовУОрганизацииИсточника(ТаблицаДокумента));
		ТекстыСозданияЗапросаДанных.Добавить(ТекстРегистрацияРасходовУОрганизацииПолучателя(ТаблицаДокумента));
		ТекстыСозданияЗапросаДанных.Добавить(ТекстНДСПоДаннымФинпартий());
		ТекстыСозданияЗапросаДанных.Добавить(ТекстНДСПоНДСПредъявленный());
		ТекстыСозданияЗапросаДанных.Добавить(ТекстПереносРезервовПодОбесценение());
		Если ПолучитьФункциональнуюОпцию("ИспользоватьОбесценениеВНА") Тогда
			ТекстыСозданияЗапросаДанных.Добавить(ТекстПереносОбесцененияВНА());
			ТекстыСозданияЗапросаДанных.Добавить(ТекстВосстановлениеОбесцененияВНА());
		КонецЕсли;
		ТекстыСозданияЗапросаДанных.Добавить(ТекстСписаниеСтоимостиНаСтатьиАктивовПассивов(,, Истина));
		ТекстыСозданияЗапросаДанных.Добавить(ТекстПеремещениеМеждуФилиалами());
	КонецЕсли;
	ТекстОтраженияДокумента = ТекстОтраженияДокумента(ДокументИмя);
	Если ТекстОтраженияДокумента <> "" Тогда
		ТекстыСозданияЗапросаДанных.Добавить(ТекстОтраженияДокумента);
	КонецЕсли;
	
	ТекстСозданияВременныхТаблиц = СтрСоединить(ТекстыСозданияВременныхТаблиц);
	ТекстСозданияЗапросаДанных = СтрСоединить(ТекстыСозданияЗапросаДанных, ОбщегоНазначенияУТ.РазделительЗапросовВОбъединении());
	ТекстыОбщегоЗапросаОтражения = Новый Массив(2);
	ТекстыОбщегоЗапросаОтражения[0] = ТекстСозданияВременныхТаблиц;
	ТекстыОбщегоЗапросаОтражения[1] = ТекстСозданияЗапросаДанных;
	ТекстОбщегоЗапросаОтражения = СтрСоединить(ТекстыОбщегоЗапросаОтражения);
	
	Возврат Новый Запрос(ТекстОбщегоЗапросаОтражения);
	
КонецФункции

Функция ЗапросДанныхПараметры(ДокументИмя, ЭтоОбъектРасчетов) Экспорт
	
	Возврат РеглУчетВыборкиСерверПовтИсп.ЗапросДанных(ДокументИмя, ЭтоОбъектРасчетов).НайтиПараметры();
	
КонецФункции

Функция ЗапросСчетовПоУмолчанию() Экспорт
	
	ТекстИнициализации = "
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчета,
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПустаяСсылка) КАК ВидСчетаРеглУчета,
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетУчета,
	|	НЕОПРЕДЕЛЕНО КАК ВидСубконто1,
	|	НЕОПРЕДЕЛЕНО КАК ВидСубконто2,
	|	НЕОПРЕДЕЛЕНО КАК ВидСубконто3,
	|	ЛОЖЬ КАК ИспользоватьСубконто,
	|	НЕОПРЕДЕЛЕНО КАК ВидСубконто,
	|	НЕОПРЕДЕЛЕНО КАК Субконто
	|ПОМЕСТИТЬ СчетаПоУмолчанию
	|ГДЕ ЛОЖЬ
	|ИНДЕКСИРОВАТЬ ПО
	|	ВидСчетаРеглУчета,
	|	АналитикаУчета
	|";
	
	Возврат Новый Запрос(ТекстИнициализации);
	
КонецФункции

Функция ЗапросОбработкиДанных() Экспорт
	
	МассивТекстовЗапроса = Новый Массив;
	
	#Область ОсновнойТекстЗапроса
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	Данные.Ссылка                       КАК Ссылка,
	|	Данные.Период                       КАК Период,
	|	НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ)  КАК ДатаОтражения,
	|	Данные.ИдентификаторСтроки          КАК ИдентификаторСтроки,
	|	
	|	Данные.Организация                  КАК Организация,
	|	
	|	Данные.Сумма КАК Сумма,
	|	ВЫБОР
	|		КОГДА &ВестиУУ
	|			И НЕ ЕСТЬNULL(НастройкиСтатейРасходовДт.РаздельноеОтражение_УУ, ЛОЖЬ)
	|			И НЕ ЕСТЬNULL(НастройкиСтатейРасходовКт.РаздельноеОтражение_УУ, ЛОЖЬ)
	|			И (&ДатаНачалаВеденияУУ <= Данные.Период
	|			ИЛИ ТИПЗНАЧЕНИЯ(Данные.Ссылка) В (&СписокТиповВводаОстатков))
	|		ТОГДА Данные.СуммаУУ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаУУ,
	|	
	|	Данные.ВидСчетаДт КАК ВидСчетаДт,
	|	Данные.АналитикаУчетаДт КАК ОбъектУчетаДт,
	|	&АналитикаУчетаПереопределяемыйДт КАК АналитикаУчетаДт,
	|	&МестоУчетаПереопределяемыйДт КАК МестоУчетаДт,
	|	
	|	Данные.ВалютаДт                     КАК ВалютаДт,
	|	Данные.ПодразделениеДт              КАК ПодразделениеДт,
	|	ВЫБОР
	|		КОГДА Данные.ВидСчетаДт В (&ЗаполнятьВсегда)
	|		ТОГДА Данные.НаправлениеДеятельностиДт
	|		КОГДА (Данные.ВидСчетаДт В (&УчетЗатрат) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетЗатрат, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДоходов, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетДенежныхСредств) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДенежныхСредствРаздельно, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетВнеоборотныхАктивов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетВнеоборотныхАктивов, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетРезервов) И ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.ГосударственныйКонтракт,
	|				ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка)) <> ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетРезервов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетЗатрат, ЛОЖЬ))
	|			ИЛИ Данные.ВидСчетаДт В (&НикогдаНеЗаполнять)
	|		ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|		ИНАЧЕ Данные.НаправлениеДеятельностиДт
	|	КОНЕЦ КАК НаправлениеДеятельностиДт,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(Данные.Ссылка КАК Документ.РегламентнаяОперация).ТипОперации = ЗНАЧЕНИЕ(Перечисление.ТипыРегламентныхОпераций.РеклассификацияДолгосрочныхАктивовОбязательств)
	|			И Данные.ВидСчетаДт В (&ПассивныеСчетаПриРеклассификации)
	|		ТОГДА ИСТИНА
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезКраткосрочныйСчет""
	|		ТОГДА ЛОЖЬ
	|		ИНАЧЕ ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Долгосрочная, ЛОЖЬ)
	|	КОНЕЦ КАК ДолгосрочныйДт,
	|	
	|	Данные.СчетДт КАК СчетДт,
	|	Данные.СубконтоДт1 КАК СубконтоДт1,
	|	Данные.СубконтоДт2 КАК СубконтоДт2,
	|	Данные.СубконтоДт3 КАК СубконтоДт3,
	|	
	|	Данные.ВалютнаяСуммаДт           КАК ВалютнаяСуммаДт,
	|	Данные.КоличествоДт              КАК КоличествоДт,
	|	ВЫБОР
	|		КОГДА НЕ ЕСТЬNULL(НастройкиСтатейРасходовДт.РаздельноеОтражение_НУ, ЛОЖЬ)
	|			И НЕ ЕСТЬNULL(НастройкиСтатейРасходовКт.РаздельноеОтражение_НУ, ЛОЖЬ)
	|		ТОГДА Данные.СуммаНУДт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаНУДт,
	|	ВЫБОР
	|		КОГДА НЕ ЕСТЬNULL(НастройкиСтатейРасходовДт.РаздельноеОтражение_НУ, ЛОЖЬ)
	|			И НЕ ЕСТЬNULL(НастройкиСтатейРасходовКт.РаздельноеОтражение_НУ, ЛОЖЬ)
	|			ИЛИ Данные.СуммаПРДт > 0 //отрицательная ПР отражается по правилам НУ
	|		ТОГДА Данные.СуммаПРДт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаПРДт,
	|	ВЫБОР
	|		КОГДА НЕ ЕСТЬNULL(НастройкиСтатейРасходовДт.РаздельноеОтражение_НУ, ЛОЖЬ)
	|			И НЕ ЕСТЬNULL(НастройкиСтатейРасходовКт.РаздельноеОтражение_НУ, ЛОЖЬ)
	|			ТОГДА Данные.СуммаВРДт
	|		КОГДА Данные.СуммаПРДт > 0
	|			ТОГДА Данные.Сумма - Данные.СуммаПРДт
	|		ИНАЧЕ Данные.Сумма
	|	КОНЕЦ КАК СуммаВРДт,
	|	
	|	Данные.ВидСчетаКт КАК ВидСчетаКт,
	|	Данные.АналитикаУчетаКт КАК ОбъектУчетаКт,
	|	&АналитикаУчетаПереопределяемыйКт КАК АналитикаУчетаКт,
	|	&МестоУчетаПереопределяемыйКт КАК МестоУчетаКт,
	|	
	|	Данные.ВалютаКт                  КАК ВалютаКт,
	|	Данные.ПодразделениеКт           КАК ПодразделениеКт,
	|	ВЫБОР
	|		КОГДА Данные.ВидСчетаКт В (&ЗаполнятьВсегда)
	|		ТОГДА Данные.НаправлениеДеятельностиКт 
	|		КОГДА (Данные.ВидСчетаКт В (&УчетЗатрат) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетЗатрат, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДоходов, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетДенежныхСредств) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДенежныхСредствРаздельно, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетВнеоборотныхАктивов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетВнеоборотныхАктивов, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетРезервов) И ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.ГосударственныйКонтракт,
	|				ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка)) <> ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетРезервов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетЗатрат, ЛОЖЬ))
	|			ИЛИ Данные.ВидСчетаКт В (&НикогдаНеЗаполнять)
	|		ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|		ИНАЧЕ Данные.НаправлениеДеятельностиКт 
	|	КОНЕЦ КАК НаправлениеДеятельностиКт,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(Данные.Ссылка КАК Документ.РегламентнаяОперация).ТипОперации = ЗНАЧЕНИЕ(Перечисление.ТипыРегламентныхОпераций.РеклассификацияДолгосрочныхАктивовОбязательств)
	|			И Данные.ВидСчетаКт В (&АктивныеСчетаПриРеклассификации)
	|		ТОГДА ИСТИНА
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезКраткосрочныйСчет""
	|		ТОГДА ЛОЖЬ
	|		ИНАЧЕ ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Долгосрочная, ЛОЖЬ)
	|	КОНЕЦ КАК ДолгосрочныйКт,
	|	
	|	Данные.СчетКт КАК СчетКт,
	|	ВЫБОР
	|		КОГДА Данные.ВидСчетаКт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство) И НЕ &ДетализацияПроводок
	|			И ТИПЗНАЧЕНИЯ(Данные.СубконтоКт1) <> ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Данные.СубконтоКт1
	|	КОНЕЦ КАК СубконтоКт1,
	|	ВЫБОР
	|		КОГДА Данные.ВидСчетаКт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство) И НЕ &ДетализацияПроводок
	|			И ТИПЗНАЧЕНИЯ(Данные.СубконтоКт2) <> ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Данные.СубконтоКт2
	|	КОНЕЦ КАК СубконтоКт2,
	|	ВЫБОР
	|		КОГДА Данные.ВидСчетаКт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство) И НЕ &ДетализацияПроводок
	|			И ТИПЗНАЧЕНИЯ(Данные.СубконтоКт3) <> ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Данные.СубконтоКт3
	|	КОНЕЦ КАК СубконтоКт3,
	|	
	|	Данные.ВалютнаяСуммаКт          КАК ВалютнаяСуммаКт,
	|	Данные.КоличествоКт             КАК КоличествоКт,
	|	ВЫБОР
	|		КОГДА НЕ ЕСТЬNULL(НастройкиСтатейРасходовДт.РаздельноеОтражение_НУ, ЛОЖЬ)
	|			И НЕ ЕСТЬNULL(НастройкиСтатейРасходовКт.РаздельноеОтражение_НУ, ЛОЖЬ)
	|		ТОГДА Данные.СуммаНУКт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаНУКт,
	|	ВЫБОР
	|		КОГДА НЕ ЕСТЬNULL(НастройкиСтатейРасходовДт.РаздельноеОтражение_НУ, ЛОЖЬ)
	|			И НЕ ЕСТЬNULL(НастройкиСтатейРасходовКт.РаздельноеОтражение_НУ, ЛОЖЬ)
	|			ИЛИ Данные.СуммаПРКт > 0 //отрицательная ПР отражается по правилам НУ
	|		ТОГДА Данные.СуммаПРКт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаПРКт,
	|	ВЫБОР
	|		КОГДА НЕ ЕСТЬNULL(НастройкиСтатейРасходовДт.РаздельноеОтражение_НУ, ЛОЖЬ)
	|			И НЕ ЕСТЬNULL(НастройкиСтатейРасходовКт.РаздельноеОтражение_НУ, ЛОЖЬ)
	|			ТОГДА Данные.СуммаВРКт
	|		КОГДА Данные.СуммаПРДт > 0
	|			ТОГДА Данные.Сумма - Данные.СуммаПРКт
	|		ИНАЧЕ Данные.Сумма
	|	КОНЕЦ КАК СуммаВРКт,
	|	
	|	Данные.Содержание               КАК Содержание,
	|	Данные.Сторно                   КАК Сторно
	|
	|ПОМЕСТИТЬ ДанныеДляСопоставления
	|
	|ИЗ
	|	Данные КАК Данные
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РазрезыКОтражению КАК РазрезыКОтражению
	|	ПО
	|		Данные.Ссылка = РазрезыКОтражению.Ссылка
	|		И Данные.Организация =  РазрезыКОтражению.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = РазрезыКОтражению.ДатаОтражения
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВтДолгосрочнаяЗадолженность КАК ДолгосрочнаяЗадолженностьДт
	|	ПО
	|		Данные.Ссылка = ДолгосрочнаяЗадолженностьДт.Ссылка
	|		И Данные.Организация = ДолгосрочнаяЗадолженностьДт.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = ДолгосрочнаяЗадолженностьДт.ДатаОтражения
	|		И Данные.ВидСчетаДт = ДолгосрочнаяЗадолженностьДт.ВидСчета
	|		И Данные.АналитикаУчетаДт = ДолгосрочнаяЗадолженностьДт.АналитикаУчета
	|		И Данные.МестоУчетаДт = ДолгосрочнаяЗадолженностьДт.МестоУчета
	|		И Данные.ПодразделениеДт = ДолгосрочнаяЗадолженностьДт.Подразделение
	|		И Данные.НаправлениеДеятельностиДт = ДолгосрочнаяЗадолженностьДт.НаправлениеДеятельности
	|		И Данные.ВалютаДт = ДолгосрочнаяЗадолженностьДт.Валюта
	|		И Данные.СубконтоДт1 = ДолгосрочнаяЗадолженностьДт.Субконто1
	|		И Данные.СубконтоДт2 = ДолгосрочнаяЗадолженностьДт.Субконто2
	|		И ДолгосрочнаяЗадолженностьДт.ВидПроводкиДляПереноса В (НЕОПРЕДЕЛЕНО, ""Дт"")
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВтДолгосрочнаяЗадолженность КАК ДолгосрочнаяЗадолженностьКт
	|	ПО
	|		Данные.Ссылка = ДолгосрочнаяЗадолженностьКт.Ссылка
	|		И Данные.Организация = ДолгосрочнаяЗадолженностьКт.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = ДолгосрочнаяЗадолженностьКт.ДатаОтражения
	|		И Данные.ВидСчетаКт = ДолгосрочнаяЗадолженностьКт.ВидСчета
	|		И Данные.АналитикаУчетаКт = ДолгосрочнаяЗадолженностьКт.АналитикаУчета
	|		И Данные.МестоУчетаКт = ДолгосрочнаяЗадолженностьКт.МестоУчета
	|		И Данные.ПодразделениеКт = ДолгосрочнаяЗадолженностьКт.Подразделение
	|		И Данные.НаправлениеДеятельностиКт = ДолгосрочнаяЗадолженностьКт.НаправлениеДеятельности
	|		И Данные.ВалютаКт = ДолгосрочнаяЗадолженностьКт.Валюта
	|		И Данные.СубконтоКт1 = ДолгосрочнаяЗадолженностьКт.Субконто1
	|		И Данные.СубконтоКт2 = ДолгосрочнаяЗадолженностьКт.Субконто2
	|		И ДолгосрочнаяЗадолженностьКт.ВидПроводкиДляПереноса В (НЕОПРЕДЕЛЕНО, ""Кт"")
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		НастройкиСтатейРасходов КАК НастройкиСтатейРасходовДт
	|	ПО
	|		НастройкиСтатейРасходовДт.СтатьяРасходов = Данные.АналитикаУчетаДт
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		НастройкиСтатейРасходов КАК НастройкиСтатейРасходовКт
	|	ПО
	|		НастройкиСтатейРасходовКт.СтатьяРасходов = Данные.АналитикаУчетаКт
	|
	|ГДЕ
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"")) В (""Основной"", ""ЧерезКраткосрочныйСчет"")
	|	И ВЫБОР КОГДА Данные.ВидСчетаДт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство) И Данные.ВидСчетаКт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|	ТОГДА Данные.МестоУчетаДт <> Данные.МестоУчетаКт ИЛИ Данные.НаправлениеДеятельностиДт <> Данные.НаправлениеДеятельностиКт
	|		ИЛИ (Данные.АналитикаУчетаДт <> Данные.АналитикаУчетаКт
	|		И НЕ (Данные.АналитикаУчетаДт = ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка) И Данные.АналитикаУчетаКт = НЕОПРЕДЕЛЕНО)
	|		И НЕ (Данные.АналитикаУчетаКт = ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка) И Данные.АналитикаУчетаДт = НЕОПРЕДЕЛЕНО))
	|	ИНАЧЕ ИСТИНА КОНЕЦ";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ЗапросНУ
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	Данные.Ссылка                       КАК Ссылка,
	|	Данные.Период                       КАК Период,
	|	НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ)  КАК ДатаОтражения,
	|	Данные.ИдентификаторСтроки          КАК ИдентификаторСтроки,
	|	
	|	Данные.Организация                  КАК Организация,
	|	
	|	0                                   КАК Сумма,
	|	0                                   КАК СуммаУУ,
	|	
	|	Данные.ВидСчетаДт                   КАК ВидСчетаДт,
	|	Данные.АналитикаУчетаДт КАК ОбъектУчетаДт,
	|	&АналитикаУчетаПереопределяемыйДт_НУ КАК АналитикаУчетаДт,
	|	&МестоУчетаПереопределяемыйДт КАК МестоУчетаДт,
	|	
	|	Данные.ВалютаДт                     КАК ВалютаДт,
	|	Данные.ПодразделениеДт              КАК ПодразделениеДт,
	|	ВЫБОР
	|		КОГДА Данные.ВидСчетаДт В (&ЗаполнятьВсегда)
	|		ТОГДА Данные.НаправлениеДеятельностиДт
	|		КОГДА (Данные.ВидСчетаДт В (&УчетЗатрат) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетЗатрат, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДоходов, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетДенежныхСредств) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДенежныхСредствРаздельно, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетДенежныхСредств) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДенежныхСредствПоКорреспонденции, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетВнеоборотныхАктивов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетВнеоборотныхАктивов, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетРезервов) И ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.ГосударственныйКонтракт,
	|				ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка)) <> ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетРезервов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетЗатрат, ЛОЖЬ))
	|			ИЛИ Данные.ВидСчетаДт В (&НикогдаНеЗаполнять)
	|		ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|		ИНАЧЕ Данные.НаправлениеДеятельностиДт
	|	КОНЕЦ КАК НаправлениеДеятельностиДт,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(Данные.Ссылка КАК Документ.РегламентнаяОперация).ТипОперации = ЗНАЧЕНИЕ(Перечисление.ТипыРегламентныхОпераций.РеклассификацияДолгосрочныхАктивовОбязательств)
	|			И Данные.ВидСчетаДт В (&ПассивныеСчетаПриРеклассификации)
	|		ТОГДА ИСТИНА
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезКраткосрочныйСчет""
	|		ТОГДА ЛОЖЬ
	|		ИНАЧЕ ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Долгосрочная, ЛОЖЬ)
	|	КОНЕЦ КАК ДолгосрочныйДт,
	|	
	|	Данные.СчетДт КАК СчетДт,
	|	Данные.СубконтоДт1 КАК СубконтоДт1,
	|	Данные.СубконтоДт2 КАК СубконтоДт2,
	|	Данные.СубконтоДт3 КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	ВЫБОР
	|		КОГДА Данные.Сумма <> 0 И Данные.СуммаНУДт = 0 И Данные.СуммаПРДт = 0 И Данные.СуммаВРДт = 0
	|			ТОГДА Данные.Сумма
	|		ИНАЧЕ Данные.СуммаНУДт
	|	КОНЕЦ КАК СуммаНУДт,
	|	ВЫБОР
	|		КОГДА Данные.СуммаПРДт < 0 //отрицательная ПР отражается по правилам НУ
	|		ТОГДА Данные.СуммаПРДт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаПРДт,
	|	ВЫБОР
	|		КОГДА Данные.СуммаПРДт < 0
	|			ТОГДА -Данные.СуммаНУДт - Данные.СуммаПРДт
	|		КОГДА Данные.Сумма <> 0 И Данные.СуммаНУДт = 0 И Данные.СуммаПРДт = 0 И Данные.СуммаВРДт = 0
	|			ТОГДА -Данные.Сумма
	|		ИНАЧЕ -Данные.СуммаНУДт
	|	КОНЕЦ КАК СуммаВРДт,
	|	
	|	Данные.ВидСчетаКт КАК ВидСчетаКт,
	|	Данные.АналитикаУчетаКт КАК ОбъектУчетаКт,
	|	&АналитикаУчетаПереопределяемыйКт_НУ КАК АналитикаУчетаКт,
	|	&МестоУчетаПереопределяемыйКт КАК МестоУчетаКт,
	|	
	|	Данные.ВалютаКт                  КАК ВалютаКт,
	|	Данные.ПодразделениеКт           КАК ПодразделениеКт,
	|	ВЫБОР
	|		КОГДА Данные.ВидСчетаКт В (&ЗаполнятьВсегда)
	|		ТОГДА Данные.НаправлениеДеятельностиКт 
	|		КОГДА (Данные.ВидСчетаКт В (&УчетЗатрат) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетЗатрат, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДоходов, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетДенежныхСредств) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДенежныхСредствРаздельно, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетДенежныхСредств) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДенежныхСредствПоКорреспонденции, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетВнеоборотныхАктивов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетВнеоборотныхАктивов, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетРезервов) И ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.ГосударственныйКонтракт,
	|				ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка)) <> ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетРезервов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетЗатрат, ЛОЖЬ))
	|			ИЛИ Данные.ВидСчетаКт В (&НикогдаНеЗаполнять)
	|		ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|		ИНАЧЕ Данные.НаправлениеДеятельностиКт 
	|	КОНЕЦ КАК НаправлениеДеятельностиКт,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(Данные.Ссылка КАК Документ.РегламентнаяОперация).ТипОперации = ЗНАЧЕНИЕ(Перечисление.ТипыРегламентныхОпераций.РеклассификацияДолгосрочныхАктивовОбязательств)
	|			И Данные.ВидСчетаКт В (&АктивныеСчетаПриРеклассификации)
	|		ТОГДА ИСТИНА
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезКраткосрочныйСчет""
	|		ТОГДА ЛОЖЬ
	|		ИНАЧЕ ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Долгосрочная, ЛОЖЬ)
	|	КОНЕЦ КАК ДолгосрочныйКт,
	|	
	|	Данные.СчетКт КАК СчетКт,
	|	ВЫБОР
	|		КОГДА Данные.ВидСчетаКт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство) И НЕ &ДетализацияПроводок
	|			И ТИПЗНАЧЕНИЯ(Данные.СубконтоКт1) <> ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Данные.СубконтоКт1
	|	КОНЕЦ КАК СубконтоКт1,
	|	ВЫБОР
	|		КОГДА Данные.ВидСчетаКт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство) И НЕ &ДетализацияПроводок
	|			И ТИПЗНАЧЕНИЯ(Данные.СубконтоКт2) <> ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Данные.СубконтоКт2
	|	КОНЕЦ КАК СубконтоКт2,
	|	ВЫБОР
	|		КОГДА Данные.ВидСчетаКт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство) И НЕ &ДетализацияПроводок
	|			И ТИПЗНАЧЕНИЯ(Данные.СубконтоКт3) <> ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Данные.СубконтоКт3
	|	КОНЕЦ КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	ВЫБОР
	|		КОГДА Данные.Сумма <> 0 И Данные.СуммаНУКт = 0 И Данные.СуммаПРКт = 0 И Данные.СуммаВРКт = 0
	|			ТОГДА Данные.Сумма
	|		ИНАЧЕ Данные.СуммаНУКт
	|	КОНЕЦ КАК СуммаНУКт,
	|	ВЫБОР
	|		КОГДА Данные.СуммаПРКт < 0 //отрицательная ПР отражается по правилам НУ
	|		ТОГДА Данные.СуммаПРКт
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаПРКт,
	|	ВЫБОР
	|		КОГДА Данные.СуммаПРКт < 0
	|			ТОГДА -Данные.СуммаНУКт - Данные.СуммаПРКт
	|		КОГДА Данные.Сумма <> 0 И Данные.СуммаНУКт = 0 И Данные.СуммаПРКт = 0 И Данные.СуммаВРКт = 0
	|			ТОГДА -Данные.Сумма
	|		ИНАЧЕ -Данные.СуммаНУКт
	|	КОНЕЦ КАК СуммаВРКт,
	|	
	|	Данные.Содержание               КАК Содержание,
	|	Данные.Сторно                   КАК Сторно
	|	
	|ИЗ
	|	Данные КАК Данные
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РазрезыКОтражению КАК РазрезыКОтражению
	|	ПО
	|		Данные.Ссылка = РазрезыКОтражению.Ссылка
	|		И Данные.Организация =  РазрезыКОтражению.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = РазрезыКОтражению.ДатаОтражения
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВтДолгосрочнаяЗадолженность КАК ДолгосрочнаяЗадолженностьДт
	|	ПО
	|		Данные.Ссылка = ДолгосрочнаяЗадолженностьДт.Ссылка
	|		И Данные.Организация = ДолгосрочнаяЗадолженностьДт.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = ДолгосрочнаяЗадолженностьДт.ДатаОтражения
	|		И Данные.ВидСчетаДт = ДолгосрочнаяЗадолженностьДт.ВидСчета
	|		И Данные.АналитикаУчетаДт = ДолгосрочнаяЗадолженностьДт.АналитикаУчета
	|		И Данные.МестоУчетаДт = ДолгосрочнаяЗадолженностьДт.МестоУчета
	|		И Данные.ПодразделениеДт = ДолгосрочнаяЗадолженностьДт.Подразделение
	|		И Данные.НаправлениеДеятельностиДт = ДолгосрочнаяЗадолженностьДт.НаправлениеДеятельности
	|		И Данные.ВалютаДт = ДолгосрочнаяЗадолженностьДт.Валюта
	|		И Данные.СубконтоДт1 = ДолгосрочнаяЗадолженностьДт.Субконто1
	|		И Данные.СубконтоДт2 = ДолгосрочнаяЗадолженностьДт.Субконто2
	|		И ДолгосрочнаяЗадолженностьДт.ВидПроводкиДляПереноса В (НЕОПРЕДЕЛЕНО, ""Дт"")
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВтДолгосрочнаяЗадолженность КАК ДолгосрочнаяЗадолженностьКт
	|	ПО
	|		Данные.Ссылка = ДолгосрочнаяЗадолженностьКт.Ссылка
	|		И Данные.Организация = ДолгосрочнаяЗадолженностьКт.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = ДолгосрочнаяЗадолженностьКт.ДатаОтражения
	|		И Данные.ВидСчетаКт = ДолгосрочнаяЗадолженностьКт.ВидСчета
	|		И Данные.АналитикаУчетаКт = ДолгосрочнаяЗадолженностьКт.АналитикаУчета
	|		И Данные.МестоУчетаКт = ДолгосрочнаяЗадолженностьКт.МестоУчета
	|		И Данные.ПодразделениеКт = ДолгосрочнаяЗадолженностьКт.Подразделение
	|		И Данные.НаправлениеДеятельностиКт = ДолгосрочнаяЗадолженностьКт.НаправлениеДеятельности
	|		И Данные.ВалютаКт = ДолгосрочнаяЗадолженностьКт.Валюта
	|		И Данные.СубконтоКт1 = ДолгосрочнаяЗадолженностьКт.Субконто1
	|		И Данные.СубконтоКт2 = ДолгосрочнаяЗадолженностьКт.Субконто2
	|		И ДолгосрочнаяЗадолженностьКт.ВидПроводкиДляПереноса В (НЕОПРЕДЕЛЕНО, ""Кт"")
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		НастройкиСтатейРасходов КАК НастройкиСтатейРасходовДт
	|	ПО
	|		НастройкиСтатейРасходовДт.СтатьяРасходов = Данные.АналитикаУчетаДт
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		НастройкиСтатейРасходов КАК НастройкиСтатейРасходовКт
	|	ПО
	|		НастройкиСтатейРасходовКт.СтатьяРасходов = Данные.АналитикаУчетаКт
	|ГДЕ
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"")) В (""Основной"", ""ЧерезКраткосрочныйСчет"")
	|	И (ЕСТЬNULL(НастройкиСтатейРасходовДт.РаздельноеОтражение_НУ, ЛОЖЬ)
	|		ИЛИ ЕСТЬNULL(НастройкиСтатейРасходовКт.РаздельноеОтражение_НУ, ЛОЖЬ))
	|	И ВЫБОР КОГДА Данные.ВидСчетаДт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство) И Данные.ВидСчетаКт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|	ТОГДА Данные.МестоУчетаДт <> Данные.МестоУчетаКт ИЛИ Данные.НаправлениеДеятельностиДт <> Данные.НаправлениеДеятельностиКт
	|		ИЛИ (Данные.АналитикаУчетаДт <> Данные.АналитикаУчетаКт
	|		И НЕ (Данные.АналитикаУчетаДт = ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка) И Данные.АналитикаУчетаКт = НЕОПРЕДЕЛЕНО)
	|		И НЕ (Данные.АналитикаУчетаКт = ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка) И Данные.АналитикаУчетаДт = НЕОПРЕДЕЛЕНО))
	|	ИНАЧЕ ИСТИНА КОНЕЦ";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ЗапросУУ
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	Данные.Ссылка                       КАК Ссылка,
	|	Данные.Период                       КАК Период,
	|	НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ)  КАК ДатаОтражения,
	|	Данные.ИдентификаторСтроки          КАК ИдентификаторСтроки,
	|	
	|	Данные.Организация                  КАК Организация,
	|	
	|	0                                   КАК Сумма,
	|	Данные.СуммаУУ                      КАК СуммаУУ,
	|	
	|	Данные.ВидСчетаДт                   КАК ВидСчетаДт,
	|	Данные.АналитикаУчетаДт КАК ОбъектУчетаДт,
	|	&АналитикаУчетаПереопределяемыйДт_УУ КАК АналитикаУчетаДт,
	|	&МестоУчетаПереопределяемыйДт КАК МестоУчетаДт,
	|	
	|	Данные.ВалютаДт                     КАК ВалютаДт,
	|	Данные.ПодразделениеДт              КАК ПодразделениеДт,
	|	ВЫБОР
	|		КОГДА Данные.ВидСчетаДт В (&ЗаполнятьВсегда)
	|		ТОГДА Данные.НаправлениеДеятельностиДт
	|		КОГДА (Данные.ВидСчетаДт В (&УчетЗатрат) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетЗатрат, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДоходов, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетДенежныхСредств) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДенежныхСредствРаздельно, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетДенежныхСредств) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДенежныхСредствПоКорреспонденции, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетВнеоборотныхАктивов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетВнеоборотныхАктивов, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетРезервов) И ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.ГосударственныйКонтракт,
	|				ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка)) <> ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетРезервов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетЗатрат, ЛОЖЬ))
	|			ИЛИ Данные.ВидСчетаДт В (&НикогдаНеЗаполнять)
	|		ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|		ИНАЧЕ Данные.НаправлениеДеятельностиДт
	|	КОНЕЦ КАК НаправлениеДеятельностиДт,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(Данные.Ссылка КАК Документ.РегламентнаяОперация).ТипОперации = ЗНАЧЕНИЕ(Перечисление.ТипыРегламентныхОпераций.РеклассификацияДолгосрочныхАктивовОбязательств)
	|			И Данные.ВидСчетаДт В (&ПассивныеСчетаПриРеклассификации)
	|		ТОГДА ИСТИНА
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезКраткосрочныйСчет""
	|		ТОГДА ЛОЖЬ
	|		ИНАЧЕ ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Долгосрочная, ЛОЖЬ)
	|	КОНЕЦ КАК ДолгосрочныйДт,
	|	
	|	Данные.СчетДт      КАК СчетДт,
	|	Данные.СубконтоДт1 КАК СубконтоДт1,
	|	Данные.СубконтоДт2 КАК СубконтоДт2,
	|	Данные.СубконтоДт3 КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	Данные.ВидСчетаКт КАК ВидСчетаКт,
	|	Данные.АналитикаУчетаКт КАК ОбъектУчетаКт,
	|	&АналитикаУчетаПереопределяемыйКт_УУ КАК АналитикаУчетаКт,
	|	&МестоУчетаПереопределяемыйКт КАК МестоУчетаКт,
	|	
	|	Данные.ВалютаКт                  КАК ВалютаКт,
	|	Данные.ПодразделениеКт           КАК ПодразделениеКт,
	|	ВЫБОР
	|		КОГДА Данные.ВидСчетаКт В (&ЗаполнятьВсегда)
	|		ТОГДА Данные.НаправлениеДеятельностиКт 
	|		КОГДА (Данные.ВидСчетаКт В (&УчетЗатрат) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетЗатрат, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДоходов, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетДенежныхСредств) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДенежныхСредствРаздельно, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетДенежныхСредств) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДенежныхСредствПоКорреспонденции, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетВнеоборотныхАктивов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетВнеоборотныхАктивов, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетРезервов) И ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.ГосударственныйКонтракт,
	|				ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка)) <> ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетРезервов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетЗатрат, ЛОЖЬ))
	|			ИЛИ Данные.ВидСчетаКт В (&НикогдаНеЗаполнять)
	|		ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|		ИНАЧЕ Данные.НаправлениеДеятельностиКт 
	|	КОНЕЦ КАК НаправлениеДеятельностиКт,
	|	ВЫБОР
	|		КОГДА ВЫРАЗИТЬ(Данные.Ссылка КАК Документ.РегламентнаяОперация).ТипОперации = ЗНАЧЕНИЕ(Перечисление.ТипыРегламентныхОпераций.РеклассификацияДолгосрочныхАктивовОбязательств)
	|			И Данные.ВидСчетаКт В (&АктивныеСчетаПриРеклассификации)
	|		ТОГДА ИСТИНА
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезКраткосрочныйСчет""
	|		ТОГДА ЛОЖЬ
	|		ИНАЧЕ ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Долгосрочная, ЛОЖЬ)
	|	КОНЕЦ КАК ДолгосрочныйКт,
	|	
	|	Данные.СчетКт      КАК СчетКт,
	|	ВЫБОР
	|		КОГДА Данные.ВидСчетаКт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство) И НЕ &ДетализацияПроводок
	|			И ТИПЗНАЧЕНИЯ(Данные.СубконтоКт1) <> ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Данные.СубконтоКт1
	|	КОНЕЦ КАК СубконтоКт1,
	|	ВЫБОР
	|		КОГДА Данные.ВидСчетаКт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство) И НЕ &ДетализацияПроводок
	|			И ТИПЗНАЧЕНИЯ(Данные.СубконтоКт2) <> ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Данные.СубконтоКт2
	|	КОНЕЦ КАК СубконтоКт2,
	|	ВЫБОР
	|		КОГДА Данные.ВидСчетаКт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство) И НЕ &ДетализацияПроводок
	|			И ТИПЗНАЧЕНИЯ(Данные.СубконтоКт3) <> ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Данные.СубконтоКт3
	|	КОНЕЦ КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	
	|	Данные.Содержание  КАК Содержание,
	|	Данные.Сторно                   КАК Сторно
	|	
	|ИЗ
	|	Данные КАК Данные
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РазрезыКОтражению КАК РазрезыКОтражению
	|	ПО
	|		Данные.Ссылка = РазрезыКОтражению.Ссылка
	|		И Данные.Организация =  РазрезыКОтражению.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = РазрезыКОтражению.ДатаОтражения
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВтДолгосрочнаяЗадолженность КАК ДолгосрочнаяЗадолженностьДт
	|	ПО
	|		Данные.Ссылка = ДолгосрочнаяЗадолженностьДт.Ссылка
	|		И Данные.Организация = ДолгосрочнаяЗадолженностьДт.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = ДолгосрочнаяЗадолженностьДт.ДатаОтражения
	|		И Данные.ВидСчетаДт = ДолгосрочнаяЗадолженностьДт.ВидСчета
	|		И Данные.АналитикаУчетаДт = ДолгосрочнаяЗадолженностьДт.АналитикаУчета
	|		И Данные.МестоУчетаДт = ДолгосрочнаяЗадолженностьДт.МестоУчета
	|		И Данные.ПодразделениеДт = ДолгосрочнаяЗадолженностьДт.Подразделение
	|		И Данные.НаправлениеДеятельностиДт = ДолгосрочнаяЗадолженностьДт.НаправлениеДеятельности
	|		И Данные.ВалютаДт = ДолгосрочнаяЗадолженностьДт.Валюта
	|		И Данные.СубконтоДт1 = ДолгосрочнаяЗадолженностьДт.Субконто1
	|		И Данные.СубконтоДт2 = ДолгосрочнаяЗадолженностьДт.Субконто2
	|		И ДолгосрочнаяЗадолженностьДт.ВидПроводкиДляПереноса В (НЕОПРЕДЕЛЕНО, ""Дт"")
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВтДолгосрочнаяЗадолженность КАК ДолгосрочнаяЗадолженностьКт
	|	ПО
	|		Данные.Ссылка = ДолгосрочнаяЗадолженностьКт.Ссылка
	|		И Данные.Организация = ДолгосрочнаяЗадолженностьКт.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = ДолгосрочнаяЗадолженностьКт.ДатаОтражения
	|		И Данные.ВидСчетаКт = ДолгосрочнаяЗадолженностьКт.ВидСчета
	|		И Данные.АналитикаУчетаКт = ДолгосрочнаяЗадолженностьКт.АналитикаУчета
	|		И Данные.МестоУчетаКт = ДолгосрочнаяЗадолженностьКт.МестоУчета
	|		И Данные.ПодразделениеКт = ДолгосрочнаяЗадолженностьКт.Подразделение
	|		И Данные.НаправлениеДеятельностиКт = ДолгосрочнаяЗадолженностьКт.НаправлениеДеятельности
	|		И Данные.ВалютаКт = ДолгосрочнаяЗадолженностьКт.Валюта
	|		И Данные.СубконтоКт1 = ДолгосрочнаяЗадолженностьКт.Субконто1
	|		И Данные.СубконтоКт2 = ДолгосрочнаяЗадолженностьКт.Субконто2
	|		И ДолгосрочнаяЗадолженностьКт.ВидПроводкиДляПереноса В (НЕОПРЕДЕЛЕНО, ""Кт"")
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		НастройкиСтатейРасходов КАК НастройкиСтатейРасходовДт
	|	ПО
	|		НастройкиСтатейРасходовДт.СтатьяРасходов = Данные.АналитикаУчетаДт
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		НастройкиСтатейРасходов КАК НастройкиСтатейРасходовКт
	|	ПО
	|		НастройкиСтатейРасходовКт.СтатьяРасходов = Данные.АналитикаУчетаКт
	|ГДЕ
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"")) В (""Основной"", ""ЧерезКраткосрочныйСчет"")
	|	И &ВестиУУ И Данные.СуммаУУ <> 0
	|	И (ЕСТЬNULL(НастройкиСтатейРасходовДт.РаздельноеОтражение_УУ, ЛОЖЬ)
	|		ИЛИ ЕСТЬNULL(НастройкиСтатейРасходовКт.РаздельноеОтражение_УУ, ЛОЖЬ))
	|	И (&ДатаНачалаВеденияУУ <= Данные.Период
	|		ИЛИ ТИПЗНАЧЕНИЯ(Данные.Ссылка) В (&СписокТиповВводаОстатков))
	|	И ВЫБОР КОГДА Данные.ВидСчетаДт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство) И Данные.ВидСчетаКт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|	ТОГДА Данные.МестоУчетаДт <> Данные.МестоУчетаКт ИЛИ Данные.НаправлениеДеятельностиДт <> Данные.НаправлениеДеятельностиКт
	|		ИЛИ (Данные.АналитикаУчетаДт <> Данные.АналитикаУчетаКт
	|		И НЕ (Данные.АналитикаУчетаДт = ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка) И Данные.АналитикаУчетаКт = НЕОПРЕДЕЛЕНО)
	|		И НЕ (Данные.АналитикаУчетаКт = ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка) И Данные.АналитикаУчетаДт = НЕОПРЕДЕЛЕНО))
	|	ИНАЧЕ ИСТИНА КОНЕЦ";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ТекстЗапросаПереносаЗадолженностиСРасчетовСПартнерамиНаТранзитныйСчет
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	Данные.Ссылка                       КАК Ссылка,
	|	Данные.Период                       КАК Период,
	|	НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ)  КАК ДатаОтражения,
	|	Данные.ИдентификаторСтроки          КАК ИдентификаторСтроки,
	|	
	|	Данные.Организация                  КАК Организация,
	|	
	|	Данные.Сумма                        КАК Сумма,
	|	ВЫБОР
	|		КОГДА &ВестиУУ И (&ДатаНачалаВеденияУУ <= Данные.Период
	|			ИЛИ ТИПЗНАЧЕНИЯ(Данные.Ссылка) В (&СписокТиповВводаОстатков))
	|		ТОГДА Данные.СуммаУУ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаУУ,
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.ВидСчетаДт
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПереносДолгосрочнойЗадолженности)
	|	КОНЕЦ КАК ВидСчетаДт,
	|	Данные.АналитикаУчетаДт КАК ОбъектУчетаДт,
	|	&АналитикаУчетаПереопределяемыйДт КАК АналитикаУчетаДт,
	|	&МестоУчетаПереопределяемыйДт КАК МестоУчетаДт,
	|	
	|	Данные.ВалютаДт                     КАК ВалютаДт,
	|	Данные.ПодразделениеДт              КАК ПодразделениеДт,
	|	ВЫБОР
	|		КОГДА Данные.ВидСчетаДт В (&ЗаполнятьВсегда)
	|		ТОГДА Данные.НаправлениеДеятельностиДт
	|		КОГДА (Данные.ВидСчетаДт В (&УчетЗатрат) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетЗатрат, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДоходов, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетДенежныхСредств) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДенежныхСредствРаздельно, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетДенежныхСредств) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДенежныхСредствПоКорреспонденции, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетВнеоборотныхАктивов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетВнеоборотныхАктивов, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетРезервов) И ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.ГосударственныйКонтракт,
	|				ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка)) <> ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетРезервов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетЗатрат, ЛОЖЬ))
	|			ИЛИ Данные.ВидСчетаДт В (&НикогдаНеЗаполнять)
	|		ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|		ИНАЧЕ Данные.НаправлениеДеятельностиДт
	|	КОНЕЦ КАК НаправлениеДеятельностиДт,
	|	ЛОЖЬ КАК ДолгосрочныйДт,
	|	
	|	Данные.СчетДт КАК СчетДт,
	|	Данные.СубконтоДт1 КАК СубконтоДт1,
	|	Данные.СубконтоДт2 КАК СубконтоДт2,
	|	Данные.СубконтоДт3 КАК СубконтоДт3,
	|	
	|	Данные.ВалютнаяСуммаДт           КАК ВалютнаяСуммаДт,
	|	Данные.КоличествоДт              КАК КоличествоДт,
	|	Данные.СуммаНУДт                 КАК СуммаНУДт,
	|	Данные.СуммаПРДт                 КАК СуммаПРДт,
	|	Данные.СуммаВРДт                 КАК СуммаВРДт,
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.ВидСчетаКт
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПереносДолгосрочнойЗадолженности)
	|	КОНЕЦ КАК ВидСчетаКт,
	|	Данные.АналитикаУчетаКт КАК ОбъектУчетаКт,
	|	&АналитикаУчетаПереопределяемыйКт КАК АналитикаУчетаКт,
	|	&МестоУчетаПереопределяемыйКт КАК МестоУчетаКт,
	|	
	|	Данные.ВалютаКт                  КАК ВалютаКт,
	|	Данные.ПодразделениеКт           КАК ПодразделениеКт,
	|	ВЫБОР
	|		КОГДА Данные.ВидСчетаКт В (&ЗаполнятьВсегда)
	|		ТОГДА Данные.НаправлениеДеятельностиКт 
	|		КОГДА (Данные.ВидСчетаКт В (&УчетЗатрат) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетЗатрат, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДоходов, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетДенежныхСредств) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДенежныхСредствРаздельно, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетДенежныхСредств) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДенежныхСредствПоКорреспонденции, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетВнеоборотныхАктивов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетВнеоборотныхАктивов, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетРезервов) И ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.ГосударственныйКонтракт,
	|				ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка)) <> ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетРезервов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетЗатрат, ЛОЖЬ))
	|			ИЛИ Данные.ВидСчетаКт В (&НикогдаНеЗаполнять)
	|		ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|		ИНАЧЕ Данные.НаправлениеДеятельностиКт 
	|	КОНЕЦ КАК НаправлениеДеятельностиКт,
	|	ЛОЖЬ КАК ДолгосрочныйКт,
	|	
	|	Данные.СчетКт КАК СчетКт,
	|	Данные.СубконтоКт1 КАК СубконтоКт1,
	|	Данные.СубконтоКт2 КАК СубконтоКт2,
	|	Данные.СубконтоКт3 КАК СубконтоКт3,
	|	
	|	Данные.ВалютнаяСуммаКт          КАК ВалютнаяСуммаКт,
	|	Данные.КоличествоКт             КАК КоличествоКт,
	|	Данные.СуммаНУКт                КАК СуммаНУКт,
	|	Данные.СуммаПРКт                КАК СуммаПРКт,
	|	Данные.СуммаВРКт                КАК СуммаВРКт,
	|	
	|	Данные.Содержание               КАК Содержание,
	|	Данные.Сторно                   КАК Сторно
	|ИЗ
	|	Данные КАК Данные
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РазрезыКОтражению КАК РазрезыКОтражению
	|	ПО
	|		Данные.Ссылка = РазрезыКОтражению.Ссылка
	|		И Данные.Организация =  РазрезыКОтражению.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = РазрезыКОтражению.ДатаОтражения
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВтДолгосрочнаяЗадолженность КАК ДолгосрочнаяЗадолженностьДт
	|	ПО
	|		Данные.Ссылка = ДолгосрочнаяЗадолженностьДт.Ссылка
	|		И Данные.Организация = ДолгосрочнаяЗадолженностьДт.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = ДолгосрочнаяЗадолженностьДт.ДатаОтражения
	|		И Данные.ВидСчетаДт = ДолгосрочнаяЗадолженностьДт.ВидСчета
	|		И Данные.АналитикаУчетаДт = ДолгосрочнаяЗадолженностьДт.АналитикаУчета
	|		И Данные.МестоУчетаДт = ДолгосрочнаяЗадолженностьДт.МестоУчета
	|		И Данные.ПодразделениеДт = ДолгосрочнаяЗадолженностьДт.Подразделение
	|		И Данные.НаправлениеДеятельностиДт = ДолгосрочнаяЗадолженностьДт.НаправлениеДеятельности
	|		И Данные.ВалютаДт = ДолгосрочнаяЗадолженностьДт.Валюта
	|		И Данные.СубконтоДт1 = ДолгосрочнаяЗадолженностьДт.Субконто1
	|		И Данные.СубконтоДт2 = ДолгосрочнаяЗадолженностьДт.Субконто2
	|		И ДолгосрочнаяЗадолженностьДт.ВидПроводкиДляПереноса В (НЕОПРЕДЕЛЕНО, ""Дт"")
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВтДолгосрочнаяЗадолженность КАК ДолгосрочнаяЗадолженностьКт
	|	ПО
	|		Данные.Ссылка = ДолгосрочнаяЗадолженностьКт.Ссылка
	|		И Данные.Организация = ДолгосрочнаяЗадолженностьКт.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = ДолгосрочнаяЗадолженностьКт.ДатаОтражения
	|		И Данные.ВидСчетаКт = ДолгосрочнаяЗадолженностьКт.ВидСчета
	|		И Данные.АналитикаУчетаКт = ДолгосрочнаяЗадолженностьКт.АналитикаУчета
	|		И Данные.МестоУчетаКт = ДолгосрочнаяЗадолженностьКт.МестоУчета
	|		И Данные.ПодразделениеКт = ДолгосрочнаяЗадолженностьКт.Подразделение
	|		И Данные.НаправлениеДеятельностиКт = ДолгосрочнаяЗадолженностьКт.НаправлениеДеятельности
	|		И Данные.ВалютаКт = ДолгосрочнаяЗадолженностьКт.Валюта
	|		И Данные.СубконтоКт1 = ДолгосрочнаяЗадолженностьКт.Субконто1
	|		И Данные.СубконтоКт2 = ДолгосрочнаяЗадолженностьКт.Субконто2
	|		И ДолгосрочнаяЗадолженностьКт.ВидПроводкиДляПереноса В (НЕОПРЕДЕЛЕНО, ""Кт"")
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		НастройкиСтатейРасходов КАК НастройкиСтатейРасходовДт
	|	ПО
	|		НастройкиСтатейРасходовДт.СтатьяРасходов = Данные.АналитикаУчетаДт
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		НастройкиСтатейРасходов КАК НастройкиСтатейРасходовКт
	|	ПО
	|		НастройкиСтатейРасходовКт.СтатьяРасходов = Данные.АналитикаУчетаКт
	|
	|ГДЕ
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|	И Данные.ВидСчетаДт В (&СчетаДляТранзитаДолгосрочнойЗадолженности)
	|	И НЕ Данные.ВидСчетаКт В (&СчетаДляТранзитаДолгосрочнойЗадолженности)
	|	ИЛИ ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|	И Данные.ВидСчетаКт В (&СчетаДляТранзитаДолгосрочнойЗадолженности)
	|	И НЕ Данные.ВидСчетаДт В (&СчетаДляТранзитаДолгосрочнойЗадолженности)";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ТекстЗапросаПереносаЗадолженностиСТранзитногоСчетаНаРасчетыСПартнерами
	ТекстЗапросаШаблон =
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	Данные.Ссылка                       КАК Ссылка,
	|	Данные.Период                       КАК Период,
	|	НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ)  КАК ДатаОтражения,
	|	Данные.ИдентификаторСтроки          КАК ИдентификаторСтроки,
	|	
	|	Данные.Организация                  КАК Организация,
	|	
	|	ВЫБОР
	|		КОГДА (Данные.Сумма < 0)
	|			ТОГДА &МножительПереопределяемый * Данные.Сумма + (-1) * (&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0)) + (-1) * (&ЗнакРазделениеПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаРегл, 0)) 
	|		ИНАЧЕ
	|			&МножительПереопределяемый * Данные.Сумма + (&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0)) + (&ЗнакРазделениеПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаРегл, 0)) 
	|	КОНЕЦ КАК Сумма,
	|	ВЫБОР
	|		КОГДА &ВестиУУ И (&ДатаНачалаВеденияУУ <= Данные.Период
	|			ИЛИ ТИПЗНАЧЕНИЯ(Данные.Ссылка) В (&СписокТиповВводаОстатков))
	|		ТОГДА 
	|			ВЫБОР
	|				КОГДА (Данные.СуммаУУ < 0)
	|					ТОГДА &МножительПереопределяемый * Данные.СуммаУУ + (-1) * (&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаУпр, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаУпр, 0)) + (-1) *(&ЗнакРазделениеПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаУпр, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаУпр, 0))
	|				ИНАЧЕ
	|					&МножительПереопределяемый * Данные.СуммаУУ + (&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаУпр, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаУпр, 0)) + (&ЗнакРазделениеПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаУпр, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаУпр, 0))
	|			КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаУУ,
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПереносДолгосрочнойЗадолженности)
	|		ИНАЧЕ Данные.ВидСчетаДт
	|	КОНЕЦ КАК ВидСчетаДт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.АналитикаУчетаКт
	|		ИНАЧЕ Данные.АналитикаУчетаДт
	|	КОНЕЦ КАК ОбъектУчетаДт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА &АналитикаУчетаПереопределяемыйКт
	|		ИНАЧЕ &АналитикаУчетаПереопределяемыйДт
	|	КОНЕЦ КАК АналитикаУчетаДт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА &МестоУчетаПереопределяемыйКт
	|		ИНАЧЕ &МестоУчетаПереопределяемыйДт
	|	КОНЕЦ КАК МестоУчетаДт,
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.ВалютаКт
	|		ИНАЧЕ Данные.ВалютаДт
	|	КОНЕЦ КАК ВалютаДт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.ПодразделениеКт
	|		ИНАЧЕ Данные.ПодразделениеДт
	|	КОНЕЦ КАК ПодразделениеДт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА ВЫБОР
	|				КОГДА Данные.ВидСчетаКт В (&ЗаполнятьВсегда)
	|				ТОГДА Данные.НаправлениеДеятельностиКт
	|				КОГДА (Данные.ВидСчетаКт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДоходов, ЛОЖЬ))
	|					ИЛИ (Данные.ВидСчетаКт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|					ИЛИ Данные.ВидСчетаКт В (&НикогдаНеЗаполнять)
	|				ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|				ИНАЧЕ Данные.НаправлениеДеятельностиКт КОНЕЦ
	|		ИНАЧЕ ВЫБОР
	|				КОГДА Данные.ВидСчетаДт В (&ЗаполнятьВсегда)
	|				ТОГДА Данные.НаправлениеДеятельностиДт
	|				КОГДА (Данные.ВидСчетаДт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДоходов, ЛОЖЬ))
	|					ИЛИ (Данные.ВидСчетаДт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|					ИЛИ Данные.ВидСчетаДт В (&НикогдаНеЗаполнять)
	|				ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|				ИНАЧЕ Данные.НаправлениеДеятельностиДт КОНЕЦ
	|	КОНЕЦ КАК НаправлениеДеятельностиДт,
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Долгосрочная, ЛОЖЬ) И &ПереносСуммыЗадолженности КАК ДолгосрочныйДт,
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СчетКт
	|		ИНАЧЕ Данные.СчетДт
	|	КОНЕЦ КАК СчетДт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СубконтоКт1
	|		ИНАЧЕ Данные.СубконтоДт1
	|	КОНЕЦ КАК СубконтоДт1,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СубконтоКт2
	|		ИНАЧЕ Данные.СубконтоДт2
	|	КОНЕЦ КАК СубконтоДт2,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СубконтоКт3
	|		ИНАЧЕ Данные.СубконтоДт3
	|	КОНЕЦ КАК СубконтоДт3,
	|	
	|	СУММА(&МножительПереопределяемый * ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА (Данные.ВалютнаяСуммаКт)
	|		ИНАЧЕ (Данные.ВалютнаяСуммаДт)
	|	КОНЕЦ) + ВЫБОР
	|				КОГДА СУММА(ВЫБОР
	|							КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|								ТОГДА (Данные.ВалютнаяСуммаКт)
	|							ИНАЧЕ (Данные.ВалютнаяСуммаДт) 
	|							КОНЕЦ) < 0
	|					ТОГДА (-1) * (&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Сумма, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Сумма, 0)) + (-1) * (&ЗнакРазделениеПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.Сумма, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.Сумма, 0))
	|				ИНАЧЕ
	|					(&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Сумма, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Сумма, 0)) + (&ЗнакРазделениеПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.Сумма, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.Сумма, 0))
	|				КОНЕЦ КАК ВалютнаяСуммаДт,
	|	СУММА(ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.КоличествоКт
	|		ИНАЧЕ Данные.КоличествоДт
	|	КОНЕЦ) КАК КоличествоДт,
	|	ВЫБОР
	|		КОГДА (Данные.Сумма < 0)
	|			ТОГДА &МножительПереопределяемый * Данные.Сумма + (-1) * (&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0))
	|		ИНАЧЕ
	|			&МножительПереопределяемый * Данные.Сумма + (&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0)) 
	|	КОНЕЦ КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	ВЫБОР
	|		КОГДА (Данные.Сумма < 0)
	|			ТОГДА (-1) * (&ЗнакРазделениеКраткосрочныйПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаРегл, 0))
	|		ИНАЧЕ (&ЗнакРазделениеКраткосрочныйПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаРегл, 0)) 
	|	КОНЕЦ КАК СуммаВРДт,
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПереносДолгосрочнойЗадолженности)
	|		ИНАЧЕ Данные.ВидСчетаКт
	|	КОНЕЦ КАК ВидСчетаКт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.АналитикаУчетаДт
	|		ИНАЧЕ Данные.АналитикаУчетаКт
	|	КОНЕЦ КАК ОбъектУчетаКт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА &АналитикаУчетаПереопределяемыйДт
	|		ИНАЧЕ &АналитикаУчетаПереопределяемыйКт
	|	КОНЕЦ КАК АналитикаУчетаКт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА &МестоУчетаПереопределяемыйДт
	|		ИНАЧЕ &МестоУчетаПереопределяемыйКт
	|	КОНЕЦ КАК МестоУчетаКт,
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.ВалютаДт
	|		ИНАЧЕ Данные.ВалютаКт
	|	КОНЕЦ КАК ВалютаКт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.ПодразделениеДт
	|		ИНАЧЕ Данные.ПодразделениеКт
	|	КОНЕЦ КАК ПодразделениеКт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА ВЫБОР
	|				КОГДА Данные.ВидСчетаДт В (&ЗаполнятьВсегда)
	|				ТОГДА Данные.НаправлениеДеятельностиДт
	|				КОГДА (Данные.ВидСчетаДт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДоходов, ЛОЖЬ))
	|					ИЛИ (Данные.ВидСчетаДт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|					ИЛИ Данные.ВидСчетаДт В (&НикогдаНеЗаполнять)
	|				ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|				ИНАЧЕ Данные.НаправлениеДеятельностиДт КОНЕЦ
	|		ИНАЧЕ ВЫБОР
	|				КОГДА Данные.ВидСчетаКт В (&ЗаполнятьВсегда)
	|				ТОГДА Данные.НаправлениеДеятельностиКт
	|				КОГДА (Данные.ВидСчетаКт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДоходов, ЛОЖЬ))
	|					ИЛИ (Данные.ВидСчетаКт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|					ИЛИ Данные.ВидСчетаКт В (&НикогдаНеЗаполнять)
	|				ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|				ИНАЧЕ Данные.НаправлениеДеятельностиКт КОНЕЦ
	|	КОНЕЦ КАК НаправлениеДеятельностиКт,
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Долгосрочная, ЛОЖЬ) КАК ДолгосрочныйКт,
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СчетДт
	|		ИНАЧЕ Данные.СчетКт
	|	КОНЕЦ КАК СчетКт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СубконтоДт1
	|		ИНАЧЕ Данные.СубконтоКт1
	|	КОНЕЦ КАК СубконтоКт1,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СубконтоДт2
	|		ИНАЧЕ Данные.СубконтоКт2
	|	КОНЕЦ КАК СубконтоКт2,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СубконтоДт3
	|		ИНАЧЕ Данные.СубконтоКт3
	|	КОНЕЦ КАК СубконтоКт3,
	|	
	|	СУММА(&МножительПереопределяемый * ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА (Данные.ВалютнаяСуммаДт)
	|		ИНАЧЕ (Данные.ВалютнаяСуммаКт)
	|	КОНЕЦ) + ВЫБОР
	|				КОГДА СУММА(ВЫБОР
	|							КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|								ТОГДА (Данные.ВалютнаяСуммаКт)
	|							ИНАЧЕ (Данные.ВалютнаяСуммаДт) 
	|							КОНЕЦ) < 0
	|					ТОГДА (-1) * (&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Сумма, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Сумма, 0)) + (-1) * (&ЗнакРазделениеПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.Сумма, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.Сумма, 0))
	|				ИНАЧЕ
	|					(&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Сумма, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Сумма, 0)) + (&ЗнакРазделениеПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.Сумма, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.Сумма, 0))
	|				КОНЕЦ КАК ВалютнаяСуммаКт,
	|	СУММА(ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.КоличествоДт
	|		ИНАЧЕ Данные.КоличествоКт
	|	КОНЕЦ) КАК КоличествоКт,
	|	ВЫБОР
	|		КОГДА (Данные.Сумма < 0)
	|			ТОГДА &МножительПереопределяемый * Данные.Сумма + (-1) * (&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0))
	|		ИНАЧЕ
	|			&МножительПереопределяемый * Данные.Сумма + (&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0)) 
	|	КОНЕЦ КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	ВЫБОР
	|		КОГДА (Данные.Сумма < 0)
	|			ТОГДА (-1) * (&ЗнакРазделениеКраткосрочныйПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаРегл, 0))
	|		ИНАЧЕ (&ЗнакРазделениеКраткосрочныйПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаРегл, 0))
	|	КОНЕЦ КАК СуммаВРКт,
	|	
	|	""Перенос задолженности с транзитного на долгосрочный счет"" КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|
	|ИЗ
	|	Данные КАК Данные
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РазрезыКОтражению КАК РазрезыКОтражению
	|	ПО
	|		Данные.Ссылка = РазрезыКОтражению.Ссылка
	|		И Данные.Организация =  РазрезыКОтражению.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = РазрезыКОтражению.ДатаОтражения
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВтДолгосрочнаяЗадолженность КАК ДолгосрочнаяЗадолженностьДт
	|	ПО
	|		Данные.Ссылка = ДолгосрочнаяЗадолженностьДт.Ссылка
	|		И Данные.Организация = ДолгосрочнаяЗадолженностьДт.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = ДолгосрочнаяЗадолженностьДт.ДатаОтражения
	|		И Данные.ВидСчетаДт = ДолгосрочнаяЗадолженностьДт.ВидСчета
	|		И Данные.АналитикаУчетаДт = ДолгосрочнаяЗадолженностьДт.АналитикаУчета
	|		И Данные.МестоУчетаДт = ДолгосрочнаяЗадолженностьДт.МестоУчета
	|		И Данные.ПодразделениеДт = ДолгосрочнаяЗадолженностьДт.Подразделение
	|		И Данные.НаправлениеДеятельностиДт = ДолгосрочнаяЗадолженностьДт.НаправлениеДеятельности
	|		И Данные.ВалютаДт = ДолгосрочнаяЗадолженностьДт.Валюта
	|		И Данные.СубконтоДт1 = ДолгосрочнаяЗадолженностьДт.Субконто1
	|		И Данные.СубконтоДт2 = ДолгосрочнаяЗадолженностьДт.Субконто2
	|		И ДолгосрочнаяЗадолженностьДт.ВидПроводкиДляПереноса В (НЕОПРЕДЕЛЕНО, ""Дт"")
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВтДолгосрочнаяЗадолженность КАК ДолгосрочнаяЗадолженностьКт
	|	ПО
	|		Данные.Ссылка = ДолгосрочнаяЗадолженностьКт.Ссылка
	|		И Данные.Организация = ДолгосрочнаяЗадолженностьКт.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = ДолгосрочнаяЗадолженностьКт.ДатаОтражения
	|		И Данные.ВидСчетаКт = ДолгосрочнаяЗадолженностьКт.ВидСчета
	|		И Данные.АналитикаУчетаКт = ДолгосрочнаяЗадолженностьКт.АналитикаУчета
	|		И Данные.МестоУчетаКт = ДолгосрочнаяЗадолженностьКт.МестоУчета
	|		И Данные.ПодразделениеКт = ДолгосрочнаяЗадолженностьКт.Подразделение
	|		И Данные.НаправлениеДеятельностиКт = ДолгосрочнаяЗадолженностьКт.НаправлениеДеятельности
	|		И Данные.ВалютаКт = ДолгосрочнаяЗадолженностьКт.Валюта
	|		И Данные.СубконтоКт1 = ДолгосрочнаяЗадолженностьКт.Субконто1
	|		И Данные.СубконтоКт2 = ДолгосрочнаяЗадолженностьКт.Субконто2
	|		И ДолгосрочнаяЗадолженностьКт.ВидПроводкиДляПереноса В (НЕОПРЕДЕЛЕНО, ""Кт"")
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВтДолгосрочнаяЗадолженность КАК ДолгосрочнаяЗадолженностьРазделениеДт
	|	ПО
	|		Данные.Ссылка = ДолгосрочнаяЗадолженностьРазделениеДт.Ссылка
	|		И Данные.Организация = ДолгосрочнаяЗадолженностьРазделениеДт.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = ДолгосрочнаяЗадолженностьРазделениеДт.ДатаОтражения
	|		И Данные.ВидСчетаДт = ДолгосрочнаяЗадолженностьРазделениеДт.ВидСчета
	|		И Данные.АналитикаУчетаДт = ДолгосрочнаяЗадолженностьРазделениеДт.АналитикаУчета
	|		И Данные.МестоУчетаДт = ДолгосрочнаяЗадолженностьРазделениеДт.МестоУчета
	|		И Данные.ПодразделениеДт = ДолгосрочнаяЗадолженностьРазделениеДт.Подразделение
	|		И Данные.НаправлениеДеятельностиДт = ДолгосрочнаяЗадолженностьРазделениеДт.НаправлениеДеятельности
	|		И Данные.ВалютаДт = ДолгосрочнаяЗадолженностьРазделениеДт.Валюта
	|		И Данные.СубконтоДт1 = ДолгосрочнаяЗадолженностьРазделениеДт.Субконто1
	|		И Данные.СубконтоДт2 = ДолгосрочнаяЗадолженностьРазделениеДт.Субконто2
	|		И ДолгосрочнаяЗадолженностьРазделениеДт.ВидПроводкиДляПереноса В (НЕОПРЕДЕЛЕНО, ""Дт"")
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВтДолгосрочнаяЗадолженность КАК ДолгосрочнаяЗадолженностьРазделениеКт
	|	ПО
	|		Данные.Ссылка = ДолгосрочнаяЗадолженностьРазделениеКт.Ссылка
	|		И Данные.Организация = ДолгосрочнаяЗадолженностьРазделениеКт.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = ДолгосрочнаяЗадолженностьРазделениеКт.ДатаОтражения
	|		И Данные.ВидСчетаКт = ДолгосрочнаяЗадолженностьРазделениеКт.ВидСчета
	|		И Данные.АналитикаУчетаКт = ДолгосрочнаяЗадолженностьРазделениеКт.АналитикаУчета
	|		И Данные.МестоУчетаКт = ДолгосрочнаяЗадолженностьРазделениеКт.МестоУчета
	|		И Данные.ПодразделениеКт = ДолгосрочнаяЗадолженностьРазделениеКт.Подразделение
	|		И Данные.НаправлениеДеятельностиКт = ДолгосрочнаяЗадолженностьРазделениеКт.НаправлениеДеятельности
	|		И Данные.ВалютаКт = ДолгосрочнаяЗадолженностьРазделениеКт.Валюта
	|		И Данные.СубконтоКт1 = ДолгосрочнаяЗадолженностьРазделениеКт.Субконто1
	|		И Данные.СубконтоКт2 = ДолгосрочнаяЗадолженностьРазделениеКт.Субконто2
	|		И ДолгосрочнаяЗадолженностьРазделениеКт.ВидПроводкиДляПереноса В (НЕОПРЕДЕЛЕНО, ""Кт"")
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		НастройкиСтатейРасходов КАК НастройкиСтатейРасходовДт
	|	ПО
	|		НастройкиСтатейРасходовДт.СтатьяРасходов = Данные.АналитикаУчетаДт
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		НастройкиСтатейРасходов КАК НастройкиСтатейРасходовКт
	|	ПО
	|		НастройкиСтатейРасходовКт.СтатьяРасходов = Данные.АналитикаУчетаКт
	|
	|ГДЕ
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|	И Данные.ВидСчетаДт В (&СчетаДляТранзитаДолгосрочнойЗадолженности)
	|	И НЕ Данные.ВидСчетаКт В (&СчетаДляТранзитаДолгосрочнойЗадолженности)
	|	И &ПереносСуммыЗадолженности
	|	ИЛИ ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|	И Данные.ВидСчетаКт В (&СчетаДляТранзитаДолгосрочнойЗадолженности)
	|	И НЕ Данные.ВидСчетаДт В (&СчетаДляТранзитаДолгосрочнойЗадолженности)
	|	И &ПереносСуммыЗадолженности
	|	ИЛИ ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.ВариантПереноса, ""Основной"") = ""Разделение""
	|	И Данные.ВидСчетаДт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПроцентыПоДисконтированию)
	|	И &ПереносЗадолженностиРазделением
	|	ИЛИ ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.ВариантПереноса, ""Основной"") = ""Разделение""
	|	И Данные.ВидСчетаКт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПроцентыПоДисконтированию)
	|	И &ПереносЗадолженностиРазделением
	|
	|СГРУППИРОВАТЬ ПО
	|	Данные.Ссылка,
	|	Данные.Период,
	|	Данные.ИдентификаторСтроки,
	|	Данные.Организация,
	|	ВЫБОР
	|		КОГДА (Данные.Сумма < 0)
	|			ТОГДА &МножительПереопределяемый * Данные.Сумма + (-1) * (&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0)) + (-1) *(&ЗнакРазделениеПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаРегл, 0)) 
	|		ИНАЧЕ
	|			&МножительПереопределяемый * Данные.Сумма + (&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0)) + (&ЗнакРазделениеПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаРегл, 0)) 
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА &ВестиУУ И (&ДатаНачалаВеденияУУ <= Данные.Период
	|			ИЛИ ТИПЗНАЧЕНИЯ(Данные.Ссылка) В (&СписокТиповВводаОстатков))
	|		ТОГДА 
	|			ВЫБОР
	|				КОГДА (Данные.СуммаУУ < 0)
	|					ТОГДА &МножительПереопределяемый * Данные.СуммаУУ + (-1) * (&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаУпр, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаУпр, 0)) + (-1) *(&ЗнакРазделениеПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаУпр, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаУпр, 0))
	|				ИНАЧЕ
	|					&МножительПереопределяемый * Данные.СуммаУУ + (&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаУпр, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаУпр, 0)) + (&ЗнакРазделениеПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаУпр, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаУпр, 0))
	|			КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПереносДолгосрочнойЗадолженности)
	|		ИНАЧЕ Данные.ВидСчетаДт
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.АналитикаУчетаКт
	|		ИНАЧЕ Данные.АналитикаУчетаДт
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА &АналитикаУчетаПереопределяемыйКт
	|		ИНАЧЕ &АналитикаУчетаПереопределяемыйДт
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА &МестоУчетаПереопределяемыйКт
	|		ИНАЧЕ &МестоУчетаПереопределяемыйДт
	|	КОНЕЦ,
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.ВалютаКт
	|		ИНАЧЕ Данные.ВалютаДт
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.ПодразделениеКт
	|		ИНАЧЕ Данные.ПодразделениеДт
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА ВЫБОР
	|				КОГДА Данные.ВидСчетаКт В (&ЗаполнятьВсегда)
	|				ТОГДА Данные.НаправлениеДеятельностиКт
	|				КОГДА (Данные.ВидСчетаКт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДоходов, ЛОЖЬ))
	|					ИЛИ (Данные.ВидСчетаКт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|					ИЛИ Данные.ВидСчетаКт В (&НикогдаНеЗаполнять)
	|				ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|				ИНАЧЕ Данные.НаправлениеДеятельностиКт КОНЕЦ
	|		ИНАЧЕ ВЫБОР
	|				КОГДА Данные.ВидСчетаДт В (&ЗаполнятьВсегда)
	|				ТОГДА Данные.НаправлениеДеятельностиДт
	|				КОГДА (Данные.ВидСчетаДт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДоходов, ЛОЖЬ))
	|					ИЛИ (Данные.ВидСчетаДт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|					ИЛИ Данные.ВидСчетаДт В (&НикогдаНеЗаполнять)
	|				ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|				ИНАЧЕ Данные.НаправлениеДеятельностиДт КОНЕЦ
	|	КОНЕЦ,
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Долгосрочная, ЛОЖЬ) И &ПереносСуммыЗадолженности,
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СчетКт
	|		ИНАЧЕ Данные.СчетДт
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СубконтоКт1
	|		ИНАЧЕ Данные.СубконтоДт1
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СубконтоКт2
	|		ИНАЧЕ Данные.СубконтоДт2
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СубконтоКт3
	|		ИНАЧЕ Данные.СубконтоДт3
	|	КОНЕЦ,
	|
	|	ВЫБОР
	|		КОГДА (Данные.Сумма < 0)
	|			ТОГДА &МножительПереопределяемый * Данные.Сумма + (-1) * (&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0))
	|		ИНАЧЕ
	|			&МножительПереопределяемый * Данные.Сумма + (&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0)) 
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА (Данные.Сумма < 0)
	|			ТОГДА (-1) * (&ЗнакРазделениеКраткосрочныйПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаРегл, 0))
	|		ИНАЧЕ (&ЗнакРазделениеКраткосрочныйПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаРегл, 0)) 
	|	КОНЕЦ,
	|	
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет"",
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет"",
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПереносДолгосрочнойЗадолженности)
	|		ИНАЧЕ Данные.ВидСчетаКт
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.АналитикаУчетаДт
	|		ИНАЧЕ Данные.АналитикаУчетаКт
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА &АналитикаУчетаПереопределяемыйДт
	|		ИНАЧЕ &АналитикаУчетаПереопределяемыйКт
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА &МестоУчетаПереопределяемыйДт
	|		ИНАЧЕ &МестоУчетаПереопределяемыйКт
	|	КОНЕЦ,
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.ВалютаДт
	|		ИНАЧЕ Данные.ВалютаКт
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.ПодразделениеДт
	|		ИНАЧЕ Данные.ПодразделениеКт
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА ВЫБОР
	|				КОГДА Данные.ВидСчетаДт В (&ЗаполнятьВсегда)
	|				ТОГДА Данные.НаправлениеДеятельностиДт
	|				КОГДА (Данные.ВидСчетаДт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДоходов, ЛОЖЬ))
	|					ИЛИ (Данные.ВидСчетаДт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|					ИЛИ Данные.ВидСчетаДт В (&НикогдаНеЗаполнять)
	|				ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|				ИНАЧЕ Данные.НаправлениеДеятельностиДт КОНЕЦ
	|		ИНАЧЕ ВЫБОР
	|				КОГДА Данные.ВидСчетаКт В (&ЗаполнятьВсегда)
	|				ТОГДА Данные.НаправлениеДеятельностиКт
	|				КОГДА (Данные.ВидСчетаКт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДоходов, ЛОЖЬ))
	|					ИЛИ (Данные.ВидСчетаКт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|					ИЛИ Данные.ВидСчетаКт В (&НикогдаНеЗаполнять)
	|				ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|				ИНАЧЕ Данные.НаправлениеДеятельностиКт КОНЕЦ
	|	КОНЕЦ,
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Долгосрочная, ЛОЖЬ),
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СчетДт
	|		ИНАЧЕ Данные.СчетКт
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СубконтоДт1
	|		ИНАЧЕ Данные.СубконтоКт1
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СубконтоДт2
	|		ИНАЧЕ Данные.СубконтоКт2
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СубконтоДт3
	|		ИНАЧЕ Данные.СубконтоКт3
	|	КОНЕЦ,
	|	
	|	ДолгосрочнаяЗадолженностьРазделениеДт.Сумма,
	|	ДолгосрочнаяЗадолженностьРазделениеКт.Сумма,
	|
	|	ДолгосрочнаяЗадолженностьДт.Сумма,
	|	ДолгосрочнаяЗадолженностьКт.Сумма";
	ТекстЗапроса = ТекстЗапросаШаблон;
	// Перенос с транзита на долгосрочный счет:
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&МножительПереопределяемый", "0");
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ЗнакПереопределяемый", "1");
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ЗнакРазделениеПереопределяемый", "0");
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ЗнакРазделениеКраткосрочныйПереопределяемый", "0");
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ПереносСуммыЗадолженности", "ИСТИНА");
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ПереносЗадолженностиРазделением", "ЛОЖЬ");
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	// Перенос с транзита на долгосрочный счет, уменьшение долгосрочной суммы на сумму записей ВтДолгосрочнаяЗадолженность с вариантом переноса = "Разделение"
	ТекстЗапроса = ТекстЗапросаШаблон;
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&МножительПереопределяемый", "0");
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ЗнакПереопределяемый", "0");
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ЗнакРазделениеПереопределяемый", "-1");
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ЗнакРазделениеКраткосрочныйПереопределяемый", "-1");
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ПереносСуммыЗадолженности", "ЛОЖЬ");
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ПереносЗадолженностиРазделением", "ИСТИНА");
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	ТекстЗапросаШаблон = СтрЗаменить(ТекстЗапросаШаблон, "Перенос задолженности с транзитного на долгосрочный счет", "Перенос задолженности с транзитного на краткосрочный счет");
	ТекстЗапросаШаблон = СтрЗаменить(ТекстЗапросаШаблон, "ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Долгосрочная, ЛОЖЬ)", "ЛОЖЬ");
	ТекстЗапросаШаблон = СтрЗаменить(ТекстЗапросаШаблон, "ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Долгосрочная, ЛОЖЬ)", "ЛОЖЬ");
	ТекстЗапроса = ТекстЗапросаШаблон;
	// Перенос с транзита на краткосрочный счет, уменьшение исходной суммы на долгосрочную сумму:
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&МножительПереопределяемый", "0");
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ЗнакПереопределяемый", "-1");
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ЗнакРазделениеПереопределяемый", "0");
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ЗнакРазделениеКраткосрочныйПереопределяемый", "0");
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ПереносСуммыЗадолженности", "ИСТИНА");
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ПереносЗадолженностиРазделением", "ЛОЖЬ");
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	// Перенос с транзита на краткосрочный счет, увеличение краткосрочной суммы на сумму записей ВтДолгосрочнаяЗадолженность с вариантом переноса = "Разделение" (которую мы ранее перенесли на долгосрочный счет)
	ТекстЗапроса = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	Данные.Ссылка                       КАК Ссылка,
	|	Данные.Период                       КАК Период,
	|	НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ)  КАК ДатаОтражения,
	|	Данные.ИдентификаторСтроки          КАК ИдентификаторСтроки,
	|	
	|	Данные.Организация                  КАК Организация,
	|
	|	ВЫБОР
	|		КОГДА (Данные.Сумма < 0)
	|			ТОГДА &МножительПереопределяемый * Данные.Сумма + (-1) * (&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0)) + (-1) * (&ЗнакРазделениеПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаРегл, 0)) 
	|		ИНАЧЕ
	|			&МножительПереопределяемый * Данные.Сумма + (&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0)) + (&ЗнакРазделениеПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаРегл, 0)) 
	|	КОНЕЦ КАК Сумма,
	|	ВЫБОР
	|		КОГДА &ВестиУУ И (&ДатаНачалаВеденияУУ <= Данные.Период
	|			ИЛИ ТИПЗНАЧЕНИЯ(Данные.Ссылка) В (&СписокТиповВводаОстатков))       
	|		ТОГДА 
	|			ВЫБОР
	|				КОГДА (Данные.СуммаУУ < 0)
	|					ТОГДА &МножительПереопределяемый * Данные.СуммаУУ + (-1) * (&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаУпр, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаУпр, 0)) + (-1) *(&ЗнакРазделениеПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаУпр, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаУпр, 0))
	|				ИНАЧЕ
	|					&МножительПереопределяемый * Данные.СуммаУУ + (&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаУпр, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаУпр, 0)) + (&ЗнакРазделениеПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаУпр, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаУпр, 0))
	|			КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаУУ,
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПереносДолгосрочнойЗадолженности)
	|		ИНАЧЕ Данные.ВидСчетаДт
	|	КОНЕЦ КАК ВидСчетаДт,
	|	Данные.АналитикаУчетаДт КАК ОбъектУчетаДт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА &АналитикаУчетаПереопределяемыйКт
	|		ИНАЧЕ &АналитикаУчетаПереопределяемыйДт
	|	КОНЕЦ КАК АналитикаУчетаДт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА &МестоУчетаПереопределяемыйКт
	|		ИНАЧЕ &МестоУчетаПереопределяемыйДт
	|	КОНЕЦ КАК МестоУчетаДт,
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.ВалютаКт
	|		ИНАЧЕ Данные.ВалютаДт
	|	КОНЕЦ КАК ВалютаДт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.ПодразделениеКт
	|		ИНАЧЕ Данные.ПодразделениеДт
	|	КОНЕЦ КАК ПодразделениеДт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА ВЫБОР
	|				КОГДА Данные.ВидСчетаКт В (&ЗаполнятьВсегда)
	|				ТОГДА Данные.НаправлениеДеятельностиКт
	|				КОГДА (Данные.ВидСчетаКт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДоходов, ЛОЖЬ))
	|					ИЛИ (Данные.ВидСчетаКт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|					ИЛИ Данные.ВидСчетаКт В (&НикогдаНеЗаполнять)
	|				ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|				ИНАЧЕ Данные.НаправлениеДеятельностиКт КОНЕЦ
	|		ИНАЧЕ ВЫБОР
	|				КОГДА Данные.ВидСчетаДт В (&ЗаполнятьВсегда)
	|				ТОГДА Данные.НаправлениеДеятельностиДт
	|				КОГДА (Данные.ВидСчетаДт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДоходов, ЛОЖЬ))
	|					ИЛИ (Данные.ВидСчетаДт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|					ИЛИ Данные.ВидСчетаДт В (&НикогдаНеЗаполнять)
	|				ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|				ИНАЧЕ Данные.НаправлениеДеятельностиДт КОНЕЦ
	|	КОНЕЦ КАК НаправлениеДеятельностиДт,
	|	ЛОЖЬ КАК ДолгосрочныйДт,
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СчетКт
	|		ИНАЧЕ Данные.СчетДт
	|	КОНЕЦ КАК СчетДт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СубконтоКт1
	|		ИНАЧЕ Данные.СубконтоДт1
	|	КОНЕЦ КАК СубконтоДт1,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СубконтоКт2
	|		ИНАЧЕ Данные.СубконтоДт2
	|	КОНЕЦ КАК СубконтоДт2,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СубконтоКт3
	|		ИНАЧЕ Данные.СубконтоДт3
	|	КОНЕЦ КАК СубконтоДт3,
	|	
	|	СУММА(&МножительПереопределяемый * ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА (Данные.ВалютнаяСуммаКт)
	|		ИНАЧЕ (Данные.ВалютнаяСуммаДт)
	|	КОНЕЦ) + ВЫБОР
	|				КОГДА СУММА(ВЫБОР
	|							КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|								ТОГДА (Данные.ВалютнаяСуммаКт)
	|							ИНАЧЕ (Данные.ВалютнаяСуммаДт) 
	|							КОНЕЦ) < 0         
	|					ТОГДА (-1) * (&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Сумма, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Сумма, 0)) + (-1) * (&ЗнакРазделениеПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.Сумма, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.Сумма, 0))
	|				ИНАЧЕ
	|					(&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Сумма, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Сумма, 0)) + (&ЗнакРазделениеПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.Сумма, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.Сумма, 0))
	|				КОНЕЦ КАК ВалютнаяСуммаДт,
	|	СУММА(ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.КоличествоКт
	|		ИНАЧЕ Данные.КоличествоДт
	|	КОНЕЦ) КАК КоличествоДт,
	|	Данные.Сумма КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	ВЫБОР
	|		КОГДА Данные.Сумма < 0
	|			ТОГДА (-1) * Данные.Сумма - ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаРегл, 0))
	|		ИНАЧЕ
	|			(-1) * Данные.Сумма + ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаРегл, 0))
	|	КОНЕЦ КАК СуммаВРДт,
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПереносДолгосрочнойЗадолженности)
	|		ИНАЧЕ Данные.ВидСчетаКт
	|	КОНЕЦ КАК ВидСчетаКт,
	|	Данные.АналитикаУчетаКт КАК ОбъектУчетаКт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА &АналитикаУчетаПереопределяемыйДт
	|		ИНАЧЕ &АналитикаУчетаПереопределяемыйКт
	|	КОНЕЦ КАК АналитикаУчетаКт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА &МестоУчетаПереопределяемыйДт
	|		ИНАЧЕ &МестоУчетаПереопределяемыйКт
	|	КОНЕЦ КАК МестоУчетаКт,
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.ВалютаДт
	|		ИНАЧЕ Данные.ВалютаКт
	|	КОНЕЦ КАК ВалютаКт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.ПодразделениеДт
	|		ИНАЧЕ Данные.ПодразделениеКт
	|	КОНЕЦ КАК ПодразделениеКт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА ВЫБОР
	|				КОГДА Данные.ВидСчетаДт В (&ЗаполнятьВсегда)
	|				ТОГДА Данные.НаправлениеДеятельностиДт
	|				КОГДА (Данные.ВидСчетаДт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДоходов, ЛОЖЬ))
	|					ИЛИ (Данные.ВидСчетаДт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|					ИЛИ Данные.ВидСчетаДт В (&НикогдаНеЗаполнять)
	|				ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|				ИНАЧЕ Данные.НаправлениеДеятельностиДт КОНЕЦ
	|		ИНАЧЕ ВЫБОР
	|				КОГДА Данные.ВидСчетаКт В (&ЗаполнятьВсегда)
	|				ТОГДА Данные.НаправлениеДеятельностиКт
	|				КОГДА (Данные.ВидСчетаКт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДоходов, ЛОЖЬ))
	|					ИЛИ (Данные.ВидСчетаКт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|					ИЛИ Данные.ВидСчетаКт В (&НикогдаНеЗаполнять)
	|				ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|				ИНАЧЕ Данные.НаправлениеДеятельностиКт КОНЕЦ
	|	КОНЕЦ КАК НаправлениеДеятельностиКт,
	|	ЛОЖЬ КАК ДолгосрочныйКт,
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СчетДт
	|		ИНАЧЕ Данные.СчетКт
	|	КОНЕЦ КАК СчетКт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СубконтоДт1
	|		ИНАЧЕ Данные.СубконтоКт1
	|	КОНЕЦ КАК СубконтоКт1,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СубконтоДт2
	|		ИНАЧЕ Данные.СубконтоКт2
	|	КОНЕЦ КАК СубконтоКт2,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СубконтоДт3
	|		ИНАЧЕ Данные.СубконтоКт3
	|	КОНЕЦ КАК СубконтоКт3,
	|	
	|	СУММА(&МножительПереопределяемый * ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА (Данные.ВалютнаяСуммаДт)
	|		ИНАЧЕ (Данные.ВалютнаяСуммаКт)
	|	КОНЕЦ) + ВЫБОР
	|				КОГДА СУММА(ВЫБОР
	|							КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|								ТОГДА (Данные.ВалютнаяСуммаКт)
	|							ИНАЧЕ (Данные.ВалютнаяСуммаДт) 
	|							КОНЕЦ) < 0
	|					ТОГДА (-1) * (&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Сумма, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Сумма, 0)) + (-1) * (&ЗнакРазделениеПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.Сумма, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.Сумма, 0))
	|				ИНАЧЕ
	|					(&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Сумма, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Сумма, 0)) + (&ЗнакРазделениеПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.Сумма, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.Сумма, 0))
	|				КОНЕЦ КАК ВалютнаяСуммаКт,
	|	СУММА(ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.КоличествоДт
	|		ИНАЧЕ Данные.КоличествоКт
	|	КОНЕЦ) КАК КоличествоКт, 
	|	Данные.Сумма КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	ВЫБОР
	|		КОГДА Данные.Сумма < 0
	|			ТОГДА (-1) * Данные.Сумма - ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаРегл, 0))
	|		ИНАЧЕ
	|			(-1) * Данные.Сумма + ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаРегл, 0))
	|	КОНЕЦ КАК СуммаВРКт,  
	|	
	|	""Перенос задолженности с транзитного на краткосрочный счет"" КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|
	|ИЗ
	|	Данные КАК Данные
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РазрезыКОтражению КАК РазрезыКОтражению
	|	ПО
	|		Данные.Ссылка = РазрезыКОтражению.Ссылка
	|		И Данные.Организация =  РазрезыКОтражению.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = РазрезыКОтражению.ДатаОтражения
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВтДолгосрочнаяЗадолженность КАК ДолгосрочнаяЗадолженностьДт
	|	ПО
	|		Данные.Ссылка = ДолгосрочнаяЗадолженностьДт.Ссылка
	|		И Данные.Организация = ДолгосрочнаяЗадолженностьДт.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = ДолгосрочнаяЗадолженностьДт.ДатаОтражения
	|		И Данные.ВидСчетаДт = ДолгосрочнаяЗадолженностьДт.ВидСчета
	|		И Данные.АналитикаУчетаДт = ДолгосрочнаяЗадолженностьДт.АналитикаУчета
	|		И Данные.МестоУчетаДт = ДолгосрочнаяЗадолженностьДт.МестоУчета
	|		И Данные.ПодразделениеДт = ДолгосрочнаяЗадолженностьДт.Подразделение
	|		И Данные.НаправлениеДеятельностиДт = ДолгосрочнаяЗадолженностьДт.НаправлениеДеятельности
	|		И Данные.ВалютаДт = ДолгосрочнаяЗадолженностьДт.Валюта
	|		И Данные.СубконтоДт1 = ДолгосрочнаяЗадолженностьДт.Субконто1
	|		И Данные.СубконтоДт2 = ДолгосрочнаяЗадолженностьДт.Субконто2
	|		И ДолгосрочнаяЗадолженностьДт.ВидПроводкиДляПереноса В (НЕОПРЕДЕЛЕНО, ""Дт"")
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВтДолгосрочнаяЗадолженность КАК ДолгосрочнаяЗадолженностьКт
	|	ПО
	|		Данные.Ссылка = ДолгосрочнаяЗадолженностьКт.Ссылка
	|		И Данные.Организация = ДолгосрочнаяЗадолженностьКт.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = ДолгосрочнаяЗадолженностьКт.ДатаОтражения
	|		И Данные.ВидСчетаКт = ДолгосрочнаяЗадолженностьКт.ВидСчета
	|		И Данные.АналитикаУчетаКт = ДолгосрочнаяЗадолженностьКт.АналитикаУчета
	|		И Данные.МестоУчетаКт = ДолгосрочнаяЗадолженностьКт.МестоУчета
	|		И Данные.ПодразделениеКт = ДолгосрочнаяЗадолженностьКт.Подразделение
	|		И Данные.НаправлениеДеятельностиКт = ДолгосрочнаяЗадолженностьКт.НаправлениеДеятельности
	|		И Данные.ВалютаКт = ДолгосрочнаяЗадолженностьКт.Валюта
	|		И Данные.СубконтоКт1 = ДолгосрочнаяЗадолженностьКт.Субконто1
	|		И Данные.СубконтоКт2 = ДолгосрочнаяЗадолженностьКт.Субконто2
	|		И ДолгосрочнаяЗадолженностьКт.ВидПроводкиДляПереноса В (НЕОПРЕДЕЛЕНО, ""Кт"")    
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВтДолгосрочнаяЗадолженность КАК ДолгосрочнаяЗадолженностьРазделениеДт
	|	ПО
	|		Данные.Ссылка = ДолгосрочнаяЗадолженностьРазделениеДт.Ссылка
	|		И Данные.Организация = ДолгосрочнаяЗадолженностьРазделениеДт.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = ДолгосрочнаяЗадолженностьРазделениеДт.ДатаОтражения
	|		И Данные.ВидСчетаДт = ДолгосрочнаяЗадолженностьРазделениеДт.ВидСчета
	|		И Данные.АналитикаУчетаДт = ДолгосрочнаяЗадолженностьРазделениеДт.АналитикаУчета
	|		И Данные.МестоУчетаДт = ДолгосрочнаяЗадолженностьРазделениеДт.МестоУчета
	|		И Данные.ПодразделениеДт = ДолгосрочнаяЗадолженностьРазделениеДт.Подразделение
	|		И Данные.НаправлениеДеятельностиДт = ДолгосрочнаяЗадолженностьРазделениеДт.НаправлениеДеятельности
	|		И Данные.ВалютаДт = ДолгосрочнаяЗадолженностьРазделениеДт.Валюта
	|		И Данные.СубконтоДт1 = ДолгосрочнаяЗадолженностьРазделениеДт.Субконто1
	|		И Данные.СубконтоДт2 = ДолгосрочнаяЗадолженностьРазделениеДт.Субконто2
	|		И ДолгосрочнаяЗадолженностьРазделениеДт.ВидПроводкиДляПереноса В (НЕОПРЕДЕЛЕНО, ""Дт"")     
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВтДолгосрочнаяЗадолженность КАК ДолгосрочнаяЗадолженностьРазделениеКт
	|	ПО
	|		Данные.Ссылка = ДолгосрочнаяЗадолженностьРазделениеКт.Ссылка
	|		И Данные.Организация = ДолгосрочнаяЗадолженностьРазделениеКт.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = ДолгосрочнаяЗадолженностьРазделениеКт.ДатаОтражения
	|		И Данные.ВидСчетаКт = ДолгосрочнаяЗадолженностьРазделениеКт.ВидСчета
	|		И Данные.АналитикаУчетаКт = ДолгосрочнаяЗадолженностьРазделениеКт.АналитикаУчета
	|		И Данные.МестоУчетаКт = ДолгосрочнаяЗадолженностьРазделениеКт.МестоУчета
	|		И Данные.ПодразделениеКт = ДолгосрочнаяЗадолженностьРазделениеКт.Подразделение
	|		И Данные.НаправлениеДеятельностиКт = ДолгосрочнаяЗадолженностьРазделениеКт.НаправлениеДеятельности
	|		И Данные.ВалютаКт = ДолгосрочнаяЗадолженностьРазделениеКт.Валюта
	|		И Данные.СубконтоКт1 = ДолгосрочнаяЗадолженностьРазделениеКт.Субконто1
	|		И Данные.СубконтоКт2 = ДолгосрочнаяЗадолженностьРазделениеКт.Субконто2
	|		И ДолгосрочнаяЗадолженностьРазделениеКт.ВидПроводкиДляПереноса В (НЕОПРЕДЕЛЕНО, ""Кт"")  
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		НастройкиСтатейРасходов КАК НастройкиСтатейРасходовДт
	|	ПО
	|		НастройкиСтатейРасходовДт.СтатьяРасходов = Данные.АналитикаУчетаДт
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		НастройкиСтатейРасходов КАК НастройкиСтатейРасходовКт
	|	ПО
	|		НастройкиСтатейРасходовКт.СтатьяРасходов = Данные.АналитикаУчетаКт
	|
	|ГДЕ   
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|	И Данные.ВидСчетаДт В (&СчетаДляТранзитаДолгосрочнойЗадолженности)
	|	И НЕ Данные.ВидСчетаКт В (&СчетаДляТранзитаДолгосрочнойЗадолженности) 
	|	И &ПереносСуммыЗадолженности
	|	ИЛИ ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|	И Данные.ВидСчетаКт В (&СчетаДляТранзитаДолгосрочнойЗадолженности)           
	|	И НЕ Данные.ВидСчетаДт В (&СчетаДляТранзитаДолгосрочнойЗадолженности)        
	|	И &ПереносСуммыЗадолженности  
	|	ИЛИ ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.ВариантПереноса, ""Основной"") = ""Разделение""  
	|	И Данные.ВидСчетаДт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПроцентыПоДисконтированию)      
	|	И &ПереносЗадолженностиРазделением
	|	ИЛИ ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.ВариантПереноса, ""Основной"") = ""Разделение""  
	|	И Данные.ВидСчетаКт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПроцентыПоДисконтированию)
	|	И &ПереносЗадолженностиРазделением
	|
	|СГРУППИРОВАТЬ ПО
	|	Данные.Ссылка,
	|	Данные.Период,
	|	Данные.ИдентификаторСтроки,
	|	Данные.Организация,
	|	ВЫБОР
	|		КОГДА (Данные.Сумма < 0)
	|			ТОГДА &МножительПереопределяемый * Данные.Сумма + (-1) * (&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0)) + (-1) *(&ЗнакРазделениеПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаРегл, 0)) 
	|		ИНАЧЕ
	|			&МножительПереопределяемый * Данные.Сумма + (&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0)) + (&ЗнакРазделениеПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаРегл, 0)) 
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА &ВестиУУ И (&ДатаНачалаВеденияУУ <= Данные.Период
	|			ИЛИ ТИПЗНАЧЕНИЯ(Данные.Ссылка) В (&СписокТиповВводаОстатков))     
	|		ТОГДА 
	|			ВЫБОР
	|				КОГДА (Данные.СуммаУУ < 0)
	|					ТОГДА &МножительПереопределяемый * Данные.СуммаУУ + (-1) * (&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаУпр, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаУпр, 0)) + (-1) *(&ЗнакРазделениеПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаУпр, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаУпр, 0))
	|				ИНАЧЕ
	|					&МножительПереопределяемый * Данные.СуммаУУ + (&ЗнакПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаУпр, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаУпр, 0)) + (&ЗнакРазделениеПереопределяемый) * ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаУпр, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаУпр, 0))
	|			КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПереносДолгосрочнойЗадолженности)
	|		ИНАЧЕ Данные.ВидСчетаДт
	|	КОНЕЦ,
	|	Данные.АналитикаУчетаДт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА &АналитикаУчетаПереопределяемыйКт
	|		ИНАЧЕ &АналитикаУчетаПереопределяемыйДт
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА &МестоУчетаПереопределяемыйКт
	|		ИНАЧЕ &МестоУчетаПереопределяемыйДт
	|	КОНЕЦ,
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.ВалютаКт
	|		ИНАЧЕ Данные.ВалютаДт
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.ПодразделениеКт
	|		ИНАЧЕ Данные.ПодразделениеДт
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА ВЫБОР
	|				КОГДА Данные.ВидСчетаКт В (&ЗаполнятьВсегда)
	|				ТОГДА Данные.НаправлениеДеятельностиКт
	|				КОГДА (Данные.ВидСчетаКт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДоходов, ЛОЖЬ))
	|					ИЛИ (Данные.ВидСчетаКт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|					ИЛИ Данные.ВидСчетаКт В (&НикогдаНеЗаполнять)
	|				ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|				ИНАЧЕ Данные.НаправлениеДеятельностиКт КОНЕЦ
	|		ИНАЧЕ ВЫБОР
	|				КОГДА Данные.ВидСчетаДт В (&ЗаполнятьВсегда)
	|				ТОГДА Данные.НаправлениеДеятельностиДт
	|				КОГДА (Данные.ВидСчетаДт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДоходов, ЛОЖЬ))
	|					ИЛИ (Данные.ВидСчетаДт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|					ИЛИ Данные.ВидСчетаДт В (&НикогдаНеЗаполнять)
	|				ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|				ИНАЧЕ Данные.НаправлениеДеятельностиДт КОНЕЦ
	|	КОНЕЦ,
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СчетКт
	|		ИНАЧЕ Данные.СчетДт
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СубконтоКт1
	|		ИНАЧЕ Данные.СубконтоДт1
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СубконтоКт2
	|		ИНАЧЕ Данные.СубконтоДт2
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СубконтоКт3
	|		ИНАЧЕ Данные.СубконтоДт3
	|	КОНЕЦ,     
	|	Данные.Сумма,
	|	ВЫБОР
	|		КОГДА Данные.Сумма < 0
	|			ТОГДА (-1) * Данные.Сумма - ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаРегл, 0))
	|		ИНАЧЕ
	|			(-1) * Данные.Сумма + ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьРазделениеКт.СуммаРегл, 0))
	|	КОНЕЦ,
	|	
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет"",
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет"",
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПереносДолгосрочнойЗадолженности)
	|		ИНАЧЕ Данные.ВидСчетаКт
	|	КОНЕЦ,
	|	Данные.АналитикаУчетаКт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА &АналитикаУчетаПереопределяемыйДт
	|		ИНАЧЕ &АналитикаУчетаПереопределяемыйКт
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА &МестоУчетаПереопределяемыйДт
	|		ИНАЧЕ &МестоУчетаПереопределяемыйКт
	|	КОНЕЦ,
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.ВалютаДт
	|		ИНАЧЕ Данные.ВалютаКт
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.ПодразделениеДт
	|		ИНАЧЕ Данные.ПодразделениеКт
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА ВЫБОР
	|				КОГДА Данные.ВидСчетаДт В (&ЗаполнятьВсегда)
	|				ТОГДА Данные.НаправлениеДеятельностиДт
	|				КОГДА (Данные.ВидСчетаДт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДоходов, ЛОЖЬ))
	|					ИЛИ (Данные.ВидСчетаДт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|					ИЛИ Данные.ВидСчетаДт В (&НикогдаНеЗаполнять)
	|				ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|				ИНАЧЕ Данные.НаправлениеДеятельностиДт КОНЕЦ
	|		ИНАЧЕ ВЫБОР
	|				КОГДА Данные.ВидСчетаКт В (&ЗаполнятьВсегда)
	|				ТОГДА Данные.НаправлениеДеятельностиКт
	|				КОГДА (Данные.ВидСчетаКт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДоходов, ЛОЖЬ))
	|					ИЛИ (Данные.ВидСчетаКт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|					ИЛИ Данные.ВидСчетаКт В (&НикогдаНеЗаполнять)
	|				ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|				ИНАЧЕ Данные.НаправлениеДеятельностиКт КОНЕЦ
	|	КОНЕЦ,
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СчетДт
	|		ИНАЧЕ Данные.СчетКт
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СубконтоДт1
	|		ИНАЧЕ Данные.СубконтоКт1
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СубконтоДт2
	|		ИНАЧЕ Данные.СубконтоКт2
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезТранзитныйСчет""
	|		ТОГДА Данные.СубконтоДт3
	|		ИНАЧЕ Данные.СубконтоКт3
	|	КОНЕЦ,
	|
	|	ДолгосрочнаяЗадолженностьРазделениеДт.Сумма,
	|	ДолгосрочнаяЗадолженностьРазделениеКт.Сумма,
	|	ДолгосрочнаяЗадолженностьДт.Сумма,
	|	ДолгосрочнаяЗадолженностьКт.Сумма";
	
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&МножительПереопределяемый", "0");
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ЗнакПереопределяемый", "0");
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ЗнакРазделениеПереопределяемый", "1");
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ЗнакРазделениеКраткосрочныйПереопределяемый", "-1"); 
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ПереносСуммыЗадолженности", "ЛОЖЬ");
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ПереносЗадолженностиРазделением", "ИСТИНА");
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);  
	
	ТекстЗапроса = ТекстЗапросаШаблон;
	// Перенос с транзита на краткосрочный счет, исходных сумм:
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "РАЗЛИЧНЫЕ", "");
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&МножительПереопределяемый", "1");
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ЗнакПереопределяемый", "0");
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ЗнакРазделениеПереопределяемый", "0"); 
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ЗнакРазделениеКраткосрочныйПереопределяемый", "0");
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ПереносСуммыЗадолженности", "ИСТИНА");
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ПереносЗадолженностиРазделением", "ЛОЖЬ");
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ТекстЗапросаПереносаЗадолженностиРазделением_Краткосрочная
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	Данные.Ссылка                       КАК Ссылка,
	|	Данные.Период                       КАК Период,
	|	НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ)  КАК ДатаОтражения,
	|	Данные.ИдентификаторСтроки          КАК ИдентификаторСтроки,
	|	
	|	Данные.Организация                  КАК Организация,
	|	
	|	ВЫБОР
	|		КОГДА Данные.Сумма > 0 
	|			ТОГДА Данные.Сумма - ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0))
	|		КОГДА Данные.Сумма < 0 ТОГДА
	|			Данные.Сумма + ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0))
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК Сумма,
	|	ВЫБОР
	|		КОГДА &ВестиУУ И (&ДатаНачалаВеденияУУ <= Данные.Период
	|			ИЛИ ТИПЗНАЧЕНИЯ(Данные.Ссылка) В (&СписокТиповВводаОстатков))
	|		ТОГДА 
	|			ВЫБОР
	|				КОГДА Данные.СуммаУУ > 0 
	|					ТОГДА Данные.СуммаУУ - ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаУпр, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаУпр, 0))
	|				КОГДА Данные.Сумма < 0 ТОГДА
	|					Данные.СуммаУУ + ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаУпр, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаУпр, 0))
	|				ИНАЧЕ 0
	|			КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаУУ,
	|	
	|	Данные.ВидСчетаДт КАК ВидСчетаДт,
	|	Данные.АналитикаУчетаДт КАК ОбъектУчетаДт,
	|	&АналитикаУчетаПереопределяемыйДт КАК АналитикаУчетаДт,
	|	&МестоУчетаПереопределяемыйДт КАК МестоУчетаДт,
	|	
	|	Данные.ВалютаДт                     КАК ВалютаДт,
	|	Данные.ПодразделениеДт              КАК ПодразделениеДт,
	|	ВЫБОР
	|		КОГДА Данные.ВидСчетаДт В (&ЗаполнятьВсегда)
	|		ТОГДА Данные.НаправлениеДеятельностиДт
	|		КОГДА (Данные.ВидСчетаДт В (&УчетЗатрат) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетЗатрат, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДоходов, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетДенежныхСредств) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДенежныхСредствРаздельно, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетДенежныхСредств) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДенежныхСредствПоКорреспонденции, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетВнеоборотныхАктивов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетВнеоборотныхАктивов, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетРезервов) И ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.ГосударственныйКонтракт,
	|				ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка)) <> ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетРезервов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетЗатрат, ЛОЖЬ))
	|			ИЛИ Данные.ВидСчетаДт В (&НикогдаНеЗаполнять)
	|		ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|		ИНАЧЕ Данные.НаправлениеДеятельностиДт
	|	КОНЕЦ КАК НаправлениеДеятельностиДт,
	|	ЛОЖЬ КАК ДолгосрочныйДт,
	|	
	|	Данные.СчетДт КАК СчетДт,
	|	Данные.СубконтоДт1 КАК СубконтоДт1,
	|	Данные.СубконтоДт2 КАК СубконтоДт2,
	|	Данные.СубконтоДт3 КАК СубконтоДт3,
	|	
	|	ВЫБОР
	|		КОГДА Данные.ВалютнаяСуммаДт > 0 
	|			ТОГДА Данные.ВалютнаяСуммаДт - ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Сумма, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Сумма, 0))
	|		КОГДА Данные.ВалютнаяСуммаДт < 0 
	|			ТОГДА Данные.ВалютнаяСуммаДт + ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Сумма, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Сумма, 0))
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ВалютнаяСуммаДт,
	|	Данные.КоличествоДт              КАК КоличествоДт,
	|	ВЫБОР
	|		КОГДА Данные.ВидСчетаДт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПроцентыПоДисконтированию) ИЛИ Данные.СуммаНУКт = 0
	|			ТОГДА 0
	|		КОГДА Данные.СуммаНУДт > 0 
	|			ТОГДА Данные.СуммаНУДт - ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0))
	|		КОГДА Данные.СуммаНУДт > 0 ТОГДА
	|			Данные.СуммаНУДт + ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0))
	|		ИНАЧЕ 0
	|	КОНЕЦ                            КАК СуммаНУДт,
	|	Данные.СуммаПРДт                 КАК СуммаПРДт,
	|	ВЫБОР 
	|		КОГДА Данные.ВидСчетаДт <> ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПроцентыПоДисконтированию) ТОГДА
	|				ВЫБОР КОГДА Данные.СуммаВРДт > 0 
	|				ТОГДА Данные.СуммаВРДт - ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0))
	|				КОГДА Данные.СуммаВРДт < 0
	|				ТОГДА Данные.СуммаВРДт + ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0)) 
	|				ИНАЧЕ 0 КОНЕЦ
	|		КОГДА Данные.Сумма > 0
	|		ТОГДА Данные.Сумма - ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0))
	|		ИНАЧЕ
	|			Данные.Сумма + ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0))
	|	КОНЕЦ КАК СуммаВРДт,
	|	
	|	Данные.ВидСчетаКт КАК ВидСчетаКт,
	|	Данные.АналитикаУчетаКт КАК ОбъектУчетаКт,
	|	&АналитикаУчетаПереопределяемыйКт КАК АналитикаУчетаКт,
	|	&МестоУчетаПереопределяемыйКт КАК МестоУчетаКт,
	|	
	|	Данные.ВалютаКт                  КАК ВалютаКт,
	|	Данные.ПодразделениеКт           КАК ПодразделениеКт,
	|	ВЫБОР
	|		КОГДА Данные.ВидСчетаКт В (&ЗаполнятьВсегда)
	|		ТОГДА Данные.НаправлениеДеятельностиКт 
	|		КОГДА (Данные.ВидСчетаКт В (&УчетЗатрат) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетЗатрат, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДоходов, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетДенежныхСредств) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДенежныхСредствРаздельно, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетДенежныхСредств) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДенежныхСредствПоКорреспонденции, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетВнеоборотныхАктивов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетВнеоборотныхАктивов, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетРезервов) И ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.ГосударственныйКонтракт,
	|				ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка)) <> ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетРезервов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетЗатрат, ЛОЖЬ))
	|			ИЛИ Данные.ВидСчетаКт В (&НикогдаНеЗаполнять)
	|		ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|		ИНАЧЕ Данные.НаправлениеДеятельностиКт 
	|	КОНЕЦ КАК НаправлениеДеятельностиКт,
	|	ЛОЖЬ КАК ДолгосрочныйКт,
	|	
	|	Данные.СчетКт КАК СчетКт,
	|	Данные.СубконтоКт1 КАК СубконтоКт1,
	|	Данные.СубконтоКт2 КАК СубконтоКт2,
	|	Данные.СубконтоКт3 КАК СубконтоКт3,
	|	
	|	ВЫБОР
	|		КОГДА Данные.ВалютнаяСуммаКт > 0 
	|			ТОГДА Данные.ВалютнаяСуммаКт - ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Сумма, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Сумма, 0))
	|		КОГДА Данные.ВалютнаяСуммаКт < 0 ТОГДА
	|			Данные.ВалютнаяСуммаКт + ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Сумма, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Сумма, 0))
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ВалютнаяСуммаКт,
	|	Данные.КоличествоКт             КАК КоличествоКт,
	|	ВЫБОР
	|		КОГДА Данные.СуммаНУКт > 0 
	|			ТОГДА Данные.СуммаНУКт - ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, 0))
	|		КОГДА Данные.СуммаНУКт = 0
	|			ТОГДА 0
	|		ИНАЧЕ
	|			Данные.СуммаНУКт + ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, 0))
	|	КОНЕЦ                           КАК СуммаНУКт,
	|	Данные.СуммаПРКт                КАК СуммаПРКт,
	|	ВЫБОР
	|		КОГДА Данные.ВидСчетаДт <> ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПроцентыПоДисконтированию) ТОГДА
	|			ВЫБОР КОГДА Данные.СуммаВРКт > 0 
	|					ТОГДА Данные.СуммаВРКт - ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0))
	|				КОГДА Данные.СуммаВРКт < 0
	|					ТОГДА Данные.СуммаВРДт + ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0)) 
	|				ИНАЧЕ 0
	|			КОНЕЦ
	|		КОГДА Данные.Сумма > 0
	|			ТОГДА Данные.Сумма - ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0))
	|		ИНАЧЕ
	|			Данные.Сумма + ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0))
	|	КОНЕЦ                           КАК СуммаВРКт,
	|	
	|	Данные.Содержание               КАК Содержание,
	|	ЛОЖЬ                            КАК Сторно
	|
	|ИЗ
	|	Данные КАК Данные
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РазрезыКОтражению КАК РазрезыКОтражению
	|	ПО
	|		Данные.Ссылка = РазрезыКОтражению.Ссылка
	|		И Данные.Организация =  РазрезыКОтражению.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = РазрезыКОтражению.ДатаОтражения
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВтДолгосрочнаяЗадолженность КАК ДолгосрочнаяЗадолженностьДт
	|	ПО
	|		Данные.Ссылка = ДолгосрочнаяЗадолженностьДт.Ссылка
	|		И Данные.Организация = ДолгосрочнаяЗадолженностьДт.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = ДолгосрочнаяЗадолженностьДт.ДатаОтражения
	|		И Данные.ВидСчетаДт = ДолгосрочнаяЗадолженностьДт.ВидСчета
	|		И Данные.АналитикаУчетаДт = ДолгосрочнаяЗадолженностьДт.АналитикаУчета
	|		И Данные.МестоУчетаДт = ДолгосрочнаяЗадолженностьДт.МестоУчета
	|		И Данные.ПодразделениеДт = ДолгосрочнаяЗадолженностьДт.Подразделение
	|		И Данные.НаправлениеДеятельностиДт = ДолгосрочнаяЗадолженностьДт.НаправлениеДеятельности
	|		И Данные.ВалютаДт = ДолгосрочнаяЗадолженностьДт.Валюта
	|		И Данные.СубконтоДт1 = ДолгосрочнаяЗадолженностьДт.Субконто1
	|		И Данные.СубконтоДт2 = ДолгосрочнаяЗадолженностьДт.Субконто2
	|		И ДолгосрочнаяЗадолженностьДт.ВидПроводкиДляПереноса В (НЕОПРЕДЕЛЕНО, ""Дт"")
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВтДолгосрочнаяЗадолженность КАК ДолгосрочнаяЗадолженностьКт
	|	ПО
	|		Данные.Ссылка = ДолгосрочнаяЗадолженностьКт.Ссылка
	|		И Данные.Организация = ДолгосрочнаяЗадолженностьКт.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = ДолгосрочнаяЗадолженностьКт.ДатаОтражения
	|		И Данные.ВидСчетаКт = ДолгосрочнаяЗадолженностьКт.ВидСчета
	|		И Данные.АналитикаУчетаКт = ДолгосрочнаяЗадолженностьКт.АналитикаУчета
	|		И Данные.МестоУчетаКт = ДолгосрочнаяЗадолженностьКт.МестоУчета
	|		И Данные.ПодразделениеКт = ДолгосрочнаяЗадолженностьКт.Подразделение
	|		И Данные.НаправлениеДеятельностиКт = ДолгосрочнаяЗадолженностьКт.НаправлениеДеятельности
	|		И Данные.ВалютаКт = ДолгосрочнаяЗадолженностьКт.Валюта
	|		И Данные.СубконтоКт1 = ДолгосрочнаяЗадолженностьКт.Субконто1
	|		И Данные.СубконтоКт2 = ДолгосрочнаяЗадолженностьКт.Субконто2
	|		И ДолгосрочнаяЗадолженностьКт.ВидПроводкиДляПереноса В (НЕОПРЕДЕЛЕНО, ""Кт"")
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		НастройкиСтатейРасходов КАК НастройкиСтатейРасходовДт
	|	ПО
	|		НастройкиСтатейРасходовДт.СтатьяРасходов = Данные.АналитикаУчетаДт
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		НастройкиСтатейРасходов КАК НастройкиСтатейРасходовКт
	|	ПО
	|		НастройкиСтатейРасходовКт.СтатьяРасходов = Данные.АналитикаУчетаКт
	|
	|ГДЕ
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""Разделение""
	|	ИЛИ ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""Разделение""";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ТекстЗапросаПереносаЗадолженностиРазделением_Долгосрочная
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	Данные.Ссылка                       КАК Ссылка,
	|	Данные.Период                       КАК Период,
	|	НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ)  КАК ДатаОтражения,
	|	Данные.ИдентификаторСтроки          КАК ИдентификаторСтроки,
	|	
	|	Данные.Организация                  КАК Организация,
	|	
	|	ВЫБОР
	|		КОГДА Данные.Сумма > 0
	|			ТОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0))
	|		КОГДА Данные.Сумма < 0 ТОГДА
	|			-ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0))
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК Сумма,
	|	ВЫБОР
	|		КОГДА &ВестиУУ И (&ДатаНачалаВеденияУУ <= Данные.Период
	|			ИЛИ ТИПЗНАЧЕНИЯ(Данные.Ссылка) В (&СписокТиповВводаОстатков))
	|		ТОГДА ВЫБОР
	|				КОГДА Данные.СуммаУУ > 0
	|					ТОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаУпр, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаУпр, 0))
	|				КОГДА Данные.СуммаУУ < 0 ТОГДА
	|					-ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаУпр, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаУпр, 0))
	|				ИНАЧЕ 0
	|			КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаУУ,
	|	
	|	Данные.ВидСчетаДт КАК ВидСчетаДт,
	|	Данные.АналитикаУчетаДт КАК ОбъектУчетаДт,
	|	&АналитикаУчетаПереопределяемыйДт КАК АналитикаУчетаДт,
	|	&МестоУчетаПереопределяемыйДт КАК МестоУчетаДт,
	|	
	|	Данные.ВалютаДт                     КАК ВалютаДт,
	|	Данные.ПодразделениеДт              КАК ПодразделениеДт,
	|	ВЫБОР
	|		КОГДА Данные.ВидСчетаДт В (&ЗаполнятьВсегда)
	|		ТОГДА Данные.НаправлениеДеятельностиДт
	|		КОГДА (Данные.ВидСчетаДт В (&УчетЗатрат) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетЗатрат, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДоходов, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетДенежныхСредств) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДенежныхСредствРаздельно, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетДенежныхСредств) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДенежныхСредствПоКорреспонденции, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетВнеоборотныхАктивов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетВнеоборотныхАктивов, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетРезервов) И ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.ГосударственныйКонтракт,
	|				ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка)) <> ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка))
	|			ИЛИ (Данные.ВидСчетаДт В (&УчетРезервов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетЗатрат, ЛОЖЬ))
	|			ИЛИ Данные.ВидСчетаДт В (&НикогдаНеЗаполнять)
	|		ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|		ИНАЧЕ Данные.НаправлениеДеятельностиДт
	|	КОНЕЦ КАК НаправлениеДеятельностиДт,
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Долгосрочная, ЛОЖЬ) КАК ДолгосрочныйДт,
	|	
	|	Данные.СчетДт КАК СчетДт,
	|	Данные.СубконтоДт1 КАК СубконтоДт1,
	|	Данные.СубконтоДт2 КАК СубконтоДт2,
	|	Данные.СубконтоДт3 КАК СубконтоДт3,
	|	
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Сумма, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Сумма, 0)) КАК ВалютнаяСуммаДт,
	|	Данные.КоличествоДт              КАК КоличествоДт,
	|	ВЫБОР
	|		КОГДА Данные.ВидСчетаДт = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПроцентыПоДисконтированию)
	|			ТОГДА 0
	|		КОГДА Данные.Сумма > 0 ИЛИ Данные.СуммаНУДт > 0 
	|			ТОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0))
	|		КОГДА Данные.Сумма < 0 ИЛИ Данные.СуммаНУДт < 0 ТОГДА
	|			-ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0))
	|		ИНАЧЕ 0
	|	КОНЕЦ            КАК СуммаНУДт,
	|	Данные.СуммаПРДт КАК СуммаПРДт,
	|	ВЫБОР
	|		КОГДА Данные.ВидСчетаДт <> ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПроцентыПоДисконтированию)
	|			ТОГДА ВЫБОР КОГДА Данные.СуммаВРДт > 0 ТОГДА
	|				ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0))
	|			КОГДА Данные.СуммаВРДт < 0 ТОГДА
	|				-ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0))
	|			ИНАЧЕ 0
	|			КОНЕЦ
	|		КОГДА Данные.Сумма > 0
	|			ТОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0)) 
	|		ИНАЧЕ -ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0)) 
	|	КОНЕЦ КАК СуммаВРДт,
	|	
	|	Данные.ВидСчетаКт КАК ВидСчетаКт,
	|	Данные.АналитикаУчетаКт КАК ОбъектУчетаКт,
	|	&АналитикаУчетаПереопределяемыйКт КАК АналитикаУчетаКт,
	|	&МестоУчетаПереопределяемыйКт КАК МестоУчетаКт,
	|	
	|	Данные.ВалютаКт                  КАК ВалютаКт,
	|	Данные.ПодразделениеКт           КАК ПодразделениеКт,
	|	ВЫБОР
	|		КОГДА Данные.ВидСчетаКт В (&ЗаполнятьВсегда)
	|		ТОГДА Данные.НаправлениеДеятельностиКт 
	|		КОГДА (Данные.ВидСчетаКт В (&УчетЗатрат) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетЗатрат, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетДоходов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДоходов, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетДенежныхСредств) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДенежныхСредствРаздельно, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетДенежныхСредств) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДенежныхСредствПоКорреспонденции, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетВнеоборотныхАктивов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетВнеоборотныхАктивов, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетРасчетовСПоставщиками, ЛОЖЬ))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетРезервов) И ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.ГосударственныйКонтракт,
	|				ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка)) <> ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка))
	|			ИЛИ (Данные.ВидСчетаКт В (&УчетРезервов) И НЕ ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетЗатрат, ЛОЖЬ))
	|			ИЛИ Данные.ВидСчетаКт В (&НикогдаНеЗаполнять)
	|		ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|		ИНАЧЕ Данные.НаправлениеДеятельностиКт 
	|	КОНЕЦ КАК НаправлениеДеятельностиКт,
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Долгосрочная, ЛОЖЬ) КАК ДолгосрочныйКт,
	|	
	|	Данные.СчетКт КАК СчетКт,
	|	Данные.СубконтоКт1 КАК СубконтоКт1,
	|	Данные.СубконтоКт2 КАК СубконтоКт2,
	|	Данные.СубконтоКт3 КАК СубконтоКт3,
	|	
	|	ВЫБОР КОГДА ДолгосрочнаяЗадолженностьКт.ВариантПереноса = ""Разделение"" ТОГДА
	|			ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Сумма, 0) 
	|		ИНАЧЕ ВЫБОР
	|			КОГДА Данные.ВалютнаяСуммаКт > 0 
	|				ТОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Сумма, ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Сумма, 0)) 
	|			КОГДА Данные.ВалютнаяСуммаКт < 0 ТОГДА
	|				- ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Сумма, ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Сумма, 0))
	|			ИНАЧЕ 0
	|		КОНЕЦ
	|	КОНЕЦ                           КАК ВалютнаяСуммаКт,
	|
	|	Данные.КоличествоКт             КАК КоличествоКт,
	|	ВЫБОР КОГДА ДолгосрочнаяЗадолженностьКт.ВариантПереноса = ""Разделение"" ТОГДА
	|			ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0)
	|		КОГДА Данные.СуммаНУКт > 0
	|			ТОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0)) 
	|		КОГДА Данные.СуммаНУКт < 0 
	|			ТОГДА - ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0)) 
	|		ИНАЧЕ 0
	|	КОНЕЦ                           КАК СуммаНУКт,
	|	Данные.СуммаПРКт                КАК СуммаПРКт,
	|	ВЫБОР
	|		КОГДА Данные.ВидСчетаДт <> ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПроцентыПоДисконтированию)
	|			ТОГДА ВЫБОР КОГДА ДолгосрочнаяЗадолженностьКт.ВариантПереноса = ""Разделение"" ТОГДА
	|					ВЫБОР КОГДА Данные.СуммаВРКт > 0 ТОГДА
	|						ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0)
	|					КОГДА Данные.СуммаВРКт < 0 ТОГДА
	|						-ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0)
	|					ИНАЧЕ 0
	|				КОНЕЦ
	|			ИНАЧЕ
	|				Данные.СуммаВРКт
	|			КОНЕЦ
	|		КОГДА Данные.Сумма > 0
	|			ТОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0)) 
	|		ИНАЧЕ -ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0)) 
	|	КОНЕЦ                            КАК СуммаВРКт,
	|	
	|	Данные.Содержание               КАК Содержание,
	|	ЛОЖЬ                            КАК Сторно
	|ИЗ
	|	Данные КАК Данные
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РазрезыКОтражению КАК РазрезыКОтражению
	|	ПО
	|		Данные.Ссылка = РазрезыКОтражению.Ссылка
	|		И Данные.Организация =  РазрезыКОтражению.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = РазрезыКОтражению.ДатаОтражения
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВтДолгосрочнаяЗадолженность КАК ДолгосрочнаяЗадолженностьДт
	|	ПО
	|		Данные.Ссылка = ДолгосрочнаяЗадолженностьДт.Ссылка
	|		И Данные.Организация = ДолгосрочнаяЗадолженностьДт.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = ДолгосрочнаяЗадолженностьДт.ДатаОтражения
	|		И Данные.ВидСчетаДт = ДолгосрочнаяЗадолженностьДт.ВидСчета
	|		И Данные.АналитикаУчетаДт = ДолгосрочнаяЗадолженностьДт.АналитикаУчета
	|		И Данные.МестоУчетаДт = ДолгосрочнаяЗадолженностьДт.МестоУчета
	|		И Данные.ПодразделениеДт = ДолгосрочнаяЗадолженностьДт.Подразделение
	|		И Данные.НаправлениеДеятельностиДт = ДолгосрочнаяЗадолженностьДт.НаправлениеДеятельности
	|		И Данные.ВалютаДт = ДолгосрочнаяЗадолженностьДт.Валюта
	|		И Данные.СубконтоДт1 = ДолгосрочнаяЗадолженностьДт.Субконто1
	|		И Данные.СубконтоДт2 = ДолгосрочнаяЗадолженностьДт.Субконто2
	|		И ДолгосрочнаяЗадолженностьДт.ВидПроводкиДляПереноса В (НЕОПРЕДЕЛЕНО, ""Дт"")
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВтДолгосрочнаяЗадолженность КАК ДолгосрочнаяЗадолженностьКт
	|	ПО
	|		Данные.Ссылка = ДолгосрочнаяЗадолженностьКт.Ссылка
	|		И Данные.Организация = ДолгосрочнаяЗадолженностьКт.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = ДолгосрочнаяЗадолженностьКт.ДатаОтражения
	|		И Данные.ВидСчетаКт = ДолгосрочнаяЗадолженностьКт.ВидСчета
	|		И Данные.АналитикаУчетаКт = ДолгосрочнаяЗадолженностьКт.АналитикаУчета
	|		И Данные.МестоУчетаКт = ДолгосрочнаяЗадолженностьКт.МестоУчета
	|		И Данные.ПодразделениеКт = ДолгосрочнаяЗадолженностьКт.Подразделение
	|		И Данные.НаправлениеДеятельностиКт = ДолгосрочнаяЗадолженностьКт.НаправлениеДеятельности
	|		И Данные.ВалютаКт = ДолгосрочнаяЗадолженностьКт.Валюта
	|		И Данные.СубконтоКт1 = ДолгосрочнаяЗадолженностьКт.Субконто1
	|		И Данные.СубконтоКт2 = ДолгосрочнаяЗадолженностьКт.Субконто2
	|		И ДолгосрочнаяЗадолженностьКт.ВидПроводкиДляПереноса В (НЕОПРЕДЕЛЕНО, ""Кт"")
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		НастройкиСтатейРасходов КАК НастройкиСтатейРасходовДт
	|	ПО
	|		НастройкиСтатейРасходовДт.СтатьяРасходов = Данные.АналитикаУчетаДт
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		НастройкиСтатейРасходов КАК НастройкиСтатейРасходовКт
	|	ПО
	|		НастройкиСтатейРасходовКт.СтатьяРасходов = Данные.АналитикаУчетаКт
	|
	|ГДЕ
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""Разделение""
	|	ИЛИ ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""Разделение""";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ТекстЗапросаПереносаАрендыСКраткосрочногоНаДолгосрочный
	ТекстЗапроса =
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	Данные.Ссылка                       КАК Ссылка,
	|	Данные.Период                       КАК Период,
	|	НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ)  КАК ДатаОтражения,
	|	Данные.ИдентификаторСтроки          КАК ИдентификаторСтроки,
	|	
	|	Данные.Организация КАК Организация,
	|	
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаРегл, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаРегл, 0)) КАК Сумма,
	|	ВЫБОР
	|		КОГДА &ВестиУУ И (&ДатаНачалаВеденияУУ <= Данные.Период
	|			ИЛИ ТИПЗНАЧЕНИЯ(Данные.Ссылка) В (&СписокТиповВводаОстатков))
	|		ТОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.СуммаУпр, ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.СуммаУпр, 0))
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаУУ,
	|	
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВидСчета, Данные.ВидСчетаДт) КАК ВидСчетаДт,
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.АналитикаУчета, Данные.АналитикаУчетаДт) КАК ОбъектУчетаДт,
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.АналитикаУчета, &АналитикаУчетаПереопределяемыйДт) КАК АналитикаУчетаДт,
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.МестоУчета, &МестоУчетаПереопределяемыйДт) КАК МестоУчетаДт,
	|	
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Валюта, Данные.ВалютаДт) КАК ВалютаДт,
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Подразделение, Данные.ПодразделениеДт) КАК ПодразделениеДт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВидСчета, Данные.ВидСчетаДт) В (&ЗаполнятьВсегда)
	|		ТОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.НаправлениеДеятельности, Данные.НаправлениеДеятельностиДт)
	|		КОГДА (ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВидСчета, Данные.ВидСчетаДт) В (&УчетЗатрат) И НЕ ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.НаправлениеДеятельности.УчетЗатрат, ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетЗатрат, ЛОЖЬ)))
	|			ИЛИ (ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВидСчета, Данные.ВидСчетаДт) В (&УчетДоходов) И НЕ ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.НаправлениеДеятельности.УчетДоходов, ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДоходов, ЛОЖЬ)))
	|			ИЛИ (ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВидСчета, Данные.ВидСчетаДт) В (&УчетДенежныхСредств) И НЕ ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.НаправлениеДеятельности.УчетДенежныхСредствРаздельно, ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДенежныхСредствРаздельно, ЛОЖЬ)))
	|			ИЛИ (ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВидСчета, Данные.ВидСчетаДт) В (&УчетДенежныхСредств) И НЕ ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.НаправлениеДеятельности.УчетДенежныхСредствПоКорреспонденции, ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетДенежныхСредствПоКорреспонденции, ЛОЖЬ)))
	|			ИЛИ (ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВидСчета, Данные.ВидСчетаДт) В (&УчетВнеоборотныхАктивов) И НЕ ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.НаправлениеДеятельности.УчетВнеоборотныхАктивов, ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетВнеоборотныхАктивов, ЛОЖЬ)))
	|			ИЛИ (ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВидСчета, Данные.ВидСчетаДт) В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.НаправлениеДеятельности.УчетРасчетовСПоставщиками, ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетРасчетовСПоставщиками, ЛОЖЬ)))
	|			ИЛИ (ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВидСчета, Данные.ВидСчетаДт) В (&УчетРезервов) И ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.НаправлениеДеятельности.ГосударственныйКонтракт, ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.ГосударственныйКонтракт,
	|				ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка))) <> ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка))
	|			ИЛИ (ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВидСчета, Данные.ВидСчетаДт) В (&УчетРезервов) И НЕ ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.НаправлениеДеятельности.УчетЗатрат, ЕСТЬNULL(Данные.НаправлениеДеятельностиДт.УчетЗатрат, ЛОЖЬ)))
	|			ИЛИ ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВидСчета, Данные.ВидСчетаДт) В (&НикогдаНеЗаполнять)
	|		ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|		ИНАЧЕ ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.НаправлениеДеятельности, Данные.НаправлениеДеятельностиДт)
	|	КОНЕЦ КАК НаправлениеДеятельностиДт,
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Долгосрочная, ЛОЖЬ) КАК ДолгосрочныйДт,
	|	
	|	Данные.СчетДт КАК СчетДт,
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Субконто1, Данные.СубконтоДт1) КАК СубконтоДт1,
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Субконто2, Данные.СубконтоДт2) КАК СубконтоДт2,
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Субконто3, Данные.СубконтоДт3) КАК СубконтоДт3,
	|	
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Сумма, ДолгосрочнаяЗадолженностьКт.Сумма) КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВидСчета, Данные.ВидСчетаКт) КАК ВидСчетаКт,
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.АналитикаУчета, Данные.АналитикаУчетаКт) КАК ОбъектУчетаКт,
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.АналитикаУчета, &АналитикаУчетаПереопределяемыйКт) КАК АналитикаУчетаКт,
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.МестоУчета, &МестоУчетаПереопределяемыйКт) КАК МестоУчетаКт,
	|	
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Валюта, Данные.ВалютаКт) КАК ВалютаКт,
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Подразделение, Данные.ПодразделениеКт) КАК ПодразделениеКт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВидСчета, Данные.ВидСчетаКт) В (&ЗаполнятьВсегда)
	|		ТОГДА ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.НаправлениеДеятельности, Данные.НаправлениеДеятельностиКт)
	|		КОГДА (ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВидСчета, Данные.ВидСчетаКт) В (&УчетЗатрат) И НЕ ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.НаправлениеДеятельности.УчетЗатрат, ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетЗатрат, ЛОЖЬ)))
	|			ИЛИ (ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВидСчета, Данные.ВидСчетаКт) В (&УчетДоходов) И НЕ ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.НаправлениеДеятельности.УчетДоходов, ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДоходов, ЛОЖЬ)))
	|			ИЛИ (ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВидСчета, Данные.ВидСчетаКт) В (&УчетДенежныхСредств) И НЕ ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.НаправлениеДеятельности.УчетДенежныхСредствРаздельно, ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДенежныхСредствРаздельно, ЛОЖЬ)))
	|			ИЛИ (ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВидСчета, Данные.ВидСчетаКт) В (&УчетДенежныхСредств) И НЕ ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.НаправлениеДеятельности.УчетДенежныхСредствПоКорреспонденции, ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетДенежныхСредствПоКорреспонденции, ЛОЖЬ)))
	|			ИЛИ (ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВидСчета, Данные.ВидСчетаКт) В (&УчетВнеоборотныхАктивов) И НЕ ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.НаправлениеДеятельности.УчетВнеоборотныхАктивов, ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетВнеоборотныхАктивов, ЛОЖЬ)))
	|			ИЛИ (ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВидСчета, Данные.ВидСчетаКт) В (&УчетРасчетовСПоставщиками) И НЕ ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.НаправлениеДеятельности.УчетРасчетовСПоставщиками, ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетРасчетовСПоставщиками, ЛОЖЬ)))
	|			ИЛИ (ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВидСчета, Данные.ВидСчетаКт) В (&УчетРезервов) И ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.НаправлениеДеятельности.ГосударственныйКонтракт, ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.ГосударственныйКонтракт,
	|				ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка))) = ЗНАЧЕНИЕ(Справочник.ГосударственныеКонтракты.ПустаяСсылка))
	|			ИЛИ (ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВидСчета, Данные.ВидСчетаКт) В (&УчетРезервов) И НЕ ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.НаправлениеДеятельности.УчетЗатрат, ЕСТЬNULL(Данные.НаправлениеДеятельностиКт.УчетЗатрат, ЛОЖЬ)))
	|			ИЛИ ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВидСчета, Данные.ВидСчетаКт) В (&НикогдаНеЗаполнять)
	|		ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|		ИНАЧЕ ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.НаправлениеДеятельности, Данные.НаправлениеДеятельностиКт)
	|	КОНЕЦ КАК НаправлениеДеятельностиКт,
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Долгосрочная, ЛОЖЬ) КАК ДолгосрочныйКт,
	|	
	|	Данные.СчетКт КАК СчетКт,
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Субконто1, Данные.СубконтоКт1) КАК СубконтоКт1,
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Субконто2, Данные.СубконтоКт2) КАК СубконтоКт2,
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.Субконто3, Данные.СубконтоКт3) КАК СубконтоКт3,
	|	
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.Сумма, ДолгосрочнаяЗадолженностьДт.Сумма) КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	
	|	""Перенос долгосрочной задолженности на долгосрочный счет"" КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|
	|ИЗ
	|	Данные КАК Данные
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РазрезыКОтражению КАК РазрезыКОтражению
	|	ПО
	|		Данные.Ссылка = РазрезыКОтражению.Ссылка
	|		И Данные.Организация =  РазрезыКОтражению.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = РазрезыКОтражению.ДатаОтражения
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВтДолгосрочнаяЗадолженность КАК ДолгосрочнаяЗадолженностьДт
	|	ПО
	|		Данные.Ссылка = ДолгосрочнаяЗадолженностьДт.Ссылка
	|		И Данные.Организация = ДолгосрочнаяЗадолженностьДт.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = ДолгосрочнаяЗадолженностьДт.ДатаОтражения
	|		И Данные.ВидСчетаДт = ДолгосрочнаяЗадолженностьДт.ВидСчета
	|		И Данные.АналитикаУчетаДт = ДолгосрочнаяЗадолженностьДт.АналитикаУчета
	|		И Данные.МестоУчетаДт = ДолгосрочнаяЗадолженностьДт.МестоУчета
	|		И Данные.ПодразделениеДт = ДолгосрочнаяЗадолженностьДт.Подразделение
	|		И Данные.НаправлениеДеятельностиДт = ДолгосрочнаяЗадолженностьДт.НаправлениеДеятельности
	|		И Данные.ВалютаДт = ДолгосрочнаяЗадолженностьДт.Валюта
	|		И Данные.СубконтоДт1 = ДолгосрочнаяЗадолженностьДт.Субконто1
	|		И Данные.СубконтоДт2 = ДолгосрочнаяЗадолженностьДт.Субконто2
	|		И ДолгосрочнаяЗадолженностьДт.ВидПроводкиДляПереноса В (НЕОПРЕДЕЛЕНО, ""Дт"")
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВтДолгосрочнаяЗадолженность КАК ДолгосрочнаяЗадолженностьКт
	|	ПО
	|		Данные.Ссылка = ДолгосрочнаяЗадолженностьКт.Ссылка
	|		И Данные.Организация = ДолгосрочнаяЗадолженностьКт.Организация
	|		И НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ) = ДолгосрочнаяЗадолженностьКт.ДатаОтражения
	|		И Данные.ВидСчетаКт = ДолгосрочнаяЗадолженностьКт.ВидСчета
	|		И Данные.АналитикаУчетаКт = ДолгосрочнаяЗадолженностьКт.АналитикаУчета
	|		И Данные.МестоУчетаКт = ДолгосрочнаяЗадолженностьКт.МестоУчета
	|		И Данные.ПодразделениеКт = ДолгосрочнаяЗадолженностьКт.Подразделение
	|		И Данные.НаправлениеДеятельностиКт = ДолгосрочнаяЗадолженностьКт.НаправлениеДеятельности
	|		И Данные.ВалютаКт = ДолгосрочнаяЗадолженностьКт.Валюта
	|		И Данные.СубконтоКт1 = ДолгосрочнаяЗадолженностьКт.Субконто1
	|		И Данные.СубконтоКт2 = ДолгосрочнаяЗадолженностьКт.Субконто2
	|		И ДолгосрочнаяЗадолженностьКт.ВидПроводкиДляПереноса В (НЕОПРЕДЕЛЕНО, ""Кт"")
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		НастройкиСтатейРасходов КАК НастройкиСтатейРасходовДт
	|	ПО
	|		НастройкиСтатейРасходовДт.СтатьяРасходов = Данные.АналитикаУчетаДт
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		НастройкиСтатейРасходов КАК НастройкиСтатейРасходовКт
	|	ПО
	|		НастройкиСтатейРасходовКт.СтатьяРасходов = Данные.АналитикаУчетаКт
	|
	|ГДЕ
	|	ЕСТЬNULL(ДолгосрочнаяЗадолженностьДт.ВариантПереноса, ""Основной"") = ""ЧерезКраткосрочныйСчет""
	|	ИЛИ ЕСТЬNULL(ДолгосрочнаяЗадолженностьКт.ВариантПереноса, ""Основной"") = ""ЧерезКраткосрочныйСчет""";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	Запрос = Новый Запрос;
	Запрос.Текст = СтрСоединить(МассивТекстовЗапроса, ОбщегоНазначенияУТ.РазделительЗапросовВОбъединении());
	
	Запрос.УстановитьПараметр("ВестиУУ",             Константы.ВестиУУНаПланеСчетовХозрасчетный.Получить());
	Запрос.УстановитьПараметр("ДатаНачалаВеденияУУ", Константы.ДатаНачалаУУНаПланеСчетовХозрасчетный.Получить());
	Запрос.УстановитьПараметр("СписокТиповВводаОстатков", ТипыДокументовВводаНачальныхОстатков());
	Запрос.УстановитьПараметр("ДетализацияПроводок", Истина); // Используется только при тестировании, при отражении
	// переопределяется в методе РеглУчетПроведениеСервер.ВыборкиОтраженияДокументов()
	
	#Область ЗаполнениеНаправленияДеятельности
	
	Условия = УсловияЗаполненияНаправленийДеятельностиПоВидамСчетов();
	Запрос.УстановитьПараметр("УчетЗатрат",                Условия.УчетЗатрат);
	Запрос.УстановитьПараметр("УчетДоходов",               Условия.УчетДоходов);
	Запрос.УстановитьПараметр("УчетДенежныхСредств",       Условия.УчетДенежныхСредств);
	Запрос.УстановитьПараметр("УчетВнеоборотныхАктивов",   Условия.УчетВнеоборотныхАктивов);
	Запрос.УстановитьПараметр("УчетРасчетовСПоставщиками", Условия.УчетРасчетовСПоставщиками);
	Запрос.УстановитьПараметр("УчетРезервов",              Условия.УчетРезервов);
	Запрос.УстановитьПараметр("НикогдаНеЗаполнять",        Условия.НикогдаНеЗаполнять);
	Запрос.УстановитьПараметр("ЗаполнятьВсегда",           Условия.ЗаполнятьВсегда);
	
	#КонецОбласти
	
	#Область ПереопределениеАналитикИМестУчетаПоВидуСчета
	
	ТекстПереопределенияПараметраУчета = "ВЫБОР
	|		%ТекстПереопределенияПараметраДляРазделов%
	|		ИНАЧЕ ЕСТЬNULL(Данные.%ПараметрУчета%%1, НЕОПРЕДЕЛЕНО)
	|	КОНЕЦ";
	ШаблонПереопределенияПараметраДляРаздела = "КОГДА Данные.ВидСчета%1 В (&ВидыСчетов_%РазделУчета%) И (&НеИспользуется%ПараметрУчета%_%РазделУчета%
	|			ИЛИ ЕСТЬNULL(Данные.%ПараметрУчета%%1, НЕОПРЕДЕЛЕНО) = НЕОПРЕДЕЛЕНО)
	|		ТОГДА &ПустоеЗначение%ПараметрУчета%_%РазделУчета%";
	МассивПереопределенияАналитики = Новый Массив;
	МассивПереопределенияМеста = Новый Массив;
	
	Для каждого РазделУчета Из НастройкаСчетовУчетаКлиентСервер.СписокРазделовСчетовУчета(Истина).ВыгрузитьЗначения() Цикл
		
		ВидыСчетовРеглУчета = НастройкаСчетовУчетаСервер.ВидыСчетовРеглУчетаПоРазделуУчета(РазделУчета, Ложь);
		НастройкаАналитикиУчета = НастройкаСчетовУчетаСервер.НастройкиАналитикиУчетаПоРазделуУчета(РазделУчета);
		НастройкаМестаУчета = НастройкаСчетовУчетаСервер.НастройкиМестаУчетаПоРазделуУчета(РазделУчета);
		ПустоеЗначениеАналитикиУчета = ?(НастройкаАналитикиУчета.ТипЗначения <> Неопределено, НастройкаАналитикиУчета.ТипЗначения.ПривестиЗначение(Неопределено), Неопределено);
		ПустоеЗначениеМестаУчета = ?(НастройкаМестаУчета.ТипЗначения <> Неопределено, НастройкаМестаУчета.ТипЗначения.ПривестиЗначение(Неопределено), Неопределено);
		
		МассивПереопределенияАналитики.Добавить(СтрЗаменить(ШаблонПереопределенияПараметраДляРаздела, "%РазделУчета%", РазделУчета));
		МассивПереопределенияМеста.Добавить(СтрЗаменить(ШаблонПереопределенияПараметраДляРаздела, "%РазделУчета%", РазделУчета));
		
		Если РазделУчета = "Расходы" Тогда
			// Для аналитики учета мы ведем раздельный учет по БУ, НУ и УУ для расходов:
			ТекстПереопределенияРасходов = "КОГДА Данные.ВидСчета%1 В (&ВидыСчетов_Расходы) И ТИПЗНАЧЕНИЯ(Данные.%ПараметрУчета%%1) = ТИП(ПланВидовХарактеристик.СтатьиРасходов)
			|		ТОГДА ЕСТЬNULL(НастройкиСтатейРасходов%1.ГФУ_%2, &ПустоеЗначениеАналитикаУчета_Расходы)";
			МассивПереопределенияАналитики.Добавить(ТекстПереопределенияРасходов);
		КонецЕсли;
		
		Если РазделУчета = "Доходы" Тогда
			// Для доходов и расходов мы вместо статей доходов указываем ГФУ:
			ТекстПереопределенияДоходов = "КОГДА Данные.ВидСчета%1 В (&ВидыСчетов_Доходы) И ТИПЗНАЧЕНИЯ(Данные.%ПараметрУчета%%1) = ТИП(ПланВидовХарактеристик.СтатьиДоходов)
			|		ТОГДА ЕСТЬNULL(Данные.%ПараметрУчета%%1.ГруппаФинансовогоУчета, &ПустоеЗначениеАналитикаУчета_Доходы)";
			МассивПереопределенияАналитики.Добавить(ТекстПереопределенияДоходов);
			ВидыСчетовРеглУчета.Добавить(Перечисления.ВидыСчетовРеглУчета.НДСПриДоходах);
		КонецЕсли;
		
		Запрос.УстановитьПараметр("ВидыСчетов_" + РазделУчета, ВидыСчетовРеглУчета);
		Запрос.УстановитьПараметр("НеИспользуетсяАналитикаУчета_" + РазделУчета, Не НастройкаАналитикиУчета.Используется);
		Запрос.УстановитьПараметр("ПустоеЗначениеАналитикаУчета_" + РазделУчета, ПустоеЗначениеАналитикиУчета);
		Запрос.УстановитьПараметр("НеИспользуетсяМестоУчета_" + РазделУчета, Не НастройкаМестаУчета.Используется);
		Запрос.УстановитьПараметр("ПустоеЗначениеМестоУчета_" + РазделУчета, ПустоеЗначениеМестаУчета);
		
	КонецЦикла;
	
	ТекстПереопределенияАналитикиДляРазделов = СтрСоединить(МассивПереопределенияАналитики, Символы.ПС + Символы.Таб + Символы.Таб);
	ТекстПереопределенияМестаДляРазделов = СтрСоединить(МассивПереопределенияМеста, Символы.ПС + Символы.Таб + Символы.Таб);
	
	ТекстАналитикиУчета = СтрЗаменить(ТекстПереопределенияПараметраУчета, "%ТекстПереопределенияПараметраДляРазделов%", ТекстПереопределенияАналитикиДляРазделов);
	ТекстМестаУчета = СтрЗаменить(ТекстПереопределенияПараметраУчета, "%ТекстПереопределенияПараметраДляРазделов%", ТекстПереопределенияМестаДляРазделов);
	
	ТекстАналитикиУчета = СтрЗаменить(ТекстАналитикиУчета, "%ПараметрУчета%", "АналитикаУчета");
	ТекстМестаУчета = СтрЗаменить(ТекстМестаУчета, "%ПараметрУчета%", "МестоУчета");
	
	Запрос.Текст = СтрЗаменить(Запрос.Текст, "&АналитикаУчетаПереопределяемыйДт_НУ", СтрШаблон(ТекстАналитикиУчета, "Дт", "НУ"));
	Запрос.Текст = СтрЗаменить(Запрос.Текст, "&АналитикаУчетаПереопределяемыйКт_НУ", СтрШаблон(ТекстАналитикиУчета, "Кт", "НУ"));
	Запрос.Текст = СтрЗаменить(Запрос.Текст, "&АналитикаУчетаПереопределяемыйДт_УУ", СтрШаблон(ТекстАналитикиУчета, "Дт", "УУ"));
	Запрос.Текст = СтрЗаменить(Запрос.Текст, "&АналитикаУчетаПереопределяемыйКт_УУ", СтрШаблон(ТекстАналитикиУчета, "Кт", "УУ"));
	
	Запрос.Текст = СтрЗаменить(Запрос.Текст, "&АналитикаУчетаПереопределяемыйДт", СтрШаблон(ТекстАналитикиУчета, "Дт", "БУ"));
	Запрос.Текст = СтрЗаменить(Запрос.Текст, "&АналитикаУчетаПереопределяемыйКт", СтрШаблон(ТекстАналитикиУчета, "Кт", "БУ"));
	Запрос.Текст = СтрЗаменить(Запрос.Текст, "&МестоУчетаПереопределяемыйДт", СтрШаблон(ТекстМестаУчета, "Дт"));
	Запрос.Текст = СтрЗаменить(Запрос.Текст, "&МестоУчетаПереопределяемыйКт", СтрШаблон(ТекстМестаУчета, "Кт"));
	
	#КонецОбласти
	
	#Область РеклассификацияЗадолженности
	
	МассивСчетовДляТранзитаДолгосрочнойЗадолженности = Новый Массив;
	МассивСчетовДляТранзитаДолгосрочнойЗадолженности.Добавить(Перечисления.ВидыСчетовРеглУчета.РасчетыСКлиентами);
	МассивСчетовДляТранзитаДолгосрочнойЗадолженности.Добавить(Перечисления.ВидыСчетовРеглУчета.РасчетыСПоставщиками);
	МассивСчетовДляТранзитаДолгосрочнойЗадолженности.Добавить(Перечисления.ВидыСчетовРеглУчета.ПроцентыПоДисконтированию);
	Запрос.УстановитьПараметр("СчетаДляТранзитаДолгосрочнойЗадолженности", МассивСчетовДляТранзитаДолгосрочнойЗадолженности);
	
	АктивныеСчетаПриРеклассификации = Новый Массив;
	АктивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.РасчетыСКлиентами);
	АктивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.АвансыВыданные);
	АктивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.РасчетыСКредиторамиКомиссия);
	АктивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.РасчетыСДебиторамиОсновнойДолг);
	АктивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.РасчетыСДебиторамиПроценты);
	АктивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.РасчетыСДебиторамиКомиссия);
	АктивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.ОбеспечительныйПлатеж);
	АктивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.ПроцентыПоДисконтированию);
	Запрос.УстановитьПараметр("АктивныеСчетаПриРеклассификации", АктивныеСчетаПриРеклассификации);
	
	ПассивныеСчетаПриРеклассификации = Новый Массив;
	ПассивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.АвансыПолученные);
	ПассивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.РасчетыСПоставщиками);
	ПассивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.РасчетыСКредиторамиОсновнойДолг);
	ПассивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.РасчетыСКредиторамиПроценты);
	ПассивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.ВыкупнаяСтоимость);
	ПассивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.АрендныеОбязательства);
	ПассивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.УслугаПоАренде);
	Запрос.УстановитьПараметр("ПассивныеСчетаПриРеклассификации", ПассивныеСчетаПриРеклассификации);
	
	#КонецОбласти
	
	Возврат Запрос;
	
КонецФункции

Функция ЗапросСопоставлений(ПодготовкаДанныхДляСопоставления = Истина) Экспорт
	
	МассивТекстовЗапроса = Новый Массив;
	
	Если ПодготовкаДанныхДляСопоставления Тогда
		Запрос = ЗапросОбработкиДанных();
		МассивТекстовЗапроса.Добавить(Запрос.Текст);
	Иначе
		Запрос = Новый Запрос;
	КонецЕсли;
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	Данные.Ссылка                       КАК Ссылка,
	|	Данные.Период                       КАК Период,
	|	НАЧАЛОПЕРИОДА(Данные.Период, ДЕНЬ)  КАК ДатаОтражения,
	|	Данные.ИдентификаторСтроки          КАК ИдентификаторСтроки,
	|
	|	Данные.Организация                  КАК Организация,
	|
	|	Данные.Сумма                        КАК Сумма,
	|	Данные.СуммаУУ                      КАК СуммаУУ,
	|	
	|	Данные.ВидСчетаДт                   КАК ВидСчетаДт,
	|	Данные.ОбъектУчетаДт                КАК ОбъектУчетаДт,
	|	Данные.АналитикаУчетаДт             КАК АналитикаУчетаДт,
	|	Данные.МестоУчетаДт                 КАК МестоУчетаДт,
	|	Данные.ДолгосрочныйДт               КАК ДолгосрочныйДт,
	|
	|	Данные.ВалютаДт                     КАК ВалютаДт,
	|	Данные.ПодразделениеДт              КАК ПодразделениеДт,
	|	Данные.НаправлениеДеятельностиДт    КАК НаправлениеДеятельностиДт,
	|	
	|	ЕСТЬNULL(ПрочиеДт.СчетУчета, ЕСТЬNULL(СчетаДтДанных.Ссылка, &ПустаяСсылка)) КАК СчетДт,
	|
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ПрочиеДт.ИспользоватьСубконто, ЛОЖЬ)
	|		ТОГДА ПрочиеДт.ВидСубконто1
	|		КОГДА ЕСТЬNULL(СчетаДтПоМестуУчета.ИспользоватьСубконто, ЕСТЬNULL(СчетаДтПоОрганизации.ИспользоватьСубконто, ЕСТЬNULL(СчетаДтПоАналитикеУчета.ИспользоватьСубконто, ЛОЖЬ)))
	|			И ЕСТЬNULL(СчетаДтПоМестуУчета.ВидСубконто, ЕСТЬNULL(СчетаДтПоОрганизации.ВидСубконто, ЕСТЬNULL(СчетаДтПоАналитикеУчета.ВидСубконто, НЕОПРЕДЕЛЕНО)))
	|			= ЕСТЬNULL(СчетаДтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО)
	|		ТОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО)
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО) = ВидыДт1.Ссылка ТОГДА ВидыДт1.Ссылка
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО) = ВидыДт2.Ссылка ТОГДА ВидыДт2.Ссылка
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО) = ВидыДт3.Ссылка ТОГДА ВидыДт3.Ссылка
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО) = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы) ТОГДА СчетаДтДанных.ВидСубконто1
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ВидСубконтоДт1,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ПрочиеДт.ИспользоватьСубконто, ЛОЖЬ)
	|		ТОГДА ПрочиеДт.Субконто1
	|		КОГДА ЕСТЬNULL(СчетаДтПоМестуУчета.ИспользоватьСубконто, ЕСТЬNULL(СчетаДтПоОрганизации.ИспользоватьСубконто, ЕСТЬNULL(СчетаДтПоАналитикеУчета.ИспользоватьСубконто, ЛОЖЬ)))
	|			И ЕСТЬNULL(СчетаДтПоМестуУчета.ВидСубконто, ЕСТЬNULL(СчетаДтПоОрганизации.ВидСубконто, ЕСТЬNULL(СчетаДтПоАналитикеУчета.ВидСубконто, НЕОПРЕДЕЛЕНО)))
	|			= ЕСТЬNULL(СчетаДтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО)
	|		ТОГДА ЕСТЬNULL(СчетаДтПоМестуУчета.Субконто, ЕСТЬNULL(СчетаДтПоОрганизации.Субконто, ЕСТЬNULL(СчетаДтПоАналитикеУчета.Субконто, НЕОПРЕДЕЛЕНО)))
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО) = ВидыДт1.Ссылка И Данные.СубконтоДт1 <> ВидыДт1.ПустоеЗначениеСубконто ТОГДА Данные.СубконтоДт1
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО) = ВидыДт2.Ссылка И Данные.СубконтоДт2 <> ВидыДт2.ПустоеЗначениеСубконто ТОГДА Данные.СубконтоДт2
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО) = ВидыДт3.Ссылка И Данные.СубконтоДт3 <> ВидыДт3.ПустоеЗначениеСубконто ТОГДА Данные.СубконтоДт3
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО) = ВидыДт1.Ссылка И Данные.СубконтоДт1 = ВидыДт1.ПустоеЗначениеСубконто
	|			ИЛИ ЕСТЬNULL(СчетаДтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО) = ВидыДт2.Ссылка И Данные.СубконтоДт2 = ВидыДт2.ПустоеЗначениеСубконто
	|			ИЛИ ЕСТЬNULL(СчетаДтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО) = ВидыДт3.Ссылка И Данные.СубконтоДт3 = ВидыДт3.ПустоеЗначениеСубконто
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО) = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы) ТОГДА Данные.АналитикаУчетаДт
	|		ИНАЧЕ Данные.СубконтоДт1
	|	КОНЕЦ КАК СубконтоДт1,
	|
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ПрочиеДт.ИспользоватьСубконто, ЛОЖЬ)
	|		ТОГДА ПрочиеДт.ВидСубконто2
	|		КОГДА ЕСТЬNULL(СчетаДтПоМестуУчета.ИспользоватьСубконто, ЕСТЬNULL(СчетаДтПоОрганизации.ИспользоватьСубконто, ЕСТЬNULL(СчетаДтПоАналитикеУчета.ИспользоватьСубконто, ЛОЖЬ)))
	|			И ЕСТЬNULL(СчетаДтПоМестуУчета.ВидСубконто, ЕСТЬNULL(СчетаДтПоОрганизации.ВидСубконто, ЕСТЬNULL(СчетаДтПоАналитикеУчета.ВидСубконто, НЕОПРЕДЕЛЕНО)))
	|			= ЕСТЬNULL(СчетаДтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО)
	|		ТОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО)
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО) = ВидыДт1.Ссылка ТОГДА ВидыДт1.Ссылка
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО) = ВидыДт2.Ссылка ТОГДА ВидыДт2.Ссылка
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО) = ВидыДт3.Ссылка ТОГДА ВидыДт3.Ссылка
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО) = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы) ТОГДА СчетаДтДанных.ВидСубконто2
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ВидСубконтоДт2,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ПрочиеДт.ИспользоватьСубконто, ЛОЖЬ)
	|		ТОГДА ПрочиеДт.Субконто2
	|		КОГДА ЕСТЬNULL(СчетаДтПоМестуУчета.ИспользоватьСубконто, ЕСТЬNULL(СчетаДтПоОрганизации.ИспользоватьСубконто, ЕСТЬNULL(СчетаДтПоАналитикеУчета.ИспользоватьСубконто, ЛОЖЬ)))
	|			И ЕСТЬNULL(СчетаДтПоМестуУчета.ВидСубконто, ЕСТЬNULL(СчетаДтПоОрганизации.ВидСубконто, ЕСТЬNULL(СчетаДтПоАналитикеУчета.ВидСубконто, НЕОПРЕДЕЛЕНО)))
	|			= ЕСТЬNULL(СчетаДтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО)
	|		ТОГДА ЕСТЬNULL(СчетаДтПоМестуУчета.Субконто, ЕСТЬNULL(СчетаДтПоОрганизации.Субконто, ЕСТЬNULL(СчетаДтПоАналитикеУчета.Субконто, НЕОПРЕДЕЛЕНО)))
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО) = ВидыДт1.Ссылка И Данные.СубконтоДт1 <> ВидыДт1.ПустоеЗначениеСубконто ТОГДА Данные.СубконтоДт1
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО) = ВидыДт2.Ссылка И Данные.СубконтоДт2 <> ВидыДт2.ПустоеЗначениеСубконто ТОГДА Данные.СубконтоДт2
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО) = ВидыДт3.Ссылка И Данные.СубконтоДт3 <> ВидыДт3.ПустоеЗначениеСубконто ТОГДА Данные.СубконтоДт3
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО) = ВидыДт1.Ссылка И Данные.СубконтоДт1 = ВидыДт1.ПустоеЗначениеСубконто
	|			ИЛИ ЕСТЬNULL(СчетаДтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО) = ВидыДт2.Ссылка И Данные.СубконтоДт2 = ВидыДт2.ПустоеЗначениеСубконто
	|			ИЛИ ЕСТЬNULL(СчетаДтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО) = ВидыДт3.Ссылка И Данные.СубконтоДт3 = ВидыДт3.ПустоеЗначениеСубконто
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО) = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы) ТОГДА Данные.АналитикаУчетаДт
	|		ИНАЧЕ Данные.СубконтоДт2
	|	КОНЕЦ КАК СубконтоДт2,
	|
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ПрочиеДт.ИспользоватьСубконто, ЛОЖЬ)
	|		ТОГДА ПрочиеДт.ВидСубконто3
	|		КОГДА ЕСТЬNULL(СчетаДтПоМестуУчета.ИспользоватьСубконто, ЕСТЬNULL(СчетаДтПоОрганизации.ИспользоватьСубконто, ЕСТЬNULL(СчетаДтПоАналитикеУчета.ИспользоватьСубконто, ЛОЖЬ)))
	|			И ЕСТЬNULL(СчетаДтПоМестуУчета.ВидСубконто, ЕСТЬNULL(СчетаДтПоОрганизации.ВидСубконто, ЕСТЬNULL(СчетаДтПоАналитикеУчета.ВидСубконто, НЕОПРЕДЕЛЕНО)))
	|			= ЕСТЬNULL(СчетаДтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО)
	|		ТОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО)
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО) = ВидыДт1.Ссылка ТОГДА ВидыДт1.Ссылка
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО) = ВидыДт2.Ссылка ТОГДА ВидыДт2.Ссылка
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО) = ВидыДт3.Ссылка ТОГДА ВидыДт3.Ссылка
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО) = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы) ТОГДА СчетаДтДанных.ВидСубконто3
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ВидСубконтоДт3,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ПрочиеДт.ИспользоватьСубконто, ЛОЖЬ)
	|		ТОГДА ПрочиеДт.Субконто3
	|		КОГДА ЕСТЬNULL(СчетаДтПоМестуУчета.ИспользоватьСубконто, ЕСТЬNULL(СчетаДтПоОрганизации.ИспользоватьСубконто, ЕСТЬNULL(СчетаДтПоАналитикеУчета.ИспользоватьСубконто, ЛОЖЬ)))
	|			И ЕСТЬNULL(СчетаДтПоМестуУчета.ВидСубконто, ЕСТЬNULL(СчетаДтПоОрганизации.ВидСубконто, ЕСТЬNULL(СчетаДтПоАналитикеУчета.ВидСубконто, НЕОПРЕДЕЛЕНО)))
	|			= ЕСТЬNULL(СчетаДтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО)
	|		ТОГДА ЕСТЬNULL(СчетаДтПоМестуУчета.Субконто, ЕСТЬNULL(СчетаДтПоОрганизации.Субконто, ЕСТЬNULL(СчетаДтПоАналитикеУчета.Субконто, НЕОПРЕДЕЛЕНО)))
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО) = ВидыДт1.Ссылка И Данные.СубконтоДт1 <> ВидыДт1.ПустоеЗначениеСубконто ТОГДА Данные.СубконтоДт1
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО) = ВидыДт2.Ссылка И Данные.СубконтоДт2 <> ВидыДт2.ПустоеЗначениеСубконто ТОГДА Данные.СубконтоДт2
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО) = ВидыДт3.Ссылка И Данные.СубконтоДт3 <> ВидыДт3.ПустоеЗначениеСубконто ТОГДА Данные.СубконтоДт3
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО) = ВидыДт1.Ссылка И Данные.СубконтоДт1 = ВидыДт1.ПустоеЗначениеСубконто
	|			ИЛИ ЕСТЬNULL(СчетаДтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО) = ВидыДт2.Ссылка И Данные.СубконтоДт2 = ВидыДт2.ПустоеЗначениеСубконто
	|			ИЛИ ЕСТЬNULL(СчетаДтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО) = ВидыДт3.Ссылка И Данные.СубконтоДт3 = ВидыДт3.ПустоеЗначениеСубконто
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		КОГДА ЕСТЬNULL(СчетаДтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО) = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы) ТОГДА Данные.АналитикаУчетаДт
	|		ИНАЧЕ Данные.СубконтоДт3
	|	КОНЕЦ КАК СубконтоДт3,
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(СчетаДтПоМестуУчета.ИспользоватьСубконто, ЕСТЬNULL(СчетаДтПоОрганизации.ИспользоватьСубконто, ЕСТЬNULL(СчетаДтПоАналитикеУчета.ИспользоватьСубконто, ЛОЖЬ)))
	|		ТОГДА ЕСТЬNULL(СчетаДтПоМестуУчета.ВидСубконто, ЕСТЬNULL(СчетаДтПоОрганизации.ВидСубконто, ЕСТЬNULL(СчетаДтПоАналитикеУчета.ВидСубконто, НЕОПРЕДЕЛЕНО)))
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ВидСубконтоДт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(СчетаДтПоМестуУчета.ИспользоватьСубконто, ЕСТЬNULL(СчетаДтПоОрганизации.ИспользоватьСубконто, ЕСТЬNULL(СчетаДтПоАналитикеУчета.ИспользоватьСубконто, ЛОЖЬ)))
	|		ТОГДА ЕСТЬNULL(СчетаДтПоМестуУчета.Субконто, ЕСТЬNULL(СчетаДтПоОрганизации.Субконто, ЕСТЬNULL(СчетаДтПоАналитикеУчета.Субконто, НЕОПРЕДЕЛЕНО)))
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК СубконтоДт,
	|
	|	Данные.ВалютнаяСуммаДт           КАК ВалютнаяСуммаДт,
	|	Данные.КоличествоДт              КАК КоличествоДт,
	|	Данные.СуммаНУДт                 КАК СуммаНУДт,
	|	Данные.СуммаПРДт                 КАК СуммаПРДт,
	|	Данные.СуммаВРДт                 КАК СуммаВРДт,
	|
	|	Данные.ВидСчетаКт                КАК ВидСчетаКт,
	|	Данные.ОбъектУчетаКт             КАК ОбъектУчетаКт,
	|	Данные.АналитикаУчетаКт          КАК АналитикаУчетаКт,
	|	Данные.МестоУчетаКт              КАК МестоУчетаКт,
	|	Данные.ДолгосрочныйКт            КАК ДолгосрочныйКт,
	|
	|	Данные.ВалютаКт                  КАК ВалютаКт,
	|	Данные.ПодразделениеКт           КАК ПодразделениеКт,
	|	Данные.НаправлениеДеятельностиКт КАК НаправлениеДеятельностиКт,
	|	
	|	ЕСТЬNULL(ПрочиеКт.СчетУчета, ЕСТЬNULL(СчетаКтДанных.Ссылка, &ПустаяСсылка)) КАК СчетКт,
	|	
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ПрочиеКт.ИспользоватьСубконто, ЛОЖЬ)
	|		ТОГДА ПрочиеКт.ВидСубконто1
	|		КОГДА ЕСТЬNULL(СчетаКтПоМестуУчета.ИспользоватьСубконто, ЕСТЬNULL(СчетаКтПоОрганизации.ИспользоватьСубконто, ЕСТЬNULL(СчетаКтПоАналитикеУчета.ИспользоватьСубконто, ЛОЖЬ)))
	|			И ЕСТЬNULL(СчетаКтПоМестуУчета.ВидСубконто, ЕСТЬNULL(СчетаКтПоОрганизации.ВидСубконто, ЕСТЬNULL(СчетаКтПоАналитикеУчета.ВидСубконто, НЕОПРЕДЕЛЕНО)))
	|			= ЕСТЬNULL(СчетаКтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО)
	|		ТОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО)
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО) = ВидыКт1.Ссылка ТОГДА ВидыКт1.Ссылка
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО) = ВидыКт2.Ссылка ТОГДА ВидыКт2.Ссылка
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО) = ВидыКт3.Ссылка ТОГДА ВидыКт3.Ссылка
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО) = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы) ТОГДА СчетаКтДанных.ВидСубконто1
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ВидСубконтоКт1,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ПрочиеКт.ИспользоватьСубконто, ЛОЖЬ)
	|		ТОГДА ПрочиеКт.Субконто1
	|		КОГДА ЕСТЬNULL(СчетаКтПоМестуУчета.ИспользоватьСубконто, ЕСТЬNULL(СчетаКтПоОрганизации.ИспользоватьСубконто, ЕСТЬNULL(СчетаКтПоАналитикеУчета.ИспользоватьСубконто, ЛОЖЬ)))
	|			И ЕСТЬNULL(СчетаКтПоМестуУчета.ВидСубконто, ЕСТЬNULL(СчетаКтПоОрганизации.ВидСубконто, ЕСТЬNULL(СчетаКтПоАналитикеУчета.ВидСубконто, НЕОПРЕДЕЛЕНО)))
	|			= ЕСТЬNULL(СчетаКтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО)
	|		ТОГДА ЕСТЬNULL(СчетаКтПоМестуУчета.Субконто, ЕСТЬNULL(СчетаКтПоОрганизации.Субконто, ЕСТЬNULL(СчетаКтПоАналитикеУчета.Субконто, НЕОПРЕДЕЛЕНО)))
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО) = ВидыКт1.Ссылка И Данные.СубконтоКт1 = ВидыКт1.ПустоеЗначениеСубконто
	|			ИЛИ ЕСТЬNULL(СчетаКтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО) = ВидыКт2.Ссылка И Данные.СубконтоКт2 = ВидыКт2.ПустоеЗначениеСубконто
	|			ИЛИ ЕСТЬNULL(СчетаКтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО) = ВидыКт3.Ссылка И Данные.СубконтоКт3 = ВидыКт3.ПустоеЗначениеСубконто
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО) = ВидыКт1.Ссылка ТОГДА Данные.СубконтоКт1
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО) = ВидыКт2.Ссылка ТОГДА Данные.СубконтоКт2
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО) = ВидыКт3.Ссылка ТОГДА Данные.СубконтоКт3
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО) = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы) ТОГДА Данные.АналитикаУчетаКт
	|		ИНАЧЕ Данные.СубконтоКт1
	|	КОНЕЦ КАК СубконтоКт1,
	|
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ПрочиеКт.ИспользоватьСубконто, ЛОЖЬ)
	|		ТОГДА ПрочиеКт.ВидСубконто2
	|		КОГДА ЕСТЬNULL(СчетаКтПоМестуУчета.ИспользоватьСубконто, ЕСТЬNULL(СчетаКтПоОрганизации.ИспользоватьСубконто, ЕСТЬNULL(СчетаКтПоАналитикеУчета.ИспользоватьСубконто, ЛОЖЬ)))
	|			И ЕСТЬNULL(СчетаКтПоМестуУчета.ВидСубконто, ЕСТЬNULL(СчетаКтПоОрганизации.ВидСубконто, ЕСТЬNULL(СчетаКтПоАналитикеУчета.ВидСубконто, НЕОПРЕДЕЛЕНО)))
	|			= ЕСТЬNULL(СчетаКтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО)
	|		ТОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО)
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО) = ВидыКт1.Ссылка ТОГДА ВидыКт1.Ссылка
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО) = ВидыКт2.Ссылка ТОГДА ВидыКт2.Ссылка
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО) = ВидыКт3.Ссылка ТОГДА ВидыКт3.Ссылка
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО) = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы) ТОГДА СчетаКтДанных.ВидСубконто2
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ВидСубконтоКт2,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ПрочиеКт.ИспользоватьСубконто, ЛОЖЬ)
	|		ТОГДА ПрочиеКт.Субконто2
	|		КОГДА ЕСТЬNULL(СчетаКтПоМестуУчета.ИспользоватьСубконто, ЕСТЬNULL(СчетаКтПоОрганизации.ИспользоватьСубконто, ЕСТЬNULL(СчетаКтПоАналитикеУчета.ИспользоватьСубконто, ЛОЖЬ)))
	|			И ЕСТЬNULL(СчетаКтПоМестуУчета.ВидСубконто, ЕСТЬNULL(СчетаКтПоОрганизации.ВидСубконто, ЕСТЬNULL(СчетаКтПоАналитикеУчета.ВидСубконто, НЕОПРЕДЕЛЕНО)))
	|			= ЕСТЬNULL(СчетаКтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО)
	|		ТОГДА ЕСТЬNULL(СчетаКтПоМестуУчета.Субконто, ЕСТЬNULL(СчетаКтПоОрганизации.Субконто, ЕСТЬNULL(СчетаКтПоАналитикеУчета.Субконто, НЕОПРЕДЕЛЕНО)))
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО) = ВидыКт1.Ссылка И Данные.СубконтоКт1 = ВидыКт1.ПустоеЗначениеСубконто
	|			ИЛИ ЕСТЬNULL(СчетаКтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО) = ВидыКт2.Ссылка И Данные.СубконтоКт2 = ВидыКт2.ПустоеЗначениеСубконто
	|			ИЛИ ЕСТЬNULL(СчетаКтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО) = ВидыКт3.Ссылка И Данные.СубконтоКт3 = ВидыКт3.ПустоеЗначениеСубконто
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО) = ВидыКт1.Ссылка ТОГДА Данные.СубконтоКт1
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО) = ВидыКт2.Ссылка ТОГДА Данные.СубконтоКт2
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО) = ВидыКт3.Ссылка ТОГДА Данные.СубконтоКт3
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО) = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы) ТОГДА Данные.АналитикаУчетаКт
	|		ИНАЧЕ Данные.СубконтоКт2
	|	КОНЕЦ КАК СубконтоКт2,
	|
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ПрочиеКт.ИспользоватьСубконто, ЛОЖЬ)
	|		ТОГДА ПрочиеКт.ВидСубконто3
	|		КОГДА ЕСТЬNULL(СчетаКтПоМестуУчета.ИспользоватьСубконто, ЕСТЬNULL(СчетаКтПоОрганизации.ИспользоватьСубконто, ЕСТЬNULL(СчетаКтПоАналитикеУчета.ИспользоватьСубконто, ЛОЖЬ)))
	|			И ЕСТЬNULL(СчетаКтПоМестуУчета.ВидСубконто, ЕСТЬNULL(СчетаКтПоОрганизации.ВидСубконто, ЕСТЬNULL(СчетаКтПоАналитикеУчета.ВидСубконто, НЕОПРЕДЕЛЕНО)))
	|			= ЕСТЬNULL(СчетаКтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО)
	|		ТОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО)
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО) = ВидыКт1.Ссылка ТОГДА ВидыКт1.Ссылка
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО) = ВидыКт2.Ссылка ТОГДА ВидыКт2.Ссылка
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО) = ВидыКт3.Ссылка ТОГДА ВидыКт3.Ссылка
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО) = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы) ТОГДА СчетаКтДанных.ВидСубконто3
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ВидСубконтоКт3,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ПрочиеКт.ИспользоватьСубконто, ЛОЖЬ)
	|		ТОГДА ПрочиеКт.Субконто3
	|		КОГДА ЕСТЬNULL(СчетаКтПоМестуУчета.ИспользоватьСубконто, ЕСТЬNULL(СчетаКтПоОрганизации.ИспользоватьСубконто, ЕСТЬNULL(СчетаКтПоАналитикеУчета.ИспользоватьСубконто, ЛОЖЬ)))
	|			И ЕСТЬNULL(СчетаКтПоМестуУчета.ВидСубконто, ЕСТЬNULL(СчетаКтПоОрганизации.ВидСубконто, ЕСТЬNULL(СчетаКтПоАналитикеУчета.ВидСубконто, НЕОПРЕДЕЛЕНО)))
	|			= ЕСТЬNULL(СчетаКтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО)
	|		ТОГДА ЕСТЬNULL(СчетаКтПоМестуУчета.Субконто, ЕСТЬNULL(СчетаКтПоОрганизации.Субконто, ЕСТЬNULL(СчетаКтПоАналитикеУчета.Субконто, НЕОПРЕДЕЛЕНО)))
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО) = ВидыКт1.Ссылка И Данные.СубконтоКт1 = ВидыКт1.ПустоеЗначениеСубконто
	|			ИЛИ ЕСТЬNULL(СчетаКтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО) = ВидыКт2.Ссылка И Данные.СубконтоКт2 = ВидыКт2.ПустоеЗначениеСубконто
	|			ИЛИ ЕСТЬNULL(СчетаКтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО) = ВидыКт3.Ссылка И Данные.СубконтоКт3 = ВидыКт3.ПустоеЗначениеСубконто
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО) = ВидыКт1.Ссылка ТОГДА Данные.СубконтоКт1
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО) = ВидыКт2.Ссылка ТОГДА Данные.СубконтоКт2
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО) = ВидыКт3.Ссылка ТОГДА Данные.СубконтоКт3
	|		КОГДА ЕСТЬNULL(СчетаКтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО) = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.НоменклатурныеГруппы) ТОГДА Данные.АналитикаУчетаКт
	|		ИНАЧЕ Данные.СубконтоКт3
	|	КОНЕЦ КАК СубконтоКт3,
	|
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(СчетаКтПоМестуУчета.ИспользоватьСубконто, ЕСТЬNULL(СчетаКтПоОрганизации.ИспользоватьСубконто, ЕСТЬNULL(СчетаКтПоАналитикеУчета.ИспользоватьСубконто, ЛОЖЬ)))
	|		ТОГДА ЕСТЬNULL(СчетаКтПоМестуУчета.ВидСубконто, ЕСТЬNULL(СчетаКтПоОрганизации.ВидСубконто, ЕСТЬNULL(СчетаКтПоАналитикеУчета.ВидСубконто, НЕОПРЕДЕЛЕНО)))
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ВидСубконтоКт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(СчетаКтПоМестуУчета.ИспользоватьСубконто, ЕСТЬNULL(СчетаКтПоОрганизации.ИспользоватьСубконто, ЕСТЬNULL(СчетаКтПоАналитикеУчета.ИспользоватьСубконто, ЛОЖЬ)))
	|		ТОГДА ЕСТЬNULL(СчетаКтПоМестуУчета.Субконто, ЕСТЬNULL(СчетаКтПоОрганизации.Субконто, ЕСТЬNULL(СчетаКтПоАналитикеУчета.Субконто, НЕОПРЕДЕЛЕНО)))
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК СубконтоКт,
	|
	|	Данные.ВалютнаяСуммаКт          КАК ВалютнаяСуммаКт,
	|	Данные.КоличествоКт             КАК КоличествоКт,
	|	Данные.СуммаНУКт                КАК СуммаНУКт,
	|	Данные.СуммаПРКт                КАК СуммаПРКт,
	|	Данные.СуммаВРКт                КАК СуммаВРКт,
	|	
	|	Данные.Содержание               КАК Содержание,
	|	Данные.Сторно                   КАК Сторно
	|
	|ПОМЕСТИТЬ РезультатСопоставления
	|
	|ИЗ
	|	ДанныеДляСопоставления КАК Данные
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		Счета КАК СчетаДтПоМестуУчета
	|	ПО 
	|		Данные.Организация = СчетаДтПоМестуУчета.Организация
	|		И Данные.АналитикаУчетаДт = СчетаДтПоМестуУчета.АналитикаУчета
	|		И Данные.МестоУчетаДт = СчетаДтПоМестуУчета.МестоУчета
	|		И Данные.ВидСчетаДт = СчетаДтПоМестуУчета.ВидСчетаРеглУчета
	|		И Данные.ДолгосрочныйДт = СчетаДтПоМестуУчета.Долгосрочный
	|		И НЕ (Данные.ОбъектУчетаДт = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
	|			И Данные.ВидСчетаДт В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы),
	|						ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СписаниеРасходовОСНО),
	|						ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СписаниеРасходовЕНВД)))
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		Счета КАК СчетаДтПоОрганизации
	|	ПО 
	|		Данные.Организация = СчетаДтПоОрганизации.Организация
	|		И Данные.АналитикаУчетаДт = СчетаДтПоОрганизации.АналитикаУчета
	|		И СчетаДтПоОрганизации.МестоУчета = НЕОПРЕДЕЛЕНО
	|		И Данные.ВидСчетаДт = СчетаДтПоОрганизации.ВидСчетаРеглУчета
	|		И Данные.ДолгосрочныйДт = СчетаДтПоОрганизации.Долгосрочный
	|		И НЕ (Данные.ОбъектУчетаДт = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
	|			И Данные.ВидСчетаДт В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы),
	|						ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СписаниеРасходовОСНО),
	|						ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СписаниеРасходовЕНВД)))
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		Счета КАК СчетаДтПоАналитикеУчета
	|	ПО 
	|		СчетаДтПоАналитикеУчета.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|		И Данные.АналитикаУчетаДт = СчетаДтПоАналитикеУчета.АналитикаУчета
	|		И СчетаДтПоАналитикеУчета.МестоУчета = НЕОПРЕДЕЛЕНО
	|		И Данные.ВидСчетаДт = СчетаДтПоАналитикеУчета.ВидСчетаРеглУчета
	|		И Данные.ДолгосрочныйДт = СчетаДтПоАналитикеУчета.Долгосрочный
	|		И НЕ (Данные.ОбъектУчетаДт = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
	|			И Данные.ВидСчетаДт В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы),
	|						ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СписаниеРасходовОСНО),
	|						ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СписаниеРасходовЕНВД)))
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ПланХозрасчетный КАК СчетаДтДанных
	|	ПО
	|		ЕСТЬNULL(СчетаДтПоМестуУчета.СчетУчета, ЕСТЬNULL(СчетаДтПоОрганизации.СчетУчета, ЕСТЬNULL(СчетаДтПоАналитикеУчета.СчетУчета, Данные.СчетДт))) = СчетаДтДанных.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВидыСубконто КАК ВидыДт1
	|	ПО
	|		(ВидыДт1.Ссылка = ЕСТЬNULL(СчетаДтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО)
	|		ИЛИ ВидыДт1.Ссылка = ЕСТЬNULL(СчетаДтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО)
	|		ИЛИ ВидыДт1.Ссылка = ЕСТЬNULL(СчетаДтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО)
	|			И СчетаДтДанных.ВидСубконто1 ЕСТЬ NULL И СчетаДтДанных.ВидСубконто2 ЕСТЬ NULL
	|		ИЛИ ВидыДт1.Ссылка = ЕСТЬNULL(СчетаДтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО)
	|			И ТИПЗНАЧЕНИЯ(Данные.СубконтоДт1) <> ТИПЗНАЧЕНИЯ(Данные.СубконтоДт3)
	|			И НЕ СчетаДтДанных.ТипЗначенияСубконто3СовпадаетСПредыдущимиСубконто)
	|		И ВидыДт1.ТипЗначения = ТИПЗНАЧЕНИЯ(Данные.СубконтоДт1)
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВидыСубконто КАК ВидыДт2
	|	ПО
	|		(ВидыДт2.Ссылка = ЕСТЬNULL(СчетаДтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО)
	|		И ЕСТЬNULL(ВидыДт1.Ссылка, 0) <> ЕСТЬNULL(СчетаДтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО)
	|		ИЛИ ВидыДт2.Ссылка = ЕСТЬNULL(СчетаДтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО)
	|		ИЛИ ВидыДт2.Ссылка = ЕСТЬNULL(СчетаДтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО)
	|			И СчетаДтДанных.ВидСубконто1 ЕСТЬ NULL И СчетаДтДанных.ВидСубконто2 ЕСТЬ NULL
	|		ИЛИ ВидыДт2.Ссылка = ЕСТЬNULL(СчетаДтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО)
	|			И ТИПЗНАЧЕНИЯ(Данные.СубконтоДт2) <> ТИПЗНАЧЕНИЯ(Данные.СубконтоДт3)
	|			И НЕ СчетаДтДанных.ТипЗначенияСубконто3СовпадаетСПредыдущимиСубконто)
	|		И ВидыДт2.ТипЗначения = ТИПЗНАЧЕНИЯ(Данные.СубконтоДт2)
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВидыСубконто КАК ВидыДт3
	|	ПО
	|		(ВидыДт3.Ссылка = ЕСТЬNULL(СчетаДтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО)
	|		И ЕСТЬNULL(ВидыДт1.Ссылка, 0) <> ЕСТЬNULL(СчетаДтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО)
	|		И ЕСТЬNULL(ВидыДт2.Ссылка, 0) <> ЕСТЬNULL(СчетаДтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО)
	|		ИЛИ ВидыДт3.Ссылка = ЕСТЬNULL(СчетаДтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО)
	|		И ЕСТЬNULL(ВидыДт1.Ссылка, 0) <> ЕСТЬNULL(СчетаДтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО)
	|		И ЕСТЬNULL(ВидыДт2.Ссылка, 0) <> ЕСТЬNULL(СчетаДтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО)
	|		ИЛИ ВидыДт3.Ссылка = ЕСТЬNULL(СчетаДтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО))
	|		И ВидыДт3.ТипЗначения = ТИПЗНАЧЕНИЯ(Данные.СубконтоДт3)
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		ПрочиеСчета КАК ПрочиеДт
	|	ПО 
	|		Данные.Организация = ПрочиеДт.Организация
	|		И Данные.Ссылка = ПрочиеДт.Документ 
	|		И Данные.ВидСчетаДт = ПрочиеДт.ВидСчетаРеглУчета
	|		И Данные.ИдентификаторСтроки = ПрочиеДт.ИдентификаторСтроки
	|		И ПрочиеДт.СчетУчета <> &ПустаяСсылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		Счета КАК СчетаКтПоМестуУчета
	|	ПО
	|		Данные.Организация = СчетаКтПоМестуУчета.Организация
	|		И Данные.АналитикаУчетаКт = СчетаКтПоМестуУчета.АналитикаУчета
	|		И Данные.МестоУчетаКт = СчетаКтПоМестуУчета.МестоУчета
	|		И Данные.ВидСчетаКт = СчетаКтПоМестуУчета.ВидСчетаРеглУчета
	|		И Данные.ДолгосрочныйКт = СчетаКтПоМестуУчета.Долгосрочный
	|		И НЕ (Данные.ОбъектУчетаКт = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
	|			И Данные.ВидСчетаКт В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы),
	|						ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СписаниеРасходовОСНО),
	|						ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СписаниеРасходовЕНВД)))
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		Счета КАК СчетаКтПоОрганизации
	|	ПО
	|		Данные.Организация = СчетаКтПоОрганизации.Организация
	|		И Данные.АналитикаУчетаКт = СчетаКтПоОрганизации.АналитикаУчета
	|		И СчетаКтПоОрганизации.МестоУчета = НЕОПРЕДЕЛЕНО
	|		И Данные.ВидСчетаКт = СчетаКтПоОрганизации.ВидСчетаРеглУчета
	|		И Данные.ДолгосрочныйКт = СчетаКтПоОрганизации.Долгосрочный
	|		И НЕ (Данные.ОбъектУчетаКт = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
	|			И Данные.ВидСчетаКт В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы),
	|						ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СписаниеРасходовОСНО),
	|						ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СписаниеРасходовЕНВД)))
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		Счета КАК СчетаКтПоАналитикеУчета
	|	ПО
	|		СчетаКтПоАналитикеУчета.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|		И Данные.АналитикаУчетаКт = СчетаКтПоАналитикеУчета.АналитикаУчета
	|		И СчетаКтПоАналитикеУчета.МестоУчета = НЕОПРЕДЕЛЕНО
	|		И Данные.ВидСчетаКт = СчетаКтПоАналитикеУчета.ВидСчетаРеглУчета
	|		И Данные.ДолгосрочныйКт = СчетаКтПоАналитикеУчета.Долгосрочный
	|		И НЕ (Данные.ОбъектУчетаКт = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
	|			И Данные.ВидСчетаКт В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы),
	|						ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СписаниеРасходовОСНО),
	|						ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СписаниеРасходовЕНВД)))
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ПланХозрасчетный КАК СчетаКтДанных
	|	ПО
	|		ЕСТЬNULL(СчетаКтПоМестуУчета.СчетУчета, ЕСТЬNULL(СчетаКтПоОрганизации.СчетУчета, ЕСТЬNULL(СчетаКтПоАналитикеУчета.СчетУчета, Данные.СчетКт))) = СчетаКтДанных.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВидыСубконто КАК ВидыКт1
	|	ПО
	|		(ВидыКт1.Ссылка = ЕСТЬNULL(СчетаКтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО)
	|		ИЛИ ВидыКт1.Ссылка = ЕСТЬNULL(СчетаКтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО)
	|		ИЛИ ВидыКт1.Ссылка = ЕСТЬNULL(СчетаКтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО)
	|			И СчетаКтДанных.ВидСубконто1 ЕСТЬ NULL И СчетаКтДанных.ВидСубконто2 ЕСТЬ NULL
	|		ИЛИ ВидыКт1.Ссылка = ЕСТЬNULL(СчетаКтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО)
	|			И ТИПЗНАЧЕНИЯ(Данные.СубконтоКт1) <> ТИПЗНАЧЕНИЯ(Данные.СубконтоКт3)
	|			И НЕ СчетаКтДанных.ТипЗначенияСубконто3СовпадаетСПредыдущимиСубконто)
	|		И ВидыКт1.ТипЗначения = ТИПЗНАЧЕНИЯ(Данные.СубконтоКт1)
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВидыСубконто КАК ВидыКт2
	|	ПО
	|		(ВидыКт2.Ссылка = ЕСТЬNULL(СчетаКтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО)
	|		И ЕСТЬNULL(ВидыКт1.Ссылка, 0) <> ЕСТЬNULL(СчетаКтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО)
	|		ИЛИ ВидыКт2.Ссылка = ЕСТЬNULL(СчетаКтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО)
	|		ИЛИ ВидыКт2.Ссылка = ЕСТЬNULL(СчетаКтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО)
	|			И СчетаКтДанных.ВидСубконто1 ЕСТЬ NULL И СчетаКтДанных.ВидСубконто2 ЕСТЬ NULL
	|		ИЛИ ВидыКт2.Ссылка = ЕСТЬNULL(СчетаКтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО)
	|			И ТИПЗНАЧЕНИЯ(Данные.СубконтоКт2) <> ТИПЗНАЧЕНИЯ(Данные.СубконтоКт3)
	|			И НЕ СчетаКтДанных.ТипЗначенияСубконто3СовпадаетСПредыдущимиСубконто)
	|		И ВидыКт2.ТипЗначения = ТИПЗНАЧЕНИЯ(Данные.СубконтоКт2)
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ВидыСубконто КАК ВидыКт3
	|	ПО
	|		(ВидыКт3.Ссылка = ЕСТЬNULL(СчетаКтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО)
	|		И ЕСТЬNULL(ВидыКт1.Ссылка, 0) <> ЕСТЬNULL(СчетаКтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО)
	|		И ЕСТЬNULL(ВидыКт2.Ссылка, 0) <> ЕСТЬNULL(СчетаКтДанных.ВидСубконто1, НЕОПРЕДЕЛЕНО)
	|		ИЛИ ВидыКт3.Ссылка = ЕСТЬNULL(СчетаКтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО)
	|		И ЕСТЬNULL(ВидыКт1.Ссылка, 0) <> ЕСТЬNULL(СчетаКтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО)
	|		И ЕСТЬNULL(ВидыКт2.Ссылка, 0) <> ЕСТЬNULL(СчетаКтДанных.ВидСубконто2, НЕОПРЕДЕЛЕНО)
	|		ИЛИ ВидыКт3.Ссылка = ЕСТЬNULL(СчетаКтДанных.ВидСубконто3, НЕОПРЕДЕЛЕНО))
	|		И ВидыКт3.ТипЗначения = ТИПЗНАЧЕНИЯ(Данные.СубконтоКт3)
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		ПрочиеСчета КАК ПрочиеКт
	|	ПО 
	|		Данные.Организация = ПрочиеКт.Организация 
	|		И Данные.Ссылка = ПрочиеКт.Документ 
	|		И Данные.ВидСчетаКт = ПрочиеКт.ВидСчетаРеглУчета
	|		И Данные.ИдентификаторСтроки = ПрочиеКт.ИдентификаторСтроки
	|		И ПрочиеКт.СчетУчета <> &ПустаяСсылка
	|		
	|ГДЕ
	|	ИСТИНА";
	
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#Область ВТПолученияНалогообложенияПрибыли
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	Данные.Ссылка КАК Ссылка,
	|	Данные.ДатаОтражения КАК Период,
	|	Данные.Организация КАК Организация,
	|	Данные.ПодразделениеДт КАК Подразделение,
	|	Данные.НаправлениеДеятельностиДт КАК НаправлениеДеятельности,
	|	Данные.ОбъектУчетаДт КАК Статья
	|ПОМЕСТИТЬ ВТПолученияНалогообложенияПрибыли
	|ИЗ
	|	РезультатСопоставления КАК Данные
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		УчетнаяПолитикаОрганизаций КАК УчетнаяПолитикаОрганизаций
	|	ПО 
	|		УчетнаяПолитикаОрганизаций.Ссылка = Данные.Ссылка
	|		И УчетнаяПолитикаОрганизаций.Организация = Данные.Организация
	|		И УчетнаяПолитикаОрганизаций.ДатаОтражения = Данные.ДатаОтражения
	|		И УчетнаяПолитикаОрганизаций.РаздельныйУчетПоНалогуНаПрибыль
	|
	|ГДЕ
	|	Данные.ВидСчетаДт В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Доходы),
	|						ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы),
	|						ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СписаниеРасходовОСНО),
	|						ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СписаниеРасходовЕНВД))
	|	И Данные.СчетДт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажу),
	|												ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_УправленческиеРасходы),
	|												ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеДоходы),
	|												ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы))
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Данные.Ссылка КАК Ссылка,
	|	Данные.ДатаОтражения КАК Период,
	|	Данные.Организация КАК Организация,
	|	Данные.ПодразделениеКт КАК Подразделение,
	|	Данные.НаправлениеДеятельностиКт КАК НаправлениеДеятельности,
	|	Данные.ОбъектУчетаКт КАК Статья
	|ИЗ
	|	РезультатСопоставления КАК Данные
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		УчетнаяПолитикаОрганизаций КАК УчетнаяПолитикаОрганизаций
	|	ПО 
	|		УчетнаяПолитикаОрганизаций.Ссылка = Данные.Ссылка
	|		И УчетнаяПолитикаОрганизаций.Организация = Данные.Организация
	|		И УчетнаяПолитикаОрганизаций.ДатаОтражения = Данные.ДатаОтражения
	|		И УчетнаяПолитикаОрганизаций.РаздельныйУчетПоНалогуНаПрибыль
	|
	|ГДЕ
	|	Данные.ВидСчетаКт В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Доходы),
	|						ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы),
	|						ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СписаниеРасходовОСНО),
	|						ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СписаниеРасходовЕНВД))
	|	И Данные.СчетКт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажу),
	|												ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_УправленческиеРасходы),
	|												ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеДоходы),
	|												ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы),
	|												ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Выручка))";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область РаздельныйУчет_НастройкиНалогообложенияПрибылиПостобработка
	ПараметрыПолученияНалогообложенияПрибыли = РаздельныйУчетПоНалогуНаПрибыль.НовыйПараметрыПолученияТаблицыНастроекНалогообложенияПрибыли();
	ПараметрыПолученияНалогообложенияПрибыли.ИмяТаблицы = "ВТПолученияНалогообложенияПрибыли";
	ПараметрыПолученияНалогообложенияПрибыли.ИмяПоля_Период = "Период";
	ПараметрыПолученияНалогообложенияПрибыли.ИмяПоля_Организация = "Организация";
	ПараметрыПолученияНалогообложенияПрибыли.ИмяПоля_Подразделение = "Подразделение";
	ПараметрыПолученияНалогообложенияПрибыли.ИмяПоля_НаправлениеДеятельности = "НаправлениеДеятельности";
	ПараметрыПолученияНалогообложенияПрибыли.ИмяПоля_ОбъектУчета = "Статья";
	ТекстЗапроса = РаздельныйУчетПоНалогуНаПрибыль.ТекстЗапроса_НастройкиНалогообложенияПрибыли(ПараметрыПолученияНалогообложенияПрибыли);
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "ПОМЕСТИТЬ РаздельныйУчет_НастройкиНалогообложенияПрибыли", "ПОМЕСТИТЬ РаздельныйУчет_НастройкиНалогообложенияПрибылиПостобработка");
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	МассивТекстовЗапроса.Добавить("УНИЧТОЖИТЬ ВТПолученияНалогообложенияПрибыли");
	#КонецОбласти
	
	Запрос.Текст = СтрСоединить(МассивТекстовЗапроса, ОбщегоНазначения.РазделительПакетаЗапросов());
	Запрос.УстановитьПараметр("ПустаяСсылка", ПланыСчетов.Хозрасчетный.ПустаяСсылка());
	
	Возврат Запрос;
	
КонецФункции

Функция ЗапросПроверки() Экспорт
	Возврат Новый Запрос("
		|ВЫБРАТЬ
		|	
		|	ХЗ.Ссылка                       КАК Ссылка,
		|	ХЗ.ИдентификаторСтроки          КАК ИдентификаторСтроки,
		|	ХЗ.Организация                  КАК Организация,
		|	ХЗ.ДатаОтражения                КАК ДатаОтражения,
		|	
		|	ХЗ.ВидСчетаДт                   КАК ВидСчетаДт,
		|	ХЗ.АналитикаУчетаДт             КАК АналитикаУчетаДт,
		|	ХЗ.МестоУчетаДт                 КАК МестоУчетаДт,
		|	ХЗ.ДолгосрочныйДт               КАК ДолгосрочныйДт,
		|	ХЗ.СчетДт                       КАК СчетДт,
		|	(ВЫБОР
		|		КОГДА ПланДт.ЗапретитьИспользоватьВПроводках ТОГДА ""СЧЕТ_ЗАПРЕЩЕН""
		|		КОГДА (ЕСТЬNULL(ПланДт.Забалансовый, ЛОЖЬ) ИЛИ НЕ ЗабалансовыеВидыСчетовДт.Ссылка ЕСТЬ NULL)
		|				И НЕ ЕСТЬNULL(ПланКт.Забалансовый, ЛОЖЬ) И ЗабалансовыеВидыСчетовКт.Ссылка ЕСТЬ NULL И НЕ ПланКт.Ссылка ЕСТЬ NULL
		|			ТОГДА ""СЧЕТ_ЗАБАЛАНСОВЫЙ""
		|		КОГДА НЕ ЕСТЬNULL(ПланКт.Забалансовый, ЛОЖЬ) И ЗабалансовыеВидыСчетовКт.Ссылка ЕСТЬ NULL И ПланДт.Ссылка ЕСТЬ NULL
		|			ТОГДА ""СЧЕТ_ПУСТОЙ""
		|		КОГДА НЕ ЗабалансовыеВидыСчетовДт.Ссылка ЕСТЬ NULL И ПланДт.Ссылка ЕСТЬ NULL
		|			ТОГДА ""СЧЕТ_ПУСТОЙ""
		|		ИНАЧЕ """" КОНЕЦ) КАК КодОшибкиДт,
		|	ВЫБОР
		|		КОГДА ХЗ.АналитикаУчетаДт = ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаДоходовРасходов.ПустаяСсылка)
		|			И ХЗ.ВидСчетаДт В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы),
		|								ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СписаниеРасходовОСНО),
		|								ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СписаниеРасходовЕНВД),
		|								ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Доходы))
		|			И (НЕ ЕСТЬNULL(ПланКт.Забалансовый, ЛОЖЬ) И ЗабалансовыеВидыСчетовКт.Ссылка ЕСТЬ NULL И ПланДт.Ссылка ЕСТЬ NULL
		|			ИЛИ НЕ ЗабалансовыеВидыСчетовДт.Ссылка ЕСТЬ NULL И ПланДт.Ссылка ЕСТЬ NULL)
		|		ТОГДА ХЗ.ОбъектУчетаДт
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СтатьяДт,
		|
		|	ХЗ.ВидСчетаКт                  КАК ВидСчетаКт,
		|	ХЗ.АналитикаУчетаКт            КАК АналитикаУчетаКт,
		|	ХЗ.МестоУчетаКт                КАК МестоУчетаКт,
		|	ХЗ.ДолгосрочныйКт              КАК ДолгосрочныйКт,
		|	ХЗ.СчетКт                      КАК СчетКт,
		|	(ВЫБОР
		|		КОГДА ПланКт.ЗапретитьИспользоватьВПроводках ТОГДА ""СЧЕТ_ЗАПРЕЩЕН""
		|		КОГДА (ЕСТЬNULL(ПланКт.Забалансовый, ЛОЖЬ) ИЛИ НЕ ЗабалансовыеВидыСчетовКт.Ссылка ЕСТЬ NULL)
		|				И НЕ ЕСТЬNULL(ПланДт.Забалансовый, ЛОЖЬ) И ЗабалансовыеВидыСчетовДт.Ссылка ЕСТЬ NULL И НЕ ПланДт.Ссылка ЕСТЬ NULL
		|			ТОГДА ""СЧЕТ_ЗАБАЛАНСОВЫЙ""
		|		КОГДА НЕ ЕСТЬNULL(ПланДт.Забалансовый, ЛОЖЬ) И ЗабалансовыеВидыСчетовДт.Ссылка ЕСТЬ NULL И ПланКт.Ссылка ЕСТЬ NULL
		|			ТОГДА ""СЧЕТ_ПУСТОЙ""
		|		КОГДА НЕ ЗабалансовыеВидыСчетовКт.Ссылка ЕСТЬ NULL И ПланКт.Ссылка ЕСТЬ NULL
		|			ТОГДА ""СЧЕТ_ПУСТОЙ""
		|		ИНАЧЕ """" КОНЕЦ) КАК КодОшибкиКт,
		|	ВЫБОР
		|		КОГДА ХЗ.АналитикаУчетаКт = ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаДоходовРасходов.ПустаяСсылка)
		|			И ХЗ.ВидСчетаКт В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы),
		|								ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СписаниеРасходовОСНО),
		|								ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СписаниеРасходовЕНВД),
		|								ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Доходы))
		|			И (НЕ ЕСТЬNULL(ПланДт.Забалансовый, ЛОЖЬ) И ЗабалансовыеВидыСчетовДт.Ссылка ЕСТЬ NULL И ПланКт.Ссылка ЕСТЬ NULL
		|			ИЛИ НЕ ЗабалансовыеВидыСчетовКт.Ссылка ЕСТЬ NULL И ПланКт.Ссылка ЕСТЬ NULL)
		|		ТОГДА ХЗ.ОбъектУчетаКт
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СтатьяКт
		|	
		|ПОМЕСТИТЬ ОшибкиПроверки
		|ИЗ
		|	РезультатСопоставления КАК ХЗ
		|	ЛЕВОЕ СОЕДИНЕНИЕ ПланХозрасчетный КАК ПланДт
		|		ПО ПланДт.Ссылка = ХЗ.СчетДт
		|	ЛЕВОЕ СОЕДИНЕНИЕ ПланХозрасчетный КАК ПланКт
		|		ПО ПланКт.Ссылка = ХЗ.СчетКт
		|	ЛЕВОЕ СОЕДИНЕНИЕ Перечисление.ВидыСчетовРеглУчета КАК ЗабалансовыеВидыСчетовДт
		|		ПО ЗабалансовыеВидыСчетовДт.Ссылка = ХЗ.ВидСчетаДт
		|			И ЗабалансовыеВидыСчетовДт.Ссылка В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦВЭксплуатацииЗаБалансом),
		|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗабалансовыйУчетВНА),
		|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦНаСкладах),
		|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦВПроизводстве),
		|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦПотребленныеВПроизводстве),
		|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦУХранителей),
		|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦКСписанию),
		|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработку),
		|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуВПроизводстве),
		|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПотребленныеВПроизводстве),
		|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуУХранителей),
		|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуКСписанию),
		|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыНаСкладе),
		|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыПереданныеНаКомиссию))
		|	ЛЕВОЕ СОЕДИНЕНИЕ Перечисление.ВидыСчетовРеглУчета КАК ЗабалансовыеВидыСчетовКт
		|		ПО ЗабалансовыеВидыСчетовКт.Ссылка = ХЗ.ВидСчетаКт
		|			И ЗабалансовыеВидыСчетовКт.Ссылка В (ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦВЭксплуатацииЗаБалансом),
		|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗабалансовыйУчетВНА),
		|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦНаСкладах),
		|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦВПроизводстве),
		|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦПотребленныеВПроизводстве),
		|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦУХранителей),
		|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦКСписанию),
		|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработку),
		|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуВПроизводстве),
		|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПотребленныеВПроизводстве),
		|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуУХранителей),
		|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуКСписанию),
		|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыНаСкладе),
		|												ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыПереданныеНаКомиссию))
		|ГДЕ (ЛОЖЬ
		|	//// для балансового (не забалансового) счета должна быть задана корреспонденция
		|	ИЛИ НЕ ПланДт.Забалансовый И ЗабалансовыеВидыСчетовДт.Ссылка ЕСТЬ NULL И ПланКт.Ссылка ЕСТЬ NULL
		|	ИЛИ НЕ ПланКт.Забалансовый И ЗабалансовыеВидыСчетовКт.Ссылка ЕСТЬ NULL И ПланДт.Ссылка ЕСТЬ NULL
		|	//// Для забалансового счета корреспонденция может быть только с забалансовым
		|	ИЛИ (ПланДт.Забалансовый ИЛИ НЕ ЗабалансовыеВидыСчетовДт.Ссылка ЕСТЬ NULL)
		|		И НЕ (ПланКт.Забалансовый ИЛИ НЕ ЗабалансовыеВидыСчетовКт.Ссылка ЕСТЬ NULL)
		|	ИЛИ (ПланКт.Забалансовый ИЛИ НЕ ЗабалансовыеВидыСчетовКт.Ссылка ЕСТЬ NULL)
		|		И НЕ (ПланДт.Забалансовый ИЛИ НЕ ЗабалансовыеВидыСчетовДт.Ссылка ЕСТЬ NULL)
		|	//// оба счета не заданы
		|	ИЛИ ПланДт.Ссылка ЕСТЬ NULL И ПланКт.Ссылка ЕСТЬ NULL
		|	//// счет дебета или счет кредита запрещен к использованию
		|	ИЛИ ПланДт.ЗапретитьИспользоватьВПроводках
		|	ИЛИ ПланКт.ЗапретитьИспользоватьВПроводках
		|	//// Для забалансового вида счета должны проверять наличие соответстующего счета для него:
		|	ИЛИ НЕ ЗабалансовыеВидыСчетовДт.Ссылка ЕСТЬ NULL И ПланДт.Ссылка ЕСТЬ NULL
		|	ИЛИ НЕ ЗабалансовыеВидыСчетовКт.Ссылка ЕСТЬ NULL И ПланКт.Ссылка ЕСТЬ NULL)
		|	И (ХЗ.Сумма + ХЗ.СуммаУУ + ХЗ.СуммаНУДт + ХЗ.СуммаНУКт + ХЗ.КоличествоДт + ХЗ.КоличествоКт <> 0
		|	ИЛИ	ХЗ.СуммаПРДт + ХЗ.СуммаПРКт - ХЗ.СуммаВРДт - ХЗ.СуммаВРКт <> 0)
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ХЗ.Ссылка,
		|	ХЗ.Организация
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	ОП.Ссылка              КАК Ссылка,
		|	ОП.ИдентификаторСтроки КАК ИдентификаторСтроки,
		|	ОП.Организация         КАК Организация,
		|	ОП.ДатаОтражения       КАК ДатаОтражения,
		|	ОП.ВидСчета            КАК ВидСчета,
		|	ОП.АналитикаУчета КАК АналитикаУчета,
		|	ОП.МестоУчета          КАК МестоУчета,
		|	ОП.Долгосрочный        КАК Долгосрочный,
		|	ОП.Счет                КАК Счет,
		|	ВЫБОР
		|		КОГДА ОП.КодОшибки = ""СЧЕТ_ПУСТОЙ"" И ОП.Статья <> НЕОПРЕДЕЛЕНО
		|			И ОП.АналитикаУчета = ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаДоходовРасходов.ПустаяСсылка)
		|		ТОГДА ОП.Статья
		|		КОГДА ГФУ.Ссылка ЕСТЬ NULL
		|		ТОГДА """"
		|		КОГДА ГФУ.РасчетыСКомиссионерами И НЕ ГФУ.РасчетыСКлиентами И НЕ ГФУ.РасчетыСКомитентами
		|		ТОГДА ""РасчетыСКомиссионерами""
		|		КОГДА ГФУ.РасчетыСКомитентами И НЕ ГФУ.РасчетыСПоставщиками И НЕ ГФУ.РасчетыСКомиссионерами
		|		ТОГДА ""РасчетыСКомитентами""
		|		КОГДА ГФУ.РасчетыСКредиторами
		|		ТОГДА ""РасчетыСКредиторами""
		|		КОГДА ГФУ.РасчетыСДебиторами
		|		ТОГДА ""РасчетыСДебиторами""
		|		КОГДА ГФУ.РасчетыСАрендодателями
		|		ТОГДА ""РасчетыСАрендодателями""
		|		КОГДА ГФУ.РасчетыСКомитентамиПоЗакупке
		|		ТОГДА ""РасчетыСКомитентамиПоЗакупке""
		|		КОГДА ГФУ.РасчетыСПереработчиками
		|		ТОГДА ""РасчетыСПереработчиками""
		|		КОГДА ГФУ.РасчетыСДавальцами
		|		ТОГДА ""РасчетыСДавальцами""
		|		КОГДА ГФУ.РасчетыСКлиентами И НЕ ГФУ.РасчетыСПоставщиками
		|		ТОГДА ""РасчетыСКлиентами""
		|		КОГДА ГФУ.РасчетыСПоставщиками И НЕ ГФУ.РасчетыСКлиентами
		|		ТОГДА ""РасчетыСПоставщиками""
		|		ИНАЧЕ """"
		|	КОНЕЦ КАК ДопИнформация,
		|	ВЫБОР
		|		КОГДА ОП.КодОшибки = ""СЧЕТ_ПУСТОЙ"" И ОП.Статья <> НЕОПРЕДЕЛЕНО
		|			И ОП.АналитикаУчета = ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаДоходовРасходов.ПустаяСсылка)
		|		ТОГДА ""АНАЛИТИКА_ПУСТАЯ""
		|		ИНАЧЕ ОП.КодОшибки
		|	КОНЕЦ КАК КодОшибки
		|ИЗ (
		|	ВЫБРАТЬ
		|		ОП.Ссылка КАК Ссылка,
		|		ОП.ИдентификаторСтроки КАК ИдентификаторСтроки,
		|		ОП.Организация КАК Организация,
		|		ОП.ДатаОтражения КАК ДатаОтражения,
		|		ОП.ВидСчетаДт КАК ВидСчета,
		|		ОП.АналитикаУчетаДт КАК АналитикаУчета,
		|		ОП.МестоУчетаДт КАК МестоУчета,
		|		ОП.ДолгосрочныйДт КАК Долгосрочный,
		|		ОП.СчетДт КАК Счет,
		|		ОП.КодОшибкиДт КАК КодОшибки,
		|		ОП.СтатьяДт КАК Статья
		|	ИЗ
		|		ОшибкиПроверки КАК ОП
		|	ГДЕ
		|		ОП.КодОшибкиДт <> """"
		|	ОБЪЕДИНИТЬ ВСЕ
		|	ВЫБРАТЬ
		|		ОП.Ссылка КАК Ссылка,
		|		ОП.ИдентификаторСтроки,
		|		ОП.Организация КАК Организация,
		|		ОП.ДатаОтражения КАК ДатаОтражения,
		|		ОП.ВидСчетаКт КАК ВидСчета,
		|		ОП.АналитикаУчетаКт КАК АналитикаУчета,
		|		ОП.МестоУчетаКт КАК МестоУчета,
		|		ОП.ДолгосрочныйКт КАК Долгосрочный,
		|		ОП.СчетКт КАК Счет,
		|		ОП.КодОшибкиКт КАК КодОшибки,
		|		ОП.СтатьяКт КАК Статья
		|	ИЗ
		|		ОшибкиПроверки КАК ОП
		|	ГДЕ
		|		ОП.КодОшибкиКт <> """"
		|) КАК ОП
		|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ГруппыФинансовогоУчетаРасчетов КАК ГФУ
		|	ПО ОП.АналитикаУчета = ГФУ.Ссылка
		|
		|УПОРЯДОЧИТЬ ПО
		|	Ссылка, Организация, ДатаОтражения
		|
		|ИТОГИ ПО
		|	Ссылка, Организация, ДатаОтражения
		|");
КонецФункции

Функция ЗапросХозрасчетный() Экспорт
	
	Запрос = Новый Запрос("
		|ВЫБРАТЬ
		|	ХЗ.Ссылка КАК Ссылка,
		|	ХЗ.Период КАК Период,
		|	ХЗ.Организация КАК Организация,
		|
		|	СУММА(ХЗ.Сумма)   КАК Сумма,
		|	СУММА(ХЗ.СуммаУУ) КАК СуммаУУ,
		|	СУММА(ВЫБОР 
		|			КОГДА ПланДт.Валютный И ХЗ.ВалютаДт = &ВалютаФинОтчетности
		|				ТОГДА ХЗ.ВалютнаяСуммаДт
		|			КОГДА ПланКт.Валютный И ХЗ.ВалютаКт = &ВалютаФинОтчетности
		|				ТОГДА ХЗ.ВалютнаяСуммаКт
		|			КОГДА &ИсточникСуммыДляПересчетаВВалютуФО = ЗНАЧЕНИЕ(Перечисление.ИсточникиСуммыДляПересчетаВВалютуФинОтчетности.БУ)
		|				ТОГДА ХЗ.Сумма / КурсыВалютыФинОтчетности.Курс
		|			КОГДА &ИсточникСуммыДляПересчетаВВалютуФО = ЗНАЧЕНИЕ(Перечисление.ИсточникиСуммыДляПересчетаВВалютуФинОтчетности.УУ)
		|				ТОГДА ХЗ.СуммаУУ * КурсыВалютыУпрУчета.Курс / КурсыВалютыФинОтчетности.Курс
		|			КОНЕЦ) КАК СуммаФО,
		|		
		|	(ВЫБОР КОГДА ПланДт.Валютный ТОГДА ХЗ.ВалютаДт ИНАЧЕ ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КОНЕЦ) КАК ВалютаДт,
		|	(ВЫБОР КОГДА ПланДт.УчетПоПодразделениям ТОГДА ХЗ.ПодразделениеДт
		|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка) КОНЕЦ) КАК ПодразделениеДт,
		|	(ВЫБОР КОГДА ПланДт.УчетПоНаправлениямДеятельности ТОГДА ХЗ.НаправлениеДеятельностиДт
		|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КОНЕЦ) КАК НаправлениеДеятельностиДт,
		|	ХЗ.СчетДт КАК СчетДт,
		|
		|	(ВЫБОР
		|		КОГДА ХЗ.ВидСубконтоДт1 <> НЕОПРЕДЕЛЕНО ТОГДА ХЗ.ВидСубконтоДт1
		|		КОГДА (ВидыДт1.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоДт) ТОГДА ХЗ.ВидСубконтоДт
		|		КОГДА ПланДт.ВидСубконто1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|			И НЕ ТаблицаНалогообложенияПрибылиДт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ПланДт.ВидСубконто1
		|		ИНАЧЕ ЕСТЬNULL(ВидыДт1.Ссылка, ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПустаяСсылка))
		|	КОНЕЦ) КАК ВидСубконтоДт1,
		|	(ВЫБОР
		|		КОГДА ХЗ.ВидСубконтоДт1 <> НЕОПРЕДЕЛЕНО ТОГДА ХЗ.СубконтоДт1
		|		КОГДА (ВидыДт1.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоДт) ТОГДА ХЗ.СубконтоДт
		|		КОГДА ПланДт.ВидСубконто1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|			И НЕ ТаблицаНалогообложенияПрибылиДт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ТаблицаНалогообложенияПрибылиДт.ВариантНалогообложенияПрибыли
		|		КОГДА (ВидыДт1.Ссылка ЕСТЬ NULL) ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ХЗ.СубконтоДт1
		|	КОНЕЦ) КАК СубконтоДт1,
		|
		|	(ВЫБОР
		|		КОГДА ХЗ.ВидСубконтоДт2 <> НЕОПРЕДЕЛЕНО ТОГДА ХЗ.ВидСубконтоДт2
		|		КОГДА (ВидыДт1.Ссылка <> ХЗ.ВидСубконтоДт) И (ВидыДт2.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоДт)
		|			ТОГДА ХЗ.ВидСубконтоДт
		|		КОГДА ПланДт.ВидСубконто2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|			И НЕ ТаблицаНалогообложенияПрибылиДт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ПланДт.ВидСубконто2
		|		ИНАЧЕ ЕСТЬNULL(ВидыДт2.Ссылка, ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПустаяСсылка)) КОНЕЦ) КАК ВидСубконтоДт2,
		|	(ВЫБОР
		|		КОГДА ХЗ.ВидСубконтоДт2 <> НЕОПРЕДЕЛЕНО ТОГДА ХЗ.СубконтоДт2
		|		КОГДА (ВидыДт1.Ссылка <> ХЗ.ВидСубконтоДт) И (ВидыДт2.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоДт)
		|		ТОГДА ХЗ.СубконтоДт
		|		КОГДА ПланДт.ВидСубконто2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|			И НЕ ТаблицаНалогообложенияПрибылиДт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ТаблицаНалогообложенияПрибылиДт.ВариантНалогообложенияПрибыли
		|		КОГДА (ВидыДт2.Ссылка ЕСТЬ NULL)
		|		ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ХЗ.СубконтоДт2
		|	КОНЕЦ) КАК СубконтоДт2,
		|
		|	(ВЫБОР
		|		КОГДА ХЗ.ВидСубконтоДт3 <> НЕОПРЕДЕЛЕНО ТОГДА ХЗ.ВидСубконтоДт3
		|		КОГДА (НЕ ХЗ.ВидСубконтоДт В (ВидыДт1.Ссылка, ВидыДт2.Ссылка)) И (ВидыДт3.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоДт)
		|			ТОГДА ХЗ.ВидСубконтоДт
		|		КОГДА ПланДт.ВидСубконто3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|			И НЕ ТаблицаНалогообложенияПрибылиДт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ПланДт.ВидСубконто3
		|		ИНАЧЕ ЕСТЬNULL(ВидыДт3.Ссылка, ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПустаяСсылка)) КОНЕЦ) КАК ВидСубконтоДт3,
		|	(ВЫБОР
		|		КОГДА ХЗ.ВидСубконтоДт3 <> НЕОПРЕДЕЛЕНО ТОГДА ХЗ.СубконтоДт3
		|		КОГДА (НЕ ХЗ.ВидСубконтоДт В (ВидыДт1.Ссылка, ВидыДт2.Ссылка)) И (ВидыДт3.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоДт)
		|		ТОГДА ХЗ.СубконтоДт
		|		КОГДА ПланДт.ВидСубконто3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|			И НЕ ТаблицаНалогообложенияПрибылиДт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ТаблицаНалогообложенияПрибылиДт.ВариантНалогообложенияПрибыли
		|		КОГДА (ВидыДт3.Ссылка ЕСТЬ NULL)
		|		ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ХЗ.СубконтоДт3
		|	КОНЕЦ) КАК СубконтоДт3,
		|
		|	СУММА(ВЫБОР КОГДА ПланДт.Валютный ТОГДА ХЗ.ВалютнаяСуммаДт ИНАЧЕ 0.0 КОНЕЦ) КАК ВалютнаяСуммаДт,
		|	СУММА(ВЫБОР КОГДА ПланДт.Количественный ТОГДА ХЗ.КоличествоДт ИНАЧЕ 0.0 КОНЕЦ) КАК КоличествоДт,
		|	СУММА(ВЫБОР КОГДА ПланДт.НалоговыйУчет ТОГДА ХЗ.СуммаНУДт ИНАЧЕ 0.0 КОНЕЦ) КАК СуммаНУДт,
		|	СУММА(ВЫБОР КОГДА ПланДт.НалоговыйУчет ТОГДА ХЗ.СуммаПРДт ИНАЧЕ 0.0 КОНЕЦ) КАК СуммаПРДт,
		|	СУММА(ВЫБОР КОГДА ПланДт.НалоговыйУчет ТОГДА ХЗ.СуммаВРДт ИНАЧЕ 0.0 КОНЕЦ) КАК СуммаВРДт,
		|
		|	(ВЫБОР КОГДА ПланКт.Валютный ТОГДА ХЗ.ВалютаКт ИНАЧЕ ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КОНЕЦ) КАК ВалютаКт,
		|	(ВЫБОР КОГДА ПланКт.УчетПоПодразделениям ТОГДА ХЗ.ПодразделениеКт
		|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка) КОНЕЦ) КАК ПодразделениеКт,
		|	(ВЫБОР КОГДА ПланКт.УчетПоНаправлениямДеятельности ТОГДА ХЗ.НаправлениеДеятельностиКт
		|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КОНЕЦ) КАК НаправлениеДеятельностиКт,
		|	ХЗ.СчетКт КАК СчетКт,
		|
		|	(ВЫБОР
		|		КОГДА ХЗ.ВидСубконтоКт1 <> НЕОПРЕДЕЛЕНО ТОГДА ХЗ.ВидСубконтоКт1
		|		КОГДА (ВидыКт1.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоКт) ТОГДА ХЗ.ВидСубконтоКт
		|		КОГДА ПланКт.ВидСубконто1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|			И НЕ ТаблицаНалогообложенияПрибылиКт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ПланКт.ВидСубконто1
		|		ИНАЧЕ ЕСТЬNULL(ВидыКт1.Ссылка, ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПустаяСсылка))
		|	КОНЕЦ) КАК ВидСубконтоКт1,
		|	(ВЫБОР
		|		КОГДА ХЗ.ВидСубконтоКт1 <> НЕОПРЕДЕЛЕНО ТОГДА ХЗ.СубконтоКт1
		|		КОГДА (ВидыКт1.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоКт) ТОГДА ХЗ.СубконтоКт
		|		КОГДА ПланКт.ВидСубконто1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|			И НЕ ТаблицаНалогообложенияПрибылиКт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ТаблицаНалогообложенияПрибылиКт.ВариантНалогообложенияПрибыли
		|		КОГДА (ВидыКт1.Ссылка ЕСТЬ NULL) ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ХЗ.СубконтоКт1
		|	КОНЕЦ) КАК СубконтоКт1,
		|
		|	(ВЫБОР
		|		КОГДА ХЗ.ВидСубконтоКт2 <> НЕОПРЕДЕЛЕНО ТОГДА ХЗ.ВидСубконтоКт2
		|		КОГДА (ВидыКт1.Ссылка <> ХЗ.ВидСубконтоКт) И (ВидыКт2.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоКт)
		|			ТОГДА ХЗ.ВидСубконтоКт
		|		КОГДА ПланКт.ВидСубконто2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|			И НЕ ТаблицаНалогообложенияПрибылиКт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ПланКт.ВидСубконто2
		|		ИНАЧЕ ЕСТЬNULL(ВидыКт2.Ссылка, ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПустаяСсылка)) КОНЕЦ) КАК ВидСубконтоКт2,
		|	(ВЫБОР
		|		КОГДА ХЗ.ВидСубконтоКт2 <> НЕОПРЕДЕЛЕНО ТОГДА ХЗ.СубконтоКт2
		|		КОГДА (ВидыКт1.Ссылка <> ХЗ.ВидСубконтоКт) И (ВидыКт2.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоКт)
		|		ТОГДА ХЗ.СубконтоКт
		|		КОГДА ПланКт.ВидСубконто2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|			И НЕ ТаблицаНалогообложенияПрибылиКт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ТаблицаНалогообложенияПрибылиКт.ВариантНалогообложенияПрибыли
		|		КОГДА (ВидыКт2.Ссылка ЕСТЬ NULL)
		|		ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ХЗ.СубконтоКт2
		|	КОНЕЦ) КАК СубконтоКт2,
		|
		|	(ВЫБОР
		|		КОГДА ХЗ.ВидСубконтоКт3 <> НЕОПРЕДЕЛЕНО ТОГДА ХЗ.ВидСубконтоКт3
		|		КОГДА (НЕ ХЗ.ВидСубконтоКт В (ВидыКт1.Ссылка, ВидыКт2.Ссылка)) И (ВидыКт3.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоКт)
		|			ТОГДА ХЗ.ВидСубконтоКт
		|		КОГДА ПланКт.ВидСубконто3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|			И НЕ ТаблицаНалогообложенияПрибылиКт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ПланКт.ВидСубконто3
		|		ИНАЧЕ ЕСТЬNULL(ВидыКт3.Ссылка, ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПустаяСсылка)) КОНЕЦ) КАК ВидСубконтоКт3,
		|	(ВЫБОР
		|		КОГДА ХЗ.ВидСубконтоКт3 <> НЕОПРЕДЕЛЕНО ТОГДА ХЗ.СубконтоКт3
		|		КОГДА (НЕ ХЗ.ВидСубконтоКт В (ВидыКт1.Ссылка, ВидыКт2.Ссылка)) И (ВидыКт3.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоКт)
		|		ТОГДА ХЗ.СубконтоКт
		|		КОГДА ПланКт.ВидСубконто3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|			И НЕ ТаблицаНалогообложенияПрибылиКт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ТаблицаНалогообложенияПрибылиКт.ВариантНалогообложенияПрибыли
		|		КОГДА (ВидыКт3.Ссылка ЕСТЬ NULL)
		|		ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ХЗ.СубконтоКт3
		|	КОНЕЦ) КАК СубконтоКт3,
		|
		|	СУММА(ВЫБОР КОГДА ПланКт.Валютный ТОГДА ХЗ.ВалютнаяСуммаКт ИНАЧЕ 0.0 КОНЕЦ) КАК ВалютнаяСуммаКт,
		|	СУММА(ВЫБОР КОГДА ПланКт.Количественный ТОГДА ХЗ.КоличествоКт ИНАЧЕ 0.0 КОНЕЦ) КАК КоличествоКт,
		|	СУММА(ВЫБОР КОГДА ПланКт.НалоговыйУчет ТОГДА ХЗ.СуммаНУКт ИНАЧЕ 0.0 КОНЕЦ) КАК СуммаНУКт,
		|	СУММА(ВЫБОР КОГДА ПланКт.НалоговыйУчет ТОГДА ХЗ.СуммаПРКт ИНАЧЕ 0.0 КОНЕЦ) КАК СуммаПРКт,
		|	СУММА(ВЫБОР КОГДА ПланКт.НалоговыйУчет ТОГДА ХЗ.СуммаВРКт ИНАЧЕ 0.0 КОНЕЦ) КАК СуммаВРКт,
		|	
		|	ХЗ.Содержание КАК Содержание,
		|	ХЗ.Сторно КАК Сторно
		|
		|ПОМЕСТИТЬ Хозрасчетный
		|ИЗ
		|	РезультатСопоставления КАК ХЗ
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ 
		|		ОшибкиПроверки КАК ОшибкиПроверки 
		|	ПО
		|		ХЗ.Ссылка = ОшибкиПроверки.Ссылка
		|		И ХЗ.Организация = ОшибкиПроверки.Организация
		|		И ХЗ.ДатаОтражения = ОшибкиПроверки.ДатаОтражения
		|
		|	ЛЕВОЕ СОЕДИНЕНИЕ 
		|		РаздельныйУчет_НастройкиНалогообложенияПрибылиПостобработка КАК ТаблицаНалогообложенияПрибылиДт
		|	ПО 
		|		ТаблицаНалогообложенияПрибылиДт.Период = ХЗ.ДатаОтражения
		|		И ТаблицаНалогообложенияПрибылиДт.Организация = ХЗ.Организация
		|		И ТаблицаНалогообложенияПрибылиДт.Подразделение = ХЗ.ПодразделениеДт
		|		И ТаблицаНалогообложенияПрибылиДт.ОбъектУчета = ХЗ.ОбъектУчетаДт
		|		И ТаблицаНалогообложенияПрибылиДт.НаправлениеДеятельности = ХЗ.НаправлениеДеятельностиДт
		|		И ХЗ.СчетДт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажу),
		|									ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_УправленческиеРасходы),
		|									ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеДоходы),
		|									ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы),
		|									ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_НДС))
		|
		|	ЛЕВОЕ СОЕДИНЕНИЕ 
		|		РаздельныйУчет_НастройкиНалогообложенияПрибылиПостобработка КАК ТаблицаНалогообложенияПрибылиКт
		|	ПО 
		|		ТаблицаНалогообложенияПрибылиКт.Период = ХЗ.ДатаОтражения
		|		И ТаблицаНалогообложенияПрибылиКт.Организация = ХЗ.Организация
		|		И ТаблицаНалогообложенияПрибылиКт.Подразделение = ХЗ.ПодразделениеКт
		|		И ТаблицаНалогообложенияПрибылиКт.ОбъектУчета = ХЗ.ОбъектУчетаКт
		|		И ТаблицаНалогообложенияПрибылиКт.НаправлениеДеятельности = ХЗ.НаправлениеДеятельностиКт
		|		И ХЗ.СчетКт В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_РасходыНаПродажу),
		|									ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_УправленческиеРасходы),
		|									ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеДоходы),
		|									ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы),
		|									ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_НДС))
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ 
		|		ПланХозрасчетный КАК ПланДт
		|	ПО 
		|		ХЗ.СчетДт = ПланДт.Ссылка
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ 
		|		ВидыСубконто КАК ВидыДт1
		|	ПО 
		|		ВидыДт1.Ссылка В (
		|				ВЫБОР КОГДА ХЗ.ВидСубконтоДт1 = НЕОПРЕДЕЛЕНО ТОГДА ПланДт.ВидСубконто1 ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ,
		|				ВЫБОР КОГДА ХЗ.ВидСубконтоДт2 = НЕОПРЕДЕЛЕНО ТОГДА ПланДт.ВидСубконто2 ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ,
		|				ВЫБОР КОГДА ХЗ.ВидСубконтоДт3 = НЕОПРЕДЕЛЕНО ТОГДА ПланДт.ВидСубконто3 ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ)
		|		И ВидыДт1.ТипЗначения = ТИПЗНАЧЕНИЯ(ХЗ.СубконтоДт1)
		|		
		|		
		|	ЛЕВОЕ СОЕДИНЕНИЕ 
		|		ВидыСубконто КАК ВидыДт2
		|	ПО 
		|		ВидыДт2.Ссылка В (
		|				ВЫБОР КОГДА ХЗ.ВидСубконтоДт1 = НЕОПРЕДЕЛЕНО ТОГДА ПланДт.ВидСубконто1 ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ,
		|				ВЫБОР КОГДА ХЗ.ВидСубконтоДт2 = НЕОПРЕДЕЛЕНО ТОГДА ПланДт.ВидСубконто2 ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ,
		|				ВЫБОР КОГДА ХЗ.ВидСубконтоДт3 = НЕОПРЕДЕЛЕНО ТОГДА ПланДт.ВидСубконто3 ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ)
		|		И ВидыДт2.ТипЗначения = ТИПЗНАЧЕНИЯ(ХЗ.СубконтоДт2)
		|		И ВидыДт2.Ссылка <> ЕСТЬNULL(ВидыДт1.Ссылка, НЕОПРЕДЕЛЕНО)
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ 
		|		ВидыСубконто КАК ВидыДт3
		|	ПО 
		|		ВидыДт3.Ссылка В (
		|				ВЫБОР КОГДА ХЗ.ВидСубконтоДт1 = НЕОПРЕДЕЛЕНО ТОГДА ПланДт.ВидСубконто1 ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ,
		|				ВЫБОР КОГДА ХЗ.ВидСубконтоДт2 = НЕОПРЕДЕЛЕНО ТОГДА ПланДт.ВидСубконто2 ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ,
		|				ВЫБОР КОГДА ХЗ.ВидСубконтоДт3 = НЕОПРЕДЕЛЕНО ТОГДА ПланДт.ВидСубконто3 ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ)
		|		И ВидыДт3.ТипЗначения = ТИПЗНАЧЕНИЯ(ХЗ.СубконтоДт3)
		|		И ВидыДт3.Ссылка <> ЕСТЬNULL(ВидыДт1.Ссылка, НЕОПРЕДЕЛЕНО)
		|		И ВидыДт3.Ссылка <> ЕСТЬNULL(ВидыДт2.Ссылка, НЕОПРЕДЕЛЕНО)
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ 
		|		ПланХозрасчетный КАК ПланКт
		|	ПО 
		|		ХЗ.СчетКт = ПланКт.Ссылка
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ 
		|		ВидыСубконто КАК ВидыКт1
		|	ПО 
		|		ВидыКт1.Ссылка В (
		|				ВЫБОР КОГДА ХЗ.ВидСубконтоКт1 = НЕОПРЕДЕЛЕНО ТОГДА ПланКт.ВидСубконто1 ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ,
		|				ВЫБОР КОГДА ХЗ.ВидСубконтоКт2 = НЕОПРЕДЕЛЕНО ТОГДА ПланКт.ВидСубконто2 ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ,
		|				ВЫБОР КОГДА ХЗ.ВидСубконтоКт3 = НЕОПРЕДЕЛЕНО ТОГДА ПланКт.ВидСубконто3 ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ)
		|		И ВидыКт1.ТипЗначения = ТИПЗНАЧЕНИЯ(ХЗ.СубконтоКт1)
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ 
		|		ВидыСубконто КАК ВидыКт2
		|	ПО 
		|		ВидыКт2.Ссылка В (
		|				ВЫБОР КОГДА ХЗ.ВидСубконтоКт1 = НЕОПРЕДЕЛЕНО ТОГДА ПланКт.ВидСубконто1 ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ,
		|				ВЫБОР КОГДА ХЗ.ВидСубконтоКт2 = НЕОПРЕДЕЛЕНО ТОГДА ПланКт.ВидСубконто2 ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ,
		|				ВЫБОР КОГДА ХЗ.ВидСубконтоКт3 = НЕОПРЕДЕЛЕНО ТОГДА ПланКт.ВидСубконто3 ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ)
		|		И ВидыКт2.ТипЗначения = ТИПЗНАЧЕНИЯ(ХЗ.СубконтоКт2)
		|		И ВидыКт2.Ссылка <> ЕСТЬNULL(ВидыКт1.Ссылка, НЕОПРЕДЕЛЕНО)
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ
		|		ВидыСубконто КАК ВидыКт3
		|	ПО 
		|		ВидыКт3.Ссылка В (
		|				ВЫБОР КОГДА ХЗ.ВидСубконтоКт1 = НЕОПРЕДЕЛЕНО ТОГДА ПланКт.ВидСубконто1 ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ,
		|				ВЫБОР КОГДА ХЗ.ВидСубконтоКт2 = НЕОПРЕДЕЛЕНО ТОГДА ПланКт.ВидСубконто2 ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ,
		|				ВЫБОР КОГДА ХЗ.ВидСубконтоКт3 = НЕОПРЕДЕЛЕНО ТОГДА ПланКт.ВидСубконто3 ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ)
		|		И ВидыКт3.ТипЗначения = ТИПЗНАЧЕНИЯ(ХЗ.СубконтоКт3)
		|		И ВидыКт3.Ссылка <> ЕСТЬNULL(ВидыКт1.Ссылка, НЕОПРЕДЕЛЕНО)
		|		И ВидыКт3.Ссылка <> ЕСТЬNULL(ВидыКт2.Ссылка, НЕОПРЕДЕЛЕНО)
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ
		|		УчетнаяПолитикаОрганизаций КАК УчетнаяПолитикаОрганизаций
		|	ПО
		|		ХЗ.Ссылка = УчетнаяПолитикаОрганизаций.Ссылка
		|		И ХЗ.Организация = УчетнаяПолитикаОрганизаций.Организация
		|		И ХЗ.ДатаОтражения = УчетнаяПолитикаОрганизаций.ДатаОтражения
		|
		|	ЛЕВОЕ СОЕДИНЕНИЕ
		|		КурсыВалют КАК КурсыВалютыФинОтчетности
		|	ПО
		|		КурсыВалютыФинОтчетности.Валюта = &ВалютаФинОтчетности
		|		И ХЗ.ДатаОтражения = КурсыВалютыФинОтчетности.Дата
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ
		|		КурсыВалют КАК КурсыВалютыУпрУчета
		|	ПО
		|		КурсыВалютыУпрУчета.Валюта = &ВалютаУпрУчета
		|		И ХЗ.ДатаОтражения = КурсыВалютыУпрУчета.Дата
		|
		|ГДЕ
		|	ОшибкиПроверки.Ссылка ЕСТЬ NULL
		|	И (ХЗ.Сумма <> 0
		|		ИЛИ ХЗ.СуммаУУ <> 0
		|		ИЛИ (ВЫБОР КОГДА ПланДт.Валютный ТОГДА ХЗ.ВалютнаяСуммаДт <> 0 ИНАЧЕ ЛОЖЬ КОНЕЦ)
		|		ИЛИ (ВЫБОР КОГДА ПланДт.Количественный ТОГДА ХЗ.КоличествоДт <> 0 ИНАЧЕ ЛОЖЬ КОНЕЦ)
		|		ИЛИ (ВЫБОР 
		|				КОГДА ЕСТЬNULL(УчетнаяПолитикаОрганизаций.СистемаНалогообложения, ЗНАЧЕНИЕ(Перечисление.СистемыНалогообложения.Общая)) = ЗНАЧЕНИЕ(Перечисление.СистемыНалогообложения.Общая) 
		|					  И ПланДт.НалоговыйУчет
		|					ТОГДА ХЗ.СуммаНУДт <> 0 ИЛИ ХЗ.СуммаПРДт <> 0 ИЛИ ХЗ.СуммаВРДт <> 0
		|				ИНАЧЕ ЛОЖЬ 
		|			КОНЕЦ)  
		|		ИЛИ (ВЫБОР КОГДА ПланКт.Валютный ТОГДА ХЗ.ВалютнаяСуммаКт <> 0 ИНАЧЕ ЛОЖЬ КОНЕЦ)
		|		ИЛИ (ВЫБОР КОГДА ПланКт.Количественный ТОГДА ХЗ.КоличествоКт <> 0 ИНАЧЕ ЛОЖЬ КОНЕЦ)
		|		ИЛИ (ВЫБОР 
		|				КОГДА ЕСТЬNULL(УчетнаяПолитикаОрганизаций.СистемаНалогообложения, ЗНАЧЕНИЕ(Перечисление.СистемыНалогообложения.Общая)) = ЗНАЧЕНИЕ(Перечисление.СистемыНалогообложения.Общая) 
		|					  И ПланКт.НалоговыйУчет
		|					ТОГДА ХЗ.СуммаНУКт <> 0 ИЛИ ХЗ.СуммаПРКт <> 0 ИЛИ ХЗ.СуммаВРКт <> 0
		|				ИНАЧЕ ЛОЖЬ 
		|			КОНЕЦ))
		|	И (ХЗ.СчетДт <> ХЗ.СчетКт
		|		ИЛИ (ВЫБОР
		|				КОГДА ХЗ.ВидСубконтоДт1 <> НЕОПРЕДЕЛЕНО 
		|					ТОГДА ХЗ.СубконтоДт1
		|				КОГДА (ВидыДт1.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоДт) 
		|					ТОГДА ЕСТЬNULL(ХЗ.СубконтоДт, НЕОПРЕДЕЛЕНО)
		|				КОГДА ПланДт.ВидСубконто1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|					И НЕ ТаблицаНалогообложенияПрибылиДт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ТаблицаНалогообложенияПрибылиДт.ВариантНалогообложенияПрибыли
		|				КОГДА (ВидыДт1.Ссылка ЕСТЬ NULL) 
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ХЗ.СубконтоДт1 КОНЕЦ) <>
		|			(ВЫБОР
		|				КОГДА ХЗ.ВидСубконтоКт1 <> НЕОПРЕДЕЛЕНО 
		|					ТОГДА ХЗ.СубконтоКт1
		|				КОГДА (ВидыКт1.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоКт) 
		|					ТОГДА ЕСТЬNULL(ХЗ.СубконтоКт, НЕОПРЕДЕЛЕНО)
		|				КОГДА ПланКт.ВидСубконто1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|					И НЕ ТаблицаНалогообложенияПрибылиКт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ТаблицаНалогообложенияПрибылиКт.ВариантНалогообложенияПрибыли
		|				КОГДА (ВидыКт1.Ссылка ЕСТЬ NULL) 
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ХЗ.СубконтоКт1 КОНЕЦ)
		|		ИЛИ (ВЫБОР
		|				КОГДА ХЗ.ВидСубконтоДт2 <> НЕОПРЕДЕЛЕНО
		|				ТОГДА ХЗ.СубконтоДт2
		|				КОГДА (ВидыДт1.Ссылка <> ХЗ.ВидСубконтоДт) И (ВидыДт2.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоДт)
		|				ТОГДА ЕСТЬNULL(ХЗ.СубконтоДт, НЕОПРЕДЕЛЕНО)
		|				КОГДА ПланДт.ВидСубконто2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|					И НЕ ТаблицаНалогообложенияПрибылиДт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ТаблицаНалогообложенияПрибылиДт.ВариантНалогообложенияПрибыли
		|				КОГДА (ВидыДт2.Ссылка ЕСТЬ NULL)
		|				ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ХЗ.СубконтоДт2
		|			КОНЕЦ) <>
		|			(ВЫБОР
		|				КОГДА ХЗ.ВидСубконтоКт2 <> НЕОПРЕДЕЛЕНО
		|				ТОГДА ХЗ.СубконтоКт2
		|				КОГДА (ВидыКт1.Ссылка <> ХЗ.ВидСубконтоКт) И (ВидыКт2.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоКт)
		|					ТОГДА ЕСТЬNULL(ХЗ.СубконтоКт, НЕОПРЕДЕЛЕНО)
		|				КОГДА ПланКт.ВидСубконто2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|					И НЕ ТаблицаНалогообложенияПрибылиКт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ТаблицаНалогообложенияПрибылиКт.ВариантНалогообложенияПрибыли
		|				КОГДА 
		|					(ВидыКт2.Ссылка ЕСТЬ NULL)
		|				ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ХЗ.СубконтоКт2
		|			КОНЕЦ)
		|		ИЛИ (ВЫБОР
		|				КОГДА ХЗ.ВидСубконтоДт3 <> НЕОПРЕДЕЛЕНО
		|				ТОГДА ХЗ.СубконтоДт3
		|				КОГДА (НЕ ХЗ.ВидСубконтоДт В (ВидыДт1.Ссылка, ВидыДт2.Ссылка)) И (ВидыДт3.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоДт)
		|				ТОГДА ЕСТЬNULL(ХЗ.СубконтоДт, НЕОПРЕДЕЛЕНО)
		|				КОГДА ПланДт.ВидСубконто3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|					И НЕ ТаблицаНалогообложенияПрибылиДт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ТаблицаНалогообложенияПрибылиДт.ВариантНалогообложенияПрибыли
		|				КОГДА (ВидыДт3.Ссылка ЕСТЬ NULL)
		|				ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ХЗ.СубконтоДт3
		|			КОНЕЦ) <>
		|			(ВЫБОР
		|				КОГДА ХЗ.ВидСубконтоКт3 <> НЕОПРЕДЕЛЕНО
		|				ТОГДА ХЗ.СубконтоКт3
		|				КОГДА (НЕ ХЗ.ВидСубконтоКт В (ВидыКт1.Ссылка, ВидыКт2.Ссылка)) И (ВидыКт3.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоКт)
		|				ТОГДА ЕСТЬNULL(ХЗ.СубконтоКт, НЕОПРЕДЕЛЕНО)
		|				КОГДА ПланКт.ВидСубконто3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|					И НЕ ТаблицаНалогообложенияПрибылиКт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ТаблицаНалогообложенияПрибылиКт.ВариантНалогообложенияПрибыли
		|				КОГДА (ВидыКт3.Ссылка ЕСТЬ NULL)
		|				ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ХЗ.СубконтоКт3
		|			КОНЕЦ)
		|		ИЛИ (ВЫБОР 
		|				КОГДА ПланДт.Валютный ТОГДА ЕСТЬNULL(ХЗ.ВалютаДт, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)) 
		|				ИНАЧЕ ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) 
		|			КОНЕЦ) <>
		|			(ВЫБОР 
		|				КОГДА ПланКт.Валютный ТОГДА ЕСТЬNULL(ХЗ.ВалютаКт, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)) 
		|				ИНАЧЕ ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) 
		|			КОНЕЦ)
		|		ИЛИ (ВЫБОР 
		|				КОГДА ПланДт.УчетПоПодразделениям ТОГДА ЕСТЬNULL(ХЗ.ПодразделениеДт, ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка))
		|				ИНАЧЕ ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)
		|			КОНЕЦ) <> 
		|			(ВЫБОР 
		|				КОГДА ПланКт.УчетПоПодразделениям ТОГДА ЕСТЬNULL(ХЗ.ПодразделениеКт, ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка))
		|				ИНАЧЕ ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)
		|			КОНЕЦ)
		|		ИЛИ ((ПланДт.Количественный ИЛИ ПланКт.Количественный) И ЕСТЬNULL(ХЗ.КоличествоДт, 0) <> ЕСТЬNULL(ХЗ.КоличествоКт, 0))
		|		ИЛИ (ЕСТЬNULL(ХЗ.НаправлениеДеятельностиКт, ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)) <> ЕСТЬNULL(ХЗ.НаправлениеДеятельностиДт, ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка))))
		|
		|СГРУППИРОВАТЬ ПО
		|	ХЗ.Ссылка,
		|	ХЗ.Период,
		|	ХЗ.Организация,
		|
		|	(ВЫБОР КОГДА ПланДт.Валютный ТОГДА ХЗ.ВалютаДт ИНАЧЕ ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КОНЕЦ),
		|	(ВЫБОР КОГДА ПланДт.УчетПоПодразделениям ТОГДА ХЗ.ПодразделениеДт
		|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка) КОНЕЦ),
		|	(ВЫБОР КОГДА ПланДт.УчетПоНаправлениямДеятельности ТОГДА ХЗ.НаправлениеДеятельностиДт
		|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КОНЕЦ),
		|	ХЗ.СчетДт,
		|
		|	(ВЫБОР
		|		КОГДА ХЗ.ВидСубконтоДт1 <> НЕОПРЕДЕЛЕНО ТОГДА ХЗ.ВидСубконтоДт1
		|		КОГДА (ВидыДт1.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоДт) ТОГДА ХЗ.ВидСубконтоДт
		|		КОГДА ПланДт.ВидСубконто1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|			И НЕ ТаблицаНалогообложенияПрибылиДт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ПланДт.ВидСубконто1
		|		ИНАЧЕ ЕСТЬNULL(ВидыДт1.Ссылка, ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПустаяСсылка))
		|	КОНЕЦ),
		|	(ВЫБОР
		|		КОГДА ХЗ.ВидСубконтоДт1 <> НЕОПРЕДЕЛЕНО ТОГДА ХЗ.СубконтоДт1
		|		КОГДА (ВидыДт1.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоДт) ТОГДА ХЗ.СубконтоДт
		|		КОГДА ПланДт.ВидСубконто1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|			И НЕ ТаблицаНалогообложенияПрибылиДт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ТаблицаНалогообложенияПрибылиДт.ВариантНалогообложенияПрибыли
		|		КОГДА (ВидыДт1.Ссылка ЕСТЬ NULL) ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ХЗ.СубконтоДт1
		|	КОНЕЦ),
		|
		|	(ВЫБОР
		|		КОГДА ХЗ.ВидСубконтоДт2 <> НЕОПРЕДЕЛЕНО ТОГДА ХЗ.ВидСубконтоДт2
		|		КОГДА (ВидыДт1.Ссылка <> ХЗ.ВидСубконтоДт) И (ВидыДт2.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоДт)
		|			ТОГДА ХЗ.ВидСубконтоДт
		|		КОГДА ПланДт.ВидСубконто2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|			И НЕ ТаблицаНалогообложенияПрибылиДт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ПланДт.ВидСубконто2
		|		ИНАЧЕ ЕСТЬNULL(ВидыДт2.Ссылка, ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПустаяСсылка)) КОНЕЦ),
		|	(ВЫБОР
		|		КОГДА ХЗ.ВидСубконтоДт2 <> НЕОПРЕДЕЛЕНО ТОГДА ХЗ.СубконтоДт2
		|		КОГДА (ВидыДт1.Ссылка <> ХЗ.ВидСубконтоДт) И (ВидыДт2.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоДт)
		|		ТОГДА ХЗ.СубконтоДт
		|		КОГДА ПланДт.ВидСубконто2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|			И НЕ ТаблицаНалогообложенияПрибылиДт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ТаблицаНалогообложенияПрибылиДт.ВариантНалогообложенияПрибыли
		|		КОГДА (ВидыДт2.Ссылка ЕСТЬ NULL)
		|		ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ХЗ.СубконтоДт2
		|	КОНЕЦ),
		|
		|	(ВЫБОР
		|		КОГДА ХЗ.ВидСубконтоДт3 <> НЕОПРЕДЕЛЕНО ТОГДА ХЗ.ВидСубконтоДт3
		|		КОГДА (НЕ ХЗ.ВидСубконтоДт В (ВидыДт1.Ссылка, ВидыДт2.Ссылка)) И (ВидыДт3.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоДт)
		|			ТОГДА ХЗ.ВидСубконтоДт
		|		КОГДА ПланДт.ВидСубконто3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|			И НЕ ТаблицаНалогообложенияПрибылиДт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ПланДт.ВидСубконто3
		|		ИНАЧЕ ЕСТЬNULL(ВидыДт3.Ссылка, ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПустаяСсылка)) КОНЕЦ),
		|	(ВЫБОР
		|		КОГДА ХЗ.ВидСубконтоДт3 <> НЕОПРЕДЕЛЕНО ТОГДА ХЗ.СубконтоДт3
		|		КОГДА (НЕ ХЗ.ВидСубконтоДт В (ВидыДт1.Ссылка, ВидыДт2.Ссылка)) И (ВидыДт3.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоДт)
		|		ТОГДА ХЗ.СубконтоДт
		|		КОГДА ПланДт.ВидСубконто3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|			И НЕ ТаблицаНалогообложенияПрибылиДт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ТаблицаНалогообложенияПрибылиДт.ВариантНалогообложенияПрибыли
		|		КОГДА (ВидыДт3.Ссылка ЕСТЬ NULL)
		|		ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ХЗ.СубконтоДт3
		|	КОНЕЦ),
		|
		|	(ВЫБОР КОГДА ПланКт.Валютный ТОГДА ХЗ.ВалютаКт ИНАЧЕ ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КОНЕЦ),
		|	(ВЫБОР КОГДА ПланКт.УчетПоПодразделениям ТОГДА ХЗ.ПодразделениеКт
		|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка) КОНЕЦ),
		|	(ВЫБОР КОГДА ПланКт.УчетПоНаправлениямДеятельности ТОГДА ХЗ.НаправлениеДеятельностиКт
		|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КОНЕЦ),
		|	ХЗ.СчетКт,
		|
		|	(ВЫБОР
		|		КОГДА ХЗ.ВидСубконтоКт1 <> НЕОПРЕДЕЛЕНО ТОГДА ХЗ.ВидСубконтоКт1
		|		КОГДА (ВидыКт1.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоКт) ТОГДА ХЗ.ВидСубконтоКт
		|		КОГДА ПланКт.ВидСубконто1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|			И НЕ ТаблицаНалогообложенияПрибылиКт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ПланКт.ВидСубконто1
		|		ИНАЧЕ ЕСТЬNULL(ВидыКт1.Ссылка, ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПустаяСсылка))
		|	КОНЕЦ),
		|	(ВЫБОР
		|		КОГДА ХЗ.ВидСубконтоКт1 <> НЕОПРЕДЕЛЕНО ТОГДА ХЗ.СубконтоКт1
		|		КОГДА (ВидыКт1.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоКт) ТОГДА ХЗ.СубконтоКт
		|		КОГДА ПланКт.ВидСубконто1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|			И НЕ ТаблицаНалогообложенияПрибылиКт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ТаблицаНалогообложенияПрибылиКт.ВариантНалогообложенияПрибыли
		|		КОГДА (ВидыКт1.Ссылка ЕСТЬ NULL) ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ХЗ.СубконтоКт1
		|	КОНЕЦ),
		|
		|	(ВЫБОР
		|		КОГДА ХЗ.ВидСубконтоКт2 <> НЕОПРЕДЕЛЕНО ТОГДА ХЗ.ВидСубконтоКт2
		|		КОГДА (ВидыКт1.Ссылка <> ХЗ.ВидСубконтоКт) И (ВидыКт2.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоКт)
		|			ТОГДА ХЗ.ВидСубконтоКт
		|		КОГДА ПланКт.ВидСубконто2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|			И НЕ ТаблицаНалогообложенияПрибылиКт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ПланКт.ВидСубконто2
		|		ИНАЧЕ ЕСТЬNULL(ВидыКт2.Ссылка, ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПустаяСсылка)) КОНЕЦ),
		|	(ВЫБОР
		|		КОГДА ХЗ.ВидСубконтоКт2 <> НЕОПРЕДЕЛЕНО ТОГДА ХЗ.СубконтоКт2
		|		КОГДА (ВидыКт1.Ссылка <> ХЗ.ВидСубконтоКт) И (ВидыКт2.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоКт)
		|		ТОГДА ХЗ.СубконтоКт
		|		КОГДА ПланКт.ВидСубконто2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|			И НЕ ТаблицаНалогообложенияПрибылиКт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ТаблицаНалогообложенияПрибылиКт.ВариантНалогообложенияПрибыли
		|		КОГДА (ВидыКт2.Ссылка ЕСТЬ NULL)
		|		ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ХЗ.СубконтоКт2
		|	КОНЕЦ),
		|
		|	(ВЫБОР
		|		КОГДА ХЗ.ВидСубконтоКт3 <> НЕОПРЕДЕЛЕНО ТОГДА ХЗ.ВидСубконтоКт3
		|		КОГДА (НЕ ХЗ.ВидСубконтоКт В (ВидыКт1.Ссылка, ВидыКт2.Ссылка)) И (ВидыКт3.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоКт)
		|			ТОГДА ХЗ.ВидСубконтоКт
		|		КОГДА ПланКт.ВидСубконто3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|			И НЕ ТаблицаНалогообложенияПрибылиКт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ПланКт.ВидСубконто3
		|		ИНАЧЕ ЕСТЬNULL(ВидыКт3.Ссылка, ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПустаяСсылка)) КОНЕЦ),
		|	(ВЫБОР
		|		КОГДА ХЗ.ВидСубконтоКт3 <> НЕОПРЕДЕЛЕНО ТОГДА ХЗ.СубконтоКт3
		|		КОГДА (НЕ ХЗ.ВидСубконтоКт В (ВидыКт1.Ссылка, ВидыКт2.Ссылка)) И (ВидыКт3.Ссылка ЕСТЬ NULL) И (НЕОПРЕДЕЛЕНО <> ХЗ.ВидСубконтоКт)
		|		ТОГДА ХЗ.СубконтоКт
		|		КОГДА ПланКт.ВидСубконто3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ВариантыНалогообложенияПрибыли)
		|			И НЕ ТаблицаНалогообложенияПрибылиКт.ВариантНалогообложенияПрибыли ЕСТЬ NULL ТОГДА ТаблицаНалогообложенияПрибылиКт.ВариантНалогообложенияПрибыли
		|		КОГДА (ВидыКт3.Ссылка ЕСТЬ NULL)
		|		ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ХЗ.СубконтоКт3
		|	КОНЕЦ),
		|	
		|	ХЗ.Содержание,
		|	ХЗ.Сторно
		|
		|ИМЕЮЩИЕ
		|	СУММА(ХЗ.Сумма) <> 0.0
		|	ИЛИ СУММА(ХЗ.СуммаУУ) <> 0.0
		|	ИЛИ СУММА(ВЫБОР КОГДА ПланДт.Валютный ТОГДА ХЗ.ВалютнаяСуммаДт ИНАЧЕ 0.0 КОНЕЦ) <> 0.0
		|	ИЛИ СУММА(ВЫБОР КОГДА ПланДт.Количественный ТОГДА ХЗ.КоличествоДт ИНАЧЕ 0.0 КОНЕЦ) <> 0.0
		|	ИЛИ СУММА(ВЫБОР КОГДА ПланДт.НалоговыйУчет ТОГДА ХЗ.СуммаНУДт ИНАЧЕ 0.0 КОНЕЦ) <> 0.0
		|	ИЛИ СУММА(ВЫБОР КОГДА ПланДт.НалоговыйУчет ТОГДА ХЗ.СуммаПРДт ИНАЧЕ 0.0 КОНЕЦ) <> 0.0
		|	ИЛИ СУММА(ВЫБОР КОГДА ПланДт.НалоговыйУчет ТОГДА ХЗ.СуммаВРДт ИНАЧЕ 0.0 КОНЕЦ) <> 0.0
		|	ИЛИ СУММА(ВЫБОР КОГДА ПланКт.Валютный ТОГДА ХЗ.ВалютнаяСуммаКт ИНАЧЕ 0.0 КОНЕЦ) <> 0.0
		|	ИЛИ СУММА(ВЫБОР КОГДА ПланКт.Количественный ТОГДА ХЗ.КоличествоКт ИНАЧЕ 0.0 КОНЕЦ) <> 0.0
		|	ИЛИ СУММА(ВЫБОР КОГДА ПланКт.НалоговыйУчет ТОГДА ХЗ.СуммаНУКт ИНАЧЕ 0.0 КОНЕЦ) <> 0.0
		|	ИЛИ СУММА(ВЫБОР КОГДА ПланКт.НалоговыйУчет ТОГДА ХЗ.СуммаПРКт ИНАЧЕ 0.0 КОНЕЦ) <> 0.0
		|	ИЛИ СУММА(ВЫБОР КОГДА ПланКт.НалоговыйУчет ТОГДА ХЗ.СуммаВРКт ИНАЧЕ 0.0 КОНЕЦ) <> 0.0
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Ссылка
		|;
		|
		|////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	Хозрасчетный.Ссылка КАК Ссылка,
		|	Хозрасчетный.Период КАК Период,
		|	Хозрасчетный.Организация КАК Организация,
		|	Хозрасчетный.Сумма КАК Сумма,
		|	Хозрасчетный.СуммаУУ КАК СуммаУУ,
		|	Хозрасчетный.СуммаФО КАК СуммаФО,
		|	
		|	Хозрасчетный.ВалютаДт КАК ВалютаДт,
		|	Хозрасчетный.ПодразделениеДт КАК ПодразделениеДт,
		|	Хозрасчетный.НаправлениеДеятельностиДт КАК НаправлениеДеятельностиДт,
		|	Хозрасчетный.СчетДт КАК СчетДт,
		|	Хозрасчетный.ВидСубконтоДт1 КАК ВидСубконтоДт1,
		|	Хозрасчетный.СубконтоДт1 КАК СубконтоДт1,
		|	Хозрасчетный.ВидСубконтоДт2 КАК ВидСубконтоДт2,
		|	Хозрасчетный.СубконтоДт2 КАК СубконтоДт2,
		|	Хозрасчетный.ВидСубконтоДт3 КАК ВидСубконтоДт3,
		|	Хозрасчетный.СубконтоДт3 КАК СубконтоДт3,
		|	Хозрасчетный.ВалютнаяСуммаДт КАК ВалютнаяСуммаДт,
		|	Хозрасчетный.КоличествоДт КАК КоличествоДт,
		|	Хозрасчетный.СуммаНУДт КАК СуммаНУДт,
		|	Хозрасчетный.СуммаПРДт КАК СуммаПРДт,
		|	Хозрасчетный.СуммаВРДт КАК СуммаВРДт,
		|	
		|	Хозрасчетный.ВалютаКт КАК ВалютаКт,
		|	Хозрасчетный.ПодразделениеКт КАК ПодразделениеКт,
		|	Хозрасчетный.НаправлениеДеятельностиКт КАК НаправлениеДеятельностиКт,
		|	Хозрасчетный.СчетКт КАК СчетКт,
		|	Хозрасчетный.ВидСубконтоКт1 КАК ВидСубконтоКт1,
		|	Хозрасчетный.СубконтоКт1 КАК СубконтоКт1,
		|	Хозрасчетный.ВидСубконтоКт2 КАК ВидСубконтоКт2,
		|	Хозрасчетный.СубконтоКт2 КАК СубконтоКт2,
		|	Хозрасчетный.ВидСубконтоКт3 КАК ВидСубконтоКт3,
		|	Хозрасчетный.СубконтоКт3 КАК СубконтоКт3,
		|	Хозрасчетный.ВалютнаяСуммаКт КАК ВалютнаяСуммаКт,
		|	Хозрасчетный.КоличествоКт КАК КоличествоКт,
		|	Хозрасчетный.СуммаНУКт КАК СуммаНУКт,
		|	Хозрасчетный.СуммаПРКт КАК СуммаПРКт,
		|	Хозрасчетный.СуммаВРКт КАК СуммаВРКт,
		|	
		|	Хозрасчетный.Содержание КАК Содержание,
		|	Хозрасчетный.Сторно КАК Сторно
		|
		|ИЗ
		|	Хозрасчетный КАК Хозрасчетный
		|
		|УПОРЯДОЧИТЬ ПО
		|	Ссылка
		|	
		|ИТОГИ ПО
		|	Ссылка
		|");
	
	Запрос.УстановитьПараметр("ИсточникСуммыДляПересчетаВВалютуФО", Константы.ИсточникСуммыДляПересчетаВВалютуФинОтчетности.Получить());
	Запрос.УстановитьПараметр("ВалютаФинОтчетности",     Константы.ВалютаФинОтчетности.Получить());
	Запрос.УстановитьПараметр("ВалютаУпрУчета",          Константы.ВалютаУправленческогоУчета.Получить());
	
	Возврат Запрос;
	
КонецФункции

Функция ЗапросХозрасчетныйДополнение() Экспорт
	
	Возврат Новый Запрос(
		"ВЫБРАТЬ
		|	Хозрасчетный.Регистратор                  КАК Ссылка,
		|	НАЧАЛОПЕРИОДА(Хозрасчетный.Период, ДЕНЬ)  КАК ДатаОтражения,
		|	Хозрасчетный.Период                       КАК Период,
		|	Хозрасчетный.СчетДт                       КАК СчетДт,
		|	Хозрасчетный.СубконтоДт1                  КАК СубконтоДт1,
		|	Хозрасчетный.ВидСубконтоДт1               КАК ВидСубконтоДт1,
		|	Хозрасчетный.СубконтоДт2                  КАК СубконтоДт2,
		|	Хозрасчетный.ВидСубконтоДт2               КАК ВидСубконтоДт2,
		|	Хозрасчетный.СубконтоДт3                  КАК СубконтоДт3,
		|	Хозрасчетный.ВидСубконтоДт3               КАК ВидСубконтоДт3,
		|	Хозрасчетный.СчетКт                       КАК СчетКт,
		|	Хозрасчетный.СубконтоКт1                  КАК СубконтоКт1,
		|	Хозрасчетный.ВидСубконтоКт1               КАК ВидСубконтоКт1,
		|	Хозрасчетный.СубконтоКт2                  КАК СубконтоКт2,
		|	Хозрасчетный.ВидСубконтоКт2               КАК ВидСубконтоКт2,
		|	Хозрасчетный.СубконтоКт3                  КАК СубконтоКт3,
		|	Хозрасчетный.ВидСубконтоКт3               КАК ВидСубконтоКт3,
		|	Хозрасчетный.Организация                  КАК Организация,
		|	Хозрасчетный.ВалютаДт                     КАК ВалютаДт,
		|	Хозрасчетный.ВалютаКт                     КАК ВалютаКт,
		|	Хозрасчетный.ПодразделениеДт              КАК ПодразделениеДт,
		|	Хозрасчетный.НаправлениеДеятельностиДт    КАК НаправлениеДеятельностиДт,
		|	Хозрасчетный.ПодразделениеКт              КАК ПодразделениеКт,
		|	Хозрасчетный.НаправлениеДеятельностиКт    КАК НаправлениеДеятельностиКт,
		|	Хозрасчетный.Сумма                        КАК Сумма,
		|	Хозрасчетный.СуммаУУ                      КАК СуммаУУ,
		|	Хозрасчетный.СуммаФО                      КАК СуммаФО,
		|	Хозрасчетный.ВалютнаяСуммаДт              КАК ВалютнаяСуммаДт,
		|	Хозрасчетный.ВалютнаяСуммаКт              КАК ВалютнаяСуммаКт,
		|	Хозрасчетный.КоличествоДт                 КАК КоличествоДт,
		|	Хозрасчетный.КоличествоКт                 КАК КоличествоКт,
		|	Хозрасчетный.СуммаНУДт                    КАК СуммаНУДт,
		|	Хозрасчетный.СуммаНУКт                    КАК СуммаНУКт,
		|	Хозрасчетный.СуммаПРДт                    КАК СуммаПРДт,
		|	Хозрасчетный.СуммаПРКт                    КАК СуммаПРКт,
		|	Хозрасчетный.СуммаВРДт                    КАК СуммаВРДт,
		|	Хозрасчетный.СуммаВРКт                    КАК СуммаВРКт,
		|	Хозрасчетный.Содержание                   КАК Содержание,
		|	Хозрасчетный.Сторно                       КАК Сторно
		|ПОМЕСТИТЬ ТекущееСостояние
		|ИЗ
		|	РегистрБухгалтерии.Хозрасчетный.ДвиженияССубконто(
		|			,
		|			,
		|			Регистратор В
		|				(ВЫБРАТЬ
		|					Таблица.Ссылка КАК Ссылка
		|				ИЗ
		|					ДокументыКОтражению КАК Таблица)
		|			И НЕ ТИПЗНАЧЕНИЯ(Регистратор) В (&ДокументыОтражаемыеПоследовательно),
		|			,
		|			) КАК Хозрасчетный
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Ссылка
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	Хозрасчетный.Ссылка                       КАК Ссылка,
		|	Хозрасчетный.Период                       КАК Период,
		|	Хозрасчетный.СчетДт                       КАК СчетДт,
		|	Хозрасчетный.СубконтоДт1                  КАК СубконтоДт1,
		|	Хозрасчетный.ВидСубконтоДт1               КАК ВидСубконтоДт1,
		|	Хозрасчетный.СубконтоДт2                  КАК СубконтоДт2,
		|	Хозрасчетный.ВидСубконтоДт2               КАК ВидСубконтоДт2,
		|	Хозрасчетный.СубконтоДт3                  КАК СубконтоДт3,
		|	Хозрасчетный.ВидСубконтоДт3               КАК ВидСубконтоДт3,
		|	Хозрасчетный.СчетКт                       КАК СчетКт,
		|	Хозрасчетный.СубконтоКт1                  КАК СубконтоКт1,
		|	Хозрасчетный.ВидСубконтоКт1               КАК ВидСубконтоКт1,
		|	Хозрасчетный.СубконтоКт2                  КАК СубконтоКт2,
		|	Хозрасчетный.ВидСубконтоКт2               КАК ВидСубконтоКт2,
		|	Хозрасчетный.СубконтоКт3                  КАК СубконтоКт3,
		|	Хозрасчетный.ВидСубконтоКт3               КАК ВидСубконтоКт3,
		|	Хозрасчетный.Организация                  КАК Организация,
		|	Хозрасчетный.ВалютаДт                     КАК ВалютаДт,
		|	Хозрасчетный.ВалютаКт                     КАК ВалютаКт,
		|	Хозрасчетный.ПодразделениеДт              КАК ПодразделениеДт,
		|	Хозрасчетный.НаправлениеДеятельностиДт    КАК НаправлениеДеятельностиДт,
		|	Хозрасчетный.ПодразделениеКт              КАК ПодразделениеКт,
		|	Хозрасчетный.НаправлениеДеятельностиКт    КАК НаправлениеДеятельностиКт,
		|	Хозрасчетный.Сумма                        КАК Сумма,
		|	Хозрасчетный.СуммаУУ                      КАК СуммаУУ,
		|	Хозрасчетный.СуммаФО                      КАК СуммаФО,
		|	Хозрасчетный.ВалютнаяСуммаДт              КАК ВалютнаяСуммаДт,
		|	Хозрасчетный.ВалютнаяСуммаКт              КАК ВалютнаяСуммаКт,
		|	Хозрасчетный.КоличествоДт                 КАК КоличествоДт,
		|	Хозрасчетный.КоличествоКт                 КАК КоличествоКт,
		|	Хозрасчетный.СуммаНУДт                    КАК СуммаНУДт,
		|	Хозрасчетный.СуммаНУКт                    КАК СуммаНУКт,
		|	Хозрасчетный.СуммаПРДт                    КАК СуммаПРДт,
		|	Хозрасчетный.СуммаПРКт                    КАК СуммаПРКт,
		|	Хозрасчетный.СуммаВРДт                    КАК СуммаВРДт,
		|	Хозрасчетный.СуммаВРКт                    КАК СуммаВРКт,
		|	Хозрасчетный.Содержание                   КАК Содержание,
		|	Хозрасчетный.Сторно                       КАК Сторно
		|ПОМЕСТИТЬ ХозрасчетныйДополнение
		|ИЗ
		|	ТекущееСостояние КАК Хозрасчетный
		|	ЛЕВОЕ СОЕДИНЕНИЕ 
		|		РазрезыКОтражению КАК РазрезыКОтражению
		|	ПО 
		|		Хозрасчетный.Ссылка = РазрезыКОтражению.Ссылка
		|		И Хозрасчетный.ДатаОтражения = РазрезыКОтражению.ДатаОтражения
		|		И Хозрасчетный.Организация = РазрезыКОтражению.Организация
		|	
		|ГДЕ
		|	РазрезыКОтражению.Ссылка ЕСТЬ NULL 
		|;
		|
		|////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	Хозрасчетный.Ссылка КАК Ссылка,
		|	Хозрасчетный.Период КАК Период,
		|	Хозрасчетный.Организация КАК Организация,
		|	Хозрасчетный.Сумма КАК Сумма,
		|	Хозрасчетный.СуммаУУ КАК СуммаУУ,
		|	Хозрасчетный.СуммаФО КАК СуммаФО,
		|	
		|	Хозрасчетный.ВалютаДт КАК ВалютаДт,
		|	Хозрасчетный.ПодразделениеДт КАК ПодразделениеДт,
		|	Хозрасчетный.НаправлениеДеятельностиДт КАК НаправлениеДеятельностиДт,
		|	Хозрасчетный.СчетДт КАК СчетДт,
		|	Хозрасчетный.ВидСубконтоДт1 КАК ВидСубконтоДт1,
		|	Хозрасчетный.СубконтоДт1 КАК СубконтоДт1,
		|	Хозрасчетный.ВидСубконтоДт2 КАК ВидСубконтоДт2,
		|	Хозрасчетный.СубконтоДт2 КАК СубконтоДт2,
		|	Хозрасчетный.ВидСубконтоДт3 КАК ВидСубконтоДт3,
		|	Хозрасчетный.СубконтоДт3 КАК СубконтоДт3,
		|	Хозрасчетный.ВалютнаяСуммаДт КАК ВалютнаяСуммаДт,
		|	Хозрасчетный.КоличествоДт КАК КоличествоДт,
		|	Хозрасчетный.СуммаНУДт КАК СуммаНУДт,
		|	Хозрасчетный.СуммаПРДт КАК СуммаПРДт,
		|	Хозрасчетный.СуммаВРДт КАК СуммаВРДт,
		|	
		|	Хозрасчетный.ВалютаКт КАК ВалютаКт,
		|	Хозрасчетный.ПодразделениеКт КАК ПодразделениеКт,
		|	Хозрасчетный.НаправлениеДеятельностиКт КАК НаправлениеДеятельностиКт,
		|	Хозрасчетный.СчетКт КАК СчетКт,
		|	Хозрасчетный.ВидСубконтоКт1 КАК ВидСубконтоКт1,
		|	Хозрасчетный.СубконтоКт1 КАК СубконтоКт1,
		|	Хозрасчетный.ВидСубконтоКт2 КАК ВидСубконтоКт2,
		|	Хозрасчетный.СубконтоКт2 КАК СубконтоКт2,
		|	Хозрасчетный.ВидСубконтоКт3 КАК ВидСубконтоКт3,
		|	Хозрасчетный.СубконтоКт3 КАК СубконтоКт3,
		|	Хозрасчетный.ВалютнаяСуммаКт КАК ВалютнаяСуммаКт,
		|	Хозрасчетный.КоличествоКт КАК КоличествоКт,
		|	Хозрасчетный.СуммаНУКт КАК СуммаНУКт,
		|	Хозрасчетный.СуммаПРКт КАК СуммаПРКт,
		|	Хозрасчетный.СуммаВРКт КАК СуммаВРКт,
		|	
		|	Хозрасчетный.Содержание КАК Содержание,
		|	Хозрасчетный.Сторно КАК Сторно
		|
		|ИЗ
		|	ХозрасчетныйДополнение КАК Хозрасчетный
		|
		|УПОРЯДОЧИТЬ ПО
		|	Ссылка
		|	
		|ИТОГИ ПО
		|	Ссылка
		|;
		|
		|////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ ТекущееСостояние");
	
КонецФункции

Функция ЗапросХозрасчетныйСторно() Экспорт
	
	Возврат Новый Запрос(
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	РазрезыКОтражению.Ссылка КАК Ссылка,
		|	РазрезыКОтражению.Период КАК Период,
		|	РеестрДокументов.СторнируемыйДокумент КАК СторнируемыйДокумент,
		|	РазрезыКОтражению.Организация КАК Организация,
		|	ВЫБОР
		|		КОГДА РазрезыКОтражениюСторнируемыйДокумент.Ссылка ЕСТЬ NULL
		|			ТОГДА ЛОЖЬ
		|		ИНАЧЕ ИСТИНА
		|	КОНЕЦ КАК СторнируемыйДокументКОтражению
		|ПОМЕСТИТЬ ДокументыСторно
		|ИЗ
		|	РазрезыКОтражению КАК РазрезыКОтражению
		|	
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
		|		РегистрСведений.РеестрДокументов КАК РеестрДокументов
		|	ПО
		|		РазрезыКОтражению.Ссылка = РеестрДокументов.Ссылка
		|		И РеестрДокументов.СторноИсправление
		|		И НЕ РеестрДокументов.ДополнительнаяЗапись
		|
		|	ЛЕВОЕ СОЕДИНЕНИЕ
		|		РазрезыКОтражению КАК РазрезыКОтражениюСторнируемыйДокумент
		|	ПО
		|		РеестрДокументов.СторнируемыйДокумент = РазрезыКОтражениюСторнируемыйДокумент.Ссылка
		|		И РазрезыКОтражению.Организация = РазрезыКОтражениюСторнируемыйДокумент.Организация
		// Сторнирующие проводки формируем всегда на дату документа.
		|ГДЕ
		|	НАЧАЛОПЕРИОДА(РазрезыКОтражению.Период, ДЕНЬ) = РазрезыКОтражению.ДатаОтражения
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	СторнируемыйДокумент,
		|	Организация
		|;
		|
		|///////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	Хозрасчетный.Регистратор                  КАК Ссылка,
		|	Хозрасчетный.Период                       КАК Период,
		|	Хозрасчетный.СчетДт                       КАК СчетДт,
		|	Хозрасчетный.СубконтоДт1                  КАК СубконтоДт1,
		|	Хозрасчетный.ВидСубконтоДт1               КАК ВидСубконтоДт1,
		|	Хозрасчетный.СубконтоДт2                  КАК СубконтоДт2,
		|	Хозрасчетный.ВидСубконтоДт2               КАК ВидСубконтоДт2,
		|	Хозрасчетный.СубконтоДт3                  КАК СубконтоДт3,
		|	Хозрасчетный.ВидСубконтоДт3               КАК ВидСубконтоДт3,
		|	Хозрасчетный.СчетКт                       КАК СчетКт,
		|	Хозрасчетный.СубконтоКт1                  КАК СубконтоКт1,
		|	Хозрасчетный.ВидСубконтоКт1               КАК ВидСубконтоКт1,
		|	Хозрасчетный.СубконтоКт2                  КАК СубконтоКт2,
		|	Хозрасчетный.ВидСубконтоКт2               КАК ВидСубконтоКт2,
		|	Хозрасчетный.СубконтоКт3                  КАК СубконтоКт3,
		|	Хозрасчетный.ВидСубконтоКт3               КАК ВидСубконтоКт3,
		|	Хозрасчетный.Организация                  КАК Организация,
		|	Хозрасчетный.ВалютаДт                     КАК ВалютаДт,
		|	Хозрасчетный.ВалютаКт                     КАК ВалютаКт,
		|	Хозрасчетный.ПодразделениеДт              КАК ПодразделениеДт,
		|	Хозрасчетный.НаправлениеДеятельностиДт    КАК НаправлениеДеятельностиДт,
		|	Хозрасчетный.ПодразделениеКт              КАК ПодразделениеКт,
		|	Хозрасчетный.НаправлениеДеятельностиКт    КАК НаправлениеДеятельностиКт,
		|	Хозрасчетный.Сумма                        КАК Сумма,
		|	Хозрасчетный.СуммаУУ                      КАК СуммаУУ,
		|	Хозрасчетный.СуммаФО                      КАК СуммаФО,
		|	Хозрасчетный.ВалютнаяСуммаДт              КАК ВалютнаяСуммаДт,
		|	Хозрасчетный.ВалютнаяСуммаКт              КАК ВалютнаяСуммаКт,
		|	Хозрасчетный.КоличествоДт                 КАК КоличествоДт,
		|	Хозрасчетный.КоличествоКт                 КАК КоличествоКт,
		|	Хозрасчетный.СуммаНУДт                    КАК СуммаНУДт,
		|	Хозрасчетный.СуммаНУКт                    КАК СуммаНУКт,
		|	Хозрасчетный.СуммаПРДт                    КАК СуммаПРДт,
		|	Хозрасчетный.СуммаПРКт                    КАК СуммаПРКт,
		|	Хозрасчетный.СуммаВРДт                    КАК СуммаВРДт,
		|	Хозрасчетный.СуммаВРКт                    КАК СуммаВРКт,
		|	Хозрасчетный.Содержание                   КАК Содержание,
		|	Хозрасчетный.Сторно                       КАК Сторно
		|ПОМЕСТИТЬ ДвиженияСторнируемыхДокументов
		|ИЗ
		|	РегистрБухгалтерии.Хозрасчетный.ДвиженияССубконто(
		|			,
		|			,
		|			(Регистратор, Организация) В
		|				(ВЫБРАТЬ
		|					Таблица.СторнируемыйДокумент КАК СторнируемыйДокумент,
		|					Таблица.Организация КАК Организация
		|				ИЗ
		|					ДокументыСторно КАК Таблица
		|				ГДЕ
		|					НЕ Таблица.СторнируемыйДокументКОтражению)
		|			,
		|			,
		|			) КАК Хозрасчетный
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Ссылка
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ДокументыСторно.Ссылка                    КАК Ссылка,
		|	ДокументыСторно.Период                    КАК Период,
		|	Хозрасчетный.СчетДт                       КАК СчетДт,
		|	Хозрасчетный.СубконтоДт1                  КАК СубконтоДт1,
		|	Хозрасчетный.ВидСубконтоДт1               КАК ВидСубконтоДт1,
		|	Хозрасчетный.СубконтоДт2                  КАК СубконтоДт2,
		|	Хозрасчетный.ВидСубконтоДт2               КАК ВидСубконтоДт2,
		|	Хозрасчетный.СубконтоДт3                  КАК СубконтоДт3,
		|	Хозрасчетный.ВидСубконтоДт3               КАК ВидСубконтоДт3,
		|	Хозрасчетный.СчетКт                       КАК СчетКт,
		|	Хозрасчетный.СубконтоКт1                  КАК СубконтоКт1,
		|	Хозрасчетный.ВидСубконтоКт1               КАК ВидСубконтоКт1,
		|	Хозрасчетный.СубконтоКт2                  КАК СубконтоКт2,
		|	Хозрасчетный.ВидСубконтоКт2               КАК ВидСубконтоКт2,
		|	Хозрасчетный.СубконтоКт3                  КАК СубконтоКт3,
		|	Хозрасчетный.ВидСубконтоКт3               КАК ВидСубконтоКт3,
		|	Хозрасчетный.Организация                  КАК Организация,
		|	Хозрасчетный.ВалютаДт                     КАК ВалютаДт,
		|	Хозрасчетный.ВалютаКт                     КАК ВалютаКт,
		|	Хозрасчетный.ПодразделениеДт              КАК ПодразделениеДт,
		|	Хозрасчетный.НаправлениеДеятельностиДт    КАК НаправлениеДеятельностиДт,
		|	Хозрасчетный.ПодразделениеКт              КАК ПодразделениеКт,
		|	Хозрасчетный.НаправлениеДеятельностиКт    КАК НаправлениеДеятельностиКт,
		|	- Хозрасчетный.Сумма                      КАК Сумма,
		|	- Хозрасчетный.СуммаУУ                    КАК СуммаУУ,
		|	- Хозрасчетный.СуммаФО                    КАК СуммаФО,
		|	- Хозрасчетный.ВалютнаяСуммаДт            КАК ВалютнаяСуммаДт,
		|	- Хозрасчетный.ВалютнаяСуммаКт            КАК ВалютнаяСуммаКт,
		|	- Хозрасчетный.КоличествоДт               КАК КоличествоДт,
		|	- Хозрасчетный.КоличествоКт               КАК КоличествоКт,
		|	- Хозрасчетный.СуммаНУДт                  КАК СуммаНУДт,
		|	- Хозрасчетный.СуммаНУКт                  КАК СуммаНУКт,
		|	- Хозрасчетный.СуммаПРДт                  КАК СуммаПРДт,
		|	- Хозрасчетный.СуммаПРКт                  КАК СуммаПРКт,
		|	- Хозрасчетный.СуммаВРДт                  КАК СуммаВРДт,
		|	- Хозрасчетный.СуммаВРКт                  КАК СуммаВРКт,
		|	Хозрасчетный.Содержание                   КАК Содержание,
		|	ИСТИНА                                    КАК Сторно
		|ИЗ
		|	ДвиженияСторнируемыхДокументов КАК Хозрасчетный
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
		|		ДокументыСторно КАК ДокументыСторно
		|	ПО
		|		Хозрасчетный.Ссылка = ДокументыСторно.СторнируемыйДокумент
		|		И Хозрасчетный.Организация = ДокументыСторно.Организация
		|ГДЕ
		|	НЕ Хозрасчетный.Сторно
		|	
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДокументыСторно.Ссылка                    КАК Ссылка,
		|	ДокументыСторно.Период                    КАК Период,
		|	Хозрасчетный.СчетДт                       КАК СчетДт,
		|	Хозрасчетный.СубконтоДт1                  КАК СубконтоДт1,
		|	Хозрасчетный.ВидСубконтоДт1               КАК ВидСубконтоДт1,
		|	Хозрасчетный.СубконтоДт2                  КАК СубконтоДт2,
		|	Хозрасчетный.ВидСубконтоДт2               КАК ВидСубконтоДт2,
		|	Хозрасчетный.СубконтоДт3                  КАК СубконтоДт3,
		|	Хозрасчетный.ВидСубконтоДт3               КАК ВидСубконтоДт3,
		|	Хозрасчетный.СчетКт                       КАК СчетКт,
		|	Хозрасчетный.СубконтоКт1                  КАК СубконтоКт1,
		|	Хозрасчетный.ВидСубконтоКт1               КАК ВидСубконтоКт1,
		|	Хозрасчетный.СубконтоКт2                  КАК СубконтоКт2,
		|	Хозрасчетный.ВидСубконтоКт2               КАК ВидСубконтоКт2,
		|	Хозрасчетный.СубконтоКт3                  КАК СубконтоКт3,
		|	Хозрасчетный.ВидСубконтоКт3               КАК ВидСубконтоКт3,
		|	Хозрасчетный.Организация                  КАК Организация,
		|	Хозрасчетный.ВалютаДт                     КАК ВалютаДт,
		|	Хозрасчетный.ВалютаКт                     КАК ВалютаКт,
		|	Хозрасчетный.ПодразделениеДт              КАК ПодразделениеДт,
		|	Хозрасчетный.НаправлениеДеятельностиДт    КАК НаправлениеДеятельностиДт,
		|	Хозрасчетный.ПодразделениеКт              КАК ПодразделениеКт,
		|	Хозрасчетный.НаправлениеДеятельностиКт    КАК НаправлениеДеятельностиКт,
		|	- Хозрасчетный.Сумма                      КАК Сумма,
		|	- Хозрасчетный.СуммаУУ                    КАК СуммаУУ,
		|	- Хозрасчетный.СуммаФО                    КАК СуммаФО,
		|	- Хозрасчетный.ВалютнаяСуммаДт            КАК ВалютнаяСуммаДт,
		|	- Хозрасчетный.ВалютнаяСуммаКт            КАК ВалютнаяСуммаКт,
		|	- Хозрасчетный.КоличествоДт               КАК КоличествоДт,
		|	- Хозрасчетный.КоличествоКт               КАК КоличествоКт,
		|	- Хозрасчетный.СуммаНУДт                  КАК СуммаНУДт,
		|	- Хозрасчетный.СуммаНУКт                  КАК СуммаНУКт,
		|	- Хозрасчетный.СуммаПРДт                  КАК СуммаПРДт,
		|	- Хозрасчетный.СуммаПРКт                  КАК СуммаПРКт,
		|	- Хозрасчетный.СуммаВРДт                  КАК СуммаВРДт,
		|	- Хозрасчетный.СуммаВРКт                  КАК СуммаВРКт,
		|	Хозрасчетный.Содержание                   КАК Содержание,
		|	ИСТИНА                                    КАК Сторно
		|ИЗ
		|	Хозрасчетный КАК Хозрасчетный
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
		|		ДокументыСторно КАК ДокументыСторно
		|	ПО
		|		Хозрасчетный.Ссылка = ДокументыСторно.СторнируемыйДокумент
		|		И Хозрасчетный.Организация = ДокументыСторно.Организация
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДокументыСторно.Ссылка                    КАК Ссылка,
		|	ДокументыСторно.Период                    КАК Период,
		|	Хозрасчетный.СчетДт                       КАК СчетДт,
		|	Хозрасчетный.СубконтоДт1                  КАК СубконтоДт1,
		|	Хозрасчетный.ВидСубконтоДт1               КАК ВидСубконтоДт1,
		|	Хозрасчетный.СубконтоДт2                  КАК СубконтоДт2,
		|	Хозрасчетный.ВидСубконтоДт2               КАК ВидСубконтоДт2,
		|	Хозрасчетный.СубконтоДт3                  КАК СубконтоДт3,
		|	Хозрасчетный.ВидСубконтоДт3               КАК ВидСубконтоДт3,
		|	Хозрасчетный.СчетКт                       КАК СчетКт,
		|	Хозрасчетный.СубконтоКт1                  КАК СубконтоКт1,
		|	Хозрасчетный.ВидСубконтоКт1               КАК ВидСубконтоКт1,
		|	Хозрасчетный.СубконтоКт2                  КАК СубконтоКт2,
		|	Хозрасчетный.ВидСубконтоКт2               КАК ВидСубконтоКт2,
		|	Хозрасчетный.СубконтоКт3                  КАК СубконтоКт3,
		|	Хозрасчетный.ВидСубконтоКт3               КАК ВидСубконтоКт3,
		|	Хозрасчетный.Организация                  КАК Организация,
		|	Хозрасчетный.ВалютаДт                     КАК ВалютаДт,
		|	Хозрасчетный.ВалютаКт                     КАК ВалютаКт,
		|	Хозрасчетный.ПодразделениеДт              КАК ПодразделениеДт,
		|	Хозрасчетный.НаправлениеДеятельностиДт    КАК НаправлениеДеятельностиДт,
		|	Хозрасчетный.ПодразделениеКт              КАК ПодразделениеКт,
		|	Хозрасчетный.НаправлениеДеятельностиКт    КАК НаправлениеДеятельностиКт,
		|	- Хозрасчетный.Сумма                      КАК Сумма,
		|	- Хозрасчетный.СуммаУУ                    КАК СуммаУУ,
		|	- Хозрасчетный.СуммаФО                    КАК СуммаФО,
		|	- Хозрасчетный.ВалютнаяСуммаДт            КАК ВалютнаяСуммаДт,
		|	- Хозрасчетный.ВалютнаяСуммаКт            КАК ВалютнаяСуммаКт,
		|	- Хозрасчетный.КоличествоДт               КАК КоличествоДт,
		|	- Хозрасчетный.КоличествоКт               КАК КоличествоКт,
		|	- Хозрасчетный.СуммаНУДт                  КАК СуммаНУДт,
		|	- Хозрасчетный.СуммаНУКт                  КАК СуммаНУКт,
		|	- Хозрасчетный.СуммаПРДт                  КАК СуммаПРДт,
		|	- Хозрасчетный.СуммаПРКт                  КАК СуммаПРКт,
		|	- Хозрасчетный.СуммаВРДт                  КАК СуммаВРДт,
		|	- Хозрасчетный.СуммаВРКт                  КАК СуммаВРКт,
		|	Хозрасчетный.Содержание                   КАК Содержание,
		|	ИСТИНА                                    КАК Сторно
		|ИЗ
		|	ХозрасчетныйДополнение КАК Хозрасчетный
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
		|		ДокументыСторно КАК ДокументыСторно
		|	ПО
		|		Хозрасчетный.Ссылка = ДокументыСторно.СторнируемыйДокумент
		|		И Хозрасчетный.Организация = ДокументыСторно.Организация
		|ГДЕ
		|	НЕ Хозрасчетный.Сторно
		|
		|УПОРЯДОЧИТЬ ПО
		|	Ссылка
		|
		|ИТОГИ ПО
		|	Ссылка
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ ДокументыСторно
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ ДвиженияСторнируемыхДокументов
		|;
		|");
	
КонецФункции

Функция ЗапросОтражениеДокументовВРеглУчете() Экспорт
	
	Возврат Новый Запрос(
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	Статусы.Регистратор                  КАК Ссылка,
		|	Статусы.Период                       КАК Период,
		|	Статусы.Организация                  КАК Организация,
		|	Статусы.ДатаОтражения                КАК ДатаОтражения,
		|	ВЫБОР
		|		КОГДА НЕ РазрезыКОтражению.Ссылка ЕСТЬ NULL
		|			ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ Статусы.Статус
		|	КОНЕЦ                                КАК Статус,
		|	Статусы.ИдентификаторСтатуса         КАК ИдентификаторСтатуса
		|ИЗ
		|	ДокументыКОтражению КАК ДокументыКОтражению
		|	
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
		|		РегистрСведений.ОтражениеДокументовВРеглУчете КАК Статусы
		|	ПО 
		|		ДокументыКОтражению.Ссылка = Статусы.Регистратор
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ
		|		РазрезыКОтражению КАК РазрезыКОтражению
		|	ПО
		|		Статусы.Регистратор = РазрезыКОтражению.Ссылка
		|		И Статусы.Период = РазрезыКОтражению.Период
		|		И Статусы.Организация = РазрезыКОтражению.Организация
		|		И Статусы.ДатаОтражения = РазрезыКОтражению.ДатаОтражения
		|		
		|УПОРЯДОЧИТЬ ПО
		|	Ссылка,
		|	Организация,
		|	ДатаОтражения
		|
		|ИТОГИ
		|	МАКСИМУМ(Период),
		|	МАКСИМУМ(ИдентификаторСтатуса)
		|ПО
		|	Ссылка");
	
КонецФункции

Функция ЗапросСвязанныеДокументыКОтражению() Экспорт
	
	Возврат Новый Запрос(
		"ВЫБРАТЬ
		|	ДокументыКОтражению.Ссылка            КАК Ссылка,
		|	ОперацияБух.Ссылка                    КАК Регистратор,
		|	ОперацияБух.Дата                      КАК Период,
		|	ОперацияБух.Организация               КАК Организация,
		|	НАЧАЛОПЕРИОДА(ОперацияБух.Дата, ДЕНЬ) КАК ДатаОтражения,
		|	ЗНАЧЕНИЕ(Перечисление.СтатусыОтраженияДокументовВРеглУчете.КОтражениюВУчетеВручную) КАК Статус
		|ИЗ
		|	Документ.ОперацияБух.ЗаполнениеДвижений КАК ОперацияБухОснования
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
		|		ДокументыКОтражению КАК ДокументыКОтражению
		|	ПО
		|		ОперацияБухОснования.Документ = ДокументыКОтражению.Ссылка
		|	
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
		|		Документ.ОперацияБух КАК ОперацияБух
		|	ПО
		|		ОперацияБухОснования.Ссылка = ОперацияБух.Ссылка
		|ГДЕ
		|	НЕ ОперацияБух.ПометкаУдаления
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	ДокументыКОтражению.Ссылка                  КАК Ссылка,
		|	ОтражениеДокументовВРеглУчете.Регистратор   КАК Регистратор,
		|	ОтражениеДокументовВРеглУчете.Период        КАК Период,
		|	ОтражениеДокументовВРеглУчете.Организация   КАК Организация,
		|	ОтражениеДокументовВРеглУчете.ДатаОтражения КАК ДатаОтражения,
		|	ВЫБОР
		|		КОГДА ОтражениеДокументовВРеглУчете.Статус = ЗНАЧЕНИЕ(Перечисление.СтатусыОтраженияДокументовВРеглУчете.ОтраженоВУчетеВручную)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.СтатусыОтраженияДокументовВРеглУчете.КОтражениюВУчетеВручную)
		|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.СтатусыОтраженияДокументовВРеглУчете.КОтражениюВРеглУчете)
		|	КОНЕЦ КАК Статус
		|ИЗ
		|	ДокументыКОтражению КАК ДокументыКОтражению
		|	
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
		|		РегистрСведений.РеестрДокументов КАК РеестрДокументов
		|	ПО
		|		РеестрДокументов.СторнируемыйДокумент = ДокументыКОтражению.Ссылка
		|		И РеестрДокументов.СторноИсправление
		|		И РеестрДокументов.Проведен
		|		И НЕ РеестрДокументов.ДополнительнаяЗапись
		|
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
		|		РегистрСведений.ОтражениеДокументовВРеглУчете КАК ОтражениеДокументовВРеглУчете
		|	ПО
		|		РеестрДокументов.Ссылка = ОтражениеДокументовВРеглУчете.Регистратор
		|ГДЕ
		|	НЕ (РеестрДокументов.Ссылка) В 
		|		(ВЫБРАТЬ
		|			ДокументыКОтражению.Ссылка
		|		ИЗ
		|			ДокументыКОтражению КАК ДокументыКОтражению)
		|
		|УПОРЯДОЧИТЬ ПО
		|	Ссылка
		|
		|ИТОГИ ПО
		|	Ссылка, Регистратор");
	
КонецФункции

Функция ЗапросЗаданияКФормированиюФинРезультата() Экспорт
	
	Возврат Новый Запрос(
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	РазрезыКОтражению.Организация КАК Организация,
		|	ЗНАЧЕНИЕ(Перечисление.ОперацииЗакрытияМесяца.ФормированиеФинансовогоРезультата) КАК Операция,
		|	НАЧАЛОПЕРИОДА(РазрезыКОтражению.ДатаОтражения, МЕСЯЦ) КАК Месяц
		|ИЗ
		|	РазрезыКОтражению КАК РазрезыКОтражению
		|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЗаданияКЗакрытиюМесяца КАК Задания
		|	ПО
		|		РазрезыКОтражению.Организация = Задания.Организация
		|		И Задания.Операция = ЗНАЧЕНИЕ(Перечисление.ОперацииЗакрытияМесяца.ФормированиеФинансовогоРезультата)
		|		И НАЧАЛОПЕРИОДА(РазрезыКОтражению.ДатаОтражения, МЕСЯЦ) = НАЧАЛОПЕРИОДА(Задания.Месяц, МЕСЯЦ)
		|ГДЕ
		|	КОНЕЦПЕРИОДА(РазрезыКОтражению.Период, ГОД) <= КОНЕЦПЕРИОДА(РазрезыКОтражению.ДатаОтражения, ГОД)
		|	И Задания.Операция ЕСТЬ NULL
		|	И НЕ (РазрезыКОтражению.Ссылка Ссылка Документ.РегламентнаяОперация И РазрезыКОтражению.Ссылка.ТипОперации В (&ТипыОперацийФинРеза))
		|");
	
КонецФункции

//++ НЕ УТКА

Функция ЗапросОтражениеДокументовВМеждународномУчете() Экспорт
	
	Возврат Новый Запрос(
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	РазрезыКОтражению.Ссылка,
		|	РазрезыКОтражению.Организация,
		|	РазрезыКОтражению.Организация.ГоловнаяОрганизация КАК ГоловнаяОрганизация
		|ПОМЕСТИТЬ РазрезыКОтражениюПоДокументамИОрганизациям
		|ИЗ
		|	РазрезыКОтражению КАК РазрезыКОтражению
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Ссылка,
		|	Организация
		|;
		|
		|///////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	Статусы.Регистратор КАК Ссылка,
		|	Статусы.Период КАК Период,
		|	Статусы.ПланСчетов КАК ПланСчетов,
		|	Статусы.ДатаОтражения КАК ДатаОтражения,
		|	Статусы.Организация КАК Организация,
		|	Статусы.Статус КАК Статус,
		|	ВЫБОР
		|		КОГДА НЕ РазрезыКОтражению.Ссылка ЕСТЬ NULL
		|			ТОГДА ИСТИНА
		|		ИНАЧЕ ЛОЖЬ
		|	КОНЕЦ КАК ОбновитьСтатус,
		|	ВЫБОР
		|		КОГДА Статусы.Статус В (
		|				ЗНАЧЕНИЕ(Перечисление.СтатусыОтраженияВМеждународномУчете.КОтражениюВУчетеВручную),
		|				ЗНАЧЕНИЕ(Перечисление.СтатусыОтраженияВМеждународномУчете.ОтраженоВУчетеВручную))
		|			ТОГДА ИСТИНА
		|		ИНАЧЕ ЛОЖЬ
		|	КОНЕЦ КАК РучноеОтражение,
		|	Статусы.НастройкаФормированияПроводок КАК НастройкаФормированияПроводок,
		|	Статусы.Комментарий     КАК Комментарий
		|ИЗ
		|	ДокументыКОтражению КАК ДокументыКОтражению
		|	
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
		|		РегистрСведений.ОтражениеДокументовВМеждународномУчете КАК Статусы
		|	ПО 
		|		ДокументыКОтражению.Ссылка = Статусы.Регистратор
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ
		|		РазрезыКОтражениюПоДокументамИОрганизациям КАК РазрезыКОтражению
		|	ПО
		|		Статусы.Регистратор = РазрезыКОтражению.Ссылка
		|		И Статусы.Организация = РазрезыКОтражению.Организация
		|	
		|ГДЕ
		|	&ПроводкиМеждународногоУчетаПоДаннымРегл
		|	
		|УПОРЯДОЧИТЬ ПО
		|	Ссылка,
		|	ПланСчетов,
		|	Организация,
		|	Период,
		|	ДатаОтражения
		|
		|ИТОГИ
		|	МАКСИМУМ(Период)
		|ПО
		|	Ссылка
		|;
		|
		|///////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ РазрезыКОтражениюПоДокументамИОрганизациям
		|");
	
КонецФункции

//-- НЕ УТКА

#КонецОбласти

#Область ВременныеТаблицы

Функция ТекстПустыеВТ(МассивВТ)
	
	МассивТекстовЗапросаОчисткиВТ = Новый Массив;
	Для каждого ТаблицаВТ из МассивВТ Цикл
		ТекстЗапросаОчисткиВТ =
		"ВЫБРАТЬ
		|	1
		|ПОМЕСТИТЬ #ИмяВременнойТаблицы";
		ТекстЗапросаОчисткиВТ = СтрЗаменить(ТекстЗапросаОчисткиВТ, "#ИмяВременнойТаблицы", ТаблицаВТ);
		МассивТекстовЗапросаОчисткиВТ.Добавить(ТекстЗапросаОчисткиВТ);
	КонецЦикла;
	ТекстЗапросаОчисткиВТ = СтрСоединить(МассивТекстовЗапросаОчисткиВТ, ОбщегоНазначения.РазделительПакетаЗапросов()) + ОбщегоНазначения.РазделительПакетаЗапросов();
	Возврат ТекстЗапросаОчисткиВТ;
	
КонецФункции

Функция ТекстУчетнаяПолитика()
	
	Возврат "
		|ВЫБРАТЬ
		|	РазрезыКОтражению.Ссылка              КАК Ссылка,
		|	РазрезыКОтражению.ГоловнаяОрганизация КАК ГоловнаяОрганизация,
		|	РазрезыКОтражению.ДатаОтражения       КАК ДатаОтражения,
		|	МАКСИМУМ(НастройкиСистемыНалогообложения.Период) КАК ПериодУчетнойПолитики
		|ПОМЕСТИТЬ ПериодыНастройкиСистемыНалогообложения
		|ИЗ
		|	РазрезыКОтражению КАК РазрезыКОтражению
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
		|		РегистрСведений.НастройкиСистемыНалогообложения КАК НастройкиСистемыНалогообложения
		|	ПО
		|		РазрезыКОтражению.ГоловнаяОрганизация = НастройкиСистемыНалогообложения.Организация
		|		И РазрезыКОтражению.ДатаОтражения >= НастройкиСистемыНалогообложения.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	РазрезыКОтражению.Ссылка,
		|	РазрезыКОтражению.ГоловнаяОрганизация,
		|	РазрезыКОтражению.ДатаОтражения
		|	
		|ИНДЕКСИРОВАТЬ ПО
		|	Ссылка,
		|	ГоловнаяОрганизация
		|;
		|
		|ВЫБРАТЬ
		|	РазрезыКОтражению.Ссылка              КАК Ссылка,
		|	РазрезыКОтражению.ГоловнаяОрганизация КАК ГоловнаяОрганизация,
		|	РазрезыКОтражению.ДатаОтражения       КАК ДатаОтражения,
		|	МАКСИМУМ(УчетнаяПолитикаБухУчета.Период) КАК ПериодУчетнойПолитики
		|ПОМЕСТИТЬ ПериодыНастройкиУчетнаяПолитикаБухУчета
		|ИЗ
		|	РазрезыКОтражению КАК РазрезыКОтражению
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
		|		РегистрСведений.УчетнаяПолитикаБухУчета КАК УчетнаяПолитикаБухУчета
		|	ПО
		|		РазрезыКОтражению.ГоловнаяОрганизация = УчетнаяПолитикаБухУчета.Организация
		|		И РазрезыКОтражению.ДатаОтражения >= УчетнаяПолитикаБухУчета.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	РазрезыКОтражению.Ссылка,
		|	РазрезыКОтражению.ГоловнаяОрганизация,
		|	РазрезыКОтражению.ДатаОтражения
		|	
		|ИНДЕКСИРОВАТЬ ПО
		|	Ссылка,
		|	ГоловнаяОрганизация
		|;
		|
		|ВЫБРАТЬ
		|	РазрезыКОтражению.Ссылка              КАК Ссылка,
		|	РазрезыКОтражению.ГоловнаяОрганизация КАК ГоловнаяОрганизация,
		|	РазрезыКОтражению.ДатаОтражения       КАК ДатаОтражения,
		|	МАКСИМУМ(УчетнаяПолитикаФинУчета.Период) КАК ПериодУчетнойПолитики
		|ПОМЕСТИТЬ ПериодыНастройкиУчетнаяПолитикаФинУчета
		|ИЗ
		|	РазрезыКОтражению КАК РазрезыКОтражению
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
		|		РегистрСведений.УчетнаяПолитикаФинансовогоУчета КАК УчетнаяПолитикаФинУчета
		|	ПО
		|		РазрезыКОтражению.ГоловнаяОрганизация = УчетнаяПолитикаФинУчета.Организация
		|		И РазрезыКОтражению.ДатаОтражения >= УчетнаяПолитикаФинУчета.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	РазрезыКОтражению.Ссылка,
		|	РазрезыКОтражению.ГоловнаяОрганизация,
		|	РазрезыКОтражению.ДатаОтражения
		|	
		|ИНДЕКСИРОВАТЬ ПО
		|	Ссылка,
		|	ГоловнаяОрганизация
		|;
		|
		|ВЫБРАТЬ
		|	РазрезыКОтражению.Ссылка              КАК Ссылка,
		|	РазрезыКОтражению.ГоловнаяОрганизация КАК ГоловнаяОрганизация,
		|	РазрезыКОтражению.ДатаОтражения       КАК ДатаОтражения,
		|	МАКСИМУМ(НастройкиУчетаНалогаНаПрибыль.Период) КАК ПериодУчетнойПолитики
		|ПОМЕСТИТЬ ПериодыНастройкиУчетаНалогаНаПрибыль
		|ИЗ
		|	РазрезыКОтражению КАК РазрезыКОтражению
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
		|		РегистрСведений.НастройкиУчетаНалогаНаПрибыль КАК НастройкиУчетаНалогаНаПрибыль
		|	ПО
		|		РазрезыКОтражению.ГоловнаяОрганизация = НастройкиУчетаНалогаНаПрибыль.Организация
		|		И РазрезыКОтражению.ДатаОтражения >= НастройкиУчетаНалогаНаПрибыль.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	РазрезыКОтражению.Ссылка,
		|	РазрезыКОтражению.ГоловнаяОрганизация,
		|	РазрезыКОтражению.ДатаОтражения
		|	
		|ИНДЕКСИРОВАТЬ ПО
		|	Ссылка,
		|	ГоловнаяОрганизация
		|;
		|
		|ВЫБРАТЬ
		|	РазрезыКОтражению.Ссылка              КАК Ссылка,
		|	РазрезыКОтражению.ГоловнаяОрганизация КАК ГоловнаяОрганизация,
		|	РазрезыКОтражению.ДатаОтражения       КАК ДатаОтражения,
		|	МАКСИМУМ(НастройкиУчетаНДС.Период) КАК ПериодУчетнойПолитики
		|ПОМЕСТИТЬ ПериодыНастройкиУчетаНДС
		|ИЗ
		|	РазрезыКОтражению КАК РазрезыКОтражению
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
		|		РегистрСведений.НастройкиУчетаНДС КАК НастройкиУчетаНДС
		|	ПО
		|		РазрезыКОтражению.ГоловнаяОрганизация = НастройкиУчетаНДС.Организация
		|		И РазрезыКОтражению.ДатаОтражения >= НастройкиУчетаНДС.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	РазрезыКОтражению.Ссылка,
		|	РазрезыКОтражению.ГоловнаяОрганизация,
		|	РазрезыКОтражению.ДатаОтражения
		|	
		|ИНДЕКСИРОВАТЬ ПО
		|	Ссылка,
		|	ГоловнаяОрганизация
		|;
		|
		|ВЫБРАТЬ
		|	РазрезыКОтражению.Ссылка              КАК Ссылка,
		|	РазрезыКОтражению.ГоловнаяОрганизация КАК ГоловнаяОрганизация,
		|	РазрезыКОтражению.ДатаОтражения       КАК ДатаОтражения,
		|	МАКСИМУМ(НастройкиУчетаНДСПриУСН.Период) КАК ПериодУчетнойПолитики
		|ПОМЕСТИТЬ ПериодыНастройкиУчетаНДСПриУСН
		|ИЗ
		|	РазрезыКОтражению КАК РазрезыКОтражению
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
		|		РегистрСведений.НастройкиУчетаНДСПриУСН КАК НастройкиУчетаНДСПриУСН
		|	ПО
		|		РазрезыКОтражению.ГоловнаяОрганизация = НастройкиУчетаНДСПриУСН.Организация
		|		И РазрезыКОтражению.ДатаОтражения >= НастройкиУчетаНДСПриУСН.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	РазрезыКОтражению.Ссылка,
		|	РазрезыКОтражению.ГоловнаяОрганизация,
		|	РазрезыКОтражению.ДатаОтражения
		|	
		|ИНДЕКСИРОВАТЬ ПО
		|	Ссылка,
		|	ГоловнаяОрганизация
		|;
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	РазрезыКОтражению.Ссылка        КАК Ссылка,
		|	РазрезыКОтражению.Организация   КАК Организация,
		|	РазрезыКОтражению.Период        КАК Период,
		|	РазрезыКОтражению.ДатаОтражения КАК ДатаОтражения,
		|	ЕСТЬNULL(НастройкиСистемыНалогообложения.СистемаНалогообложения, ЗНАЧЕНИЕ(Перечисление.СистемыНалогообложения.Общая)) КАК СистемаНалогообложения,
		|	ЕСТЬNULL(НастройкиСистемыНалогообложения.ПрименяетсяЕНВД, ЛОЖЬ) КАК ПрименяетсяЕНВД,
		|	ЕСТЬNULL(НастройкиСистемыНалогообложения.ПрименяетсяПСН, ЛОЖЬ) КАК ПрименяетсяПСН,
		|	ЕСТЬNULL(УчетнаяПолитикаБухУчета.ВариантУчетаОтложенногоНалога,
		|				ЗНАЧЕНИЕ(Перечисление.ВариантыУчетаОтложенногоНалога.Нет)) КАК ВариантУчетаОтложенногоНалога,
		|	ЕСТЬNULL(УчетнаяПолитикаБухУчета.ВариантУчетаОтложенногоНалога
		|				<> ЗНАЧЕНИЕ(Перечисление.ВариантыУчетаОтложенногоНалога.ПустаяСсылка)
		|			И УчетнаяПолитикаБухУчета.ВариантУчетаОтложенногоНалога
		|				<> ЗНАЧЕНИЕ(Перечисление.ВариантыУчетаОтложенногоНалога.Нет),
		|			ЛОЖЬ) КАК ПрименяетсяПБУ18,
		|	ЕСТЬNULL(УчетнаяПолитикаБухУчета.ВедетсяУчетПостоянныхИВременныхРазниц,
		|			ЛОЖЬ) КАК ВедетсяУчетПостоянныхИВременныхРазниц,
		|	ЕСТЬNULL(УчетнаяПолитикаБухУчета.ЗабалансовыйУчетТМЦВЭксплуатации, ЛОЖЬ) КАК ЗабалансовыйУчетТМЦВЭксплуатации,
		|	ЕСТЬNULL(НастройкиУчетаНалогаНаПрибыль.ВключатьВСоставНалоговыхРасходовАрендныеПлатежи, ЛОЖЬ) КАК ВключатьВСоставНалоговыхРасходовАрендныеПлатежи,
		|	ВЫБОР
		|		КОГДА ЕСТЬNULL(НастройкиУчетаНалогаНаПрибыль.ДатаНезависимогоПризнанияДоходовРасходов, ДАТАВРЕМЯ(1,1,1)) = ДАТАВРЕМЯ(1,1,1)
		|		ТОГДА ДОБАВИТЬКДАТЕ(РазрезыКОтражению.ДатаОтражения, ГОД, 1)
		|		ИНАЧЕ НастройкиУчетаНалогаНаПрибыль.ДатаНезависимогоПризнанияДоходовРасходов
		|	КОНЕЦ КАК ДатаНачалаПрименения67ФЗ,
		|	ВЫБОР
		|		КОГДА ЕСТЬNULL(НастройкиУчетаНалогаНаПрибыль.ДатаНезависимогоПризнанияДоходовРасходов, ДАТАВРЕМЯ(1,1,1)) = ДАТАВРЕМЯ(1,1,1)
		|		ТОГДА ДОБАВИТЬКДАТЕ(РазрезыКОтражению.ДатаОтражения, ГОД, 1)
		|		ИНАЧЕ &ДатаНачалаПрименения67ФЗРасходы
		|	КОНЕЦ КАК ДатаНачалаПрименения67ФЗРасходы,
		|	ВЫБОР
		|		КОГДА ЕСТЬNULL(НастройкиУчетаНалогаНаПрибыль.ДатаНезависимогоПризнанияДоходовРасходов, ДОБАВИТЬКДАТЕ(РазрезыКОтражению.ДатаОтражения, ГОД, 1)) > РазрезыКОтражению.ДатаОтражения
		|		ТОГДА 0
		|		ИНАЧЕ 1
		|	КОНЕЦ КАК КоэффициентПрименения67ФЗ,
		|	ЕСТЬNULL(УчетнаяПолитикаФинУчета.УчетАрендыПоФСБУ25_2018, ЛОЖЬ)
		|		ИЛИ ЕСТЬNULL(УчетнаяПолитикаФинУчетаНаСледующийДень.УчетАрендыПоФСБУ25_2018, ЛОЖЬ) КАК ИспользуетсяУчетАрендыПоФСБУ25_2018,
		|	ЕСТЬNULL(УчетнаяПолитикаБухУчета.ИспользоватьСчет40, ЛОЖЬ) КАК ИспользоватьСчет40,
		|	ЕСТЬNULL(УчетнаяПолитикаБухУчета.СборкаТоваровЧерезСчет20, ЛОЖЬ) КАК СборкаТоваровЧерезСчет20,
		|	ЕСТЬNULL(УчетнаяПолитикаФинУчета.ИспользоватьВыделениеДолгосрочныхАктивовОбязательств, ЛОЖЬ) КАК ДолгосрочныеАктивыОбязательства,
		|	ЕСТЬNULL(УчетнаяПолитикаФинУчета.ДлительностьОперационногоЦикла, 0) КАК МесяцыДолгосрочнойЗадолженности,
		|	ЕСТЬNULL(НастройкиУчетаНДС.РаздельныйУчетТоваровПоНалогообложениюНДС, ЛОЖЬ) КАК РаздельныйУчетТоваровПоНалогообложениюНДС,
		|	ЕСТЬNULL(НастройкиУчетаНалогаНаПрибыль.РаздельныйУчетПоНалогуНаПрибыль, ЛОЖЬ) КАК РаздельныйУчетПоНалогуНаПрибыль,
		|	ЕСТЬNULL(НастройкиУчетаНалогаНаПрибыль.ОсновнойВариантНалогообложенияПрибыли,
		|		ЗНАЧЕНИЕ(Справочник.ВариантыНалогообложенияПрибыли.ПустаяСсылка)) КАК ОсновнойВариантНалогообложенияПрибыли,
		|	ЕСТЬNULL(НастройкиУчетаНДСПриУСН.ОсновноеНалогообложение, ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)) КАК ОсновноеНалогообложениеНДСПриУСН,
		|	ЕСТЬNULL(НастройкиУчетаНДС.ФормироватьНДСПредъявленныйПриВключенииВСтоимость, ЛОЖЬ) КАК НДСПредъявленныйПриВключенииВСтоимость 
		|ПОМЕСТИТЬ УчетнаяПолитикаОрганизаций
		|ИЗ
		|	РазрезыКОтражению КАК РазрезыКОтражению
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ
		|		ПериодыНастройкиСистемыНалогообложения КАК ПериодыНастройкиСистемыНалогообложения
		|	ПО
		|		РазрезыКОтражению.Ссылка = ПериодыНастройкиСистемыНалогообложения.Ссылка
		|		И РазрезыКОтражению.ГоловнаяОрганизация = ПериодыНастройкиСистемыНалогообложения.ГоловнаяОрганизация
		|		И РазрезыКОтражению.ДатаОтражения = ПериодыНастройкиСистемыНалогообложения.ДатаОтражения
		|		
		|	ЛЕВОЕ СОЕДИНЕНИЕ
		|		РегистрСведений.НастройкиСистемыНалогообложения КАК НастройкиСистемыНалогообложения
		|	ПО
		|		ПериодыНастройкиСистемыНалогообложения.ГоловнаяОрганизация = НастройкиСистемыНалогообложения.Организация
		|		И ПериодыНастройкиСистемыНалогообложения.ПериодУчетнойПолитики = НастройкиСистемыНалогообложения.Период
		|
		|	ЛЕВОЕ СОЕДИНЕНИЕ
		|		ПериодыНастройкиУчетнаяПолитикаБухУчета КАК ПериодыНастройкиУчетнаяПолитикаБухУчета
		|	ПО
		|		РазрезыКОтражению.Ссылка = ПериодыНастройкиУчетнаяПолитикаБухУчета.Ссылка
		|		И РазрезыКОтражению.ГоловнаяОрганизация = ПериодыНастройкиУчетнаяПолитикаБухУчета.ГоловнаяОрганизация
		|		И РазрезыКОтражению.ДатаОтражения = ПериодыНастройкиУчетнаяПолитикаБухУчета.ДатаОтражения
		|		
		|	ЛЕВОЕ СОЕДИНЕНИЕ
		|		РегистрСведений.УчетнаяПолитикаБухУчета КАК УчетнаяПолитикаБухУчета
		|	ПО
		|		ПериодыНастройкиУчетнаяПолитикаБухУчета.ГоловнаяОрганизация = УчетнаяПолитикаБухУчета.Организация
		|		И ПериодыНастройкиУчетнаяПолитикаБухУчета.ПериодУчетнойПолитики = УчетнаяПолитикаБухУчета.Период
		|
		|	ЛЕВОЕ СОЕДИНЕНИЕ
		|		ПериодыНастройкиУчетнаяПолитикаФинУчета КАК ПериодыНастройкиУчетнаяПолитикаФинУчета
		|	ПО
		|		РазрезыКОтражению.Ссылка = ПериодыНастройкиУчетнаяПолитикаФинУчета.Ссылка
		|		И РазрезыКОтражению.ГоловнаяОрганизация = ПериодыНастройкиУчетнаяПолитикаФинУчета.ГоловнаяОрганизация
		|		И РазрезыКОтражению.ДатаОтражения = ПериодыНастройкиУчетнаяПолитикаФинУчета.ДатаОтражения
		|		
		|	ЛЕВОЕ СОЕДИНЕНИЕ
		|		РегистрСведений.УчетнаяПолитикаФинансовогоУчета КАК УчетнаяПолитикаФинУчета
		|	ПО
		|		ПериодыНастройкиУчетнаяПолитикаФинУчета.ГоловнаяОрганизация = УчетнаяПолитикаФинУчета.Организация
		|		И ПериодыНастройкиУчетнаяПолитикаФинУчета.ПериодУчетнойПолитики = УчетнаяПолитикаФинУчета.Период
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ
		|		РегистрСведений.УчетнаяПолитикаФинансовогоУчета КАК УчетнаяПолитикаФинУчетаНаСледующийДень
		|	ПО
		|		РазрезыКОтражению.ГоловнаяОрганизация = УчетнаяПолитикаФинУчетаНаСледующийДень.Организация
		|		И НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(РазрезыКОтражению.Период, ДЕНЬ, 1), ДЕНЬ) = УчетнаяПолитикаФинУчетаНаСледующийДень.Период
		|
		|	ЛЕВОЕ СОЕДИНЕНИЕ
		|		ПериодыНастройкиУчетаНалогаНаПрибыль КАК ПериодыНастройкиУчетаНалогаНаПрибыль
		|	ПО
		|		РазрезыКОтражению.Ссылка = ПериодыНастройкиУчетаНалогаНаПрибыль.Ссылка
		|		И РазрезыКОтражению.ГоловнаяОрганизация = ПериодыНастройкиУчетаНалогаНаПрибыль.ГоловнаяОрганизация
		|		И РазрезыКОтражению.ДатаОтражения = ПериодыНастройкиУчетаНалогаНаПрибыль.ДатаОтражения
		|		
		|	ЛЕВОЕ СОЕДИНЕНИЕ
		|		РегистрСведений.НастройкиУчетаНалогаНаПрибыль КАК НастройкиУчетаНалогаНаПрибыль
		|	ПО
		|		ПериодыНастройкиУчетаНалогаНаПрибыль.ГоловнаяОрганизация = НастройкиУчетаНалогаНаПрибыль.Организация
		|		И ПериодыНастройкиУчетаНалогаНаПрибыль.ПериодУчетнойПолитики = НастройкиУчетаНалогаНаПрибыль.Период
		|
		|	ЛЕВОЕ СОЕДИНЕНИЕ
		|		ПериодыНастройкиУчетаНДС КАК ПериодыНастройкиУчетаНДС
		|	ПО
		|		РазрезыКОтражению.Ссылка = ПериодыНастройкиУчетаНДС.Ссылка
		|		И РазрезыКОтражению.ГоловнаяОрганизация = ПериодыНастройкиУчетаНДС.ГоловнаяОрганизация
		|		И РазрезыКОтражению.ДатаОтражения = ПериодыНастройкиУчетаНДС.ДатаОтражения
		|		
		|	ЛЕВОЕ СОЕДИНЕНИЕ
		|		РегистрСведений.НастройкиУчетаНДС КАК НастройкиУчетаНДС
		|	ПО
		|		ПериодыНастройкиУчетаНДС.ГоловнаяОрганизация = НастройкиУчетаНДС.Организация
		|		И ПериодыНастройкиУчетаНДС.ПериодУчетнойПолитики = НастройкиУчетаНДС.Период
		|
		|	ЛЕВОЕ СОЕДИНЕНИЕ
		|		ПериодыНастройкиУчетаНДСПриУСН КАК ПериодыНастройкиУчетаНДСПриУСН
		|	ПО
		|		РазрезыКОтражению.Ссылка = ПериодыНастройкиУчетаНДСПриУСН.Ссылка
		|		И РазрезыКОтражению.ГоловнаяОрганизация = ПериодыНастройкиУчетаНДСПриУСН.ГоловнаяОрганизация
		|		И РазрезыКОтражению.ДатаОтражения = ПериодыНастройкиУчетаНДСПриУСН.ДатаОтражения
		|		
		|	ЛЕВОЕ СОЕДИНЕНИЕ
		|		РегистрСведений.НастройкиУчетаНДСПриУСН КАК НастройкиУчетаНДСПриУСН
		|	ПО
		|		ПериодыНастройкиУчетаНДСПриУСН.ГоловнаяОрганизация = НастройкиУчетаНДСПриУСН.Организация
		|		И ПериодыНастройкиУчетаНДСПриУСН.ПериодУчетнойПолитики = НастройкиУчетаНДСПриУСН.Период
		|ИНДЕКСИРОВАТЬ ПО
		|	Ссылка,
		|	Организация
		|;
		|
		|УНИЧТОЖИТЬ ПериодыНастройкиСистемыНалогообложения
		|;
		|УНИЧТОЖИТЬ ПериодыНастройкиУчетаНалогаНаПрибыль
		|;
		|УНИЧТОЖИТЬ ПериодыНастройкиУчетнаяПолитикаБухУчета
		|;
		|УНИЧТОЖИТЬ ПериодыНастройкиУчетнаяПолитикаФинУчета
		|;
		|УНИЧТОЖИТЬ ПериодыНастройкиУчетаНДС
		|;
		|УНИЧТОЖИТЬ ПериодыНастройкиУчетаНДСПриУСН
		|;
		|";
	
КонецФункции

Функция ТекстСебестоимость()
	
#Область ВтСтроки
	ТекстСебестоимость = "
	|ВЫБРАТЬ
	|	Движения.Регистратор КАК Ссылка,
	|	Движения.Период КАК Период,
	|	Движения.ВидДвижения КАК ВидДвижения,
	|	Движения.Организация КАК Организация,
	|	Движения.КорОрганизация КАК КорОрганизация,
	|	Аналитика.Номенклатура КАК Номенклатура,
	|	ЕСТЬNULL(КорАналитика.Номенклатура, НЕОПРЕДЕЛЕНО) КАК КорНоменклатура,
	|	Аналитика.МестоХранения КАК Склад,
	|	ЕСТЬNULL(КорАналитика.МестоХранения, Аналитика.МестоХранения) КАК КорСклад,
	|	ВЫБОР
	|		КОГДА НЕ Движения.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|			И Аналитика.МестоХранения ССЫЛКА Справочник.Партнеры ИЛИ Аналитика.МестоХранения ССЫЛКА Справочник.Организации
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоПродаже)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаСкладах)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			И ЕСТЬNULL(Аналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦВПроизводстве)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			И Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦПотребленныеВПроизводстве)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦНаСкладах)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦУХранителей)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеКОформлениюСписания),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиКОформлениюСписания))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦКСписанию)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			И ЕСТЬNULL(Аналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуВПроизводстве)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			И Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПотребленныеВПроизводстве)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработку)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработкуПереданныеПартнерам)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуУХранителей)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработкуКОформлениюСписания)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуКСписанию)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|			И Аналитика.МестоХранения ССЫЛКА Справочник.Партнеры ИЛИ Аналитика.МестоХранения ССЫЛКА Справочник.Организации
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыПереданныеНаКомиссию)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыНаСкладе)
	|		КОГДА ЕСТЬNULL(Аналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ)
	|			ИЛИ Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|			ИЛИ Движения.РазделУчета В (
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗатратыНаПриобретениеТМЦ)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ВидСчета,
	|	ВЫБОР
	|		КОГДА НЕ Движения.КорРазделУчета В (&ЗабалансовыеРазделыУчета)
	|			И КорАналитика.МестоХранения ССЫЛКА Справочник.Партнеры ИЛИ КорАналитика.МестоХранения ССЫЛКА Справочник.Организации
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоПродаже)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаСкладах)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			И ЕСТЬNULL(КорАналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦВПроизводстве)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			И КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦПотребленныеВПроизводстве)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦНаСкладах)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦУХранителей)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеКОформлениюСписания),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиКОформлениюСписания))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦКСписанию)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			И ЕСТЬNULL(КорАналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуВПроизводстве)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			И КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПотребленныеВПроизводстве)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработку)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработкуПереданныеПартнерам)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуУХранителей)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработкуКОформлениюСписания)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуКСписанию)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|			И КорАналитика.МестоХранения ССЫЛКА Справочник.Партнеры ИЛИ КорАналитика.МестоХранения ССЫЛКА Справочник.Организации
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыПереданныеНаКомиссию)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыНаСкладе)
	|		КОГДА ЕСТЬNULL(КорАналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ)
	|			ИЛИ КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|			ИЛИ Движения.КорРазделУчета В (
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗатратыНаПриобретениеТМЦ)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК КорВидСчета,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЕСТЬNULL(ВидыЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Аналитика.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА Аналитика.Договор.Подразделение
	|		КОГДА Движения.РазделУчета В (
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|			И (Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер)
	|				ИЛИ Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	//++ Устарело_Переработка24
	|			И (Движения.Регистратор ССЫЛКА Документ.ОтчетПереработчика
	|				ИЛИ Движения.Регистратор ССЫЛКА Документ.ПоступлениеОтПереработчика)
	//-- Устарело_Переработка24
	|		ТОГДА ЕСТЬNULL(ВидыЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеПереданныеПартнерам))
	|		ТОГДА ЕСТЬNULL(ВидыЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ПодразделениеАналитики,
	|	ВЫБОР
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЕСТЬNULL(ЕСТЬNULL(КорВидыЗапасов.Договор.Подразделение, ВидыЗапасов.Договор.Подразделение), НЕОПРЕДЕЛЕНО)
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА ЕСТЬNULL(КорАналитика.Подразделение, Аналитика.Подразделение)
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА ЕСТЬNULL(КорАналитика.Договор.Подразделение, Аналитика.Договор.Подразделение)
	|		КОГДА Движения.КорРазделУчета В (
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|			И (КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер)
	|				ИЛИ КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	//++ Устарело_Переработка24
	|			И (Движения.Регистратор ССЫЛКА Документ.ОтчетПереработчика
	|				ИЛИ Движения.Регистратор ССЫЛКА Документ.ПоступлениеОтПереработчика)
	//-- Устарело_Переработка24
	|		ТОГДА ЕСТЬNULL(КорВидыЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеПереданныеПартнерам))
	|		ТОГДА ЕСТЬNULL(ЕСТЬNULL(КорВидыЗапасов.Договор.Подразделение, ВидыЗапасов.Договор.Подразделение), НЕОПРЕДЕЛЕНО)
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА ЕСТЬNULL(КорАналитика.СкладскаяТерритория.Подразделение, Аналитика.СкладскаяТерритория.Подразделение)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК КорПодразделениеАналитики,
	|
	|	ВЫБОР КОГДА Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа) ТОГДА
	|		Аналитика.Номенклатура.ГруппаФинансовогоУчета
	|	КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета ТОГДА
	|		ЕСТЬNULL(ВидыЗапасов.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка))
	|	ИНАЧЕ
	|		Аналитика.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК ГруппаФинансовогоУчета,
	|
	|	ВЫБОР КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета ТОГДА
	|		ЕСТЬNULL(КорВидыЗапасов.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка))
	|	ИНАЧЕ
	|		ЕСТЬNULL(КорАналитика.Номенклатура.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка))
	|	КОНЕЦ КАК КорГруппаФинансовогоУчета,
	|
	|	ЕСТЬNULL(ВидыЗапасов.ТипЗапасов, ЗНАЧЕНИЕ(Перечисление.ТипыЗапасов.ПустаяСсылка)) КАК ТипЗапасов,
	|	ЕСТЬNULL(КорВидыЗапасов.ТипЗапасов, ЗНАЧЕНИЕ(Перечисление.ТипыЗапасов.ПустаяСсылка)) КАК КорТипЗапасов,
	|
	|	ВЫБОР
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА Аналитика.Договор.Контрагент
	|		КОГДА ВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец) И Движения.РазделУчета <>
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ВидыЗапасов.Контрагент
	|		КОГДА Движения.АналитикаУчетаПоПартнерам <> ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПоПартнерам.ПустаяСсылка)
	|		ТОГДА Движения.АналитикаУчетаПоПартнерам.Контрагент
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер)
	|		ТОГДА Аналитика.Контрагент
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация)
	|		ТОГДА Аналитика.МестоХранения
	|		КОГДА ВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец) И Движения.РазделУчета =
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ВидыЗапасов.Контрагент
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка)
	|	КОНЕЦ КАК Контрагент,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) =
	|			ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА ЕСТЬNULL(КорАналитика.Договор.Контрагент, Аналитика.Договор.Контрагент)
	|		КОГДА ЕСТЬNULL(КорВидыЗапасов.ТипЗапасов, ВидыЗапасов.ТипЗапасов) В (&ТипыЗапасовВнешнийВладелец)
	|			И Движения.КорРазделУчета <> ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЕСТЬNULL(КорВидыЗапасов.Контрагент, ВидыЗапасов.Контрагент)
	|		КОГДА Движения.АналитикаУчетаПоПартнерам <> ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПоПартнерам.ПустаяСсылка)
	|		ТОГДА Движения.АналитикаУчетаПоПартнерам.Контрагент
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер)
	|		ТОГДА ЕСТЬNULL(КорАналитика.Контрагент, Аналитика.Контрагент)
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация)
	|		ТОГДА ЕСТЬNULL(КорАналитика.МестоХранения, Аналитика.МестоХранения)
	|		КОГДА ЕСТЬNULL(КорВидыЗапасов.ТипЗапасов, ВидыЗапасов.ТипЗапасов) В (&ТипыЗапасовВнешнийВладелец)
	|			И Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЕСТЬNULL(КорВидыЗапасов.Контрагент, ВидыЗапасов.Контрагент)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка)
	|	КОНЕЦ КАК КорКонтрагент,
	|	ВЫБОР
	|		КОГДА КорВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец)
	|			И КорВидыЗапасов.Договор ССЫЛКА Справочник.ДоговорыМеждуОрганизациями
	|			И Движения.Организация = КорВидыЗапасов.Договор.ОрганизацияПолучатель
	|		ТОГДА ЕСТЬNULL(КорВидыЗапасов.Договор.ГруппаФинансовогоУчетаПолучателя, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА КорВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец)
	|		ТОГДА ЕСТЬNULL(КорВидыЗапасов.Договор.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА ВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец)
	|			И ВидыЗапасов.Договор ССЫЛКА Справочник.ДоговорыМеждуОрганизациями
	|			И Движения.Организация = ВидыЗапасов.Договор.ОрганизацияПолучатель
	|		ТОГДА ЕСТЬNULL(ВидыЗапасов.Договор.ГруппаФинансовогоУчетаПолучателя, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА ВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец)
	|		ТОГДА ЕСТЬNULL(ВидыЗапасов.Договор.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЕСТЬNULL(Аналитика.Договор.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА Движения.АналитикаУчетаПоПартнерам <> ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПоПартнерам.ПустаяСсылка)
	|			И Движения.АналитикаУчетаПоПартнерам.Договор ССЫЛКА Справочник.ДоговорыМеждуОрганизациями
	|			И Движения.Организация = Движения.АналитикаУчетаПоПартнерам.Договор.ОрганизацияПолучатель
	|		ТОГДА ЕСТЬNULL(Движения.АналитикаУчетаПоПартнерам.Договор.ГруппаФинансовогоУчетаПолучателя, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА Движения.АналитикаУчетаПоПартнерам <> ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПоПартнерам.ПустаяСсылка)
	|		ТОГДА ЕСТЬNULL(Движения.АналитикаУчетаПоПартнерам.Договор.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка)
	|	КОНЕЦ КАК ГруппаФинансовогоУчетаРасчетов,
	|
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		КОГДА &ПартионныйУчетВерсии22 И Движения.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ)
	|			И ТИПЗНАЧЕНИЯ(Движения.АналитикаФинансовогоУчета) = ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|			ТОГДА Движения.АналитикаФинансовогоУчета
	|		КОГДА НЕ &АналитическийУчетПоГруппамПродукции
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		КОГДА НЕ Движения.ГруппаПродукции = ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		 И НЕ ТИПЗНАЧЕНИЯ(Движения.Регистратор) В (&ТипыДокументовПроизводства22)
	|		 И НЕ Движения.ХозяйственнаяОперация В (
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПередачаПродукцииИзКладовой),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПередачаПродукцииИзПроизводства),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзПроизводства),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзКладовой))
	|			ТОГДА Движения.ГруппаПродукции
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|	КОНЕЦ КАК ГруппаПродукции,
	|	ВЫБОР
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		КОГДА &ПартионныйУчетВерсии22 И Движения.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ)
	|			И ТИПЗНАЧЕНИЯ(Движения.КорАналитикаФинансовогоУчета) = ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|			ТОГДА Движения.КорАналитикаФинансовогоУчета
	|		КОГДА НЕ &АналитическийУчетПоГруппамПродукции
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		КОГДА НЕ Движения.ГруппаПродукции = ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		 И НЕ ТИПЗНАЧЕНИЯ(Движения.Регистратор) В (&ТипыДокументовПроизводства22)
	|		 И НЕ Движения.ХозяйственнаяОперация В (
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПередачаПродукцииИзКладовой),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПередачаПродукцииИзПроизводства),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзПроизводства),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзКладовой))
	|			ТОГДА Движения.ГруппаПродукции
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|	КОНЕЦ КАК КорГруппаПродукции,
	|
	|	ВЫБОР
	|		КОГДА Движения.ВидЗапасов = ЗНАЧЕНИЕ(Справочник.ВидыЗапасов.ПустаяСсылка)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Работы)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.МатериальныеЗатраты)
	|	КОНЕЦ КАК ТипЗатрат,
	|	ЕСТЬNULL(Аналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|	ИЛИ Движения.РазделУчета В (
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство)) КАК ПроизводственныеЗатраты,
	|	ЕСТЬNULL(КорАналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|	ИЛИ Движения.КорРазделУчета В (
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство)) КАК КорПроизводственныеЗатраты,
	|	Аналитика.Номенклатура.ТипНоменклатуры КАК ТипНоменклатуры,
	|	ЕСТЬNULL(КорАналитика.Номенклатура.ТипНоменклатуры, НЕОПРЕДЕЛЕНО) КАК КорТипНоменклатуры,
	|
	|	Движения.РазделУчета КАК РазделУчета,
	|	Движения.КорРазделУчета КАК КорРазделУчета,
	|	Движения.Подразделение КАК Подразделение,
	|	Движения.АналитикаРасходов КАК АналитикаРасходов,
	|	Движения.СтатьяРасходовСписания КАК СтатьяРасходов,
	|	Движения.АналитикаДоходов КАК АналитикаДоходов,
	|	Движения.СтатьяДоходов КАК СтатьяДоходов,
	|	Движения.АналитикаАктивовПассивов КАК АналитикаАктивовПассивов,
	|	Движения.СтатьяАктивовПассивов КАК СтатьяАктивовПассивов,
	|	Движения.НастройкаСчетовУчета КАК НастройкаСчетовУчета,
	|	Движения.ХозяйственнаяОперация КАК ХозяйственнаяОперация,
	|
	|	ВЫБОР
	|		КОГДА Движения.ИдентификаторСтроки = ""ВО"" ТОГДА """"
	|		ИНАЧЕ Движения.ИдентификаторСтроки КОНЕЦ КАК ИдентификаторСтроки,
	|	Движения.ПериодПродажи КАК ПериодПродажи,
	|
	|	ВЫБОР
	|		КОГДА ТИПЗНАЧЕНИЯ(Движения.Партия) = ТИП(Справочник.ПартииПроизводства)
	|			ТОГДА ВЫРАЗИТЬ(Движения.Партия КАК Справочник.ПартииПроизводства).НаправлениеДеятельности
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|			И Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|			ТОГДА ЕСТЬNULL(Назначения.НаправлениеДеятельности, Аналитика.Договор.НаправлениеДеятельности)
	|		ИНАЧЕ ЕСТЬNULL(Назначения.НаправлениеДеятельности, ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка))
	|	КОНЕЦ КАК НаправлениеДеятельности,
	|	ВЫБОР
	|		КОГДА ТИПЗНАЧЕНИЯ(Движения.КорПартия) = ТИП(Справочник.ПартииПроизводства)
	|			ТОГДА ВЫРАЗИТЬ(Движения.КорПартия КАК Справочник.ПартииПроизводства).НаправлениеДеятельности
	|		КОГДА КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|			И Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|			ТОГДА ЕСТЬNULL(КорНазначения.НаправлениеДеятельности, КорАналитика.Договор.НаправлениеДеятельности)
	|		ИНАЧЕ ЕСТЬNULL(КорНазначения.НаправлениеДеятельности, Движения.КорНаправлениеДеятельности)
	|	КОНЕЦ КАК КорНаправлениеДеятельности,
	|
	|	ВЫБОР
	|		КОГДА Движения.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|			И Движения.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.Дополнение)
	|			И (Движения.Регистратор ССЫЛКА Документ.ОтчетПереработчика2_5
	//++ НЕ УТКА
	|				ИЛИ Движения.Регистратор ССЫЛКА Документ.ОтчетДавальцуМеждуОрганизациями
	//-- НЕ УТКА
	//++ Устарело_Переработка24
	|				ИЛИ Движения.Регистратор ССЫЛКА Документ.ОтчетПереработчика
	|					И Движения.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ЗакупкаУПоставщика)
	//-- Устарело_Переработка24
	|				ИЛИ ЛОЖЬ)
	|		ТОГДА Движения.ТипЗаписи
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ТипЗаписи,
	|
	|	ВЫБОР
	|		КОГДА Движения.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|		ТОГДА -1
	|		ИНАЧЕ 1
	|	КОНЕЦ КАК Знак,
	|	СУММА(Движения.Количество) КАК Количество,
	|	СУММА(ВЫБОР
	|			КОГДА Движения.СтоимостьРегл <> 0
	|			ТОГДА Движения.СтоимостьРегл
	|			КОГДА РасчетСебестоимостиТоваровОкончательный.Ссылка ЕСТЬ NULL
	|			ТОГДА ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.СтоимостьРегл, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|				+ ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.ДопРасходыРегл, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|				+ ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.ТрудозатратыРегл, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|				+ ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.ПостатейныеПостоянныеРегл, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|				+ ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.ПостатейныеПеременныеРегл, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК Сумма,
	|	СУММА(ВЫБОР
	|			КОГДА Движения.СтоимостьУпр <> 0
	|			ТОГДА Движения.СтоимостьУпр
	|			КОГДА РасчетСебестоимостиТоваровОкончательный.Ссылка ЕСТЬ NULL
	|			ТОГДА ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.СтоимостьУпр, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|				+ ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.ДопРасходыУпр, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|				+ ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.ТрудозатратыУпр, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|				+ ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.ПостатейныеПостоянныеУпр, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|				+ ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.ПостатейныеПеременныеУпр, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК СуммаУУ,
	|	СУММА(ВЫБОР
	|			КОГДА Движения.СтоимостьРегл <> 0
	|			ТОГДА Движения.СтоимостьРегл
	|			КОГДА РасчетСебестоимостиТоваровОкончательный.Ссылка ЕСТЬ NULL
	|			ТОГДА ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.СтоимостьРегл, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|				+ ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.ДопРасходыРегл, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|				+ ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.ТрудозатратыРегл, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|				+ ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.ПостатейныеПостоянныеРегл, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|				+ ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.ПостатейныеПеременныеРегл, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК СуммаБалансовая,
	|	СУММА(ВЫБОР
	|			КОГДА Движения.СтоимостьУпр <> 0
	|			ТОГДА Движения.СтоимостьУпр
	|			КОГДА РасчетСебестоимостиТоваровОкончательный.Ссылка ЕСТЬ NULL
	|			ТОГДА ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.СтоимостьУпр, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|				+ ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.ДопРасходыУпр, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|				+ ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.ТрудозатратыУпр, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|				+ ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.ПостатейныеПостоянныеУпр, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|				+ ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.ПостатейныеПеременныеУпр, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК СуммаБалансоваяУУ,
	|	СУММА(ВЫБОР
	|			КОГДА Движения.СтоимостьЗабалансоваяРегл <> 0
	|			ТОГДА Движения.СтоимостьЗабалансоваяРегл
	|			КОГДА РасчетСебестоимостиТоваровОкончательный.Ссылка ЕСТЬ NULL
	|			ТОГДА ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.СтоимостьЗабалансоваяРегл, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК СуммаЗабалансовая,
	|	СУММА(ВЫБОР
	|			КОГДА Движения.СтоимостьЗабалансовая <> 0
	|			ТОГДА Движения.СтоимостьЗабалансовая
	|			КОГДА РасчетСебестоимостиТоваровОкончательный.Ссылка ЕСТЬ NULL
	|			ТОГДА ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.СтоимостьЗабалансовая, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК СуммаЗабалансоваяУУ,
	|	СУММА(ВЫБОР
	|			КОГДА Движения.ПостояннаяРазница <> 0
	|			ТОГДА Движения.ПостояннаяРазница
	|			КОГДА РасчетСебестоимостиТоваровОкончательный.Ссылка ЕСТЬ NULL
	|			ТОГДА ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.ПостояннаяРазница, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК СуммаПР,
	|	СУММА(ВЫБОР
	|			КОГДА Движения.ВременнаяРазница <> 0
	|			ТОГДА Движения.ВременнаяРазница
	|			КОГДА РасчетСебестоимостиТоваровОкончательный.Ссылка ЕСТЬ NULL
	|			ТОГДА ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.ВременнаяРазница, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК СуммаВР,
	|	СУММА(ВЫБОР
	|			КОГДА Движения.СтоимостьРегл <> 0 ИЛИ Движения.ПостояннаяРазница <> 0 ИЛИ Движения.ВременнаяРазница <> 0
	|			ТОГДА Движения.СтоимостьРегл - Движения.ПостояннаяРазница - Движения.ВременнаяРазница
	|			КОГДА РасчетСебестоимостиТоваровОкончательный.Ссылка ЕСТЬ NULL
	|			ТОГДА ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.СтоимостьРегл, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|				+ ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.ДопРасходыРегл, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|				+ ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.ТрудозатратыРегл, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|				+ ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.ПостатейныеПостоянныеРегл, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|				+ ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.ПостатейныеПеременныеРегл, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|				- ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.ПостояннаяРазница, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|				- ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьТоваров.ВременнаяРазница, 0) КАК ЧИСЛО(31,2)) * ВЫРАЗИТЬ(Движения.Количество КАК ЧИСЛО(31,3))
	|			ИНАЧЕ 0
	|		КОНЕЦ) КАК СуммаНУ,
	|	ВЫБОР
	|		КОГДА &ИспользоватьПартионныйУчет И НЕ (&ПартионныйУчетВерсии22 И Движения.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ))
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ПустаяСсылка)
	|		ИНАЧЕ Движения.НастройкаХозяйственнойОперации
	|	КОНЕЦ КАК НастройкаХозяйственнойОперации,
	|	ВЫБОР
	|		КОГДА &ИспользоватьПартионныйУчет И НЕ (&ПартионныйУчетВерсии22 И Движения.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ))
	|			ТОГДА """"
	|		ИНАЧЕ Движения.ИдентификаторФинЗаписи 
	|	КОНЕЦ КАК ИдентификаторФинЗаписи
	|
	|ПОМЕСТИТЬ ВтСтроки
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.СебестоимостьТоваров КАК Движения
	|	ПО
	|		Движения.Регистратор = ДокументыКОтражению.Ссылка
	|		И НЕ Движения.РасчетСебестоимости
	|		И Движения.Активность
	|		И НЕ Движения.Сторно
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ВидыЗапасов КАК ВидыЗапасов
	|	ПО Движения.ВидЗапасов = ВидыЗапасов.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ВидыЗапасов КАК КорВидыЗапасов
	|	ПО Движения.КорВидЗапасов = КорВидыЗапасов.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Справочник.КлючиАналитикиУчетаНоменклатуры КАК Аналитика
	|	ПО
	|		Движения.АналитикаУчетаНоменклатуры = Аналитика.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Назначения КАК Назначения
	|		ПО Аналитика.Назначение = Назначения.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		Справочник.КлючиАналитикиУчетаНоменклатуры КАК КорАналитика
	|	ПО
	|		Движения.КорАналитикаУчетаНоменклатуры = КорАналитика.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Назначения КАК КорНазначения
	|		ПО КорАналитика.Назначение = КорНазначения.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		РегистрСведений.СтоимостьТоваров КАК СтоимостьТоваров
	|	ПО
	|		НАЧАЛОПЕРИОДА(Движения.Период, Месяц) = СтоимостьТоваров.Период
	|		И Движения.АналитикаУчетаНоменклатуры = СтоимостьТоваров.АналитикаУчетаНоменклатуры
	|		И Движения.РазделУчета = СтоимостьТоваров.РазделУчета
	|		И Движения.ВидЗапасов = СтоимостьТоваров.ВидЗапасов
	|		И Движения.Организация = СтоимостьТоваров.Организация
	|		И СтоимостьТоваров.Активность
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		Документ.РасчетСебестоимостиТоваров.Организации КАК РасчетСебестоимостиТоваровОкончательный
	|	ПО
	|		НАЧАЛОПЕРИОДА(Движения.Период, Месяц) = НАЧАЛОПЕРИОДА(РасчетСебестоимостиТоваровОкончательный.Ссылка.Дата, МЕСЯЦ)
	|		И Движения.Организация = РасчетСебестоимостиТоваровОкончательный.Организация
	|		И РасчетСебестоимостиТоваровОкончательный.Ссылка.Проведен
	|		И НЕ РасчетСебестоимостиТоваровОкончательный.Ссылка.ПредварительныйРасчет
	|
	|ГДЕ
	|	ВЫБОР 
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение)
	|			И Движения.ХозяйственнаяОперация В (ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВыпускПродукции),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВыпускПродукцииФиксированнаяСтоимость))
	|			ТОГДА 
	|				Движения.Количество > 0
	|			ИНАЧЕ
	|				ИСТИНА
	|	КОНЕЦ
	|	И ВЫБОР КОГДА ТИПЗНАЧЕНИЯ(Движения.Регистратор) В (&ТипыДокументовСВключениемНДСВСебестоимость)
	|		И Движения.НастройкаХозяйственнойОперации.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВключениеНДСВСтоимость)
	|		ТОГДА ИСТИНА
	|		КОГДА Движения.ХозяйственнаяОперация В (ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СборкаТоваров),
	|			ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.РазборкаТоваров))
	|		ТОГДА ИСТИНА
	|		ИНАЧЕ Движения.Количество <> 0  КОНЕЦ
	|	И Движения.Организация <> ЗНАЧЕНИЕ(Справочник.Организации.УправленческаяОрганизация)
	|	И НЕ Движения.ХозяйственнаяОперация В (
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеРезервовПодОбесценениеЗапасов),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВосстановлениеРезервовПодОбесценениеЗапасов),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.НачислениеРезерваПодОбесценениеЗапасов))
	|
	|СГРУППИРОВАТЬ ПО
	|	Движения.Регистратор,
	|	Движения.Период,
	|	Движения.ВидДвижения,
	|	Движения.Организация,
	|	Движения.КорОрганизация,
	|	Аналитика.Номенклатура,
	|	ЕСТЬNULL(КорАналитика.Номенклатура, НЕОПРЕДЕЛЕНО),
	|	Аналитика.МестоХранения,
	|	ЕСТЬNULL(КорАналитика.МестоХранения, Аналитика.МестоХранения),
	|	ВЫБОР
	|		КОГДА НЕ Движения.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|			И Аналитика.МестоХранения ССЫЛКА Справочник.Партнеры ИЛИ Аналитика.МестоХранения ССЫЛКА Справочник.Организации
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоПродаже)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаСкладах)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			И ЕСТЬNULL(Аналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦВПроизводстве)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			И Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦПотребленныеВПроизводстве)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦНаСкладах)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦУХранителей)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеКОформлениюСписания),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиКОформлениюСписания))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦКСписанию)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			И ЕСТЬNULL(Аналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуВПроизводстве)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			И Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПотребленныеВПроизводстве)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработку)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработкуПереданныеПартнерам)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуУХранителей)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработкуКОформлениюСписания)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуКСписанию)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|			И Аналитика.МестоХранения ССЫЛКА Справочник.Партнеры ИЛИ Аналитика.МестоХранения ССЫЛКА Справочник.Организации
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыПереданныеНаКомиссию)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыНаСкладе)
	|		КОГДА ЕСТЬNULL(Аналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ)
	|			ИЛИ Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|			ИЛИ Движения.РазделУчета В (
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗатратыНаПриобретениеТМЦ)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ Движения.КорРазделУчета В (&ЗабалансовыеРазделыУчета)
	|			И КорАналитика.МестоХранения ССЫЛКА Справочник.Партнеры ИЛИ КорАналитика.МестоХранения ССЫЛКА Справочник.Организации
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоПродаже)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаСкладах)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			И ЕСТЬNULL(КорАналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦВПроизводстве)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			И КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦПотребленныеВПроизводстве)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦНаСкладах)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦУХранителей)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеКОформлениюСписания),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиКОформлениюСписания))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦКСписанию)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			И ЕСТЬNULL(КорАналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуВПроизводстве)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			И КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПотребленныеВПроизводстве)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработку)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработкуПереданныеПартнерам)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуУХранителей)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработкуКОформлениюСписания)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуКСписанию)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|			И КорАналитика.МестоХранения ССЫЛКА Справочник.Партнеры ИЛИ КорАналитика.МестоХранения ССЫЛКА Справочник.Организации
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыПереданныеНаКомиссию)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыНаСкладе)
	|		КОГДА ЕСТЬNULL(КорАналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ)
	|			ИЛИ КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|			ИЛИ Движения.КорРазделУчета В (
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗатратыНаПриобретениеТМЦ)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЕСТЬNULL(ВидыЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Аналитика.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА Аналитика.Договор.Подразделение
	|		КОГДА Движения.РазделУчета В (
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|			И (Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер)
	|				ИЛИ Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	//++ Устарело_Переработка24
	|			И (Движения.Регистратор ССЫЛКА Документ.ОтчетПереработчика
	|				ИЛИ Движения.Регистратор ССЫЛКА Документ.ПоступлениеОтПереработчика)
	//-- Устарело_Переработка24
	|		ТОГДА ЕСТЬNULL(ВидыЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеПереданныеПартнерам))
	|		ТОГДА ЕСТЬNULL(ВидыЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЕСТЬNULL(ЕСТЬNULL(КорВидыЗапасов.Договор.Подразделение, ВидыЗапасов.Договор.Подразделение), НЕОПРЕДЕЛЕНО)
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА ЕСТЬNULL(КорАналитика.Подразделение, Аналитика.Подразделение)
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА ЕСТЬNULL(КорАналитика.Договор.Подразделение, Аналитика.Договор.Подразделение)
	|		КОГДА Движения.КорРазделУчета В (
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|			И (КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер)
	|				ИЛИ КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	//++ Устарело_Переработка24
	|			И (Движения.Регистратор ССЫЛКА Документ.ОтчетПереработчика
	|				ИЛИ Движения.Регистратор ССЫЛКА Документ.ПоступлениеОтПереработчика)
	//-- Устарело_Переработка24
	|		ТОГДА ЕСТЬNULL(КорВидыЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеПереданныеПартнерам))
	|		ТОГДА ЕСТЬNULL(ЕСТЬNULL(КорВидыЗапасов.Договор.Подразделение, ВидыЗапасов.Договор.Подразделение), НЕОПРЕДЕЛЕНО)
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА ЕСТЬNULL(КорАналитика.СкладскаяТерритория.Подразделение, Аналитика.СкладскаяТерритория.Подразделение)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ,
	|
	|	ВЫБОР КОГДА Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа) ТОГДА
	|		Аналитика.Номенклатура.ГруппаФинансовогоУчета
	|	КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета ТОГДА
	|		ЕСТЬNULL(ВидыЗапасов.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка))
	|	ИНАЧЕ
	|		Аналитика.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ,
	|
	|	ВЫБОР КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета ТОГДА
	|		ЕСТЬNULL(КорВидыЗапасов.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка))
	|	ИНАЧЕ
	|		ЕСТЬNULL(КорАналитика.Номенклатура.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка))
	|	КОНЕЦ,
	|
	|	ЕСТЬNULL(ВидыЗапасов.ТипЗапасов, ЗНАЧЕНИЕ(Перечисление.ТипыЗапасов.ПустаяСсылка)),
	|	ЕСТЬNULL(КорВидыЗапасов.ТипЗапасов, ЗНАЧЕНИЕ(Перечисление.ТипыЗапасов.ПустаяСсылка)),
	|
	|	ВЫБОР
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА Аналитика.Договор.Контрагент
	|		КОГДА ВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец) И Движения.РазделУчета <>
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ВидыЗапасов.Контрагент
	|		КОГДА Движения.АналитикаУчетаПоПартнерам <> ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПоПартнерам.ПустаяСсылка)
	|		ТОГДА Движения.АналитикаУчетаПоПартнерам.Контрагент
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер)
	|		ТОГДА Аналитика.Контрагент
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация)
	|		ТОГДА Аналитика.МестоХранения
	|		КОГДА ВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец) И Движения.РазделУчета =
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ВидыЗапасов.Контрагент
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка)
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) =
	|			ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА ЕСТЬNULL(КорАналитика.Договор.Контрагент, Аналитика.Договор.Контрагент)
	|		КОГДА ЕСТЬNULL(КорВидыЗапасов.ТипЗапасов, ВидыЗапасов.ТипЗапасов) В (&ТипыЗапасовВнешнийВладелец)
	|			И Движения.КорРазделУчета <> ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЕСТЬNULL(КорВидыЗапасов.Контрагент, ВидыЗапасов.Контрагент)
	|		КОГДА Движения.АналитикаУчетаПоПартнерам <> ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПоПартнерам.ПустаяСсылка)
	|		ТОГДА Движения.АналитикаУчетаПоПартнерам.Контрагент
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер)
	|		ТОГДА ЕСТЬNULL(КорАналитика.Контрагент, Аналитика.Контрагент)
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация)
	|		ТОГДА ЕСТЬNULL(КорАналитика.МестоХранения, Аналитика.МестоХранения)
	|		КОГДА ЕСТЬNULL(КорВидыЗапасов.ТипЗапасов, ВидыЗапасов.ТипЗапасов) В (&ТипыЗапасовВнешнийВладелец)
	|			И Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЕСТЬNULL(КорВидыЗапасов.Контрагент, ВидыЗапасов.Контрагент)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка)
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА КорВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец)
	|			И КорВидыЗапасов.Договор ССЫЛКА Справочник.ДоговорыМеждуОрганизациями
	|			И Движения.Организация = КорВидыЗапасов.Договор.ОрганизацияПолучатель
	|		ТОГДА ЕСТЬNULL(КорВидыЗапасов.Договор.ГруппаФинансовогоУчетаПолучателя, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА КорВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец)
	|		ТОГДА ЕСТЬNULL(КорВидыЗапасов.Договор.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА ВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец)
	|			И ВидыЗапасов.Договор ССЫЛКА Справочник.ДоговорыМеждуОрганизациями
	|			И Движения.Организация = ВидыЗапасов.Договор.ОрганизацияПолучатель
	|		ТОГДА ЕСТЬNULL(ВидыЗапасов.Договор.ГруппаФинансовогоУчетаПолучателя, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА ВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец)
	|		ТОГДА ЕСТЬNULL(ВидыЗапасов.Договор.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЕСТЬNULL(Аналитика.Договор.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА Движения.АналитикаУчетаПоПартнерам <> ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПоПартнерам.ПустаяСсылка)
	|			И Движения.АналитикаУчетаПоПартнерам.Договор ССЫЛКА Справочник.ДоговорыМеждуОрганизациями
	|			И Движения.Организация = Движения.АналитикаУчетаПоПартнерам.Договор.ОрганизацияПолучатель
	|		ТОГДА ЕСТЬNULL(Движения.АналитикаУчетаПоПартнерам.Договор.ГруппаФинансовогоУчетаПолучателя, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА Движения.АналитикаУчетаПоПартнерам <> ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПоПартнерам.ПустаяСсылка)
	|		ТОГДА ЕСТЬNULL(Движения.АналитикаУчетаПоПартнерам.Договор.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка)
	|	КОНЕЦ,
	|
	|	ВЫБОР
	|		КОГДА ТИПЗНАЧЕНИЯ(Движения.Партия) = ТИП(Справочник.ПартииПроизводства)
	|			ТОГДА ВЫРАЗИТЬ(Движения.Партия КАК Справочник.ПартииПроизводства).НаправлениеДеятельности
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|			И Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|			ТОГДА ЕСТЬNULL(Назначения.НаправлениеДеятельности, Аналитика.Договор.НаправлениеДеятельности)
	|		ИНАЧЕ ЕСТЬNULL(Назначения.НаправлениеДеятельности, ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка))
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ТИПЗНАЧЕНИЯ(Движения.КорПартия) = ТИП(Справочник.ПартииПроизводства)
	|			ТОГДА ВЫРАЗИТЬ(Движения.КорПартия КАК Справочник.ПартииПроизводства).НаправлениеДеятельности
	|		КОГДА КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|			И Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|			ТОГДА ЕСТЬNULL(КорНазначения.НаправлениеДеятельности, КорАналитика.Договор.НаправлениеДеятельности)
	|		ИНАЧЕ ЕСТЬNULL(КорНазначения.НаправлениеДеятельности, Движения.КорНаправлениеДеятельности)
	|	КОНЕЦ,
	|
	|	Движения.АналитикаРасходов,
	|	Движения.РазделУчета,
	|	Движения.КорРазделУчета,
	|	Движения.Подразделение,
	|	Движения.СтатьяРасходовСписания,
	|	Движения.АналитикаДоходов,
	|	Движения.СтатьяДоходов,
	|	Движения.АналитикаАктивовПассивов,
	|	Движения.СтатьяАктивовПассивов,
	|	Движения.НастройкаСчетовУчета,
	|	Движения.ХозяйственнаяОперация,
	|	ВЫБОР
	|		КОГДА Движения.ИдентификаторСтроки = ""ВО"" ТОГДА """"
	|		ИНАЧЕ Движения.ИдентификаторСтроки КОНЕЦ,
	|	Движения.ПериодПродажи,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		КОГДА &ПартионныйУчетВерсии22 И Движения.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ)
	|			И ТИПЗНАЧЕНИЯ(Движения.АналитикаФинансовогоУчета) = ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|			ТОГДА Движения.АналитикаФинансовогоУчета
	|		КОГДА НЕ &АналитическийУчетПоГруппамПродукции
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		КОГДА НЕ Движения.ГруппаПродукции = ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		 И НЕ ТИПЗНАЧЕНИЯ(Движения.Регистратор) В (&ТипыДокументовПроизводства22)
	|		 И НЕ Движения.ХозяйственнаяОперация В (
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПередачаПродукцииИзКладовой),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПередачаПродукцииИзПроизводства),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзПроизводства),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзКладовой))
	|			ТОГДА Движения.ГруппаПродукции
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		КОГДА &ПартионныйУчетВерсии22 И Движения.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ)
	|			И ТИПЗНАЧЕНИЯ(Движения.КорАналитикаФинансовогоУчета) = ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|			ТОГДА Движения.КорАналитикаФинансовогоУчета
	|		КОГДА НЕ &АналитическийУчетПоГруппамПродукции
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		КОГДА НЕ Движения.ГруппаПродукции = ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		 И НЕ ТИПЗНАЧЕНИЯ(Движения.Регистратор) В (&ТипыДокументовПроизводства22)
	|		 И НЕ Движения.ХозяйственнаяОперация В (
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПередачаПродукцииИзКладовой),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПередачаПродукцииИзПроизводства),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзПроизводства),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзКладовой))
	|			ТОГДА Движения.ГруппаПродукции
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|	КОНЕЦ,
	|
	|	ВЫБОР
	|		КОГДА Движения.ВидЗапасов = ЗНАЧЕНИЕ(Справочник.ВидыЗапасов.ПустаяСсылка)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Работы)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.МатериальныеЗатраты)
	|	КОНЕЦ,
	|	ЕСТЬNULL(Аналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|	ИЛИ Движения.РазделУчета В (
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство)),
	|	ЕСТЬNULL(КорАналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|	ИЛИ Движения.КорРазделУчета В (
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство)),
	|	Аналитика.Номенклатура.ТипНоменклатуры,
	|	ЕСТЬNULL(КорАналитика.Номенклатура.ТипНоменклатуры, НЕОПРЕДЕЛЕНО),
	|	ВЫБОР
	|		КОГДА &ИспользоватьПартионныйУчет И НЕ (&ПартионныйУчетВерсии22 И Движения.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ))
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ПустаяСсылка)
	|		ИНАЧЕ Движения.НастройкаХозяйственнойОперации
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА &ИспользоватьПартионныйУчет И НЕ (&ПартионныйУчетВерсии22 И Движения.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ))
	|			ТОГДА """"
	|		ИНАЧЕ Движения.ИдентификаторФинЗаписи 
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА Движения.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|			И Движения.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.Дополнение)
	|			И (Движения.Регистратор ССЫЛКА Документ.ОтчетПереработчика2_5
	//++ НЕ УТКА
	|				ИЛИ Движения.Регистратор ССЫЛКА Документ.ОтчетДавальцуМеждуОрганизациями
	//-- НЕ УТКА
	//++ Устарело_Переработка24
	|				ИЛИ Движения.Регистратор ССЫЛКА Документ.ОтчетПереработчика
	|					И Движения.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ЗакупкаУПоставщика)
	//-- Устарело_Переработка24
	|				ИЛИ ЛОЖЬ)
	|		ТОГДА Движения.ТипЗаписи
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка,
	|	Номенклатура
	|;
	|/////////////////////////////////////////////////////////////////////////////
	|";
#КонецОбласти

#Область ВтСтоимости
	ТекстСебестоимость = ТекстСебестоимость + "
	|ВЫБРАТЬ
	|	Движения.ДокументДвижения КАК Ссылка,
	|	Движения.Период КАК Период,
	|	Движения.ВидДвижения КАК ВидДвижения,
	|	Движения.Организация КАК Организация,
	|	Движения.КорОрганизация КАК КорОрганизация,
	|	Аналитика.Номенклатура КАК Номенклатура,
	|	ЕСТЬNULL(КорАналитика.Номенклатура, НЕОПРЕДЕЛЕНО) КАК КорНоменклатура,
	|	Аналитика.МестоХранения КАК Склад,
	|	ЕСТЬNULL(КорАналитика.МестоХранения, Аналитика.МестоХранения) КАК КорСклад,
	|	ВЫБОР
	|		КОГДА НЕ Движения.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|			И Аналитика.МестоХранения ССЫЛКА Справочник.Партнеры ИЛИ Аналитика.МестоХранения ССЫЛКА Справочник.Организации
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоПродаже)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаСкладах)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			И ЕСТЬNULL(Аналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦВПроизводстве)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			И Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦПотребленныеВПроизводстве)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦНаСкладах)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦУХранителей)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеКОформлениюСписания),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиКОформлениюСписания))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦКСписанию)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			И ЕСТЬNULL(Аналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуВПроизводстве)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			И Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПотребленныеВПроизводстве)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработку)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработкуПереданныеПартнерам)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуУХранителей)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработкуКОформлениюСписания)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуКСписанию)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|			И Аналитика.МестоХранения ССЫЛКА Справочник.Партнеры ИЛИ Аналитика.МестоХранения ССЫЛКА Справочник.Организации
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыПереданныеНаКомиссию)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыНаСкладе)
	|		КОГДА ЕСТЬNULL(Аналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ)
	|			ИЛИ Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|			ИЛИ Движения.РазделУчета В (
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗатратыНаПриобретениеТМЦ)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ВидСчета,
	|	ВЫБОР
	|		КОГДА НЕ Движения.КорРазделУчета В (&ЗабалансовыеРазделыУчета)
	|			И КорАналитика.МестоХранения ССЫЛКА Справочник.Партнеры ИЛИ КорАналитика.МестоХранения ССЫЛКА Справочник.Организации
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоПродаже)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаСкладах)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			И ЕСТЬNULL(КорАналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦВПроизводстве)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			И КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦПотребленныеВПроизводстве)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦНаСкладах)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦУХранителей)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеКОформлениюСписания),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиКОформлениюСписания))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦКСписанию)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			И ЕСТЬNULL(КорАналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуВПроизводстве)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			И КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПотребленныеВПроизводстве)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработку)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработкуПереданныеПартнерам)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуУХранителей)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработкуКОформлениюСписания)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуКСписанию)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|			И КорАналитика.МестоХранения ССЫЛКА Справочник.Партнеры ИЛИ КорАналитика.МестоХранения ССЫЛКА Справочник.Организации
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыПереданныеНаКомиссию)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыНаСкладе)
	|		КОГДА ЕСТЬNULL(КорАналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ)
	|			ИЛИ КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|			ИЛИ Движения.КорРазделУчета В (
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗатратыНаПриобретениеТМЦ)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК КорВидСчета,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЕСТЬNULL(ВидыЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Аналитика.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА Аналитика.Договор.Подразделение
	|		КОГДА Движения.РазделУчета В (
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|			И (Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер)
	|				ИЛИ Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	//++ Устарело_Переработка24
	|			И (Движения.ДокументДвижения ССЫЛКА Документ.ОтчетПереработчика
	|				ИЛИ Движения.ДокументДвижения ССЫЛКА Документ.ПоступлениеОтПереработчика)
	//-- Устарело_Переработка24
	|		ТОГДА ЕСТЬNULL(ВидыЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеПереданныеПартнерам))
	|		ТОГДА ЕСТЬNULL(ВидыЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ПодразделениеАналитики,
	|	ВЫБОР
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЕСТЬNULL(ЕСТЬNULL(КорВидыЗапасов.Договор.Подразделение, ВидыЗапасов.Договор.Подразделение), НЕОПРЕДЕЛЕНО)
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА ЕСТЬNULL(КорАналитика.Подразделение, Аналитика.Подразделение)
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА ЕСТЬNULL(КорАналитика.Договор.Подразделение, Аналитика.Договор.Подразделение)
	|		КОГДА Движения.КорРазделУчета В (
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|			И (КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер)
	|				ИЛИ КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	//++ Устарело_Переработка24
	|			И (Движения.ДокументДвижения ССЫЛКА Документ.ОтчетПереработчика
	|				ИЛИ Движения.ДокументДвижения ССЫЛКА Документ.ПоступлениеОтПереработчика)
	//-- Устарело_Переработка24
	|		ТОГДА ЕСТЬNULL(КорВидыЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеПереданныеПартнерам))
	|		ТОГДА ЕСТЬNULL(ЕСТЬNULL(КорВидыЗапасов.Договор.Подразделение, ВидыЗапасов.Договор.Подразделение), НЕОПРЕДЕЛЕНО)
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА ЕСТЬNULL(КорАналитика.СкладскаяТерритория.Подразделение, Аналитика.СкладскаяТерритория.Подразделение)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК КорПодразделениеАналитики,
	|
	|	ВЫБОР КОГДА Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа) ТОГДА
	|		Аналитика.Номенклатура.ГруппаФинансовогоУчета
	|	КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета ТОГДА
	|		ЕСТЬNULL(ВидыЗапасов.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка))
	|	ИНАЧЕ
	|		Аналитика.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК ГруппаФинансовогоУчета,
	|	ВЫБОР КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета ТОГДА
	|		ЕСТЬNULL(КорВидыЗапасов.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка))
	|	ИНАЧЕ
	|		ЕСТЬNULL(КорАналитика.Номенклатура.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка))
	|	КОНЕЦ КАК КорГруппаФинансовогоУчета,
	|
	|	ЕСТЬNULL(ВидыЗапасов.ТипЗапасов, ЗНАЧЕНИЕ(Перечисление.ТипыЗапасов.ПустаяСсылка)) КАК ТипЗапасов,
	|	ЕСТЬNULL(КорВидыЗапасов.ТипЗапасов, ЗНАЧЕНИЕ(Перечисление.ТипыЗапасов.ПустаяСсылка)) КАК КорТипЗапасов,
	|
	|	ВЫБОР
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА Аналитика.Договор.Контрагент
	|		КОГДА ВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец) И Движения.РазделУчета <>
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ВидыЗапасов.Контрагент
	|		КОГДА Движения.АналитикаУчетаПоПартнерам <> ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПоПартнерам.ПустаяСсылка)
	|		ТОГДА Движения.АналитикаУчетаПоПартнерам.Контрагент
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер)
	|		ТОГДА Аналитика.Контрагент
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация)
	|		ТОГДА Аналитика.МестоХранения
	|		КОГДА ВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец) И Движения.РазделУчета =
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ВидыЗапасов.Контрагент
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка)
	|	КОНЕЦ КАК Контрагент,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) =
	|			ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА ЕСТЬNULL(КорАналитика.Договор.Контрагент, Аналитика.Договор.Контрагент)
	|		КОГДА ЕСТЬNULL(КорВидыЗапасов.ТипЗапасов, ВидыЗапасов.ТипЗапасов) В (&ТипыЗапасовВнешнийВладелец)
	|			И Движения.КорРазделУчета <> ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЕСТЬNULL(КорВидыЗапасов.Контрагент, ВидыЗапасов.Контрагент)
	|		КОГДА Движения.АналитикаУчетаПоПартнерам <> ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПоПартнерам.ПустаяСсылка)
	|		ТОГДА Движения.АналитикаУчетаПоПартнерам.Контрагент
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер)
	|		ТОГДА ЕСТЬNULL(КорАналитика.Контрагент, Аналитика.Контрагент)
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация)
	|		ТОГДА ЕСТЬNULL(КорАналитика.МестоХранения, Аналитика.МестоХранения)
	|		КОГДА ЕСТЬNULL(КорВидыЗапасов.ТипЗапасов, ВидыЗапасов.ТипЗапасов) В (&ТипыЗапасовВнешнийВладелец)
	|			И Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЕСТЬNULL(КорВидыЗапасов.Контрагент, ВидыЗапасов.Контрагент)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка)
	|	КОНЕЦ КАК КорКонтрагент,
	|	ВЫБОР
	|		КОГДА КорВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец)
	|			И КорВидыЗапасов.Договор ССЫЛКА Справочник.ДоговорыМеждуОрганизациями
	|			И Движения.Организация = КорВидыЗапасов.Договор.ОрганизацияПолучатель
	|		ТОГДА ЕСТЬNULL(КорВидыЗапасов.Договор.ГруппаФинансовогоУчетаПолучателя, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА КорВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец)
	|		ТОГДА ЕСТЬNULL(КорВидыЗапасов.Договор.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА ВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец)
	|			И ВидыЗапасов.Договор ССЫЛКА Справочник.ДоговорыМеждуОрганизациями
	|			И Движения.Организация = ВидыЗапасов.Договор.ОрганизацияПолучатель
	|		ТОГДА ЕСТЬNULL(ВидыЗапасов.Договор.ГруппаФинансовогоУчетаПолучателя, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА ВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец)
	|		ТОГДА ЕСТЬNULL(ВидыЗапасов.Договор.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику))
	|		ТОГДА ЕСТЬNULL(Аналитика.Договор.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА Движения.АналитикаУчетаПоПартнерам <> ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПоПартнерам.ПустаяСсылка)
	|			И Движения.АналитикаУчетаПоПартнерам.Договор ССЫЛКА Справочник.ДоговорыМеждуОрганизациями
	|			И Движения.Организация = Движения.АналитикаУчетаПоПартнерам.Договор.ОрганизацияПолучатель
	|		ТОГДА ЕСТЬNULL(Движения.АналитикаУчетаПоПартнерам.Договор.ГруппаФинансовогоУчетаПолучателя, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА Движения.АналитикаУчетаПоПартнерам <> ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПоПартнерам.ПустаяСсылка)
	|		ТОГДА ЕСТЬNULL(Движения.АналитикаУчетаПоПартнерам.Договор.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка)
	|	КОНЕЦ КАК ГруппаФинансовогоУчетаРасчетов,
	|
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		КОГДА &ПартионныйУчетВерсии22 И Движения.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ)
	|			И ТИПЗНАЧЕНИЯ(Движения.АналитикаФинансовогоУчета) = ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|			ТОГДА Движения.АналитикаФинансовогоУчета
	|		КОГДА НЕ &АналитическийУчетПоГруппамПродукции
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		КОГДА НЕ Движения.ГруппаПродукции = ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		 И НЕ ТИПЗНАЧЕНИЯ(Движения.Регистратор) В (&ТипыДокументовПроизводства22)
	|		 И НЕ Движения.ХозяйственнаяОперация В (
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПередачаПродукцииИзКладовой),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПередачаПродукцииИзПроизводства),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзПроизводства),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзКладовой))
	|			ТОГДА Движения.ГруппаПродукции
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|	КОНЕЦ КАК ГруппаПродукции,
	|	ВЫБОР
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		КОГДА &ПартионныйУчетВерсии22 И Движения.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ)
	|			И ТИПЗНАЧЕНИЯ(Движения.КорАналитикаФинансовогоУчета) = ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|			ТОГДА Движения.КорАналитикаФинансовогоУчета
	|		КОГДА НЕ &АналитическийУчетПоГруппамПродукции
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		КОГДА НЕ Движения.ГруппаПродукции = ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		 И НЕ ТИПЗНАЧЕНИЯ(Движения.Регистратор) В (&ТипыДокументовПроизводства22)
	|		 И НЕ Движения.ХозяйственнаяОперация В (
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПередачаПродукцииИзКладовой),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПередачаПродукцииИзПроизводства),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзПроизводства),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзКладовой))
	|			ТОГДА Движения.ГруппаПродукции
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|	КОНЕЦ КАК КорГруппаПродукции,
	|
	|	ВЫБОР
	|		КОГДА ТИПЗНАЧЕНИЯ(Движения.Партия) = ТИП(Справочник.ПартииПроизводства)
	|			ТОГДА ВЫРАЗИТЬ(Движения.Партия КАК Справочник.ПартииПроизводства).НаправлениеДеятельности
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|			И Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|			ТОГДА ЕСТЬNULL(Назначения.НаправлениеДеятельности, Аналитика.Договор.НаправлениеДеятельности)
	|		ИНАЧЕ ЕСТЬNULL(Назначения.НаправлениеДеятельности, ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка))
	|	КОНЕЦ КАК НаправлениеДеятельности,
	|	ВЫБОР
	|		КОГДА ТИПЗНАЧЕНИЯ(Движения.КорПартия) = ТИП(Справочник.ПартииПроизводства)
	|			ТОГДА ВЫРАЗИТЬ(Движения.КорПартия КАК Справочник.ПартииПроизводства).НаправлениеДеятельности
	|		КОГДА КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|			И Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|			ТОГДА ЕСТЬNULL(КорНазначения.НаправлениеДеятельности, КорАналитика.Договор.НаправлениеДеятельности)
	|		ИНАЧЕ ЕСТЬNULL(КорНазначения.НаправлениеДеятельности, Движения.КорНаправлениеДеятельности)
	|	КОНЕЦ КАК КорНаправлениеДеятельности,
	|
	|	ВЫБОР
	// Поле ТипЗаписи используется в функциях ТекстОтклонениеСтоимостиНаСтатьиАктивовПассивов,
	//	ТекстПеремещениеМеждуФилиаламиПриход и ТекстПеремещениеМеждуФилиаламиРасход.
	// Условия проверки полей ТипЗаписи и ХозяйственнаяОперация должны соответствовать этим функциям.
	|		КОГДА Движения.ТипЗаписи В (ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимости),
	|				ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.КорректировкаПриобретенияПрошлогоПериода),
	|				ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.РаспределениеПоВыбывшимТоварам),
	|				ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимостиНаПрочиеРасходы))
	|			И Движения.ХозяйственнаяОперация В (
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПеремещениеТоваровМеждуФилиалами),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПередачаНаПрочиеЦели))
	|		ТОГДА Движения.ТипЗаписи
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ТипЗаписи,
	|
	|	ВЫБОР
	|		КОГДА Движения.ВидЗапасов = ЗНАЧЕНИЕ(Справочник.ВидыЗапасов.ПустаяСсылка)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Работы)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.МатериальныеЗатраты)
	|	КОНЕЦ КАК ТипЗатрат,
	|	ЕСТЬNULL(Аналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|	ИЛИ Движения.РазделУчета В (
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство)) КАК ПроизводственныеЗатраты,
	|	ЕСТЬNULL(КорАналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|	ИЛИ Движения.КорРазделУчета В (
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство)) КАК КорПроизводственныеЗатраты,
	|	Аналитика.Номенклатура.ТипНоменклатуры КАК ТипНоменклатуры,
	|	ЕСТЬNULL(КорАналитика.Номенклатура.ТипНоменклатуры, НЕОПРЕДЕЛЕНО) КАК КорТипНоменклатуры,
	|
	|	Движения.РазделУчета КАК РазделУчета,
	|	Движения.КорРазделУчета КАК КорРазделУчета,
	|	Движения.Подразделение КАК Подразделение,
	|	Движения.АналитикаРасходов КАК АналитикаРасходов,
	|	Движения.СтатьяРасходовСписания КАК СтатьяРасходов,
	|	Движения.АналитикаДоходов КАК АналитикаДоходов,
	|	Движения.СтатьяДоходов КАК СтатьяДоходов,
	|	Движения.АналитикаАктивовПассивов КАК АналитикаАктивовПассивов,
	|	Движения.СтатьяАктивовПассивов КАК СтатьяАктивовПассивов,
	|	Движения.НастройкаСчетовУчета КАК НастройкаСчетовУчета,
	|	Движения.ХозяйственнаяОперация КАК ХозяйственнаяОперация,
	|	ВЫБОР
	|		КОГДА Движения.ИдентификаторСтроки = ""ВО"" ТОГДА """"
	|		ИНАЧЕ Движения.ИдентификаторСтроки КОНЕЦ КАК ИдентификаторСтроки,
	|	Движения.ПериодПродажи КАК ПериодПродажи,
	|	ВЫБОР 
	|		КОГДА Движения.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) ТОГДА
	|			-1
	|		ИНАЧЕ
	|			1
	|	КОНЕЦ КАК Знак,
	|	СУММА(Движения.СтоимостьРегл + Движения.ДопРасходыРегл + Движения.ТрудозатратыРегл + Движения.ПостатейныеПостоянныеРегл
	|		+ Движения.ПостатейныеПеременныеРегл + ВЫБОР КОГДА Движения.РазделУчета <> ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаСкладах)
	|		ТОГДА Движения.СтоимостьЗабалансоваяРегл ИНАЧЕ 0 КОНЕЦ) КАК Сумма,
	|	СУММА(Движения.СтоимостьУпр + Движения.ДопРасходыУпр + Движения.ТрудозатратыУпр + Движения.ПостатейныеПостоянныеУпр
	|		+ Движения.ПостатейныеПеременныеУпр + ВЫБОР КОГДА Движения.РазделУчета <> ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаСкладах)
	|		ТОГДА Движения.СтоимостьЗабалансовая ИНАЧЕ 0 КОНЕЦ) КАК СуммаУУ,
	|	СУММА(Движения.СтоимостьРегл + Движения.ДопРасходыРегл + Движения.ТрудозатратыРегл + Движения.ПостатейныеПостоянныеРегл
	|		+ Движения.ПостатейныеПеременныеРегл)КАК СуммаБалансовая,
	|	СУММА(Движения.СтоимостьУпр + Движения.ДопРасходыУпр + Движения.ТрудозатратыУпр + Движения.ПостатейныеПостоянныеУпр
	|		+ Движения.ПостатейныеПеременныеУпр)КАК СуммаБалансоваяУУ,
	|	СУММА(Движения.СтоимостьЗабалансоваяРегл) КАК СуммаЗабалансовая,
	|	СУММА(Движения.СтоимостьЗабалансовая) КАК СуммаЗабалансоваяУУ,
	|	СУММА(Движения.СтоимостьРегл + Движения.ДопРасходыРегл + Движения.ТрудозатратыРегл + Движения.ПостатейныеПостоянныеРегл
	|		+ Движения.ПостатейныеПеременныеРегл - Движения.ПостояннаяРазница - Движения.ВременнаяРазница) КАК СуммаНУ,
	|	СУММА(Движения.ПостояннаяРазница) КАК СуммаПР,
	|	СУММА(Движения.ВременнаяРазница) КАК СуммаВР,
	|	СУММА(Движения.РезервПодОбесценениеРегл) КАК РезервПодОбесценениеРегл,
	|	СУММА(Движения.РезервПодОбесценениеУпр) КАК РезервПодОбесценениеУпр,
	|	ВЫБОР
	|		КОГДА &ИспользоватьПартионныйУчет И НЕ (&ПартионныйУчетВерсии22 И Движения.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ))
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ПустаяСсылка)
	|		ИНАЧЕ Движения.НастройкаХозяйственнойОперации
	|	КОНЕЦ КАК НастройкаХозяйственнойОперации,
	|	ВЫБОР
	|		КОГДА &ИспользоватьПартионныйУчет И НЕ (&ПартионныйУчетВерсии22 И Движения.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ))
	|			ТОГДА """"
	|		ИНАЧЕ Движения.ИдентификаторФинЗаписи 
	|	КОНЕЦ КАК ИдентификаторФинЗаписи
	|
	|ПОМЕСТИТЬ ВтСтоимости
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.СебестоимостьТоваров КАК Движения
	|	ПО
	|		Движения.ДокументДвижения = ДокументыКОтражению.Ссылка
	|		И Движения.Активность
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Справочник.КлючиАналитикиУчетаНоменклатуры КАК Аналитика
	|	ПО
	|		Движения.АналитикаУчетаНоменклатуры = Аналитика.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		Справочник.КлючиАналитикиУчетаНоменклатуры КАК КорАналитика
	|	ПО
	|		Движения.КорАналитикаУчетаНоменклатуры = КорАналитика.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ВидыЗапасов КАК ВидыЗапасов
	|	ПО Движения.ВидЗапасов = ВидыЗапасов.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ВидыЗапасов КАК КорВидыЗапасов
	|	ПО Движения.КорВидЗапасов = КорВидыЗапасов.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Назначения КАК Назначения
	|		ПО Аналитика.Назначение = Назначения.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Назначения КАК КорНазначения
	|		ПО КорАналитика.Назначение = КорНазначения.Ссылка
	|ГДЕ
	|	ВЫБОР 
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение)
	|			И Движения.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			И Движения.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВыпускПродукции)
	|			И Движения.ВидЗапасов.ТипЗапасов <> ЗНАЧЕНИЕ(Перечисление.ТипыЗапасов.ПолуфабрикатДавальца)
	|			ТОГДА 
	|				Движения.СтоимостьЗабалансоваяРегл > 0
	|			ИНАЧЕ
	|				ИСТИНА
	|	КОНЕЦ
	|	И Движения.Организация <> ЗНАЧЕНИЕ(Справочник.Организации.УправленческаяОрганизация)
	|	И НЕ Движения.Сторно
	|	И НЕ Движения.ХозяйственнаяОперация В (
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеРезервовПодОбесценениеЗапасов),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВосстановлениеРезервовПодОбесценениеЗапасов),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.НачислениеРезерваПодОбесценениеЗапасов))
	|
	|СГРУППИРОВАТЬ ПО
	|	Движения.ДокументДвижения,
	|	Движения.Период,
	|	Движения.ВидДвижения,
	|	Движения.Организация,
	|	Движения.КорОрганизация,
	|	Аналитика.Номенклатура,
	|	ЕСТЬNULL(КорАналитика.Номенклатура, НЕОПРЕДЕЛЕНО),
	|	Аналитика.МестоХранения,
	|	ЕСТЬNULL(КорАналитика.МестоХранения, Аналитика.МестоХранения),
	|	ВЫБОР
	|		КОГДА НЕ Движения.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|			И Аналитика.МестоХранения ССЫЛКА Справочник.Партнеры ИЛИ Аналитика.МестоХранения ССЫЛКА Справочник.Организации
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоПродаже)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаСкладах)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			И ЕСТЬNULL(Аналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦВПроизводстве)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			И Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦПотребленныеВПроизводстве)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦНаСкладах)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦУХранителей)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеКОформлениюСписания),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиКОформлениюСписания))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦКСписанию)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			И ЕСТЬNULL(Аналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуВПроизводстве)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			И Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПотребленныеВПроизводстве)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработку)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработкуПереданныеПартнерам)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуУХранителей)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработкуКОформлениюСписания)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуКСписанию)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|			И Аналитика.МестоХранения ССЫЛКА Справочник.Партнеры ИЛИ Аналитика.МестоХранения ССЫЛКА Справочник.Организации
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыПереданныеНаКомиссию)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыНаСкладе)
	|		КОГДА ЕСТЬNULL(Аналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ)
	|			ИЛИ Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|			ИЛИ Движения.РазделУчета В (
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗатратыНаПриобретениеТМЦ)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА НЕ Движения.КорРазделУчета В (&ЗабалансовыеРазделыУчета)
	|			И КорАналитика.МестоХранения ССЫЛКА Справочник.Партнеры ИЛИ КорАналитика.МестоХранения ССЫЛКА Справочник.Организации
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоПродаже)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаСкладах)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			И ЕСТЬNULL(КорАналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦВПроизводстве)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			И КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦПотребленныеВПроизводстве)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦНаСкладах)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦУХранителей)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеКОформлениюСписания),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиКОформлениюСписания))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦКСписанию)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			И ЕСТЬNULL(КорАналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуВПроизводстве)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			И КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПотребленныеВПроизводстве)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработку)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработкуПереданныеПартнерам)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуУХранителей)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработкуКОформлениюСписания)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуКСписанию)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|			И КорАналитика.МестоХранения ССЫЛКА Справочник.Партнеры ИЛИ КорАналитика.МестоХранения ССЫЛКА Справочник.Организации
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыПереданныеНаКомиссию)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыНаСкладе)
	|		КОГДА ЕСТЬNULL(КорАналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ)
	|			ИЛИ КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|			ИЛИ Движения.КорРазделУчета В (
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗатратыНаПриобретениеТМЦ)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЕСТЬNULL(ВидыЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Аналитика.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА Аналитика.Договор.Подразделение
	|		КОГДА Движения.РазделУчета В (
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|			И (Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер)
	|				ИЛИ Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	//++ Устарело_Переработка24
	|			И (Движения.ДокументДвижения ССЫЛКА Документ.ОтчетПереработчика
	|				ИЛИ Движения.ДокументДвижения ССЫЛКА Документ.ПоступлениеОтПереработчика)
	//-- Устарело_Переработка24
	|		ТОГДА ЕСТЬNULL(ВидыЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеПереданныеПартнерам))
	|		ТОГДА ЕСТЬNULL(ВидыЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЕСТЬNULL(ЕСТЬNULL(КорВидыЗапасов.Договор.Подразделение, ВидыЗапасов.Договор.Подразделение), НЕОПРЕДЕЛЕНО)
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА ЕСТЬNULL(КорАналитика.Подразделение, Аналитика.Подразделение)
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА ЕСТЬNULL(КорАналитика.Договор.Подразделение, Аналитика.Договор.Подразделение)
	|		КОГДА Движения.КорРазделУчета В (
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|			И (КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер)
	|				ИЛИ КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	//++ Устарело_Переработка24
	|			И (Движения.ДокументДвижения ССЫЛКА Документ.ОтчетПереработчика
	|				ИЛИ Движения.ДокументДвижения ССЫЛКА Документ.ПоступлениеОтПереработчика)
	//-- Устарело_Переработка24
	|		ТОГДА ЕСТЬNULL(КорВидыЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеПереданныеПартнерам))
	|		ТОГДА ЕСТЬNULL(ЕСТЬNULL(КорВидыЗапасов.Договор.Подразделение, ВидыЗапасов.Договор.Подразделение), НЕОПРЕДЕЛЕНО)
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА ЕСТЬNULL(КорАналитика.СкладскаяТерритория.Подразделение, Аналитика.СкладскаяТерритория.Подразделение)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ,
	|
	|	ВЫБОР КОГДА Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа) ТОГДА
	|		Аналитика.Номенклатура.ГруппаФинансовогоУчета
	|	КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета ТОГДА
	|		ЕСТЬNULL(ВидыЗапасов.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка))
	|	ИНАЧЕ
	|		Аналитика.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ,
	|	ВЫБОР КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета ТОГДА
	|		ЕСТЬNULL(КорВидыЗапасов.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка))
	|	ИНАЧЕ
	|		ЕСТЬNULL(КорАналитика.Номенклатура.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка))
	|	КОНЕЦ,
	|
	|	ЕСТЬNULL(ВидыЗапасов.ТипЗапасов, ЗНАЧЕНИЕ(Перечисление.ТипыЗапасов.ПустаяСсылка)),
	|	ЕСТЬNULL(КорВидыЗапасов.ТипЗапасов, ЗНАЧЕНИЕ(Перечисление.ТипыЗапасов.ПустаяСсылка)),
	|
	|	ВЫБОР
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА Аналитика.Договор.Контрагент
	|		КОГДА ВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец) И Движения.РазделУчета <>
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ВидыЗапасов.Контрагент
	|		КОГДА Движения.АналитикаУчетаПоПартнерам <> ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПоПартнерам.ПустаяСсылка)
	|		ТОГДА Движения.АналитикаУчетаПоПартнерам.Контрагент
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер)
	|		ТОГДА Аналитика.Контрагент
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация)
	|		ТОГДА Аналитика.МестоХранения
	|		КОГДА ВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец) И Движения.РазделУчета =
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ВидыЗапасов.Контрагент
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка)
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) =
	|			ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА ЕСТЬNULL(КорАналитика.Договор.Контрагент, Аналитика.Договор.Контрагент)
	|		КОГДА ЕСТЬNULL(КорВидыЗапасов.ТипЗапасов, ВидыЗапасов.ТипЗапасов) В (&ТипыЗапасовВнешнийВладелец)
	|			И Движения.КорРазделУчета <> ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЕСТЬNULL(КорВидыЗапасов.Контрагент, ВидыЗапасов.Контрагент)
	|		КОГДА Движения.АналитикаУчетаПоПартнерам <> ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПоПартнерам.ПустаяСсылка)
	|		ТОГДА Движения.АналитикаУчетаПоПартнерам.Контрагент
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер)
	|		ТОГДА ЕСТЬNULL(КорАналитика.Контрагент, Аналитика.Контрагент)
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация)
	|		ТОГДА ЕСТЬNULL(КорАналитика.МестоХранения, Аналитика.МестоХранения)
	|		КОГДА ЕСТЬNULL(КорВидыЗапасов.ТипЗапасов, ВидыЗапасов.ТипЗапасов) В (&ТипыЗапасовВнешнийВладелец)
	|			И Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЕСТЬNULL(КорВидыЗапасов.Контрагент, ВидыЗапасов.Контрагент)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка)
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА КорВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец)
	|			И КорВидыЗапасов.Договор ССЫЛКА Справочник.ДоговорыМеждуОрганизациями
	|			И Движения.Организация = КорВидыЗапасов.Договор.ОрганизацияПолучатель
	|		ТОГДА ЕСТЬNULL(КорВидыЗапасов.Договор.ГруппаФинансовогоУчетаПолучателя, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА КорВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец)
	|		ТОГДА ЕСТЬNULL(КорВидыЗапасов.Договор.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА ВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец)
	|			И ВидыЗапасов.Договор ССЫЛКА Справочник.ДоговорыМеждуОрганизациями
	|			И Движения.Организация = ВидыЗапасов.Договор.ОрганизацияПолучатель
	|		ТОГДА ЕСТЬNULL(ВидыЗапасов.Договор.ГруппаФинансовогоУчетаПолучателя, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА ВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец)
	|		ТОГДА ЕСТЬNULL(ВидыЗапасов.Договор.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику))
	|		ТОГДА ЕСТЬNULL(Аналитика.Договор.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА Движения.АналитикаУчетаПоПартнерам <> ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПоПартнерам.ПустаяСсылка)
	|			И Движения.АналитикаУчетаПоПартнерам.Договор ССЫЛКА Справочник.ДоговорыМеждуОрганизациями
	|			И Движения.Организация = Движения.АналитикаУчетаПоПартнерам.Договор.ОрганизацияПолучатель
	|		ТОГДА ЕСТЬNULL(Движения.АналитикаУчетаПоПартнерам.Договор.ГруппаФинансовогоУчетаПолучателя, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|		КОГДА Движения.АналитикаУчетаПоПартнерам <> ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПоПартнерам.ПустаяСсылка)
	|		ТОГДА ЕСТЬNULL(Движения.АналитикаУчетаПоПартнерам.Договор.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка)
	|	КОНЕЦ,
	|
	|	ВЫБОР
	|		КОГДА ТИПЗНАЧЕНИЯ(Движения.Партия) = ТИП(Справочник.ПартииПроизводства)
	|			ТОГДА ВЫРАЗИТЬ(Движения.Партия КАК Справочник.ПартииПроизводства).НаправлениеДеятельности
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|			И Движения.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|			ТОГДА ЕСТЬNULL(Назначения.НаправлениеДеятельности, Аналитика.Договор.НаправлениеДеятельности)
	|		ИНАЧЕ ЕСТЬNULL(Назначения.НаправлениеДеятельности, ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка))
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ТИПЗНАЧЕНИЯ(Движения.КорПартия) = ТИП(Справочник.ПартииПроизводства)
	|			ТОГДА ВЫРАЗИТЬ(Движения.КорПартия КАК Справочник.ПартииПроизводства).НаправлениеДеятельности
	|		КОГДА КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|			И Движения.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|			ТОГДА ЕСТЬNULL(КорНазначения.НаправлениеДеятельности, КорАналитика.Договор.НаправлениеДеятельности)
	|		ИНАЧЕ ЕСТЬNULL(КорНазначения.НаправлениеДеятельности, Движения.КорНаправлениеДеятельности)
	|	КОНЕЦ,
	|
	|	ВЫБОР
	|		КОГДА Движения.ТипЗаписи В (ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимости),
	|				ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.КорректировкаПриобретенияПрошлогоПериода),
	|				ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.РаспределениеПоВыбывшимТоварам),
	|				ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимостиНаПрочиеРасходы))
	|			И Движения.ХозяйственнаяОперация В (
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПеремещениеТоваровМеждуФилиалами),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПередачаНаПрочиеЦели))
	|		ТОГДА Движения.ТипЗаписи
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ,
	|
	|	Движения.АналитикаРасходов,
	|	Движения.РазделУчета,
	|	Движения.КорРазделУчета,
	|	Движения.Подразделение,
	|	Движения.СтатьяРасходовСписания,
	|	Движения.АналитикаДоходов,
	|	Движения.СтатьяДоходов,
	|	Движения.АналитикаАктивовПассивов,
	|	Движения.СтатьяАктивовПассивов,
	|	Движения.НастройкаСчетовУчета,
	|	Движения.ХозяйственнаяОперация,
	|	ВЫБОР
	|		КОГДА Движения.ИдентификаторСтроки = ""ВО"" ТОГДА """"
	|		ИНАЧЕ Движения.ИдентификаторСтроки КОНЕЦ,
	|	Движения.ПериодПродажи,
	|	ВЫБОР
	|		КОГДА Движения.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		КОГДА &ПартионныйУчетВерсии22 И Движения.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ)
	|			И ТИПЗНАЧЕНИЯ(Движения.АналитикаФинансовогоУчета) = ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|			ТОГДА Движения.АналитикаФинансовогоУчета
	|		КОГДА НЕ &АналитическийУчетПоГруппамПродукции
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		КОГДА НЕ Движения.ГруппаПродукции = ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		 И НЕ ТИПЗНАЧЕНИЯ(Движения.Регистратор) В (&ТипыДокументовПроизводства22)
	|		 И НЕ Движения.ХозяйственнаяОперация В (
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПередачаПродукцииИзКладовой),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПередачаПродукцииИзПроизводства),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзПроизводства),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзКладовой))
	|			ТОГДА Движения.ГруппаПродукции
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА Движения.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		КОГДА &ПартионныйУчетВерсии22 И Движения.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ)
	|			И ТИПЗНАЧЕНИЯ(Движения.КорАналитикаФинансовогоУчета) = ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|			ТОГДА Движения.КорАналитикаФинансовогоУчета
	|		КОГДА НЕ &АналитическийУчетПоГруппамПродукции
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		КОГДА НЕ Движения.ГруппаПродукции = ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|		 И НЕ ТИПЗНАЧЕНИЯ(Движения.Регистратор) В (&ТипыДокументовПроизводства22)
	|		 И НЕ Движения.ХозяйственнаяОперация В (
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПередачаПродукцииИзКладовой),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПередачаПродукцииИзПроизводства),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзПроизводства),
	|				ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратМатериаловИзКладовой))
	|			ТОГДА Движения.ГруппаПродукции
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|	КОНЕЦ,
	|
	|	ВЫБОР
	|		КОГДА Движения.ВидЗапасов = ЗНАЧЕНИЕ(Справочник.ВидыЗапасов.ПустаяСсылка)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Работы)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.МатериальныеЗатраты)
	|	КОНЕЦ,
	|	ЕСТЬNULL(Аналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|	ИЛИ Движения.РазделУчета В (
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство)),
	|	ЕСТЬNULL(КорАналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ КорАналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|	ИЛИ Движения.КорРазделУчета В (
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство)),
	|	Аналитика.Номенклатура.ТипНоменклатуры,
	|	ЕСТЬNULL(КорАналитика.Номенклатура.ТипНоменклатуры, НЕОПРЕДЕЛЕНО),
	|	ВЫБОР
	|		КОГДА &ИспользоватьПартионныйУчет И НЕ (&ПартионныйУчетВерсии22 И Движения.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ))
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ПустаяСсылка)
	|		ИНАЧЕ Движения.НастройкаХозяйственнойОперации
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА &ИспользоватьПартионныйУчет И НЕ (&ПартионныйУчетВерсии22 И Движения.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ))
	|			ТОГДА """"
	|		ИНАЧЕ Движения.ИдентификаторФинЗаписи 
	|	КОНЕЦ
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка,
	|	Номенклатура,
	|	Склад,
	|	ГруппаФинансовогоУчета,
	|	ТипЗапасов,
	|	Контрагент
	|;
	|/////////////////////////////////////////////////////////////////////////////
	|";
#КонецОбласти
	
	ТипыДокументовПроизводства22 = Новый Массив;
	ТипыДокументовПроизводства22.Добавить("ТИП(Документ.ДвижениеПродукцииИМатериалов)");
	ТипыДокументовПроизводства22.Добавить("ТИП(Документ.ПроизводствоБезЗаказа)");
	//++ НЕ УТКА
	ТипыДокументовПроизводства22.Добавить("ТИП(Документ.ЭтапПроизводства2_2)");
	//-- НЕ УТКА
	ТекстСебестоимость = СтрЗаменить(ТекстСебестоимость, "&ТипыДокументовПроизводства22", СтрСоединить(ТипыДокументовПроизводства22, ","));
	
	ТипыДокументовСВключениемНДСВСебестоимость = Новый Массив;
	ТипыДокументовСВключениемНДСВСебестоимость.Добавить("ТИП(Документ.ПриобретениеТоваровУслуг)");
	ТипыДокументовСВключениемНДСВСебестоимость.Добавить("ТИП(Документ.КорректировкаПриобретения)");
	ТипыДокументовСВключениемНДСВСебестоимость.Добавить("ТИП(Документ.ПередачаТоваровМеждуОрганизациями)");
	//++ НЕ УТКА
	ТипыДокументовСВключениемНДСВСебестоимость.Добавить("ТИП(Документ.ОтчетДавальцуМеждуОрганизациями)");
	//-- НЕ УТКА
	ТипыДокументовСВключениемНДСВСебестоимость.Добавить("ТИП(Документ.ОтчетПереработчика2_5)");
	ТипыДокументовСВключениемНДСВСебестоимость.Добавить("ТИП(Документ.ВыкупПринятыхНаХранениеТоваров)");
	ТипыДокументовСВключениемНДСВСебестоимость.Добавить("ТИП(Документ.ТаможеннаяДекларацияИмпорт)");
	ТипыДокументовСВключениемНДСВСебестоимость.Добавить("ТИП(Документ.ЗаявлениеОВвозеТоваров)");
	ТекстСебестоимость = СтрЗаменить(ТекстСебестоимость, "&ТипыДокументовСВключениемНДСВСебестоимость", СтрСоединить(ТипыДокументовСВключениемНДСВСебестоимость, ","));
	
	Возврат ТекстСебестоимость;
	
КонецФункции

Функция ТекстПартии() Экспорт
	
	МассивПакетовЗапросов = Новый Массив;
	
	#Область Партии_Предварительная
	МассивЗапросаПартий = Новый Массив;
	
	#Область ПартииТоваровОрганизаций
	ТекстЗапроса = "
		|ВЫБРАТЬ
		|	Партии.Регистратор КАК Ссылка,
		|	Партии.Период КАК Период,
		|	Партии.Организация КАК Организация,
		|	Партии.НДСРегл КАК НДСРегл,
		|	0 КАК НДСУпр,
		|	ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.Товары) КАК ВидЦенности,
		|	Партии.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
		|	Партии.КорАналитикаУчетаНоменклатуры КАК КорАналитикаУчетаНоменклатуры,
		|	Партии.ДокументПоступления КАК ДокументПоступления,
		|	Партии.АналитикаУчетаПартий КАК АналитикаУчетаПартий,
		|	ВЫБОР 
		|		КОГДА Партии.АналитикаУчетаПартий.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортНесырьевыхТоваров)
		|				И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) < &ДатаНачалаДействия150ФЗ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНаЭкспорт) 
		|		КОГДА Партии.АналитикаУчетаПартий.НалогообложениеНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		ИНАЧЕ
		|			Партии.АналитикаУчетаПартий.НалогообложениеНДС 
		|	КОНЕЦ КАК НалогообложениеПартии,
		|	Партии.ВидЗапасов КАК ВидЗапасов,
		|	Партии.КорВидЗапасов КАК КорВидЗапасов,
		|	Партии.КорВидЗапасов.ГруппаПродукции КАК ГруппаПродукции,
		|	Партии.КорВидЗапасов.ГруппаПродукции КАК КорГруппаПродукции,
		|	ВЫБОР 
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортНесырьевыхТоваров)
		|				И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) < &ДатаНачалаДействия150ФЗ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНаЭкспорт) 
		|		КОГДА Партии.НалогообложениеНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.РеализацияРаботУслугНаЭкспорт)
		|		 И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) >= &ДатаВозможностиВычетаПриОказанииУслугНеВРФ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС)
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.РеализацияРаботУслугНаЭкспорт)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДСВСтранеЕАЭС)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС)
		|		ИНАЧЕ
		|			Партии.НалогообложениеНДС 
		|	КОНЕЦ КАК НалогообложениеНДС,
		|	Партии.СтатьяРасходовСписания КАК СтатьяРасходов,
		|	Партии.АналитикаРасходов КАК АналитикаРасходов,
		|	Партии.АналитикаАктивовПассивов КАК АналитикаАктивовПассивов,
		|	НЕОПРЕДЕЛЕНО КАК ДокументРеализации,
		|	Партии.СтатьяСписанияНДС КАК СтатьяСписанияНДС,
		|	Партии.АналитикаСписанияНДС КАК АналитикаСписанияНДС,
		|	NULL КАК ПодразделениеРасходов,
		|	ВЫБОР 
		|		КОГДА ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) >= &ДатаНачалаУчетаНДСПоНаправлениямДеятельности
		|			ТОГДА Партии.АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности
		|		КОГДА Партии.АналитикаУчетаПартий.НалогообложениеНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА Партии.АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности
		|		ИНАЧЕ
		|			ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
		|	КОНЕЦ КАК НаправлениеДеятельности,
		|	ВЫБОР 
		|		КОГДА ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) >= &ДатаНачалаУчетаНДСПоНаправлениямДеятельности
		|			ТОГДА Партии.КорАналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности
		|		КОГДА Партии.НалогообложениеНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА Партии.КорАналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности
		|		ИНАЧЕ
		|			ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
		|	КОНЕЦ КАК КорНаправлениеДеятельности,
		|	NULL КАК ИдентификаторСтроки,
		|	ЛОЖЬ КАК ЭтоРабота,
		|	NULL КАК РазделУчета,
		|	NULL КАК КорРазделУчета
		|	
		|ПОМЕСТИТЬ Партии_Предварительная
		|ИЗ
		|	ДокументыКОтражению КАК ДокументыКОтражению
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
		|		РегистрНакопления.ПартииТоваровОрганизаций КАК Партии
		|	ПО
		|		Партии.Регистратор = ДокументыКОтражению.Ссылка
		|	ЛЕВОЕ СОЕДИНЕНИЕ 
		|		РегистрСведений.ДанныеПервичныхДокументов КАК ДанныеПервичныхДокументов
		|	ПО
		|		ДанныеПервичныхДокументов.Организация = Партии.Организация
		|		И ДанныеПервичныхДокументов.Документ = Партии.ДокументПоступления
		|ГДЕ
		|	Партии.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
		|	И Партии.НДСРегл <> 0
		|	И Партии.ВидЗапасов.ТипЗапасов = ЗНАЧЕНИЕ(Перечисление.ТипыЗапасов.Товар)
		|	И Партии.Активность";
	МассивЗапросаПартий.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ПартииЗатратНаВыпуск
	ТекстЗапроса =
		"ВЫБРАТЬ
		|	Партии.Регистратор КАК Ссылка,
		|	Партии.Период КАК Период,
		|	Партии.Организация КАК Организация,
		|	Партии.НДСРегл КАК НДСРегл,
		|	0 КАК НДСУпр,
		|	ВЫБОР КОГДА Партии.АналитикаУчетаНоменклатуры.Номенклатура.ТипНоменклатуры В (
		|					ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Товар),
		|						ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.МногооборотнаяТара))
		|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.Товары) 
		|			ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.ПрочиеРаботыИУслуги) 
		|	КОНЕЦ КАК ВидЦенности,
		|	Партии.АналитикаУчетаПродукции КАК АналитикаУчетаНоменклатуры,
		|	Партии.КорАналитикаУчетаПродукции КАК КорАналитикаУчетаНоменклатуры,
		|	Партии.ДокументПоступления КАК ДокументПоступления,
		|	Партии.АналитикаУчетаПартий КАК АналитикаУчетаПартий,
		|	ВЫБОР 
		|		КОГДА Партии.АналитикаУчетаПартий.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортНесырьевыхТоваров)
		|				И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) < &ДатаНачалаДействия150ФЗ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНаЭкспорт) 
		|		КОГДА Партии.АналитикаУчетаПартий.НалогообложениеНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		ИНАЧЕ
		|			Партии.АналитикаУчетаПартий.НалогообложениеНДС 
		|	КОНЕЦ КАК НалогообложениеПартии,
		|	Партии.КорВидЗапасов КАК ВидЗапасов,
		|	Партии.КорВидЗапасов КАК КорВидЗапасов,
		|	Партии.КорВидЗапасов.ГруппаПродукции КАК ГруппаПродукции,
		|	Партии.КорВидЗапасов.ГруппаПродукции КАК КорГруппаПродукции,
		|	ВЫБОР 
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортНесырьевыхТоваров)
		|				И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) < &ДатаНачалаДействия150ФЗ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНаЭкспорт) 
		|		КОГДА Партии.НалогообложениеНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.РеализацияРаботУслугНаЭкспорт)
		|		 И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) >= &ДатаВозможностиВычетаПриОказанииУслугНеВРФ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС)
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.РеализацияРаботУслугНаЭкспорт)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДСВСтранеЕАЭС)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС)
		|		ИНАЧЕ
		|			Партии.НалогообложениеНДС 
		|	КОНЕЦ КАК НалогообложениеНДС,
		|	Партии.СтатьяРасходовСписания КАК СтатьяРасходов,
		|	Партии.АналитикаРасходов КАК АналитикаРасходов,
		|	Партии.АналитикаАктивовПассивов КАК АналитикаАктивовПассивов,
		|	НЕОПРЕДЕЛЕНО КАК ДокументРеализации,
		|	Партии.СтатьяСписанияНДС КАК СтатьяСписанияНДС,
		|	Партии.АналитикаСписанияНДС КАК АналитикаСписанияНДС,
		|	NULL КАК ПодразделениеРасходов,
		|	ВЫБОР 
		|		КОГДА ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) >= &ДатаНачалаУчетаНДСПоНаправлениямДеятельности
		|			ТОГДА Партии.АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности
		|		КОГДА Партии.АналитикаУчетаПартий.НалогообложениеНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА Партии.АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности
		|		ИНАЧЕ
		|			ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
		|	КОНЕЦ КАК НаправлениеДеятельности,
		|	ВЫБОР 
		|		КОГДА ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) >= &ДатаНачалаУчетаНДСПоНаправлениямДеятельности
		|			ТОГДА Партии.АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности
		|		КОГДА Партии.НалогообложениеНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА Партии.АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности
		|		ИНАЧЕ
		|			ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
		|	КОНЕЦ КАК КорНаправлениеДеятельности,
		|	Партии.ИдентификаторСтроки КАК ИдентификаторСтроки,
		|	(ВЫБОР
		|		КОГДА Партии.АналитикаУчетаНоменклатуры.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа) ТОГДА ИСТИНА
		|		ИНАЧЕ ЛОЖЬ КОНЕЦ) КАК ЭтоРабота,
		|	NULL КАК РазделУчета,
		|	NULL КАК КорРазделУчета
		|ИЗ
		|	ДокументыКОтражению КАК ДокументыКОтражению
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
		|		РегистрНакопления.ПартииЗатратНаВыпуск КАК Партии
		|	ПО
		|		Партии.Регистратор = ДокументыКОтражению.Ссылка
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ 
		|		РегистрСведений.ДанныеПервичныхДокументов КАК ДанныеПервичныхДокументов
		|	ПО
		|		ДанныеПервичныхДокументов.Организация = Партии.Организация
		|		И ДанныеПервичныхДокументов.Документ = Партии.ДокументПоступления
		|ГДЕ
		|	Партии.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
		|	И Партии.НДСРегл <> 0
		|	И Партии.Активность";
	МассивЗапросаПартий.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ПартииРасходовНаСебестоимостьТоваров
	ТекстЗапроса =
		"ВЫБРАТЬ
		|	Партии.Регистратор КАК Ссылка,
		|	Партии.Период КАК Период,
		|	Партии.Организация КАК Организация,
		|	Партии.НДСРегл КАК НДСРегл,
		|	0 КАК НДСУпр,
		|	ВЫБОР 
		|		КОГДА НЕ СтатьиРасходов.Ссылка ЕСТЬ NULL 
		|			ТОГДА СтатьиРасходов.ВидЦенностиНДС
		|		КОГДА Партии.АналитикаУчетаНоменклатуры.Номенклатура.ТипНоменклатуры В (
		|					ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Товар),
		|						ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.МногооборотнаяТара))
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.Товары)
		|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.ПрочиеРаботыИУслуги)
		|	КОНЕЦ КАК ВидЦенности,
		|	Партии.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
		|	Партии.КорАналитикаУчетаНоменклатуры КАК КорАналитикаУчетаНоменклатуры,
		|	Партии.ДокументПоступленияРасходов КАК ДокументПоступления,
		|	Партии.АналитикаУчетаПартий КАК АналитикаУчетаПартий,
		|	ВЫБОР 
		|		КОГДА Партии.АналитикаУчетаПартий.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортНесырьевыхТоваров)
		|				И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) < &ДатаНачалаДействия150ФЗ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНаЭкспорт) 
		|		КОГДА Партии.АналитикаУчетаПартий.НалогообложениеНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		ИНАЧЕ
		|			Партии.АналитикаУчетаПартий.НалогообложениеНДС 
		|	КОНЕЦ КАК НалогообложениеПартии,
		|	Партии.ВидЗапасов КАК ВидЗапасов,
		|	Партии.ВидЗапасов КАК КорВидЗапасов,
		|	Партии.ВидЗапасов.ГруппаПродукции КАК ГруппаПродукции,
		|	Партии.ВидЗапасов.ГруппаПродукции КАК КорГруппаПродукции,
		|	ВЫБОР 
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортНесырьевыхТоваров)
		|				И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) < &ДатаНачалаДействия150ФЗ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНаЭкспорт) 
		|		КОГДА Партии.НалогообложениеНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.РеализацияРаботУслугНаЭкспорт)
		|		 И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) >= &ДатаВозможностиВычетаПриОказанииУслугНеВРФ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС)
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.РеализацияРаботУслугНаЭкспорт)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДСВСтранеЕАЭС)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС)
		|		ИНАЧЕ
		|			Партии.НалогообложениеНДС 
		|	КОНЕЦ КАК НалогообложениеНДС,
		|	Партии.СтатьяРасходовСписания КАК СтатьяРасходов,
		|	Партии.АналитикаРасходов КАК АналитикаРасходов,
		|	Партии.АналитикаАктивовПассивов КАК АналитикаАктивовПассивов,
		|	НЕОПРЕДЕЛЕНО КАК ДокументРеализации,
		|	Партии.СтатьяСписанияНДС КАК СтатьяСписанияНДС,
		|	Партии.АналитикаСписанияНДС КАК АналитикаСписанияНДС,
		|	NULL КАК ПодразделениеРасходов,
		|	ВЫБОР 
		|		КОГДА ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) >= &ДатаНачалаУчетаНДСПоНаправлениямДеятельности
		|			ТОГДА Партии.АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности
		|		КОГДА Партии.АналитикаУчетаПартий.НалогообложениеНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА Партии.АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности
		|		ИНАЧЕ
		|			ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
		|	КОНЕЦ КАК НаправлениеДеятельности,
		|	ВЫБОР 
		|		КОГДА ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) >= &ДатаНачалаУчетаНДСПоНаправлениямДеятельности
		|			ТОГДА Партии.КорАналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности
		|		КОГДА Партии.НалогообложениеНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА Партии.КорАналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности
		|		ИНАЧЕ
		|			ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
		|	КОНЕЦ КАК КорНаправлениеДеятельности,
		|	NULL КАК ИдентификаторСтроки,
		|	ЛОЖЬ КАК ЭтоРабота,
		|	NULL КАК РазделУчета,
		|	NULL КАК КорРазделУчета
		|ИЗ
		|	ДокументыКОтражению КАК ДокументыКОтражению
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
		|		РегистрНакопления.ПартииРасходовНаСебестоимостьТоваров КАК Партии
		|	ПО
		|		Партии.Регистратор = ДокументыКОтражению.Ссылка
		|		
		|	ЛЕВОЕ СОЕДИНЕНИЕ 
		|		ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиРасходов
		|	ПО 
		|		Партии.СтатьяРасходов = СтатьиРасходов.Ссылка
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ 
		|		РегистрСведений.ДанныеПервичныхДокументов КАК ДанныеПервичныхДокументов
		|	ПО
		|		ДанныеПервичныхДокументов.Организация = Партии.Организация
		|		И ДанныеПервичныхДокументов.Документ = Партии.ДокументПоступленияРасходов
		|ГДЕ
		|	Партии.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
		|	И Партии.НДСРегл <> 0
		|	И Партии.Активность";
	МассивЗапросаПартий.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ПартииПрочихРасходов
	ТекстЗапроса =
		"ВЫБРАТЬ
		|	Партии.Регистратор КАК Ссылка,
		|	Партии.Период КАК Период,
		|	Партии.Организация КАК Организация,
		|	Партии.НДСРегл КАК НДСРегл,
		|	Партии.НДСУпр КАК НДСУпр,
		|	ВЫБОР
		|		КОГДА Партии.АналитикаУчетаПартий.ВидЦенности <> ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.ПустаяСсылка)
		|			ТОГДА Партии.АналитикаУчетаПартий.ВидЦенности        // Версия ПартионногоУчета 2.2
		|		КОГДА НЕ Партии.АналитикаУчетаНоменклатуры.Номенклатура.ТипНоменклатуры ЕСТЬ NULL ТОГДА
		|			ВЫБОР 
		|				КОГДА Партии.АналитикаУчетаНоменклатуры.Номенклатура.ТипНоменклатуры В (
		|							ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Товар),
		|							ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.МногооборотнаяТара))
		|					ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.Товары)
		|				ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.ПрочиеРаботыИУслуги)
		|			КОНЕЦ
		|		КОГДА НЕ СтатьиРасходов.Ссылка ЕСТЬ NULL
		|			ТОГДА СтатьиРасходов.ВидЦенностиНДС
		|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.ПрочиеРаботыИУслуги)
		|	КОНЕЦ КАК ВидЦенности,
		|	Партии.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
		|	NULL КАК КорАналитикаУчетаНоменклатуры,
		|	Партии.ДокументПоступленияРасходов КАК ДокументПоступления,
		|	Партии.АналитикаУчетаПартий КАК АналитикаУчетаПартий,
		|	ВЫБОР
		|		КОГДА Партии.ВидДеятельностиНДС <> ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПустаяСсылка)
		|			ТОГДА ВЫБОР
		|				КОГДА Партии.ВидДеятельностиНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортНесырьевыхТоваров)
		|				И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1, 1, 1)) < &ДатаНачалаДействия150ФЗ
		|					ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНаЭкспорт)
		|				КОГДА Партии.ВидДеятельностиНДС В (&ТипыНеОблагаемыеНДС)
		|					ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|				ИНАЧЕ Партии.ВидДеятельностиНДС
		|			КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|			КОГДА
		|				Партии.АналитикаУчетаПартий.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортНесырьевыхТоваров)
		|			И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1, 1, 1)) < &ДатаНачалаДействия150ФЗ
		|				ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНаЭкспорт)
		|			КОГДА Партии.АналитикаУчетаПартий.НалогообложениеНДС В (&ТипыНеОблагаемыеНДС)
		|				ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|			ИНАЧЕ Партии.АналитикаУчетаПартий.НалогообложениеНДС
		|		КОНЕЦ
		|	КОНЕЦ КАК НалогообложениеПартии,
		|	NULL КАК ВидЗапасов,
		|	NULL КАК КорВидЗапасов,
		|	NULL КАК ГруппаПродукции,
		|	Партии.КорГруппаПродукции КАК КорГруппаПродукции,
		|	ВЫБОР
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортНесырьевыхТоваров)
		|		И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1, 1, 1)) < &ДатаНачалаДействия150ФЗ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНаЭкспорт)
		|		КОГДА Партии.НалогообложениеНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.РеализацияРаботУслугНаЭкспорт)
		|		И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1, 1,
		|			1)) >= &ДатаВозможностиВычетаПриОказанииУслугНеВРФ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС)
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.РеализацияРаботУслугНаЭкспорт)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДСВСтранеЕАЭС)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС)
		|		ИНАЧЕ Партии.НалогообложениеНДС
		|	КОНЕЦ КАК НалогообложениеНДС,
		|	(ВЫБОР
		|		КОГДА Партии.КорСтатьяРасходов <> ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
		|			ТОГДА Партии.КорСтатьяРасходов
		|		КОГДА Партии.СтатьяОтраженияРасходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
		|			ТОГДА Партии.СтатьяРасходов
		|		ИНАЧЕ Партии.СтатьяОтраженияРасходов
		|	КОНЕЦ) КАК СтатьяРасходов,
		|	(ВЫБОР
		|		КОГДА Партии.КорСтатьяРасходов <> ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
		|			ТОГДА Партии.КорАналитикаРасходов
		|		КОГДА Партии.СтатьяОтраженияРасходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
		|			ТОГДА Партии.АналитикаРасходов
		|		ИНАЧЕ Партии.АналитикаОтраженияРасходов
		|	КОНЕЦ) КАК АналитикаРасходов,
		|	Партии.АналитикаАктивовПассивов КАК АналитикаАктивовПассивов,
		|	Партии.ДокументРеализации КАК ДокументРеализации,
		|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка) КАК СтатьяСписанияНДС,
		|	НЕОПРЕДЕЛЕНО КАК АналитикаСписанияНДС,
		|	(ВЫБОР
		|		КОГДА Партии.КорСтатьяРасходов <> ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
		|			ТОГДА Партии.КорПодразделение
		|		ИНАЧЕ Партии.Подразделение КОНЕЦ) КАК ПодразделениеРасходов,
		|	ВЫБОР 
		|		КОГДА ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) >= &ДатаНачалаУчетаНДСПоНаправлениямДеятельности
		|			ТОГДА Партии.НаправлениеДеятельности
		|		ИНАЧЕ
		|			ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
		|	КОНЕЦ КАК НаправлениеДеятельности,
		|	(ВЫБОР
		|		КОГДА Партии.КорСтатьяРасходов <> ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
		|			ТОГДА Партии.КорНаправлениеДеятельности 		
		|		ИНАЧЕ Партии.НаправлениеДеятельности КОНЕЦ) КАК КорНаправлениеДеятельности,
		|	NULL КАК ИдентификаторСтроки,
		|	ЛОЖЬ КАК ЭтоРабота,
		|	NULL КАК РазделУчета,
		|	NULL КАК КорРазделУчета
		|ИЗ
		|	ДокументыКОтражению КАК ДокументыКОтражению
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
		|		РегистрНакопления.ПартииПрочихРасходов КАК Партии
		|	ПО
		|		Партии.Регистратор = ДокументыКОтражению.Ссылка
		|
		|	ЛЕВОЕ СОЕДИНЕНИЕ
		|		ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиРасходов
		|	ПО 
		|		Партии.СтатьяРасходов = СтатьиРасходов.Ссылка
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ 
		|		РегистрСведений.ДанныеПервичныхДокументов КАК ДанныеПервичныхДокументов
		|	ПО
		|		ДанныеПервичныхДокументов.Организация = Партии.Организация
		|		И ДанныеПервичныхДокументов.Документ = Партии.ДокументПоступленияРасходов
		|	
		|ГДЕ
		|	Партии.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
		|	И (НЕ Партии.Регистратор ССЫЛКА Документ.РаспределениеПрочихЗатрат
		|		ИЛИ Партии.СтатьяРасходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.НДСНалоговогоАгента)
		|		И Партии.КорСтатьяРасходов <> ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка))
		|	И Партии.НДСРегл <> 0
		|	И Партии.Активность
		// Для исключения движений свертки развернутого сальдо
		|		И НЕ (Партии.Регистратор ССЫЛКА Документ.РасчетСебестоимостиТоваров
		|				И Партии.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.Расчетное))
		|	И НЕ Партии.Сторно";
	МассивЗапросаПартий.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ПартииПроизводственныхЗатрат
	ТекстЗапроса =
		"ВЫБРАТЬ
		|	Партии.Регистратор КАК Ссылка,
		|	Партии.Период,
		|	Партии.Организация,
		|	Партии.НДСРегл,
		|	0 КАК НДСУпр,
		|	ВЫБОР КОГДА Партии.АналитикаУчетаНоменклатуры.Номенклатура.ТипНоменклатуры В (
		|						ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Товар),
		|						ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.МногооборотнаяТара))
		|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.Товары) 
		|			ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.ПрочиеРаботыИУслуги) 
		|	КОНЕЦ КАК ВидЦенности,
		|	Партии.АналитикаУчетаНоменклатуры,
		|	Партии.КорАналитикаУчетаНоменклатуры,
		|	Партии.ДокументПоступления,
		|	Партии.АналитикаУчетаПартий,
		|	ВЫБОР 
		|		КОГДА Партии.АналитикаУчетаПартий.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортНесырьевыхТоваров)
		|				И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) < &ДатаНачалаДействия150ФЗ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНаЭкспорт) 
		|		КОГДА Партии.АналитикаУчетаПартий.НалогообложениеНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		ИНАЧЕ
		|			Партии.АналитикаУчетаПартий.НалогообложениеНДС 
		|	КОНЕЦ КАК НалогообложениеПартии,
		|	Партии.ВидЗапасов,
		|	Партии.ВидЗапасов КАК КорВидЗапасов,
		|	Партии.ВидЗапасов.ГруппаПродукции КАК ГруппаПродукции,
		|	Партии.ВидЗапасов.ГруппаПродукции КАК КорГруппаПродукции,
		|	ВЫБОР 
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортНесырьевыхТоваров)
		|				И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) < &ДатаНачалаДействия150ФЗ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНаЭкспорт) 
		|		КОГДА Партии.НалогообложениеНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.РеализацияРаботУслугНаЭкспорт)
		|		 И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) >= &ДатаВозможностиВычетаПриОказанииУслугНеВРФ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС)
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.РеализацияРаботУслугНаЭкспорт)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДСВСтранеЕАЭС)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС)
		|		ИНАЧЕ
		|			Партии.НалогообложениеНДС 
		|	КОНЕЦ КАК НалогообложениеНДС,
		|	Партии.СтатьяРасходовСписания КАК СтатьяРасходов,
		|	Партии.АналитикаРасходов,
		|	НЕОПРЕДЕЛЕНО КАК АналитикаАктивовПассивов,
		|	НЕОПРЕДЕЛЕНО КАК ДокументРеализации,
		|	Партии.СтатьяСписанияНДС КАК СтатьяСписанияНДС,
		|	Партии.АналитикаСписанияНДС КАК АналитикаСписанияНДС,
		|	NULL КАК ПодразделениеРасходов,
		|	ВЫБОР 
		|		КОГДА ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) >= &ДатаНачалаУчетаНДСПоНаправлениямДеятельности
		|			ТОГДА Партии.АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности
		|		КОГДА Партии.АналитикаУчетаПартий.НалогообложениеНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА Партии.АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности
		|		ИНАЧЕ
		|			ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
		|	КОНЕЦ КАК НаправлениеДеятельности,
		|	ВЫБОР 
		|		КОГДА ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) >= &ДатаНачалаУчетаНДСПоНаправлениямДеятельности
		|			ТОГДА Партии.КорАналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности
		|		КОГДА Партии.НалогообложениеНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА Партии.КорАналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности
		|		ИНАЧЕ
		|			ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
		|	КОНЕЦ КАК КорНаправлениеДеятельности,
		|	Партии.ИдентификаторСтроки КАК ИдентификаторСтроки,
		|	(ВЫБОР
		|		КОГДА Партии.АналитикаУчетаНоменклатуры.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа) ТОГДА ИСТИНА
		|		ИНАЧЕ ЛОЖЬ КОНЕЦ) КАК ЭтоРабота,
		|	NULL КАК РазделУчета,
		|	NULL КАК КорРазделУчета
		|ИЗ
		|	ДокументыКОтражению КАК ДокументыКОтражению
		|	
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
		|		РегистрНакопления.ПартииПроизводственныхЗатрат КАК Партии
		|	ПО
		|		Партии.Регистратор = ДокументыКОтражению.Ссылка
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ 
		|		РегистрСведений.ДанныеПервичныхДокументов КАК ДанныеПервичныхДокументов
		|	ПО
		|		ДанныеПервичныхДокументов.Организация = Партии.Организация
		|		И ДанныеПервичныхДокументов.Документ = Партии.ДокументПоступления
		|ГДЕ
		|	Партии.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
		|	И Партии.НДСРегл <> 0
		|	И Партии.Активность";
	МассивЗапросаПартий.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ПартииТоваровПереданныеНаКомиссию
	ТекстЗапроса =
		"ВЫБРАТЬ
		|	Партии.Регистратор КАК Ссылка,
		|	Партии.Период,
		|	Партии.Организация,
		|	Партии.НДСРегл,
		|	0 КАК НДСУпр,
		|	ВЫБОР КОГДА Партии.АналитикаУчетаНоменклатуры.Номенклатура.ТипНоменклатуры В (
		|						ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Товар),
		|						ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.МногооборотнаяТара))
		|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.Товары) 
		|			ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.ПрочиеРаботыИУслуги) 
		|	КОНЕЦ КАК ВидЦенности,
		|	Партии.АналитикаУчетаНоменклатуры,
		|	Партии.КорАналитикаУчетаНоменклатуры,
		|	Партии.ДокументПоступления,
		|	Партии.АналитикаУчетаПартий,
		|	ВЫБОР 
		|		КОГДА Партии.АналитикаУчетаПартий.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортНесырьевыхТоваров)
		|				И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) < &ДатаНачалаДействия150ФЗ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНаЭкспорт) 
		|		КОГДА Партии.АналитикаУчетаПартий.НалогообложениеНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		ИНАЧЕ
		|			Партии.АналитикаУчетаПартий.НалогообложениеНДС 
		|	КОНЕЦ КАК НалогообложениеПартии,
		|	Партии.ВидЗапасов,
		|	Партии.ВидЗапасов КАК КорВидЗапасов,
		|	Партии.ВидЗапасов.ГруппаПродукции КАК ГруппаПродукции,
		|	Партии.ВидЗапасов.ГруппаПродукции КАК КорГруппаПродукции,
		|	ВЫБОР 
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортНесырьевыхТоваров)
		|				И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) < &ДатаНачалаДействия150ФЗ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНаЭкспорт) 
		|		КОГДА Партии.НалогообложениеНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.РеализацияРаботУслугНаЭкспорт)
		|		 И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) >= &ДатаВозможностиВычетаПриОказанииУслугНеВРФ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС)
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.РеализацияРаботУслугНаЭкспорт)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДСВСтранеЕАЭС)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС)
		|		ИНАЧЕ
		|			Партии.НалогообложениеНДС 
		|	КОНЕЦ КАК НалогообложениеНДС,
		|	НЕОПРЕДЕЛЕНО КАК СтатьяРасходов,
		|	НЕОПРЕДЕЛЕНО КАК АналитикаРасходов,
		|	НЕОПРЕДЕЛЕНО КАК АналитикаАктивовПассивов,
		|	НЕОПРЕДЕЛЕНО КАК ДокументРеализации,
		|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка) КАК СтатьяСписанияНДС,
		|	НЕОПРЕДЕЛЕНО КАК АналитикаСписанияНДС,
		|	NULL КАК ПодразделениеРасходов,
		|	ВЫБОР 
		|		КОГДА ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) >= &ДатаНачалаУчетаНДСПоНаправлениямДеятельности
		|			ТОГДА Партии.АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности
		|		КОГДА Партии.АналитикаУчетаПартий.НалогообложениеНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА Партии.АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности
		|		ИНАЧЕ
		|			ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
		|	КОНЕЦ КАК НаправлениеДеятельности,
		|	ВЫБОР 
		|		КОГДА ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) >= &ДатаНачалаУчетаНДСПоНаправлениямДеятельности
		|			ТОГДА Партии.КорАналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности
		|		КОГДА Партии.НалогообложениеНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА Партии.КорАналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности
		|		ИНАЧЕ
		|			ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
		|	КОНЕЦ КАК КорНаправлениеДеятельности,
		|	NULL КАК ИдентификаторСтроки,
		|	(ВЫБОР
		|		КОГДА Партии.ВидЗапасов.ТипЗапасов = ЗНАЧЕНИЕ(Перечисление.ТипыЗапасов.Услуга) ТОГДА ИСТИНА
		|		ИНАЧЕ ЛОЖЬ КОНЕЦ) КАК ЭтоРабота,
		|	NULL КАК РазделУчета,
		|	NULL КАК КорРазделУчета
		|ИЗ
		|	ДокументыКОтражению КАК ДокументыКОтражению
		|	
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
		|		РегистрНакопления.ПартииТоваровПереданныеНаКомиссию КАК Партии
		|	ПО
		|		Партии.Регистратор = ДокументыКОтражению.Ссылка
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ 
		|		РегистрСведений.ДанныеПервичныхДокументов КАК ДанныеПервичныхДокументов
		|	ПО
		|		ДанныеПервичныхДокументов.Организация = Партии.Организация
		|		И ДанныеПервичныхДокументов.Документ = Партии.ДокументПоступления
		|ГДЕ
		|	Партии.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
		|	И Партии.НДСРегл <> 0
		|	И Партии.Активность";
	МассивЗапросаПартий.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ДетализацияПартийТоваровДляНДСиУСН
	ТекстЗапроса =
		"ВЫБРАТЬ
		|	Партии.Регистратор КАК Ссылка,
		|	Партии.Период,
		|	Партии.Организация,
		|	Партии.НДС КАК НДСРегл,
		|	Партии.НДСУпр КАК НДСУпр,
		|	ЕСТЬNULL(Партии.АналитикаУчетаПартий.ВидЦенности, ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.Товары)) КАК ВидЦенности,
		|	Партии.АналитикаУчетаНоменклатуры,
		|	Партии.КорАналитикаУчетаНоменклатуры,
		|	Партии.ДокументПоступления,
		|	Партии.АналитикаУчетаПартий,
		|	ВЫБОР 
		|		КОГДА ВЫБОР КОГДА Партии.Регистратор ССЫЛКА Документ.РаспределениеПрочихЗатрат ТОГДА Партии.КорВидДеятельностиНДС ИНАЧЕ Партии.ВидДеятельностиНДС КОНЕЦ = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортНесырьевыхТоваров)
		|				И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) < &ДатаНачалаДействия150ФЗ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНаЭкспорт) 
		|		КОГДА ВЫБОР КОГДА Партии.Регистратор ССЫЛКА Документ.РаспределениеПрочихЗатрат ТОГДА Партии.КорВидДеятельностиНДС ИНАЧЕ Партии.ВидДеятельностиНДС КОНЕЦ В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		ИНАЧЕ
		|			ВЫБОР КОГДА Партии.Регистратор ССЫЛКА Документ.РаспределениеПрочихЗатрат ТОГДА Партии.КорВидДеятельностиНДС ИНАЧЕ Партии.ВидДеятельностиНДС КОНЕЦ
		|	КОНЕЦ КАК НалогообложениеПартии,
		|	Партии.ВидЗапасов,
		|	Партии.КорВидЗапасов КАК КорВидЗапасов,
		|	ВЫРАЗИТЬ(Партии.АналитикаФинансовогоУчета КАК Справочник.ГруппыАналитическогоУчетаНоменклатуры) КАК ГруппаПродукции,
		|	ВЫРАЗИТЬ(Партии.КорАналитикаФинансовогоУчета КАК Справочник.ГруппыАналитическогоУчетаНоменклатуры) КАК КорГруппаПродукции,
		|	ВЫБОР 
		|		КОГДА ВЫБОР КОГДА Партии.Регистратор ССЫЛКА Документ.РаспределениеПрочихЗатрат ТОГДА Партии.ВидДеятельностиНДС ИНАЧЕ Партии.КорВидДеятельностиНДС КОНЕЦ = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортНесырьевыхТоваров)
		|				И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) < &ДатаНачалаДействия150ФЗ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНаЭкспорт) 
		|		КОГДА ВЫБОР КОГДА Партии.Регистратор ССЫЛКА Документ.РаспределениеПрочихЗатрат ТОГДА Партии.ВидДеятельностиНДС ИНАЧЕ Партии.КорВидДеятельностиНДС КОНЕЦ В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		КОГДА ВЫБОР КОГДА Партии.Регистратор ССЫЛКА Документ.РаспределениеПрочихЗатрат ТОГДА Партии.ВидДеятельностиНДС ИНАЧЕ Партии.КорВидДеятельностиНДС КОНЕЦ = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.РеализацияРаботУслугНаЭкспорт)
		|		 И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) >= &ДатаВозможностиВычетаПриОказанииУслугНеВРФ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС)
		|		КОГДА ВЫБОР КОГДА Партии.Регистратор ССЫЛКА Документ.РаспределениеПрочихЗатрат ТОГДА Партии.ВидДеятельностиНДС ИНАЧЕ Партии.КорВидДеятельностиНДС КОНЕЦ = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.РеализацияРаботУслугНаЭкспорт)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		КОГДА ВЫБОР КОГДА Партии.Регистратор ССЫЛКА Документ.РаспределениеПрочихЗатрат ТОГДА Партии.ВидДеятельностиНДС ИНАЧЕ Партии.КорВидДеятельностиНДС КОНЕЦ = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДСВСтранеЕАЭС)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС)
		|		ИНАЧЕ
		|			ВЫБОР КОГДА Партии.Регистратор ССЫЛКА Документ.РаспределениеПрочихЗатрат ТОГДА Партии.ВидДеятельностиНДС ИНАЧЕ Партии.КорВидДеятельностиНДС КОНЕЦ
		|	КОНЕЦ КАК НалогообложениеНДС,
		|	Партии.СтатьяРасходовАктивов КАК СтатьяРасходов,
		|	Партии.АналитикаРасходов,
		|	Партии.АналитикаАктивов КАК АналитикаАктивовПассивов,
		|	(ВЫБОР
		|		КОГДА Партии.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ВозвратПрошлыхПериодов)
		|			ТОГДА Партии.ДокументИсточник
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ) КАК ДокументРеализации,
		|	Партии.СтатьяСписанияНДС КАК СтатьяСписанияНДС,
		|	Партии.АналитикаСписанияНДС КАК АналитикаСписанияНДС,
		|	(ВЫБОР
		|		КОГДА Партии.ТипЗаписи В (
		|				ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.РаспределениеПоВыбывшимТоварам),
		|				ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.КорректировкаПриобретенияПрошлогоПериода))
		|			ИЛИ Партии.Регистратор ССЫЛКА Документ.РаспределениеПрочихЗатрат
		|			ТОГДА Партии.Подразделение
		|		КОГДА Партии.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПересортицаПартийТоваров)
		|			ТОГДА Партии.Подразделение
		|		ИНАЧЕ NULL КОНЕЦ) КАК ПодразделениеРасходов,
		|	ВЫБОР 
		|		КОГДА ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) >= &ДатаНачалаУчетаНДСПоНаправлениямДеятельности
		|			ТОГДА Партии.АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности
		|		КОГДА Партии.ВидДеятельностиНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА Партии.АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности
		|		ИНАЧЕ
		|			ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
		|	КОНЕЦ КАК НаправлениеДеятельности,
		|	ВЫБОР 
		|		КОГДА ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) >= &ДатаНачалаУчетаНДСПоНаправлениямДеятельности
		|		  ИЛИ Партии.КорВидДеятельностиНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА ЕСТЬNULL(ВЫБОР КОГДА ТИПЗНАЧЕНИЯ(Партии.Регистратор) = ТИП(Документ.РеализацияТоваровУслуг)
		|							ТОГДА Партии.АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности
		|							ИНАЧЕ Партии.КорАналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности
		|						   КОНЕЦ, Партии.КорНаправлениеДеятельности)
		|		ИНАЧЕ
		|			ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
		|	КОНЕЦ КАК КорНаправлениеДеятельности,
		|	NULL КАК ИдентификаторСтроки,
		|	(ВЫБОР
		|		КОГДА Партии.АналитикаУчетаНоменклатуры.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа) ТОГДА ИСТИНА
		|		ИНАЧЕ ЛОЖЬ КОНЕЦ) КАК ЭтоРабота,
		|	Партии.РазделУчета КАК РазделУчета,
		|	NULL КАК КорРазделУчета
		|ИЗ
		|	ДокументыКОтражению КАК ДокументыКОтражению
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
		|		РегистрНакопления.ДетализацияПартийТоваровДляНДСиУСН КАК Партии
		|	ПО
		|		Партии.Регистратор = ДокументыКОтражению.Ссылка
		|
		|	ЛЕВОЕ СОЕДИНЕНИЕ 
		|		РегистрСведений.ДанныеПервичныхДокументов КАК ДанныеПервичныхДокументов
		|	ПО
		|		ДанныеПервичныхДокументов.Организация = Партии.Организация
		|		И ДанныеПервичныхДокументов.Документ = Партии.ДокументПоступления
		|ГДЕ
		|	(Партии.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
		|		ИЛИ Партии.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ВозвратПрошлыхПериодов)
		|		ИЛИ Партии.Регистратор ССЫЛКА Документ.РаспределениеПрочихЗатрат)
		|	И Партии.НДС <> 0
		|	И Партии.Активность
		|	И НЕ Партии.Сторно";
	МассивЗапросаПартий.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ДетализацияПартийТоваровДляНДСиУСН2_4
	ТекстЗапроса =
		"ВЫБРАТЬ
		|	Партии.Регистратор КАК Ссылка,
		|	Партии.Период,
		|	Партии.Организация,
		|	Партии.НДС КАК НДСРегл,
		|	Партии.НДСУпр КАК НДСУпр,
		|	ЕСТЬNULL(Партии.АналитикаУчетаДокументаПоступления.ВидЦенности, ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.Товары)) КАК ВидЦенности,
		|	Партии.КорАналитикаУчетаНоменклатуры,
		|	Партии.КорАналитикаУчетаНоменклатуры,
		|	Партии.ДокументПоступления,
		|	Партии.АналитикаУчетаДокументаПоступления,
		|	ВЫБОР 
		|		КОГДА Партии.ВидДеятельностиНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортНесырьевыхТоваров)
		|				И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) < &ДатаНачалаДействия150ФЗ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНаЭкспорт) 
		|		КОГДА Партии.ВидДеятельностиНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		ИНАЧЕ
		|			Партии.ВидДеятельностиНДС 
		|	КОНЕЦ КАК НалогообложениеПартии,
		|	Партии.КорВидЗапасов КАК ВидЗапасов,
		|	Партии.КорВидЗапасов КАК КорВидЗапасов,
		|	НЕОПРЕДЕЛЕНО,
		|	НЕОПРЕДЕЛЕНО,
		|	ВЫБОР 
		|		КОГДА Партии.КорВидДеятельностиНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортНесырьевыхТоваров)
		|				И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) < &ДатаНачалаДействия150ФЗ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНаЭкспорт) 
		|		КОГДА Партии.КорВидДеятельностиНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		КОГДА Партии.КорВидДеятельностиНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.РеализацияРаботУслугНаЭкспорт)
		|		 И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) >= &ДатаВозможностиВычетаПриОказанииУслугНеВРФ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС)
		|		КОГДА Партии.КорВидДеятельностиНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.РеализацияРаботУслугНаЭкспорт)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		КОГДА Партии.КорВидДеятельностиНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДСВСтранеЕАЭС)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС)
		|		ИНАЧЕ
		|			Партии.КорВидДеятельностиНДС 
		|	КОНЕЦ КАК НалогообложениеНДС,
		|	Партии.СтатьяРасходовАктивов КАК СтатьяРасходов,
		|	Партии.АналитикаРасходов,
		|	Партии.АналитикаАктивов КАК АналитикаАктивовПассивов,
		|	(ВЫБОР
		|		КОГДА Партии.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ВозвратПрошлыхПериодов)
		|			ТОГДА Партии.ДокументИсточник
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ) КАК ДокументРеализации,
		|	Партии.СтатьяСписанияНДС КАК СтатьяСписанияНДС,
		|	Партии.АналитикаСписанияНДС КАК АналитикаСписанияНДС,
		|	(ВЫБОР
		|		КОГДА Партии.ТипЗаписи В (
		|				ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.РаспределениеПоВыбывшимТоварам),
		|				ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.КорректировкаПриобретенияПрошлогоПериода))
		|			ИЛИ Партии.Регистратор ССЫЛКА Документ.РаспределениеПрочихЗатрат
		|			ТОГДА Партии.Подразделение
		|		КОГДА Партии.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПересортицаПартийТоваров)
		|			ТОГДА Партии.Подразделение
		|		ИНАЧЕ NULL КОНЕЦ) КАК ПодразделениеРасходов,
		|	ВЫБОР 
		|		КОГДА ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) >= &ДатаНачалаУчетаНДСПоНаправлениямДеятельности
		|			ТОГДА Партии.НаправлениеДеятельности
		|		КОГДА Партии.ВидДеятельностиНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА Партии.НаправлениеДеятельности
		|		ИНАЧЕ
		|			ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
		|	КОНЕЦ КАК НаправлениеДеятельности,
		|	ВЫБОР 
		|		КОГДА ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) >= &ДатаНачалаУчетаНДСПоНаправлениямДеятельности
		|			ТОГДА Партии.КорНаправлениеДеятельности
		|		КОГДА Партии.КорВидДеятельностиНДС В (&ТипыНеОблагаемыеНДС)
		|			ТОГДА Партии.КорНаправлениеДеятельности
		|		ИНАЧЕ
		|			ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
		|	КОНЕЦ КАК КорНаправлениеДеятельности,
		|	NULL КАК ИдентификаторСтроки,
		|	ЛОЖЬ КАК ЭтоРабота,
		|	NULL КАК РазделУчета,
		|	NULL КАК КорРазделУчета
		|ИЗ
		|	ДокументыКОтражению КАК ДокументыКОтражению
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
		|		РегистрНакопления.ДетализацияПартийТоваровДляНДСиУСН2_4 КАК Партии
		|	ПО
		|		Партии.Регистратор = ДокументыКОтражению.Ссылка
		|
		|	ЛЕВОЕ СОЕДИНЕНИЕ 
		|		РегистрСведений.ДанныеПервичныхДокументов КАК ДанныеПервичныхДокументов
		|	ПО
		|		ДанныеПервичныхДокументов.Организация = Партии.Организация
		|		И ДанныеПервичныхДокументов.Документ = Партии.ДокументПоступления
		|ГДЕ
		|	(Партии.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
		|		ИЛИ Партии.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ВозвратПрошлыхПериодов)
		|		ИЛИ Партии.Регистратор ССЫЛКА Документ.РаспределениеПрочихЗатрат)
		|	И Партии.НДС <> 0
		|	И Партии.Активность
		|	И НЕ Партии.Сторно";
	МассивЗапросаПартий.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ВТСтоимостьПартийНДС
	ТекстЗапроса =
		"ВЫБРАТЬ
		|	Т.Регистратор КАК Ссылка,
		|	Т.Период,
		|	Т.Организация,
		|	Т.НДС КАК НДСРегл,
		|	Т.НДСУпр КАК НДСУпр,
		|	ЕСТЬNULL(Т.АналитикаУчетаПартийДокументаПоступления.ВидЦенности, ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.Товары)) КАК ВидЦенности,
		|	Т.АналитикаУчетаНоменклатуры,
		|	Т.КорАналитикаУчетаНоменклатуры,
		|	Т.ДокументПоступления,
		|	Т.АналитикаУчетаПартийДокументаПоступления КАК АналитикаУчетаПартий,
		|	ВЫБОР
		|		КОГДА Т.ВидДеятельностиНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортНесырьевыхТоваров) И Т.ДатаРегистратора < &ДатаНачалаДействия150ФЗ
		|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНаЭкспорт)
		|		КОГДА Т.ВидДеятельностиНДС В (&ТипыНеОблагаемыеНДС)
		|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		ИНАЧЕ Т.ВидДеятельностиНДС
		|	КОНЕЦ КАК НалогообложениеПартии,
		|	Т.ВидЗапасов КАК ВидЗапасов,
		|	Т.КорВидЗапасов КАК КорВидЗапасов,
		|	ВЫРАЗИТЬ(Т.АналитикаФинансовогоУчета КАК Справочник.ГруппыАналитическогоУчетаНоменклатуры) КАК ГруппаПродукции,
		|	ВЫРАЗИТЬ(Т.КорАналитикаФинансовогоУчета КАК Справочник.ГруппыАналитическогоУчетаНоменклатуры) КАК КорГруппаПродукции,
		|	ВЫБОР
		|		КОГДА Т.КорВидДеятельностиНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортНесырьевыхТоваров) И Т.ДатаРегистратора < &ДатаНачалаДействия150ФЗ
		|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНаЭкспорт)
		|		КОГДА Т.КорВидДеятельностиНДС В (&ТипыНеОблагаемыеНДС)
		|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		КОГДА Т.КорВидДеятельностиНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.РеализацияРаботУслугНаЭкспорт) И Т.ДатаРегистратора >= &ДатаВозможностиВычетаПриОказанииУслугНеВРФ
		|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС)
		|		КОГДА Т.КорВидДеятельностиНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.РеализацияРаботУслугНаЭкспорт)
		|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		КОГДА Т.КорВидДеятельностиНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДСВСтранеЕАЭС)
		|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС)
		|		ИНАЧЕ Т.КорВидДеятельностиНДС
		|	КОНЕЦ КАК НалогообложениеНДС,
		|	ВЫБОР
		|		КОГДА Т.СтатьяРасходовСписания = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
		|			И Т.СтатьяАктивовПассивов <> ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.ПустаяСсылка)
		|		ТОГДА Т.СтатьяАктивовПассивов
		|		ИНАЧЕ Т.СтатьяРасходовСписания
		|	КОНЕЦ КАК СтатьяРасходов,
		|	Т.АналитикаРасходов,
		|	Т.АналитикаАктивовПассивов КАК АналитикаАктивовПассивов,
		|	ВЫБОР КОГДА Т.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ВозвратПрошлыхПериодов)
		|		ТОГДА Т.ДокументИсточник
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК ДокументРеализации,
		|	Т.СтатьяСписанияНДС КАК СтатьяСписанияНДС,
		|	Т.АналитикаСписанияНДС КАК АналитикаСписанияНДС,
		|	(ВЫБОР
		|		КОГДА Т.ТипЗаписи В (
		|				ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.РаспределениеПоВыбывшимТоварам),
		|				ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.КорректировкаПриобретенияПрошлогоПериода))
		|			ТОГДА Т.Подразделение
		|		ИНАЧЕ NULL КОНЕЦ) КАК ПодразделениеРасходов,
		|	ВЫБОР
		|		КОГДА Т.ДатаРегистратора >= &ДатаНачалаУчетаНДСПоНаправлениямДеятельности
		|		ТОГДА Т.НаправлениеДеятельности
		|		КОГДА Т.ВидДеятельностиНДС В (&ТипыНеОблагаемыеНДС)
		|		ТОГДА Т.НаправлениеДеятельности
		|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
		|	КОНЕЦ КАК НаправлениеДеятельности,
		|	ВЫБОР
		|		КОГДА Т.ДатаРегистратора >= &ДатаНачалаУчетаНДСПоНаправлениямДеятельности
		|		ТОГДА Т.КорНаправлениеДеятельности
		|		КОГДА Т.КорВидДеятельностиНДС В (&ТипыНеОблагаемыеНДС)
		|		ТОГДА Т.КорНаправлениеДеятельности
		|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
		|	КОНЕЦ КАК КорНаправлениеДеятельности,
		|	NULL КАК ИдентификаторСтроки,
		|	ЛОЖЬ КАК ЭтоРабота,
		|	Т.РазделУчета КАК РазделУчета,
		|	Т.КорРазделУчета КАК КорРазделУчета
		|ИЗ
		|	ВТСтоимостьПартийНДС КАК Т
		|ГДЕ
		|	НЕ Т.ЭтоНЗП	И НЕ Т.Сторно
		|";
	МассивЗапросаПартий.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ВТСтоимостьПартийНДС_НЗП
	ТекстЗапроса =
		"ВЫБРАТЬ
		|	Т.Регистратор КАК Ссылка,
		|	ВЫБОР КОГДА Т.ЭтоРаспределениеПрочихЗатрат
		|		ТОГДА ВЫРАЗИТЬ(Т.Регистратор КАК Документ.РаспределениеПрочихЗатрат).Дата
		|		ИНАЧЕ Т.Период
		|	КОНЕЦ КАК Период,
		|	Т.Организация,
		|	Т.НДС КАК НДСРегл,
		|	Т.НДСУпр КАК НДСУпр,
		|	ЕСТЬNULL(Т.АналитикаУчетаПартийДокументаПоступления.ВидЦенности, ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.Товары)) КАК ВидЦенности,
		|	Т.АналитикаУчетаНоменклатуры,
		|	Т.КорАналитикаУчетаНоменклатуры,
		|	Т.ДокументПоступления,
		|	Т.АналитикаУчетаПартийДокументаПоступления КАК АналитикаУчетаПартий,
		|	ВЫБОР
		|		КОГДА Т.ВидДеятельностиНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортНесырьевыхТоваров) И Т.ДатаРегистратора < &ДатаНачалаДействия150ФЗ
		|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНаЭкспорт)
		|		КОГДА Т.ВидДеятельностиНДС В (&ТипыНеОблагаемыеНДС)
		|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		ИНАЧЕ Т.ВидДеятельностиНДС
		|	КОНЕЦ КАК НалогообложениеПартии,
		|	Т.ВидЗапасов КАК ВидЗапасов,
		|	Т.КорВидЗапасов КАК КорВидЗапасов,
		|	ВЫБОР КОГДА Т.ЭтоРаспределениеПрочихЗатрат ТОГДА Т.КорГруппаПродукции ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ КАК ГруппаПродукции,
		|	ВЫБОР КОГДА Т.ЭтоРаспределениеПрочихЗатрат ТОГДА НЕОПРЕДЕЛЕНО ИНАЧЕ Т.КорГруппаПродукции КОНЕЦ КАК КорГруппаПродукции,
		|	ВЫБОР
		|		КОГДА Т.КорВидДеятельностиНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортНесырьевыхТоваров) И Т.ДатаРегистратора < &ДатаНачалаДействия150ФЗ
		|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНаЭкспорт)
		|		КОГДА Т.КорВидДеятельностиНДС В (&ТипыНеОблагаемыеНДС)
		|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		КОГДА Т.КорВидДеятельностиНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.РеализацияРаботУслугНаЭкспорт) И Т.ДатаРегистратора >= &ДатаВозможностиВычетаПриОказанииУслугНеВРФ
		|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС)
		|		КОГДА Т.КорВидДеятельностиНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.РеализацияРаботУслугНаЭкспорт)
		|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|		КОГДА Т.КорВидДеятельностиНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДСВСтранеЕАЭС)
		|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС)
		|		ИНАЧЕ Т.КорВидДеятельностиНДС
		|	КОНЕЦ КАК НалогообложениеНДС,
		|	Т.СтатьяРасходовСписания КАК СтатьяРасходов,
		|	Т.АналитикаРасходов,
		|	НЕОПРЕДЕЛЕНО КАК АналитикаАктивовПассивов,
		|	НЕОПРЕДЕЛЕНО КАК ДокументРеализации,
		|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка) КАК СтатьяСписанияНДС,
		|	НЕОПРЕДЕЛЕНО КАК АналитикаСписанияНДС,
		|	ВЫБОР КОГДА Т.ЭтоРаспределениеПрочихЗатрат
		|		ТОГДА Т.Подразделение
		|		ИНАЧЕ NULL
		|	КОНЕЦ КАК ПодразделениеРасходов,
		|	Т.КорНаправлениеДеятельности КАК НаправлениеДеятельности,
		|	Т.НаправлениеДеятельности КАК КорНаправлениеДеятельности,
		|	NULL КАК ИдентификаторСтроки,
		|	ЛОЖЬ КАК ЭтоРабота,
		|	ВЫБОР КОГДА Т.ЭтоРаспределениеПрочихЗатрат ТОГДА Т.РазделУчета ИНАЧЕ NULL КОНЕЦ КАК РазделУчета,
		|	NULL КАК КорРазделУчета
		|ИЗ
		|	ВТСтоимостьПартийНДС КАК Т
		|ГДЕ
		|	Т.ЭтоНЗП И НЕ Т.Сторно
		|
		|" + "
		|ИНДЕКСИРОВАТЬ ПО
		|	АналитикаУчетаПартий
		|";
	МассивЗапросаПартий.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	МассивПакетовЗапросов.Добавить(СтрСоединить(МассивЗапросаПартий, ОбщегоНазначенияУТ.РазделительЗапросовВОбъединении()));
	#КонецОбласти
	
	#Область Партии
	ТекстЗапроса = "
		|ВЫБРАТЬ
		|	Партии.Ссылка КАК Ссылка,
		|	Партии.Период КАК Период,
		|	Партии.Организация КАК Организация,
		|	СУММА(Партии.НДСРегл) КАК НДСРегл,
		|	СУММА(Партии.НДСУпр) КАК НДСУпр,
		|	Партии.АналитикаУчетаНоменклатуры.Номенклатура КАК Номенклатура,
		|	Партии.АналитикаУчетаНоменклатуры.Характеристика КАК Характеристика,
		|	Партии.АналитикаУчетаНоменклатуры.Серия КАК Серия,
		|
		|	Партии.КорАналитикаУчетаНоменклатуры.Номенклатура КАК КорНоменклатура,
		|
		|	ВЫБОР КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
		|	 И НЕ Партии.АналитикаУчетаНоменклатуры.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа) ТОГДА
		|		ЕСТЬNULL(ВидыЗапасов.ГруппаФинансовогоУчета, ЕСТЬNULL(Партии.АналитикаУчетаПартий.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка)))
		|	ИНАЧЕ
		|		Партии.АналитикаУчетаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
		|	КОНЕЦ КАК ГруппаФинансовогоУчета,
		|
		|	ВЫБОР КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
		|	 И НЕ Партии.КорАналитикаУчетаНоменклатуры.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа) ТОГДА
		|		КорВидыЗапасов.ГруппаФинансовогоУчета
		|	ИНАЧЕ
		|		Партии.КорАналитикаУчетаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
		|	КОНЕЦ КАК КорГруппаФинансовогоУчета,
		|	
		|	ВЫБОР ТИПЗНАЧЕНИЯ(Партии.ДокументПоступления)
		|		КОГДА ТИП(Документ.СчетФактураПолученныйНалоговыйАгент)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.ТоварыНалоговыйАгент)
		|		КОГДА ТИП(Документ.СчетФактураНалоговыйАгент) ТОГДА
		|			ВЫБОР 
		|				КОГДА ВЫРАЗИТЬ(Партии.ДокументПоступления КАК Документ.СчетФактураНалоговыйАгент).ВидАгентскогоДоговора = ЗНАЧЕНИЕ(Перечисление.ВидыАгентскихДоговоров.Аренда)
		|					ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.НалоговыйАгентАренда)
		|				КОГДА ВЫРАЗИТЬ(Партии.ДокументПоступления КАК Документ.СчетФактураНалоговыйАгент).ВидАгентскогоДоговора = ЗНАЧЕНИЕ(Перечисление.ВидыАгентскихДоговоров.РеализацияИмущества)
		|					ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.НалоговыйАгентРеализацияИмущества)
		|				КОГДА ВЫРАЗИТЬ(Партии.ДокументПоступления КАК Документ.СчетФактураНалоговыйАгент).ВидАгентскогоДоговора = ЗНАЧЕНИЕ(Перечисление.ВидыАгентскихДоговоров.НерезидентЭлектронныеУслуги)
		|					ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.НалоговыйАгентЭлектронныеУслуги)
		|				КОГДА ВЫРАЗИТЬ(Партии.ДокументПоступления КАК Документ.СчетФактураНалоговыйАгент).ВидАгентскогоДоговора = ЗНАЧЕНИЕ(Перечисление.ВидыАгентскихДоговоров.Нерезидент)
		|					ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.НалоговыйАгентИностранцы)
		|			КОНЕЦ
		|		КОГДА ТИП(Документ.ТаможеннаяДекларацияИмпорт)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.ТаможенныеПлатежи)
		|		КОГДА ТИП(Документ.ЗаявлениеОВвозеТоваров) 
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.ТаможенныйСоюз)
		|		ИНАЧЕ Партии.ВидЦенности 
		|	КОНЕЦ КАК ВидЦенности,
		|	
		|	Партии.НаправлениеДеятельности    КАК НаправлениеДеятельности,
		|	Партии.КорНаправлениеДеятельности КАК КорНаправлениеДеятельности,
		|
		|	ЕСТЬNULL(Партии.АналитикаУчетаНоменклатуры.СкладскаяТерритория,
		|		ЗНАЧЕНИЕ(Справочник.Склады.ПустаяСсылка)) КАК Склад,
		|	ЕСТЬNULL(Партии.КорАналитикаУчетаНоменклатуры.СкладскаяТерритория,
		|		ЗНАЧЕНИЕ(Справочник.Склады.ПустаяСсылка)) КАК КорСклад,
		|
		|	ВЫБОР
		|		КОГДА Партии.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
		|		ТОГДА ЕСТЬNULL(Партии.ВидЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
		|		КОГДА Партии.АналитикаУчетаНоменклатуры.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
		|		ТОГДА Партии.АналитикаУчетаНоменклатуры.МестоХранения
		|		КОГДА Партии.АналитикаУчетаНоменклатуры.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
		|		ТОГДА Партии.АналитикаУчетаНоменклатуры.Договор.Подразделение
		|		КОГДА Партии.АналитикаУчетаНоменклатуры.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
		|		ТОГДА Партии.АналитикаУчетаНоменклатуры.СкладскаяТерритория.Подразделение
		|		ИНАЧЕ Партии.АналитикаУчетаНоменклатуры.Подразделение
		|	КОНЕЦ КАК Подразделение,
		|	ВЫБОР
		|		КОГДА Партии.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
		|		ТОГДА ЕСТЬNULL(Партии.ВидЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
		|		КОГДА Партии.КорАналитикаУчетаНоменклатуры.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
		|		ТОГДА Партии.КорАналитикаУчетаНоменклатуры.МестоХранения
		|		КОГДА Партии.КорАналитикаУчетаНоменклатуры.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
		|		ТОГДА Партии.КорАналитикаУчетаНоменклатуры.Договор.Подразделение
		|		КОГДА Партии.КорАналитикаУчетаНоменклатуры.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
		|		ТОГДА Партии.КорАналитикаУчетаНоменклатуры.СкладскаяТерритория.Подразделение
		|		ИНАЧЕ Партии.КорАналитикаУчетаНоменклатуры.Подразделение
		|	КОНЕЦ КАК КорПодразделение,
		|	Партии.ДокументПоступления КАК ДокументПоступления,
		|	Партии.АналитикаУчетаПартий.Контрагент КАК Контрагент,
		|	Партии.АналитикаУчетаНоменклатуры.Договор КАК Договор,
		|	Партии.ГруппаПродукции КАК ГруппаПродукции,
		|	Партии.КорГруппаПродукции КАК КорГруппаПродукции,
		|	
		|	ВЫБОР 
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС) 
		|				И Партии.НалогообложениеПартии <> Партии.НалогообложениеНДС 
		|			ТОГДА Партии.НалогообложениеПартии
		|		КОГДА Партии.НалогообложениеПартии = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|				И Партии.НалогообложениеПартии <> Партии.НалогообложениеНДС 
		|			ТОГДА ВЫБОР КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ОблагаетсяНДСУПокупателя)
		|						ИЛИ Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ОблагаетсяНДССМежценовойРазницы)
		|					ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС)
		|				ИНАЧЕ Партии.НалогообложениеНДС
		|				КОНЕЦ
		|		ИНАЧЕ Партии.НалогообложениеПартии
		|	КОНЕЦ КАК ВидДеятельностиНДС,
		|	
		|	Партии.НалогообложениеНДС КАК НалогообложениеПартии,
		|	Партии.ДокументРеализации КАК ДокументРеализации,
		|	ВЫБОР 
		|		КОГДА Партии.СтатьяРасходов = НЕОПРЕДЕЛЕНО
		|			ТОГДА ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
		|		ИНАЧЕ Партии.СтатьяРасходов
		|	КОНЕЦ КАК СтатьяРасходов,
		|	Партии.АналитикаРасходов КАК АналитикаРасходов,
		|	Партии.АналитикаАктивовПассивов КАК АналитикаАктивовПассивов,
		|	Партии.ПодразделениеРасходов КАК ПодразделениеРасходов,
		|	Партии.ИдентификаторСтроки КАК ИдентификаторСтроки,
		|
		|	ВЫБОР 
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС) 
		|				И Партии.НалогообложениеПартии <> Партии.НалогообложениеНДС
		|				И Партии.НалогообложениеНДС <> ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПустаяСсылка)  
		|				И Партии.НалогообложениеПартии <> ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПустаяСсылка)  
		|				И Партии.СтатьяСписанияНДС = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)  
		|			ТОГДА ИСТИНА
		|		ИНАЧЕ ЛОЖЬ
		|	КОНЕЦ КАК ВключениеНДСВСтоимость,
		|
		|	ВЫБОР 
		|		КОГДА Партии.НалогообложениеПартии = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|				И Партии.НалогообложениеПартии <> Партии.НалогообложениеНДС 
		|				И Партии.НалогообложениеНДС <> ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПустаяСсылка)  
		|				И Партии.НалогообложениеПартии <> ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПустаяСсылка) 
		|				И УчетнаяПолитикаОрганизаций.Организация ЕСТЬ NULL 
		|			ТОГДА ИСТИНА
		|		ИНАЧЕ ЛОЖЬ
		|	КОНЕЦ КАК ИсключениеНДСИзСтоимости,
		|
		|	ВидыЗапасов.ТипЗапасов КАК ТипЗапасов,
		|	Партии.РазделУчета,
		|	ЕСТЬNULL(Партии.КорРазделУчета, НЕОПРЕДЕЛЕНО) КАК КорРазделУчета
		|
		|ПОМЕСТИТЬ Партии
		|ИЗ 
		|	Партии_Предварительная КАК Партии
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиРасходов
		|		ПО Партии.СтатьяРасходов = СтатьиРасходов.Ссылка
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ВидыЗапасов КАК ВидыЗапасов
		|	ПО Партии.ВидЗапасов = ВидыЗапасов.Ссылка
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ВидыЗапасов КАК КорВидыЗапасов
		|	ПО Партии.КорВидЗапасов = КорВидыЗапасов.Ссылка
		|
		|	ЛЕВОЕ СОЕДИНЕНИЕ УчетнаяПолитикаОрганизаций КАК УчетнаяПолитикаОрганизаций
		|		ПО УчетнаяПолитикаОрганизаций.Организация = Партии.Организация 
		|		И УчетнаяПолитикаОрганизаций.ОсновноеНалогообложениеНДСПриУСН = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЛьготноеНалогообложениеНДСНаУСН)
		|	
		|ГДЕ
		|	НЕ Партии.НалогообложениеПартии ЕСТЬ NULL
		|	И (ВЫБОР 
		|			КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС) 
		|					И Партии.НалогообложениеПартии <> Партии.НалогообложениеНДС
		|					И Партии.НалогообложениеНДС <> ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПустаяСсылка)
		|					И Партии.СтатьяСписанияНДС = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
		|				ТОГДА ИСТИНА
		|			ИНАЧЕ ЛОЖЬ
		|		КОНЕЦ 
		|		ИЛИ 
		|		ВЫБОР 
		|			КОГДА Партии.НалогообложениеПартии = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|					И Партии.НалогообложениеПартии <> Партии.НалогообложениеНДС 
		|					И Партии.НалогообложениеНДС <> ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПустаяСсылка)
		|				ТОГДА ИСТИНА
		|			ИНАЧЕ ЛОЖЬ
		|		КОНЕЦ)
		|
		|СГРУППИРОВАТЬ ПО
		|	Партии.Ссылка,
		|	Партии.Период,
		|	Партии.Организация,
		|	Партии.АналитикаУчетаНоменклатуры.Номенклатура,
		|	Партии.АналитикаУчетаНоменклатуры.Характеристика,
		|	Партии.АналитикаУчетаНоменклатуры.Серия,
		|	Партии.КорАналитикаУчетаНоменклатуры.Номенклатура,
		|	
		|	ВЫБОР ТИПЗНАЧЕНИЯ(Партии.ДокументПоступления)
		|		КОГДА ТИП(Документ.СчетФактураПолученныйНалоговыйАгент)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.ТоварыНалоговыйАгент)
		|		КОГДА ТИП(Документ.СчетФактураНалоговыйАгент) ТОГДА
		|			ВЫБОР 
		|				КОГДА ВЫРАЗИТЬ(Партии.ДокументПоступления КАК Документ.СчетФактураНалоговыйАгент).ВидАгентскогоДоговора = ЗНАЧЕНИЕ(Перечисление.ВидыАгентскихДоговоров.Аренда)
		|					ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.НалоговыйАгентАренда)
		|				КОГДА ВЫРАЗИТЬ(Партии.ДокументПоступления КАК Документ.СчетФактураНалоговыйАгент).ВидАгентскогоДоговора = ЗНАЧЕНИЕ(Перечисление.ВидыАгентскихДоговоров.РеализацияИмущества)
		|					ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.НалоговыйАгентРеализацияИмущества)
		|				КОГДА ВЫРАЗИТЬ(Партии.ДокументПоступления КАК Документ.СчетФактураНалоговыйАгент).ВидАгентскогоДоговора = ЗНАЧЕНИЕ(Перечисление.ВидыАгентскихДоговоров.НерезидентЭлектронныеУслуги)
		|					ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.НалоговыйАгентЭлектронныеУслуги)
		|				КОГДА ВЫРАЗИТЬ(Партии.ДокументПоступления КАК Документ.СчетФактураНалоговыйАгент).ВидАгентскогоДоговора = ЗНАЧЕНИЕ(Перечисление.ВидыАгентскихДоговоров.Нерезидент)
		|					ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.НалоговыйАгентИностранцы)
		|			КОНЕЦ
		|		КОГДА ТИП(Документ.ТаможеннаяДекларацияИмпорт)
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.ТаможенныеПлатежи)
		|		КОГДА ТИП(Документ.ЗаявлениеОВвозеТоваров) 
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.ТаможенныйСоюз)
		|		ИНАЧЕ Партии.ВидЦенности 
		|	КОНЕЦ,
		|	
		|	ВЫБОР 
		|		КОГДА Партии.КорАналитикаУчетаНоменклатуры.Номенклатура.ТипНоменклатуры В (ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Товар),
		|												    ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.МногооборотнаяТара))
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.Товары)
		|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.ПрочиеРаботыИУслуги)
		|	КОНЕЦ,
		|	ВЫБОР КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
		|	 И НЕ Партии.АналитикаУчетаНоменклатуры.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа) ТОГДА
		|		ЕСТЬNULL(ВидыЗапасов.ГруппаФинансовогоУчета, ЕСТЬNULL(Партии.АналитикаУчетаПартий.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка)))
		|	ИНАЧЕ
		|		Партии.АналитикаУчетаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
		|	КОНЕЦ,
		|	ВЫБОР КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
		|	 И НЕ Партии.КорАналитикаУчетаНоменклатуры.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа) ТОГДА
		|		КорВидыЗапасов.ГруппаФинансовогоУчета
		|	ИНАЧЕ
		|		Партии.КорАналитикаУчетаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
		|	КОНЕЦ,
		|	Партии.НаправлениеДеятельности,
		|	Партии.КорНаправлениеДеятельности,
		|	ЕСТЬNULL(Партии.АналитикаУчетаНоменклатуры.СкладскаяТерритория, ЗНАЧЕНИЕ(Справочник.Склады.ПустаяСсылка)),
		|	ЕСТЬNULL(Партии.КорАналитикаУчетаНоменклатуры.СкладскаяТерритория, ЗНАЧЕНИЕ(Справочник.Склады.ПустаяСсылка)),
		|	ВЫБОР
		|		КОГДА Партии.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
		|		ТОГДА ЕСТЬNULL(Партии.ВидЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
		|		КОГДА Партии.АналитикаУчетаНоменклатуры.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
		|		ТОГДА Партии.АналитикаУчетаНоменклатуры.МестоХранения
		|		КОГДА Партии.АналитикаУчетаНоменклатуры.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
		|		ТОГДА Партии.АналитикаУчетаНоменклатуры.Договор.Подразделение
		|		КОГДА Партии.АналитикаУчетаНоменклатуры.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
		|		ТОГДА Партии.АналитикаУчетаНоменклатуры.СкладскаяТерритория.Подразделение
		|		ИНАЧЕ Партии.АналитикаУчетаНоменклатуры.Подразделение
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА Партии.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
		|		ТОГДА ЕСТЬNULL(Партии.ВидЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
		|		КОГДА Партии.КорАналитикаУчетаНоменклатуры.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
		|		ТОГДА Партии.КорАналитикаУчетаНоменклатуры.МестоХранения
		|		КОГДА Партии.КорАналитикаУчетаНоменклатуры.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
		|		ТОГДА Партии.КорАналитикаУчетаНоменклатуры.Договор.Подразделение
		|		КОГДА Партии.КорАналитикаУчетаНоменклатуры.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
		|		ТОГДА Партии.КорАналитикаУчетаНоменклатуры.СкладскаяТерритория.Подразделение
		|		ИНАЧЕ Партии.КорАналитикаУчетаНоменклатуры.Подразделение
		|	КОНЕЦ,
		|	Партии.ДокументПоступления,
		|	Партии.АналитикаУчетаПартий.Контрагент,
		|	Партии.АналитикаУчетаНоменклатуры.Договор,
		|	Партии.ГруппаПродукции,
		|	Партии.КорГруппаПродукции,
		|	ВЫБОР КОГДА Партии.НалогообложениеПартии В (&ТипыНеОблагаемыеНДС) ТОГДА
		|		ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|	ИНАЧЕ
		|		Партии.НалогообложениеПартии
		|	КОНЕЦ,
		|	Партии.НалогообложениеНДС,
		|	Партии.ДокументРеализации,
		|	ВЫБОР 
		|		КОГДА Партии.СтатьяРасходов = НЕОПРЕДЕЛЕНО
		|			ТОГДА ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
		|		ИНАЧЕ Партии.СтатьяРасходов
		|	КОНЕЦ,
		|	Партии.АналитикаРасходов,
		|	Партии.АналитикаАктивовПассивов,
		|	Партии.ПодразделениеРасходов,
		|	Партии.ИдентификаторСтроки,
		|
		|	ВЫБОР 
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС) 
		|				И Партии.НалогообложениеПартии <> Партии.НалогообложениеНДС
		|				И Партии.НалогообложениеНДС <> ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПустаяСсылка)  
		|				И Партии.НалогообложениеПартии <> ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПустаяСсылка)  
		|				И Партии.СтатьяСписанияНДС = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
		|			ТОГДА ИСТИНА
		|		ИНАЧЕ ЛОЖЬ
		|	КОНЕЦ, 
		|	ВЫБОР 
		|		КОГДА Партии.НалогообложениеПартии = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|				И Партии.НалогообложениеПартии <> Партии.НалогообложениеНДС 
		|				И Партии.НалогообложениеНДС <> ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПустаяСсылка)  
		|				И Партии.НалогообложениеПартии <> ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПустаяСсылка) 
		|				И УчетнаяПолитикаОрганизаций.Организация ЕСТЬ NULL 
		|			ТОГДА ИСТИНА
		|		ИНАЧЕ ЛОЖЬ
		|	КОНЕЦ,
		|	
		|	ВЫБОР 
		|		КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС) 
		|				И Партии.НалогообложениеПартии <> Партии.НалогообложениеНДС 
		|			ТОГДА Партии.НалогообложениеПартии
		|		КОГДА Партии.НалогообложениеПартии = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС)
		|				И Партии.НалогообложениеПартии <> Партии.НалогообложениеНДС 
		|			ТОГДА ВЫБОР КОГДА Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ОблагаетсяНДСУПокупателя)
		|						ИЛИ Партии.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ОблагаетсяНДССМежценовойРазницы)
		|					ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС)
		|				ИНАЧЕ Партии.НалогообложениеНДС
		|				КОНЕЦ
		|		ИНАЧЕ Партии.НалогообложениеПартии
		|	КОНЕЦ,
		|
		|	ВидыЗапасов.ТипЗапасов,
		|	Партии.РазделУчета,
		|	ЕСТЬNULL(Партии.КорРазделУчета, НЕОПРЕДЕЛЕНО)
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Ссылка";
	МассивПакетовЗапросов.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область УничтожениеВременныхТаблиц
	МассивПакетовЗапросов.Добавить("УНИЧТОЖИТЬ Партии_Предварительная");
	#КонецОбласти
	
	МассивПакетовЗапросов.Добавить("");
	
	Возврат СтрСоединить(МассивПакетовЗапросов, ОбщегоНазначения.РазделительПакетаЗапросов());
	
КонецФункции

Функция ТекстВТВыручкаИСебестоимостьПродаж()
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	Строки.Регистратор КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.АналитикаУчетаПоПартнерам.Организация КАК Организация,
	|	ВЫБОР
	|		КОГДА &ИспользоватьПартионныйУчет И НЕ (&ПартионныйУчетВерсии22 И Строки.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ))
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ПустаяСсылка)
	|		ИНАЧЕ Строки.НастройкаХозяйственнойОперации
	|	КОНЕЦ КАК НастройкаХозОперации,
	|	ВЫБОР
	|		КОГДА &ИспользоватьПартионныйУчет И НЕ (&ПартионныйУчетВерсии22 И Строки.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ))
	|			ТОГДА """"
	|		ИНАЧЕ Строки.ИдентификаторФинЗаписи
	|	КОНЕЦ КАК ИдентификаторФинЗаписи,
	|	Строки.ИсточникГФУРасчетов КАК ИсточникГФУРасчетов,
	|	ВЫБОР
	|		КОГДА Строки.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяЕНВД)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ВыручкаОтПродажЕНВД)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ВыручкаОтПродаж)
	|	КОНЕЦ КАК ВидСчетаВыручки,
	|	ВЫБОР
	|		КОГДА Строки.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяЕНВД)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СебестоимостьПродажЕНВД)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СебестоимостьПродаж)
	|	КОНЕЦ КАК ВидСчетаСебестоимости,
	|
	|	ЕСТЬNULL(ВидыЗапасов.ГруппаФинансовогоУчета, СпрНоменклатуры.ГруппаФинансовогоУчета) КАК ГруппаФинансовогоУчета,
	|	Аналитика.СкладскаяТерритория КАК Склад,
	|	СпрНоменклатуры.Ссылка КАК Номенклатура,
	|	Строки.ВалютаВзаиморасчетов КАК Валюта,
	|	Строки.Подразделение КАК Подразделение,
	|	Строки.НаправлениеДеятельностиКонтрагента КАК НДВыручки,
	|	Строки.НаправлениеДеятельностиНоменклатуры КАК НДСебестоимости,
	|
	|	СУММА(Строки.Количество) КАК Количество,
	|	СУММА(Строки.СуммаВыручкиСНДСРегл) КАК СуммаРегл,
	|	СУММА(Строки.СуммаВыручки) КАК СуммаУпр,
	|	СУММА(Строки.СуммаВВалютеВзаиморасчетов) КАК Сумма,
	|	СУММА(Строки.СуммаВыручкиРегл) КАК СуммаБезНДСРегл,
	|	СУММА(Строки.СуммаВыручкиБезНДС) КАК СуммаБезНДСУпр,
	|	СУММА(Строки.СуммаБезНДСВВалютеВзаиморасчетов) КАК СуммаБезНДС
	|ПОМЕСТИТЬ ВТВыручкаИСебестоимостьПродаж
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.ВыручкаИСебестоимостьПродаж КАК Строки
	|	ПО Строки.Регистратор = ДокументыКОтражению.Ссылка
	|		И Строки.Активность
	|		И НЕ Строки.Сторно
	|		И Строки.ИдентификаторФинЗаписи <> """"
	|		И НЕ Строки.РасчетСебестоимости
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.КлючиАналитикиУчетаНоменклатуры КАК Аналитика
	|	ПО Строки.АналитикаУчетаНоменклатуры = Аналитика.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ВидыЗапасов КАК ВидыЗапасов
	|	ПО Строки.ВидЗапасов = ВидыЗапасов.Ссылка
	|		И  &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Номенклатура КАК СпрНоменклатуры
	|	ПО СпрНоменклатуры.Ссылка = Аналитика.Номенклатура
	|
	|СГРУППИРОВАТЬ ПО
	|	Строки.Регистратор,
	|	Строки.Период,
	|	Строки.АналитикаУчетаПоПартнерам.Организация,
	|	Строки.НастройкаХозяйственнойОперации,
	|	Строки.ИдентификаторФинЗаписи,
	|	Строки.ИсточникГФУРасчетов,
	|	ВЫБОР
	|		КОГДА Строки.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяЕНВД)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ВыручкаОтПродажЕНВД)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ВыручкаОтПродаж)
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА Строки.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяЕНВД)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СебестоимостьПродажЕНВД)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СебестоимостьПродаж)
	|	КОНЕЦ,
	|
	|	ЕСТЬNULL(ВидыЗапасов.ГруппаФинансовогоУчета, СпрНоменклатуры.ГруппаФинансовогоУчета),
	|	Аналитика.СкладскаяТерритория,
	|	СпрНоменклатуры.Ссылка,
	|	Строки.ВалютаВзаиморасчетов,
	|	Строки.Подразделение,
	|	Строки.НаправлениеДеятельностиКонтрагента,
	|	Строки.НаправлениеДеятельностиНоменклатуры
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка,
	|	ИдентификаторФинЗаписи,
	|	НастройкаХозОперации,
	|	ИсточникГФУРасчетов
	|;
	|/////////////////////////////////////////////////////////////////////////////
	|";
	
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстКурсыВалют()
	
	Возврат "
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	РазрезыКОтражению.ДатаОтражения КАК ДатаОтражения
		|ПОМЕСТИТЬ РазрезыКОтражениюПериоды
		|ИЗ
		|	РазрезыКОтражению КАК РазрезыКОтражению
		|ИНДЕКСИРОВАТЬ ПО
		|	ДатаОтражения
		|;
		|//////////////////////////////////////////////////
		|	
		|ВЫБРАТЬ
		|	РазрезыКОтражению.ДатаОтражения   КАК ДатаОтражения,
		|	КурсыВалют.Валюта                 КАК Валюта,
		|	МАКСИМУМ(КурсыВалют.Период)       КАК ПериодКурса
		|ПОМЕСТИТЬ ПериодыКурсовВалют
		|ИЗ
		|	РазрезыКОтражениюПериоды КАК РазрезыКОтражению
		|	
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
		|		РегистрСведений.ОтносительныеКурсыВалют КАК КурсыВалют
		|	ПО
		|		РазрезыКОтражению.ДатаОтражения >= КурсыВалют.Период
		|		И КурсыВалют.БазоваяВалюта = &ВалютаРеглУчета
		|
		|СГРУППИРОВАТЬ ПО
		|	РазрезыКОтражению.ДатаОтражения,
		|	КурсыВалют.Валюта
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Валюта,
		|	ДатаОтражения
		|;
		|
		|//////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ПериодыКурсовВалют.ДатаОтражения КАК Дата,
		|	ПериодыКурсовВалют.Валюта КАК Валюта,
		|	ВЫБОР 
		|		КОГДА КурсыВалют.Валюта ЕСТЬ NULL
		|			ТОГДА 1
		|		КОГДА КурсыВалют.КурсЗнаменатель = 0
		|			ТОГДА КурсыВалют.КурсЧислитель
		|		ИНАЧЕ КурсыВалют.КурсЧислитель / КурсыВалют.КурсЗнаменатель
		|	КОНЕЦ КАК Курс
		|ПОМЕСТИТЬ КурсыВалют
		|ИЗ
		|	ПериодыКурсовВалют КАК ПериодыКурсовВалют
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ
		|		РегистрСведений.ОтносительныеКурсыВалют КАК КурсыВалют
		|	ПО
		|		ПериодыКурсовВалют.Валюта = КурсыВалют.Валюта
		|		И ПериодыКурсовВалют.ПериодКурса = КурсыВалют.Период
		|		И КурсыВалют.БазоваяВалюта = &ВалютаРеглУчета
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Валюта,
		|	Дата
		|;
		|
		|//////////////////////////////////////////////////
		|УНИЧТОЖИТЬ ПериодыКурсовВалют
		|;
		|";
	
КонецФункции

Функция ТекстРасчетовПоНовойАрхитектуреДетально()
	
	ТекстыЗапроса = Новый Массив;
	
	#Область Клиенты
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	Расчеты.ДокументРегистратор КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	Расчеты.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
	|	Расчеты.АналитикаУчетаПоПартнерам.Организация КАК ОрганизацияАналитики,
	|	Расчеты.ИдентификаторФинЗаписи КАК ИдентификаторФинЗаписи,
	|	Расчеты.РасчетныйДокумент,
	|	ВЫБОР
	|		КОГДА Расчеты.Предоплата <> 0
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыПолученные)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами)
	|	КОНЕЦ КАК ВидСчета,
	|	
	|	Расчеты.ОбъектРасчетов КАК ОбъектРасчетов,
	|	ОбъектыРасчетов.Организация КАК Организация,
	|	ОбъектыРасчетов.Контрагент КАК Контрагент,
	|	ОбъектыРасчетов.Договор КАК Договор,
	|	ОбъектыРасчетов.Объект КАК ДокументОбъектаРасчетов,
	|	ОбъектыРасчетов.Подразделение КАК Подразделение,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	ОбъектыРасчетов.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	
	|	Расчеты.КорОбъектРасчетов КАК КорОбъектРасчетов,
	|	ЕСТЬNULL(КорОбъектыРасчетов.Организация, ОбъектыРасчетов.Организация) КАК КорОрганизация,
	|	ЕСТЬNULL(КорОбъектыРасчетов.Контрагент, ОбъектыРасчетов.Контрагент) КАК КорКонтрагент,
	|	ЕСТЬNULL(КорОбъектыРасчетов.Договор, ОбъектыРасчетов.Договор) КАК КорДоговор,
	|	ЕСТЬNULL(КорОбъектыРасчетов.Объект, ОбъектыРасчетов.Объект) КАК КорДокументОбъектаРасчетов,
	|	ЕСТЬNULL(КорОбъектыРасчетов.Подразделение, ОбъектыРасчетов.Подразделение) КАК КорПодразделение,
	|	ЕСТЬNULL(КорОбъектыРасчетов.ГруппаФинансовогоУчета, ОбъектыРасчетов.ГруппаФинансовогоУчета) КАК КорГруппаФинансовогоУчета,
	|	ЕСТЬNULL(КорОбъектыРасчетов.НаправлениеДеятельности, ОбъектыРасчетов.НаправлениеДеятельности) КАК КорНаправлениеДеятельности,
	|
	|	ВЫБОР
	|		КОГДА Расчеты.ДокументРегистратор ССЫЛКА Документ.РасчетКурсовыхРазниц
	|		ТОГДА Расчеты.ДатаВозникновения
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ДатаВозникновения,
	|	Расчеты.ДатаПлановогоПогашения КАК ДатаПлановогоПогашения,
	|	РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(Расчеты.Период, ДЕНЬ), Расчеты.ДатаПлановогоПогашения, МЕСЯЦ) >=
	|		ЕСТЬNULL(УчетнаяПолитикаОрганизаций.МесяцыДолгосрочнойЗадолженности, 999) КАК ДолгосрочнаяЗадолженность,
	|	РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(Расчеты.Период, ДЕНЬ), Расчеты.ДатаПлановогоПогашения, ДЕНЬ) КАК ДнейДоПлановогоПогашения,
	|
	|	Расчеты.Валюта,
	|	Расчеты.СтатьяДвиженияДенежныхСредств КАК СтатьяДвиженияДенежныхСредств,
	|	Расчеты.ХозяйственнаяОперация КАК ХозяйственнаяОперация,
	|	Расчеты.НастройкаХозяйственнойОперации КАК НастройкаХозОперации,
	|	Расчеты.ВидДвижения КАК ВидДвижения,
	|	ВЫБОР КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) ТОГДА -1 ИНАЧЕ 1 КОНЕЦ * Расчеты.Предоплата КАК Предоплата,
	|	ВЫБОР КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) ТОГДА -1 ИНАЧЕ 1 КОНЕЦ * Расчеты.ПредоплатаУпр КАК ПредоплатаУпр,
	|	ВЫБОР КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) ТОГДА -1 ИНАЧЕ 1 КОНЕЦ * Расчеты.ПредоплатаРегл КАК ПредоплатаРегл,
	|	ВЫБОР КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) ТОГДА -1 ИНАЧЕ 1 КОНЕЦ * Расчеты.Долг КАК Долг,
	|	ВЫБОР КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) ТОГДА -1 ИНАЧЕ 1 КОНЕЦ * Расчеты.ДолгУпр КАК ДолгУпр,
	|	ВЫБОР КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) ТОГДА -1 ИНАЧЕ 1 КОНЕЦ * Расчеты.ДолгРегл КАК ДолгРегл,
	|	Расчеты.Предоплата + Расчеты.Долг КАК Сумма,
	|	Расчеты.ПредоплатаУпр + Расчеты.ДолгУпр КАК СуммаУпр,
	|	Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл КАК СуммаРегл,
	|	0 КАК ЗалогЗаТару,
	|	0 КАК ЗалогЗаТаруРегл
	|
	|ПОМЕСТИТЬ РасчетыСКлиентамиНоваяАрхитектураДетально
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.РасчетыСКлиентамиПоСрокам КАК Расчеты
	|	ПО
	|		ДокументыКОтражению.Ссылка = Расчеты.ДокументРегистратор
	|		И НЕ Расчеты.Сторно
	|		И &НоваяАрхитектураВзаиморасчетов
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ОбъектыРасчетов КАК ОбъектыРасчетов
	|	ПО (Расчеты.ОбъектРасчетов = ОбъектыРасчетов.Ссылка)
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ОбъектыРасчетов КАК КорОбъектыРасчетов
	|	ПО (Расчеты.КорОбъектРасчетов = КорОбъектыРасчетов.Ссылка)
	|	ЛЕВОЕ СОЕДИНЕНИЕ УчетнаяПолитикаОрганизаций КАК УчетнаяПолитикаОрганизаций
	|	ПО Расчеты.ДокументРегистратор = УчетнаяПолитикаОрганизаций.Ссылка
	|		И ОбъектыРасчетов.Организация = УчетнаяПолитикаОрганизаций.Организация
	|		И НАЧАЛОПЕРИОДА(Расчеты.Период, ДЕНЬ) = УчетнаяПолитикаОрганизаций.ДатаОтражения
	|		И УчетнаяПолитикаОрганизаций.ДолгосрочныеАктивыОбязательства
	|	
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка";
	ТекстыЗапроса.Добавить(ТекстЗапроса);
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	Расчеты.Ссылка КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	Расчеты.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
	|	Расчеты.ОбъектРасчетов КАК ОбъектРасчетов,
	|	Расчеты.РасчетныйДокумент КАК РасчетныйДокумент,
	|	Расчеты.ДатаВозникновения КАК ДатаВозникновения,
	|	Расчеты.ДатаПлановогоПогашения КАК ДатаПлановогоПогашения,
	|	
	|	МАКСИМУМ(Расчеты.КорОбъектРасчетов) КАК КорОбъектРасчетов,
	|	МАКСИМУМ(Расчеты.КорОрганизация) КАК КорОрганизация,
	|	МАКСИМУМ(Расчеты.КорКонтрагент) КАК КорКонтрагент,
	|	МАКСИМУМ(Расчеты.КорДоговор) КАК КорДоговор,
	|	МАКСИМУМ(Расчеты.КорДокументОбъектаРасчетов) КАК КорДокументОбъектаРасчетов,
	|	МАКСИМУМ(Расчеты.КорПодразделение) КАК КорПодразделение,
	|	МАКСИМУМ(Расчеты.КорГруппаФинансовогоУчета) КАК КорГруппаФинансовогоУчета,
	|	МАКСИМУМ(Расчеты.КорНаправлениеДеятельности) КАК КорНаправлениеДеятельности
	|
	|ПОМЕСТИТЬ РасчетыСКлиентамиНоваяАрхитектураПереносыАвансов
	|ИЗ
	|	РасчетыСКлиентамиНоваяАрхитектураДетально КАК Расчеты
	|ГДЕ
	|	Расчеты.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПереносАванса)
	|	И Расчеты.КорОбъектРасчетов <> ЗНАЧЕНИЕ(Справочник.ОбъектыРасчетов.ПустаяСсылка)
	|
	|СГРУППИРОВАТЬ ПО
	|	Расчеты.Ссылка,
	|	Расчеты.Период,
	|	Расчеты.АналитикаУчетаПоПартнерам,
	|	Расчеты.ОбъектРасчетов,
	|	Расчеты.РасчетныйДокумент,
	|	Расчеты.ДатаВозникновения,
	|	Расчеты.ДатаПлановогоПогашения
	|	
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка";
	ТекстыЗапроса.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область Поставщики
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	Расчеты.ДокументРегистратор КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	Расчеты.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
	|	Расчеты.АналитикаУчетаПоПартнерам.Организация КАК ОрганизацияАналитики,
	|	Расчеты.ИдентификаторФинЗаписи КАК ИдентификаторФинЗаписи,
	|	Расчеты.РасчетныйДокумент,
	|	ВЫБОР
	|		КОГДА Расчеты.Предоплата <> 0
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыВыданные)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками)
	|	КОНЕЦ КАК ВидСчета,
	|	
	|	Расчеты.ОбъектРасчетов КАК ОбъектРасчетов,
	|	ОбъектыРасчетов.Организация КАК Организация,
	|	ОбъектыРасчетов.Контрагент КАК Контрагент,
	|	ОбъектыРасчетов.Договор КАК Договор,
	|	ОбъектыРасчетов.Объект КАК ДокументОбъектаРасчетов,
	|	ОбъектыРасчетов.Подразделение КАК Подразделение,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	ОбъектыРасчетов.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	
	|	Расчеты.КорОбъектРасчетов КАК КорОбъектРасчетов,
	|	ЕСТЬNULL(КорОбъектыРасчетов.Организация, ОбъектыРасчетов.Организация) КАК КорОрганизация,
	|	ЕСТЬNULL(КорОбъектыРасчетов.Контрагент, ОбъектыРасчетов.Контрагент) КАК КорКонтрагент,
	|	ЕСТЬNULL(КорОбъектыРасчетов.Договор, ОбъектыРасчетов.Договор) КАК КорДоговор,
	|	ЕСТЬNULL(КорОбъектыРасчетов.Объект, ОбъектыРасчетов.Объект) КАК КорДокументОбъектаРасчетов,
	|	ЕСТЬNULL(КорОбъектыРасчетов.Подразделение, ОбъектыРасчетов.Подразделение) КАК КорПодразделение,
	|	ЕСТЬNULL(КорОбъектыРасчетов.ГруппаФинансовогоУчета, ОбъектыРасчетов.ГруппаФинансовогоУчета) КАК КорГруппаФинансовогоУчета,
	|	ЕСТЬNULL(КорОбъектыРасчетов.НаправлениеДеятельности, ОбъектыРасчетов.НаправлениеДеятельности) КАК КорНаправлениеДеятельности,
	|
	|	ВЫБОР
	|		КОГДА Расчеты.ДокументРегистратор ССЫЛКА Документ.РасчетКурсовыхРазниц
	|		ТОГДА Расчеты.ДатаВозникновения
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ДатаВозникновения,
	|	Расчеты.ДатаПлановогоПогашения КАК ДатаПлановогоПогашения,
	|	РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(Расчеты.Период, ДЕНЬ), Расчеты.ДатаПлановогоПогашения, МЕСЯЦ) >=
	|		ЕСТЬNULL(УчетнаяПолитикаОрганизаций.МесяцыДолгосрочнойЗадолженности, 999) КАК ДолгосрочнаяЗадолженность,
	|	РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(Расчеты.Период, ДЕНЬ), Расчеты.ДатаПлановогоПогашения, ДЕНЬ) КАК ДнейДоПлановогоПогашения,
	|
	|	Расчеты.Валюта,
	|	Расчеты.СтатьяДвиженияДенежныхСредств КАК СтатьяДвиженияДенежныхСредств,
	|	Расчеты.ХозяйственнаяОперация КАК ХозяйственнаяОперация,
	|	Расчеты.НастройкаХозяйственнойОперации КАК НастройкаХозОперации,
	|	Расчеты.ВидДвижения КАК ВидДвижения,
	|	ВЫБОР КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) ТОГДА -1 ИНАЧЕ 1 КОНЕЦ * Расчеты.Предоплата КАК Предоплата,
	|	ВЫБОР КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) ТОГДА -1 ИНАЧЕ 1 КОНЕЦ * Расчеты.ПредоплатаУпр КАК ПредоплатаУпр,
	|	ВЫБОР КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) ТОГДА -1 ИНАЧЕ 1 КОНЕЦ * Расчеты.ПредоплатаРегл КАК ПредоплатаРегл,
	|	ВЫБОР КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) ТОГДА -1 ИНАЧЕ 1 КОНЕЦ * Расчеты.Долг КАК Долг,
	|	ВЫБОР КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) ТОГДА -1 ИНАЧЕ 1 КОНЕЦ * Расчеты.ДолгУпр КАК ДолгУпр,
	|	ВЫБОР КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) ТОГДА -1 ИНАЧЕ 1 КОНЕЦ * Расчеты.ДолгРегл КАК ДолгРегл,
	|	Расчеты.Предоплата + Расчеты.Долг КАК Сумма,
	|	Расчеты.ПредоплатаУпр + Расчеты.ДолгУпр КАК СуммаУпр,
	|	Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл КАК СуммаРегл
	|
	|ПОМЕСТИТЬ РасчетыСПоставщикамиНоваяАрхитектураДетально
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.РасчетыСПоставщикамиПоСрокам КАК Расчеты
	|	ПО
	|		ДокументыКОтражению.Ссылка = Расчеты.ДокументРегистратор
	|		И НЕ Расчеты.Сторно
	|		И &НоваяАрхитектураВзаиморасчетов
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ОбъектыРасчетов КАК ОбъектыРасчетов
	|	ПО (Расчеты.ОбъектРасчетов = ОбъектыРасчетов.Ссылка)
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ОбъектыРасчетов КАК КорОбъектыРасчетов
	|	ПО (Расчеты.КорОбъектРасчетов = КорОбъектыРасчетов.Ссылка)
	|	ЛЕВОЕ СОЕДИНЕНИЕ УчетнаяПолитикаОрганизаций КАК УчетнаяПолитикаОрганизаций
	|	ПО Расчеты.ДокументРегистратор = УчетнаяПолитикаОрганизаций.Ссылка
	|		И ОбъектыРасчетов.Организация = УчетнаяПолитикаОрганизаций.Организация
	|		И НАЧАЛОПЕРИОДА(Расчеты.Период, ДЕНЬ) = УчетнаяПолитикаОрганизаций.ДатаОтражения
	|		И УчетнаяПолитикаОрганизаций.ДолгосрочныеАктивыОбязательства
	|	
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка";
	ТекстыЗапроса.Добавить(ТекстЗапроса);

	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	Расчеты.Ссылка КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	Расчеты.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
	|	Расчеты.ОбъектРасчетов КАК ОбъектРасчетов,
	|	Расчеты.РасчетныйДокумент КАК РасчетныйДокумент,
	|	Расчеты.ДатаВозникновения КАК ДатаВозникновения,
	|	Расчеты.ДатаПлановогоПогашения КАК ДатаПлановогоПогашения,
	|	
	|	МАКСИМУМ(Расчеты.КорОбъектРасчетов) КАК КорОбъектРасчетов,
	|	МАКСИМУМ(Расчеты.КорОрганизация) КАК КорОрганизация,
	|	МАКСИМУМ(Расчеты.КорКонтрагент) КАК КорКонтрагент,
	|	МАКСИМУМ(Расчеты.КорДоговор) КАК КорДоговор,
	|	МАКСИМУМ(Расчеты.КорДокументОбъектаРасчетов) КАК КорДокументОбъектаРасчетов,
	|	МАКСИМУМ(Расчеты.КорПодразделение) КАК КорПодразделение,
	|	МАКСИМУМ(Расчеты.КорГруппаФинансовогоУчета) КАК КорГруппаФинансовогоУчета,
	|	МАКСИМУМ(Расчеты.КорНаправлениеДеятельности) КАК КорНаправлениеДеятельности
	|
	|ПОМЕСТИТЬ РасчетыСПоставщикамиНоваяАрхитектураПереносыАвансов
	|ИЗ
	|	РасчетыСПоставщикамиНоваяАрхитектураДетально КАК Расчеты
	|ГДЕ
	|	Расчеты.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПереносАванса)
	|	И Расчеты.КорОбъектРасчетов <> ЗНАЧЕНИЕ(Справочник.ОбъектыРасчетов.ПустаяСсылка)
	|
	|СГРУППИРОВАТЬ ПО
	|	Расчеты.Ссылка,
	|	Расчеты.Период,
	|	Расчеты.АналитикаУчетаПоПартнерам,
	|	Расчеты.ОбъектРасчетов,
	|	Расчеты.РасчетныйДокумент,
	|	Расчеты.ДатаВозникновения,
	|	Расчеты.ДатаПлановогоПогашения
	|	
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка";
	ТекстыЗапроса.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	ТекстЗапроса = СтрСоединить(ТекстыЗапроса, ОбщегоНазначения.РазделительПакетаЗапросов()) + ОбщегоНазначения.РазделительПакетаЗапросов();
	
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстРасчетовПоНовойАрхитектуре()
	
	ТекстыЗапроса = Новый Массив;
	
	#Область Клиенты
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	Расчеты.Ссылка КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	Расчеты.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
	|	Расчеты.ОрганизацияАналитики КАК ОрганизацияАналитики,
	|	Расчеты.ИдентификаторФинЗаписи КАК ИдентификаторФинЗаписи,
	|	ВЫБОР
	|		КОГДА ТИПЗНАЧЕНИЯ(Расчеты.Ссылка) В (&РасчетныеДокументыКлиенты)
	|		ТОГДА Расчеты.РасчетныйДокумент
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК РасчетныйДокумент,
	|	Расчеты.ВидСчета КАК ВидСчета,
	|	
	|	Расчеты.ОбъектРасчетов КАК ОбъектРасчетов,
	|	Расчеты.Организация КАК Организация,
	|	Расчеты.Контрагент КАК Контрагент,
	|	Расчеты.Договор КАК Договор,
	|	Расчеты.ДокументОбъектаРасчетов КАК ДокументОбъектаРасчетов,
	|	Расчеты.Подразделение КАК Подразделение,
	|	Расчеты.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	
	|	ЕСТЬNULL(ПереносыАвансов.КорОбъектРасчетов, Расчеты.КорОбъектРасчетов) КАК КорОбъектРасчетов,
	|	ЕСТЬNULL(ПереносыАвансов.КорОрганизация, Расчеты.КорОрганизация) КАК КорОрганизация,
	|	ЕСТЬNULL(ПереносыАвансов.КорКонтрагент, Расчеты.КорКонтрагент) КАК КорКонтрагент,
	|	ЕСТЬNULL(ПереносыАвансов.КорДоговор, Расчеты.КорДоговор) КАК КорДоговор,
	|	ЕСТЬNULL(ПереносыАвансов.КорДокументОбъектаРасчетов, Расчеты.КорДокументОбъектаРасчетов) КАК КорДокументОбъектаРасчетов,
	|	ЕСТЬNULL(ПереносыАвансов.КорПодразделение, Расчеты.КорПодразделение) КАК КорПодразделение,
	|	ЕСТЬNULL(ПереносыАвансов.КорГруппаФинансовогоУчета, Расчеты.КорГруппаФинансовогоУчета) КАК КорГруппаФинансовогоУчета,
	|	ЕСТЬNULL(ПереносыАвансов.КорНаправлениеДеятельности, Расчеты.КорНаправлениеДеятельности) КАК КорНаправлениеДеятельности,
	|
	|	Расчеты.ДатаВозникновения КАК ДатаВозникновения,
	|
	|	Расчеты.Валюта,
	|	Расчеты.СтатьяДвиженияДенежныхСредств КАК СтатьяДвиженияДенежныхСредств,
	|	Расчеты.ХозяйственнаяОперация КАК ХозяйственнаяОперация,
	|	Расчеты.НастройкаХозОперации КАК НастройкаХозОперации,
	|	Расчеты.ВидДвижения КАК ВидДвижения,
	|	СУММА(Расчеты.Предоплата) КАК Предоплата,
	|	СУММА(Расчеты.ПредоплатаУпр) КАК ПредоплатаУпр,
	|	СУММА(Расчеты.ПредоплатаРегл) КАК ПредоплатаРегл,
	|	СУММА(Расчеты.Долг) КАК Долг,
	|	СУММА(Расчеты.ДолгУпр) КАК ДолгУпр,
	|	СУММА(Расчеты.ДолгРегл) КАК ДолгРегл,
	|	СУММА(Расчеты.Сумма) КАК Сумма,
	|	СУММА(Расчеты.СуммаУпр) КАК СуммаУпр,
	|	СУММА(Расчеты.СуммаРегл) КАК СуммаРегл,
	|	0 КАК ЗалогЗаТару,
	|	0 КАК ЗалогЗаТаруРегл
	|
	|ПОМЕСТИТЬ РасчетыСКлиентамиНоваяАрхитектура
	|ИЗ
	|	РасчетыСКлиентамиНоваяАрхитектураДетально КАК Расчеты
	|	ЛЕВОЕ СОЕДИНЕНИЕ РасчетыСКлиентамиНоваяАрхитектураПереносыАвансов КАК ПереносыАвансов
	|	ПО Расчеты.КорОбъектРасчетов = ЗНАЧЕНИЕ(Справочник.ОбъектыРасчетов.ПустаяСсылка)
	|	И Расчеты.Ссылка = ПереносыАвансов.Ссылка
	|	И Расчеты.Период = ПереносыАвансов.Период
	|	И Расчеты.АналитикаУчетаПоПартнерам = ПереносыАвансов.АналитикаУчетаПоПартнерам
	|	И Расчеты.ОбъектРасчетов = ПереносыАвансов.ОбъектРасчетов
	|	И Расчеты.РасчетныйДокумент = ПереносыАвансов.РасчетныйДокумент
	|	И Расчеты.ДатаВозникновения = ПереносыАвансов.ДатаВозникновения
	|	И Расчеты.ДатаПлановогоПогашения = ПереносыАвансов.ДатаПлановогоПогашения
	|	
	|СГРУППИРОВАТЬ ПО
	|	Расчеты.Ссылка,
	|	Расчеты.Период,
	|	Расчеты.АналитикаУчетаПоПартнерам,
	|	Расчеты.ОрганизацияАналитики,
	|	Расчеты.ИдентификаторФинЗаписи,
	|	ВЫБОР
	|		КОГДА ТИПЗНАЧЕНИЯ(Расчеты.Ссылка) В (&РасчетныеДокументыКлиенты)
	|		ТОГДА Расчеты.РасчетныйДокумент
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ,
	|	Расчеты.ВидСчета,
	|	
	|	Расчеты.ОбъектРасчетов,
	|	Расчеты.Организация,
	|	Расчеты.Контрагент,
	|	Расчеты.Договор,
	|	Расчеты.ДокументОбъектаРасчетов,
	|	Расчеты.Подразделение,
	|	Расчеты.ГруппаФинансовогоУчета,
	|	Расчеты.НаправлениеДеятельности,
	|	
	|	ЕСТЬNULL(ПереносыАвансов.КорОбъектРасчетов, Расчеты.КорОбъектРасчетов),
	|	ЕСТЬNULL(ПереносыАвансов.КорОрганизация, Расчеты.КорОрганизация),
	|	ЕСТЬNULL(ПереносыАвансов.КорКонтрагент, Расчеты.КорКонтрагент),
	|	ЕСТЬNULL(ПереносыАвансов.КорДоговор, Расчеты.КорДоговор),
	|	ЕСТЬNULL(ПереносыАвансов.КорДокументОбъектаРасчетов, Расчеты.КорДокументОбъектаРасчетов),
	|	ЕСТЬNULL(ПереносыАвансов.КорПодразделение, Расчеты.КорПодразделение),
	|	ЕСТЬNULL(ПереносыАвансов.КорГруппаФинансовогоУчета, Расчеты.КорГруппаФинансовогоУчета),
	|	ЕСТЬNULL(ПереносыАвансов.КорНаправлениеДеятельности, Расчеты.КорНаправлениеДеятельности),
	|
	|	Расчеты.ДатаВозникновения,
	|
	|	Расчеты.Валюта,
	|	Расчеты.СтатьяДвиженияДенежныхСредств,
	|	Расчеты.ХозяйственнаяОперация,
	|	Расчеты.НастройкаХозОперации,
	|	Расчеты.ВидДвижения
	|	
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка";
	ТекстыЗапроса.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область Поставщики
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	Расчеты.Ссылка КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	Расчеты.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
	|	Расчеты.ОрганизацияАналитики КАК ОрганизацияАналитики,
	|	Расчеты.ИдентификаторФинЗаписи КАК ИдентификаторФинЗаписи,
	|	ВЫБОР
	|		КОГДА ТИПЗНАЧЕНИЯ(Расчеты.Ссылка) В (&РасчетныеДокументыПоставщики)
	|		ТОГДА Расчеты.РасчетныйДокумент
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК РасчетныйДокумент,
	|	Расчеты.ВидСчета КАК ВидСчета,
	|	
	|	Расчеты.ОбъектРасчетов КАК ОбъектРасчетов,
	|	Расчеты.Организация КАК Организация,
	|	Расчеты.Контрагент КАК Контрагент,
	|	Расчеты.Договор КАК Договор,
	|	Расчеты.ДокументОбъектаРасчетов КАК ДокументОбъектаРасчетов,
	|	Расчеты.Подразделение КАК Подразделение,
	|	Расчеты.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	
	|	ЕСТЬNULL(ПереносыАвансов.КорОбъектРасчетов, Расчеты.КорОбъектРасчетов) КАК КорОбъектРасчетов,
	|	ЕСТЬNULL(ПереносыАвансов.КорОрганизация, Расчеты.КорОрганизация) КАК КорОрганизация,
	|	ЕСТЬNULL(ПереносыАвансов.КорКонтрагент, Расчеты.КорКонтрагент) КАК КорКонтрагент,
	|	ЕСТЬNULL(ПереносыАвансов.КорДоговор, Расчеты.КорДоговор) КАК КорДоговор,
	|	ЕСТЬNULL(ПереносыАвансов.КорДокументОбъектаРасчетов, Расчеты.КорДокументОбъектаРасчетов) КАК КорДокументОбъектаРасчетов,
	|	ЕСТЬNULL(ПереносыАвансов.КорПодразделение, Расчеты.КорПодразделение) КАК КорПодразделение,
	|	ЕСТЬNULL(ПереносыАвансов.КорГруппаФинансовогоУчета, Расчеты.КорГруппаФинансовогоУчета) КАК КорГруппаФинансовогоУчета,
	|	ЕСТЬNULL(ПереносыАвансов.КорНаправлениеДеятельности, Расчеты.КорНаправлениеДеятельности) КАК КорНаправлениеДеятельности,
	|
	|	Расчеты.ДатаВозникновения КАК ДатаВозникновения,
	|
	|	Расчеты.Валюта,
	|	ВЫБОР
	|		КОГДА Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ПереносАванса)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ
	|			Расчеты.СтатьяДвиженияДенежныхСредств
	|	КОНЕЦ КАК СтатьяДвиженияДенежныхСредств,
	|	Расчеты.ХозяйственнаяОперация КАК ХозяйственнаяОперация,
	|	Расчеты.НастройкаХозОперации КАК НастройкаХозОперации,
	|	Расчеты.ВидДвижения КАК ВидДвижения,
	|	СУММА(Расчеты.Предоплата) КАК Предоплата,
	|	СУММА(Расчеты.ПредоплатаУпр) КАК ПредоплатаУпр,
	|	СУММА(Расчеты.ПредоплатаРегл) КАК ПредоплатаРегл,
	|	СУММА(Расчеты.Долг) КАК Долг,
	|	СУММА(Расчеты.ДолгУпр) КАК ДолгУпр,
	|	СУММА(Расчеты.ДолгРегл) КАК ДолгРегл,
	|	СУММА(Расчеты.Сумма) КАК Сумма,
	|	СУММА(Расчеты.СуммаУпр) КАК СуммаУпр,
	|	СУММА(Расчеты.СуммаРегл) КАК СуммаРегл
	|
	|ПОМЕСТИТЬ РасчетыСПоставщикамиНоваяАрхитектура
	|ИЗ
	|	РасчетыСПоставщикамиНоваяАрхитектураДетально КАК Расчеты
	|	ЛЕВОЕ СОЕДИНЕНИЕ РасчетыСПоставщикамиНоваяАрхитектураПереносыАвансов КАК ПереносыАвансов
	|	ПО Расчеты.КорОбъектРасчетов = ЗНАЧЕНИЕ(Справочник.ОбъектыРасчетов.ПустаяСсылка)
	|	И Расчеты.Ссылка = ПереносыАвансов.Ссылка
	|	И Расчеты.Период = ПереносыАвансов.Период
	|	И Расчеты.АналитикаУчетаПоПартнерам = ПереносыАвансов.АналитикаУчетаПоПартнерам
	|	И Расчеты.ОбъектРасчетов = ПереносыАвансов.ОбъектРасчетов
	|	И Расчеты.РасчетныйДокумент = ПереносыАвансов.РасчетныйДокумент
	|	И Расчеты.ДатаВозникновения = ПереносыАвансов.ДатаВозникновения
	|	И Расчеты.ДатаПлановогоПогашения = ПереносыАвансов.ДатаПлановогоПогашения
	|	
	|СГРУППИРОВАТЬ ПО
	|	Расчеты.Ссылка,
	|	Расчеты.Период,
	|	Расчеты.АналитикаУчетаПоПартнерам,
	|	Расчеты.ОрганизацияАналитики,
	|	Расчеты.ИдентификаторФинЗаписи,
	|	ВЫБОР
	|		КОГДА ТИПЗНАЧЕНИЯ(Расчеты.Ссылка) В (&РасчетныеДокументыПоставщики)
	|		ТОГДА Расчеты.РасчетныйДокумент
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ,
	|	Расчеты.ВидСчета,
	|	
	|	Расчеты.ОбъектРасчетов,
	|	Расчеты.Организация,
	|	Расчеты.Контрагент,
	|	Расчеты.Договор,
	|	Расчеты.ДокументОбъектаРасчетов,
	|	Расчеты.Подразделение,
	|	Расчеты.ГруппаФинансовогоУчета,
	|	Расчеты.НаправлениеДеятельности,
	|	
	|	ЕСТЬNULL(ПереносыАвансов.КорОбъектРасчетов, Расчеты.КорОбъектРасчетов),
	|	ЕСТЬNULL(ПереносыАвансов.КорОрганизация, Расчеты.КорОрганизация),
	|	ЕСТЬNULL(ПереносыАвансов.КорКонтрагент, Расчеты.КорКонтрагент),
	|	ЕСТЬNULL(ПереносыАвансов.КорДоговор, Расчеты.КорДоговор),
	|	ЕСТЬNULL(ПереносыАвансов.КорДокументОбъектаРасчетов, Расчеты.КорДокументОбъектаРасчетов),
	|	ЕСТЬNULL(ПереносыАвансов.КорПодразделение, Расчеты.КорПодразделение),
	|	ЕСТЬNULL(ПереносыАвансов.КорГруппаФинансовогоУчета, Расчеты.КорГруппаФинансовогоУчета),
	|	ЕСТЬNULL(ПереносыАвансов.КорНаправлениеДеятельности, Расчеты.КорНаправлениеДеятельности),
	|
	|	Расчеты.ДатаВозникновения,
	|
	|	Расчеты.Валюта,
	|	ВЫБОР
	|		КОГДА Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ПереносАванса)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ
	|			Расчеты.СтатьяДвиженияДенежныхСредств
	|	КОНЕЦ,
	|	Расчеты.ХозяйственнаяОперация,
	|	Расчеты.НастройкаХозОперации,
	|	Расчеты.ВидДвижения
	|	
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка";
	ТекстыЗапроса.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	ТекстЗапроса = СтрСоединить(ТекстыЗапроса, ОбщегоНазначения.РазделительПакетаЗапросов()) + ОбщегоНазначения.РазделительПакетаЗапросов();
	
	// Типы документов с детализацией до расчетных документов (поставщики):
	РасчетныеДокументыПоставщики = Новый Массив;
	РасчетныеДокументыПоставщики.Добавить("ТИП(Документ.ВозвратТоваровПоставщику)");
	РасчетныеДокументыПоставщики.Добавить("ТИП(Документ.ВозвратТоваровМеждуОрганизациями)");
	РасчетныеДокументыПоставщики.Добавить("ТИП(Документ.ОтчетКомитенту)");
	РасчетныеДокументыПоставщики.Добавить("ТИП(Документ.ОтчетПоКомиссииМеждуОрганизациями)");
	Если РасчетныеДокументыПоставщики.Количество() Тогда
		ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&РасчетныеДокументыПоставщики", СтрСоединить(РасчетныеДокументыПоставщики, ","));
	Иначе
		ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "ТИПЗНАЧЕНИЯ(Расчеты.Ссылка) В (&РасчетныеДокументыПоставщики)", "ЛОЖЬ");
	КонецЕсли;
	
	// Типы документов с детализацией до расчетных документов (клиенты):
	РасчетныеДокументыКлиенты = Новый Массив;
	РасчетныеДокументыКлиенты.Добавить("ТИП(Документ.ОтчетКомиссионера)");
	РасчетныеДокументыКлиенты.Добавить("ТИП(Документ.ОтчетПоКомиссииМеждуОрганизациями)");
	Если РасчетныеДокументыКлиенты.Количество() Тогда
		ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&РасчетныеДокументыКлиенты", СтрСоединить(РасчетныеДокументыКлиенты, ","));
	Иначе
		ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "ТИПЗНАЧЕНИЯ(Расчеты.Ссылка) В (&РасчетныеДокументыКлиенты)", "ЛОЖЬ");
	КонецЕсли;
	
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстВТРасчетовПоДокументам(ДокументИмя)
	
	ТекстыЗапроса = Новый Массив;
	
	#Область Клиенты
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	Расчеты.Регистратор КАК Ссылка,
	|	ОбъектыРасчетов.Контрагент КАК Контрагент,
	|	ОбъектыРасчетов.Договор КАК Договор,
	|	ОбъектыРасчетов.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	ОбъектыРасчетов.Подразделение КАК Подразделение,
	|	Расчеты.Валюта,
	|	Расчеты.СтатьяДвиженияДенежныхСредств,
	|	ЕСТЬNULL(Операция.НаправлениеДеятельности, ОбъектыРасчетов.НаправлениеДеятельности) КАК КорНаправлениеДеятельности,
	|	ЕСТЬNULL(Операция.ГруппаФинансовогоУчета, ОбъектыРасчетов.ГруппаФинансовогоУчета) КАК КорГруппаФинансовогоУчета,
	|	ЕСТЬNULL(Операция.Подразделение, ОбъектыРасчетов.Подразделение) КАК КорПодразделение,
	|	СУММА(Расчеты.Предоплата) КАК Предоплата,
	|	СУММА(Расчеты.ПредоплатаУпр) КАК ПредоплатаУпр,
	|	СУММА(Расчеты.ПредоплатаРегл) КАК ПредоплатаРегл,
	|	СУММА(Расчеты.Долг) КАК Долг,
	|	СУММА(Расчеты.ДолгУпр) КАК ДолгУпр,
	|	СУММА(Расчеты.ДолгРегл) КАК ДолгРегл,
	|	СУММА(Расчеты.ЗалогЗаТару) КАК ЗалогЗаТару,
	|	СУММА(Расчеты.ЗалогЗаТаруРегл) КАК ЗалогЗаТаруРегл
	|ПОМЕСТИТЬ ВТРасчетыСКлиентамиПоДокументам
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.РасчетыСКлиентамиПоДокументам КАК Расчеты
	|	ПО
	|		ДокументыКОтражению.Ссылка = Расчеты.Регистратор
	|		И НЕ &НоваяАрхитектураВзаиморасчетов
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ОбъектыРасчетов КАК ОбъектыРасчетов
	|	ПО (Расчеты.ЗаказКлиента = ОбъектыРасчетов.Ссылка)
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ДокументИмя КАК Операция
	|	ПО
	|		Расчеты.Регистратор = Операция.Ссылка
	|		И ОбъектыРасчетов.ТипОбъектаРасчетов = ЗНАЧЕНИЕ(Перечисление.ТипыОбъектовРасчетов.Накладная)
	|		И ОбъектыРасчетов.Объект <> Операция.Ссылка
	|	
	|СГРУППИРОВАТЬ ПО
	|	Расчеты.Регистратор,
	|	ОбъектыРасчетов.Контрагент,
	|	ОбъектыРасчетов.Договор,
	|	ОбъектыРасчетов.НаправлениеДеятельности,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета,
	|	ОбъектыРасчетов.Подразделение,
	|	Расчеты.Валюта,
	|	Расчеты.СтатьяДвиженияДенежныхСредств,
	|	ЕСТЬNULL(Операция.НаправлениеДеятельности, ОбъектыРасчетов.НаправлениеДеятельности),
	|	ЕСТЬNULL(Операция.ГруппаФинансовогоУчета, ОбъектыРасчетов.ГруппаФинансовогоУчета),
	|	ЕСТЬNULL(Операция.Подразделение, ОбъектыРасчетов.Подразделение)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Расчеты.Ссылка КАК Ссылка,
	|	Расчеты.Контрагент КАК Контрагент,
	|	Расчеты.Договор КАК Договор,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	Расчеты.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	Расчеты.Подразделение КАК Подразделение,
	|	Расчеты.Валюта КАК Валюта,
	|	Расчеты.СтатьяДвиженияДенежныхСредств КАК СтатьяДвиженияДенежныхСредств,
	|	Расчеты.КорНаправлениеДеятельности,
	|	Расчеты.КорГруппаФинансовогоУчета,
	|	Расчеты.КорПодразделение,
	|	СУММА(Расчеты.Предоплата) КАК Предоплата,
	|	СУММА(Расчеты.ПредоплатаУпр) КАК ПредоплатаУпр,
	|	СУММА(Расчеты.ПредоплатаРегл) КАК ПредоплатаРегл,
	|	СУММА(Расчеты.Долг) КАК Долг,
	|	СУММА(Расчеты.ДолгУпр) КАК ДолгУпр,
	|	СУММА(Расчеты.ДолгРегл) КАК ДолгРегл,
	|	СУММА(Расчеты.ЗалогЗаТару) КАК ЗалогЗаТару,
	|	СУММА(Расчеты.ЗалогЗаТаруРегл) КАК ЗалогЗаТаруРегл
	|ИЗ
	|	РасчетыСКлиентамиНоваяАрхитектураДетально КАК Расчеты
	|
	|СГРУППИРОВАТЬ ПО
	|	Расчеты.Ссылка,
	|	Расчеты.Контрагент,
	|	Расчеты.Договор,
	|	Расчеты.НаправлениеДеятельности,
	|	Расчеты.ГруппаФинансовогоУчета,
	|	Расчеты.Подразделение,
	|	Расчеты.Валюта,
	|	Расчеты.СтатьяДвиженияДенежныхСредств,
	|	Расчеты.КорНаправлениеДеятельности,
	|	Расчеты.КорГруппаФинансовогоУчета,
	|	Расчеты.КорПодразделение
	|	
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка,
	|	Контрагент,
	|	Договор,
	|	ГруппаФинансовогоУчета,
	|	Подразделение,
	|	НаправлениеДеятельности,
	|	Расчеты.СтатьяДвиженияДенежныхСредств,
	|	Расчеты.Валюта";
	ТекстыЗапроса.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область Поставщики
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	Расчеты.Регистратор КАК Ссылка,
	|	ОбъектыРасчетов.Контрагент КАК Контрагент,
	|	ОбъектыРасчетов.Договор КАК Договор,
	|	ОбъектыРасчетов.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	ОбъектыРасчетов.Подразделение КАК Подразделение,
	|	Расчеты.Валюта,
	|	Расчеты.СтатьяДвиженияДенежныхСредств,
	|	ЕСТЬNULL(Операция.НаправлениеДеятельности, ОбъектыРасчетов.НаправлениеДеятельности) КАК КорНаправлениеДеятельности,
	|	ЕСТЬNULL(Операция.ГруппаФинансовогоУчета, ОбъектыРасчетов.ГруппаФинансовогоУчета) КАК КорГруппаФинансовогоУчета,
	|	ЕСТЬNULL(Операция.Подразделение, ОбъектыРасчетов.Подразделение) КАК КорПодразделение,
	|	СУММА(Расчеты.Предоплата) КАК Предоплата,
	|	СУММА(Расчеты.ПредоплатаУпр) КАК ПредоплатаУпр,
	|	СУММА(Расчеты.ПредоплатаРегл) КАК ПредоплатаРегл,
	|	СУММА(Расчеты.Долг) КАК Долг,
	|	СУММА(Расчеты.ДолгУпр) КАК ДолгУпр,
	|	СУММА(Расчеты.ДолгРегл) КАК ДолгРегл
	|ПОМЕСТИТЬ ВТРасчетыСПоставщикамиПоДокументам
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.РасчетыСПоставщикамиПоДокументам КАК Расчеты
	|	ПО
	|		ДокументыКОтражению.Ссылка = Расчеты.Регистратор
	|		И НЕ &НоваяАрхитектураВзаиморасчетов
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ОбъектыРасчетов КАК ОбъектыРасчетов
	|	ПО (Расчеты.ЗаказПоставщику = ОбъектыРасчетов.Ссылка)
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ДокументИмя КАК Операция
	|	ПО
	|		Расчеты.Регистратор = Операция.Ссылка
	|		И ОбъектыРасчетов.ТипОбъектаРасчетов = ЗНАЧЕНИЕ(Перечисление.ТипыОбъектовРасчетов.Накладная)
	|		И ОбъектыРасчетов.Объект <> Операция.Ссылка
	|	
	|СГРУППИРОВАТЬ ПО
	|	Расчеты.Регистратор,
	|	ОбъектыРасчетов.Контрагент,
	|	ОбъектыРасчетов.Договор,
	|	ОбъектыРасчетов.НаправлениеДеятельности,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета,
	|	ОбъектыРасчетов.Подразделение,
	|	Расчеты.Валюта,
	|	Расчеты.СтатьяДвиженияДенежныхСредств,
	|	ЕСТЬNULL(Операция.НаправлениеДеятельности, ОбъектыРасчетов.НаправлениеДеятельности),
	|	ЕСТЬNULL(Операция.ГруппаФинансовогоУчета, ОбъектыРасчетов.ГруппаФинансовогоУчета),
	|	ЕСТЬNULL(Операция.Подразделение, ОбъектыРасчетов.Подразделение)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Расчеты.Ссылка КАК Ссылка,
	|	Расчеты.Контрагент КАК Контрагент,
	|	Расчеты.Договор КАК Договор,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	Расчеты.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	Расчеты.Подразделение КАК Подразделение,
	|	Расчеты.Валюта КАК Валюта,
	|	Расчеты.СтатьяДвиженияДенежныхСредств КАК СтатьяДвиженияДенежныхСредств,
	|	Расчеты.КорНаправлениеДеятельности,
	|	Расчеты.КорГруппаФинансовогоУчета,
	|	Расчеты.КорПодразделение,
	|	СУММА(Расчеты.Предоплата) КАК Предоплата,
	|	СУММА(Расчеты.ПредоплатаУпр) КАК ПредоплатаУпр,
	|	СУММА(Расчеты.ПредоплатаРегл) КАК ПредоплатаРегл,
	|	СУММА(-Расчеты.Долг) КАК Долг,
	|	СУММА(-Расчеты.ДолгУпр) КАК ДолгУпр,
	|	СУММА(-Расчеты.ДолгРегл) КАК ДолгРегл
	|ИЗ
	|	РасчетыСПоставщикамиНоваяАрхитектураДетально КАК Расчеты
	|
	|СГРУППИРОВАТЬ ПО
	|	Расчеты.Ссылка,
	|	Расчеты.Контрагент,
	|	Расчеты.Договор,
	|	Расчеты.НаправлениеДеятельности,
	|	Расчеты.Валюта,
	|	Расчеты.ГруппаФинансовогоУчета,
	|	Расчеты.Подразделение,
	|	Расчеты.СтатьяДвиженияДенежныхСредств,
	|	Расчеты.КорНаправлениеДеятельности,
	|	Расчеты.КорГруппаФинансовогоУчета,
	|	Расчеты.КорПодразделение
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка,
	|	Контрагент,
	|	Договор,
	|	ГруппаФинансовогоУчета,
	|	Подразделение,
	|	НаправлениеДеятельности,
	|	Расчеты.СтатьяДвиженияДенежныхСредств,
	|	Расчеты.Валюта";
	ТекстыЗапроса.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	ТекстыЗапроса.Добавить("");
	
	ТекстЗапроса = СтрСоединить(ТекстыЗапроса, ОбщегоНазначения.РазделительПакетаЗапросов());
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "ДокументИмя", ДокументИмя);
	Если ДокументИмя = "Документ.ОтчетПоКомиссииМеждуОрганизациями" ИЛИ ДокументИмя = "Документ.ПередачаТоваровМеждуОрганизациями" Тогда
		Отступ = Символы.ПС + Символы.Таб + Символы.Таб + Символы.Таб;
		ВыражениеДляИнтеркомпани = Отступ + "ВЫБОР КОГДА ОбъектыРасчетов.Организация = Операция.Организация"
			+ Отступ + "ТОГДА Операция.ГруппаФинансовогоУчета"
			+ Отступ + "ИНАЧЕ Операция.ГруппаФинансовогоУчетаПолучателя КОНЕЦ";
		ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "Операция.ГруппаФинансовогоУчета", ВыражениеДляИнтеркомпани);
	//++ НЕ УТКА
	ИначеЕсли ДокументИмя = "Документ.ОтчетДавальцуМеждуОрганизациями" Тогда
		Отступ = Символы.ПС + Символы.Таб + Символы.Таб + Символы.Таб;
		ВыражениеДляИнтеркомпани = Отступ + "ВЫБОР КОГДА ОбъектыРасчетов.Организация = Операция.Организация"
			+ Отступ + "ТОГДА Операция.ГруппаФинансовогоУчетаПереработчика"
			+ Отступ + "ИНАЧЕ Операция.ГруппаФинансовогоУчетаДавальца КОНЕЦ";
		ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "Операция.ГруппаФинансовогоУчета", ВыражениеДляИнтеркомпани);
	//-- НЕ УТКА
	КонецЕсли;
	
	Если ДокументИмя = "Документ.ОперацияПоЯндексКассе" Тогда
		// ОперацияПоЯндексКассе добавлен в качестве объекта расчетов, для него строится зачет авансов, однако авансов быть не может, а так же ГФУ и НаправленияДеятельности в нем нет.
		ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "Операция.ГруппаФинансовогоУчета", "ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка)");
		ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "Операция.НаправлениеДеятельности", "ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)");
	КонецЕсли;
	
	Если ДокументИмя = "Документ.Бронирование" Тогда
		// Бронирование добавлен в качестве объекта расчетов, однако ГФУ в нем нет.
		ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "Операция.ГруппаФинансовогоУчета", "ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка)");
	КонецЕсли;
	
	Если ДокументИмя = "Документ.Сторно" Тогда
		ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "Операция.Подразделение", "ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)");
		ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "Операция.ГруппаФинансовогоУчета", "ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка)");
		ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "Операция.НаправлениеДеятельности", "ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)");
	КонецЕсли;
	
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстВТРасчетов()
	
	ТекстыЗапроса = Новый Массив;
	
	#Область Клиенты
	ТекстЗапроса = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	Расчеты.Регистратор КАК Ссылка,
	|	Расчеты.Валюта,
	|	Расчеты.СтатьяДвиженияДенежныхСредств,
	|	Расчеты.АналитикаУчетаПоПартнерам.Организация КАК ОрганизацияАналитики,
	|	ОбъектыРасчетов.Организация КАК Организация,
	|	ОбъектыРасчетов.Контрагент КАК Контрагент,
	|	ОбъектыРасчетов.Договор КАК Договор,
	|	ОбъектыРасчетов.Подразделение КАК Подразделение,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	ОбъектыРасчетов.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	СУММА(Расчеты.Сумма) КАК Сумма,
	|	СУММА(Расчеты.СуммаУпр) КАК СуммаУпр,
	|	СУММА(Расчеты.СуммаРегл) КАК СуммаРегл
	|	
	|ПОМЕСТИТЬ ВТРасчетыСКлиентами
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.РасчетыСКлиентами КАК Расчеты
	|		ПО ДокументыКОтражению.Ссылка = Расчеты.Регистратор
	|		И НЕ Расчеты.Сторно
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ОбъектыРасчетов КАК ОбъектыРасчетов
	|	ПО (Расчеты.ОбъектРасчетов = ОбъектыРасчетов.Ссылка)
	|ГДЕ
	|	ОбъектыРасчетов.Организация <> ЗНАЧЕНИЕ(Справочник.Организации.УправленческаяОрганизация)
	|	И НЕ Расчеты.ХозяйственнаяОперация В (
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПереносАванса),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.РезервированиеАвансаКлиента),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВзаимозачетЗадолженности),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПереносПлатежаМеждуФилиалами),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПереносЗадолженностиМеждуФилиалами))
	|
	|СГРУППИРОВАТЬ ПО
	|	Расчеты.Регистратор,
	|	Расчеты.Валюта,
	|	Расчеты.СтатьяДвиженияДенежныхСредств,
	|	Расчеты.АналитикаУчетаПоПартнерам.Организация,
	|	ОбъектыРасчетов.Организация,
	|	ОбъектыРасчетов.Контрагент,
	|	ОбъектыРасчетов.Договор,
	|	ОбъектыРасчетов.НаправлениеДеятельности,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета,
	|	ОбъектыРасчетов.Подразделение
	|
	|ИМЕЮЩИЕ
	|	СУММА(Расчеты.Сумма) <> 0
	|	
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка";
	ТекстыЗапроса.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область Поставщики
	ТекстЗапроса = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	Расчеты.Регистратор КАК Ссылка,
	|	Расчеты.Валюта,
	|	Расчеты.СтатьяДвиженияДенежныхСредств,
	|	Расчеты.АналитикаУчетаПоПартнерам.Организация КАК ОрганизацияАналитики,
	|	ОбъектыРасчетов.Организация,
	|	ОбъектыРасчетов.Контрагент КАК Контрагент,
	|	ОбъектыРасчетов.Договор КАК Договор,
	|	ОбъектыРасчетов.Подразделение КАК Подразделение,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	ОбъектыРасчетов.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	СУММА(Расчеты.Сумма) КАК Сумма,
	|	СУММА(Расчеты.СуммаУпр) КАК СуммаУпр,
	|	СУММА(Расчеты.СуммаРегл) КАК СуммаРегл
	|	
	|ПОМЕСТИТЬ ВТРасчетыСПоставщиками
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.РасчетыСПоставщиками КАК Расчеты
	|		ПО ДокументыКОтражению.Ссылка = Расчеты.Регистратор
	|		И НЕ Расчеты.Сторно
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ОбъектыРасчетов КАК ОбъектыРасчетов
	|	ПО (Расчеты.ОбъектРасчетов = ОбъектыРасчетов.Ссылка)
	|ГДЕ
	|	ОбъектыРасчетов.Организация <> ЗНАЧЕНИЕ(Справочник.Организации.УправленческаяОрганизация)
	|	И НЕ Расчеты.ХозяйственнаяОперация В (
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПереносАванса),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВзаимозачетЗадолженности),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПереносПлатежаМеждуФилиалами),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПереносЗадолженностиМеждуФилиалами))
	|
	|СГРУППИРОВАТЬ ПО
	|	Расчеты.Регистратор,
	|	Расчеты.Валюта,
	|	Расчеты.СтатьяДвиженияДенежныхСредств,
	|	Расчеты.АналитикаУчетаПоПартнерам.Организация,
	|	ОбъектыРасчетов.Организация,
	|	ОбъектыРасчетов.Контрагент,
	|	ОбъектыРасчетов.Договор,
	|	ОбъектыРасчетов.НаправлениеДеятельности,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета,
	|	ОбъектыРасчетов.Подразделение
	|
	|ИМЕЮЩИЕ
	|	СУММА(Расчеты.Сумма) <> 0
	|	
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка";
	ТекстыЗапроса.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	Возврат СтрСоединить(ТекстыЗапроса, ОбщегоНазначения.РазделительПакетаЗапросов()) + ОбщегоНазначения.РазделительПакетаЗапросов();
	
КонецФункции

Функция ТекстВТВводСобственныхСредств()
	
	// Если в документе поступления партии НДС был ввод собственных средств в направление, то ценности на контракт ГОЗ относятся,
	// а НДС с них нет, т.к. это запрещено Постановлением №543.
	Возврат "
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	РазрезыКОтражению.Ссылка КАК Ссылка,
		|	НДСПредъявленный.СчетФактура КАК СчетФактура,
		|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельности,
		|	НДСПредъявленный.НаправлениеДеятельности КАК ИсходноеНаправлениеДеятельности
		|ПОМЕСТИТЬ ВТВводСобственныхСредств
		|ИЗ
		|	РазрезыКОтражению КАК РазрезыКОтражению
		|	
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
		|		РегистрНакопления.НДСПредъявленный КАК НДСПредъявленный
		|	ПО
		|		РазрезыКОтражению.Ссылка = НДСПредъявленный.Регистратор
		|		И НДСПредъявленный.НаправлениеДеятельности.ТипНаправленияДеятельности = ЗНАЧЕНИЕ(Перечисление.ТипыНаправленийДеятельности.КонтрактГОЗ)
		|		И НЕ НДСПредъявленный.Сторно
		|
		|	ЛЕВОЕ СОЕДИНЕНИЕ
		|		РегистрСведений.РеестрДокументов КАК РеестрДокументов
		|	ПО
		|		НДСПредъявленный.СчетФактура = РеестрДокументов.Ссылка
		|
		|ГДЕ
		|	ЕСТЬNULL(РеестрДокументов.Договор.НаправлениеДеятельности, ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)) <> НДСПредъявленный.НаправлениеДеятельности
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Ссылка,
		|	СчетФактура,
		|	ИсходноеНаправлениеДеятельности
		|;";
	
КонецФункции

Функция ТекстДолгосрочнаяЗадолженность(ДокументИмя)
	
	МассивТекстовВТ = Новый Массив;
	МассивТекстовУничтоженияВТ = Новый Массив;
	МассивТекстовЗапроса = Новый Массив;
	
	#Область Инициализация
	
	ТекстЗапроса =
	"ВЫБРАТЬ //// Инициализация временной таблицы долгосрочной задолженности
	|	НЕОПРЕДЕЛЕНО КАК Ссылка,
	|	ДАТАВРЕМЯ(1, 1, 1) КАК ДатаОтражения,
	|	ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка) КАК Организация,
	|	ЛОЖЬ КАК Долгосрочная,
	|	""Основной"" КАК ВариантПереноса,
	|	НЕОПРЕДЕЛЕНО КАК ВидПроводкиДляПереноса,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПустаяСсылка) КАК ВидСчета,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчета,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчета,
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК Валюта,
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка) КАК Подразделение,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельности,
	|	НЕОПРЕДЕЛЕНО КАК Субконто1,
	|	НЕОПРЕДЕЛЕНО КАК Субконто2,
	|	НЕОПРЕДЕЛЕНО КАК Субконто3,
	|	
	|	0 КАК Сумма,
	|	0 КАК СуммаУпр,
	|	0 КАК СуммаРегл
	|
	|ПОМЕСТИТЬ ВтДолгосрочнаяЗадолженность
	|ГДЕ ЛОЖЬ";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	Если ПолучитьФункциональнуюОпцию("ВыделятьДолгосрочныеАктивыОбязательства") Тогда
		
		Если ЭтоРасчетныйДокумент(ДокументИмя) ИЛИ ДокументИмя = "РасчетКурсовыхРазниц" Тогда
			
			#Область ДолгосрочнаяЗадолженностьПоРасчетамСКлиентами
			
			ТекстЗапроса =
			"ВЫБРАТЬ //// Расчеты с клиентами краткосрочные
			|	Расчеты.Ссылка КАК Ссылка,
			|	Расчеты.Период КАК Период,
			|	Расчеты.Организация КАК Организация,
			|	Расчеты.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
			|	Расчеты.Валюта КАК Валюта,
			|	Расчеты.Подразделение КАК Подразделение,
			|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельности,
			|	Расчеты.Контрагент КАК Контрагент,
			|	Расчеты.Договор КАК Договор,
			|	СУММА(Расчеты.Предоплата) КАК Предоплата,
			|	СУММА(Расчеты.Долг) КАК Долг,
			|	СУММА(Расчеты.ПредоплатаУпр) КАК ПредоплатаУпр,
			|	СУММА(Расчеты.ДолгУпр) КАК ДолгУпр,
			|	СУММА(Расчеты.ПредоплатаРегл) КАК ПредоплатаРегл,
			|	СУММА(Расчеты.ДолгРегл) КАК ДолгРегл
			|ПОМЕСТИТЬ РасчетыСКлиентамиКраткосрочнаяЗадолженность
			|ИЗ
			|	РасчетыСКлиентамиНоваяАрхитектураДетально КАК Расчеты
			|ГДЕ
			|	НЕ Расчеты.ДолгосрочнаяЗадолженность
			|
			|СГРУППИРОВАТЬ ПО
			|	Расчеты.Ссылка,
			|	Расчеты.Организация,
			|	Расчеты.Период,
			|	Расчеты.ГруппаФинансовогоУчета,
			|	Расчеты.Валюта,
			|	Расчеты.Подразделение,
			|	Расчеты.НаправлениеДеятельности,
			|	Расчеты.Контрагент,
			|	Расчеты.Договор
			|
			|ИМЕЮЩИЕ
			|	СУММА(Расчеты.Предоплата)
			|		+ СУММА(Расчеты.Долг)
			|		+ СУММА(Расчеты.ПредоплатаУпр)
			|		+ СУММА(Расчеты.ДолгУпр)
			|		+ СУММА(Расчеты.ПредоплатаРегл)
			|		+ СУММА(Расчеты.ДолгРегл) <> 0
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Ссылка,
			|	Период,
			|	Организация,
			|	ГруппаФинансовогоУчета,
			|	Валюта,
			|	Подразделение,
			|	НаправлениеДеятельности,
			|	Контрагент,
			|	Договор";
			МассивТекстовВТ.Добавить(ТекстЗапроса);
			
			ТекстЗапроса =
			"ВЫБРАТЬ //// Расчеты с клиентами
			|	Расчеты.Ссылка КАК Ссылка,
			|	НАЧАЛОПЕРИОДА(Расчеты.Период, ДЕНЬ) КАК ДатаОтражения,
			|	Расчеты.Организация КАК Организация,
			|	ИСТИНА КАК Долгосрочная,
			|	ВЫБОР
			|		КОГДА РасчетыКраткосрочные.Ссылка ЕСТЬ NULL
			|		ТОГДА ""Основной""
			|		КОГДА Расчеты.ПредоплатаРегл <> 0
			|		ТОГДА ""Разделение""
			|		ИНАЧЕ ""ЧерезТранзитныйСчет""
			|	КОНЕЦ КАК ВариантПереноса,
			|	НЕОПРЕДЕЛЕНО КАК ВидПроводкиДляПереноса,
			|
			|	ВЫБОР КОГДА Расчеты.ПредоплатаРегл <> 0
			|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыПолученные)
			|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами)
			|	КОНЕЦ КАК ВидСчета,
			|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчета,
			|	НЕОПРЕДЕЛЕНО КАК МестоУчета,
			|	Расчеты.Валюта КАК Валюта,
			|	Расчеты.Подразделение КАК Подразделение,
			|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельности,
			|
			|	Расчеты.Контрагент КАК Субконто1,
			|	Расчеты.Договор КАК Субконто2,
			|	НЕОПРЕДЕЛЕНО КАК Субконто3,
			|
			|	СУММА(ВЫБОР КОГДА Расчеты.Предоплата + Расчеты.Долг < 0 ТОГДА -1 ИНАЧЕ 1 КОНЕЦ * (Расчеты.Предоплата + Расчеты.Долг)) КАК Сумма,
			|	СУММА(ВЫБОР КОГДА Расчеты.ПредоплатаУпр + Расчеты.ДолгУпр < 0 ТОГДА -1 ИНАЧЕ 1 КОНЕЦ * (Расчеты.ПредоплатаУпр + Расчеты.ДолгУпр)) КАК СуммаУпр,
			|	СУММА(ВЫБОР КОГДА Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл < 0 ТОГДА -1 ИНАЧЕ 1 КОНЕЦ * (Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл)) КАК СуммаРегл
			|
			|ИЗ
			|	РасчетыСКлиентамиНоваяАрхитектураДетально КАК Расчеты
			|	ЛЕВОЕ СОЕДИНЕНИЕ РасчетыСКлиентамиКраткосрочнаяЗадолженность КАК РасчетыКраткосрочные
			|	ПО Расчеты.Ссылка = РасчетыКраткосрочные.Ссылка
			|		И Расчеты.Организация = РасчетыКраткосрочные.Организация
			|		И Расчеты.Период = РасчетыКраткосрочные.Период
			|		И Расчеты.ГруппаФинансовогоУчета = РасчетыКраткосрочные.ГруппаФинансовогоУчета
			|		И Расчеты.Валюта = РасчетыКраткосрочные.Валюта
			|		И Расчеты.Подразделение = РасчетыКраткосрочные.Подразделение
			|		И Расчеты.НаправлениеДеятельности = РасчетыКраткосрочные.НаправлениеДеятельности
			|		И Расчеты.Контрагент = РасчетыКраткосрочные.Контрагент
			|		И Расчеты.Договор = РасчетыКраткосрочные.Договор
			|ГДЕ
			|	Расчеты.ДолгосрочнаяЗадолженность
			|	И Расчеты.ДатаПлановогоПогашения > Расчеты.Период
			|
			|СГРУППИРОВАТЬ ПО
			|	Расчеты.Ссылка,
			|	НАЧАЛОПЕРИОДА(Расчеты.Период, ДЕНЬ),
			|	Расчеты.Организация,
			|	ВЫБОР
			|		КОГДА РасчетыКраткосрочные.Ссылка ЕСТЬ NULL
			|		ТОГДА ""Основной""
			|		КОГДА Расчеты.ПредоплатаРегл <> 0
			|		ТОГДА ""Разделение""
			|		ИНАЧЕ ""ЧерезТранзитныйСчет""
			|	КОНЕЦ,
			|
			|	ВЫБОР КОГДА Расчеты.ПредоплатаРегл <> 0
			|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыПолученные)
			|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами)
			|	КОНЕЦ,
			|	Расчеты.ГруппаФинансовогоУчета,
			|	Расчеты.Валюта,
			|	Расчеты.Подразделение,
			|	Расчеты.НаправлениеДеятельности,
			|
			|	Расчеты.Контрагент,
			|	Расчеты.Договор";
			МассивТекстовЗапроса.Добавить(ТекстЗапроса);
			
			ТекстУничтоженияВТ = "
			|////////////////////////////////////////////////////////////////////////////////
			|УНИЧТОЖИТЬ РасчетыСКлиентамиКраткосрочнаяЗадолженность";
			
			МассивТекстовУничтоженияВТ.Добавить(ТекстУничтоженияВТ);
			
			#КонецОбласти
			
			#Область ДолгосрочнаяЗадолженностьПоРасчетамСПоставщиками
			
			ТекстЗапроса =
			"ВЫБРАТЬ //// Расчеты с поставщиками
			|	Расчеты.Ссылка КАК Ссылка,
			|	НАЧАЛОПЕРИОДА(Расчеты.Период, ДЕНЬ) КАК ДатаОтражения,
			|	Расчеты.Организация КАК Организация,
			|	ИСТИНА КАК Долгосрочная,
			|	ВЫБОР
			|		КОГДА РасчетыКраткосрочные.Ссылка ЕСТЬ NULL
			|		ТОГДА ""Основной""
			|		КОГДА Расчеты.ПредоплатаРегл <> 0
			|		ТОГДА ""Разделение""
			|		ИНАЧЕ ""ЧерезТранзитныйСчет""
			|	КОНЕЦ КАК ВариантПереноса,
			|	НЕОПРЕДЕЛЕНО КАК ВидПроводкиДляПереноса,
			|
			|	ВЫБОР КОГДА Расчеты.ПредоплатаРегл <> 0
			|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыВыданные)
			|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками)
			|	КОНЕЦ КАК ВидСчета,
			|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчета,
			|	НЕОПРЕДЕЛЕНО КАК МестоУчета,
			|	Расчеты.Валюта КАК Валюта,
			|	Расчеты.Подразделение КАК Подразделение,
			|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельности,
			|
			|	Расчеты.Контрагент КАК Субконто1,
			|	Расчеты.Договор КАК Субконто2,
			|	НЕОПРЕДЕЛЕНО КАК Субконто3,
			|
			|	СУММА(ВЫБОР КОГДА Расчеты.Предоплата + Расчеты.Долг < 0 ТОГДА -1 ИНАЧЕ 1 КОНЕЦ * (Расчеты.Предоплата + Расчеты.Долг)) КАК Сумма,
			|	СУММА(ВЫБОР КОГДА Расчеты.ПредоплатаУпр + Расчеты.ДолгУпр < 0 ТОГДА -1 ИНАЧЕ 1 КОНЕЦ * (Расчеты.ПредоплатаУпр + Расчеты.ДолгУпр)) КАК СуммаУпр,
			|	СУММА(ВЫБОР КОГДА Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл < 0 ТОГДА -1 ИНАЧЕ 1 КОНЕЦ * (Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл)) КАК СуммаРегл
			|
			|ИЗ
			|	РасчетыСПоставщикамиНоваяАрхитектураДетально КАК Расчеты
			|	ЛЕВОЕ СОЕДИНЕНИЕ РасчетыСПоставщикамиНоваяАрхитектураДетальноКраткосрочнаяЗадолженность КАК РасчетыКраткосрочные
			|	ПО Расчеты.Ссылка = РасчетыКраткосрочные.Ссылка
			|		И Расчеты.Организация = РасчетыКраткосрочные.Организация
			|		И Расчеты.Период = РасчетыКраткосрочные.Период
			|		И Расчеты.ГруппаФинансовогоУчета = РасчетыКраткосрочные.ГруппаФинансовогоУчета
			|		И Расчеты.Валюта = РасчетыКраткосрочные.Валюта
			|		И Расчеты.Подразделение = РасчетыКраткосрочные.Подразделение
			|		И Расчеты.НаправлениеДеятельности = РасчетыКраткосрочные.НаправлениеДеятельности
			|		И Расчеты.Контрагент = РасчетыКраткосрочные.Контрагент
			|		И Расчеты.Договор = РасчетыКраткосрочные.Договор
			|ГДЕ
			|	Расчеты.ДолгосрочнаяЗадолженность
			|	И Расчеты.ДатаПлановогоПогашения > Расчеты.Период
			|СГРУППИРОВАТЬ ПО
			|	Расчеты.Ссылка,
			|	НАЧАЛОПЕРИОДА(Расчеты.Период, ДЕНЬ),
			|	Расчеты.Организация,
			|	ВЫБОР
			|		КОГДА РасчетыКраткосрочные.Ссылка ЕСТЬ NULL
			|		ТОГДА ""Основной""
			|		КОГДА Расчеты.ПредоплатаРегл <> 0
			|		ТОГДА ""Разделение""
			|		ИНАЧЕ ""ЧерезТранзитныйСчет""
			|	КОНЕЦ,
			|
			|	ВЫБОР КОГДА Расчеты.ПредоплатаРегл <> 0
			|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыВыданные)
			|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками)
			|	КОНЕЦ,
			|	Расчеты.ГруппаФинансовогоУчета,
			|	Расчеты.Валюта,
			|	Расчеты.Подразделение,
			|	Расчеты.НаправлениеДеятельности,
			|
			|	Расчеты.Контрагент,
			|	Расчеты.Договор";
			МассивТекстовЗапроса.Добавить(ТекстЗапроса);
			
			#КонецОбласти
			
			#Область ДолгосрочнаяЗадолженностьПоКредитамИДепозитам
			
			ТекстЗапросаВТ ="ВЫБРАТЬ
			|	Расчеты.Регистратор КАК Ссылка,
			|	Расчеты.Договор КАК Договор,
			|	Расчеты.Валюта,
			|	УчетнаяПолитикаОрганизаций.МесяцыДолгосрочнойЗадолженности,
			|	СУММА(Расчеты.Сумма) КАК Сумма,
			|	СУММА(Расчеты.СуммаУпр) КАК СуммаУпр,
			|	СУММА(Расчеты.СуммаРегл) КАК СуммаРегл,
			|	НАЧАЛОПЕРИОДА(Расчеты.Период, ДЕНЬ) КАК ДатаОтражения,
			|	Расчеты.ХозяйственнаяОперация,
			|	ВЫБОР
			|		КОГДА Расчеты.Договор.ХарактерДоговора = ЗНАЧЕНИЕ(Перечисление.ХарактерыДоговоровФинансовыхИнструментов.КредитИлиЗайм)
			|		ТОГДА ""Кт""
			|		ИНАЧЕ ""Дт""
			|	КОНЕЦ КАК ВидПроводкиДляПереноса
			|ПОМЕСТИТЬ ВтКредитыДепозиты
			|ИЗ
			|	ДокументыКОтражению КАК ДокументыКОтражению
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.РасчетыПоФинансовымИнструментам КАК Расчеты
			|		ПО ДокументыКОтражению.Ссылка = Расчеты.Регистратор
			|		ЛЕВОЕ СОЕДИНЕНИЕ УчетнаяПолитикаОрганизаций КАК УчетнаяПолитикаОрганизаций
			|		ПО Расчеты.Регистратор = УчетнаяПолитикаОрганизаций.Ссылка
			|		И Расчеты.Договор.Организация = УчетнаяПолитикаОрганизаций.Организация
			|		И НАЧАЛОПЕРИОДА(Расчеты.Период, ДЕНЬ) = УчетнаяПолитикаОрганизаций.ДатаОтражения
			|ГДЕ
			|	Расчеты.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыСуммГрафикаКредитовИДепозитов.ОсновнойДолг)
			|	И Расчеты.Сумма > 0
			|	И ЕСТЬNULL(УчетнаяПолитикаОрганизаций.ДолгосрочныеАктивыОбязательства, ЛОЖЬ)
			|	И Расчеты.Договор.ХарактерДоговора В (ЗНАЧЕНИЕ(Перечисление.ХарактерыДоговоровФинансовыхИнструментов.Депозит),
			|		ЗНАЧЕНИЕ(Перечисление.ХарактерыДоговоровФинансовыхИнструментов.ЗаймВыданный),
			|		ЗНАЧЕНИЕ(Перечисление.ХарактерыДоговоровФинансовыхИнструментов.КредитИлиЗайм))
			|	И ВЫБОР
			|		КОГДА
			|			Расчеты.Договор.ХарактерДоговора = ЗНАЧЕНИЕ(Перечисление.ХарактерыДоговоровФинансовыхИнструментов.КредитИлиЗайм)
			|			ТОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
			|		ИНАЧЕ Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
			|	КОНЕЦ
			|СГРУППИРОВАТЬ ПО
			|	Расчеты.Регистратор,
			|	Расчеты.Договор,
			|	Расчеты.Валюта,
			|	Расчеты.Период,
			|	УчетнаяПолитикаОрганизаций.МесяцыДолгосрочнойЗадолженности,
			|	Расчеты.ХозяйственнаяОперация,
			|	ВЫБОР
			|		КОГДА Расчеты.Договор.ХарактерДоговора = ЗНАЧЕНИЕ(Перечисление.ХарактерыДоговоровФинансовыхИнструментов.КредитИлиЗайм)
			|		ТОГДА ""Кт""
			|		ИНАЧЕ ""Дт""
			|	КОНЕЦ
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Договор,
			|	ДатаОтражения
			|;
			|
			|////////////////////////////////////////////////////////////////////////////////
			|ВЫБРАТЬ
			|	ВтКредитыДепозиты.Договор КАК Договор,
			|	СУММА(ГрафикОплатКредитовИДепозитов.Сумма) КАК Сумма,
			|	СУММА(ВЫБОР
			|		КОГДА РАЗНОСТЬДАТ(ВтКредитыДепозиты.ДатаОтражения, ГрафикОплатКредитовИДепозитов.Период,
			|			Месяц) >= ВтКредитыДепозиты.МесяцыДолгосрочнойЗадолженности
			|			ТОГДА ГрафикОплатКредитовИДепозитов.Сумма
			|		ИНАЧЕ 0
			|	КОНЕЦ) КАК СуммаДолгосрочная
			|ПОМЕСТИТЬ ДолгосрочныеСуммыГрафиков
			|ИЗ
			|	ВтКредитыДепозиты КАК ВтКредитыДепозиты
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикОплатКредитовИДепозитов КАК ГрафикОплатКредитовИДепозитов
			|		ПО ГрафикОплатКредитовИДепозитов.ВариантГрафика.Владелец = ВтКредитыДепозиты.Договор
			|		И ГрафикОплатКредитовИДепозитов.Период > ВтКредитыДепозиты.ДатаОтражения
			|		И ГрафикОплатКредитовИДепозитов.ВариантГрафика.Используется = ИСТИНА
			|		И НЕ ГрафикОплатКредитовИДепозитов.ВариантГрафика.ПометкаУдаления
			|СГРУППИРОВАТЬ ПО
			|	ВтКредитыДепозиты.Договор
			|ИМЕЮЩИЕ
			|	СУММА(ВЫБОР
			|		КОГДА РАЗНОСТЬДАТ(ВтКредитыДепозиты.ДатаОтражения, ГрафикОплатКредитовИДепозитов.Период,
			|			Месяц) >= ВтКредитыДепозиты.МесяцыДолгосрочнойЗадолженности
			|			ТОГДА ГрафикОплатКредитовИДепозитов.Сумма
			|		ИНАЧЕ 0
			|	КОНЕЦ) > 0
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Договор";
			МассивТекстовВТ.Добавить(ТекстЗапросаВТ);
			
			ТекстЗапроса = "ВЫБРАТЬ
			|	ВтКредитыДепозиты.Ссылка КАК Ссылка,
			|	ВтКредитыДепозиты.ДатаОтражения КАК ДатаОтражения,
			|	ВтКредитыДепозиты.Договор.Организация КАК Организация,
			|	ИСТИНА КАК Долгосрочная,
			|	""Разделение"" КАК ВариантПереноса,
			|	ВтКредитыДепозиты.ВидПроводкиДляПереноса,
			|
			|	ВЫБОР
			|		КОГДА ВтКредитыДепозиты.ХозяйственнаяОперация В
			|			(ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПоступлениеДенежныхСредствПоКредитам),
			|			ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ОплатаПоКредитам))
			|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКредиторамиОсновнойДолг)
			|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСДебиторамиОсновнойДолг)
			|	КОНЕЦ КАК ВидСчета,
			|	ВтКредитыДепозиты.Договор.ГруппаФинансовогоУчета КАК АналитикаУчета,
			|	НЕОПРЕДЕЛЕНО КАК МестоУчета,
			|	ВтКредитыДепозиты.Валюта КАК Валюта,
			|	ВтКредитыДепозиты.Договор.Подразделение КАК Подразделение,
			|	ВтКредитыДепозиты.Договор.НаправлениеДеятельности КАК НаправлениеДеятельности,
			|
			|	ВтКредитыДепозиты.Договор.Контрагент КАК Субконто1,
			|	ВтКредитыДепозиты.Договор КАК Субконто2,
			|	НЕОПРЕДЕЛЕНО КАК Субконто3,
			|
			|	ВтКредитыДепозиты.Сумма * ДолгосрочныеСуммыГрафиков.СуммаДолгосрочная / ДолгосрочныеСуммыГрафиков.Сумма КАК Сумма,
			|	ВтКредитыДепозиты.СуммаУпр * ДолгосрочныеСуммыГрафиков.СуммаДолгосрочная / ДолгосрочныеСуммыГрафиков.Сумма КАК СуммаУпр,
			|	ВтКредитыДепозиты.СуммаРегл * ДолгосрочныеСуммыГрафиков.СуммаДолгосрочная / ДолгосрочныеСуммыГрафиков.Сумма КАК СуммаРегл
			|ИЗ
			|	ВтКредитыДепозиты КАК ВтКредитыДепозиты
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ДолгосрочныеСуммыГрафиков КАК ДолгосрочныеСуммыГрафиков
			|		ПО ВтКредитыДепозиты.Договор = ДолгосрочныеСуммыГрафиков.Договор";
			МассивТекстовЗапроса.Добавить(ТекстЗапроса);
			
			ТекстУничтоженияВТ = "
			|////////////////////////////////////////////////////////////////////////////////
			|УНИЧТОЖИТЬ ВтКредитыДепозиты
			|;
			|
			|////////////////////////////////////////////////////////////////////////////////
			|УНИЧТОЖИТЬ ДолгосрочныеСуммыГрафиков";
			МассивТекстовУничтоженияВТ.Добавить(ТекстУничтоженияВТ);
			
			#КонецОбласти
			
			#Область ДолгосрочнаяЗадолженностьПоДисконтированию
			
			ТекстЗапросаВТ = 
			 "ВЫБРАТЬ
			 |	Расчеты.Ссылка КАК Ссылка,
			 |	Расчеты.Период КАК Период,
			 |	ВЫБОР
			 |		КОГДА РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(Расчеты.Период, ДЕНЬ), Расчеты.ДатаПлановогоПогашения, МЕСЯЦ) >= ЕСТЬNULL(УчетнаяПолитикаОрганизаций.МесяцыДолгосрочнойЗадолженности, 999)
			 |			ТОГДА ИСТИНА
			 |		ИНАЧЕ ЛОЖЬ
			 |	КОНЕЦ КАК ДолгосрочнаяЗадолженность,
			 |	Расчеты.ДнейДоПлановогоПогашения КАК ДнейДоПлановогоПогашения,
			 |	Расчеты.Организация КАК Организация,
			 |	Расчеты.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
			 |	Расчеты.Валюта КАК Валюта,
			 |	Расчеты.Подразделение КАК Подразделение,
			 |	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельности,
			 |	Расчеты.Контрагент КАК Контрагент,
			 |	Расчеты.Договор КАК Договор,
			 |	СУММА(ВЫБОР
			 |			КОГДА Расчеты.Предоплата + Расчеты.Долг < 0
			 |				ТОГДА -1
			 |			ИНАЧЕ 1
			 |		КОНЕЦ * (Расчеты.Предоплата + Расчеты.Долг)) КАК Сумма,
			 |	СУММА(ВЫБОР
			 |			КОГДА Расчеты.ПредоплатаУпр + Расчеты.ДолгУпр < 0
			 |				ТОГДА -1
			 |			ИНАЧЕ 1
			 |		КОНЕЦ * (Расчеты.ПредоплатаУпр + Расчеты.ДолгУпр)) КАК СуммаУпр,
			 |	СУММА(ВЫБОР
			 |			КОГДА Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл < 0
			 |				ТОГДА -1
			 |			ИНАЧЕ 1
			 |		КОНЕЦ * (Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл)) КАК СуммаРегл,
			 |	СУММА(ВЫБОР
			 |			КОГДА Расчеты.Предоплата + Расчеты.Долг < 0
			 |				ТОГДА -Расчеты.ДнейДоПлановогоПогашения
			 |			ИНАЧЕ Расчеты.ДнейДоПлановогоПогашения
			 |		КОНЕЦ * (Расчеты.Предоплата + Расчеты.Долг)) КАК СуммаСводно,
			 |	СУММА(ВЫБОР
			 |			КОГДА Расчеты.ПредоплатаУпр + Расчеты.ДолгУпр < 0
			 |				ТОГДА -Расчеты.ДнейДоПлановогоПогашения
			 |			ИНАЧЕ Расчеты.ДнейДоПлановогоПогашения
			 |		КОНЕЦ * (Расчеты.ПредоплатаУпр + Расчеты.ДолгУпр)) КАК СуммаСводноУпр,
			 |	СУММА(ВЫБОР
			 |			КОГДА Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл < 0
			 |				ТОГДА -Расчеты.ДнейДоПлановогоПогашения
			 |			ИНАЧЕ Расчеты.ДнейДоПлановогоПогашения
			 |		КОНЕЦ * (Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл)) КАК СуммаСводноРегл
			 |ПОМЕСТИТЬ ВТРасчетыСПоставщикамиПодготовкаДанныхДляДолгосрочнойзадолженности
			 |ИЗ
			 |	РасчетыСПоставщикамиНоваяАрхитектураДетально КАК Расчеты
			 |		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ДоговорыКонтрагентов КАК ДоговорыКонтрагентов
			 |		ПО Расчеты.Договор = ДоговорыКонтрагентов.Ссылка
			 |			И (ДоговорыКонтрагентов.СтавкаДисконтирования > 0)  
			 |		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ОбъектыРасчетов КАК ОбъектыРасчетов
			 |		ПО (Расчеты.ОбъектРасчетов = ОбъектыРасчетов.Ссылка)
			 |		ЛЕВОЕ СОЕДИНЕНИЕ УчетнаяПолитикаОрганизаций КАК УчетнаяПолитикаОрганизаций
			 |		ПО Расчеты.Ссылка = УчетнаяПолитикаОрганизаций.Ссылка
			 |			И ОбъектыРасчетов.Организация = УчетнаяПолитикаОрганизаций.Организация
			 |			И НАЧАЛОПЕРИОДА(Расчеты.Период, ДЕНЬ) = УчетнаяПолитикаОрганизаций.ДатаОтражения
			 |			И УчетнаяПолитикаОрганизаций.ДолгосрочныеАктивыОбязательства
			 |ГДЕ
			 |	Расчеты.ДатаПлановогоПогашения > Расчеты.Период
			 |
			 |СГРУППИРОВАТЬ ПО
			 |	Расчеты.Ссылка,
			 |	Расчеты.Период,
			 |	Расчеты.ДнейДоПлановогоПогашения,
			 |	Расчеты.Организация,
			 |	Расчеты.ГруппаФинансовогоУчета,
			 |	Расчеты.Валюта,
			 |	Расчеты.Подразделение,
			 |	Расчеты.НаправлениеДеятельности,
			 |	Расчеты.Контрагент,
			 |	Расчеты.Договор,
			 |	ВЫБОР
			 |		КОГДА РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(Расчеты.Период, ДЕНЬ), Расчеты.ДатаПлановогоПогашения, МЕСЯЦ) >= ЕСТЬNULL(УчетнаяПолитикаОрганизаций.МесяцыДолгосрочнойЗадолженности, 999)
			 |			ТОГДА ИСТИНА
			 |		ИНАЧЕ ЛОЖЬ
			 |	КОНЕЦ
			 |
			 |ИНДЕКСИРОВАТЬ ПО
			 |	Ссылка";
			МассивТекстовВТ.Добавить(ТекстЗапросаВТ);
			
			ТекстЗапросаВТ = 
			 "ВЫБРАТЬ РАЗЛИЧНЫЕ
			 |	Расчеты.Ссылка КАК Ссылка,
			 |	Расчеты.Организация КАК Организация,
			 |	Расчеты.Период КАК Период,
			 |	Расчеты.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
			 |	Расчеты.Валюта КАК Валюта,
			 |	Расчеты.Подразделение КАК Подразделение,
			 |	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельности,
			 |	Расчеты.Контрагент КАК Контрагент,
			 |	Расчеты.Договор КАК Договор
			 |ПОМЕСТИТЬ РасчетыСПоставщикамиНоваяАрхитектураДетальноКраткосрочнаяЗадолженность
			 |ИЗ
			 |	РасчетыСПоставщикамиНоваяАрхитектураДетально КАК Расчеты
			 |ГДЕ
			 |	НЕ Расчеты.ДолгосрочнаяЗадолженность
			 |
			 |ИНДЕКСИРОВАТЬ ПО
			 |	Ссылка";
			МассивТекстовВТ.Добавить(ТекстЗапросаВТ);
			
			ТекстЗапросаВТ =
			"ВЫБРАТЬ
			 |	Расчеты.Ссылка КАК Ссылка,
			 |	СУММА(Расчеты.СуммаСводно) КАК СуммаСводно,
			 |	СУММА(Расчеты.СуммаСводноУпр) КАК СуммаСводноУпр,
			 |	СУММА(Расчеты.СуммаСводноРегл) КАК СуммаСводноРегл
			 |ПОМЕСТИТЬ ВТРасчетыСПоставщикамиСводно
			 |ИЗ
			 |	ВТРасчетыСПоставщикамиПодготовкаДанныхДляДолгосрочнойзадолженности КАК Расчеты
			 |
			 |СГРУППИРОВАТЬ ПО
			 |	Расчеты.Ссылка
			 |
			 |ИНДЕКСИРОВАТЬ ПО
			 |	Ссылка";
			МассивТекстовВТ.Добавить(ТекстЗапросаВТ);
			
			ТекстЗапроса =
			"ВЫБРАТЬ
			|	Расчеты.Ссылка КАК Ссылка,
			|	НАЧАЛОПЕРИОДА(Расчеты.Период, ДЕНЬ) КАК ДатаОтражения,
			|	Расчеты.Организация КАК Организация,
			|	Расчеты.ДолгосрочнаяЗадолженность КАК Долгосрочная,
			|	ВЫБОР
			|		КОГДА РасчетыКраткосрочные.Ссылка ЕСТЬ NULL
			|			ТОГДА ""Основной""
			|		ИНАЧЕ
			|			""Разделение""
			|	КОНЕЦ КАК ВариантПереноса,
			|	""Дт"" КАК ВидПроводкиДляПереноса,
			|
			|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПроцентыПоДисконтированию) КАК ВидСчета,
			|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчета,
			|	НЕОПРЕДЕЛЕНО КАК МестоУчета,
			|	Расчеты.Валюта КАК Валюта,
			|	Расчеты.Подразделение КАК Подразделение,
			|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельности,
			|
			|	Расчеты.Контрагент КАК Субконто1,
			|	Расчеты.Договор КАК Субконто2,
			|	НЕОПРЕДЕЛЕНО КАК Субконто3,
			|
			|	СУММА(ДанныеДисконта.СуммаДисконтирования * Расчеты.СуммаСводно / РасчетыИтого.СуммаСводно) КАК Сумма,
			|	СУММА(ДанныеДисконта.СуммаДисконтированияУпр * Расчеты.СуммаСводноУпр / РасчетыИтого.СуммаСводноУпр) КАК СуммаУпр,
			|	СУММА(ДанныеДисконта.СуммаДисконтированияРегл * Расчеты.СуммаСводноРегл / РасчетыИтого.СуммаСводноРегл) КАК СуммаРегл
			|ИЗ
			|	ДокументыКОтражению КАК ДокументыКОтражению
			|	
			|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.ПроцентныеРасходыДисконтирования КАК ДанныеДисконта
			|	ПО ДанныеДисконта.Регистратор = ДокументыКОтражению.Ссылка
			|		И НЕ ДанныеДисконта.Сторно
			|		
			|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТРасчетыСПоставщикамиСводно КАК РасчетыИтого
			|	ПО РасчетыИтого.Ссылка = ДанныеДисконта.Регистратор
			|		
			|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТРасчетыСПоставщикамиПодготовкаДанныхДляДолгосрочнойзадолженности КАК Расчеты
			|	ПО Расчеты.Ссылка = ДокументыКОтражению.Ссылка
			|
			|	ЛЕВОЕ СОЕДИНЕНИЕ РасчетыСПоставщикамиНоваяАрхитектураДетальноКраткосрочнаяЗадолженность КАК РасчетыКраткосрочные
			|	ПО Расчеты.Ссылка = РасчетыКраткосрочные.Ссылка
			|		И Расчеты.Организация = РасчетыКраткосрочные.Организация
			|		И Расчеты.Период = РасчетыКраткосрочные.Период
			|		И Расчеты.ГруппаФинансовогоУчета = РасчетыКраткосрочные.ГруппаФинансовогоУчета
			|		И Расчеты.Валюта = РасчетыКраткосрочные.Валюта
			|		И Расчеты.Подразделение = РасчетыКраткосрочные.Подразделение
			|		И Расчеты.НаправлениеДеятельности = РасчетыКраткосрочные.НаправлениеДеятельности
			|		И Расчеты.Контрагент = РасчетыКраткосрочные.Контрагент
			|		И Расчеты.Договор = РасчетыКраткосрочные.Договор
			|
			|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ДоговорыКонтрагентов КАК ДоговорыКонтрагентов
			|	ПО Расчеты.Договор = ДоговорыКонтрагентов.Ссылка
			|		И ДоговорыКонтрагентов.СтавкаДисконтирования > 0
			|ГДЕ
			|	Расчеты.ДолгосрочнаяЗадолженность
			|СГРУППИРОВАТЬ ПО
			|	Расчеты.Ссылка,
			|	НАЧАЛОПЕРИОДА(Расчеты.Период, ДЕНЬ),
			|	Расчеты.Организация,
			|	Расчеты.ДолгосрочнаяЗадолженность,
			|	ВЫБОР
			|		КОГДА РасчетыКраткосрочные.Ссылка ЕСТЬ NULL
			|			ТОГДА ""Основной""
			|		ИНАЧЕ
			|			""Разделение""
			|	КОНЕЦ,
			|	""Дт"",
			|
			|	Расчеты.ГруппаФинансовогоУчета,
			|	Расчеты.Валюта,
			|	Расчеты.Подразделение,
			|	Расчеты.НаправлениеДеятельности,
			|
			|	Расчеты.Контрагент,
			|	Расчеты.Договор";
			МассивТекстовЗапроса.Добавить(ТекстЗапроса);
			
			ТекстУничтоженияВТ = "
			|////////////////////////////////////////////////////////////////////////////////
			|УНИЧТОЖИТЬ ВТРасчетыСПоставщикамиСводно
			|;
			|
			|////////////////////////////////////////////////////////////////////////////////
			|УНИЧТОЖИТЬ ВТРасчетыСПоставщикамиПодготовкаДанныхДляДолгосрочнойзадолженности
			|;
			|
			|////////////////////////////////////////////////////////////////////////////////
			|УНИЧТОЖИТЬ РасчетыСПоставщикамиНоваяАрхитектураДетальноКраткосрочнаяЗадолженность";
			МассивТекстовУничтоженияВТ.Добавить(ТекстУничтоженияВТ);
			
			#КонецОбласти
			
		КонецЕсли;
		
		Если ДокументИмя = "ЗаключениеДоговораАренды" ИЛИ ДокументИмя = "ИзменениеУсловийДоговораАренды"
			ИЛИ ДокументИмя = "ВводОстатковВзаиморасчетовПоАренде" Тогда
			
			#Область ДолгосрочнаяЗадолженностьПоДоговорамАренды
			
			ТекстЗапросаВТ ="ВЫБРАТЬ
			|	Расчеты.Регистратор КАК Ссылка,
			|	Расчеты.Период КАК ДатаОтражения,
			|	Расчеты.Договор КАК Договор,
			|	Расчеты.Валюта,
			|	УчетнаяПолитикаОрганизаций.МесяцыДолгосрочнойЗадолженности
			|ПОМЕСТИТЬ ВтРасчетыПоАренде
			|ИЗ
			|	ДокументыКОтражению КАК ДокументыКОтражению
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.РасчетыПоФинансовымИнструментам КАК Расчеты
			|		ПО ДокументыКОтражению.Ссылка = Расчеты.Регистратор
			|		ЛЕВОЕ СОЕДИНЕНИЕ УчетнаяПолитикаОрганизаций КАК УчетнаяПолитикаОрганизаций
			|		ПО Расчеты.Регистратор = УчетнаяПолитикаОрганизаций.Ссылка
			|		И Расчеты.Договор.Организация = УчетнаяПолитикаОрганизаций.Организация
			|		И НАЧАЛОПЕРИОДА(Расчеты.Период, ДЕНЬ) = УчетнаяПолитикаОрганизаций.ДатаОтражения
			|ГДЕ
			|	Расчеты.ТипСуммы = ЗНАЧЕНИЕ(Перечисление.ТипыПлатежейПоАренде.АрендныеОбязательства)
			|	И Расчеты.Сумма > 0
			|	И ЕСТЬNULL(УчетнаяПолитикаОрганизаций.ДолгосрочныеАктивыОбязательства, ЛОЖЬ)
			|СГРУППИРОВАТЬ ПО
			|	Расчеты.Регистратор,
			|	Расчеты.Договор,
			|	Расчеты.Валюта,
			|	Расчеты.Период,
			|	УчетнаяПолитикаОрганизаций.МесяцыДолгосрочнойЗадолженности
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Договор,
			|	ДатаОтражения
			|;
			|
			|////////////////////////////////////////////////////////////////////////////////
			|ВЫБРАТЬ
			|	ВтРасчетыПоАренде.Договор КАК Договор,
			|	МИНИМУМ(УсловияДоговоровАрендыАктуальные.Период) КАК Период
			|ПОМЕСТИТЬ ВТПериодыУсловийДоговоровАктуальные
			|ИЗ
			|	ВтРасчетыПоАренде КАК ВтРасчетыПоАренде
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УсловияДоговоровАренды КАК УсловияДоговоровАрендыАктуальные
			|		ПО ВтРасчетыПоАренде.Договор = УсловияДоговоровАрендыАктуальные.Договор
			|ГДЕ
			|	УсловияДоговоровАрендыАктуальные.Период >= ВтРасчетыПоАренде.ДатаОтражения
			|СГРУППИРОВАТЬ ПО
			|	ВтРасчетыПоАренде.Договор
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Договор,
			|	Период
			|;
			|
			|////////////////////////////////////////////////////////////////////////////////
			|ВЫБРАТЬ
			|	ВтРасчетыПоАренде.Договор КАК Договор,
			|	МАКСИМУМ(УсловияДоговоровАрендыДо.Период) КАК Период
			|ПОМЕСТИТЬ ВТПериодыУсловийДоговоровДо
			|ИЗ
			|	ВтРасчетыПоАренде КАК ВтРасчетыПоАренде
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УсловияДоговоровАренды КАК УсловияДоговоровАрендыДо
			|		ПО ВтРасчетыПоАренде.Договор = УсловияДоговоровАрендыДо.Договор
			|ГДЕ
			|	УсловияДоговоровАрендыДо.Период < ВтРасчетыПоАренде.ДатаОтражения
			|СГРУППИРОВАТЬ ПО
			|	ВтРасчетыПоАренде.Договор
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Договор,
			|	Период
			|;
			|
			|////////////////////////////////////////////////////////////////////////////////
			|ВЫБРАТЬ
			|	ВТПериодыУсловийДоговоровАктуальные.Договор КАК Договор,
			|	УсловияДоговоровАрендыАктуальные.АктуальныеУсловияДоговора КАК АктуальныеУсловияДоговора
			|ПОМЕСТИТЬ УсловияДоговораАктуальные
			|ИЗ
			|	ВТПериодыУсловийДоговоровАктуальные КАК ВТПериодыУсловийДоговоровАктуальные
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УсловияДоговоровАренды КАК УсловияДоговоровАрендыАктуальные
			|		ПО ВТПериодыУсловийДоговоровАктуальные.Договор = УсловияДоговоровАрендыАктуальные.Договор
			|		И ВТПериодыУсловийДоговоровАктуальные.Период = УсловияДоговоровАрендыАктуальные.Период
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Договор,
			|	АктуальныеУсловияДоговора
			|;
			|
			|////////////////////////////////////////////////////////////////////////////////
			|ВЫБРАТЬ
			|	ВТПериодыУсловийДоговоровДо.Договор КАК Договор,
			|	УсловияДоговоровАренды.АктуальныеУсловияДоговора КАК АктуальныеУсловияДоговора
			|ПОМЕСТИТЬ УсловияДоговораДо
			|ИЗ
			|	ВТПериодыУсловийДоговоровДо КАК ВТПериодыУсловийДоговоровДо
			|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УсловияДоговоровАренды КАК УсловияДоговоровАренды
			|		ПО ВТПериодыУсловийДоговоровДо.Договор = УсловияДоговоровАренды.Договор
			|		И ВТПериодыУсловийДоговоровДо.Период = УсловияДоговоровАренды.Период
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Договор,
			|	АктуальныеУсловияДоговора
			|;
			|
			|////////////////////////////////////////////////////////////////////////////////
			|УНИЧТОЖИТЬ ВТПериодыУсловийДоговоровАктуальные
			|;
			|
			|////////////////////////////////////////////////////////////////////////////////
			|УНИЧТОЖИТЬ ВТПериодыУсловийДоговоровДо
			|;
			|
			|////////////////////////////////////////////////////////////////////////////////
			|ВЫБРАТЬ
			|	СУММА(ГрафикНачисленияПроцентовПоАренде.Проценты) КАК Проценты,
			|	ГрафикНачисленияПроцентовПоАренде.Договор КАК Договор
			|ПОМЕСТИТЬ ВтПроценты
			|ИЗ
			|	ВтРасчетыПоАренде КАК ВтРасчетыПоАренде
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ УсловияДоговораАктуальные КАК УсловияДоговораАктуальные
			|		ПО ВтРасчетыПоАренде.Договор = УсловияДоговораАктуальные.Договор
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикНачисленияПроцентовПоАренде КАК ГрафикНачисленияПроцентовПоАренде
			|		ПО ВтРасчетыПоАренде.Договор = УсловияДоговораАктуальные.Договор
			|		И ГрафикНачисленияПроцентовПоАренде.АктуальныеУсловияДоговора = УсловияДоговораАктуальные.АктуальныеУсловияДоговора
			|		И РАЗНОСТЬДАТ(ВтРасчетыПоАренде.ДатаОтражения, ГрафикНачисленияПроцентовПоАренде.Дата,
			|			Месяц) >= ВтРасчетыПоАренде.МесяцыДолгосрочнойЗадолженности
			|СГРУППИРОВАТЬ ПО
			|	ГрафикНачисленияПроцентовПоАренде.Договор
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Договор
			|;
			|
			|////////////////////////////////////////////////////////////////////////////////
			|ВЫБРАТЬ
			|	СУММА(ГрафикНачисленияПроцентовПоАренде.Проценты) КАК Проценты,
			|	ГрафикНачисленияПроцентовПоАренде.Договор КАК Договор
			|ПОМЕСТИТЬ ВТПроцентыДо
			|ИЗ
			|	ВтРасчетыПоАренде КАК ВтРасчетыПоАренде
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ УсловияДоговораДо КАК УсловияДоговораДо
			|		ПО ВтРасчетыПоАренде.Договор = УсловияДоговораДо.Договор
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикНачисленияПроцентовПоАренде КАК ГрафикНачисленияПроцентовПоАренде
			|		ПО ВтРасчетыПоАренде.Договор = УсловияДоговораДо.Договор
			|		И ГрафикНачисленияПроцентовПоАренде.АктуальныеУсловияДоговора = УсловияДоговораДо.АктуальныеУсловияДоговора
			|		И РАЗНОСТЬДАТ(ВтРасчетыПоАренде.ДатаОтражения, ГрафикНачисленияПроцентовПоАренде.Дата,
			|			Месяц) >= ВтРасчетыПоАренде.МесяцыДолгосрочнойЗадолженности
			|СГРУППИРОВАТЬ ПО
			|	ГрафикНачисленияПроцентовПоАренде.Договор
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Договор
			|;
			|
			|////////////////////////////////////////////////////////////////////////////////
			|ВЫБРАТЬ
			|	ГрафикОплатУслугПоАренде.Договор КАК Договор,
			|	СУММА(ГрафикОплатУслугПоАренде.УслугаПоАренде - ГрафикОплатУслугПоАренде.УслугаПоАрендеНДС) КАК УслугаПоАренде
			|ПОМЕСТИТЬ ВтУслугиПоАренде
			|ИЗ
			|	ВтРасчетыПоАренде КАК ВтРасчетыПоАренде
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ УсловияДоговораАктуальные КАК УсловияДоговораАктуальные
			|		ПО ВтРасчетыПоАренде.Договор = УсловияДоговораАктуальные.Договор
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикОплатУслугПоАренде КАК ГрафикОплатУслугПоАренде
			|		ПО ВтРасчетыПоАренде.Договор = ГрафикОплатУслугПоАренде.Договор
			|		И ГрафикОплатУслугПоАренде.АктуальныеУсловияДоговора = УсловияДоговораАктуальные.АктуальныеУсловияДоговора
			|		И РАЗНОСТЬДАТ(ВтРасчетыПоАренде.ДатаОтражения, ГрафикОплатУслугПоАренде.Дата,
			|			Месяц) >= ВтРасчетыПоАренде.МесяцыДолгосрочнойЗадолженности
			|СГРУППИРОВАТЬ ПО
			|	ГрафикОплатУслугПоАренде.Договор
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Договор
			|;
			|
			|////////////////////////////////////////////////////////////////////////////////
			|ВЫБРАТЬ
			|	ГрафикОплатУслугПоАренде.Договор КАК Договор,
			|	СУММА(ГрафикОплатУслугПоАренде.УслугаПоАренде - ГрафикОплатУслугПоАренде.УслугаПоАрендеНДС) КАК УслугаПоАренде
			|ПОМЕСТИТЬ ВтУслугиПоАрендеДо
			|ИЗ
			|	ВтРасчетыПоАренде КАК ВтРасчетыПоАренде
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ УсловияДоговораДо КАК УсловияДоговораДо
			|		ПО ВтРасчетыПоАренде.Договор = УсловияДоговораДо.Договор
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГрафикОплатУслугПоАренде КАК ГрафикОплатУслугПоАренде
			|		ПО ВтРасчетыПоАренде.Договор = ГрафикОплатУслугПоАренде.Договор
			|		И ГрафикОплатУслугПоАренде.АктуальныеУсловияДоговора = УсловияДоговораДо.АктуальныеУсловияДоговора
			|		И РАЗНОСТЬДАТ(ВтРасчетыПоАренде.ДатаОтражения, ГрафикОплатУслугПоАренде.Дата,
			|			Месяц) >= ВтРасчетыПоАренде.МесяцыДолгосрочнойЗадолженности
			|СГРУППИРОВАТЬ ПО
			|	ГрафикОплатУслугПоАренде.Договор
			|
			|ИНДЕКСИРОВАТЬ ПО
			|	Договор";
			МассивТекстовВТ.Добавить(ТекстЗапросаВТ);
			
			ТекстЗапроса = "ВЫБРАТЬ
			|	ВтРасчетыПоАренде.Ссылка КАК Ссылка,
			|	НАЧАЛОПЕРИОДА(ВтРасчетыПоАренде.ДатаОтражения, ДЕНЬ) КАК ДатаОтражения,
			|	ВтРасчетыПоАренде.Договор.Организация КАК Организация,
			|	ИСТИНА КАК Долгосрочная,
			|	""ЧерезКраткосрочныйСчет"" КАК ВариантПереноса,
			|	""Кт"" КАК ВидПроводкиДляПереноса,
			|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АрендныеОбязательства) КАК ВидСчета,
			|	ВтРасчетыПоАренде.Договор.ГруппаФинансовогоУчета КАК АналитикаУчета,
			|	НЕОПРЕДЕЛЕНО КАК МестоУчета,
			|	ВтРасчетыПоАренде.Валюта КАК Валюта,
			|	ВтРасчетыПоАренде.Договор.Подразделение КАК Подразделение,
			|	ВтРасчетыПоАренде.Договор.НаправлениеДеятельности КАК НаправлениеДеятельности,
			|	ВтРасчетыПоАренде.Договор.Контрагент КАК Субконто1,
			|	ВтРасчетыПоАренде.Договор КАК Субконто2,
			|	НЕОПРЕДЕЛЕНО КАК Субконто3,
			|	ЕСТЬNULL(ВтУслугиПоАренде.УслугаПоАренде, 0) - ЕСТЬNULL(ВтПроценты.Проценты, 0)
			|		- (ЕСТЬNULL(ВтУслугиПоАрендеДо.УслугаПоАренде, 0) - ЕСТЬNULL(ВтПроцентыДо.Проценты, 0)) КАК Сумма,
			|	ВЫБОР
			|		КОГДА ВтРасчетыПоАренде.Договор.УчитыватьПредметыАрендыВУпрУчете
			|			ТОГДА ВЫБОР
			|				КОГДА ВтРасчетыПоАренде.Валюта = &ВалютаУпрУчета
			|					ТОГДА ЕСТЬNULL(ВтУслугиПоАренде.УслугаПоАренде, 0) - ЕСТЬNULL(ВтПроценты.Проценты, 0)
			|							- (ЕСТЬNULL(ВтУслугиПоАрендеДо.УслугаПоАренде, 0) - ЕСТЬNULL(ВтПроцентыДо.Проценты, 0))
			|				КОГДА КурсыВалютУпр.Курс ЕСТЬ NULL
			|					ТОГДА 0
			|				КОГДА КурсыВалют.Курс ЕСТЬ NULL
			|					ТОГДА 0
			|				ИНАЧЕ ВЫРАЗИТЬ(ЕСТЬNULL(ВтУслугиПоАренде.УслугаПоАренде, 0) - ЕСТЬNULL(ВтПроценты.Проценты, 0)
			|						- (ЕСТЬNULL(ВтУслугиПоАрендеДо.УслугаПоАренде, 0) - ЕСТЬNULL(ВтПроцентыДо.Проценты, 0))
			|						* КурсыВалют.Курс / КурсыВалютУпр.Курс КАК ЧИСЛО(31, 2))
			|			КОНЕЦ
			|		ИНАЧЕ 0
			|	КОНЕЦ КАК СуммаУпр,
			|	ВЫБОР
			|		КОГДА ВтРасчетыПоАренде.Договор.УчитыватьПредметыАрендыВРеглУчете
			|			ТОГДА ВЫБОР
			|				КОГДА ВтРасчетыПоАренде.Валюта = &ВалютаРеглУчета
			|					ТОГДА ЕСТЬNULL(ВтУслугиПоАренде.УслугаПоАренде, 0) - ЕСТЬNULL(ВтПроценты.Проценты, 0)
			|						 - (ЕСТЬNULL(ВтУслугиПоАрендеДо.УслугаПоАренде, 0) - ЕСТЬNULL(ВтПроцентыДо.Проценты, 0))
			|				КОГДА КурсыВалют.Курс ЕСТЬ NULL
			|					ТОГДА 0
			|				ИНАЧЕ ВЫРАЗИТЬ((ЕСТЬNULL(ВтУслугиПоАренде.УслугаПоАренде, 0) - ЕСТЬNULL(ВтПроценты.Проценты, 0)
			|					-(ЕСТЬNULL(ВтУслугиПоАрендеДо.УслугаПоАренде, 0) - ЕСТЬNULL(ВтПроцентыДо.Проценты, 0)))
			|					* КурсыВалют.Курс КАК ЧИСЛО(31, 2))
			|			КОНЕЦ
			|		Иначе 0
			|	конец КАК СуммаРегл
			|ИЗ
			|	ВтРасчетыПоАренде КАК ВтРасчетыПоАренде
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВтУслугиПоАренде КАК ВтУслугиПоАренде
			|		ПО ВтРасчетыПоАренде.Договор = ВтУслугиПоАренде.Договор
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВтУслугиПоАрендеДо КАК ВтУслугиПоАрендеДо
			|		ПО ВтРасчетыПоАренде.Договор = ВтУслугиПоАрендеДо.Договор
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВТПроцентыДо КАК ВТПроцентыДо
			|		ПО ВтРасчетыПоАренде.Договор = ВтПроцентыДо.Договор
			|		ЛЕВОЕ СОЕДИНЕНИЕ ВтПроценты КАК ВтПроценты
			|		ПО ВтРасчетыПоАренде.Договор = ВтПроценты.Договор
			|		ЛЕВОЕ СОЕДИНЕНИЕ КурсыВалют КАК КурсыВалют
			|		ПО ВтРасчетыПоАренде.Валюта = КурсыВалют.Валюта
			|		И КурсыВалют.Дата = НАЧАЛОПЕРИОДА(ВтРасчетыПоАренде.ДатаОтражения, ДЕНЬ)
			|		ЛЕВОЕ СОЕДИНЕНИЕ КурсыВалют КАК КурсыВалютУпр
			|		ПО КурсыВалютУпр.Валюта = &ВалютаУпрУчета
			|		И КурсыВалютУпр.Дата = НАЧАЛОПЕРИОДА(ВтРасчетыПоАренде.ДатаОтражения, ДЕНЬ)";
			МассивТекстовЗапроса.Добавить(ТекстЗапроса);
			
			ТекстУничтоженияВТ = "
			|////////////////////////////////////////////////////////////////////////////////
			|УНИЧТОЖИТЬ ВтРасчетыПоАренде
			|;
			|
			|////////////////////////////////////////////////////////////////////////////////
			|УНИЧТОЖИТЬ УсловияДоговораАктуальные
			|;
			|
			|////////////////////////////////////////////////////////////////////////////////
			|УНИЧТОЖИТЬ УсловияДоговораДо
			|;
			|
			|////////////////////////////////////////////////////////////////////////////////
			|УНИЧТОЖИТЬ ВтПроценты
			|;
			|
			|////////////////////////////////////////////////////////////////////////////////
			|УНИЧТОЖИТЬ ВтПроцентыДо
			|;
			|
			|////////////////////////////////////////////////////////////////////////////////
			|УНИЧТОЖИТЬ ВтУслугиПоАренде
			|;
			|
			|////////////////////////////////////////////////////////////////////////////////
			|УНИЧТОЖИТЬ ВтУслугиПоАрендеДо";
			МассивТекстовУничтоженияВТ.Добавить(ТекстУничтоженияВТ);
			
			#КонецОбласти
		КонецЕсли;
	КонецЕсли;
	
	ТекстЗапроса = СтрСоединить(МассивТекстовЗапроса, ОбщегоНазначенияУТ.РазделительЗапросовВОбъединении());
	
	МассивТекстовЗапроса = МассивТекстовВТ;
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	ОбщегоНазначенияКлиентСервер.ДополнитьМассив(МассивТекстовЗапроса, МассивТекстовУничтоженияВТ);
	МассивТекстовЗапроса.Добавить("");
	
	ТекстЗапроса = СтрСоединить(МассивТекстовЗапроса, ОбщегоНазначения.РазделительПакетаЗапросов());
	
	Возврат ТекстЗапроса;
		
КонецФункции

Функция ТекстНастройкиСтатейРасходов()
	Возврат
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	СтатьиРасходов.Ссылка КАК СтатьяРасходов,
	|	СтатьиРасходов.ГруппаФинансовогоУчета <> СтатьиРасходов.ГруппаФинансовогоУчетаРегл КАК РаздельноеОтражение_УУ,
	|	СтатьиРасходов.ГруппаФинансовогоУчетаРегл <> СтатьиРасходов.ГруппаФинансовогоУчетаНУ КАК РаздельноеОтражение_НУ,
	|	СтатьиРасходов.ГруппаФинансовогоУчета КАК ГФУ_УУ,
	|	СтатьиРасходов.ГруппаФинансовогоУчетаРегл КАК ГФУ_БУ,
	|	СтатьиРасходов.ГруппаФинансовогоУчетаНУ КАК ГФУ_НУ
	|ПОМЕСТИТЬ НастройкиСтатейРасходов
	|ИЗ
	|	ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиРасходов
	|ГДЕ
	|	НЕ СтатьиРасходов.ЭтоГруппа
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	СтатьяРасходов;
	|
	|";
КонецФункции

Функция ТекстВтВосстановлениеРасчетовПоСторно()
	
	МассивВтВосстановлениеРасчетовПоСторно = Новый Массив;
	
	#Область РасчетыСКлиентами
	ТекстВосстановлениеРасчетовСКлиентамиПоСторно = 
	"ВЫБРАТЬ
	|	ВременнаяТаблица.Ссылка КАК Ссылка,
	|	ВременнаяТаблица.Организация КАК Организация,
	|	ВременнаяТаблица.ОбъектРасчетов КАК ОбъектРасчетов,
	|	ВременнаяТаблица.Валюта КАК Валюта,
	|	СУММА(ВременнаяТаблица.Долг) КАК Долг,
	|	СУММА(ВременнаяТаблица.ДолгРегл) КАК ДолгРегл,
	|	СУММА(ВременнаяТаблица.ДолгУпр) КАК ДолгУпр,
	|	СУММА(ВременнаяТаблица.Предоплата) КАК Предоплата,
	|	СУММА(ВременнаяТаблица.ПредоплатаРегл) КАК ПредоплатаРегл,
	|	СУММА(ВременнаяТаблица.ПредоплатаУпр) КАК ПредоплатаУпр
	|ПОМЕСТИТЬ ВтВосстановлениеРасчетовСКлиентамиПоСторно
	|ИЗ
	|	(ВЫБРАТЬ
	|		РазрезыКОтражению.Ссылка КАК Ссылка,
	|		РасчетыСКлиентамиПоСрокам.АналитикаУчетаПоПартнерам.Организация КАК Организация,
	|		РасчетыСКлиентамиПоСрокам.ОбъектРасчетов КАК ОбъектРасчетов,
	|		РасчетыСКлиентамиПоСрокам.Валюта КАК Валюта,
	|		-ВЫБОР
	|			КОГДА РасчетыСКлиентамиПоСрокам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|				ТОГДА -РасчетыСКлиентамиПоСрокам.Долг 
	|			ИНАЧЕ РасчетыСКлиентамиПоСрокам.Долг 
	|		КОНЕЦ КАК Долг,
	|		-ВЫБОР
	|			КОГДА РасчетыСКлиентамиПоСрокам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|				ТОГДА -РасчетыСКлиентамиПоСрокам.ДолгРегл 
	|			ИНАЧЕ РасчетыСКлиентамиПоСрокам.ДолгРегл 
	|		КОНЕЦ КАК ДолгРегл,
	|		-ВЫБОР
	|			КОГДА РасчетыСКлиентамиПоСрокам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|				ТОГДА -РасчетыСКлиентамиПоСрокам.ДолгУпр 
	|			ИНАЧЕ РасчетыСКлиентамиПоСрокам.ДолгУпр 
	|		КОНЕЦ КАК ДолгУпр,
	|		-ВЫБОР
	|			КОГДА РасчетыСКлиентамиПоСрокам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|				ТОГДА -РасчетыСКлиентамиПоСрокам.Предоплата 
	|			ИНАЧЕ РасчетыСКлиентамиПоСрокам.Предоплата 
	|		КОНЕЦ КАК Предоплата,
	|		-ВЫБОР
	|			КОГДА РасчетыСКлиентамиПоСрокам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|				ТОГДА -РасчетыСКлиентамиПоСрокам.ПредоплатаРегл 
	|			ИНАЧЕ РасчетыСКлиентамиПоСрокам.ПредоплатаРегл 
	|		КОНЕЦ КАК ПредоплатаРегл,
	|		-ВЫБОР
	|			КОГДА РасчетыСКлиентамиПоСрокам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|				ТОГДА -РасчетыСКлиентамиПоСрокам.ПредоплатаРегл 
	|			ИНАЧЕ РасчетыСКлиентамиПоСрокам.ПредоплатаУпр 
	|		КОНЕЦ КАК ПредоплатаУпр
	|	ИЗ
	|		РазрезыКОтражению КАК РазрезыКОтражению
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|			РегистрСведений.РеестрДокументов КАК РеестрДокументов
	|		ПО
	|			РазрезыКОтражению.Ссылка = РеестрДокументов.Ссылка
	|			И РеестрДокументов.СторноИсправление
	|			И НЕ РеестрДокументов.ДополнительнаяЗапись
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|			РегистрНакопления.РасчетыСКлиентамиПоСрокам КАК РасчетыСКлиентамиПоСрокам
	|		ПО
	|			РеестрДокументов.СторнируемыйДокумент = РасчетыСКлиентамиПоСрокам.ДокументРегистратор
	|			И РазрезыКОтражению.Организация = РасчетыСКлиентамиПоСрокам.АналитикаУчетаПоПартнерам.Организация
	|			И НЕ РасчетыСКлиентамиПоСрокам.Сторно
	|
	|	ОБЪЕДИНИТЬ ВСЕ
	|
	|	ВЫБРАТЬ
	|		РазрезыКОтражению.Ссылка КАК Ссылка,
	|		РасчетыСКлиентамиПоСрокам.АналитикаУчетаПоПартнерам.Организация КАК Организация,
	|		РасчетыСКлиентамиПоСрокам.ОбъектРасчетов КАК ОбъектРасчетов,
	|		РасчетыСКлиентамиПоСрокам.Валюта КАК Валюта,
	|		ВЫБОР
	|			КОГДА РасчетыСКлиентамиПоСрокам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|				ТОГДА -РасчетыСКлиентамиПоСрокам.Долг 
	|			ИНАЧЕ РасчетыСКлиентамиПоСрокам.Долг 
	|		КОНЕЦ КАК Долг,
	|		ВЫБОР
	|			КОГДА РасчетыСКлиентамиПоСрокам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|				ТОГДА -РасчетыСКлиентамиПоСрокам.ДолгРегл 
	|			ИНАЧЕ РасчетыСКлиентамиПоСрокам.ДолгРегл 
	|		КОНЕЦ КАК ДолгРегл,
	|		ВЫБОР
	|			КОГДА РасчетыСКлиентамиПоСрокам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|				ТОГДА -РасчетыСКлиентамиПоСрокам.ДолгУпр 
	|			ИНАЧЕ РасчетыСКлиентамиПоСрокам.ДолгУпр 
	|		КОНЕЦ КАК ДолгУпр,
	|		ВЫБОР
	|			КОГДА РасчетыСКлиентамиПоСрокам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|				ТОГДА -РасчетыСКлиентамиПоСрокам.Предоплата 
	|			ИНАЧЕ РасчетыСКлиентамиПоСрокам.Предоплата 
	|		КОНЕЦ КАК Предоплата,
	|		ВЫБОР
	|			КОГДА РасчетыСКлиентамиПоСрокам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|				ТОГДА -РасчетыСКлиентамиПоСрокам.ПредоплатаРегл 
	|			ИНАЧЕ РасчетыСКлиентамиПоСрокам.ПредоплатаРегл 
	|		КОНЕЦ КАК ПредоплатаРегл,
	|		ВЫБОР
	|			КОГДА РасчетыСКлиентамиПоСрокам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|				ТОГДА -РасчетыСКлиентамиПоСрокам.ПредоплатаРегл 
	|			ИНАЧЕ РасчетыСКлиентамиПоСрокам.ПредоплатаУпр 
	|		КОНЕЦ КАК ПредоплатаУпр
	|	ИЗ
	|		РазрезыКОтражению КАК РазрезыКОтражению
	|			
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|			РегистрНакопления.РасчетыСКлиентамиПоСрокам КАК РасчетыСКлиентамиПоСрокам
	|		ПО
	|			РазрезыКОтражению.Ссылка = РасчетыСКлиентамиПоСрокам.ДокументРегистратор
	|			И РазрезыКОтражению.Организация = РасчетыСКлиентамиПоСрокам.АналитикаУчетаПоПартнерам.Организация
	|			И РасчетыСКлиентамиПоСрокам.Сторно) КАК ВременнаяТаблица
	|
	|СГРУППИРОВАТЬ ПО
	|	ВременнаяТаблица.Ссылка,
	|	ВременнаяТаблица.Организация,
	|	ВременнаяТаблица.ОбъектРасчетов,
	|   ВременнаяТаблица.Валюта
	|
	|ИМЕЮЩИЕ
	|	СУММА(ВременнаяТаблица.Предоплата) <> 0 И СУММА(ВременнаяТаблица.Долг) <> 0
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка
	|";
	МассивВтВосстановлениеРасчетовПоСторно.Добавить(ТекстВосстановлениеРасчетовСКлиентамиПоСторно);
	#КонецОбласти
	
	#Область РасчетыСПоставщиками
	ТекстВосстановлениеРасчетовСПоставщикамиПоСторно = 
	"ВЫБРАТЬ
	|	ВременнаяТаблица.Ссылка КАК Ссылка,
	|	ВременнаяТаблица.Организация КАК Организация,
	|	ВременнаяТаблица.ОбъектРасчетов КАК ОбъектРасчетов,
	|	ВременнаяТаблица.Валюта КАК Валюта,
	|	СУММА(ВременнаяТаблица.Долг) КАК Долг,
	|	СУММА(ВременнаяТаблица.ДолгРегл) КАК ДолгРегл,
	|	СУММА(ВременнаяТаблица.ДолгУпр) КАК ДолгУпр,
	|	СУММА(ВременнаяТаблица.Предоплата) КАК Предоплата,
	|	СУММА(ВременнаяТаблица.ПредоплатаРегл) КАК ПредоплатаРегл,
	|	СУММА(ВременнаяТаблица.ПредоплатаУпр) КАК ПредоплатаУпр
	|ПОМЕСТИТЬ ВтВосстановлениеРасчетовСПоставщикамиПоСторно
	|ИЗ
	|	(ВЫБРАТЬ
	|		РазрезыКОтражению.Ссылка КАК Ссылка,
	|		РасчетыСПоставщикамиПоСрокам.АналитикаУчетаПоПартнерам.Организация КАК Организация,
	|		РасчетыСПоставщикамиПоСрокам.ОбъектРасчетов КАК ОбъектРасчетов,
	|		РасчетыСПоставщикамиПоСрокам.Валюта КАК Валюта,
	|		-ВЫБОР
	|			КОГДА РасчетыСПоставщикамиПоСрокам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|				ТОГДА -РасчетыСПоставщикамиПоСрокам.Долг 
	|			ИНАЧЕ РасчетыСПоставщикамиПоСрокам.Долг 
	|		КОНЕЦ КАК Долг,
	|		-ВЫБОР
	|			КОГДА РасчетыСПоставщикамиПоСрокам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|				ТОГДА -РасчетыСПоставщикамиПоСрокам.ДолгРегл 
	|			ИНАЧЕ РасчетыСПоставщикамиПоСрокам.ДолгРегл 
	|		КОНЕЦ КАК ДолгРегл,
	|		-ВЫБОР
	|			КОГДА РасчетыСПоставщикамиПоСрокам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|				ТОГДА -РасчетыСПоставщикамиПоСрокам.ДолгУпр 
	|			ИНАЧЕ РасчетыСПоставщикамиПоСрокам.ДолгУпр 
	|		КОНЕЦ КАК ДолгУпр,
	|		-ВЫБОР
	|			КОГДА РасчетыСПоставщикамиПоСрокам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|				ТОГДА -РасчетыСПоставщикамиПоСрокам.Предоплата 
	|			ИНАЧЕ РасчетыСПоставщикамиПоСрокам.Предоплата 
	|		КОНЕЦ КАК Предоплата,
	|		-ВЫБОР
	|			КОГДА РасчетыСПоставщикамиПоСрокам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|				ТОГДА -РасчетыСПоставщикамиПоСрокам.ПредоплатаРегл 
	|			ИНАЧЕ РасчетыСПоставщикамиПоСрокам.ПредоплатаРегл 
	|		КОНЕЦ КАК ПредоплатаРегл,
	|		-ВЫБОР
	|			КОГДА РасчетыСПоставщикамиПоСрокам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|				ТОГДА -РасчетыСПоставщикамиПоСрокам.ПредоплатаРегл 
	|			ИНАЧЕ РасчетыСПоставщикамиПоСрокам.ПредоплатаУпр 
	|		КОНЕЦ КАК ПредоплатаУпр
	|	ИЗ
	|		РазрезыКОтражению КАК РазрезыКОтражению
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|			РегистрСведений.РеестрДокументов КАК РеестрДокументов
	|		ПО
	|			РазрезыКОтражению.Ссылка = РеестрДокументов.Ссылка
	|			И РеестрДокументов.СторноИсправление
	|			И НЕ РеестрДокументов.ДополнительнаяЗапись
	|
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|			РегистрНакопления.РасчетыСПоставщикамиПоСрокам КАК РасчетыСПоставщикамиПоСрокам
	|		ПО
	|			РеестрДокументов.СторнируемыйДокумент = РасчетыСПоставщикамиПоСрокам.ДокументРегистратор
	|			И РазрезыКОтражению.Организация = РасчетыСПоставщикамиПоСрокам.АналитикаУчетаПоПартнерам.Организация
	|			И НЕ РасчетыСПоставщикамиПоСрокам.Сторно
	|
	|	ОБЪЕДИНИТЬ ВСЕ
	|
	|	ВЫБРАТЬ
	|		РазрезыКОтражению.Ссылка КАК Ссылка,
	|		РасчетыСПоставщикамиПоСрокам.АналитикаУчетаПоПартнерам.Организация КАК Организация,
	|		РасчетыСПоставщикамиПоСрокам.ОбъектРасчетов КАК ОбъектРасчетов,
	|		РасчетыСПоставщикамиПоСрокам.Валюта КАК Валюта,
	|		ВЫБОР
	|			КОГДА РасчетыСПоставщикамиПоСрокам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|				ТОГДА -РасчетыСПоставщикамиПоСрокам.Долг 
	|			ИНАЧЕ РасчетыСПоставщикамиПоСрокам.Долг 
	|		КОНЕЦ КАК Долг,
	|		ВЫБОР
	|			КОГДА РасчетыСПоставщикамиПоСрокам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|				ТОГДА -РасчетыСПоставщикамиПоСрокам.ДолгРегл 
	|			ИНАЧЕ РасчетыСПоставщикамиПоСрокам.ДолгРегл 
	|		КОНЕЦ КАК ДолгРегл,
	|		ВЫБОР
	|			КОГДА РасчетыСПоставщикамиПоСрокам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|				ТОГДА -РасчетыСПоставщикамиПоСрокам.ДолгУпр 
	|			ИНАЧЕ РасчетыСПоставщикамиПоСрокам.ДолгУпр 
	|		КОНЕЦ КАК ДолгУпр,
	|		ВЫБОР
	|			КОГДА РасчетыСПоставщикамиПоСрокам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|				ТОГДА -РасчетыСПоставщикамиПоСрокам.Предоплата 
	|			ИНАЧЕ РасчетыСПоставщикамиПоСрокам.Предоплата 
	|		КОНЕЦ КАК Предоплата,
	|		ВЫБОР
	|			КОГДА РасчетыСПоставщикамиПоСрокам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|				ТОГДА -РасчетыСПоставщикамиПоСрокам.ПредоплатаРегл 
	|			ИНАЧЕ РасчетыСПоставщикамиПоСрокам.ПредоплатаРегл 
	|		КОНЕЦ КАК ПредоплатаРегл,
	|		ВЫБОР
	|			КОГДА РасчетыСПоставщикамиПоСрокам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|				ТОГДА -РасчетыСПоставщикамиПоСрокам.ПредоплатаРегл 
	|			ИНАЧЕ РасчетыСПоставщикамиПоСрокам.ПредоплатаУпр 
	|		КОНЕЦ КАК ПредоплатаУпр
	|	ИЗ
	|		РазрезыКОтражению КАК РазрезыКОтражению
	|			
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|			РегистрНакопления.РасчетыСПоставщикамиПоСрокам КАК РасчетыСПоставщикамиПоСрокам
	|		ПО
	|			РазрезыКОтражению.Ссылка = РасчетыСПоставщикамиПоСрокам.ДокументРегистратор
	|			И РазрезыКОтражению.Организация = РасчетыСПоставщикамиПоСрокам.АналитикаУчетаПоПартнерам.Организация
	|			И РасчетыСПоставщикамиПоСрокам.Сторно) КАК ВременнаяТаблица
	|
	|СГРУППИРОВАТЬ ПО
	|	ВременнаяТаблица.Ссылка,
	|	ВременнаяТаблица.Организация,
	|	ВременнаяТаблица.ОбъектРасчетов,
	|	ВременнаяТаблица.Валюта
	|
	|ИМЕЮЩИЕ
	|	СУММА(ВременнаяТаблица.Предоплата) <> 0 И СУММА(ВременнаяТаблица.Долг) <> 0
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка
	|";
	МассивВтВосстановлениеРасчетовПоСторно.Добавить(ТекстВосстановлениеРасчетовСПоставщикамиПоСторно);
	#КонецОбласти
	
	Возврат СтрСоединить(МассивВтВосстановлениеРасчетовПоСторно, ОбщегоНазначения.РазделительПакетаЗапросов()) + ОбщегоНазначения.РазделительПакетаЗапросов();
	
КонецФункции

Функция ТекстРаздельныйУчетНастройкиНалогообложенияПрибыли()
	
	Если Не ПолучитьФункциональнуюОпцию("РаздельныйУчетПоНалогуНаПрибыль") Тогда
		Возврат 
			"ВЫБРАТЬ
			|	NULL КАК Организация,
			|	NULL КАК Период,
			|	NULL КАК Подразделение,
			|	NULL КАК ОбъектУчета,
			|	NULL КАК НаправлениеДеятельности,
			|	NULL КАК ВариантНалогообложенияПрибыли
			|
			|ПОМЕСТИТЬ РаздельныйУчетНастройкиНалогообложенияПрибыли
			|
			|;";
	КонецЕсли;
	
	ТекстыЗапроса = Новый Массив;

	#Область ВТПолученияНалогообложенияПрибыли
	ТекстЗапроса = 
	"ВЫБРАТЬ // Отклонения в себестоимости реализации
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	Строки.Подразделение КАК Подразделение,
	|	АналитикаУчетаПоПартнерам.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	Аналитика.Номенклатура КАК Номенклатура
	|ПОМЕСТИТЬ ВТПолученияНалогообложенияПрибыли
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.СебестоимостьТоваров КАК Строки
	|	ПО
	|		ДокументыКОтражению.Ссылка = Строки.Регистратор
	|		И Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И Строки.Активность
	|		И НЕ Строки.РасчетСебестоимости
	|		И Строки.РасчетПартий
	|		И (Строки.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимости) 
	|			ИЛИ Строки.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.КорректировкаПриобретенияПрошлогоПериода)
	|			ИЛИ Строки.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.РаспределениеПоВыбывшимТоварам))
	|		И Строки.Количество = 0
	|		И (Строки.ДопРасходыРегл <> 0 ИЛИ Строки.ДопРасходыУпр <> 0)
	|		И Строки.СтатьяРасходовСписания = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)  
	|		И Строки.АналитикаУчетаПоПартнерам <> ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПоПартнерам.ПустаяСсылка)
	|		И НЕ Строки.Сторно
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Справочник.КлючиАналитикиУчетаНоменклатуры КАК Аналитика
	|	ПО
	|		Строки.АналитикаУчетаНоменклатуры = Аналитика.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		УчетнаяПолитикаОрганизаций КАК УчетнаяПолитикаОрганизаций
	|	ПО 
	|		УчетнаяПолитикаОрганизаций.Ссылка = ДокументыКОтражению.Ссылка
	|		И УчетнаяПолитикаОрганизаций.Организация = Строки.Организация
	|		И УчетнаяПолитикаОрганизаций.ДатаОтражения = НАЧАЛОПЕРИОДА(Строки.Период, ДЕНЬ)
	|		И УчетнаяПолитикаОрганизаций.РаздельныйУчетПоНалогуНаПрибыль
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ // Отклонения в доходы
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	Строки.Подразделение КАК Подразделение,
	|	Назначение.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	Аналитика.Номенклатура 	КАК Номенклатура
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.СебестоимостьТоваров КАК Строки
	|	ПО
	|		ДокументыКОтражению.Ссылка = Строки.Регистратор
	|		И Строки.Активность
	|		И (Строки.РасчетПартий ИЛИ Строки.РасчетСебестоимости)
	|		И (Строки.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимости)
	|			ИЛИ Строки.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимостиНаПрочиеДоходы)
	|			ИЛИ Строки.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.КорректировкаПриобретенияПрошлогоПериода)
	|			ИЛИ Строки.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.РаспределениеПоВыбывшимТоварам))
	|		И Строки.Количество = 0
	|		И (Строки.ДопРасходыРегл <> 0 ИЛИ Строки.ДопРасходыУпр <> 0
	|			И Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			ИЛИ Строки.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимостиНаПрочиеДоходы))
	|		И Строки.СтатьяДоходов <> ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиДоходов.ПустаяСсылка)
	|		И НЕ Строки.Сторно 
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Справочник.КлючиАналитикиУчетаНоменклатуры КАК Аналитика
	|	ПО
	|		Строки.АналитикаУчетаНоменклатуры = Аналитика.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Назначения КАК Назначения
	|		ПО Аналитика.Назначение = Назначения.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		УчетнаяПолитикаОрганизаций КАК УчетнаяПолитикаОрганизаций
	|	ПО 
	|		УчетнаяПолитикаОрганизаций.Ссылка = ДокументыКОтражению.Ссылка
	|		И УчетнаяПолитикаОрганизаций.Организация = Строки.Организация
	|		И УчетнаяПолитикаОрганизаций.ДатаОтражения = НАЧАЛОПЕРИОДА(Строки.Период, ДЕНЬ)
	|		И УчетнаяПолитикаОрганизаций.РаздельныйУчетПоНалогуНаПрибыль
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ //Расходы на себестоимость продаж
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	Строки.Подразделение КАК Подразделение,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	Аналитика.Номенклатура КАК Номенклатура
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ПрочиеРасходы КАК Строки
	|	ПО
	|		ДокументыКОтражению.Ссылка = Строки.Регистратор
	|		И Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И Строки.Активность
	|		И Строки.РасчетПартий
	|		И Строки.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.РаспределениеРасходовНаСебестоимостьПродаж)
	|		И НЕ Строки.Сторно
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ВыручкаИСебестоимостьПродаж КАК КорСтроки
	|	ПО
	|		КорСтроки.Регистратор = Строки.Регистратор
	|		И КорСтроки.НастройкаХозяйственнойОперации = Строки.НастройкаХозяйственнойОперации
	|		И КорСтроки.ИдентификаторФинЗаписи = Строки.ИдентификаторФинЗаписи
	|		И КорСтроки.Активность
	|		И НЕ КорСтроки.Сторно
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Справочник.КлючиАналитикиУчетаНоменклатуры КАК Аналитика
	|	ПО
	|		КорСтроки.АналитикаУчетаНоменклатуры = Аналитика.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		УчетнаяПолитикаОрганизаций КАК УчетнаяПолитикаОрганизаций
	|	ПО 
	|		УчетнаяПолитикаОрганизаций.Ссылка = ДокументыКОтражению.Ссылка
	|		И УчетнаяПолитикаОрганизаций.Организация = Строки.Организация
	|		И УчетнаяПолитикаОрганизаций.ДатаОтражения = НАЧАЛОПЕРИОДА(Строки.Период, ДЕНЬ)
	|		И УчетнаяПолитикаОрганизаций.РаздельныйУчетПоНалогуНаПрибыль
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ // Списание резервов
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	Строки.Подразделение КАК Подразделение,
	|	ЕСТЬNULL(Назначения.НаправлениеДеятельности,
	|		ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)) КАК НаправлениеДеятельности,
	|	ЕСТЬNULL(КорАналитика.Номенклатура, Аналитика.Номенклатура) КАК Номенклатура
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.СебестоимостьТоваров КАК Строки
	|	ПО
	|		ДокументыКОтражению.Ссылка = Строки.Регистратор
	|		И Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И Строки.Активность
	|		И Строки.РасчетСебестоимости
	|		И Строки.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПустаяСсылка)
	|		И НЕ Строки.РасчетПартий
	|		И Строки.ХозяйственнаяОперация В (
	|			ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеРезервовПодОбесценениеЗапасов),
	|			ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВосстановлениеРезервовПодОбесценениеЗапасов),
	|			ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.НачислениеРезерваПодОбесценениеЗапасов))
	|		И Строки.Количество = 0
	|		И (Строки.РезервПодОбесценениеРегл <> 0 ИЛИ Строки.РезервПодОбесценениеУпр <> 0)
	|		И Строки.СтатьяДоходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиДоходов.ПустаяСсылка)
	|		И НЕ Строки.Сторно
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Справочник.КлючиАналитикиУчетаНоменклатуры КАК Аналитика
	|	ПО
	|		Строки.АналитикаУчетаНоменклатуры = Аналитика.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		Справочник.КлючиАналитикиУчетаНоменклатуры КАК КорАналитика
	|	ПО
	|		Строки.КорАналитикаУчетаНоменклатуры = КорАналитика.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Назначения КАК Назначения
	|		ПО Аналитика.Назначение = Назначения.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		УчетнаяПолитикаОрганизаций КАК УчетнаяПолитикаОрганизаций
	|	ПО 
	|		УчетнаяПолитикаОрганизаций.Ссылка = ДокументыКОтражению.Ссылка
	|		И УчетнаяПолитикаОрганизаций.Организация = Строки.Организация
	|		И УчетнаяПолитикаОрганизаций.ДатаОтражения = НАЧАЛОПЕРИОДА(Строки.Период, ДЕНЬ)
	|		И УчетнаяПолитикаОрганизаций.РаздельныйУчетПоНалогуНаПрибыль
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ // Списание резервов в доходы
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	ПрочиеДоходы.Подразделение КАК Подразделение,
	|	ПрочиеДоходы.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	Аналитика.Номенклатура КАК Номенклатура
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.СебестоимостьТоваров КАК Строки
	|	ПО
	|		ДокументыКОтражению.Ссылка = Строки.Регистратор
	|		И Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И Строки.Активность
	|		И Строки.РасчетСебестоимости
	|		И НЕ Строки.РасчетПартий
	|		И Строки.ХозяйственнаяОперация В (
	|			ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеРезервовПодОбесценениеЗапасов),
	|			ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВосстановлениеРезервовПодОбесценениеЗапасов),
	|			ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.НачислениеРезерваПодОбесценениеЗапасов))
	|		И Строки.Количество = 0
	|		И (Строки.РезервПодОбесценениеРегл <> 0 ИЛИ Строки.РезервПодОбесценениеУпр <> 0)
	|		И Строки.СтатьяДоходов <> ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиДоходов.ПустаяСсылка)
	|		И НЕ Строки.Сторно
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ПрочиеДоходы КАК ПрочиеДоходы
	|	ПО
	|		ПрочиеДоходы.Регистратор = Строки.Регистратор
	|		И ПрочиеДоходы.Активность
	|		И ПрочиеДоходы.ИдентификаторФинЗаписи = Строки.ИдентификаторФинЗаписи
	|		И ПрочиеДоходы.НастройкаХозяйственнойОперации = Строки.НастройкаХозяйственнойОперации
	|		И ПрочиеДоходы.СтатьяДоходов = Строки.СтатьяДоходов
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Справочник.КлючиАналитикиУчетаНоменклатуры КАК Аналитика
	|	ПО
	|		Строки.АналитикаУчетаНоменклатуры = Аналитика.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		УчетнаяПолитикаОрганизаций КАК УчетнаяПолитикаОрганизаций
	|	ПО 
	|		УчетнаяПолитикаОрганизаций.Ссылка = ДокументыКОтражению.Ссылка
	|		И УчетнаяПолитикаОрганизаций.Организация = Строки.Организация
	|		И УчетнаяПолитикаОрганизаций.ДатаОтражения = НАЧАЛОПЕРИОДА(Строки.Период, ДЕНЬ)
	|		И УчетнаяПолитикаОрганизаций.РаздельныйУчетПоНалогуНаПрибыль
	|
	|";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область РаздельныйУчет_НастройкиНалогообложенияПрибыли
	ПараметрыПолученияНалогообложенияПрибыли = РаздельныйУчетПоНалогуНаПрибыль.НовыйПараметрыПолученияТаблицыНастроекНалогообложенияПрибыли();
	ПараметрыПолученияНалогообложенияПрибыли.ИмяТаблицы = "ВТПолученияНалогообложенияПрибыли";
	ПараметрыПолученияНалогообложенияПрибыли.ИмяПоля_Период = "Период";
	ПараметрыПолученияНалогообложенияПрибыли.ИмяПоля_Организация = "Организация";
	ПараметрыПолученияНалогообложенияПрибыли.ИмяПоля_Подразделение = "Подразделение";
	ПараметрыПолученияНалогообложенияПрибыли.ИмяПоля_НаправлениеДеятельности = "НаправлениеДеятельности";
	ПараметрыПолученияНалогообложенияПрибыли.ИмяПоля_ОбъектУчета = "Номенклатура";
	
	ТекстЗапроса = РаздельныйУчетПоНалогуНаПрибыль.ТекстЗапроса_НастройкиНалогообложенияПрибыли(ПараметрыПолученияНалогообложенияПрибыли);
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "ПОМЕСТИТЬ РаздельныйУчет_НастройкиНалогообложенияПрибыли",
		"ПОМЕСТИТЬ РаздельныйУчетНастройкиНалогообложенияПрибыли");
	ТекстыЗапроса.Добавить(ТекстЗапроса);
	ТекстыЗапроса.Добавить("УНИЧТОЖИТЬ ВТПолученияНалогообложенияПрибыли
	|;
	|");
	#КонецОбласти
	
	ТекстЗапроса = СтрСоединить(ТекстыЗапроса, ОбщегоНазначения.РазделительПакетаЗапросов());
	Возврат ТекстЗапроса;
	
КонецФункции

#КонецОбласти

#Область ОбщиеФрагментыЗапросовОтражения

Функция ТекстИнициализации() Экспорт
	
	Возврат
	"ВЫБРАТЬ //// Размещение итоговых данных во врем.таблицу Данные
	|	НЕОПРЕДЕЛЕНО КАК Ссылка,
	|	ДАТАВРЕМЯ(1, 1, 1) КАК Период,
	|	ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка) КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	0 КАК Сумма,
	|	0 КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПустаяСсылка) КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка) КАК ПодразделениеДт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиДт,
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПустаяСсылка) КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка) КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	
	|	"""" КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|
	|ПОМЕСТИТЬ Данные
	|ГДЕ ЛОЖЬ";
	
КонецФункции

Функция ТекстЗачетАвансов(ДокументИмя) Экспорт
	
	#Область АвансыКлиентов
	
	ТекстЗачетАвансовКлиентов =
	"ВЫБРАТЬ //// Зачет авансов клиентов (Дт <62.2> :: Кт <62.1, 76>)
	|	Операция.Ссылка КАК Ссылка,
	|	ЕСТЬNULL(РеализацияБезПереходаПраваСобственности.ДатаПереходаПраваСобственности, Расчеты.Период) КАК Период,
	|	ОбъектыРасчетов.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Расчеты.ПредоплатаРегл КАК Сумма,
	|	Расчеты.ПредоплатаУпр КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыПолученные) КАК ВидСчетаДт,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	Расчеты.Валюта КАК ВалютаДт,
	|	ОбъектыРасчетов.Подразделение КАК ПодразделениеДт,
	|	ОбъектыРасчетов.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	ОбъектыРасчетов.Контрагент КАК СубконтоДт1,
	|	ОбъектыРасчетов.Договор КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	Расчеты.Предоплата КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	Расчеты.ПредоплатаРегл КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами) КАК ВидСчетаКт,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	Расчеты.Валюта КАК ВалютаКт,
	|	ОбъектыРасчетов.Подразделение КАК ПодразделениеКт,
	|	ОбъектыРасчетов.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	ОбъектыРасчетов.Контрагент КАК СубконтоКт1,
	|	ОбъектыРасчетов.Договор КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	Расчеты.Предоплата КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	Расчеты.ПредоплатаРегл КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Зачет авансов клиентов"" КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ДокументИмя КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РегистрНакопления.РасчетыСКлиентамиПоДокументам КАК Расчеты
	|	ПО 
	|		Операция.Ссылка = Расчеты.Регистратор
	|		И НЕ &НоваяАрхитектураВзаиморасчетов
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ОбъектыРасчетов КАК ОбъектыРасчетов
	|	ПО (Расчеты.ЗаказКлиента = ОбъектыРасчетов.Ссылка)
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		Документ.РеализацияТоваровУслуг КАК РеализацияБезПереходаПраваСобственности
	|	ПО 
	|		РеализацияБезПереходаПраваСобственности.Ссылка = Операция.Ссылка
	|		И РеализацияБезПереходаПраваСобственности.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.РеализацияБезПереходаПраваСобственности)
	|ГДЕ
	|	Расчеты.ПредоплатаРегл > 0 И Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|	И Расчеты.Регистратор <> Расчеты.РасчетныйДокумент
	|	И НЕ Расчеты.Регистратор ССЫЛКА Документ.КорректировкаРеализации
	|	И НЕ Расчеты.ХозяйственнаяОперация В (
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратОплатыКлиенту),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДенежныхСредствВДругуюОрганизацию),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВзаимозачетЗадолженности))";
	
	#КонецОбласти
	
	#Область АвансыПоставщикам
	
	ТекстЗачетАвансовПоставщикам = 
	"ВЫБРАТЬ //// Зачет авансов поставщикам (Дт <60.1, 76> :: Кт <60.2>)
	|	Операция.Ссылка КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	ОбъектыРасчетов.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Расчеты.ПредоплатаРегл КАК Сумма,
	|	Расчеты.ПредоплатаУпр КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками) КАК ВидСчетаДт,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	Расчеты.Валюта КАК ВалютаДт,
	|	ОбъектыРасчетов.Подразделение КАК ПодразделениеДт,
	|	ОбъектыРасчетов.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	ОбъектыРасчетов.Контрагент КАК СубконтоДт1,
	|	ОбъектыРасчетов.Договор КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	Расчеты.Предоплата КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	Расчеты.ПредоплатаРегл КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыВыданные) КАК ВидСчетаКт,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	Расчеты.Валюта КАК ВалютаКт,
	|	ОбъектыРасчетов.Подразделение КАК ПодразделениеКт,
	|	ОбъектыРасчетов.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	ОбъектыРасчетов.Контрагент КАК СубконтоКт1,
	|	ОбъектыРасчетов.Договор КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	Расчеты.Предоплата КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	Расчеты.ПредоплатаРегл КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Зачет авансов поставщикам"" КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ДокументИмя КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РегистрНакопления.РасчетыСПоставщикамиПоДокументам КАК Расчеты
	|	ПО 
	|		Операция.Ссылка = Расчеты.Регистратор
	|		И НЕ &НоваяАрхитектураВзаиморасчетов
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ОбъектыРасчетов КАК ОбъектыРасчетов
	|	ПО (Расчеты.ЗаказПоставщику = ОбъектыРасчетов.Ссылка)
	|
	|ГДЕ
	|	Расчеты.ПредоплатаРегл > 0. 
	|	И Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|	И (Расчеты.Регистратор <> Расчеты.РасчетныйДокумент
	|		ИЛИ Расчеты.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ОтчетКомитенту))
	|	И НЕ Расчеты.Регистратор ССЫЛКА Документ.КорректировкаПриобретения
	|	И НЕ Расчеты.ХозяйственнаяОперация В (
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратТоваровПоставщику),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратТоваровМеждуОрганизациями),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДенежныхСредствОтПоставщика),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДенежныхСредствОтДругойОрганизации),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВозвратДенежныхДокументовПоставщику),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВзаимозачетЗадолженности))";
	
	#КонецОбласти
	
	#Область АвансыКлиентовНоваяАрхитектура
	
	ТекстЗачетАвансовКлиентовНоваяАрхитектура =
	"ВЫБРАТЬ //// Зачет авансов клиентов (Дт <62.2> :: Кт <62.1, 76>)
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	Расчеты.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	СУММА(-Расчеты.ПредоплатаРегл) КАК Сумма,
	|	СУММА(-Расчеты.ПредоплатаУпр) КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыПолученные) КАК ВидСчетаДт,
	|	Расчеты.КорГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	Расчеты.Валюта КАК ВалютаДт,
	|	Расчеты.КорПодразделение КАК ПодразделениеДт,
	|	Расчеты.КорНаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	Расчеты.Контрагент КАК СубконтоДт1,
	|	Расчеты.Договор КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	СУММА(-Расчеты.Предоплата) КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	СУММА(-Расчеты.ПредоплатаРегл) КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами) КАК ВидСчетаКт,
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	Расчеты.Валюта КАК ВалютаКт,
	|	Расчеты.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Расчеты.Контрагент КАК СубконтоКт1,
	|	Расчеты.Договор КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	СУММА(-Расчеты.Предоплата) КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	СУММА(-Расчеты.ПредоплатаРегл) КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Зачет авансов клиентов"" КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РасчетыСКлиентамиНоваяАрхитектура КАК Расчеты
	|	ПО 
	|		ДокументыКОтражению.Ссылка = Расчеты.Ссылка
	|
	|ГДЕ
	|	Расчеты.ПредоплатаРегл < 0
	|	И Расчеты.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ЗачетАвансаКлиента)
	|	И НЕ Расчеты.Ссылка ССЫЛКА Документ.СписаниеБезналичныхДенежныхСредств
	|	И НЕ Расчеты.Ссылка ССЫЛКА Документ.РасходныйКассовыйОрдер
	|	И НЕ Расчеты.Ссылка ССЫЛКА Документ.ОперацияПоПлатежнойКарте
	|	И НЕ Расчеты.Ссылка ССЫЛКА Документ.ОперацияПоЯндексКассе
	|	И НЕ Расчеты.Ссылка ССЫЛКА Документ.КорректировкаРеализации
	|	И НЕ Расчеты.Ссылка ССЫЛКА Документ.ОтчетОРозничныхПродажах
	|	И (НЕ Расчеты.Ссылка ССЫЛКА Документ.ОтчетКомиссионера
	|		И НЕ Расчеты.Ссылка ССЫЛКА Документ.ОтчетПоКомиссииМеждуОрганизациями
	|		ИЛИ Расчеты.Ссылка <> Расчеты.РасчетныйДокумент) 
	|
	|СГРУППИРОВАТЬ ПО
	|	ДокументыКОтражению.Ссылка,
	|	Расчеты.Период,
	|	Расчеты.Организация,
	|	Расчеты.КорГруппаФинансовогоУчета,
	|	Расчеты.Валюта,
	|	Расчеты.КорПодразделение,
	|	Расчеты.КорНаправлениеДеятельности,
	|	Расчеты.Контрагент,
	|	Расчеты.Договор,
	|	Расчеты.ГруппаФинансовогоУчета,
	|	Расчеты.Валюта,
	|	Расчеты.Подразделение,
	|	Расчеты.НаправлениеДеятельности,
	|	Расчеты.Контрагент,
	|	Расчеты.Договор";
	
	#КонецОбласти
	
	#Область АвансыПоставщикамНоваяАрхитектура
	
	ТекстЗачетАвансовПоставщикамНоваяАрхитектура = 
	" 
	|ВЫБРАТЬ //// Зачет авансов поставщикам (Дт <60.1, 76> :: Кт <60.2>)
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	Расчеты.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	СУММА(-Расчеты.ПредоплатаРегл) КАК Сумма,
	|	СУММА(-Расчеты.ПредоплатаУпр)  КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками) КАК ВидСчетаДт,
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	Расчеты.Валюта КАК ВалютаДт,
	|	Расчеты.Подразделение КАК ПодразделениеДт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	Расчеты.Контрагент КАК СубконтоДт1,
	|	Расчеты.Договор КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	СУММА(-Расчеты.Предоплата) КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	СУММА(-Расчеты.ПредоплатаРегл) КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыВыданные) КАК ВидСчетаКт,
	|	Расчеты.КорГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	Расчеты.Валюта КАК ВалютаКт,
	|	Расчеты.КорПодразделение КАК ПодразделениеКт,
	|	Расчеты.КорНаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Расчеты.Контрагент КАК СубконтоКт1,
	|	Расчеты.Договор КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	СУММА(-Расчеты.Предоплата) КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	СУММА(-Расчеты.ПредоплатаРегл) КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Зачет авансов поставщикам"" КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РасчетыСПоставщикамиНоваяАрхитектура КАК Расчеты
	|	ПО 
	|		ДокументыКОтражению.Ссылка = Расчеты.Ссылка
	|
	|ГДЕ
	|	Расчеты.ПредоплатаРегл < 0
	|	И Расчеты.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ЗачетАвансаПоставщику)
	|	И НЕ Расчеты.Ссылка ССЫЛКА Документ.ПоступлениеБезналичныхДенежныхСредств
	|	И НЕ Расчеты.Ссылка ССЫЛКА Документ.ПриходныйКассовыйОрдер
	|	И НЕ Расчеты.Ссылка ССЫЛКА Документ.ВозвратТоваровМеждуОрганизациями
	|	И НЕ Расчеты.Ссылка ССЫЛКА Документ.ВозвратТоваровПоставщику
	|	И НЕ Расчеты.Ссылка ССЫЛКА Документ.КорректировкаПриобретения
	|	И НЕ Расчеты.Ссылка ССЫЛКА Документ.Бронирование
	|	И (НЕ Расчеты.Ссылка ССЫЛКА Документ.ОтчетКомитенту
	|		И НЕ Расчеты.Ссылка ССЫЛКА Документ.ОтчетПоКомиссииМеждуОрганизациями
	|		ИЛИ Расчеты.Ссылка <> Расчеты.РасчетныйДокумент)
	|
	|СГРУППИРОВАТЬ ПО
	|	ДокументыКОтражению.Ссылка,
	|	Расчеты.Период,
	|	Расчеты.Организация,
	|	Расчеты.КорГруппаФинансовогоУчета,
	|	Расчеты.Валюта,
	|	Расчеты.КорПодразделение,
	|	Расчеты.КорНаправлениеДеятельности,
	|	Расчеты.Контрагент,
	|	Расчеты.Договор,
	|	Расчеты.ГруппаФинансовогоУчета,
	|	Расчеты.Валюта,
	|	Расчеты.Подразделение,
	|	Расчеты.НаправлениеДеятельности,
	|	Расчеты.Контрагент,
	|	Расчеты.Договор";
	
	#КонецОбласти
	
	МассивТекстовЗапроса = Новый Массив;
	МассивТекстовЗапроса.Добавить(ТекстЗачетАвансовКлиентов);
	МассивТекстовЗапроса.Добавить(ТекстЗачетАвансовПоставщикам);
	МассивТекстовЗапроса.Добавить(ТекстЗачетАвансовКлиентовНоваяАрхитектура);
	МассивТекстовЗапроса.Добавить(ТекстЗачетАвансовПоставщикамНоваяАрхитектура);
	ТекстЗачетАвансов = СтрСоединить(МассивТекстовЗапроса, ОбщегоНазначенияУТ.РазделительЗапросовВОбъединении());
	
	Если ДокументИмя = "Документ.ОтчетПоКомиссииМеждуОрганизациями" ИЛИ ДокументИмя = "Документ.ПередачаТоваровМеждуОрганизациями" Тогда
		Отступ = Символы.ПС + Символы.Таб + Символы.Таб + Символы.Таб;
		ВыражениеДляИнтеркомпани = Отступ + "ВЫБОР КОГДА ОбъектыРасчетов.Организация = Операция.Организация"
			+ Отступ + "ТОГДА Операция.ГруппаФинансовогоУчета"
			+ Отступ + "ИНАЧЕ Операция.ГруппаФинансовогоУчетаПолучателя КОНЕЦ";
		ТекстЗачетАвансов = СтрЗаменить(ТекстЗачетАвансов, "Операция.ГруппаФинансовогоУчета", ВыражениеДляИнтеркомпани);
	//++ НЕ УТКА
	ИначеЕсли ДокументИмя = "Документ.ОтчетДавальцуМеждуОрганизациями" Тогда
		Отступ = Символы.ПС + Символы.Таб + Символы.Таб + Символы.Таб;
		ВыражениеДляИнтеркомпани = Отступ + "ВЫБОР КОГДА ОбъектыРасчетов.Организация = Операция.Организация"
			+ Отступ + "ТОГДА Операция.ГруппаФинансовогоУчетаПереработчика"
			+ Отступ + "ИНАЧЕ Операция.ГруппаФинансовогоУчетаДавальца КОНЕЦ";
		ТекстЗачетАвансов = СтрЗаменить(ТекстЗачетАвансов, "Операция.ГруппаФинансовогоУчета", ВыражениеДляИнтеркомпани);
	//-- НЕ УТКА
	КонецЕсли;
	
	Если ДокументИмя = "Документ.ОперацияПоЯндексКассе" Тогда
		// ОперацияПоЯндексКассе добавлен в качестве объекта расчетов, для него строится зачет авансов, однако авансов быть не может, а так же ГФУ и НаправленияДеятельности в нем нет.
		ТекстЗачетАвансов = СтрЗаменить(ТекстЗачетАвансов, "Операция.ГруппаФинансовогоУчета", "ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка)");
		ТекстЗачетАвансов = СтрЗаменить(ТекстЗачетАвансов, "Операция.НаправлениеДеятельности", "ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)");
	КонецЕсли;
	
	Если ДокументИмя = "Документ.Бронирование" Тогда
		// Бронирование добавлен в качестве объекта расчетов, однако ГФУ в нем нет.
		ТекстЗачетАвансов = СтрЗаменить(ТекстЗачетАвансов, "Операция.ГруппаФинансовогоУчета", "ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка)");
	КонецЕсли;
	
	ТекстЗачетАвансов = СтрЗаменить(ТекстЗачетАвансов, "ДокументИмя", ДокументИмя);
	
	Возврат ТекстЗачетАвансов;
	
КонецФункции

Функция ТекстПереносАвансовМеждуФилиалами(ДокументИмя) Экспорт
	
	МассивТекстовЗапроса = Новый Массив;
	
	#Область ПереносАвансовКлиентовОрганизацияАванса
	
	ТекстЗапроса =
	"ВЫБРАТЬ //// Перенос аванса при зачете с организации получившей аванс (Дт <62.2> :: Кт <79>)
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	КорРасчеты.Период КАК Период,
	|	КорРасчеты.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	КорРасчеты.СуммаРегл КАК Сумма,
	|	КорРасчеты.СуммаУпр КАК СуммаУУ,
	|
	|	КорРасчеты.ВидСчета КАК ВидСчетаДт,
	|	КорРасчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	КорРасчеты.Валюта КАК ВалютаДт,
	|	КорРасчеты.Подразделение КАК ПодразделениеДт,
	|	КорРасчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	КорРасчеты.Контрагент КАК СубконтоДт1,
	|	КорРасчеты.Договор КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	КорРасчеты.Сумма КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	Расчеты.Валюта КАК ВалютаКт,
	|	Расчеты.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоТекущимОперациям) КАК СчетКт,
	|
	|	Расчеты.Организация КАК СубконтоКт1,
	|	Расчеты.Контрагент КАК СубконтоКт2,
	|	Расчеты.Договор КАК СубконтоКт3,
	|
	|	КорРасчеты.Сумма КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА КорРасчеты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыПолученные)
	|		ТОГДА ""Перенос аванса между филиалами""
	|		ИНАЧЕ ""Перенос задолженности между филиалами""
	|	КОНЕЦ КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РасчетыСКлиентамиНоваяАрхитектура КАК Расчеты
	|	ПО 
	|		ДокументыКОтражению.Ссылка = Расчеты.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РасчетыСКлиентамиНоваяАрхитектура КАК КорРасчеты
	|	ПО 
	|		Расчеты.Ссылка = КорРасчеты.Ссылка
	|		И Расчеты.ИдентификаторФинЗаписи = КорРасчеты.ИдентификаторФинЗаписи
	|		И Расчеты.НастройкаХозОперации = КорРасчеты.НастройкаХозОперации
	|		И Расчеты.ОрганизацияАналитики <> КорРасчеты.ОрганизацияАналитики
	|		И Расчеты.СтатьяДвиженияДенежныхСредств = КорРасчеты.СтатьяДвиженияДенежныхСредств
	|
	|ГДЕ
	|	Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ПереносАванса)
	|	И Расчеты.ДокументОбъектаРасчетов = Расчеты.Ссылка";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область ПереносАвансовКлиентовОрганизацияОбъектаРасчетов
	
	ТекстЗапроса =
	"ВЫБРАТЬ //// Перенос аванса при зачете на организацию воспользовавшуюся авансом (Дт <79> :: Кт <62.2>)
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	Расчеты.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	КорРасчеты.СуммаРегл КАК Сумма,
	|	КорРасчеты.СуммаУпр КАК СуммаУУ,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	КорРасчеты.Валюта КАК ВалютаДт,
	|	КорРасчеты.Подразделение КАК ПодразделениеДт,
	|	КорРасчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоТекущимОперациям) КАК СчетДт,
	|
	|	КорРасчеты.Организация КАК СубконтоДт1,
	|	КорРасчеты.Контрагент КАК СубконтоДт2,
	|	КорРасчеты.Договор КАК СубконтоДт3,
	|	
	|	КорРасчеты.Сумма КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	КорРасчеты.ВидСчета КАК ВидСчетаКт,
	|	КорРасчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	КорРасчеты.Валюта КАК ВалютаКт,
	|	КорРасчеты.Подразделение КАК ПодразделениеКт,
	|	КорРасчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	КорРасчеты.Контрагент КАК СубконтоКт1,
	|	КорРасчеты.Договор КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	КорРасчеты.Сумма КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА КорРасчеты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыПолученные)
	|		ТОГДА ""Перенос аванса между филиалами""
	|		ИНАЧЕ ""Перенос задолженности между филиалами""
	|	КОНЕЦ КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РасчетыСКлиентамиНоваяАрхитектура КАК Расчеты
	|	ПО 
	|		ДокументыКОтражению.Ссылка = Расчеты.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РасчетыСКлиентамиНоваяАрхитектура КАК КорРасчеты
	|	ПО 
	|		Расчеты.Ссылка = КорРасчеты.Ссылка
	|		И Расчеты.ИдентификаторФинЗаписи = КорРасчеты.ИдентификаторФинЗаписи
	|		И Расчеты.НастройкаХозОперации = КорРасчеты.НастройкаХозОперации
	|		И Расчеты.ОрганизацияАналитики <> КорРасчеты.ОрганизацияАналитики
	|		И Расчеты.СтатьяДвиженияДенежныхСредств = КорРасчеты.СтатьяДвиженияДенежныхСредств
	|
	|ГДЕ
	|	Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ПереносАванса)
	|	И Расчеты.ДокументОбъектаРасчетов = Расчеты.Ссылка";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область ПереносАвансовПоставщикамОрганизацияАванса
	
	ТекстЗапроса =
	"ВЫБРАТЬ //// Перенос аванса поставщикам с организации выдавшей аванс при зачете (Дт <79> :: Кт <60.02>)
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	КорРасчеты.Период КАК Период,
	|	КорРасчеты.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	КорРасчеты.СуммаРегл КАК Сумма,
	|	КорРасчеты.СуммаУпр КАК СуммаУУ,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	Расчеты.Валюта КАК ВалютаДт,
	|	Расчеты.Подразделение КАК ПодразделениеДт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоТекущимОперациям) КАК СчетДт,
	|
	|	Расчеты.Организация КАК СубконтоДт1,
	|	Расчеты.Контрагент КАК СубконтоДт2,
	|	Расчеты.Договор КАК СубконтоДт3,
	|	
	|	КорРасчеты.Сумма КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	КорРасчеты.ВидСчета КАК ВидСчетаКт,
	|	КорРасчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	КорРасчеты.Валюта КАК ВалютаКт,
	|	КорРасчеты.Подразделение КАК ПодразделениеКт,
	|	КорРасчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	КорРасчеты.Контрагент КАК СубконтоКт1,
	|	КорРасчеты.Договор КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	КорРасчеты.Сумма КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА КорРасчеты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыВыданные)
	|		ТОГДА ""Перенос аванса между филиалами""
	|		ИНАЧЕ ""Перенос задолженности между филиалами""
	|	КОНЕЦ КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РасчетыСПоставщикамиНоваяАрхитектура КАК Расчеты
	|	ПО 
	|		ДокументыКОтражению.Ссылка = Расчеты.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РасчетыСПоставщикамиНоваяАрхитектура КАК КорРасчеты
	|	ПО 
	|		Расчеты.Ссылка = КорРасчеты.Ссылка
	|		И Расчеты.ИдентификаторФинЗаписи = КорРасчеты.ИдентификаторФинЗаписи
	|		И Расчеты.НастройкаХозОперации = КорРасчеты.НастройкаХозОперации
	|		И Расчеты.ОрганизацияАналитики <> КорРасчеты.ОрганизацияАналитики
	|		И Расчеты.СтатьяДвиженияДенежныхСредств = КорРасчеты.СтатьяДвиженияДенежныхСредств
	|
	|ГДЕ
	|	Расчеты.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПереносАванса)
	|	И Расчеты.ДокументОбъектаРасчетов = Расчеты.Ссылка";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область ПереносАвансовПоставщикамОрганизацияОбъектаРасчетов
	
	ТекстЗапроса = 
	"ВЫБРАТЬ //// Перенос аванса поставщикам на организацию воспользовавшуюся авансом (Дт <60.02> :: Кт <79>)
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	Расчеты.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	КорРасчеты.СуммаРегл КАК Сумма,
	|	КорРасчеты.СуммаУпр КАК СуммаУУ,
	|
	|	КорРасчеты.ВидСчета КАК ВидСчетаДт,
	|	КорРасчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	КорРасчеты.Валюта КАК ВалютаДт,
	|	КорРасчеты.Подразделение КАК ПодразделениеДт,
	|	КорРасчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	КорРасчеты.Контрагент КАК СубконтоДт1,
	|	КорРасчеты.Договор КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	КорРасчеты.Сумма КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	КорРасчеты.Валюта КАК ВалютаКт,
	|	КорРасчеты.Подразделение КАК ПодразделениеКт,
	|	КорРасчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоТекущимОперациям) КАК СчетКт,
	|
	|	КорРасчеты.Организация КАК СубконтоКт1,
	|	КорРасчеты.Контрагент КАК СубконтоКт2,
	|	КорРасчеты.Договор КАК СубконтоКт3,
	|
	|	КорРасчеты.Сумма КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА КорРасчеты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыВыданные)
	|		ТОГДА ""Перенос аванса между филиалами""
	|		ИНАЧЕ ""Перенос задолженности между филиалами""
	|	КОНЕЦ КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РасчетыСПоставщикамиНоваяАрхитектура КАК Расчеты
	|	ПО 
	|		ДокументыКОтражению.Ссылка = Расчеты.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РасчетыСПоставщикамиНоваяАрхитектура КАК КорРасчеты
	|	ПО 
	|		Расчеты.Ссылка = КорРасчеты.Ссылка
	|		И Расчеты.ИдентификаторФинЗаписи = КорРасчеты.ИдентификаторФинЗаписи
	|		И Расчеты.НастройкаХозОперации = КорРасчеты.НастройкаХозОперации
	|		И Расчеты.ОрганизацияАналитики <> КорРасчеты.ОрганизацияАналитики
	|		И Расчеты.СтатьяДвиженияДенежныхСредств = КорРасчеты.СтатьяДвиженияДенежныхСредств
	|
	|ГДЕ
	|	Расчеты.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПереносАванса)
	|	И Расчеты.ДокументОбъектаРасчетов = Расчеты.Ссылка";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	ТекстПереносАвансов = СтрСоединить(МассивТекстовЗапроса, ОбщегоНазначенияУТ.РазделительЗапросовВОбъединении());
	
	Возврат ТекстПереносАвансов;
	
КонецФункции

Функция ТекстПереносПлатежаМеждуФилиалами(ДокументИмя) Экспорт
	
	МассивТекстовЗапроса = Новый Массив;
	
	#Область ПереносПлатежаКлиентовОрганизацияАванса
	
	ТекстЗапроса =
	"ВЫБРАТЬ //// Перенос платежа клиентов с организации получившей аванс (Дт <62.2> :: Кт <79>)
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	РасчетыПлатежа.ОрганизацияАналитики КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Расчеты.СуммаРегл КАК Сумма,
	|	Расчеты.СуммаУпр КАК СуммаУУ,
	|
	|	Расчеты.ВидСчета КАК ВидСчетаДт,
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	Расчеты.Валюта КАК ВалютаДт,
	|	Расчеты.Подразделение КАК ПодразделениеДт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	Расчеты.Контрагент КАК СубконтоДт1,
	|	Расчеты.Договор КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	Расчеты.Сумма КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	Расчеты.Валюта КАК ВалютаКт,
	|	Расчеты.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоТекущимОперациям) КАК СчетКт,
	|
	|	Расчеты.Организация КАК СубконтоКт1,
	|	Расчеты.Контрагент КАК СубконтоКт2,
	|	Расчеты.Договор КАК СубконтоКт3,
	|
	|	Расчеты.Сумма КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА Расчеты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыПолученные)
	|		ТОГДА ""Перенос аванса между филиалами""
	|		ИНАЧЕ ""Перенос задолженности между филиалами""
	|	КОНЕЦ КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РасчетыСКлиентамиНоваяАрхитектура КАК РасчетыПлатежа
	|	ПО 
	|		ДокументыКОтражению.Ссылка = РасчетыПлатежа.Ссылка
	|		И РасчетыПлатежа.Организация <> РасчетыПлатежа.ОрганизацияАналитики
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РасчетыСКлиентамиНоваяАрхитектура КАК Расчеты
	|	ПО 
	|		Расчеты.Ссылка = РасчетыПлатежа.Ссылка
	|		И Расчеты.ИдентификаторФинЗаписи = РасчетыПлатежа.ИдентификаторФинЗаписи
	|		И Расчеты.НастройкаХозОперации = РасчетыПлатежа.НастройкаХозОперации
	|		И Расчеты.ОрганизацияАналитики <> РасчетыПлатежа.ОрганизацияАналитики
	|		И Расчеты.СтатьяДвиженияДенежныхСредств = РасчетыПлатежа.СтатьяДвиженияДенежныхСредств
	|
	|ГДЕ
	|	Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ПереносПлатежаМеждуФилиалами)";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область ПереносПлатежаКлиентовОрганизацияОбъектаРасчетов
	
	ТекстЗапроса =
	"ВЫБРАТЬ //// Перенос платежа клиентов на организацию распоряжающуюся им (Дт <79> :: Кт <62.1,62.2>)
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	Расчеты.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Расчеты.СуммаРегл КАК Сумма,
	|	Расчеты.СуммаУпр КАК СуммаУУ,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	Расчеты.Валюта КАК ВалютаДт,
	|	Расчеты.Подразделение КАК ПодразделениеДт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоТекущимОперациям) КАК СчетДт,
	|
	|	РасчетыПлатежа.ОрганизацияАналитики КАК СубконтоДт1,
	|	Расчеты.Контрагент КАК СубконтоДт2,
	|	Расчеты.Договор КАК СубконтоДт3,
	|	
	|	Расчеты.Сумма КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	Расчеты.ВидСчета КАК ВидСчетаКт,
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	Расчеты.Валюта КАК ВалютаКт,
	|	Расчеты.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Расчеты.Контрагент КАК СубконтоКт1,
	|	Расчеты.Договор КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	Расчеты.Сумма КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА Расчеты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыПолученные)
	|		ТОГДА ""Перенос аванса между филиалами""
	|		ИНАЧЕ ""Перенос задолженности между филиалами""
	|	КОНЕЦ КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РасчетыСКлиентамиНоваяАрхитектура КАК РасчетыПлатежа
	|	ПО 
	|		ДокументыКОтражению.Ссылка = РасчетыПлатежа.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РасчетыСКлиентамиНоваяАрхитектура КАК Расчеты
	|	ПО 
	|		РасчетыПлатежа.Ссылка = Расчеты.Ссылка
	|		И РасчетыПлатежа.ИдентификаторФинЗаписи = Расчеты.ИдентификаторФинЗаписи
	|		И РасчетыПлатежа.НастройкаХозОперации = Расчеты.НастройкаХозОперации
	|		И Расчеты.Организация = Расчеты.ОрганизацияАналитики
	|		И РасчетыПлатежа.СтатьяДвиженияДенежныхСредств = Расчеты.СтатьяДвиженияДенежныхСредств
	|
	|ГДЕ
	|	РасчетыПлатежа.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ПереносПлатежаМеждуФилиалами)
	|	И РасчетыПлатежа.Организация <> РасчетыПлатежа.ОрганизацияАналитики";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область ПереносПлатежаПоставщикамОрганизацияАванса
	
	ТекстЗапроса =
	"ВЫБРАТЬ //// Перенос платежа поставщикам с организации выдавшей аванс (Дт <79> :: Кт <60.01, 60.02>)
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	РасчетыПлатежа.ОрганизацияАналитики КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Расчеты.СуммаРегл КАК Сумма,
	|	Расчеты.СуммаУпр КАК СуммаУУ,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	Расчеты.Валюта КАК ВалютаДт,
	|	Расчеты.Подразделение КАК ПодразделениеДт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоТекущимОперациям) КАК СчетДт,
	|
	|	Расчеты.Организация КАК СубконтоДт1,
	|	Расчеты.Контрагент КАК СубконтоДт2,
	|	Расчеты.Договор КАК СубконтоДт3,
	|	
	|	Расчеты.Сумма КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	Расчеты.ВидСчета КАК ВидСчетаКт,
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	Расчеты.Валюта КАК ВалютаКт,
	|	Расчеты.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Расчеты.Контрагент КАК СубконтоКт1,
	|	Расчеты.Договор КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	Расчеты.Сумма КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА Расчеты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыВыданные)
	|		ТОГДА ""Перенос аванса между филиалами""
	|		ИНАЧЕ ""Перенос задолженности между филиалами""
	|	КОНЕЦ КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РасчетыСПоставщикамиНоваяАрхитектура КАК РасчетыПлатежа
	|	ПО 
	|		ДокументыКОтражению.Ссылка = РасчетыПлатежа.Ссылка
	|		И РасчетыПлатежа.Организация <> РасчетыПлатежа.ОрганизацияАналитики
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РасчетыСПоставщикамиНоваяАрхитектура КАК Расчеты
	|	ПО 
	|		Расчеты.Ссылка = РасчетыПлатежа.Ссылка
	|		И Расчеты.ИдентификаторФинЗаписи = РасчетыПлатежа.ИдентификаторФинЗаписи
	|		И Расчеты.НастройкаХозОперации = РасчетыПлатежа.НастройкаХозОперации
	|		И Расчеты.ОрганизацияАналитики <> РасчетыПлатежа.ОрганизацияАналитики
	|		И Расчеты.СтатьяДвиженияДенежныхСредств = РасчетыПлатежа.СтатьяДвиженияДенежныхСредств
	|
	|ГДЕ
	|	Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ПереносПлатежаМеждуФилиалами)";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область ПереносПлатежаПоставщикамОрганизацияОбъектаРасчетов
	
	ТекстЗапроса = 
	"ВЫБРАТЬ //// Перенос платежа поставщикам на организацию распоряжающуюся им (Дт <60.01,60.02> :: Кт <79>)
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	Расчеты.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Расчеты.СуммаРегл КАК Сумма,
	|	Расчеты.СуммаУпр КАК СуммаУУ,
	|
	|	Расчеты.ВидСчета КАК ВидСчетаДт,
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	Расчеты.Валюта КАК ВалютаДт,
	|	Расчеты.Подразделение КАК ПодразделениеДт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	Расчеты.Контрагент КАК СубконтоДт1,
	|	Расчеты.Договор КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	Расчеты.Сумма КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	Расчеты.Валюта КАК ВалютаКт,
	|	Расчеты.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоТекущимОперациям) КАК СчетКт,
	|
	|	РасчетыПлатежа.ОрганизацияАналитики КАК СубконтоКт1,
	|	Расчеты.Контрагент КАК СубконтоКт2,
	|	Расчеты.Договор КАК СубконтоКт3,
	|
	|	Расчеты.Сумма КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА Расчеты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыВыданные)
	|		ТОГДА ""Перенос аванса между филиалами""
	|		ИНАЧЕ ""Перенос задолженности между филиалами""
	|	КОНЕЦ КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РасчетыСПоставщикамиНоваяАрхитектура КАК РасчетыПлатежа
	|	ПО 
	|		ДокументыКОтражению.Ссылка = РасчетыПлатежа.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РасчетыСПоставщикамиНоваяАрхитектура КАК Расчеты
	|	ПО 
	|		РасчетыПлатежа.Ссылка = Расчеты.Ссылка
	|		И РасчетыПлатежа.ИдентификаторФинЗаписи = Расчеты.ИдентификаторФинЗаписи
	|		И РасчетыПлатежа.НастройкаХозОперации = Расчеты.НастройкаХозОперации
	|		И Расчеты.Организация = Расчеты.ОрганизацияАналитики
	|		И Расчеты.СтатьяДвиженияДенежныхСредств = РасчетыПлатежа.СтатьяДвиженияДенежныхСредств
	|
	|ГДЕ
	|	РасчетыПлатежа.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ПереносПлатежаМеждуФилиалами)
	|	И РасчетыПлатежа.Организация <> РасчетыПлатежа.ОрганизацияАналитики";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	ТекстПереносАвансов = СтрСоединить(МассивТекстовЗапроса, ОбщегоНазначенияУТ.РазделительЗапросовВОбъединении());
	
	Возврат ТекстПереносАвансов;
	
КонецФункции

Функция ТекстПереносДолгаМеждуФилиалами(ДокументИмя) Экспорт
	
	МассивТекстовЗапроса = Новый Массив;
	
	#Область ПереносДолгаКлиентовОрганизацияОтгрузки
	
	ТекстЗапроса =
	"ВЫБРАТЬ //// Перенос долга клиентов с организации осуществившей продажу (Дт <79> :: Кт <62.1>)
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	Расчеты.ОрганизацияАналитики КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Расчеты.СуммаРегл КАК Сумма,
	|	Расчеты.СуммаУпр КАК СуммаУУ,
	|
	|	ВЫБОР
	|		КОГДА Расчеты.Ссылка ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|		ТОГДА Расчеты.ВидСчета
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	Расчеты.Валюта КАК ВалютаДт,
	|	Расчеты.Подразделение КАК ПодразделениеДт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	ВЫБОР
	|		КОГДА Расчеты.Ссылка ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоТекущимОперациям)
	|	КОНЕЦ КАК СчетДт,
	|
	|	Расчеты.Контрагент КАК СубконтоДт1,
	|	Расчеты.Договор КАК СубконтоДт2,
	|	ВЫБОР
	|		КОГДА Расчеты.Ссылка ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Расчеты.Организация
	|	КОНЕЦ КАК СубконтоДт3,
	|	
	|	Расчеты.Сумма КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	ВЫБОР
	|		КОГДА Расчеты.Ссылка ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Расчеты.ВидСчета
	|	КОНЕЦ КАК ВидСчетаКт,
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	Расчеты.Валюта КАК ВалютаКт,
	|	Расчеты.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	ВЫБОР
	|		КОГДА Расчеты.Ссылка ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|		ТОГДА ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоТекущимОперациям)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК СчетКт,
	|
	|	ВЫБОР
	|		КОГДА Расчеты.Ссылка ССЫЛКА Документ.ВозвратТоваровОтКлиента 
	|		ТОГДА Расчеты.Организация
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК СубконтоКт1,
	|	Расчеты.Контрагент КАК СубконтоКт2,
	|	Расчеты.Договор КАК СубконтоКт3,
	|
	|	Расчеты.Сумма КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Перенос задолженности между филиалами"" КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РасчетыСКлиентамиНоваяАрхитектура КАК Расчеты
	|	ПО 
	|		ДокументыКОтражению.Ссылка = Расчеты.Ссылка
	|
	|ГДЕ
	|	Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ПереносЗадолженностиМеждуФилиалами)
	|	И Расчеты.Организация <> Расчеты.ОрганизацияАналитики";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область ПереносДолгаКлиентовОрганизацияОбъектаРасчетов
	
	ТекстЗапроса =
	"ВЫБРАТЬ //// Перенос долга клиентов на организацию распоряжающуюся им (Дт <62.1> :: Кт <79>)
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	Расчеты.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Расчеты.СуммаРегл КАК Сумма,
	|	Расчеты.СуммаУпр КАК СуммаУУ,
	|
	|	ВЫБОР
	|		КОГДА Расчеты.Ссылка ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Расчеты.ВидСчета
	|	КОНЕЦ КАК ВидСчетаДт,
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	Расчеты.Валюта КАК ВалютаДт,
	|	Расчеты.Подразделение КАК ПодразделениеДт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	ВЫБОР
	|		КОГДА Расчеты.Ссылка ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|		ТОГДА ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоТекущимОперациям)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК СчетДт,
	|
	|	ВЫБОР
	|		КОГДА Расчеты.Ссылка ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|		ТОГДА РасчетыПоДолгу.ОрганизацияАналитики
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК СубконтоДт1,
	|	Расчеты.Контрагент КАК СубконтоДт2,
	|	Расчеты.Договор КАК СубконтоДт3,
	|	
	|	Расчеты.Сумма КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	ВЫБОР
	|		КОГДА НЕ Расчеты.Ссылка ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Расчеты.ВидСчета
	|	КОНЕЦ КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	Расчеты.Валюта КАК ВалютаКт,
	|	Расчеты.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	ВЫБОР
	|		КОГДА Расчеты.Ссылка ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоТекущимОперациям)
	|	КОНЕЦ КАК СчетКт,
	|
	|	Расчеты.Контрагент КАК СубконтоКт1,
	|	Расчеты.Договор КАК СубконтоКт2,
	|	ВЫБОР
	|		КОГДА Расчеты.Ссылка ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ РасчетыПоДолгу.ОрганизацияАналитики
	|	КОНЕЦ КАК СубконтоКт3,
	|
	|	Расчеты.Сумма КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА Расчеты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыПолученные)
	|		ТОГДА ""Перенос аванса между филиалами""
	|		ИНАЧЕ ""Перенос задолженности между филиалами""
	|	КОНЕЦ КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РасчетыСКлиентамиНоваяАрхитектура КАК РасчетыПоДолгу
	|	ПО 
	|		ДокументыКОтражению.Ссылка = РасчетыПоДолгу.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РасчетыСКлиентамиНоваяАрхитектура КАК Расчеты
	|	ПО 
	|		РасчетыПоДолгу.Ссылка = Расчеты.Ссылка
	|		И РасчетыПоДолгу.ИдентификаторФинЗаписи = Расчеты.ИдентификаторФинЗаписи
	|		И РасчетыПоДолгу.НастройкаХозОперации = Расчеты.НастройкаХозОперации
	|		И Расчеты.Организация = Расчеты.ОрганизацияАналитики
	|		И РасчетыПоДолгу.СтатьяДвиженияДенежныхСредств = Расчеты.СтатьяДвиженияДенежныхСредств
	|
	|ГДЕ
	|	РасчетыПоДолгу.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ПереносЗадолженностиМеждуФилиалами)
	|	И РасчетыПоДолгу.Организация <> РасчетыПоДолгу.ОрганизацияАналитики";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область ПереносДолгаПоставщикамОрганизацияОтгрузки
	
	ТекстЗапроса =
	"ВЫБРАТЬ //// Перенос долга поставщикам с организации осуществившей покупку (Дт <60.01> :: Кт <79>)
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	Расчеты.ОрганизацияАналитики КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Расчеты.СуммаРегл КАК Сумма,
	|	Расчеты.СуммаУпр КАК СуммаУУ,
	|
	|	ВЫБОР
	|		КОГДА Расчеты.Ссылка ССЫЛКА Документ.ВозвратТоваровПоставщику
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Расчеты.ВидСчета
	|	КОНЕЦ КАК ВидСчетаДт,
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	Расчеты.Валюта КАК ВалютаДт,
	|	Расчеты.Подразделение КАК ПодразделениеДт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	ВЫБОР
	|		КОГДА Расчеты.Ссылка ССЫЛКА Документ.ВозвратТоваровПоставщику
	|		ТОГДА ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоТекущимОперациям)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК СчетДт,
	|
	|	ВЫБОР
	|		КОГДА Расчеты.Ссылка ССЫЛКА Документ.ВозвратТоваровПоставщику
	|		ТОГДА Расчеты.Организация
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК СубконтоДт1,
	|	Расчеты.Контрагент КАК СубконтоДт2,
	|	Расчеты.Договор КАК СубконтоДт3,
	|	
	|	Расчеты.Сумма КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	ВЫБОР
	|		КОГДА Расчеты.Ссылка ССЫЛКА Документ.ВозвратТоваровПоставщику
	|		ТОГДА Расчеты.ВидСчета
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	Расчеты.Валюта КАК ВалютаКт,
	|	Расчеты.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	ВЫБОР
	|		КОГДА Расчеты.Ссылка ССЫЛКА Документ.ВозвратТоваровПоставщику
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоТекущимОперациям)
	|	КОНЕЦ КАК СчетКт,
	|
	|	Расчеты.Контрагент КАК СубконтоКт1,
	|	Расчеты.Договор КАК СубконтоКт2,
	|	ВЫБОР
	|		КОГДА Расчеты.Ссылка ССЫЛКА Документ.ВозвратТоваровПоставщику
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Расчеты.Организация
	|	КОНЕЦ КАК СубконтоКт3,
	|
	|	Расчеты.Сумма КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Перенос задолженности между филиалами"" КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РасчетыСПоставщикамиНоваяАрхитектура КАК Расчеты
	|	ПО 
	|		ДокументыКОтражению.Ссылка = Расчеты.Ссылка
	|
	|ГДЕ
	|	Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ПереносЗадолженностиМеждуФилиалами)
	|	И Расчеты.Организация <> Расчеты.ОрганизацияАналитики";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область ПереносДолгаПоставщикамОрганизацияОбъектаРасчетов
	
	ТекстЗапроса = 
	"ВЫБРАТЬ //// Перенос долга поставщикам на организацию распоряжающуюся им (Дт <79> :: Кт <60.01>)
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	Расчеты.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Расчеты.СуммаРегл КАК Сумма,
	|	Расчеты.СуммаУпр КАК СуммаУУ,
	|
	|	ВЫБОР
	|		КОГДА НЕ Расчеты.Ссылка ССЫЛКА Документ.ВозвратТоваровПоставщику
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Расчеты.ВидСчета
	|	КОНЕЦ КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	Расчеты.Валюта КАК ВалютаДт,
	|	Расчеты.Подразделение КАК ПодразделениеДт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	ВЫБОР
	|		КОГДА Расчеты.Ссылка ССЫЛКА Документ.ВозвратТоваровПоставщику
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоТекущимОперациям)
	|	КОНЕЦ КАК СчетДт,
	|
	|	Расчеты.Контрагент КАК СубконтоДт1,
	|	Расчеты.Договор КАК СубконтоДт2,
	|	ВЫБОР
	|		КОГДА Расчеты.Ссылка ССЫЛКА Документ.ВозвратТоваровПоставщику
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ РасчетыПоДолгу.ОрганизацияАналитики
	|	КОНЕЦ КАК СубконтоДт3,
	|	
	|	Расчеты.Сумма КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	ВЫБОР
	|		КОГДА Расчеты.Ссылка ССЫЛКА Документ.ВозвратТоваровПоставщику
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Расчеты.ВидСчета
	|	КОНЕЦ КАК ВидСчетаКт,
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	Расчеты.Валюта КАК ВалютаКт,
	|	Расчеты.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	ВЫБОР
	|		КОГДА Расчеты.Ссылка ССЫЛКА Документ.ВозвратТоваровПоставщику
	|		ТОГДА ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоТекущимОперациям)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК СчетКт,
	|
	|	ВЫБОР
	|		КОГДА Расчеты.Ссылка ССЫЛКА Документ.ВозвратТоваровПоставщику
	|		ТОГДА РасчетыПоДолгу.ОрганизацияАналитики
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК СубконтоКт1,
	|	Расчеты.Контрагент КАК СубконтоКт2,
	|	Расчеты.Договор КАК СубконтоКт3,
	|
	|	Расчеты.Сумма КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА Расчеты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыВыданные)
	|		ТОГДА ""Перенос аванса между филиалами""
	|		ИНАЧЕ ""Перенос задолженности между филиалами""
	|	КОНЕЦ КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РасчетыСПоставщикамиНоваяАрхитектура КАК РасчетыПоДолгу
	|	ПО 
	|		ДокументыКОтражению.Ссылка = РасчетыПоДолгу.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РасчетыСПоставщикамиНоваяАрхитектура КАК Расчеты
	|	ПО 
	|		РасчетыПоДолгу.Ссылка = Расчеты.Ссылка
	|		И РасчетыПоДолгу.ИдентификаторФинЗаписи = Расчеты.ИдентификаторФинЗаписи
	|		И РасчетыПоДолгу.НастройкаХозОперации = Расчеты.НастройкаХозОперации
	|		И Расчеты.Организация = Расчеты.ОрганизацияАналитики
	|		И РасчетыПоДолгу.СтатьяДвиженияДенежныхСредств = Расчеты.СтатьяДвиженияДенежныхСредств
	|
	|ГДЕ
	|	РасчетыПоДолгу.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ПереносЗадолженностиМеждуФилиалами)
	|	И РасчетыПоДолгу.Организация <> РасчетыПоДолгу.ОрганизацияАналитики";
	МассивТекстовЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	ТекстПереносАвансов = СтрСоединить(МассивТекстовЗапроса, ОбщегоНазначенияУТ.РазделительЗапросовВОбъединении());
	
	Возврат ТекстПереносАвансов;
	
КонецФункции

Функция ТекстВосстановлениеРасчетовПоСторно(ДокументИмя) Экспорт
	
	МассивТекстовЗапросов = Новый Массив();
	
	#Область РасчетыСКлиентами
	
	ТекстВосстановлениеРасчетовСКлиентамиПоСторно =
	"ВЫБРАТЬ
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	ДокументыКОтражению.Период КАК Период,
	|	РасчетыСКлиентами.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	РасчетыСКлиентами.ПредоплатаРегл КАК Сумма,
	|	РасчетыСКлиентами.ПредоплатаУпр КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами) КАК ВидСчетаДт,
	|	РасчетыСКлиентами.ОбъектРасчетов.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	РасчетыСКлиентами.Валюта КАК ВалютаДт,
	|	РасчетыСКлиентами.ОбъектРасчетов.Подразделение КАК ПодразделениеДт,
	|	РасчетыСКлиентами.ОбъектРасчетов.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	РасчетыСКлиентами.ОбъектРасчетов.Контрагент КАК СубконтоДт1,
	|	РасчетыСКлиентами.ОбъектРасчетов.Договор КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	РасчетыСКлиентами.Предоплата КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыПолученные) КАК ВидСчетаКт,
	|	РасчетыСКлиентами.ОбъектРасчетов.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	РасчетыСКлиентами.Валюта КАК ВалютаКт,
	|	РасчетыСКлиентами.ОбъектРасчетов.Подразделение КАК ПодразделениеКт,
	|	РасчетыСКлиентами.ОбъектРасчетов.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	РасчетыСКлиентами.ОбъектРасчетов.Контрагент КАК СубконтоКт1,
	|	РасчетыСКлиентами.ОбъектРасчетов.Договор КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	РасчетыСКлиентами.Долг КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Восстановление аванса клиента"" КАК Содержание,
	|	ИСТИНА КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		ВтВосстановлениеРасчетовСКлиентамиПоСторно КАК РасчетыСКлиентами
	|	ПО 
	|		ДокументыКОтражению.Ссылка = РасчетыСКлиентами.Ссылка
	|";
	МассивТекстовЗапросов.Добавить(ТекстВосстановлениеРасчетовСКлиентамиПоСторно);
	#КонецОбласти
	
	#Область РасчетыСПоставщиками
	
	ТекстВосстановлениеРасчетовСПоставщикамиПоСторно =
	"ВЫБРАТЬ
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	ДокументыКОтражению.Период КАК Период,
	|	РасчетыСПоставщиками.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	РасчетыСПоставщиками.ПредоплатаРегл КАК Сумма,
	|	РасчетыСПоставщиками.ПредоплатаУпр КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыВыданные) КАК ВидСчетаДт,
	|	РасчетыСПоставщиками.ОбъектРасчетов.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	РасчетыСПоставщиками.Валюта КАК ВалютаДт,
	|	РасчетыСПоставщиками.ОбъектРасчетов.Подразделение КАК ПодразделениеДт,
	|	РасчетыСПоставщиками.ОбъектРасчетов.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	РасчетыСПоставщиками.ОбъектРасчетов.Контрагент КАК СубконтоДт1,
	|	РасчетыСПоставщиками.ОбъектРасчетов.Договор КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	РасчетыСПоставщиками.Долг КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками) КАК ВидСчетаКт,
	|	РасчетыСПоставщиками.ОбъектРасчетов.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	РасчетыСПоставщиками.Валюта КАК ВалютаКт,
	|	РасчетыСПоставщиками.ОбъектРасчетов.Подразделение КАК ПодразделениеКт,
	|	РасчетыСПоставщиками.ОбъектРасчетов.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	РасчетыСПоставщиками.ОбъектРасчетов.Контрагент КАК СубконтоКт1,
	|	РасчетыСПоставщиками.ОбъектРасчетов.Договор КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	РасчетыСПоставщиками.Предоплата КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Восстановление аванса поставщику"" КАК Содержание,
	|	ИСТИНА КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		ВтВосстановлениеРасчетовСПоставщикамиПоСторно КАК РасчетыСПоставщиками
	|	ПО 
	|		ДокументыКОтражению.Ссылка = РасчетыСПоставщиками.Ссылка
	|";
	МассивТекстовЗапросов.Добавить(ТекстВосстановлениеРасчетовСПоставщикамиПоСторно);
	#КонецОбласти
		
	Возврат СтрСоединить(МассивТекстовЗапросов, ОбщегоНазначенияУТ.РазделительЗапросовВОбъединении());
	
КонецФункции

Функция ТекстРаспределениеРасходов(ДокументИмя) Экспорт
	
#Область Распределение	 // Отражение доп. расходов (Дт 10, 20, 41, 45 :: Кт 10.ДР, 41.ДР)

	ТекстРаспределения =
	"ВЫБРАТЬ //// Отражение доп. расходов (Дт 10, 20, 41, 45 :: Кт 10.ДР, 41.ДР)
	|	Строки.Регистратор КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	(Строки.СтоимостьРегл + Строки.ДопРасходыРегл + ТрудозатратыРегл + ПостатейныеПостоянныеРегл + ПостатейныеПеременныеРегл) КАК Сумма,
	|	Строки.ДопРасходыУпр + ТрудозатратыУпр + ПостатейныеПостоянныеУпр + ПостатейныеПеременныеУпр КАК СуммаУУ,
	|
	|	ВЫБОР
	|		КОГДА Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|				&ЗабалансовыеРазделыУчета)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗатратыНаПриобретениеТМЦ)
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссиюВПути))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РеализацияБезПереходаПраваСобственности)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|	КОНЕЦ КАК ВидСчетаДт,
	|	
	|	ВЫБОР
	|		КОГДА Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|				&ЗабалансовыеРазделыУчета)
	|		ТОГДА ВЫБОР
	|					КОГДА &ПартионныйУчетВерсии22 И Строки.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ)
	|						И ТИПЗНАЧЕНИЯ(Строки.АналитикаФинансовогоУчета) = ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|						ТОГДА Строки.АналитикаФинансовогоУчета
	|					ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|				КОНЕЦ
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|		ТОГДА Строки.ВидЗапасов.ГруппаФинансовогоУчета
	|		ИНАЧЕ Аналитика.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК АналитикаУчетаДт,
	|	ВЫБОР
	|		КОГДА (Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|				&ЗабалансовыеРазделыУчета))
	|			И Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссиюВПути))
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Аналитика.МестоХранения
	|	КОНЕЦ КАК МестоУчетаДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВалютаДт,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЕСТЬNULL(Строки.ВидЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Аналитика.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА Аналитика.Договор.Подразделение
	|		КОГДА Строки.РазделУчета В (
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеПереданныеПартнерам))
	|		ТОГДА ЕСТЬNULL(Строки.ВидЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ПодразделениеДт,
	|	ЕСТЬNULL(Назначения.НаправлениеДеятельности,
	|		ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)) КАК НаправлениеДеятельностиДт,
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	Аналитика.Номенклатура  КАК СубконтоДт1,
	|	ВЫБОР
	|		КОГДА Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|				&ЗабалансовыеРазделыУчета)
	|		ТОГДА ВЫБОР
	|				КОГДА &ПартионныйУчетВерсии22 И Строки.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ)
	|					И ТИПЗНАЧЕНИЯ(Строки.АналитикаФинансовогоУчета) = ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|					ТОГДА Строки.АналитикаФинансовогоУчета
	|				ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|			КОНЕЦ
	|		ИНАЧЕ Аналитика.МестоХранения
	|	КОНЕЦ КАК СубконтоДт2,
	|	ВЫБОР
	|		КОГДА Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|				&ЗабалансовыеРазделыУчета)
	|			И Строки.ВидЗапасов = ЗНАЧЕНИЕ(Справочник.ВидыЗапасов.ПустаяСсылка)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Работы)
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссиюВПути))
	|			И Аналитика.ТипМестаХранения В (ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента),
	|											ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер))
	|		ТОГДА Аналитика.Контрагент
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.МатериальныеЗатраты)
	|	КОНЕЦ КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	(Строки.СтоимостьРегл + Строки.ДопРасходыРегл + ТрудозатратыРегл + ПостатейныеПостоянныеРегл + ПостатейныеПеременныеРегл - Строки.ПостояннаяРазница - Строки.ВременнаяРазница) КАК СуммаНУДт,
	|	Строки.ПостояннаяРазница КАК СуммаПРДт,
	|	Строки.ВременнаяРазница КАК СуммаВРДт,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаКт,
	|	ЕСТЬNULL(ПрочиеРасходы.СтатьяРасходов, Строки.СтатьяРасходовСписания) КАК АналитикаУчетаКт,
	|	ЕСТЬNULL(ПрочиеРасходы.Подразделение, Строки.Подразделение) КАК МестоУчетаКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВалютаКт,
	|	ЕСТЬNULL(ПрочиеРасходы.Подразделение, Строки.Подразделение) КАК ПодразделениеКт,
	|	ЕСТЬNULL(ПрочиеРасходы.НаправлениеДеятельности, Строки.КорНаправлениеДеятельности) КАК НаправлениеДеятельностиКт,
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	ЕСТЬNULL(ПрочиеРасходы.СтатьяРасходов, Строки.СтатьяРасходовСписания) КАК СубконтоКт1,
	|	ЕСТЬNULL(ПрочиеРасходы.АналитикаРасходов, Строки.АналитикаРасходов) КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	(Строки.СтоимостьРегл + Строки.ДопРасходыРегл + ТрудозатратыРегл + ПостатейныеПостоянныеРегл + ПостатейныеПеременныеРегл - Строки.ПостояннаяРазница - Строки.ВременнаяРазница) КАК СуммаНУКт,
	|	Строки.ПостояннаяРазница КАК СуммаПРКт,
	|	Строки.ВременнаяРазница КАК СуммаВРКт,
	|	
	|	""Отражение доп. расходов"" КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.СебестоимостьТоваров КАК Строки
	|	ПО
	|		ДокументыКОтражению.Ссылка = Строки.Регистратор
	|		И Строки.Количество = 0
	|		И ВЫБОР
	|			КОГДА ТИПЗНАЧЕНИЯ(Строки.Регистратор) = ТИП(Документ.РаспределениеПрочихЗатрат)
	|			ТОГДА
	|				(Строки.СтоимостьРегл <> 0 ИЛИ Строки.ПостояннаяРазница  <> 0 ИЛИ Строки.ВременнаяРазница <> 0
	|					ИЛИ Строки.ДопРасходыРегл <> 0 ИЛИ Строки.ДопРасходыУпр <> 0
	|					ИЛИ Строки.ТрудозатратыРегл  <> 0 ИЛИ Строки.ТрудозатратыУпр <> 0
	|					ИЛИ Строки.ПостатейныеПостоянныеРегл <> 0 ИЛИ Строки.ПостатейныеПостоянныеУпр <> 0
	|					ИЛИ Строки.ПостатейныеПеременныеРегл <> 0 ИЛИ Строки.ПостатейныеПеременныеУпр <> 0)
	|			ИНАЧЕ
	|				(Строки.СтоимостьРегл <> 0 ИЛИ Строки.ДопРасходыРегл <> 0 ИЛИ Строки.ДопРасходыУпр <> 0)
	|				И НЕ Строки.РасчетСебестоимости
	|				И НЕ Строки.РазделУчета В (
	|						ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|						ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НеотфактурованныеПоставки))
	|		КОНЕЦ
	|		И Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|		И Строки.Активность
	|		И НЕ Строки.Сторно
	|		И НЕ Строки.ТипЗаписи В (ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимости),
	|			ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимостиНаПрочиеРасходы),
	|			ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимостиНаПрочиеДоходы))
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Справочник.КлючиАналитикиУчетаНоменклатуры КАК Аналитика
	|	ПО
	|		Строки.АналитикаУчетаНоменклатуры = Аналитика.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Назначения КАК Назначения
	|		ПО Аналитика.Назначение = Назначения.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ПрочиеРасходы КАК ПрочиеРасходы
	|	ПО
	|		Строки.Регистратор = ПрочиеРасходы.Регистратор
	|		И Строки.Организация = ПрочиеРасходы.Организация
	|		И Строки.СтатьяРасходовСписания = ПрочиеРасходы.СтатьяРасходов
	|		И Строки.ИдентификаторФинЗаписи = ПрочиеРасходы.ИдентификаторФинЗаписи
	|		И Строки.НастройкаХозяйственнойОперации = ПрочиеРасходы.НастройкаХозяйственнойОперации
	|		И НЕ ПрочиеРасходы.Сторно
	|		И Строки.РасчетСебестоимости = ПрочиеРасходы.РасчетСебестоимости
	|		И Строки.РасчетПартий = ПрочиеРасходы.РасчетПартий
	|		И ПрочиеРасходы.ИдентификаторФинЗаписи <> """"
	|	
	|ГДЕ
	|	НЕ Строки.СтатьяРасходовСписания В (НЕОПРЕДЕЛЕНО,
	|										ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка),
	|										ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.НДСНалоговогоАгента))
	|";
	
#КонецОбласти

#Область РаспределениеНДС // Отражение доп. расходов по НДС налогового агента (Дт 10, 20, 41, 45 :: Кт 19.03, 19.11)

	ТекстРаспределенияНДС =
	"ВЫБРАТЬ //// Отражение доп. расходов по НДС налогового агента (Дт 10, 20, 41, 45 :: Кт 19.03, 19.11) @НДСПредъявленный
	|	Операция.Ссылка КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	(Строки.СтоимостьРегл + Строки.ДопРасходыРегл + ТрудозатратыРегл + ПостатейныеПостоянныеРегл + ПостатейныеПеременныеРегл) КАК Сумма,
	|	Строки.ДопРасходыУпр + ТрудозатратыУпр + ПостатейныеПостоянныеУпр + ПостатейныеПеременныеУпр КАК СуммаУУ,
	|
	|	ВЫБОР
	|		КОГДА Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|				&ЗабалансовыеРазделыУчета)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссиюВПути))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РеализацияБезПереходаПраваСобственности)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|	КОНЕЦ КАК ВидСчетаДт,
	|	
	|	ВЫБОР
	|		КОГДА Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|				&ЗабалансовыеРазделыУчета)
	|		ТОГДА ВЫБОР
	|				КОГДА &ПартионныйУчетВерсии22 И Строки.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ)
	|					И ТИПЗНАЧЕНИЯ(Строки.АналитикаФинансовогоУчета) = ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|					ТОГДА Строки.АналитикаФинансовогоУчета
	|				ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|			КОНЕЦ
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|		ТОГДА Строки.ВидЗапасов.ГруппаФинансовогоУчета
	|		ИНАЧЕ Аналитика.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК АналитикаУчетаДт,
	|	ВЫБОР
	|		КОГДА (Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|				&ЗабалансовыеРазделыУчета))
	|			И Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссиюВПути))
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Аналитика.МестоХранения
	|	КОНЕЦ КАК МестоУчетаДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВалютаДт,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЕСТЬNULL(Строки.ВидЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Аналитика.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА Аналитика.Договор.Подразделение
	|		КОГДА Строки.РазделУчета В (
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЕСТЬNULL(Строки.ВидЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ПодразделениеДт,
	|	ЕСТЬNULL(Назначения.НаправлениеДеятельности,
	|		ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)) КАК НаправлениеДеятельностиДт,
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	Аналитика.Номенклатура  КАК СубконтоДт1,
	|	ВЫБОР
	|		КОГДА Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|				&ЗабалансовыеРазделыУчета)
	|		ТОГДА ВЫБОР
	|				КОГДА &ПартионныйУчетВерсии22 И Строки.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ)
	|					И ТИПЗНАЧЕНИЯ(Строки.АналитикаФинансовогоУчета) = ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|					ТОГДА Строки.АналитикаФинансовогоУчета
	|				ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|			КОНЕЦ
	|		ИНАЧЕ Аналитика.МестоХранения
	|	КОНЕЦ КАК СубконтоДт2,
	|	ВЫБОР
	|		КОГДА Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство),
	|				&ЗабалансовыеРазделыУчета)
	|			И Строки.ВидЗапасов = ЗНАЧЕНИЕ(Справочник.ВидыЗапасов.ПустаяСсылка)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Работы)
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссиюВПути))
	|			И Аналитика.ТипМестаХранения В (ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента),
	|											ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер))
	|		ТОГДА Аналитика.Контрагент
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.МатериальныеЗатраты)
	|	КОНЕЦ КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	(Строки.СтоимостьРегл + Строки.ДопРасходыРегл + ТрудозатратыРегл + ПостатейныеПостоянныеРегл + ПостатейныеПеременныеРегл - Строки.ПостояннаяРазница - Строки.ВременнаяРазница) КАК СуммаНУДт,
	|	Строки.ПостояннаяРазница КАК СуммаПРДт,
	|	Строки.ВременнаяРазница КАК СуммаВРДт,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НДСпоПриобретеннымЦенностям) КАК ВидСчетаКт,
	|	Строки.КорВидДеятельностиНДС КАК АналитикаУчетаКт,
	|	Строки.КорАналитикаУчетаПартий.ВидЦенности КАК МестоУчетаКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) < &ДатаНачалаУчетаНДСПоНаправлениямДеятельности
	|		ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|		ИНАЧЕ Строки.КорНаправлениеДеятельности
	|	КОНЕЦ КАК НаправлениеДеятельностиКт,
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Строки.КорАналитикаУчетаПартий.Контрагент КАК СубконтоКт1,
	|	ВЫБОР
	|		КОГДА ТИПЗНАЧЕНИЯ(Строки.ДокументДвижения) В (ТИП(Документ.СчетФактураНалоговыйАгент),
	|													ТИП(Документ.СчетФактураПолученныйНалоговыйАгент))
	|		ТОГДА Строки.ДокументДвижения
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК СубконтоКт2,
	|	ВЫБОР
	|		КОГДА Строки.СтатьяРасходовСписания = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.НДСНалоговогоАгента)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Строки.АналитикаРасходов
	|	КОНЕЦ КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	(Строки.СтоимостьРегл + Строки.ДопРасходыРегл + ТрудозатратыРегл + ПостатейныеПостоянныеРегл + ПостатейныеПеременныеРегл - Строки.ПостояннаяРазница - Строки.ВременнаяРазница) КАК СуммаНУКт,
	|	Строки.ПостояннаяРазница КАК СуммаПРКт,
	|	Строки.ВременнаяРазница КАК СуммаВРКт,
	|	
	|	""Отражение доп. расходов"" КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ДокументИмя КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.СебестоимостьТоваров КАК Строки
	|	ПО
	|		Операция.Ссылка = Строки.Регистратор
	|		И Строки.Количество = 0
	|		И (Строки.СтоимостьРегл <> 0 ИЛИ Строки.ДопРасходыРегл <> 0 ИЛИ Строки.ДопРасходыУпр <> 0)
	|		И НЕ Строки.РасчетСебестоимости
	|		И Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|		И Строки.Активность
	|		И НЕ Строки.Сторно
	|		И НЕ Строки.РазделУчета В ( 
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НеотфактурованныеПоставки))
	|		И НЕ Строки.ТипЗаписи В (ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимости),
	|			ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимостиНаПрочиеРасходы),
	|			ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимостиНаПрочиеДоходы))
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Справочник.КлючиАналитикиУчетаНоменклатуры КАК Аналитика
	|	ПО
	|		Строки.АналитикаУчетаНоменклатуры = Аналитика.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Назначения КАК Назначения
	|		ПО Аналитика.Назначение = Назначения.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		РегистрСведений.ДанныеПервичныхДокументов КАК ДанныеПервичныхДокументов
	|	ПО
	|		ДанныеПервичныхДокументов.Организация = Строки.Организация
	|		И ДанныеПервичныхДокументов.Документ = Строки.ДокументДвижения
	|	
	|ГДЕ
	|	Строки.СтатьяРасходовСписания = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.НДСНалоговогоАгента)
	|";
	
	ТекстРаспределенияНДС = СтрЗаменить(ТекстРаспределенияНДС, "ДокументИмя", ДокументИмя);
	
#КонецОбласти

#Область ОтклоненияРеализация // Отклонения в себестоимости реализации (Дт 90.02 :: Кт 10, 20, 41, 45 )
	
	ТекстОтклоненияСебестоимостьРеализованногоТовара =
	"ВЫБРАТЬ //// Отклонения В себестоимости реализации (Дт 90.02 :: Кт 10, 20, 41, 45 )
	|	ДокументыКОтражению.Ссылка 	КАК Ссылка,
	|	Строки.Период 				КАК Период,
	|	Строки.Организация 			КАК Организация,
	|	НЕОПРЕДЕЛЕНО 				КАК ИдентификаторСтроки,
	|
	|	Строки.СтоимостьРегл + Строки.ДопРасходыРегл + Строки.ТрудозатратыРегл
	|		+ Строки.ПостатейныеПостоянныеРегл + Строки.ПостатейныеПеременныеРегл КАК Сумма,
	|	Строки.СтоимостьУпр + Строки.ДопРасходыУпр + Строки.ТрудозатратыУпр
	|		+ Строки.ПостатейныеПостоянныеУпр + Строки.ПостатейныеПеременныеУпр КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СебестоимостьПродаж) КАК ВидСчетаДт,
	|	
	|	ВЫБОР
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|			И Аналитика.Номенклатура.ТипНоменклатуры <> ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ТОГДА Строки.ВидЗапасов.ГруппаФинансовогоУчета
	|		ИНАЧЕ Аналитика.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК АналитикаУчетаДт,
	|	Аналитика.СкладскаяТерритория 				КАК МестоУчетаДт,
	|
	|	НЕОПРЕДЕЛЕНО 								КАК ВалютаДт,
	|	Строки.Подразделение 						КАК ПодразделениеДт,
	|	АналитикаУчетаПоПартнерам.НаправлениеДеятельности 	КАК НаправлениеДеятельностиДт,
	|	НЕОПРЕДЕЛЕНО 								КАК СчетДт,
	|
	|	Аналитика.Номенклатура 						КАК СубконтоДт1,
	|	ВЫБОР
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|			И Аналитика.Номенклатура.ТипНоменклатуры <> ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|		ТОГДА Строки.ВидЗапасов.ГруппаФинансовогоУчета
	|		ИНАЧЕ Аналитика.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ 										КАК СубконтоДт2,
	|	ЕСТЬNULL(ТаблицаНалогообложенияПрибыли.ВариантНалогообложенияПрибыли, НЕОПРЕДЕЛЕНО) КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	(Строки.СтоимостьРегл + Строки.ДопРасходыРегл + Строки.ТрудозатратыРегл
	|		+ Строки.ПостатейныеПостоянныеРегл + Строки.ПостатейныеПеременныеРегл
	|		- Строки.ПостояннаяРазница - Строки.ВременнаяРазница) КАК СуммаНУДт,
	|	Строки.ПостояннаяРазница КАК СуммаПРДт,
	|	Строки.ВременнаяРазница КАК СуммаВРДт,
	|
	|	ВЫБОР
	|		КОГДА Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										&ЗабалансовыеРазделыУчета)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗатратыНаПриобретениеТМЦ)
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссиюВПути))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РеализацияБезПереходаПраваСобственности)
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|	КОНЕЦ КАК ВидСчетаКт,
	|
	|	ВЫБОР
	|		КОГДА Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										&ЗабалансовыеРазделыУчета)
	|		ТОГДА ВЫБОР
	|				КОГДА &ПартионныйУчетВерсии22 И Строки.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ)
	|					И ТИПЗНАЧЕНИЯ(Строки.АналитикаФинансовогоУчета) = ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|					ТОГДА Строки.АналитикаФинансовогоУчета
	|				ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|			КОНЕЦ
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|		ТОГДА Строки.ВидЗапасов.ГруппаФинансовогоУчета
	|		ИНАЧЕ Аналитика.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК АналитикаУчетаКт,
	|	ВЫБОР
	|		КОГДА (Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										&ЗабалансовыеРазделыУчета))
	|			И Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссиюВПути))
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Аналитика.МестоХранения
	|	КОНЕЦ КАК МестоУчетаКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВалютаКт,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию))
	|		ТОГДА ЕСТЬNULL(Строки.ВидЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Аналитика.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА Аналитика.Договор.Подразделение
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ПодразделениеКт,
	|	ЕСТЬNULL(Аналитика.Назначение.НаправлениеДеятельности,
	|		ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)) КАК НаправлениеДеятельностиКт,
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Аналитика.Номенклатура 	КАК СубконтоКт1,
	|	ВЫБОР
	|		КОГДА Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты)
	|			ТОГДА ВЫБОР
	|					КОГДА &ПартионныйУчетВерсии22 И Строки.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ)
	|						И ТИПЗНАЧЕНИЯ(Строки.АналитикаФинансовогоУчета) = ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|						ТОГДА Строки.АналитикаФинансовогоУчета
	|					ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|				КОНЕЦ 
	|		ИНАЧЕ
	|			Аналитика.МестоХранения 
	|	КОНЕЦ КАК СубконтоКт2,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссиюВПути))
	|		ТОГДА Аналитика.МестоХранения.Контрагент
	|		КОГДА НЕ Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			И Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										&ЗабалансовыеРазделыУчета)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.МатериальныеЗатраты)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Работы)
	|	КОНЕЦ КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	(Строки.СтоимостьРегл + Строки.ДопРасходыРегл + Строки.ТрудозатратыРегл
	|		+ Строки.ПостатейныеПостоянныеРегл + Строки.ПостатейныеПеременныеРегл
	|		- Строки.ПостояннаяРазница - Строки.ВременнаяРазница) КАК СуммаНУКт,
	|	Строки.ПостояннаяРазница КАК СуммаПРКт,
	|	Строки.ВременнаяРазница КАК СуммаВРКт,
	|	
	|	""Отклонения в стоимости товара на себестоимость продаж"" КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.СебестоимостьТоваров КАК Строки
	|	ПО
	|		ДокументыКОтражению.Ссылка = Строки.Регистратор
	|		И Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И Строки.РазделУчета <> ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НеотфактурованныеПоставки)
	|		И Строки.Активность
	|		И (Строки.РасчетПартий ИЛИ Строки.РасчетСебестоимости)
	|		И Строки.ТипЗаписи В (ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимости),
	|					ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.КорректировкаПриобретенияПрошлогоПериода),
	|					ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.РаспределениеПоВыбывшимТоварам),
	|					ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ДопРасходыБезПартии),
	|					ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ДопРасходыСПартией))
	|		И Строки.Количество = 0
	// критерий того, что расходы относятся на себестоимость продаж
	|		И Строки.СтатьяРасходовСписания = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
	|		И Строки.АналитикаУчетаПоПартнерам <> ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПоПартнерам.ПустаяСсылка)
	|		И НЕ Строки.Сторно
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Справочник.КлючиАналитикиУчетаНоменклатуры КАК Аналитика
	|	ПО
	|		Строки.АналитикаУчетаНоменклатуры = Аналитика.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		РаздельныйУчетНастройкиНалогообложенияПрибыли КАК ТаблицаНалогообложенияПрибыли
	|	ПО 
	|		ТаблицаНалогообложенияПрибыли.Период = Строки.Период
	|		И ТаблицаНалогообложенияПрибыли.Организация = Строки.Организация
	|		И ТаблицаНалогообложенияПрибыли.Подразделение = Строки.Подразделение
	|		И ТаблицаНалогообложенияПрибыли.ОбъектУчета = Аналитика.Номенклатура
	|		И ТаблицаНалогообложенияПрибыли.НаправлениеДеятельности = АналитикаУчетаПоПартнерам.НаправлениеДеятельности
	|	
	|";
	
#КонецОбласти

#Область ОтклоненияСклад // Отклонения в себестоимости товаров (Дт 10, 20, 41, 45 :: Кт 10, 20, 41, 45 )

	ТекстОтклоненияСебестоимостьНаСкладе =
	"ВЫБРАТЬ //// Отклонения В себестоимости товаров (Дт 10, 20, 41, 45 :: Кт 10, 20, 41, 45 )
	|	ДокументыКОтражению.Ссылка 	КАК Ссылка,
	|	Строки.Период 				КАК Период,
	|	Строки.Организация 			КАК Организация,
	|	НЕОПРЕДЕЛЕНО 				КАК ИдентификаторСтроки,
	|
	|	Строки.СтоимостьРегл + Строки.ДопРасходыРегл + Строки.ТрудозатратыРегл
	|		+ Строки.ПостатейныеПостоянныеРегл + Строки.ПостатейныеПеременныеРегл КАК Сумма,
	|	Строки.СтоимостьУпр + Строки.ДопРасходыУпр + Строки.ТрудозатратыУпр
	|		+ Строки.ПостатейныеПостоянныеУпр + Строки.ПостатейныеПеременныеУпр КАК СуммаУУ,
	|
	|	ВЫБОР
	|		КОГДА КорАналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										&ЗабалансовыеРазделыУчета)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|		КОГДА Строки.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА Строки.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗатратыНаПриобретениеТМЦ)
	|		КОГДА Строки.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		КОГДА Строки.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссиюВПути))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РеализацияБезПереходаПраваСобственности)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|	КОНЕЦ КАК ВидСчетаДт,
	|	
	|	ВЫБОР
	|		КОГДА КорАналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										&ЗабалансовыеРазделыУчета)
	|		ТОГДА ВЫБОР
	|				КОГДА &ПартионныйУчетВерсии22 И Строки.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ)
	|					И ТИПЗНАЧЕНИЯ(Строки.КорАналитикаФинансовогоУчета) = ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|					ТОГДА Строки.КорАналитикаФинансовогоУчета
	|				ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|			КОНЕЦ
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|		ТОГДА ЕСТЬNULL(Строки.КорВидЗапасов.ГруппаФинансовогоУчета,
	|			ЕСТЬNULL(Строки.ВидЗапасов.ГруппаФинансовогоУчета,
	|			ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка)))
	|		ИНАЧЕ ЕСТЬNULL(КорАналитика.Номенклатура.ГруппаФинансовогоУчета,
	|			ЕСТЬNULL(Аналитика.Номенклатура.ГруппаФинансовогоУчета, 
	|			ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка)))
	|	КОНЕЦ КАК АналитикаУчетаДт,
	|	ВЫБОР
	|		КОГДА (КорАналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										&ЗабалансовыеРазделыУчета))
	|			И ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА ЕСТЬNULL(КорАналитика.СкладскаяТерритория.Подразделение, Аналитика.СкладскаяТерритория.Подразделение)
	|		КОГДА Строки.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссиюВПути))
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(КорАналитика.МестоХранения, Аналитика.МестоХранения)
	|	КОНЕЦ КАК МестоУчетаДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВалютаДт,
	|	ВЫБОР
	|		КОГДА Строки.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЕСТЬNULL(ЕСТЬNULL(Строки.КорВидЗапасов.Договор.Подразделение, Строки.ВидЗапасов.Договор.Подразделение), НЕОПРЕДЕЛЕНО)
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА ЕСТЬNULL(КорАналитика.Подразделение, Аналитика.Подразделение)
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА ЕСТЬNULL(КорАналитика.Договор.Подразделение, Аналитика.Договор.Подразделение)
	|		КОГДА Строки.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЕСТЬNULL(ЕСТЬNULL(Строки.КорВидЗапасов.Договор.Подразделение, Строки.ВидЗапасов.Договор.Подразделение), НЕОПРЕДЕЛЕНО)
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА ЕСТЬNULL(КорАналитика.СкладскаяТерритория.Подразделение, Аналитика.СкладскаяТерритория.Подразделение)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ПодразделениеДт,
	|	ЕСТЬNULL(КорНазначения.НаправлениеДеятельности,
	|		ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)) КАК НаправлениеДеятельностиДт,
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	ЕСТЬNULL(КорАналитика.Номенклатура, Аналитика.Номенклатура) КАК СубконтоДт1,
	|	ВЫБОР
	|		КОГДА КорАналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										&ЗабалансовыеРазделыУчета)
	|		ТОГДА ВЫБОР
	|				КОГДА &ПартионныйУчетВерсии22 И Строки.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ)
	|					И ТИПЗНАЧЕНИЯ(Строки.КорАналитикаФинансовогоУчета) = ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|					ТОГДА Строки.КорАналитикаФинансовогоУчета
	|				ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|			КОНЕЦ
	|		ИНАЧЕ ЕСТЬNULL(КорАналитика.МестоХранения, Аналитика.МестоХранения)
	|	КОНЕЦ КАК СубконтоДт2,
	|	ВЫБОР
	|		КОГДА Строки.КорРазделУчета В (
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссиюВПути))
	|			И ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) В (
	|				ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента),
	|				ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер))
	|		ТОГДА ЕСТЬNULL(КорАналитика.Контрагент, Аналитика.Контрагент)
	|		КОГДА НЕ КорАналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			И Строки.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										&ЗабалансовыеРазделыУчета)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.МатериальныеЗатраты)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Работы)
	|	КОНЕЦ КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	(Строки.СтоимостьРегл + Строки.ДопРасходыРегл + Строки.ТрудозатратыРегл
	|		+ Строки.ПостатейныеПостоянныеРегл + Строки.ПостатейныеПеременныеРегл
	|		- Строки.ПостояннаяРазница - Строки.ВременнаяРазница) КАК СуммаНУДт,
	|	Строки.ПостояннаяРазница КАК СуммаПРДт,
	|	Строки.ВременнаяРазница КАК СуммаВРДт,
	|
	|	ВЫБОР
	|		КОГДА Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										&ЗабалансовыеРазделыУчета)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗатратыНаПриобретениеТМЦ)
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссиюВПути))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РеализацияБезПереходаПраваСобственности)
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|	КОНЕЦ КАК ВидСчетаКт,
	|
	|	ВЫБОР
	|		КОГДА Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										&ЗабалансовыеРазделыУчета)
	|		ТОГДА ВЫБОР
	|				КОГДА &ПартионныйУчетВерсии22 И Строки.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ)
	|					И ТИПЗНАЧЕНИЯ(Строки.АналитикаФинансовогоУчета) = ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|					ТОГДА Строки.АналитикаФинансовогоУчета
	|				ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|			КОНЕЦ
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|		ТОГДА ЕСТЬNULL(Строки.ВидЗапасов.ГруппаФинансовогоУчета, НЕОПРЕДЕЛЕНО)
	|		ИНАЧЕ ЕСТЬNULL(Аналитика.Номенклатура.ГруппаФинансовогоУчета, НЕОПРЕДЕЛЕНО)
	|	КОНЕЦ КАК АналитикаУчетаКт,
	|	ВЫБОР
	|		КОГДА (Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										&ЗабалансовыеРазделыУчета))
	|			И Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссиюВПути))
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Аналитика.МестоХранения
	|	КОНЕЦ КАК МестоУчетаКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВалютаКт,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЕСТЬNULL(Строки.ВидЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Аналитика.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА Аналитика.Договор.Подразделение
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЕСТЬNULL(Строки.ВидЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ПодразделениеКт,
	|	ЕСТЬNULL(Аналитика.Назначение.НаправлениеДеятельности,
	|		ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)) КАК НаправлениеДеятельностиКт,
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Аналитика.Номенклатура 	КАК СубконтоКт1,
	|	ВЫБОР
	|		КОГДА Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										&ЗабалансовыеРазделыУчета)
	|		ТОГДА ВЫБОР
	|				КОГДА &ПартионныйУчетВерсии22 И Строки.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ)
	|					И ТИПЗНАЧЕНИЯ(Строки.АналитикаФинансовогоУчета) = ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|					ТОГДА Строки.АналитикаФинансовогоУчета
	|				ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|			КОНЕЦ
	|		ИНАЧЕ Аналитика.МестоХранения
	|	КОНЕЦ КАК СубконтоКт2,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета В (
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути))
	|			И Аналитика.ТипМестаХранения В (ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента),
	|											ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер))
	|		ТОГДА Аналитика.Контрагент
	|		КОГДА НЕ Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			И Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										&ЗабалансовыеРазделыУчета)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.МатериальныеЗатраты)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Работы)
	|	КОНЕЦ КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	(Строки.СтоимостьРегл + Строки.ДопРасходыРегл + Строки.ТрудозатратыРегл
	|		+ Строки.ПостатейныеПостоянныеРегл + Строки.ПостатейныеПеременныеРегл
	|		- Строки.ПостояннаяРазница - Строки.ВременнаяРазница) КАК СуммаНУКт,
	|	Строки.ПостояннаяРазница КАК СуммаПРКт,
	|	Строки.ВременнаяРазница КАК СуммаВРКт,
	|	
	|	""Отклонения в стоимости товара"" КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.СебестоимостьТоваров КАК Строки
	|	ПО
	|		ДокументыКОтражению.Ссылка = Строки.Регистратор 
	|		И Строки.РазделУчета <> ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НеотфактурованныеПоставки)
	|		И Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И Строки.Активность
	|		И (Строки.РасчетПартий ИЛИ Строки.РасчетСебестоимости)
	|		И Строки.ТипЗаписи В (ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимости),
	|							ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.КорректировкаПриобретенияПрошлогоПериода),
	|							ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.РаспределениеПоВыбывшимТоварам),
	|							ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ДопРасходыБезПартии),
	|							ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ДопРасходыСПартией))
	|		И Строки.Количество = 0
	// критерий того, что расходы относятся на себестоимость на складе/производство
	|		И Строки.АналитикаУчетаПоПартнерам = ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПоПартнерам.ПустаяСсылка)
	|		И Строки.СтатьяДоходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиДоходов.ПустаяСсылка)
	|		И Строки.СтатьяРасходовСписания = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
	|		И НЕ Строки.Сторно
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Справочник.КлючиАналитикиУчетаНоменклатуры КАК Аналитика
	|	ПО
	|		Строки.АналитикаУчетаНоменклатуры = Аналитика.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Назначения КАК Назначения
	|		ПО Аналитика.Назначение = Назначения.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Справочник.КлючиАналитикиУчетаНоменклатуры КАК КорАналитика
	|	ПО
	|		Строки.КорАналитикаУчетаНоменклатуры = КорАналитика.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Назначения КАК КорНазначения
	|		ПО КорАналитика.Назначение = КорНазначения.Ссылка
	|";
	
#КонецОбласти
	
#Область ОтклоненияРасходы // Отклонения в расходы (Дт <44> :: Кт 10, 20, 41, 45 )

	ТекстОтклоненияРасходы =
	"ВЫБРАТЬ //// Отклонения В расходы (Дт <44> :: Кт 10, 20, 41, 45 )
	|	ДокументыКОтражению.Ссылка 		КАК Ссылка,
	|	Строки.Период 			КАК Период,
	|	Строки.Организация 		КАК Организация,
	|	НЕОПРЕДЕЛЕНО 			КАК ИдентификаторСтроки,
	|
	|	(ВЫБОР
	|		КОГДА Строки.СтоимостьРегл < 0
	|			ТОГДА -(Строки.СтоимостьРегл + Строки.ДопРасходыРегл + Строки.ТрудозатратыРегл
	|				+ Строки.ПостатейныеПостоянныеРегл + Строки.ПостатейныеПеременныеРегл)
	|		КОГДА Строки.СтоимостьРегл > 0
	|			ТОГДА Строки.СтоимостьРегл + Строки.ДопРасходыРегл + Строки.ТрудозатратыРегл
	|				+ Строки.ПостатейныеПостоянныеРегл + Строки.ПостатейныеПеременныеРегл
	|		ИНАЧЕ Строки.ДопРасходыРегл КОНЕЦ) КАК Сумма,
	|	(ВЫБОР
	|		КОГДА Строки.СтоимостьУпр < 0
	|			ТОГДА -(Строки.СтоимостьУпр + Строки.ДопРасходыУпр + Строки.ТрудозатратыУпр
	|				+ Строки.ПостатейныеПостоянныеУпр + Строки.ПостатейныеПеременныеУпр)
	|		КОГДА Строки.СтоимостьУпр > 0
	|			ТОГДА Строки.СтоимостьУпр + Строки.ДопРасходыУпр + Строки.ТрудозатратыУпр
	|				+ Строки.ПостатейныеПостоянныеУпр + Строки.ПостатейныеПеременныеУпр
	|		ИНАЧЕ Строки.ДопРасходыУпр КОНЕЦ) КАК СуммаУУ,
	|
	|	(ВЫБОР
	|		КОГДА Статья.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы) 
	|			  И Статья.ВидЦенностиНДС = ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.ПрочиеРаботыИУслуги)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеОперации)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КОНЕЦ) КАК ВидСчетаДт,
	|	Строки.СтатьяРасходовСписания КАК АналитикаУчетаДт,
	|	Строки.Подразделение КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	ВЫБОР
	|		КОГДА Строки.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеТоваровПоТребованию)
	|			И ТИПЗНАЧЕНИЯ(Строки.КорПартия) = ТИП(Справочник.ПартииПроизводства)
	|		ТОГДА ВЫРАЗИТЬ(Строки.КорПартия КАК Справочник.ПартииПроизводства).НаправлениеДеятельности
	|		КОГДА Строки.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеТоваровПоТребованию)
	|			И ТИПЗНАЧЕНИЯ(Строки.КорПартия) <> ТИП(Справочник.ПартииПроизводства)
	|		ТОГДА ЕСТЬNULL(Строки.КорАналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности, Строки.КорНаправлениеДеятельности)
	|		КОГДА Строки.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.РаспределениеПоВыбывшимТоварам)
	|			ТОГДА Строки.КорНаправлениеДеятельности
	|		ИНАЧЕ Назначение.НаправлениеДеятельности
	|	КОНЕЦ КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|
	|	Строки.СтатьяРасходовСписания КАК СубконтоДт1,
	|	Строки.АналитикаРасходов КАК СубконтоДт2,
	|	(ВЫБОР
	|		КОГДА Статья.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|			ТОГДА
	|				ВЫБОР КОГДА ОбъектыСтроительства.СпособСтроительства <> ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.ПустаяСсылка) 
	|						ТОГДА ОбъектыСтроительства.СпособСтроительства
	|					ИНАЧЕ 
	|						ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.Подрядный) 
	|				КОНЕЦ
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее) КОНЕЦ) КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	(ВЫБОР
	|		КОГДА НЕ Строки.СтатьяРасходовСписания.ПринятиеКНалоговомуУчету 
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР КОГДА Строки.СтоимостьРегл < 0
	|				ТОГДА -(Строки.СтоимостьРегл + Строки.ДопРасходыРегл + Строки.ТрудозатратыРегл
	|					+ Строки.ПостатейныеПостоянныеРегл + Строки.ПостатейныеПеременныеРегл)
	|					+ Строки.ПостояннаяРазница + Строки.ВременнаяРазница
	|			КОГДА Строки.СтоимостьРегл > 0
	|				ТОГДА Строки.СтоимостьРегл + Строки.ДопРасходыРегл + Строки.ТрудозатратыРегл
	|					+ Строки.ПостатейныеПостоянныеРегл + Строки.ПостатейныеПеременныеРегл
	|					- Строки.ПостояннаяРазница - Строки.ВременнаяРазница
	|			ИНАЧЕ Строки.ДопРасходыРегл - Строки.ПостояннаяРазница - Строки.ВременнаяРазница КОНЕЦ
	|	КОНЕЦ) КАК СуммаНУДт,
	|	(ВЫБОР
	|		КОГДА Строки.СтоимостьРегл < 0 ТОГДА -Строки.ПостояннаяРазница
	|		КОГДА Строки.СтоимостьРегл > 0 ТОГДА Строки.ПостояннаяРазница
	|		ИНАЧЕ Строки.ПостояннаяРазница КОНЕЦ
	|	+ ВЫБОР
	|		КОГДА Строки.СтатьяРасходовСписания.ПринятиеКНалоговомуУчету ТОГДА 0
	|		ИНАЧЕ ВЫБОР КОГДА Строки.СтоимостьРегл < 0
	|				ТОГДА -(Строки.СтоимостьРегл + Строки.ДопРасходыРегл + Строки.ТрудозатратыРегл
	|					+ Строки.ПостатейныеПостоянныеРегл + Строки.ПостатейныеПеременныеРегл)
	|					+ Строки.ПостояннаяРазница + Строки.ВременнаяРазница
	|			КОГДА Строки.СтоимостьРегл > 0
	|				ТОГДА Строки.СтоимостьРегл + Строки.ДопРасходыРегл + Строки.ТрудозатратыРегл
	|					+ Строки.ПостатейныеПостоянныеРегл + Строки.ПостатейныеПеременныеРегл
	|					- Строки.ПостояннаяРазница - Строки.ВременнаяРазница
	|			ИНАЧЕ Строки.ДопРасходыРегл - Строки.ПостояннаяРазница - Строки.ВременнаяРазница КОНЕЦ
	|	КОНЕЦ) КАК СуммаПРДт,
	|	(ВЫБОР
	|		КОГДА Строки.СтоимостьРегл < 0 ТОГДА -Строки.ВременнаяРазница
	|		КОГДА Строки.СтоимостьРегл > 0 ТОГДА Строки.ВременнаяРазница
	|		ИНАЧЕ Строки.ВременнаяРазница КОНЕЦ) КАК СуммаВРДт,
	|	ВЫБОР
	|		КОГДА Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										&ЗабалансовыеРазделыУчета)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗатратыНаПриобретениеТМЦ)
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссиюВПути))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РеализацияБезПереходаПраваСобственности)
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|	КОНЕЦ КАК ВидСчетаКт,
	|
	|	ВЫБОР
	|		КОГДА Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										&ЗабалансовыеРазделыУчета)
	|		ТОГДА ВЫБОР
	|				КОГДА &ПартионныйУчетВерсии22 И Строки.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ)
	|					И ТИПЗНАЧЕНИЯ(Строки.АналитикаФинансовогоУчета) = ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|					ТОГДА Строки.АналитикаФинансовогоУчета
	|				ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|			КОНЕЦ
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|		ТОГДА Строки.ВидЗапасов.ГруппаФинансовогоУчета
	|		ИНАЧЕ Аналитика.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК АналитикаУчетаКт,
	|	ВЫБОР
	|		КОГДА (Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										&ЗабалансовыеРазделыУчета))
	|			И Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссиюВПути))
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Аналитика.МестоХранения
	|	КОНЕЦ КАК МестоУчетаКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВалютаКт,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЕСТЬNULL(Строки.ВидЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Аналитика.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА Аналитика.Договор.Подразделение
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЕСТЬNULL(Строки.ВидЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ПодразделениеКт,
	|	ЕСТЬNULL(Аналитика.Назначение.НаправлениеДеятельности,
	|		ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)) КАК НаправлениеДеятельностиКт,
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Аналитика.Номенклатура 	КАК СубконтоКт1,
	|	ВЫБОР
	|		КОГДА Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										&ЗабалансовыеРазделыУчета)
	|		ТОГДА ВЫБОР
	|				КОГДА &ПартионныйУчетВерсии22 И Строки.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ)
	|					И ТИПЗНАЧЕНИЯ(Строки.АналитикаФинансовогоУчета) = ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|					ТОГДА Строки.АналитикаФинансовогоУчета
	|				ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|			КОНЕЦ
	|		ИНАЧЕ Аналитика.МестоХранения
	|	КОНЕЦ КАК СубконтоКт2,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссиюВПути))
	|			И Аналитика.ТипМестаХранения В (ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента),
	|											ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер))
	|		ТОГДА Аналитика.Контрагент
	|		КОГДА НЕ Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			И Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										&ЗабалансовыеРазделыУчета)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.МатериальныеЗатраты)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Работы)
	|	КОНЕЦ КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	(ВЫБОР
	|		КОГДА Строки.СтоимостьРегл < 0
	|			ТОГДА -(Строки.СтоимостьРегл + Строки.ДопРасходыРегл + Строки.ТрудозатратыРегл
	|				+ Строки.ПостатейныеПостоянныеРегл + Строки.ПостатейныеПеременныеРегл)
	|				+ Строки.ПостояннаяРазница + Строки.ВременнаяРазница
	|		КОГДА Строки.СтоимостьРегл > 0
	|			ТОГДА Строки.СтоимостьРегл + Строки.ДопРасходыРегл + Строки.ТрудозатратыРегл
	|				+ Строки.ПостатейныеПостоянныеРегл + Строки.ПостатейныеПеременныеРегл
	|				- Строки.ПостояннаяРазница - Строки.ВременнаяРазница
	|		ИНАЧЕ Строки.ДопРасходыРегл - Строки.ПостояннаяРазница - Строки.ВременнаяРазница КОНЕЦ) КАК СуммаНУКт,
	|	(ВЫБОР
	|		КОГДА Строки.СтоимостьРегл < 0 ТОГДА -Строки.ПостояннаяРазница
	|		КОГДА Строки.СтоимостьРегл > 0 ТОГДА Строки.ПостояннаяРазница
	|		ИНАЧЕ Строки.ПостояннаяРазница КОНЕЦ) КАК СуммаПРКт,
	|	(ВЫБОР
	|		КОГДА Строки.СтоимостьРегл < 0 ТОГДА -Строки.ВременнаяРазница
	|		КОГДА Строки.СтоимостьРегл > 0 ТОГДА Строки.ВременнаяРазница
	|		ИНАЧЕ Строки.ВременнаяРазница КОНЕЦ) КАК СуммаВРКт,
	|	
	|	""Отклонения в стоимости товара на прочие расходы"" КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.СебестоимостьТоваров КАК Строки
	|	ПО
	|		ДокументыКОтражению.Ссылка = Строки.Регистратор
	|		И Строки.Активность
	|		И (Строки.РасчетПартий ИЛИ Строки.РасчетСебестоимости)
	|		И Строки.РазделУчета <> ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НеотфактурованныеПоставки)
	|		И Строки.ТипЗаписи В (ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимости),
	|			ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.КорректировкаПриобретенияПрошлогоПериода),
	|			ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.РаспределениеПоВыбывшимТоварам),
	|			ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимостиНаПрочиеРасходы),
	|			ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ДопРасходыБезПартии),
	|			ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ДопРасходыСПартией))
	|		И Строки.Количество = 0
	|		И (Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			И (Строки.ДопРасходыРегл <> 0 ИЛИ Строки.ДопРасходыУпр <> 0
	|				ИЛИ Строки.ВременнаяРазница <> 0 ИЛИ Строки.ПостояннаяРазница <> 0)
	|			ИЛИ Строки.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимостиНаПрочиеРасходы))
	// критерий того, что отклонения списываем на расходы
	|		И Строки.СтатьяРасходовСписания <> ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
	|		И НЕ Строки.Сторно
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		ПланВидовХарактеристик.СтатьиРасходов КАК Статья
	|	ПО 
	|		Статья.Ссылка = Строки.СтатьяРасходовСписания
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Справочник.КлючиАналитикиУчетаНоменклатуры КАК Аналитика
	|	ПО
	|		Строки.АналитикаУчетаНоменклатуры = Аналитика.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		Справочник.ОбъектыСтроительства КАК ОбъектыСтроительства
	|	ПО 
	|		ОбъектыСтроительства.Ссылка = Строки.АналитикаРасходов
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Назначения КАК Назначения
	|		ПО Аналитика.Назначение = Назначения.Ссылка
	|";
	
#КонецОбласти
	
#Область ОтклоненияДоходы // Отклонения в доходы (Дт 10, 20, 41, 45 :: Кт 91.01 )

	ТекстОтклоненияДоходы =
	"ВЫБРАТЬ //// Отклонения В доходы (Дт 10, 20, 41, 45 :: Кт 91.01 )
	|	ДокументыКОтражению.Ссылка 		КАК Ссылка,
	|	Строки.Период 				КАК Период,
	|	Строки.Организация 			КАК Организация,
	|	НЕОПРЕДЕЛЕНО 				КАК ИдентификаторСтроки,
	|
	|	(Строки.СтоимостьРегл + Строки.ДопРасходыРегл) * ВЫБОР
	|		КОГДА Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			И Строки.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимостиНаПрочиеДоходы)
	|			ТОГДА -1
	|		ИНАЧЕ
	|			1
	|	КОНЕЦ КАК Сумма,
	|	(Строки.СтоимостьУпр + Строки.ДопРасходыУпр) * ВЫБОР
	|		КОГДА Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			И Строки.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимостиНаПрочиеДоходы)
	|			ТОГДА -1
	|		ИНАЧЕ
	|			1
	|	КОНЕЦ КАК СуммаУУ,
	|
	|	ВЫБОР
	|		КОГДА Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										&ЗабалансовыеРазделыУчета)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗатратыНаПриобретениеТМЦ)
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссиюВПути))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РеализацияБезПереходаПраваСобственности)
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|	КОНЕЦ КАК ВидСчетаДт,
	|
	|	ВЫБОР
	|		КОГДА Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										&ЗабалансовыеРазделыУчета)
	|		ТОГДА ВЫБОР
	|				КОГДА &ПартионныйУчетВерсии22 И Строки.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ)
	|					И ТИПЗНАЧЕНИЯ(Строки.АналитикаФинансовогоУчета) = ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|					ТОГДА Строки.АналитикаФинансовогоУчета
	|				ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|			КОНЕЦ
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|		ТОГДА Строки.ВидЗапасов.ГруппаФинансовогоУчета
	|		ИНАЧЕ Аналитика.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК АналитикаУчетаДт,
	|	ВЫБОР
	|		КОГДА (Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										&ЗабалансовыеРазделыУчета))
	|			И Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссиюВПути))
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Аналитика.МестоХранения
	|	КОНЕЦ КАК МестоУчетаДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВалютаДт,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЕСТЬNULL(Строки.ВидЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Аналитика.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА Аналитика.Договор.Подразделение
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|		ТОГДА ЕСТЬNULL(Строки.ВидЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ПодразделениеДт,
	|	ЕСТЬNULL(Аналитика.Назначение.НаправлениеДеятельности,
	|		ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)) КАК НаправлениеДеятельностиДт,
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	Аналитика.Номенклатура 	КАК СубконтоДт1,
	|	ВЫБОР
	|		КОГДА Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			ИЛИ Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										&ЗабалансовыеРазделыУчета)
	|		ТОГДА ВЫБОР
	|				КОГДА &ПартионныйУчетВерсии22 И Строки.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ)
	|					И ТИПЗНАЧЕНИЯ(Строки.АналитикаФинансовогоУчета) = ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|					ТОГДА Строки.АналитикаФинансовогоУчета
	|				ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|			КОНЕЦ
	|		ИНАЧЕ Аналитика.МестоХранения
	|	КОНЕЦ КАК СубконтоДт2,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссиюВПути))
	|			И Аналитика.ТипМестаХранения В (ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента),
	|											ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер))
	|		ТОГДА Аналитика.Контрагент
	|		КОГДА НЕ Аналитика.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа)
	|			И Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|										&ЗабалансовыеРазделыУчета)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.МатериальныеЗатраты)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Работы)
	|	КОНЕЦ КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	(Строки.СтоимостьРегл + Строки.ДопРасходыРегл - Строки.ПостояннаяРазница - Строки.ВременнаяРазница) * ВЫБОР
	|		КОГДА Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			И Строки.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимостиНаПрочиеДоходы)
	|			ТОГДА -1
	|		ИНАЧЕ
	|			1
	|	КОНЕЦ  КАК СуммаНУДт,
	|	Строки.ПостояннаяРазница * ВЫБОР
	|		КОГДА Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			И Строки.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимостиНаПрочиеДоходы)
	|			ТОГДА -1
	|		ИНАЧЕ
	|			1
	|	КОНЕЦ КАК СуммаПРДт,
	|	Строки.ВременнаяРазница * ВЫБОР
	|		КОГДА Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			И Строки.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимостиНаПрочиеДоходы)
	|			ТОГДА -1
	|		ИНАЧЕ
	|			1
	|	КОНЕЦ КАК СуммаВРДт,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Доходы) 	КАК ВидСчетаКт,
	|	Строки.СтатьяДоходов 							 	КАК АналитикаУчетаКт,
	|	Строки.Подразделение 								КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) 			КАК ВалютаКт,
	|	Строки.Подразделение 								КАК ПодразделениеКт,
	|	Назначение.НаправлениеДеятельности 					КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) 		КАК СчетКт,
	|
	|	Строки.АналитикаДоходов КАК СубконтоКт1,
	|	Строки.СтатьяДоходов 	КАК СубконтоКт2,
	|	ЕСТЬNULL(ТаблицаНалогообложенияПрибыли.ВариантНалогообложенияПрибыли, НЕОПРЕДЕЛЕНО) КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	(Строки.СтоимостьРегл + Строки.ДопРасходыРегл - Строки.ПостояннаяРазница - Строки.ВременнаяРазница) * ВЫБОР
	|		КОГДА Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			И Строки.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимостиНаПрочиеДоходы)
	|			ТОГДА -1
	|		ИНАЧЕ
	|			1
	|	КОНЕЦ КАК СуммаНУКт,
	|	Строки.ПостояннаяРазница * ВЫБОР
	|		КОГДА Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			И Строки.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимостиНаПрочиеДоходы)
	|			ТОГДА -1
	|		ИНАЧЕ
	|			1
	|	КОНЕЦ КАК СуммаПРКт,
	|	Строки.ВременнаяРазница * ВЫБОР
	|		КОГДА Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			И Строки.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимостиНаПрочиеДоходы)
	|			ТОГДА -1
	|		ИНАЧЕ
	|			1
	|	КОНЕЦ КАК СуммаВРКт,
	|	
	|	""Отклонения в стоимости товара на прочие доходы"" КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.СебестоимостьТоваров КАК Строки
	|	ПО
	|		ДокументыКОтражению.Ссылка = Строки.Регистратор
	|		И Строки.Активность
	|		И Строки.РазделУчета <> ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НеотфактурованныеПоставки)
	|		И (Строки.РасчетПартий ИЛИ Строки.РасчетСебестоимости)
	|		И Строки.ТипЗаписи В (ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимости),
	|				ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимостиНаПрочиеДоходы),
	|				ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.КорректировкаПриобретенияПрошлогоПериода),
	|				ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.РаспределениеПоВыбывшимТоварам),
	|				ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ДопРасходыБезПартии),
	|				ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ДопРасходыСПартией))
	|		И Строки.Количество = 0
	|		И ((Строки.ДопРасходыРегл <> 0 ИЛИ Строки.ДопРасходыУпр <> 0
	|				ИЛИ Строки.ВременнаяРазница <> 0 ИЛИ Строки.ПостояннаяРазница <> 0)
	|			И Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			ИЛИ Строки.ТипЗаписи = ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимостиНаПрочиеДоходы))
	// критерий того, что отклонения отражаем в доходах
	|		И Строки.СтатьяДоходов <> ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиДоходов.ПустаяСсылка)
	|		И НЕ Строки.Сторно 
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Справочник.КлючиАналитикиУчетаНоменклатуры КАК Аналитика
	|	ПО
	|		Строки.АналитикаУчетаНоменклатуры = Аналитика.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Назначения КАК Назначения
	|		ПО Аналитика.Назначение = Назначения.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		РаздельныйУчетНастройкиНалогообложенияПрибыли КАК ТаблицаНалогообложенияПрибыли
	|	ПО 
	|		ТаблицаНалогообложенияПрибыли.Период = Строки.Период
	|		И ТаблицаНалогообложенияПрибыли.Организация = Строки.Организация
	|		И ТаблицаНалогообложенияПрибыли.Подразделение = Строки.Подразделение
	|		И ТаблицаНалогообложенияПрибыли.ОбъектУчета = Аналитика.Номенклатура
	|		И ТаблицаНалогообложенияПрибыли.НаправлениеДеятельности = Назначение.НаправлениеДеятельности
	|";
	
#КонецОбласти
	
#Область РасходыНаСебестоимостьПродаж // Расходы на себестоимость продаж (Дт 90.02 :: Кт 20, 26, 44 )
	
	ТекстРаспределениеРасходовНаСебестоимостьПродаж =
	"ВЫБРАТЬ //// Расходы на себестоимость продаж (Дт 90.02 :: Кт 20, 26, 44 )
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	КорСтроки.РасходыНаПродажуРегл КАК Сумма,
	|	КорСтроки.РасходыНаПродажуУпр КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СебестоимостьПродаж) КАК ВидСчетаДт,
	|	
	|	ЕСТЬNULL(ВидыЗапасов.ГруппаФинансовогоУчета, Аналитика.Номенклатура.ГруппаФинансовогоУчета) КАК АналитикаУчетаДт,
	|	Аналитика.СкладскаяТерритория КАК МестоУчетаДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВалютаДт,
	|	КорСтроки.Подразделение КАК ПодразделениеДт,
	|	КорСтроки.НаправлениеДеятельностиНоменклатуры КАК НаправлениеДеятельностиДт,
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	Аналитика.Номенклатура КАК СубконтоДт1,
	|	ЕСТЬNULL(ВидыЗапасов.ГруппаФинансовогоУчета, Аналитика.Номенклатура.ГруппаФинансовогоУчета) КАК СубконтоДт2,
	|	ЕСТЬNULL(ТаблицаНалогообложенияПрибыли.ВариантНалогообложенияПрибыли, НЕОПРЕДЕЛЕНО) КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	(КорСтроки.РасходыНаПродажуРегл - КорСтроки.ПостояннаяРазница - КорСтроки.ВременнаяРазница) КАК СуммаНУДт,
	|	КорСтроки.ПостояннаяРазница КАК СуммаПРДт,
	|	КорСтроки.ВременнаяРазница КАК СуммаВРДт,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаКт,
	|
	|	Строки.СтатьяРасходов КАК АналитикаУчетаКт,
	|	Строки.Подразделение КАК МестоУчетаКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Строки.СтатьяРасходов КАК СубконтоКт1,
	|	Строки.АналитикаРасходов КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	(КорСтроки.РасходыНаПродажуРегл - КорСтроки.ПостояннаяРазница - КорСтроки.ВременнаяРазница) КАК СуммаНУКт,
	|	КорСтроки.ПостояннаяРазница КАК СуммаПРКт,
	|	КорСтроки.ВременнаяРазница КАК СуммаВРКт,
	|	
	|	""Распределение расходов на себестоимость продаж"" КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ПрочиеРасходы КАК Строки
	|	ПО
	|		ДокументыКОтражению.Ссылка = Строки.Регистратор
	|		И Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И Строки.Активность
	|		И Строки.РасчетПартий
	|		И Строки.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.РаспределениеРасходовНаСебестоимостьПродаж)
	|		И НЕ Строки.Сторно
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ВыручкаИСебестоимостьПродаж КАК КорСтроки
	|	ПО
	|		КорСтроки.Регистратор = Строки.Регистратор
	|		И КорСтроки.НастройкаХозяйственнойОперации = Строки.НастройкаХозяйственнойОперации
	|		И КорСтроки.ИдентификаторФинЗаписи = Строки.ИдентификаторФинЗаписи
	|		И КорСтроки.Активность
	|		И НЕ КорСтроки.Сторно
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Справочник.КлючиАналитикиУчетаНоменклатуры КАК Аналитика
	|	ПО
	|		КорСтроки.АналитикаУчетаНоменклатуры = Аналитика.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		Справочник.ВидыЗапасов КАК ВидыЗапасов
	|	ПО
	|		КорСтроки.ВидЗапасов = ВидыЗапасов.Ссылка
	|		И &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|		И НЕ Аналитика.Номенклатура.ТипНоменклатуры В (ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа),
	|														ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга))
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		РаздельныйУчетНастройкиНалогообложенияПрибыли КАК ТаблицаНалогообложенияПрибыли
	|	ПО 
	|		ТаблицаНалогообложенияПрибыли.Период = Строки.Период
	|		И ТаблицаНалогообложенияПрибыли.Организация = Строки.Организация
	|		И ТаблицаНалогообложенияПрибыли.Подразделение = Строки.Подразделение
	|		И ТаблицаНалогообложенияПрибыли.ОбъектУчета = Аналитика.Номенклатура
	|		И ТаблицаНалогообложенияПрибыли.НаправлениеДеятельности = Строки.НаправлениеДеятельности
	|";
	
#КонецОбласти
	
#Область ОтклоненияЗабаланс // Отклонения в забалансе (Дт <> :: Кт 002,004 )
	
	ТекстОтклоненияЗабаланс =
	"ВЫБРАТЬ //// Отклонения В забалансе (Дт <> :: Кт 002,003,004)
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Строки.СтоимостьЗабалансоваяРегл КАК Сумма,
	|	Строки.СтоимостьЗабалансовая КАК СуммаУУ,
	|
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработкуКОформлениюСписания)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуКСписанию)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработкуПереданныеПартнерам)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуУХранителей)
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеКОформлениюСписания),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиКОформлениюСписания))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦКСписанию)
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦУХранителей)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			И НЕ (ЕСТЬNULL(Аналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработку)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			И ЕСТЬNULL(Аналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуВПроизводстве)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.МатериалыПринятыеВПереработку)
	|			И Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.МатериалыПотребленныеВПроизводстве)
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			И ЕСТЬNULL(Аналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦВПроизводстве)
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			И Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦПотребленныеВПроизводстве)
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи))
	|			И НЕ (ЕСТЬNULL(Аналитика.МестоХранения.ЦеховаяКладовая, ЛОЖЬ) ИЛИ Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТМЦНаСкладах)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|			И Аналитика.ТипМестаХранения В (ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер), ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Организация))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыПереданныеНаКомиссию)
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыНаСкладе)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ВидСчетаДт,
	|	ВЫБОР
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|		ТОГДА ВидыЗапасов.ГруппаФинансовогоУчета
	|		ИНАЧЕ Аналитика.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВалютаДт,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаКомиссию)
	|		ТОГДА ЕСТЬNULL(Строки.ВидЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Аналитика.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА Аналитика.Договор.Подразделение
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранение),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажи),
	|										ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПринятыеНаОтветхранениеПереданныеПартнерам))
	|		ТОГДА ЕСТЬNULL(Строки.ВидЗапасов.Договор.Подразделение, НЕОПРЕДЕЛЕНО)
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|	ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ КАК ПодразделениеДт,
	|	ЕСТЬNULL(Аналитика.Назначение.НаправлениеДеятельности,
	|		ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)) КАК НаправлениеДеятельностиДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	Аналитика.Номенклатура КАК СубконтоДт1,
	|	ВЫБОР
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА Аналитика.Договор.Контрагент
	|		КОГДА ВидыЗапасов.ТипЗапасов В (&ТипыЗапасовВнешнийВладелец)
	|		ТОГДА ВидыЗапасов.Контрагент
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаХраненииСПравомПродажиПереданныеПартнерам)
	|		ТОГДА ЕСТЬNULL(Аналитика.Контрагент, ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка))
	|		КОГДА Строки.АналитикаУчетаПоПартнерам <> ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПоПартнерам.ПустаяСсылка)
	|		ТОГДА Строки.АналитикаУчетаПоПартнерам.Контрагент
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка)
	|	КОНЕЦ КАК СубконтоДт2,
	|	Аналитика.МестоХранения КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВалютаКт,
	|	НЕОПРЕДЕЛЕНО КАК ПодразделениеКт,
	|	НЕОПРЕДЕЛЕНО КАК НаправлениеДеятельностиКт,
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	
	|	""Отклонения в стоимости товара за балансом"" КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.СебестоимостьТоваров КАК Строки
	|	ПО
	|		ДокументыКОтражению.Ссылка = Строки.Регистратор
	|		И Строки.Активность
	|		И НЕ Строки.РасчетСебестоимости
	|		И Строки.РасчетПартий
	|		И Строки.ТипЗаписи В (ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимости),
	|			ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимостиНаПрочиеРасходы),
	|			ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимостиНаПрочиеДоходы),
	|			ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.КорректировкаПриобретенияПрошлогоПериода),
	|			ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.РаспределениеПоВыбывшимТоварам),
	|			ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ДопРасходыБезПартии),
	|			ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ДопРасходыСПартией))
	|		И Строки.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|		И Строки.Количество = 0
	|		И (Строки.СтоимостьЗабалансоваяРегл <> 0)
	|		И НЕ Строки.Сторно
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Справочник.КлючиАналитикиУчетаНоменклатуры КАК Аналитика
	|	ПО
	|		Строки.АналитикаУчетаНоменклатуры = Аналитика.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		Справочник.ВидыЗапасов КАК ВидыЗапасов
	|	ПО
	|		Строки.ВидЗапасов = ВидыЗапасов.Ссылка
	|";
	
#КонецОбласти

#Область СписаниеРезервов // Списание резервов (Дт <10, 20, 41, 44, 90.02> :: Кт 14)

	ТекстСписаниеРезервов =
	"ВЫБРАТЬ //// Списание резервов (Дт <10, 20, 41, 44, 90.02> :: Кт 14)
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Строки.РезервПодОбесценениеРегл КАК Сумма,
	|	Строки.РезервПодОбесценениеУпр КАК СуммаУУ,
	|
	|	ВЫБОР
	|		КОГДА Строки.Регистратор ССЫЛКА Документ.СборкаТоваров И УчетнаяПолитикаОрганизаций.СборкаТоваровЧерезСчет20
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		КОГДА НЕ Статья.Ссылка ЕСТЬ NULL
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы)
	|		КОГДА Строки.КорРазделУчета В (
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|		КОГДА Строки.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА Строки.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗатратыНаПриобретениеТМЦ)
	|		КОГДА Строки.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		КОГДА Строки.КорРазделУчета <> ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПустаяСсылка)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|		КОГДА Строки.КорВидДеятельностиНДС В (ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяЕНВД),
	|											ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаПоПатенту))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СебестоимостьПродажЕНВД)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СебестоимостьПродаж)
	|	КОНЕЦ КАК ВидСчетаДт,
	|	ВЫБОР
	|		КОГДА НЕ Статья.Ссылка ЕСТЬ NULL
	|		ТОГДА Строки.СтатьяРасходовСписания
	|		КОГДА Строки.КорРазделУчета В (
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|		ТОГДА ВЫБОР
	|				КОГДА &ПартионныйУчетВерсии22 И Строки.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ)
	|					И ТИПЗНАЧЕНИЯ(Строки.КорАналитикаФинансовогоУчета) = ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|					ТОГДА Строки.КорАналитикаФинансовогоУчета
	|				ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|			КОНЕЦ
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|		ТОГДА ЕСТЬNULL(Строки.КорВидЗапасов.ГруппаФинансовогоУчета,
	|			ЕСТЬNULL(Строки.ВидЗапасов.ГруппаФинансовогоУчета,
	|			ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка)))
	|		ИНАЧЕ ЕСТЬNULL(КорАналитика.Номенклатура.ГруппаФинансовогоУчета,
	|			ЕСТЬNULL(Аналитика.Номенклатура.ГруппаФинансовогоУчета, 
	|			ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка)))
	|	КОНЕЦ КАК АналитикаУчетаДт,
	|	ВЫБОР
	|		КОГДА НЕ Статья.Ссылка ЕСТЬ NULL
	|		ТОГДА Строки.Подразделение
	|		КОГДА Строки.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику))
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		КОГДА Строки.КорРазделУчета В (
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|			И ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения)
	|				= ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА ЕСТЬNULL(КорАналитика.СкладскаяТерритория.Подразделение, Аналитика.СкладскаяТерритория.Подразделение)
	|		ИНАЧЕ ЕСТЬNULL(КорАналитика.МестоХранения, Аналитика.МестоХранения)
	|	КОНЕЦ КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	ВЫБОР
	|		КОГДА Строки.АналитикаУчетаПоПартнерам <> ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПоПартнерам.ПустаяСсылка)
	|		ТОГДА Строки.Подразделение
	|		КОГДА НЕ Статья.Ссылка ЕСТЬ NULL
	|		ТОГДА Строки.Подразделение
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА ЕСТЬNULL(КорАналитика.СкладскаяТерритория.Подразделение, Аналитика.СкладскаяТерритория.Подразделение)
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА ЕСТЬNULL(КорАналитика.Подразделение, Аналитика.Подразделение)
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА ЕСТЬNULL(КорАналитика.Договор.Подразделение, Аналитика.Договор.Подразделение)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ПодразделениеДт,
	|	ВЫБОР КОГДА Строки.АналитикаУчетаПоПартнерам <> ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаПоПартнерам.ПустаяСсылка)
	|		ТОГДА Строки.АналитикаУчетаПоПартнерам.НаправлениеДеятельности
	|		ИНАЧЕ Строки.КорНаправлениеДеятельности
	|	КОНЕЦ КАК НаправлениеДеятельностиДт,
	|
	|	ВЫБОР
	|		КОГДА Строки.Регистратор ССЫЛКА Документ.СборкаТоваров И УчетнаяПолитикаОрганизаций.СборкаТоваровЧерезСчет20
	|		ТОГДА ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ОсновноеПроизводство)
	|		ИНАЧЕ ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)
	|	КОНЕЦ КАК СчетДт,
	|
	|	ВЫБОР
	|		КОГДА НЕ Статья.Ссылка ЕСТЬ NULL
	|		ТОГДА Строки.СтатьяРасходовСписания
	|		ИНАЧЕ ЕСТЬNULL(КорАналитика.Номенклатура, Аналитика.Номенклатура)
	|	КОНЕЦ КАК СубконтоДт1,
	|	ВЫБОР
	|		КОГДА НЕ Статья.Ссылка ЕСТЬ NULL
	|		ТОГДА Строки.АналитикаРасходов
	|		КОГДА Строки.КорРазделУчета В (
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|		ТОГДА ВЫБОР
	|				КОГДА &ПартионныйУчетВерсии22 И Строки.Период >= НАЧАЛОПЕРИОДА(&ДатаПереходаНаПартионныйУчетВерсии22, МЕСЯЦ)
	|					И ТИПЗНАЧЕНИЯ(Строки.КорАналитикаФинансовогоУчета) = ТИП(Справочник.ГруппыАналитическогоУчетаНоменклатуры)
	|					ТОГДА Строки.КорАналитикаФинансовогоУчета
	|				ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ГруппыАналитическогоУчетаНоменклатуры.ПустаяСсылка)
	|			КОНЕЦ
	|		КОГДА Строки.КорРазделУчета <> ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПустаяСсылка)
	|		ТОГДА ЕСТЬNULL(КорАналитика.МестоХранения, Аналитика.МестоХранения)
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|		ТОГДА ЕСТЬNULL(Строки.КорВидЗапасов.ГруппаФинансовогоУчета,
	|			ЕСТЬNULL(Строки.ВидЗапасов.ГруппаФинансовогоУчета,
	|			ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка)))
	|		ИНАЧЕ ЕСТЬNULL(КорАналитика.Номенклатура.ГруппаФинансовогоУчета,
	|			ЕСТЬNULL(Аналитика.Номенклатура.ГруппаФинансовогоУчета,
	|			ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка)))
	|	КОНЕЦ КАК СубконтоДт2,
	|	ВЫБОР
	|		КОГДА НЕ ТаблицаНалогообложенияПрибыли.ВариантНалогообложенияПрибыли ЕСТЬ NULL
	|		ТОГДА ТаблицаНалогообложенияПрибыли.ВариантНалогообложенияПрибыли
	|		КОГДА ЕСТЬNULL(Статья.ВариантРаспределенияРасходовРегл, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|			И ЕСТЬNULL(ОбъектыСтроительства.СпособСтроительства, ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.ПустаяСсылка)) <> ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.ПустаяСсылка)
	|		ТОГДА ОбъектыСтроительства.СпособСтроительства
	|		КОГДА ЕСТЬNULL(Статья.ВариантРаспределенияРасходовРегл, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|			И ЕСТЬNULL(ОбъектыСтроительства.СпособСтроительства, ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.ПустаяСсылка)) = ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.ПустаяСсылка)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.Подрядный)
	|		КОГДА ЕСТЬNULL(Статья.ВариантРаспределенияРасходовРегл, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.ПустаяСсылка)) <> ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.ПустаяСсылка)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее)
	|		КОГДА Строки.КорРазделУчета В (
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|			И ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) В (
	|				ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента),
	|				ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер))
	|		ТОГДА ЕСТЬNULL(КорАналитика.Контрагент, Аналитика.Контрагент)
	|		КОГДА Строки.КорРазделУчета В (
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|			И Строки.КорВидЗапасов = ЗНАЧЕНИЕ(Справочник.ВидыЗапасов.ПустаяСсылка)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Работы)
	|		КОГДА Строки.Регистратор ССЫЛКА Документ.СборкаТоваров И УчетнаяПолитикаОрганизаций.СборкаТоваровЧерезСчет20 ИЛИ Строки.КорРазделУчета В (
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|			И Строки.КорВидЗапасов <> ЗНАЧЕНИЕ(Справочник.ВидыЗапасов.ПустаяСсылка)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.МатериальныеЗатраты)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	Строки.РезервПодОбесценениеРегл КАК СуммаВРДт,
	|
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеПроизводства)
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеПереданные)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеТМЦ)
	|	КОНЕЦ КАК ВидСчетаКт,
	|
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты)
	|		ТОГДА Строки.АналитикаФинансовогоУчета
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|		ТОГДА ЕСТЬNULL(Строки.ВидЗапасов.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка))
	|		ИНАЧЕ ЕСТЬNULL(Аналитика.Номенклатура.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка))
	|	КОНЕЦ КАК АналитикаУчетаКт,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты)
	|			И Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику))
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Аналитика.МестоХранения
	|	КОНЕЦ КАК МестоУчетаКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВалютаКт,
	|	ВЫБОР
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Аналитика.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА Аналитика.Договор.Подразделение
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО 
	|	КОНЕЦ КАК ПодразделениеКт,
	|	ЕСТЬNULL(Назначения.НаправлениеДеятельности,
	|		ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)) КАК НаправлениеДеятельностиКт,
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Аналитика.Номенклатура КАК СубконтоКт1,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты)
	|		ТОГДА Строки.АналитикаФинансовогоУчета
	|		ИНАЧЕ Аналитика.МестоХранения
	|	КОНЕЦ КАК СубконтоКт2,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета В (
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути))
	|			И Аналитика.ТипМестаХранения В (ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента),
	|											ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер))
	|		ТОГДА Аналитика.Контрагент
	|		КОГДА Строки.ВидЗапасов = ЗНАЧЕНИЕ(Справочник.ВидыЗапасов.ПустаяСсылка)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Работы)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.МатериальныеЗатраты)
	|	КОНЕЦ КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	Строки.РезервПодОбесценениеРегл КАК СуммаВРКт,
	|	
	|	ВЫБОР
	|		КОГДА Строки.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеРезервовПодОбесценениеЗапасов)
	|		ТОГДА ""Списание резервов под обесценение запасов""
	|		ИНАЧЕ ""Восстановление резервов под обесценение запасов""
	|	КОНЕЦ КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.СебестоимостьТоваров КАК Строки
	|	ПО
	|		ДокументыКОтражению.Ссылка = Строки.Регистратор
	|		И Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И Строки.Активность
	|		И Строки.РасчетСебестоимости
	|		И НЕ Строки.РасчетПартий
	|		И Строки.ХозяйственнаяОперация В (
	|			ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеРезервовПодОбесценениеЗапасов),
	|			ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВосстановлениеРезервовПодОбесценениеЗапасов),
	|			ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.НачислениеРезерваПодОбесценениеЗапасов))
	|		И Строки.Количество = 0
	|		И (Строки.РезервПодОбесценениеРегл <> 0 ИЛИ Строки.РезервПодОбесценениеУпр <> 0)
	// критерий того, что списания не отражаем в доходах
	|		И Строки.СтатьяДоходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиДоходов.ПустаяСсылка)
	|		И НЕ Строки.Сторно
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ УчетнаяПолитикаОрганизаций КАК УчетнаяПолитикаОрганизаций ПО
	|		ДокументыКОтражению.Ссылка = УчетнаяПолитикаОрганизаций.Ссылка
	|			И ДокументыКОтражению.Период = УчетнаяПолитикаОрганизаций.Период
	|			И Строки.Организация = УчетнаяПолитикаОрганизаций.Организация
	|           И НАЧАЛОПЕРИОДА(Строки.Период, ДЕНЬ) = УчетнаяПолитикаОрганизаций.ДатаОтражения
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		ПланВидовХарактеристик.СтатьиРасходов КАК Статья
	|	ПО 
	|		Статья.Ссылка = Строки.СтатьяРасходовСписания
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Справочник.КлючиАналитикиУчетаНоменклатуры КАК Аналитика
	|	ПО
	|		Строки.АналитикаУчетаНоменклатуры = Аналитика.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		Справочник.КлючиАналитикиУчетаНоменклатуры КАК КорАналитика
	|	ПО
	|		Строки.КорАналитикаУчетаНоменклатуры = КорАналитика.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		Справочник.ОбъектыСтроительства КАК ОбъектыСтроительства
	|	ПО 
	|		ОбъектыСтроительства.Ссылка = Строки.АналитикаРасходов
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Назначения КАК Назначения
	|		ПО Аналитика.Назначение = Назначения.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		РаздельныйУчетНастройкиНалогообложенияПрибыли КАК ТаблицаНалогообложенияПрибыли
	|	ПО 
	|		ТаблицаНалогообложенияПрибыли.Период = Строки.Период
	|		И ТаблицаНалогообложенияПрибыли.Организация = Строки.Организация
	|		И ТаблицаНалогообложенияПрибыли.Подразделение = Строки.Подразделение
	|		И ТаблицаНалогообложенияПрибыли.ОбъектУчета = Аналитика.Номенклатура
	|		И ТаблицаНалогообложенияПрибыли.НаправлениеДеятельности = ЕСТЬNULL(Назначения.НаправлениеДеятельности,
	|			ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка))
	|		И Строки.КорРазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПустаяСсылка)
	|";
	
#КонецОбласти

#Область СписаниеРезервовДоходы // Списание резервов в доходы (Дт <14> :: Кт 91.01)
	ТекстСписаниеРезервовДоходы =
	"ВЫБРАТЬ //// Списание резервов в доходы (Дт <14> :: Кт 91.01)
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	-Строки.РезервПодОбесценениеРегл КАК Сумма,
	|	-Строки.РезервПодОбесценениеУпр КАК СуммаУУ,
	|
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеПроизводства)
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеПереданные)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеТМЦ)
	|	КОНЕЦ КАК ВидСчетаДт,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты)
	|		ТОГДА Строки.АналитикаФинансовогоУчета
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|		ТОГДА ЕСТЬNULL(Строки.ВидЗапасов.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка))
	|		ИНАЧЕ ЕСТЬNULL(Аналитика.Номенклатура.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка))
	|	КОНЕЦ КАК АналитикаУчетаДт,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты)
	|			И Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику))
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Аналитика.МестоХранения
	|	КОНЕЦ КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	ВЫБОР
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Аналитика.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА Аналитика.Договор.Подразделение
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ПодразделениеДт,
	|	ЕСТЬNULL(Назначения.НаправлениеДеятельности,
	|		ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)) КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|
	|	Аналитика.Номенклатура КАК СубконтоДт1,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты)
	|		ТОГДА Строки.АналитикаФинансовогоУчета
	|		ИНАЧЕ Аналитика.МестоХранения
	|	КОНЕЦ КАК СубконтоДт2,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета В (
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути))
	|			И Аналитика.ТипМестаХранения В (ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента),
	|											ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер))
	|		ТОГДА Аналитика.Контрагент
	|		КОГДА Строки.ВидЗапасов = ЗНАЧЕНИЕ(Справочник.ВидыЗапасов.ПустаяСсылка)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Работы)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.МатериальныеЗатраты)
	|	КОНЕЦ КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	-Строки.РезервПодОбесценениеРегл КАК СуммаВРДт,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Доходы) КАК ВидСчетаКт,
	|
	|	ПрочиеДоходы.СтатьяДоходов КАК АналитикаУчетаКт,
	|	ПрочиеДоходы.Подразделение КАК МестоУчетаКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВалютаКт,
	|	ПрочиеДоходы.Подразделение КАК ПодразделениеКт,
	|	ПрочиеДоходы.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	ПрочиеДоходы.СтатьяДоходов КАК СубконтоКт1,
	|	ПрочиеДоходы.АналитикаДоходов КАК СубконтоКт2,
	|	ЕСТЬNULL(ТаблицаНалогообложенияПрибыли.ВариантНалогообложенияПрибыли, НЕОПРЕДЕЛЕНО) КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	-Строки.РезервПодОбесценениеРегл КАК СуммаВРКт,
	|	
	|	ВЫБОР
	|		КОГДА Строки.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеРезервовПодОбесценениеЗапасов)
	|		ТОГДА ""Списание резервов под обесценение запасов""
	|		ИНАЧЕ ""Восстановление резервов под обесценение запасов""
	|	КОНЕЦ КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.СебестоимостьТоваров КАК Строки
	|	ПО
	|		ДокументыКОтражению.Ссылка = Строки.Регистратор
	|		И Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И Строки.Активность
	|		И Строки.РасчетСебестоимости
	|		И НЕ Строки.РасчетПартий
	|		И Строки.ХозяйственнаяОперация В (
	|			ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеРезервовПодОбесценениеЗапасов),
	|			ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВосстановлениеРезервовПодОбесценениеЗапасов),
	|			ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.НачислениеРезерваПодОбесценениеЗапасов))
	|		И Строки.Количество = 0
	|		И (Строки.РезервПодОбесценениеРегл <> 0 ИЛИ Строки.РезервПодОбесценениеУпр <> 0)
	// критерий того, что списания отражаем в доходах
	|		И Строки.СтатьяДоходов <> ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиДоходов.ПустаяСсылка)
	|		И НЕ Строки.Сторно
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ПрочиеДоходы КАК ПрочиеДоходы
	|	ПО
	|		ПрочиеДоходы.Регистратор = Строки.Регистратор
	|		И ПрочиеДоходы.Активность
	|		И ПрочиеДоходы.ИдентификаторФинЗаписи = Строки.ИдентификаторФинЗаписи
	|		И ПрочиеДоходы.НастройкаХозяйственнойОперации = Строки.НастройкаХозяйственнойОперации
	|		И ПрочиеДоходы.СтатьяДоходов = Строки.СтатьяДоходов
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Справочник.КлючиАналитикиУчетаНоменклатуры КАК Аналитика
	|	ПО
	|		Строки.АналитикаУчетаНоменклатуры = Аналитика.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Назначения КАК Назначения
	|		ПО Аналитика.Назначение = Назначения.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ 
	|		РаздельныйУчетНастройкиНалогообложенияПрибыли КАК ТаблицаНалогообложенияПрибыли
	|	ПО 
	|		ТаблицаНалогообложенияПрибыли.Период = Строки.Период
	|		И ТаблицаНалогообложенияПрибыли.Организация = Строки.Организация
	|		И ТаблицаНалогообложенияПрибыли.Подразделение = ПрочиеДоходы.Подразделение
	|		И ТаблицаНалогообложенияПрибыли.ОбъектУчета = Аналитика.Номенклатура
	|		И ТаблицаНалогообложенияПрибыли.НаправлениеДеятельности = ПрочиеДоходы.НаправлениеДеятельности
	|";
	
#КонецОбласти

	ТекстыОтражения = Новый Массив;
	
	ТекстыОтражения.Добавить(ТекстРаспределения);
	ТекстыОтражения.Добавить(ТекстРаспределенияНДС);
	ТекстыОтражения.Добавить(ТекстОтклоненияСебестоимостьРеализованногоТовара);
	ТекстыОтражения.Добавить(ТекстОтклоненияСебестоимостьНаСкладе);
	ТекстыОтражения.Добавить(ТекстОтклоненияРасходы);
	ТекстыОтражения.Добавить(ТекстОтклоненияДоходы);
	ТекстыОтражения.Добавить(ТекстРаспределениеРасходовНаСебестоимостьПродаж);
	ТекстыОтражения.Добавить(ТекстОтклоненияЗабаланс);
	ТекстыОтражения.Добавить(ТекстСписаниеРезервов);
	ТекстыОтражения.Добавить(ТекстСписаниеРезервовДоходы);

	Возврат СтрСоединить(ТекстыОтражения, ОбщегоНазначенияУТ.РазделительЗапросовВОбъединении());
	
КонецФункции

// Функция возвращает текст фрагмента отражения отклонения стоимости на прочие активы/пассивы (Расход)
//
// Параметры:
// 	СодержаниеПоУмолчанию - Булево - признак того, что при возвращении текста сразу переназначать содержание проводки,
// 		значение по умолчанию - Истина.
// 	ПереопределениеОтбора - Булево - признак того, что при возвращении текста необходимо добавить условия отбора,
// 		значение по умолчанию - Ложь.
// 	ОбщийФрагмент - Булево - признак того, что фрагмент используется при составлении общего фрагмента запроса, в этом случае
// 		фрагмент запроса будет содержать поле "Сторно", значение по умолчанию - Ложь.
// Возвращаемое значение:
//	Строка - сформированный текст запроса.
//
Функция ТекстСписаниеСтоимостиНаСтатьиАктивовПассивов(СодержаниеПоУмолчанию = Истина, ПереопределениеОтбора = Ложь, ОбщийФрагмент = Ложь) Экспорт
	
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Списание стоимости товара на прочие активы / пассивы (Дт ХХ.ХХ :: Кт 20, 41.01, 76.06)
	|
	|	Стоимости.Ссылка КАК Ссылка,
	|	Стоимости.Период КАК Период,
	|	Стоимости.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Стоимости.СуммаБалансовая КАК Сумма,
	|	Стоимости.СуммаБалансоваяУУ КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеАктивыПассивы) КАК ВидСчетаДт,
	|	ПрочиеАктивыПассивы.Статья КАК АналитикаУчетаДт,
	|	ПрочиеАктивыПассивы.Подразделение КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	ПрочиеАктивыПассивы.Подразделение КАК ПодразделениеДт,
	|	ПрочиеАктивыПассивы.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	НастройкиСчетовУчета.СчетУчета КАК СчетДт,
	|	НастройкиСчетовУчета.Субконто1 КАК СубконтоДт1,
	|	НастройкиСчетовУчета.Субконто2 КАК СубконтоДт2,
	|	НастройкиСчетовУчета.Субконто3 КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	Стоимости.СуммаНУ КАК СуммаНУДт,
	|	Стоимости.СуммаПР КАК СуммаПРДт,
	|	Стоимости.СуммаВР КАК СуммаВРДт,
	|
	|	ВЫБОР
	|		КОГДА Стоимости.ПроизводственныеЗатраты ИЛИ Стоимости.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|		КОГДА Стоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		КОГДА Стоимости.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА Стоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ЗатратыНаПриобретениеТМЦ)
	|		КОГДА Стоимости.Склад ССЫЛКА Справочник.Партнеры ИЛИ Стоимости.Склад ССЫЛКА Справочник.Организации
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоПродаже)
	|		КОГДА Стоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаСкладах)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|		ИНАЧЕ Стоимости.ВидСчета
	|	КОНЕЦ КАК ВидСчетаКт,
	|	ВЫБОР
	|		КОГДА Стоимости.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоПродаже)
	|		ТОГДА Стоимости.ГруппаФинансовогоУчетаРасчетов
	|		КОГДА Стоимости.ПроизводственныеЗатраты ИЛИ Стоимости.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|		ТОГДА Стоимости.ГруппаПродукции
	|		ИНАЧЕ Стоимости.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК АналитикаУчетаКт,
	|	ВЫБОР
	|		КОГДА Стоимости.ПроизводственныеЗатраты ИЛИ Стоимости.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|		ТОГДА Стоимости.ПодразделениеАналитики
	|		ИНАЧЕ Стоимости.Склад
	|	КОНЕЦ КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Стоимости.ПодразделениеАналитики КАК ПодразделениеКт,
	|	Стоимости.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Стоимости.Номенклатура КАК СубконтоКт1,
	|	ВЫБОР
	|		КОГДА Стоимости.ПроизводственныеЗатраты ИЛИ Стоимости.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|		ТОГДА Стоимости.ГруппаПродукции
	|		ИНАЧЕ Стоимости.Склад
	|	КОНЕЦ КАК СубконтоКт2,
	|	ВЫБОР
	|		КОГДА Стоимости.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоПродаже)
	|			ИЛИ Стоимости.РазделУчета В (
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути))
	|		ТОГДА Стоимости.Контрагент
	|		ИНАЧЕ Стоимости.ТипЗатрат
	|	КОНЕЦ КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	Стоимости.СуммаНУ КАК СуммаНУКт,
	|	Стоимости.СуммаПР КАК СуммаПРКт,
	|	Стоимости.СуммаВР КАК СуммаВРКт,
	|	&Содержание КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВтСтоимости КАК Стоимости
	|	ПО Стоимости.Ссылка = ДокументыКОтражению.Ссылка
	|		И Стоимости.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И Стоимости.СтатьяАктивовПассивов <> ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.ПустаяСсылка)
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.ДвиженияПоПрочимАктивамПассивам КАК ПрочиеАктивыПассивы
	|	ПО Стоимости.Ссылка = ПрочиеАктивыПассивы.Регистратор
	|		И ПрочиеАктивыПассивы.Активность И НЕ ПрочиеАктивыПассивы.Сторно
	|		И ПрочиеАктивыПассивы.Статья = Стоимости.СтатьяАктивовПассивов
	|		И ПрочиеАктивыПассивы.ИдентификаторФинЗаписи = Стоимости.ИдентификаторФинЗаписи
	|		И ПрочиеАктивыПассивы.НастройкаХозяйственнойОперации = Стоимости.НастройкаХозяйственнойОперации
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.НастройкиСчетовУчетаПрочихОпераций КАК НастройкиСчетовУчета
	|	ПО ПрочиеАктивыПассивы.НастройкаСчетовУчета = НастройкиСчетовУчета.Ссылка
	|ГДЕ
	|	&ОтборПоУмолчанию";
	
	Если Не ОбщийФрагмент Тогда
		ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&Содержание КАК Содержание,
	|	ЛОЖЬ КАК Сторно", "&Содержание КАК Содержание");
	КонецЕсли;
	
	Если СодержаниеПоУмолчанию Тогда
		ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&Содержание", """Списание стоимости товара на прочие активы/пассивы""");
	КонецЕсли;
	
	Если Не ПереопределениеОтбора Тогда
		
	// Условия проверки полей ТипЗаписи и ХозяйственнаяОперация должны соответствовать функции ТекстСебестоимость() #Область ВтСтоимости
		ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ОтборПоУмолчанию", "Стоимости.ТипЗаписи В (ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимости),
	|		ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.КорректировкаПриобретенияПрошлогоПериода),
	|		ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.РаспределениеПоВыбывшимТоварам),
	|		ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимостиНаПрочиеРасходы))
	|	И Стоимости.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПередачаНаПрочиеЦели)
	|");
	КонецЕсли;
	
	Возврат ТекстЗапроса;
	
КонецФункции

// Функция возвращает текст фрагмента отражения перемещения товаров между филиалами
//
// Возвращаемое значение:
//	Строка - сформированный текст запроса.
//
Функция ТекстПеремещениеМеждуФилиалами() Экспорт
	
	ТекстыПеремещения = Новый Массив;
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Перемещение товаров между филиалами (Дт ХХ.ХХ :: Кт 20, 41.01, 76.06)
	|
	|	Стоимости.Ссылка КАК Ссылка,
	|	Стоимости.Период КАК Период,
	|	Стоимости.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Стоимости.СуммаБалансовая КАК Сумма,
	|	Стоимости.СуммаБалансоваяУУ КАК СуммаУУ,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	ЕСТЬNULL(ПрочиеАктивыПассивы.Подразделение, Стоимости.Подразделение) КАК ПодразделениеДт,
	|	ЕСТЬNULL(ПрочиеАктивыПассивы.НаправлениеДеятельности, Стоимости.НаправлениеДеятельности) КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоВыделенномуИмуществу) КАК СчетДт,
	|	ПрочиеАктивыПассивы.Аналитика КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	Стоимости.СуммаНУ КАК СуммаНУДт,
	|	Стоимости.СуммаПР КАК СуммаПРДт,
	|	Стоимости.СуммаВР КАК СуммаВРДт,
	|
	|	ВЫБОР
	|		КОГДА Стоимости.ПроизводственныеЗатраты ИЛИ Стоимости.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|		КОГДА Стоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		КОГДА Стоимости.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА Стоимости.Склад ССЫЛКА Справочник.Партнеры ИЛИ Стоимости.Склад ССЫЛКА Справочник.Организации
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоПродаже)
	|		КОГДА Стоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаСкладах)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|		ИНАЧЕ Стоимости.ВидСчета
	|	КОНЕЦ КАК ВидСчетаКт,
	|	ВЫБОР
	|		КОГДА Стоимости.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоПродаже)
	|		ТОГДА Стоимости.ГруппаФинансовогоУчетаРасчетов
	|		КОГДА Стоимости.ПроизводственныеЗатраты ИЛИ Стоимости.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|		ТОГДА Стоимости.ГруппаПродукции
	|		ИНАЧЕ Стоимости.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК АналитикаУчетаКт,
	|	ВЫБОР
	|		КОГДА Стоимости.ПроизводственныеЗатраты ИЛИ Стоимости.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|		ТОГДА Стоимости.ПодразделениеАналитики
	|		ИНАЧЕ Стоимости.Склад
	|	КОНЕЦ КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Стоимости.ПодразделениеАналитики КАК ПодразделениеКт,
	|	Стоимости.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Стоимости.Номенклатура КАК СубконтоКт1,
	|	ВЫБОР
	|		КОГДА Стоимости.ПроизводственныеЗатраты ИЛИ Стоимости.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|		ТОГДА Стоимости.ГруппаПродукции
	|		ИНАЧЕ Стоимости.Склад
	|	КОНЕЦ КАК СубконтоКт2,
	|	ВЫБОР
	|		КОГДА Стоимости.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоПродаже)
	|			ИЛИ Стоимости.РазделУчета В (
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА Стоимости.Контрагент
	|		ИНАЧЕ Стоимости.ТипЗатрат
	|	КОНЕЦ КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	Стоимости.СуммаНУ КАК СуммаНУКт,
	|	Стоимости.СуммаПР КАК СуммаПРКт,
	|	Стоимости.СуммаВР КАК СуммаВРКт,
	|	""Перемещение товаров между филиалами"" КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВтСтоимости КАК Стоимости
	|	ПО Стоимости.Ссылка = ДокументыКОтражению.Ссылка
	|		И Стоимости.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И Стоимости.СтатьяАктивовПассивов <> ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.ПустаяСсылка)
	|		И Стоимости.НастройкаСчетовУчета = ЗНАЧЕНИЕ(Справочник.НастройкиСчетовУчетаПрочихОпераций.ПустаяСсылка)
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ДвиженияПоПрочимАктивамПассивам КАК ПрочиеАктивыПассивы
	|	ПО Стоимости.Ссылка = ПрочиеАктивыПассивы.Регистратор
	|		И ПрочиеАктивыПассивы.Активность И НЕ ПрочиеАктивыПассивы.Сторно
	|		И ПрочиеАктивыПассивы.Организация = Стоимости.Организация
	|		И ПрочиеАктивыПассивы.Статья = Стоимости.СтатьяАктивовПассивов
	|		И ПрочиеАктивыПассивы.ИдентификаторФинЗаписи = Стоимости.ИдентификаторФинЗаписи
	|		И ПрочиеАктивыПассивы.НастройкаХозяйственнойОперации = Стоимости.НастройкаХозяйственнойОперации
	|		И ПрочиеАктивыПассивы.НастройкаСчетовУчета = ЗНАЧЕНИЕ(Справочник.НастройкиСчетовУчетаПрочихОпераций.ПустаяСсылка)
	|ГДЕ
	// Условия проверки полей ТипЗаписи и ХозяйственнаяОперация должны соответствовать функции ТекстСебестоимость() #Область ВтСтоимости
	|	Стоимости.ТипЗаписи В (ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимости),
	|		ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.КорректировкаПриобретенияПрошлогоПериода),
	|		ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.РаспределениеПоВыбывшимТоварам),
	|		ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимостиНаПрочиеРасходы))
	|	И Стоимости.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПеремещениеТоваровМеждуФилиалами)";
	ТекстыПеремещения.Добавить(ТекстЗапроса);
	
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Перемещение товаров между филиалами (Дт 20, 41.01, 76.06 :: Кт ХХ.ХХ)
	|
	|	Стоимости.Ссылка КАК Ссылка,
	|	Стоимости.Период КАК Период,
	|	Стоимости.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Стоимости.СуммаБалансовая КАК Сумма,
	|	Стоимости.СуммаБалансоваяУУ КАК СуммаУУ,
	|
	|	ВЫБОР
	|		КОГДА Стоимости.ПроизводственныеЗатраты ИЛИ Стоимости.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Производство)
	|		КОГДА Стоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПередачаВПереработку)
	|		КОГДА Стоимости.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НоменклатураПереданная)
	|		КОГДА Стоимости.Склад ССЫЛКА Справочник.Партнеры ИЛИ Стоимости.Склад ССЫЛКА Справочник.Организации
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоПродаже)
	|		КОГДА Стоимости.РазделУчета = ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыНаСкладах)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НаСкладе)
	|		ИНАЧЕ Стоимости.ВидСчета
	|	КОНЕЦ КАК ВидСчетаДт,
	|	ВЫБОР
	|		КОГДА Стоимости.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоПродаже)
	|		ТОГДА Стоимости.ГруппаФинансовогоУчетаРасчетов
	|		КОГДА Стоимости.ПроизводственныеЗатраты ИЛИ Стоимости.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|		ТОГДА Стоимости.ГруппаПродукции
	|		ИНАЧЕ Стоимости.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК АналитикаУчетаДт,
	|	ВЫБОР
	|		КОГДА Стоимости.ПроизводственныеЗатраты ИЛИ Стоимости.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|		ТОГДА Стоимости.ПодразделениеАналитики
	|		ИНАЧЕ Стоимости.Склад
	|	КОНЕЦ КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Стоимости.ПодразделениеАналитики КАК ПодразделениеДт,
	|	Стоимости.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	Стоимости.Номенклатура КАК СубконтоДт1,
	|	ВЫБОР
	|		КОГДА Стоимости.ПроизводственныеЗатраты ИЛИ Стоимости.РазделУчета В (&ЗабалансовыеРазделыУчета)
	|		ТОГДА Стоимости.ГруппаПродукции
	|		ИНАЧЕ Стоимости.Склад
	|	КОНЕЦ КАК СубконтоДт2,
	|	ВЫБОР
	|		КОГДА Стоимости.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоПродаже)
	|			ИЛИ Стоимости.РазделУчета В (
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|				ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам))
	|		ТОГДА Стоимости.Контрагент
	|		ИНАЧЕ Стоимости.ТипЗатрат
	|	КОНЕЦ КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	Стоимости.СуммаНУ КАК СуммаНУДт,
	|	Стоимости.СуммаПР КАК СуммаПРДт,
	|	Стоимости.СуммаВР КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	ЕСТЬNULL(ПрочиеАктивыПассивы.Подразделение, Стоимости.Подразделение) КАК ПодразделениеКт,
	|	ЕСТЬNULL(ПрочиеАктивыПассивы.НаправлениеДеятельности, Стоимости.НаправлениеДеятельности) КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоВыделенномуИмуществу) КАК СчетКт,
	|	ПрочиеАктивыПассивы.Аналитика КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	Стоимости.СуммаНУ КАК СуммаНУКт,
	|	Стоимости.СуммаПР КАК СуммаПРКт,
	|	Стоимости.СуммаВР КАК СуммаВРКт,
	|	""Перемещение товаров между филиалами"" КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВтСтоимости КАК Стоимости
	|	ПО Стоимости.Ссылка = ДокументыКОтражению.Ссылка
	|		И Стоимости.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|		И Стоимости.СтатьяАктивовПассивов <> ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиАктивовПассивов.ПустаяСсылка)
	|		И Стоимости.НастройкаСчетовУчета = ЗНАЧЕНИЕ(Справочник.НастройкиСчетовУчетаПрочихОпераций.ПустаяСсылка)
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ДвиженияПоПрочимАктивамПассивам КАК ПрочиеАктивыПассивы
	|	ПО Стоимости.Ссылка = ПрочиеАктивыПассивы.Регистратор
	|		И ПрочиеАктивыПассивы.Активность И НЕ ПрочиеАктивыПассивы.Сторно
	|		И ПрочиеАктивыПассивы.Организация = Стоимости.Организация
	|		И ПрочиеАктивыПассивы.Статья = Стоимости.СтатьяАктивовПассивов
	|		И ПрочиеАктивыПассивы.ИдентификаторФинЗаписи = Стоимости.ИдентификаторФинЗаписи
	|		И ПрочиеАктивыПассивы.НастройкаХозяйственнойОперации = Стоимости.НастройкаХозяйственнойОперации
	|		И ПрочиеАктивыПассивы.НастройкаСчетовУчета = ЗНАЧЕНИЕ(Справочник.НастройкиСчетовУчетаПрочихОпераций.ПустаяСсылка)
	|ГДЕ
	// Условия проверки полей ТипЗаписи и ХозяйственнаяОперация должны соответствовать функции ТекстСебестоимость() #Область ВтСтоимости
	|	Стоимости.ТипЗаписи В (ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимости),
	|		ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.КорректировкаПриобретенияПрошлогоПериода),
	|		ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.РаспределениеПоВыбывшимТоварам),
	|		ЗНАЧЕНИЕ(Перечисление.ТипыЗаписейПартий.ОтклонениеВСтоимостиНаПрочиеРасходы))
	|	И Стоимости.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПеремещениеТоваровМеждуФилиалами)";
	ТекстыПеремещения.Добавить(ТекстЗапроса);
	
	Возврат СтрСоединить(ТекстыПеремещения, ОбщегоНазначенияУТ.РазделительЗапросовВОбъединении());
	
КонецФункции

Функция ТекстСписаниеРасходовУОрганизацииИсточника(ДокументИмя) Экспорт
	
	ТекстВозврата =
	"ВЫБРАТЬ //// Списание УУ расходов у организации - источника (Дт 91 :: Кт 20, 44)
	|	Операция.Ссылка КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	0 КАК Сумма,
	|	-Строки.СуммаУпр КАК СуммаУУ,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы) КАК СчетДт,
	|
	|	Строки.СтатьяРасходов КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаКт,
	|	Строки.СтатьяРасходов КАК АналитикаУчетаКт,
	|	Строки.Подразделение КАК МестоУчетаКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Строки.СтатьяРасходов КАК СубконтоКт1,
	|	Строки.АналитикаРасходов КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	
	|	""Списание УУ расходов у организации - источника"" КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ДокументИмя КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ПрочиеРасходы КАК Строки
	|	ПО
	|		Операция.Ссылка = Строки.Регистратор
	|		И Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|		И Строки.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СторнированиеРасходовУУ)
	|		И Строки.СуммаУпр <> 0
	|		И НЕ Строки.Сторно
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ //// Списание УУ расходов у организации - источника (Дт 91 :: Кт 20, 44)
	|	Операция.Ссылка КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	0 КАК Сумма,
	|	-Строки.СтоимостьБезНДС КАК СуммаУУ,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы) КАК СчетДт,
	|
	|	Строки.СтатьяРасходов КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаКт,
	|	Строки.СтатьяРасходов КАК АналитикаУчетаКт,
	|	Строки.Подразделение КАК МестоУчетаКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Строки.СтатьяРасходов КАК СубконтоКт1,
	|	Строки.АналитикаРасходов КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	
	|	""Списание УУ расходов у организации - источника"" КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ДокументИмя КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ПартииПрочихРасходов КАК Строки
	|	ПО
	|		Операция.Ссылка = Строки.Регистратор
	|		И Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|		И Строки.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СторнированиеРасходовУУ)
	|		И Строки.СтоимостьБезНДС <> 0
	|		И НЕ Строки.Сторно
	|";
	
	ТекстВозврата = СтрЗаменить(ТекстВозврата, "ДокументИмя", ДокументИмя);
	Возврат ТекстВозврата;
	
КонецФункции

Функция ТекстРегистрацияРасходовУОрганизацииПолучателя(ДокументИмя) Экспорт
	
	ТекстВозврата =
	"ВЫБРАТЬ //// Регистрация УУ расходов у организации - получателя (Дт 20, 44 :: Кт 91)
	|	Операция.Ссылка КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	0 КАК Сумма,
	|	Строки.СуммаУпр КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаДт,
	|	Строки.СтатьяРасходов КАК АналитикаУчетаДт,
	|	Строки.Подразделение КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	Строки.СтатьяРасходов КАК СубконтоДт1,
	|	Строки.АналитикаРасходов КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеДоходы) КАК СчетКт,
	|
	|	Строки.СтатьяРасходов КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	
	|	""Регистрация УУ расходов у организации - получателя"" КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ДокументИмя КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ПрочиеРасходы КАК Строки
	|	ПО
	|		Операция.Ссылка = Строки.Регистратор
	|		И Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|		И Строки.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.РегистрацияРасходовУУ)
	|		И Строки.СуммаУпр <> 0
	|		И НЕ Строки.Сторно
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|ВЫБРАТЬ //// Регистрация УУ расходов у организации - получателя (Дт 20, 44 :: Кт 91)
	|	Операция.Ссылка КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	0 КАК Сумма,
	|	Строки.СтоимостьБезНДС КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаДт,
	|	Строки.СтатьяРасходов КАК АналитикаУчетаДт,
	|	Строки.Подразделение КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	Строки.СтатьяРасходов КАК СубконтоДт1,
	|	Строки.АналитикаРасходов КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеДоходы) КАК СчетКт,
	|
	|	Строки.СтатьяРасходов КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	
	|	""Регистрация УУ расходов у организации - получателя"" КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ДокументИмя КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ПартииПрочихРасходов КАК Строки
	|	ПО
	|		Операция.Ссылка = Строки.Регистратор
	|		И Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|		И Строки.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.РегистрацияРасходовУУ)
	|		И Строки.СтоимостьБезНДС <> 0
	|		И НЕ Строки.Сторно";
	
	ТекстВозврата = СтрЗаменить(ТекстВозврата, "ДокументИмя", ДокументИмя);
	Возврат ТекстВозврата;
	
КонецФункции

Функция ТекстНДСПоДаннымФинпартий() Экспорт
	
	ВключениеНДСВРасходы = "
	|ВЫБРАТЬ //// Восстановление НДС по расходам (Дт <25, 26, 44> - Кт <19.3, 19.4>) @НДСПредъявленный
	|	Партии.Ссылка КАК Ссылка,
	|	Партии.Период КАК Период,
	|	Партии.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	ВЫБОР КОГДА Партии.ВключениеНДСВСтоимость ТОГДА
	|		Партии.НДСРегл
	|	ИНАЧЕ
	|		-Партии.НДСРегл
	|	КОНЕЦ КАК Сумма,
	|	
	|	ВЫБОР КОГДА Партии.ВключениеНДСВСтоимость ТОГДА
	|		Партии.НДСУпр
	|	ИНАЧЕ
	|		-Партии.НДСУпр
	|	КОНЕЦ КАК СуммаУпр,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаДт,
	|	Партии.СтатьяРасходов КАК АналитикаУчетаДт,
	|	ЕСТЬNULL(Партии.ПодразделениеРасходов, ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)) КАК МестоУчетаДт,
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВалютаДт,
	|	ЕСТЬNULL(Партии.ПодразделениеРасходов, ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)) КАК ПодразделениеДт,
	|	Партии.КорНаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|	Партии.СтатьяРасходов КАК СубконтоДт1,
	|	Партии.АналитикаРасходов КАК СубконтоДт2,
	|	ВЫБОР КОГДА СтатьиСтроительства.Ссылка ЕСТЬ NULL ТОГДА
	|		ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее)
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.Подрядный)
	|	КОНЕЦ КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НДСпоПриобретеннымЦенностям) КАК ВидСчетаКт,
	|	Партии.ВидДеятельностиНДС                                              КАК АналитикаУчетаКт,
	|	Партии.ВидЦенности                                                     КАК МестоУчетаКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВалютаКт,
	|	НЕОПРЕДЕЛЕНО КАК ПодразделениеКт,
	|	ЕСТЬNULL(ВводСобственныхСредств.НаправлениеДеятельности, Партии.НаправлениеДеятельности) КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	Партии.Контрагент КАК СубконтоКт1,
	|	Партии.ДокументПоступления КАК СубконтоКт2,
	|	Партии.ДокументРеализации КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Списание НДС в расходы"" КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|	
	|ИЗ
	|	Партии КАК Партии
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиСтроительства
	|	ПО Партии.СтатьяРасходов = СтатьиСтроительства.Ссылка
	|		И СтатьиСтроительства.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|	ЛЕВОЕ СОЕДИНЕНИЕ ВТВводСобственныхСредств КАК ВводСобственныхСредств
	|	ПО Партии.Ссылка = ВводСобственныхСредств.Ссылка
	|		И Партии.ДокументПоступления = ВводСобственныхСредств.СчетФактура
	|		И Партии.НаправлениеДеятельности = ВводСобственныхСредств.ИсходноеНаправлениеДеятельности
	|
	|ГДЕ
	|	Партии.СтатьяРасходов ССЫЛКА ПланВидовХарактеристик.СтатьиРасходов
	|	И Партии.СтатьяРасходов <> ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
	|	И (НЕ Партии.ПодразделениеРасходов ЕСТЬ NULL ИЛИ Партии.СтатьяРасходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ВыбытияТоваровВПрошлыхПериодах))
	|	И (Партии.ВключениеНДСВСтоимость ИЛИ Партии.ИсключениеНДСИзСтоимости)
	|	И НЕ ТИПЗНАЧЕНИЯ(Партии.ДокументПоступления) В (ТИП(Документ.СчетФактураНалоговыйАгент),
	|													ТИП(Документ.СчетФактураПолученныйНалоговыйАгент))
	|	И НЕ ТИПЗНАЧЕНИЯ(Партии.Ссылка) = ТИП(Документ.РаспределениеПрочихЗатрат)
	|";
	
	Возврат ВключениеНДСВРасходы;

КонецФункции

Функция ТекстНДСПоНДСПредъявленный() Экспорт
	
	Возврат 
		"ВЫБРАТЬ // Изменение вида деятельности НДС (Дт <19.Х> - Кт <19.Х>) @НДСПредъявленный
		|
		|	НДСПредъявленный.Регистратор КАК Ссылка,
		|	НДСПредъявленный.Период      КАК Период,
		|	НДСПредъявленный.Организация КАК Организация,
		|	НЕОПРЕДЕЛЕНО                 КАК ИдентификаторСтроки,
		|
		|	НДСПредъявленный.НДС         КАК Сумма,
		|	НДСПредъявленный.НДСУпр      КАК СуммаУУ,
		|
		|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НДСпоПриобретеннымЦенностям) КАК ВидСчетаДт,
		|	ВЫБОР 
		|		КОГДА НДСПредъявленный.ВидДеятельностиНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортНесырьевыхТоваров)
		|				И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) < &ДатаНачалаДействия150ФЗ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНаЭкспорт)
		|		ИНАЧЕ НДСПредъявленный.ВидДеятельностиНДС
		|	КОНЕЦ                                                                  КАК АналитикаУчетаДт,
		|	НДСПредъявленный.ВидЦенности                                           КАК МестоУчетаДт,
		|
		|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)                               КАК ВалютаДт,
		|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)                 КАК ПодразделениеДт,
		|	ЕСТЬNULL(ВводСобственныхСредств.НаправлениеДеятельности, НДСПредъявленный.НаправлениеДеятельности) КАК НаправлениеДеятельностиДт,
		|
		|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)                         КАК СчетДт,
		|
		|	НДСПредъявленный.Поставщик   КАК СубконтоДт1,
		|	НДСПредъявленный.СчетФактура КАК СубконтоДт2,
		|	ВЫБОР 
		|		КОГДА НДСПредъявленный.Событие В (ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.Реализация),
		|			ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПодВидДеятельности),
		|			ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПоКСФ))
		|		ТОГДА НДСПредъявленный.РеализацияЭкспорт
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СубконтоДт3,
		|	
		|	0 КАК ВалютнаяСуммаДт,
		|	0 КАК КоличествоДт,
		|	0 КАК СуммаНУДт,
		|	0 КАК СуммаПРДт,
		|	0 КАК СуммаВРДт,
		|	
		|	ВЫБОР 
		|		КОГДА НДСПредъявленный.Событие В (
		|			ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПодВидДеятельности),
		|			ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПоКСФ))
		|		ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НДСпоПриобретеннымЦенностям)
		|	КОНЕЦ КАК ВидСчетаКт,
		|	ВЫБОР 
		|		КОГДА НДСПредъявленный.Событие В (
		|			ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПодВидДеятельности),
		|			ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПоКСФ))
		|		ТОГДА НЕОПРЕДЕЛЕНО
		|		КОГДА НДСПредъявленный.КорВидДеятельностиНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортНесырьевыхТоваров)
		|				И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) < &ДатаНачалаДействия150ФЗ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНаЭкспорт)
		|		ИНАЧЕ НДСПредъявленный.КорВидДеятельностиНДС
		|	КОНЕЦ                                                                  КАК АналитикаУчетаКт,
		|	ВЫБОР 
		|		КОГДА НДСПредъявленный.Событие В (
		|			ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПодВидДеятельности),
		|			ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПоКСФ))
		|		ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ НДСПредъявленный.ВидЦенности
		|	КОНЕЦ КАК МестоУчетаКт,
		|
		|	ВЫБОР 
		|		КОГДА НДСПредъявленный.Событие В (
		|			ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПодВидДеятельности),
		|			ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПоКСФ))
		|		ТОГДА &ВалютаРеглУчета
		|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)
		|	КОНЕЦ КАК ВалютаКт,
		|	ВЫБОР 
		|		КОГДА НДСПредъявленный.Событие В (
		|			ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПодВидДеятельности),
		|			ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПоКСФ))
		|		ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)
		|	КОНЕЦ КАК ПодразделениеКт,
		|	ВЫБОР 
		|		КОГДА НДСПредъявленный.Событие В (
		|			ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПодВидДеятельности),
		|			ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПоКСФ))
		|		ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
		|		ИНАЧЕ ЕСТЬNULL(КорВводСобственныхСредств.НаправлениеДеятельности, НДСПредъявленный.КорНаправлениеДеятельности)
		|	КОНЕЦ КАК НаправлениеДеятельностиКт,
		|
		|	ВЫБОР
		|		КОГДА ТИПЗНАЧЕНИЯ(НДСПредъявленный.СчетФактура) = ТИП(Документ.СчетФактураПолученныйНалоговыйАгент)
		|		ТОГДА ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДСНалоговогоАгентаПоОтдельнымВидамТоваров)
		|		КОГДА НДСПредъявленный.Событие = ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПодВидДеятельности)
		|			ИЛИ НДСПредъявленный.Событие = ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПоКСФ)
		|			И НДСПредъявленный.ВидЦенности <> ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.ТоварыНалоговыйАгент)
		|		ТОГДА ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДС)
		|		ИНАЧЕ ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)
		|	КОНЕЦ КАК СчетКт,
		|	ВЫБОР 
		|		КОГДА НДСПредъявленный.Событие В (
		|			ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПодВидДеятельности),
		|			ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПоКСФ))
		|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВГосБюджет.Налог)
		|		ИНАЧЕ НДСПредъявленный.Поставщик
		|	КОНЕЦ КАК СубконтоКт1,
		|	ВЫБОР 
		|		КОГДА НДСПредъявленный.Событие В (
		|			ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПодВидДеятельности),
		|			ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПоКСФ))
		|		ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ НДСПредъявленный.СчетФактура
		|	КОНЕЦ КАК СубконтоКт2,
		|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
		|
		|	ВЫБОР 
		|		КОГДА НДСПредъявленный.Событие В (
		|			ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПодВидДеятельности),
		|			ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПоКСФ))
		|		ТОГДА НДСПредъявленный.НДС
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК ВалютнаяСуммаКт,
		|	0 КАК КоличествоКт,
		|	0 КАК СуммаНУКт,
		|	0 КАК СуммаПРКт,
		|	0 КАК СуммаВРКт,
		|	ВЫБОР 
		|		КОГДА НДСПредъявленный.Событие = ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ИзменениеВидаДеятельностиНДС)
		|		ТОГДА ""Изменение вида деятельности НДС""
		|		КОГДА НДСПредъявленный.Событие = ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ИзменениеНаправленияДеятельности)
		|		ТОГДА ""Изменение направления деятельности""
		|		КОГДА НДСПредъявленный.Событие = ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.Реализация)
		|		ТОГДА ""Реализация по ставке 0%""
		|		КОГДА НДСПредъявленный.Событие В (
		|			ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПодВидДеятельности),
		|			ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПоКСФ))
		|		ТОГДА ""Восстановление НДС""
		|		ИНАЧЕ ""Что-то еще""
		|	КОНЕЦ КАК Содержание,
		|	ЛОЖЬ КАК Сторно
		|ИЗ
		|	ДокументыКОтражению КАК ДокументыКОтражению
		|
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.НДСПредъявленный КАК НДСПредъявленный
		|		ПО НДСПредъявленный.Регистратор = ДокументыКОтражению.Ссылка
		|			И НДСПредъявленный.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
		|			И НЕ НДСПредъявленный.Сторно
		|
		|	ЛЕВОЕ СОЕДИНЕНИЕ ВТВводСобственныхСредств КАК ВводСобственныхСредств
		|	ПО ДокументыКОтражению.Ссылка = ВводСобственныхСредств.Ссылка
		|		И НДСПредъявленный.СчетФактура = ВводСобственныхСредств.СчетФактура
		|		И НДСПредъявленный.НаправлениеДеятельности = ВводСобственныхСредств.ИсходноеНаправлениеДеятельности
		|
		|	ЛЕВОЕ СОЕДИНЕНИЕ ВТВводСобственныхСредств КАК КорВводСобственныхСредств
		|	ПО ДокументыКОтражению.Ссылка = КорВводСобственныхСредств.Ссылка
		|		И НДСПредъявленный.СчетФактура = КорВводСобственныхСредств.СчетФактура
		|		И НДСПредъявленный.КорНаправлениеДеятельности = КорВводСобственныхСредств.ИсходноеНаправлениеДеятельности
		|		И НЕ НДСПредъявленный.Событие В (
		|			ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПодВидДеятельности),
		|			ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПоКСФ))
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ 
		|		РегистрСведений.ДанныеПервичныхДокументов КАК ДанныеПервичныхДокументов
		|	ПО
		|		ДанныеПервичныхДокументов.Организация = НДСПредъявленный.Организация
		|		И ДанныеПервичныхДокументов.Документ = НДСПредъявленный.СчетФактура
		|ГДЕ
		|	НДСПредъявленный.Событие = ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ИзменениеВидаДеятельностиНДС)
		|	И НЕ НДСПредъявленный.КорВидДеятельностиНДС В (&ТипыНеОблагаемыеНДС)
		|	ИЛИ НДСПредъявленный.Событие В (ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ИзменениеНаправленияДеятельности),
		|		ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПодВидДеятельности),
		|		ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ВосстановлениеНДСПоКСФ))
		|	ИЛИ НДСПредъявленный.Событие = ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.Реализация)
		|	И НЕ НДСПредъявленный.КорВидДеятельностиНДС В (&ТипыНеОблагаемыеНДС)
		|	И НДСПредъявленный.ВидДеятельностиНДС В (
		|		ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНаЭкспорт),
		|		ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортСырьевыхТоваровУслуг),
		|		ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортНесырьевыхТоваров),
		|		ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.Космос),
		|		ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПроизводствоСДЦ))
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ // Вычет НДС (Дт <68.02, 68.52> - Кт <19.Х>) @НДСПредъявленный
		|
		|	НДСПредъявленный.Регистратор КАК Ссылка,
		|	НДСПредъявленный.Период      КАК Период,
		|	НДСПредъявленный.Организация КАК Организация,
		|	НЕОПРЕДЕЛЕНО                 КАК ИдентификаторСтроки,
		|
		|	НДСПредъявленный.НДС         КАК Сумма,
		|	НДСПредъявленный.НДСУпр      КАК СуммаУУ,
		|
		|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
		|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
		|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
		|
		|	&ВалютаРеглУчета КАК ВалютаДт,
		|	НЕОПРЕДЕЛЕНО КАК ПодразделениеДт,
		|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиДт,
		|
		|	ВЫБОР 
		|		КОГДА НДСПредъявленный.ВидЦенности = ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.ТоварыНалоговыйАгент)
		|			ТОГДА ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДСНалоговогоАгентаПоОтдельнымВидамТоваров)
		|		ИНАЧЕ ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДС)
		|	КОНЕЦ КАК СчетДт,
		|	ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВГосБюджет.Налог) КАК СубконтоДт1,
		|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
		|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
		|	
		|	НДСПредъявленный.НДС КАК ВалютнаяСуммаДт,
		|	0 КАК КоличествоДт,
		|	0 КАК СуммаНУДт,
		|	0 КАК СуммаПРДт,
		|	0 КАК СуммаВРДт,
		|	
		|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НДСпоПриобретеннымЦенностям) КАК ВидСчетаКт,
		|	ВЫБОР 
		|		КОГДА НДСПредъявленный.ВидДеятельностиНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортНесырьевыхТоваров)
		|				И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) < &ДатаНачалаДействия150ФЗ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНаЭкспорт)
		|		ИНАЧЕ НДСПредъявленный.ВидДеятельностиНДС
		|	КОНЕЦ                                                                  КАК АналитикаУчетаКт,
		|	НДСПредъявленный.ВидЦенности                                           КАК МестоУчетаКт,
		|
		|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)                               КАК ВалютаКт,
		|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)                 КАК ПодразделениеКт,
		|	ЕСТЬNULL(ВводСобственныхСредств.НаправлениеДеятельности, НДСПредъявленный.НаправлениеДеятельности) КАК НаправлениеДеятельностиКт,
		|
		|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)                         КАК СчетКт,
		|	НДСПредъявленный.Поставщик   КАК СубконтоКт1,
		|	НДСПредъявленный.СчетФактура КАК СубконтоКт2,
		|	НДСПредъявленный.РеализацияЭкспорт КАК СубконтоКт3,
		|
		|	0 КАК ВалютнаяСуммаКт,
		|	0 КАК КоличествоКт,
		|	0 КАК СуммаНУКт,
		|	0 КАК СуммаПРКт,
		|	0 КАК СуммаВРКт,
		|	""Принятие НДС к вычету"" КАК Содержание,
		|	ЛОЖЬ КАК Сторно
		|ИЗ
		|	ДокументыКОтражению КАК ДокументыКОтражению
		|
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
		|		РегистрНакопления.НДСПредъявленный КАК НДСПредъявленный
		|	ПО 
		|		НДСПредъявленный.Регистратор = ДокументыКОтражению.Ссылка
		|		И НДСПредъявленный.Событие В (
		|					ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.НДСПринятКВычету),
		|					ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.ПодтвержденаСтавка0),
		|					ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.НеПодтвержденаСтавка0),
		|					ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.НДСПоДЦПринятКВычету))
		|		И НДСПредъявленный.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
		|		И НЕ НДСПредъявленный.Сторно
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ ВТВводСобственныхСредств КАК ВводСобственныхСредств
		|	ПО ДокументыКОтражению.Ссылка = ВводСобственныхСредств.Ссылка
		|		И НДСПредъявленный.СчетФактура = ВводСобственныхСредств.СчетФактура
		|		И НДСПредъявленный.НаправлениеДеятельности = ВводСобственныхСредств.ИсходноеНаправлениеДеятельности
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ 
		|		РегистрСведений.ДанныеПервичныхДокументов КАК ДанныеПервичныхДокументов
		|	ПО
		|		ДанныеПервичныхДокументов.Организация = НДСПредъявленный.Организация
		|		И ДанныеПервичныхДокументов.Документ = НДСПредъявленный.СчетФактура
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ // Списание НДС на расходы (Дт <91.02, ХХ.ХХ> - Кт <19.Х>) @НДСПредъявленный
		|
		|	НДСПредъявленный.Регистратор КАК Ссылка,
		|	НДСПредъявленный.Период      КАК Период,
		|	НДСПредъявленный.Организация КАК Организация,
		|	НЕОПРЕДЕЛЕНО                 КАК ИдентификаторСтроки,
		|
		|	ВЫБОР КОГДА НДСПредъявленный.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
		|		ТОГДА НДСПредъявленный.НДС
		|		ИНАЧЕ -НДСПредъявленный.НДС
		|	КОНЕЦ КАК Сумма,
		|	ВЫБОР КОГДА НДСПредъявленный.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
		|		ТОГДА НДСПредъявленный.НДСУпр
		|		ИНАЧЕ -НДСПредъявленный.НДСУпр
		|	КОНЕЦ КАК СуммаУУ,
		|
		|	ВЫБОР 
		|		КОГДА НДСПредъявленный.СтатьяРасходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
		|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеАктивыПассивы)
		|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы)
		|	КОНЕЦ КАК ВидСчетаДт,
		|	ЕСТЬNULL(ПрочиеАктивыПассивы.Статья, НДСПредъявленный.СтатьяРасходов) КАК АналитикаУчетаДт,
		|	НДСПредъявленный.Подразделение                     КАК МестоУчетаДт,
		|	
		|	НЕОПРЕДЕЛЕНО                                       КАК ВалютаДт,
		|	НДСПредъявленный.Подразделение                     КАК ПодразделениеДт,
		|	НДСПредъявленный.КорНаправлениеДеятельности        КАК НаправлениеДеятельностиДт,
		|
		|	ЕСТЬNULL(НастройкиСчетовУчета.СчетУчета, ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)) КАК СчетДт,
		|	
		|	ЕСТЬNULL(НастройкиСчетовУчета.Субконто1, НДСПредъявленный.СтатьяРасходов) КАК СубконтоДт1,
		|	ЕСТЬNULL(НастройкиСчетовУчета.Субконто2, НДСПредъявленный.АналитикаРасходов) КАК СубконтоДт2,
		|	ЕСТЬNULL(НастройкиСчетовУчета.Субконто3, НЕОПРЕДЕЛЕНО) КАК СубконтоДт3,
		|	
		|	0 КАК ВалютнаяСуммаДт,
		|	0 КАК КоличествоДт,
		|	0 КАК СуммаНУДт,
		|	0 КАК СуммаПРДт,
		|	0 КАК СуммаВРДт,
		|	
		|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НДСпоПриобретеннымЦенностям) КАК ВидСчетаКт,
		|	ВЫБОР 
		|		КОГДА НДСПредъявленный.ВидДеятельностиНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ЭкспортНесырьевыхТоваров)
		|				И ЕСТЬNULL(ДанныеПервичныхДокументов.ДатаРегистратора, ДАТАВРЕМЯ(1,1,1)) < &ДатаНачалаДействия150ФЗ
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаНаЭкспорт)
		|		ИНАЧЕ НДСПредъявленный.ВидДеятельностиНДС
		|	КОНЕЦ                                                                  КАК АналитикаУчетаКт,
		|	НДСПредъявленный.ВидЦенности                                           КАК МестоУчетаКт,
		|
		|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)                               КАК ВалютаКт,
		|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)                 КАК ПодразделениеКт,
		|	ЕСТЬNULL(ВводСобственныхСредств.НаправлениеДеятельности, НДСПредъявленный.НаправлениеДеятельности) КАК НаправлениеДеятельностиКт,
		|
		|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)                         КАК СчетКт,
		|	НДСПредъявленный.Поставщик   КАК СубконтоКт1,
		|	НДСПредъявленный.СчетФактура КАК СубконтоКт2,
		|	НДСПредъявленный.РеализацияЭкспорт КАК СубконтоКт3,
		|
		|	0 КАК ВалютнаяСуммаКт,
		|	0 КАК КоличествоКт,
		|	ВЫБОР КОГДА НДСПредъявленный.Регистратор ССЫЛКА Документ.РаспределениеПрочихЗатрат
		|		ТОГДА ВЫБОР КОГДА НДСПредъявленный.СтатьяРасходов.ПринятиеКНалоговомуУчету
		|	 		ТОГДА ВЫБОР КОГДА НДСПредъявленный.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
		|					ТОГДА НДСПредъявленный.НДС
		|					ИНАЧЕ -НДСПредъявленный.НДС
		|				КОНЕЦ
		|		ИНАЧЕ 0 КОНЕЦ
		|	КОНЕЦ КАК СуммаНУКт,
		|	ВЫБОР КОГДА НДСПредъявленный.Регистратор ССЫЛКА Документ.РаспределениеПрочихЗатрат
		|		ТОГДА ВЫБОР КОГДА НДСПредъявленный.СтатьяРасходов.ПринятиеКНалоговомуУчету
		|	 		ТОГДА 0
		|	 		ИНАЧЕ ВЫБОР КОГДА НДСПредъявленный.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
		|					ТОГДА НДСПредъявленный.НДС
		|					ИНАЧЕ -НДСПредъявленный.НДС
		|				КОНЕЦ КОНЕЦ
		|	КОНЕЦ КАК СуммаПРКт,
		|	0 КАК СуммаВРКт,
		|	""Списание НДС на расходы"" КАК Содержание,
		|	ЛОЖЬ КАК Сторно
		|ИЗ
		|	ДокументыКОтражению КАК ДокументыКОтражению
		|
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
		|		РегистрНакопления.НДСПредъявленный КАК НДСПредъявленный
		|	ПО 
		|		НДСПредъявленный.Регистратор = ДокументыКОтражению.Ссылка
		|		И (НДСПредъявленный.Событие = ЗНАЧЕНИЕ(Перечисление.СобытияНДСПредъявленный.СписаниеНДСНаРасходы)
		|			ИЛИ НДСПредъявленный.СтатьяРасходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ОтклонениеВСтоимостиТоваров))
		|		И НЕ НДСПредъявленный.Сторно
		|
		|	ЛЕВОЕ СОЕДИНЕНИЕ
		|		РегистрНакопления.ДвиженияПоПрочимАктивамПассивам КАК ПрочиеАктивыПассивы
		|	ПО
		|		ПрочиеАктивыПассивы.Регистратор = ДокументыКОтражению.Ссылка
		|		И НДСПредъявленный.СтатьяРасходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
		|		И ПрочиеАктивыПассивы.НастройкаХозяйственнойОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СписаниеНДСПоПриобретеннымЦенностям)
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ
		|		Справочник.НастройкиСчетовУчетаПрочихОпераций КАК НастройкиСчетовУчета
		|	ПО
		|		ПрочиеАктивыПассивы.НастройкаСчетовУчета = НастройкиСчетовУчета.Ссылка
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ ВТВводСобственныхСредств КАК ВводСобственныхСредств
		|	ПО ДокументыКОтражению.Ссылка = ВводСобственныхСредств.Ссылка
		|		И НДСПредъявленный.СчетФактура = ВводСобственныхСредств.СчетФактура
		|		И НДСПредъявленный.НаправлениеДеятельности = ВводСобственныхСредств.ИсходноеНаправлениеДеятельности
		|	
		|	ЛЕВОЕ СОЕДИНЕНИЕ 
		|		РегистрСведений.ДанныеПервичныхДокументов КАК ДанныеПервичныхДокументов
		|	ПО
		|		ДанныеПервичныхДокументов.Организация = НДСПредъявленный.Организация
		|		И ДанныеПервичныхДокументов.Документ = НДСПредъявленный.СчетФактура";

КонецФункции

Функция ТекстПереносРезервовПодОбесценение() Экспорт
	
	ТекстВозврата =
	"ВЫБРАТЬ //// Перенос резервов (Дт 14 :: Кт 14)
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Строки.РезервПодОбесценениеРегл КАК Сумма,
	|	Строки.РезервПодОбесценениеУпр КАК СуммаУУ,
	|
	|	ВЫБОР
	|		КОГДА Строки.КорРазделУчета В (
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеПроизводства)
	|		КОГДА Строки.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеПереданные)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеТМЦ)
	|	КОНЕЦ КАК ВидСчетаДт,
	|	ВЫБОР
	|		КОГДА Строки.КорРазделУчета В (
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|		ТОГДА Строки.КорАналитикаФинансовогоУчета
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|		ТОГДА ЕСТЬNULL(Строки.КорВидЗапасов.ГруппаФинансовогоУчета,
	|			ЕСТЬNULL(Строки.ВидЗапасов.ГруппаФинансовогоУчета,
	|			ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка)))
	|		ИНАЧЕ ЕСТЬNULL(КорАналитика.Номенклатура.ГруппаФинансовогоУчета,
	|			ЕСТЬNULL(Аналитика.Номенклатура.ГруппаФинансовогоУчета,
	|			ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка)))
	|	КОНЕЦ КАК АналитикаУчетаДт,
	|	ВЫБОР
	|		КОГДА Строки.КорРазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику))
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		КОГДА Строки.КорРазделУчета В (
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|			И ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения)
	|				= ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА ЕСТЬNULL(КорАналитика.СкладскаяТерритория.Подразделение, Аналитика.СкладскаяТерритория.Подразделение)
	|		ИНАЧЕ ЕСТЬNULL(КорАналитика.МестоХранения, Аналитика.МестоХранения)
	|	КОНЕЦ КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА ЕСТЬNULL(КорАналитика.СкладскаяТерритория.Подразделение, Аналитика.СкладскаяТерритория.Подразделение)
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА ЕСТЬNULL(КорАналитика.Подразделение, Аналитика.Подразделение)
	|		КОГДА ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА ЕСТЬNULL(КорАналитика.Договор.Подразделение, Аналитика.Договор.Подразделение)
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ПодразделениеДт,
	|
	|	ЕСТЬNULL(КорАналитика.Назначение.НаправлениеДеятельности,
	|		ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)) КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|
	|	ЕСТЬNULL(КорАналитика.Номенклатура, Аналитика.Номенклатура) КАК СубконтоДт1,
	|	ВЫБОР
	|		КОГДА Строки.КорРазделУчета В (
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|		ТОГДА Строки.КорАналитикаФинансовогоУчета
	|		ИНАЧЕ ЕСТЬNULL(КорАналитика.МестоХранения, Аналитика.МестоХранения)
	|	КОНЕЦ КАК СубконтоДт2,
	|	ВЫБОР
	|		КОГДА Строки.КорРазделУчета В (
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути))
	|			И ЕСТЬNULL(КорАналитика.ТипМестаХранения, Аналитика.ТипМестаХранения) В (ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента),
	|											ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер))
	|		ТОГДА ЕСТЬNULL(КорАналитика.Контрагент, Аналитика.Контрагент)
	|		КОГДА Строки.КорВидЗапасов = ЗНАЧЕНИЕ(Справочник.ВидыЗапасов.ПустаяСсылка)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Работы)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.МатериальныеЗатраты)
	|	КОНЕЦ КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	Строки.РезервПодОбесценениеРегл КАК СуммаВРДт,
	|
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеПроизводства)
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути))
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеПереданные)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПодОбесценениеТМЦ)
	|	КОНЕЦ КАК ВидСчетаКт,
	|
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|		ТОГДА Строки.АналитикаФинансовогоУчета
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|		ТОГДА ЕСТЬNULL(Строки.ВидЗапасов.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка))
	|		ИНАЧЕ ЕСТЬNULL(Аналитика.Номенклатура.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаНоменклатуры.ПустаяСсылка))
	|	КОНЕЦ КАК АналитикаУчетаКт,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|			И Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|									ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику))
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ Аналитика.МестоХранения
	|	КОНЕЦ КАК МестоУчетаКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВалютаКт,
	|	ВЫБОР
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Склад)
	|		ТОГДА Аналитика.СкладскаяТерритория.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Подразделение)
	|		ТОГДА Аналитика.Подразделение
	|		КОГДА Аналитика.ТипМестаХранения = ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента)
	|		ТОГДА Аналитика.Договор.Подразделение
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК ПодразделениеКт,
	|	ЕСТЬNULL(Назначения.НаправлениеДеятельности,
	|		ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)) КАК НаправлениеДеятельностиКт,
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Аналитика.Номенклатура КАК СубконтоКт1,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета В (ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ПроизводственныеЗатраты),
	|								ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.НезавершенноеПроизводство))
	|		ТОГДА Строки.АналитикаФинансовогоУчета
	|		ИНАЧЕ Аналитика.МестоХранения
	|	КОНЕЦ КАК СубконтоКт2,
	|	ВЫБОР
	|		КОГДА Строки.РазделУчета В (
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеПереработчику),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыВПути),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыПереданныеНаКомиссию),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.СобственныеТоварыПереданныеПартнерам),
	|			ЗНАЧЕНИЕ(Перечисление.РазделыУчетаСебестоимостиТоваров.ТоварыВПути))
	|			И Аналитика.ТипМестаХранения В (ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.ДоговорКонтрагента),
	|											ЗНАЧЕНИЕ(Перечисление.ТипыМестХранения.Партнер))
	|		ТОГДА Аналитика.Контрагент
	|		КОГДА Строки.ВидЗапасов = ЗНАЧЕНИЕ(Справочник.ВидыЗапасов.ПустаяСсылка)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Работы)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.МатериальныеЗатраты)
	|	КОНЕЦ КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	Строки.РезервПодОбесценениеРегл КАК СуммаВРКт,
	|	
	|	""Перенос резервов под обесценение запасов"" КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.СебестоимостьТоваров КАК Строки
	|	ПО
	|		ДокументыКОтражению.Ссылка = Строки.Регистратор
	|		И Строки.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И Строки.Активность
	|		И Строки.РасчетСебестоимости
	|		И НЕ Строки.РасчетПартий
	|		И Строки.Количество = 0
	|		И НЕ Строки.ХозяйственнаяОперация В (
	|			ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПеремещениеТоваровМеждуФилиалами),
	|			ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеРезервовПодОбесценениеЗапасов),
	|			ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ВосстановлениеРезервовПодОбесценениеЗапасов),
	|			ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеОшибокОкругления),
	|			ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.НачислениеРезерваПодОбесценениеЗапасов))
	|		И (Строки.РезервПодОбесценениеРегл <> 0 ИЛИ Строки.РезервПодОбесценениеУпр <> 0)
	|		И НЕ Строки.Сторно
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Справочник.КлючиАналитикиУчетаНоменклатуры КАК Аналитика
	|	ПО
	|		Строки.АналитикаУчетаНоменклатуры = Аналитика.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		Справочник.КлючиАналитикиУчетаНоменклатуры КАК КорАналитика
	|	ПО
	|		Строки.КорАналитикаУчетаНоменклатуры = КорАналитика.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Назначения КАК Назначения
	|		ПО Аналитика.Назначение = Назначения.Ссылка";
	
	Возврат ТекстВозврата;
	
КонецФункции

Функция ТекстПереносОбесцененияВНА() Экспорт
	
	ТекстВозврата =
	"//// Перенос обесценения ВНА (Дт 02.04, 05.04 :: Кт 02.04, 05.04) в рамках одной организации.
	|ВЫБРАТЬ 
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	ОбесценениеВНА.Период КАК Период,
	|	ОбесценениеВНА.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	ОбесценениеВНА.ОбесценениеРегл КАК Сумма,
	|	ОбесценениеВНА.ОбесценениеУпр КАК СуммаУУ,
	|	
	|	// Дт //////////////////////////////////////////////////////////////////////////////////
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ОбесценениеВНА) КАК ВидСчетаДт,
	|	ОбесценениеВНА.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	ОбесценениеВНА.Подразделение КАК ПодразделениеДт,
	|	ОбесценениеВНА.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	ОбесценениеВНА.ВнеоборотныйАктив КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	ОбесценениеВНА.ОбесценениеРегл КАК СуммаВРДт,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ОбесценениеВНА) КАК ВидСчетаКт,
	|	КорОбесценениеВНА.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	// Кт //////////////////////////////////////////////////////////////////////////////////
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	КорОбесценениеВНА.Подразделение КАК ПодразделениеКт,
	|	КорОбесценениеВНА.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	КорОбесценениеВНА.ВнеоборотныйАктив КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	ОбесценениеВНА.ОбесценениеРегл КАК СуммаВРКт,
	|	
	|	ВЫБОР
	|		КОГДА ОбесценениеВНА.ВнеоборотныйАктив ССЫЛКА Справочник.ОбъектыЭксплуатации
	|			ТОГДА ""Перенос обесценения ОС""
	|		ИНАЧЕ ""Перенос обесценения НМА""
	|	КОНЕЦ КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ОбесценениеВНА КАК ОбесценениеВНА
	|	ПО
	|		ОбесценениеВНА.Регистратор = ДокументыКОтражению.Ссылка
	|		И ОбесценениеВНА.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|		И ОбесценениеВНА.НастройкаХозяйственнойОперации В 
	|			(ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.РеклассификацияОС),
	|			ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.РеклассификацияНМА))
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ОбесценениеВНА КАК КорОбесценениеВНА
	|	ПО
	|		КорОбесценениеВНА.Регистратор = ДокументыКОтражению.Ссылка
	|		И КорОбесценениеВНА.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И КорОбесценениеВНА.ИдентификаторФинЗаписи = ОбесценениеВНА.ИдентификаторФинЗаписи
	|		
	|ГДЕ
	|	ОбесценениеВНА.Организация = КорОбесценениеВНА.Организация
	|	
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|//// Перенос обесценения ВНА (Дт 02.04, 05.04 :: Кт 79.01) между организациями через 79 счет, отправитель.
	|ВЫБРАТЬ 
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	ОбесценениеВНА.Период КАК Период,
	|	ОбесценениеВНА.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	ОбесценениеВНА.ОбесценениеРегл КАК Сумма,
	|	ОбесценениеВНА.ОбесценениеУпр КАК СуммаУУ,
	|
	|	// Дт //////////////////////////////////////////////////////////////////////////////////
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ОбесценениеВНА) КАК ВидСчетаДт,
	|	ОбесценениеВНА.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	ОбесценениеВНА.Подразделение КАК ПодразделениеДт,
	|	ОбесценениеВНА.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	ОбесценениеВНА.ВнеоборотныйАктив КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	ОбесценениеВНА.ОбесценениеРегл КАК СуммаВРДт,
	|
	|	// Кт //////////////////////////////////////////////////////////////////////////////////
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК ГруппаФинансовогоУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВалютаКт,
	|	ОбесценениеВНА.Подразделение КАК ПодразделениеКт,
	|	ОбесценениеВНА.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоВыделенномуИмуществу) КАК СчетКт,
	|	КорОбесценениеВНА.Организация КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	
	|	ВЫБОР
	|		КОГДА ОбесценениеВНА.ВнеоборотныйАктив ССЫЛКА Справочник.ОбъектыЭксплуатации
	|			ТОГДА ""Перенос обесценения ОС""
	|		ИНАЧЕ ""Перенос обесценения НМА""
	|	КОНЕЦ КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ОбесценениеВНА КАК ОбесценениеВНА
	|	ПО
	|		ОбесценениеВНА.Регистратор = ДокументыКОтражению.Ссылка
	|		И ОбесценениеВНА.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|		И ОбесценениеВНА.НастройкаХозяйственнойОперации В 
	|			(ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.РеклассификацияОС),
	|			ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.РеклассификацияНМА))
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ОбесценениеВНА КАК КорОбесценениеВНА
	|	ПО
	|		КорОбесценениеВНА.Регистратор = ДокументыКОтражению.Ссылка
	|		И КорОбесценениеВНА.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И КорОбесценениеВНА.ИдентификаторФинЗаписи = ОбесценениеВНА.ИдентификаторФинЗаписи
	|		
	|ГДЕ
	|	ОбесценениеВНА.Организация <> КорОбесценениеВНА.Организация
	|	
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|//// Перенос обесценения ВНА (Дт 79.01 :: Кт 02.04, 05.04) между организациями через 79 счет, получатель.
	|ВЫБРАТЬ 
	|	ДокументыКОтражению.Ссылка КАК Ссылка,
	|	КорОбесценениеВНА.Период КАК Период,
	|	КорОбесценениеВНА.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	ОбесценениеВНА.ОбесценениеРегл КАК Сумма,
	|	ОбесценениеВНА.ОбесценениеУпр КАК СуммаУУ,
	|
	|	// Дт //////////////////////////////////////////////////////////////////////////////////
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК ГруппаФинансовогоУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВалютаДт,
	|	КорОбесценениеВНА.Подразделение КАК ПодразделениеДт,
	|	КорОбесценениеВНА.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоВыделенномуИмуществу) КАК СчетДт,
	|	ОбесценениеВНА.Организация КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	// Кт //////////////////////////////////////////////////////////////////////////////////
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ОбесценениеВНА) КАК ВидСчетаКт,
	|	КорОбесценениеВНА.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	КорОбесценениеВНА.Подразделение КАК ПодразделениеКт,
	|	КорОбесценениеВНА.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	КорОбесценениеВНА.ВнеоборотныйАктив КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	ОбесценениеВНА.ОбесценениеРегл КАК СуммаВРКт,
	|	
	|	ВЫБОР
	|		КОГДА ОбесценениеВНА.ВнеоборотныйАктив ССЫЛКА Справочник.ОбъектыЭксплуатации
	|			ТОГДА ""Перенос обесценения ОС""
	|		ИНАЧЕ ""Перенос обесценения НМА""
	|	КОНЕЦ КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ОбесценениеВНА КАК ОбесценениеВНА
	|	ПО
	|		ОбесценениеВНА.Регистратор = ДокументыКОтражению.Ссылка
	|		И ОбесценениеВНА.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|		И ОбесценениеВНА.НастройкаХозяйственнойОперации В 
	|			(ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.РеклассификацияОС),
	|			ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.РеклассификацияНМА))
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ОбесценениеВНА КАК КорОбесценениеВНА
	|	ПО
	|		КорОбесценениеВНА.Регистратор = ДокументыКОтражению.Ссылка
	|		И КорОбесценениеВНА.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|		И КорОбесценениеВНА.ИдентификаторФинЗаписи = ОбесценениеВНА.ИдентификаторФинЗаписи
	|		
	|ГДЕ
	|	ОбесценениеВНА.Организация <> КорОбесценениеВНА.Организация";
	
	Возврат ТекстВозврата;
	
КонецФункции

Функция ТекстВосстановлениеОбесцененияВНА() Экспорт

	ТекстВозврата =
	"ВЫБРАТЬ //// Восстановление обесценения ВНА (Дт 02.04, 05.04 :: Кт 91.01)
	|
	|	ДокументыКОтражению.Ссылка КАК Ссылка, 
	|	ОбесценениеВНА.Период КАК Период,
	|	ОбесценениеВНА.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	ОбесценениеВНА.ОбесценениеРегл КАК Сумма,
	|	ОбесценениеВНА.ОбесценениеУпр КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ОбесценениеВНА) КАК ВидСчетаДт,
	|	ОбесценениеВНА.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	ОбесценениеВНА.Подразделение КАК ПодразделениеДт,
	|	ОбесценениеВНА.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	ОбесценениеВНА.ВнеоборотныйАктив КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	ОбесценениеВНА.ОбесценениеРегл КАК СуммаВРДт,
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Доходы) КАК ВидСчетаКт,
	|	ПрочиеДоходы.СтатьяДоходов КАК АналитикаУчетаКт,
	|	ПрочиеДоходы.Подразделение КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	ПрочиеДоходы.Подразделение КАК ПодразделениеКт,
	|	ПрочиеДоходы.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	ПрочиеДоходы.СтатьяДоходов КАК СубконтоКт1,
	|	ПрочиеДоходы.АналитикаДоходов КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	ОбесценениеВНА.ОбесценениеРегл КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА ОбесценениеВНА.ВнеоборотныйАктив ССЫЛКА Справочник.ОбъектыЭксплуатации
	|			ТОГДА ""Восстановление обесценения ОС""
	|		ИНАЧЕ ""Восстановление обесценения НМА""
	|	КОНЕЦ КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|
	|ИЗ 
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ОбесценениеВНА КАК ОбесценениеВНА
	|	ПО
	|		ОбесценениеВНА.Регистратор = ДокументыКОтражению.Ссылка
	|		И ОбесценениеВНА.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|		И ОбесценениеВНА.НастройкаХозяйственнойОперации В 
	|			(ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ВосстановлениеОбесцененияОС),
	|			ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ВосстановлениеОбесцененияНМА))
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.ПрочиеДоходы КАК ПрочиеДоходы
	|	ПО
	|		ПрочиеДоходы.Регистратор = ДокументыКОтражению.Ссылка
	|		И ПрочиеДоходы.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|		И ПрочиеДоходы.ИдентификаторФинЗаписи = ОбесценениеВНА.ИдентификаторФинЗаписи
	|";
	
	Возврат ТекстВозврата;
	
КонецФункции

#КонецОбласти

#Область НастройкиОтражения

// Сопоставление порядка отражений и видов счетов учета
// ПрочиеОперации - реализован в ЗапросПрочихСчетов
// 
//
Функция ЗапросСчетов() Экспорт
	
	ТекстИнициализации = "
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	Настройка.Организация КАК Организация,
	|	Настройка.АналитикаУчета КАК АналитикаУчета,
	|	Настройка.МестоУчета КАК МестоУчета,
	|	Настройка.Долгосрочный КАК Долгосрочный,
	|	Настройка.ВидСчетаРеглУчета КАК ВидСчетаРеглУчета,
	|	Настройка.СчетУчета КАК СчетУчета,
	|	(ВЫБОР КОГДА Настройка.ИспользоватьСубконто И Настройка.ВидСубконто В (План.ВидСубконто1, План.ВидСубконто2, План.ВидСубконто3)
	|		ТОГДА Настройка.ИспользоватьСубконто ИНАЧЕ ЛОЖЬ КОНЕЦ) КАК ИспользоватьСубконто,
	|	(ВЫБОР КОГДА Настройка.ИспользоватьСубконто И Настройка.ВидСубконто В (План.ВидСубконто1, План.ВидСубконто2, План.ВидСубконто3)
	|		ТОГДА Настройка.ВидСубконто ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ) КАК ВидСубконто,
	|	(ВЫБОР КОГДА Настройка.ИспользоватьСубконто И Настройка.ВидСубконто В (План.ВидСубконто1, План.ВидСубконто2, План.ВидСубконто3)
	|		ТОГДА Настройка.Субконто ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ) КАК Субконто
	|ПОМЕСТИТЬ Счета
	|ИЗ 
	|	НастройкаСчетов КАК Настройка
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланХозрасчетный КАК План
	|		ПО План.Ссылка = Настройка.СчетУчета
	|ИНДЕКСИРОВАТЬ ПО
	|	Организация,
	|	АналитикаУчета,
	|	МестоУчета,
	|	ВидСчетаРеглУчета
	|";
	
	МассивПорядкаОтражения = Новый Массив;
	МассивПорядкаОтражения.Добавить(ТекстНастроекОтраженияСчетовУчета());
	МассивПорядкаОтражения.Добавить(ТекстПорядокОтраженияНДСпоПриобретеннымЦенностям());
	ТекстНастройкаСчетов = "(" + СтрСоединить(МассивПорядкаОтражения, ОбщегоНазначенияУТ.РазделительЗапросовВОбъединении()) + ")";
	
	Возврат Новый Запрос(СтрЗаменить(ТекстИнициализации, "НастройкаСчетов", ТекстНастройкаСчетов));
	
КонецФункции

Функция ЗапросПрочихСчетов() Экспорт
	Возврат Новый Запрос("
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ПорядокУчета.Дата КАК Период,
		|	ПорядокУчета.Организация КАК Организация,
		|	ПорядокУчета.Документ КАК Документ,
		|	ПорядокУчета.ИдентификаторСтроки КАК ИдентификаторСтроки,
		|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеОперации) КАК ВидСчетаРеглУчета,
		|	ПорядокУчета.СчетУчета КАК СчетУчета,
		|	ИСТИНА КАК ИспользоватьСубконто,
		|	ПорядокУчета.Субконто1 КАК Субконто1,
		|	ПорядокУчета.Субконто2 КАК Субконто2,
		|	ПорядокУчета.Субконто3 КАК Субконто3,
		|	План.ВидСубконто1 КАК ВидСубконто1,
		|	План.ВидСубконто2 КАК ВидСубконто2,
		|	План.ВидСубконто3 КАК ВидСубконто3
		|ПОМЕСТИТЬ
		|	ПрочиеСчета
		|ИЗ
		|	РегистрСведений.ПорядокОтраженияПрочихОпераций КАК ПорядокУчета
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
		|		ДокументыКОтражению КАК ДокументыКОтражению
		|	ПО
		|		ПорядокУчета.Документ = ДокументыКОтражению.Ссылка
		|	ЛЕВОЕ СОЕДИНЕНИЕ 
		|		ПланХозрасчетный КАК План
		|	ПО 
		|		План.Ссылка = ПорядокУчета.СчетУчета
		|ИНДЕКСИРОВАТЬ ПО
		|	Организация,
		|	Документ,
		|	ВидСчетаРеглУчета,
		|	ИдентификаторСтроки
		|");
КонецФункции

Функция ЗапросПланаСчетов() Экспорт
	
	ЗапросПлана = Новый Запрос;
	
	ТекстыВременныхТаблиц = Новый Массив;
	
	#Область ВидыСубконто
	
	ТекстыВидовСубконто = Новый Массив;
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПустаяСсылка) КАК Ссылка,
	|	ТИП(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные) КАК ТипЗначения,
	|	НЕОПРЕДЕЛЕНО КАК ПустоеЗначениеСубконто
	|ПОМЕСТИТЬ ВидыСубконто
	|ГДЕ ЛОЖЬ";
	ТекстыВидовСубконто.Добавить(ТекстЗапроса);
	
	ЗапросПВХ = Новый Запрос("
		|ВЫБРАТЬ
		|	ПВХ.Ссылка КАК Ссылка,
		|	ПВХ.ТипЗначения КАК ТипЗначения
		|ИЗ
		|	ПланВидовХарактеристик.ВидыСубконтоХозрасчетные КАК ПВХ
		|");
	ВидСубконто = ЗапросПВХ.Выполнить().Выбрать();
	
	ИндексСтроки = 0;
	Пока ВидСубконто.Следующий() Цикл
		Для Каждого Тип Из ВидСубконто.ТипЗначения.Типы() Цикл
			ИмяТипа = Метаданные.НайтиПоТипу(Тип).ПолноеИмя();
			
			ТекстТипа =
			"ВЫБРАТЬ
			|	ПВХ.Ссылка,
			|	ТИП(&ПодстановкаТипа),
			|	&ПодстановкаПустого
			|ИЗ ПланВидовХарактеристик.ВидыСубконтоХозрасчетные КАК ПВХ
			|ГДЕ ПВХ.Ссылка = &ПодстановкаСсылки";
			ТекстТипа = СтрЗаменить(ТекстТипа, "&ПодстановкаТипа", ИмяТипа);
			ТекстТипа = СтрЗаменить(ТекстТипа, "&ПодстановкаПустого", "ЗНАЧЕНИЕ("+ИмяТипа+".ПустаяСсылка)");
			ИмяПараметра = "Ссылка" + Формат(ИндексСтроки, "ЧГ=0");
			ТекстТипа = СтрЗаменить(ТекстТипа, "ПодстановкаСсылки", ИмяПараметра);
			ТекстыВидовСубконто.Добавить(ТекстТипа);
			
			ЗапросПлана.УстановитьПараметр(ИмяПараметра, ВидСубконто.Ссылка);
			
			ИндексСтроки = ИндексСтроки + 1;
		КонецЦикла;
	КонецЦикла;
	
	ТекстЗапросаВидыСубконто = СтрСоединить(ТекстыВидовСубконто, ОбщегоНазначенияУТ.РазделительЗапросовВОбъединении()) + "
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка";
	ТекстыВременныхТаблиц.Добавить(ТекстЗапросаВидыСубконто);
	
	#КонецОбласти
	
	#Область ПланСчетов
	
	ТекстЗапросаПланСчетов =
	"ВЫБРАТЬ
	|	План.Ссылка КАК Ссылка,
	|	План.Валютный КАК Валютный,
	|	План.УчетПоПодразделениям КАК УчетПоПодразделениям,
	|	План.УчетПоНаправлениямДеятельности КАК УчетПоНаправлениямДеятельности,
	|	План.Забалансовый КАК Забалансовый,
	|	План.Количественный КАК Количественный,
	|	План.ЗапретитьИспользоватьВПроводках КАК ЗапретитьИспользоватьВПроводках,
	|	План.НалоговыйУчет КАК НалоговыйУчет,
	|	ЕСТЬNULL(Виды1.ВидСубконто, ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПустаяСсылка)) КАК ВидСубконто1,
	|	ЕСТЬNULL(Виды2.ВидСубконто, ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПустаяСсылка)) КАК ВидСубконто2,
	|	ЕСТЬNULL(Виды3.ВидСубконто, ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПустаяСсылка)) КАК ВидСубконто3,
	|	МАКСИМУМ(ЕСТЬNULL(ВидыСубконто3.ТипЗначения, 1) = ЕСТЬNULL(ВидыСубконто1.ТипЗначения, 0)
	|		ИЛИ ЕСТЬNULL(ВидыСубконто3.ТипЗначения, 1) = ЕСТЬNULL(ВидыСубконто2.ТипЗначения, 0)) КАК ТипЗначенияСубконто3СовпадаетСПредыдущимиСубконто
	|ПОМЕСТИТЬ
	|	ПланХозрасчетный
	|ИЗ
	|	ПланСчетов.Хозрасчетный КАК План
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Хозрасчетный.ВидыСубконто КАК Виды1
	|		ПО План.Ссылка = Виды1.Ссылка И Виды1.НомерСтроки = 1
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Хозрасчетный.ВидыСубконто КАК Виды2
	|		ПО План.Ссылка = Виды2.Ссылка И Виды2.НомерСтроки = 2
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Хозрасчетный.ВидыСубконто КАК Виды3
	|		ПО План.Ссылка = Виды3.Ссылка И Виды3.НомерСтроки = 3
	|	ЛЕВОЕ СОЕДИНЕНИЕ ВидыСубконто КАК ВидыСубконто1
	|		ПО ВидыСубконто1.Ссылка = Виды1.ВидСубконто
	|	ЛЕВОЕ СОЕДИНЕНИЕ ВидыСубконто КАК ВидыСубконто2
	|		ПО ВидыСубконто2.Ссылка = Виды2.ВидСубконто
	|	ЛЕВОЕ СОЕДИНЕНИЕ ВидыСубконто КАК ВидыСубконто3
	|		ПО ВидыСубконто3.Ссылка = Виды3.ВидСубконто
	|СГРУППИРОВАТЬ ПО
	|	План.Ссылка,
	|	План.Валютный,
	|	План.УчетПоПодразделениям,
	|	План.УчетПоНаправлениямДеятельности,
	|	План.Забалансовый,
	|	План.Количественный,
	|	План.ЗапретитьИспользоватьВПроводках,
	|	План.НалоговыйУчет,
	|	ЕСТЬNULL(Виды1.ВидСубконто, ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПустаяСсылка)),
	|	ЕСТЬNULL(Виды2.ВидСубконто, ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПустаяСсылка)),
	|	ЕСТЬNULL(Виды3.ВидСубконто, ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПустаяСсылка))
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка";
	ТекстыВременныхТаблиц.Добавить(ТекстЗапросаПланСчетов);
	
	#КонецОбласти
	
	ЗапросПлана.Текст = СтрСоединить(ТекстыВременныхТаблиц, ОбщегоНазначения.РазделительПакетаЗапросов());
	
	Возврат ЗапросПлана;
	
КонецФункции

#Область ЗапросСчетов

Функция ТекстПорядокОтраженияНДСпоПриобретеннымЦенностям()
	
	ТекстЗапросаНастройкаСчетовНДС = "
		|ВЫБРАТЬ
		|	Организации.Ссылка                                                     КАК Организация,
		|	НастройкаСчетовНДС.АналитикаУчета                                      КАК АналитикаУчета,
		|	НастройкаСчетовНДС.МестоУчета                                          КАК МестоУчета,
		|	ЛОЖЬ                                                                   КАК Долгосрочный,
		|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НДСпоПриобретеннымЦенностям) КАК ВидСчетаРеглУчета,
		|	НастройкаСчетовНДС.СчетУчета                                           КАК СчетУчета,
		|	ЛОЖЬ                                                                   КАК ИспользоватьСубконто,
		|	НЕОПРЕДЕЛЕНО                                                           КАК ВидСубконто,
		|	НЕОПРЕДЕЛЕНО                                                           КАК Субконто
		|ИЗ
		|(
		|	ВЫБРАТЬ
		|		ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПустаяСсылка)         КАК АналитикаУчета,
		|		ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.Товары)                        КАК МестоУчета,
		|		ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДСпоПриобретеннымМПЗ)            КАК СчетУчета
		|)КАК НастройкаСчетовНДС
		|
		|ЛЕВОЕ СОЕДИНЕНИЕ
		|	Справочник.Организации КАК Организации
		|ПО ИСТИНА
		|";
	
	НастройкиОтраженияНДС = Новый Массив;
	
	ДобавитьНастройку(НастройкиОтраженияНДС,"Товары","ПустаяСсылка","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"Товары","ПродажаОблагаетсяНДС","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"Товары","ЛьготноеНалогообложениеНДСНаУСН","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"Товары","ПродажаНаЭкспорт","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"Товары","ЭкспортНесырьевыхТоваров","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"Товары","ЭкспортСырьевыхТоваровУслуг","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"Товары","Космос","НДСПоТоварамВКосмическойДеятельности");
	ДобавитьНастройку(НастройкиОтраженияНДС,"Товары","ВводОСВЭксплуатацию","НДСприПриобретенииОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"Товары","ПоФактическомуИспользованию","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"Товары","ОпределяетсяРаспределением","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"Товары","ПродажаНеОблагаетсяНДС","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"Товары","ОблагаетсяНДСУПокупателя","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"Товары","ПроизводствоСДЦ","НДСПоПродукцииСДлительнымПроизводственнымЦиклом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"Товары","РеализацияРаботУслугНаЭкспорт","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"Товары","ПродажаОблагаетсяНДСВСтранеЕАЭС","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"Товары","ОблагаетсяНДССМежценовойРазницы","НДСпоПриобретеннымМПЗ");
	
	ДобавитьНастройку(НастройкиОтраженияНДС,"ВосстановлениеПоКСФ","ПустаяСсылка","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ВосстановлениеПоКСФ","ПродажаОблагаетсяНДС","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ВосстановлениеПоКСФ","ЛьготноеНалогообложениеНДСНаУСН","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ВосстановлениеПоКСФ","ПродажаНаЭкспорт","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ВосстановлениеПоКСФ","ЭкспортНесырьевыхТоваров","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ВосстановлениеПоКСФ","ЭкспортСырьевыхТоваровУслуг","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ВосстановлениеПоКСФ","Космос","НДСПоТоварамВКосмическойДеятельности");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ВосстановлениеПоКСФ","ВводОСВЭксплуатацию","НДСприПриобретенииОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ВосстановлениеПоКСФ","ПоФактическомуИспользованию","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ВосстановлениеПоКСФ","ОпределяетсяРаспределением","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ВосстановлениеПоКСФ","ПродажаНеОблагаетсяНДС","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ВосстановлениеПоКСФ","ОблагаетсяНДСУПокупателя","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ВосстановлениеПоКСФ","ПроизводствоСДЦ","НДСПоПродукцииСДлительнымПроизводственнымЦиклом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ВосстановлениеПоКСФ","РеализацияРаботУслугНаЭкспорт","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ВосстановлениеПоКСФ","ПродажаОблагаетсяНДСВСтранеЕАЭС","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ВосстановлениеПоКСФ","ОблагаетсяНДССМежценовойРазницы","НДСпоПриобретеннымМПЗ");
	
	ДобавитьНастройку(НастройкиОтраженияНДС,"ПрочиеРаботыИУслуги","ПустаяСсылка","НДСпоПриобретеннымУслугам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ПрочиеРаботыИУслуги","ПродажаОблагаетсяНДС","НДСпоПриобретеннымУслугам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ПрочиеРаботыИУслуги","ЛьготноеНалогообложениеНДСНаУСН","НДСпоПриобретеннымУслугам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ПрочиеРаботыИУслуги","ПродажаНеОблагаетсяНДС","НДСпоПриобретеннымУслугам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ПрочиеРаботыИУслуги","ПродажаНаЭкспорт","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ПрочиеРаботыИУслуги","ЭкспортНесырьевыхТоваров","НДСпоПриобретеннымУслугам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ПрочиеРаботыИУслуги","ЭкспортСырьевыхТоваровУслуг","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ПрочиеРаботыИУслуги","Космос","НДСПоТоварамВКосмическойДеятельности");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ПрочиеРаботыИУслуги","ПоФактическомуИспользованию","НДСпоПриобретеннымУслугам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ПрочиеРаботыИУслуги","ОпределяетсяРаспределением","НДСпоПриобретеннымУслугам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ПрочиеРаботыИУслуги","ВводОСВЭксплуатацию","НДСприПриобретенииОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ПрочиеРаботыИУслуги","ОблагаетсяНДСУПокупателя","НДСпоПриобретеннымУслугам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ПрочиеРаботыИУслуги","ПроизводствоСДЦ","НДСПоПродукцииСДлительнымПроизводственнымЦиклом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ПрочиеРаботыИУслуги","РеализацияРаботУслугНаЭкспорт","НДСпоПриобретеннымУслугам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ПрочиеРаботыИУслуги","ПродажаОблагаетсяНДСВСтранеЕАЭС","НДСпоПриобретеннымУслугам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ПрочиеРаботыИУслуги","ОблагаетсяНДССМежценовойРазницы","НДСпоПриобретеннымУслугам");
	
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОС","ПустаяСсылка","НДСприПриобретенииОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОС","ПродажаОблагаетсяНДС","НДСприПриобретенииОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОС","ЛьготноеНалогообложениеНДСНаУСН","НДСприПриобретенииОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОС","ПродажаНеОблагаетсяНДС","НДСприПриобретенииОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОС","ПродажаНаЭкспорт","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОС","ЭкспортНесырьевыхТоваров","НДСприПриобретенииОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОС","ЭкспортСырьевыхТоваровУслуг","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОС","Космос","НДСПоТоварамВКосмическойДеятельности");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОС","ПоФактическомуИспользованию","НДСприПриобретенииОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОС","ОпределяетсяРаспределением","НДСприПриобретенииОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОС","ВводОСВЭксплуатацию","НДСприПриобретенииОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОС","ОблагаетсяНДСУПокупателя","НДСприПриобретенииОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОС","ПроизводствоСДЦ","НДСПоПродукцииСДлительнымПроизводственнымЦиклом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОС","РеализацияРаботУслугНаЭкспорт","НДСприПриобретенииОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОС","ПродажаОблагаетсяНДСВСтранеЕАЭС","НДСприПриобретенииОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОС","ОблагаетсяНДССМежценовойРазницы","НДСприПриобретенииОсновныхСредств");
	
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОбъектыНезавершенногоСтроительства","ПустаяСсылка","НДСприСтроительствеОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОбъектыНезавершенногоСтроительства","ПродажаОблагаетсяНДС","НДСприСтроительствеОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОбъектыНезавершенногоСтроительства","ЛьготноеНалогообложениеНДСНаУСН","НДСприСтроительствеОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОбъектыНезавершенногоСтроительства","ПродажаНеОблагаетсяНДС","НДСприСтроительствеОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОбъектыНезавершенногоСтроительства","ПродажаНаЭкспорт","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОбъектыНезавершенногоСтроительства","ЭкспортНесырьевыхТоваров","НДСприСтроительствеОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОбъектыНезавершенногоСтроительства","ЭкспортСырьевыхТоваровУслуг","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОбъектыНезавершенногоСтроительства","Космос","НДСПоТоварамВКосмическойДеятельности");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОбъектыНезавершенногоСтроительства","ПоФактическомуИспользованию","НДСприСтроительствеОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОбъектыНезавершенногоСтроительства","ОпределяетсяРаспределением","НДСприСтроительствеОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОбъектыНезавершенногоСтроительства","ВводОСВЭксплуатацию","НДСприСтроительствеОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОбъектыНезавершенногоСтроительства","ОблагаетсяНДСУПокупателя","НДСприСтроительствеОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОбъектыНезавершенногоСтроительства","ПроизводствоСДЦ","НДСПоПродукцииСДлительнымПроизводственнымЦиклом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОбъектыНезавершенногоСтроительства","РеализацияРаботУслугНаЭкспорт","НДСприСтроительствеОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОбъектыНезавершенногоСтроительства","ПродажаОблагаетсяНДСВСтранеЕАЭС","НДСприСтроительствеОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ОбъектыНезавершенногоСтроительства","ОблагаетсяНДССМежценовойРазницы","НДСприСтроительствеОсновныхСредств");
	
	ДобавитьНастройку(НастройкиОтраженияНДС,"НМА","ПустаяСсылка","НДСпоПриобретеннымНематериальнымАктивам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НМА","ПродажаОблагаетсяНДС","НДСпоПриобретеннымНематериальнымАктивам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НМА","ЛьготноеНалогообложениеНДСНаУСН","НДСпоПриобретеннымНематериальнымАктивам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НМА","ПродажаНеОблагаетсяНДС","НДСпоПриобретеннымНематериальнымАктивам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НМА","ПродажаНаЭкспорт","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НМА","ЭкспортНесырьевыхТоваров","НДСпоПриобретеннымНематериальнымАктивам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НМА","ЭкспортСырьевыхТоваровУслуг","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НМА","Космос","НДСПоТоварамВКосмическойДеятельности");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НМА","ПоФактическомуИспользованию","НДСпоПриобретеннымНематериальнымАктивам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НМА","ОпределяетсяРаспределением","НДСпоПриобретеннымНематериальнымАктивам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НМА","ВводОСВЭксплуатацию","НДСпоПриобретеннымНематериальнымАктивам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НМА","ОблагаетсяНДСУПокупателя","НДСпоПриобретеннымНематериальнымАктивам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НМА","ПроизводствоСДЦ","НДСПоПродукцииСДлительнымПроизводственнымЦиклом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НМА","РеализацияРаботУслугНаЭкспорт","НДСпоПриобретеннымНематериальнымАктивам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НМА","ПродажаОблагаетсяНДСВСтранеЕАЭС","НДСпоПриобретеннымНематериальнымАктивам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НМА","ОблагаетсяНДССМежценовойРазницы","НДСпоПриобретеннымНематериальнымАктивам");
	
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныеПлатежи","ПустаяСсылка","НДСУплачиваемыйТаможеннымОрганам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныеПлатежи","ПродажаОблагаетсяНДС","НДСУплачиваемыйТаможеннымОрганам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныеПлатежи","ЛьготноеНалогообложениеНДСНаУСН","НДСУплачиваемыйТаможеннымОрганам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныеПлатежи","ПродажаНеОблагаетсяНДС","НДСУплачиваемыйТаможеннымОрганам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныеПлатежи","ПродажаНаЭкспорт","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныеПлатежи","ЭкспортНесырьевыхТоваров","НДСУплачиваемыйТаможеннымОрганам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныеПлатежи","ЭкспортСырьевыхТоваровУслуг","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныеПлатежи","Космос","НДСПоТоварамВКосмическойДеятельности");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныеПлатежи","ВводОСВЭксплуатацию","НДСприПриобретенииОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныеПлатежи","ПоФактическомуИспользованию","НДСУплачиваемыйТаможеннымОрганам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныеПлатежи","ОпределяетсяРаспределением","НДСУплачиваемыйТаможеннымОрганам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныеПлатежи","ОблагаетсяНДСУПокупателя","НДСУплачиваемыйТаможеннымОрганам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныеПлатежи","ПроизводствоСДЦ","НДСПоПродукцииСДлительнымПроизводственнымЦиклом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныеПлатежи","РеализацияРаботУслугНаЭкспорт","НДСУплачиваемыйТаможеннымОрганам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныеПлатежи","ПродажаОблагаетсяНДСВСтранеЕАЭС","НДСУплачиваемыйТаможеннымОрганам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныеПлатежи","ОблагаетсяНДССМежценовойРазницы","НДСУплачиваемыйТаможеннымОрганам");
	
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентАренда","ПустаяСсылка","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентАренда","ПродажаОблагаетсяНДС","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентАренда","ЛьготноеНалогообложениеНДСНаУСН","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентАренда","ПродажаНеОблагаетсяНДС","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентАренда","ПродажаНаЭкспорт","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентАренда","ЭкспортНесырьевыхТоваров","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентАренда","ЭкспортСырьевыхТоваровУслуг","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентАренда","Космос","НДСПоТоварамВКосмическойДеятельности");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентАренда","ВводОСВЭксплуатацию","НДСприПриобретенииОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентАренда","ПоФактическомуИспользованию","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентАренда","ОпределяетсяРаспределением","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентАренда","ОблагаетсяНДСУПокупателя","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентАренда","ПроизводствоСДЦ","НДСПоПродукцииСДлительнымПроизводственнымЦиклом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентАренда","РеализацияРаботУслугНаЭкспорт","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентАренда","ПродажаОблагаетсяНДСВСтранеЕАЭС","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентАренда","ОблагаетсяНДССМежценовойРазницы","НДСУплачиваемыйНалоговымАгентом");
	
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентРеализацияИмущества","ПустаяСсылка","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентРеализацияИмущества","ПродажаОблагаетсяНДС","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентРеализацияИмущества","ЛьготноеНалогообложениеНДСНаУСН","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентРеализацияИмущества","ПродажаНеОблагаетсяНДС","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентРеализацияИмущества","ПродажаНаЭкспорт","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентРеализацияИмущества","ЭкспортНесырьевыхТоваров","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентРеализацияИмущества","ЭкспортСырьевыхТоваровУслуг","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентРеализацияИмущества","Космос","НДСПоТоварамВКосмическойДеятельности");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентРеализацияИмущества","ВводОСВЭксплуатацию","НДСприПриобретенииОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентРеализацияИмущества","ПоФактическомуИспользованию","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентРеализацияИмущества","ОпределяетсяРаспределением","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентРеализацияИмущества","ОблагаетсяНДСУПокупателя","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентРеализацияИмущества","ПроизводствоСДЦ","НДСПоПродукцииСДлительнымПроизводственнымЦиклом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентРеализацияИмущества","РеализацияРаботУслугНаЭкспорт","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентРеализацияИмущества","ПродажаОблагаетсяНДСВСтранеЕАЭС","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентРеализацияИмущества","ОблагаетсяНДССМежценовойРазницы","НДСУплачиваемыйНалоговымАгентом");
	
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентИностранцы","ПустаяСсылка","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентИностранцы","ПродажаОблагаетсяНДС","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентИностранцы","ЛьготноеНалогообложениеНДСНаУСН","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентИностранцы","ПродажаНеОблагаетсяНДС","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентИностранцы","ПродажаНаЭкспорт","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентИностранцы","ЭкспортНесырьевыхТоваров","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентИностранцы","ЭкспортСырьевыхТоваровУслуг","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентИностранцы","Космос","НДСПоТоварамВКосмическойДеятельности");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентИностранцы","ВводОСВЭксплуатацию","НДСприПриобретенииОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентИностранцы","ПоФактическомуИспользованию","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентИностранцы","ОпределяетсяРаспределением","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентИностранцы","ОблагаетсяНДСУПокупателя","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентИностранцы","ПроизводствоСДЦ","НДСПоПродукцииСДлительнымПроизводственнымЦиклом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентИностранцы","РеализацияРаботУслугНаЭкспорт","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентИностранцы","ПродажаОблагаетсяНДСВСтранеЕАЭС","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентИностранцы","ОблагаетсяНДССМежценовойРазницы","НДСУплачиваемыйНалоговымАгентом");
	
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентЭлектронныеУслуги","ПустаяСсылка","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентЭлектронныеУслуги","ПродажаОблагаетсяНДС","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентЭлектронныеУслуги","ЛьготноеНалогообложениеНДСНаУСН","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентЭлектронныеУслуги","ПродажаНеОблагаетсяНДС","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентЭлектронныеУслуги","ПродажаНаЭкспорт","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентЭлектронныеУслуги","ЭкспортНесырьевыхТоваров","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентЭлектронныеУслуги","ЭкспортСырьевыхТоваровУслуг","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентЭлектронныеУслуги","Космос","НДСПоТоварамВКосмическойДеятельности");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентЭлектронныеУслуги","ВводОСВЭксплуатацию","НДСприПриобретенииОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентЭлектронныеУслуги","ПоФактическомуИспользованию","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентЭлектронныеУслуги","ОпределяетсяРаспределением","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентЭлектронныеУслуги","ОблагаетсяНДСУПокупателя","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентЭлектронныеУслуги","ПроизводствоСДЦ","НДСПоПродукцииСДлительнымПроизводственнымЦиклом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентЭлектронныеУслуги","РеализацияРаботУслугНаЭкспорт","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентЭлектронныеУслуги","ПродажаОблагаетсяНДСВСтранеЕАЭС","НДСУплачиваемыйНалоговымАгентом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"НалоговыйАгентЭлектронныеУслуги","ОблагаетсяНДССМежценовойРазницы","НДСУплачиваемыйНалоговымАгентом");
	
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныйСоюз","ПустаяСсылка","НДСУплачиваемыйПриИмпортеИзТаможенногоСоюза");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныйСоюз","ПродажаОблагаетсяНДС","НДСУплачиваемыйПриИмпортеИзТаможенногоСоюза");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныйСоюз","ЛьготноеНалогообложениеНДСНаУСН","НДСУплачиваемыйПриИмпортеИзТаможенногоСоюза");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныйСоюз","ПродажаНеОблагаетсяНДС","НДСУплачиваемыйПриИмпортеИзТаможенногоСоюза");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныйСоюз","ПродажаНаЭкспорт","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныйСоюз","ЭкспортНесырьевыхТоваров","НДСУплачиваемыйПриИмпортеИзТаможенногоСоюза");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныйСоюз","ЭкспортСырьевыхТоваровУслуг","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныйСоюз","Космос","НДСПоТоварамВКосмическойДеятельности");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныйСоюз","ВводОСВЭксплуатацию","НДСприПриобретенииОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныйСоюз","ПоФактическомуИспользованию","НДСУплачиваемыйПриИмпортеИзТаможенногоСоюза");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныйСоюз","ОпределяетсяРаспределением","НДСУплачиваемыйПриИмпортеИзТаможенногоСоюза");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныйСоюз","ОблагаетсяНДСУПокупателя","НДСУплачиваемыйПриИмпортеИзТаможенногоСоюза");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныйСоюз","ПроизводствоСДЦ","НДСПоПродукцииСДлительнымПроизводственнымЦиклом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныйСоюз","РеализацияРаботУслугНаЭкспорт","НДСУплачиваемыйПриИмпортеИзТаможенногоСоюза");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныйСоюз","ПродажаОблагаетсяНДСВСтранеЕАЭС","НДСУплачиваемыйПриИмпортеИзТаможенногоСоюза");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТаможенныйСоюз","ОблагаетсяНДССМежценовойРазницы","НДСУплачиваемыйПриИмпортеИзТаможенногоСоюза");
	
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТоварыНалоговыйАгент","ПустаяСсылка","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТоварыНалоговыйАгент","ПродажаОблагаетсяНДС","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТоварыНалоговыйАгент","ЛьготноеНалогообложениеНДСНаУСН","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТоварыНалоговыйАгент","ПродажаНаЭкспорт","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТоварыНалоговыйАгент","ЭкспортНесырьевыхТоваров","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТоварыНалоговыйАгент","ЭкспортСырьевыхТоваровУслуг","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТоварыНалоговыйАгент","Космос","НДСПоТоварамВКосмическойДеятельности");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТоварыНалоговыйАгент","ВводОСВЭксплуатацию","НДСприПриобретенииОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТоварыНалоговыйАгент","ПоФактическомуИспользованию","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТоварыНалоговыйАгент","ОпределяетсяРаспределением","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТоварыНалоговыйАгент","ПродажаНеОблагаетсяНДС","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТоварыНалоговыйАгент","ОблагаетсяНДСУПокупателя","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТоварыНалоговыйАгент","ПроизводствоСДЦ","НДСПоПродукцииСДлительнымПроизводственнымЦиклом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТоварыНалоговыйАгент","РеализацияРаботУслугНаЭкспорт","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТоварыНалоговыйАгент","ПродажаОблагаетсяНДСВСтранеЕАЭС","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ТоварыНалоговыйАгент","ОблагаетсяНДССМежценовойРазницы","НДСпоПриобретеннымМПЗ");
	
	ДобавитьНастройку(НастройкиОтраженияНДС,"ЭлектронныеУслуги","ПустаяСсылка","НДСпоПриобретеннымУслугам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ЭлектронныеУслуги","ПродажаОблагаетсяНДС","НДСпоПриобретеннымУслугам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ЭлектронныеУслуги","ЛьготноеНалогообложениеНДСНаУСН","НДСпоПриобретеннымУслугам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ЭлектронныеУслуги","ПродажаНеОблагаетсяНДС","НДСпоПриобретеннымУслугам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ЭлектронныеУслуги","ПродажаНаЭкспорт","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ЭлектронныеУслуги","ЭкспортНесырьевыхТоваров","НДСпоПриобретеннымУслугам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ЭлектронныеУслуги","ЭкспортСырьевыхТоваровУслуг","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ЭлектронныеУслуги","Космос","НДСПоТоварамВКосмическойДеятельности");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ЭлектронныеУслуги","ПоФактическомуИспользованию","НДСпоПриобретеннымУслугам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ЭлектронныеУслуги","ОпределяетсяРаспределением","НДСпоПриобретеннымУслугам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ЭлектронныеУслуги","ВводОСВЭксплуатацию","НДСприПриобретенииОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ЭлектронныеУслуги","ОблагаетсяНДСУПокупателя","НДСпоПриобретеннымУслугам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ЭлектронныеУслуги","ПроизводствоСДЦ","НДСПоПродукцииСДлительнымПроизводственнымЦиклом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ЭлектронныеУслуги","РеализацияРаботУслугНаЭкспорт","НДСпоПриобретеннымУслугам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ЭлектронныеУслуги","ПродажаОблагаетсяНДСВСтранеЕАЭС","НДСпоПриобретеннымУслугам");
	ДобавитьНастройку(НастройкиОтраженияНДС,"ЭлектронныеУслуги","ОблагаетсяНДССМежценовойРазницы","НДСпоПриобретеннымУслугам");
	
	ДобавитьНастройку(НастройкиОтраженияНДС,"РеверсивноеОбложениеНДС","ПустаяСсылка","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"РеверсивноеОбложениеНДС","ПродажаОблагаетсяНДС","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"РеверсивноеОбложениеНДС","ЛьготноеНалогообложениеНДСНаУСН","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"РеверсивноеОбложениеНДС","ПродажаНаЭкспорт","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"РеверсивноеОбложениеНДС","ЭкспортНесырьевыхТоваров","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"РеверсивноеОбложениеНДС","ЭкспортСырьевыхТоваровУслуг","НДСПоТоварамРеализованнымПоСтавке0");
	ДобавитьНастройку(НастройкиОтраженияНДС,"РеверсивноеОбложениеНДС","Космос","НДСПоТоварамВКосмическойДеятельности");
	ДобавитьНастройку(НастройкиОтраженияНДС,"РеверсивноеОбложениеНДС","ВводОСВЭксплуатацию","НДСприПриобретенииОсновныхСредств");
	ДобавитьНастройку(НастройкиОтраженияНДС,"РеверсивноеОбложениеНДС","ПоФактическомуИспользованию","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"РеверсивноеОбложениеНДС","ОпределяетсяРаспределением","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"РеверсивноеОбложениеНДС","ПродажаНеОблагаетсяНДС","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"РеверсивноеОбложениеНДС","ОблагаетсяНДСУПокупателя","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"РеверсивноеОбложениеНДС","ПроизводствоСДЦ","НДСПоПродукцииСДлительнымПроизводственнымЦиклом");
	ДобавитьНастройку(НастройкиОтраженияНДС,"РеверсивноеОбложениеНДС","РеализацияРаботУслугНаЭкспорт","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"РеверсивноеОбложениеНДС","ПродажаОблагаетсяНДСВСтранеЕАЭС","НДСпоПриобретеннымМПЗ");
	ДобавитьНастройку(НастройкиОтраженияНДС,"РеверсивноеОбложениеНДС","ОблагаетсяНДССМежценовойРазницы","НДСпоПриобретеннымМПЗ");
	
	ТаблицаНастроек = СтрСоединить(НастройкиОтраженияНДС, " ОБЪЕДИНИТЬ ВСЕ ");
	
	ТекстЗапросаНастройкаСчетовНДС = СтрЗаменить(ТекстЗапросаНастройкаСчетовНДС,"
		|	ВЫБРАТЬ
		|		ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПустаяСсылка)         КАК АналитикаУчета,
		|		ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.Товары)                        КАК МестоУчета,
		|		ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДСпоПриобретеннымМПЗ)            КАК СчетУчета
		|", ТаблицаНастроек);
	
	Возврат ТекстЗапросаНастройкаСчетовНДС;
	
КонецФункции

Процедура ДобавитьНастройку(НастройкиОтраженияНДС, ВидЦенности, Налогообложение, СчетУчета)
	
	ШаблонНастройки = "
	|	ВЫБРАТЬ
	|		ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПустаяСсылка) КАК АналитикаУчета,
	|		ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.Товары)                КАК МестоУчета,
	|		ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.НДСпоПриобретеннымМПЗ)    КАК СчетУчета
	|
	|";
	ШаблонНастройки = СтрЗаменить(ШаблонНастройки, "ПустаяСсылка",          Налогообложение);
	ШаблонНастройки = СтрЗаменить(ШаблонНастройки, "Товары",                ВидЦенности);
	ШаблонНастройки = СтрЗаменить(ШаблонНастройки, "НДСпоПриобретеннымМПЗ", СчетУчета);
	
	НастройкиОтраженияНДС.Добавить(ШаблонНастройки);
	
КонецПроцедуры

Функция ТекстНастроекОтраженияСчетовУчета(МассивВидовСчетов = Неопределено)
	
	ТекстВозврата =
	"ВЫБРАТЬ
	|	ПорядокУчета.Организация КАК Организация,
	|	ПорядокУчета.АналитикаУчета КАК АналитикаУчета,
	|	ПорядокУчета.МестоУчета КАК МестоУчета,
	|	ПорядокУчета.Долгосрочный КАК Долгосрочный,
	|	ПорядокУчета.ВидСчета КАК ВидСчетаРеглУчета,
	|	ПорядокУчета.СчетУчета КАК СчетУчета,
	|	НЕ ВидыСубконто.Ссылка ЕСТЬ NULL КАК ИспользоватьСубконто,
	|	ЕСТЬNULL(ВидыСубконто.ВидСубконто, НЕОПРЕДЕЛЕНО) КАК ВидСубконто,
	|	ВЫБОР
	|		КОГДА ПорядокУчета.Субконто = НЕОПРЕДЕЛЕНО И НЕ ВидыСубконто.Ссылка ЕСТЬ NULL
	|		ТОГДА ПорядокУчета.АналитикаУчета
	|		ИНАЧЕ ПорядокУчета.Субконто
	|	КОНЕЦ КАК Субконто
	|ИЗ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК ПорядокУчета
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Хозрасчетный.ВидыСубконто КАК ВидыСубконто
	|	ПО ПорядокУчета.СчетУчета = ВидыСубконто.Ссылка
	|		И ВидыСубконто.ВидСубконто В (
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ПрочиеДоходыИРасходы),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.РасходыБудущихПериодов),
	|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.БанковскиеСчета))
	|		И (ТИПЗНАЧЕНИЯ(ПорядокУчета.Субконто) В (ТИП(ПланВидовХарактеристик.СтатьиРасходов),
	|												ТИП(ПланВидовХарактеристик.СтатьиДоходов))
	|		ИЛИ ВидыСубконто.ВидСубконто = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.БанковскиеСчета)
	|			И ПорядокУчета.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ДенежныеСредства))
	|ГДЕ
	|	&УсловиеОтбораВидовСчетов
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ПорядокУчета.Организация КАК Организация,
	|	ПорядокУчета.АналитикаУчета КАК АналитикаУчета,
	|	ПорядокУчета.МестоУчета КАК МестоУчета,
	|	ЛОЖЬ КАК Долгосрочный,
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.НДСПриДоходах) КАК ВидСчетаРеглУчета,
	|	(ВЫБОР
	|		КОГДА ПорядокУчета.СчетУчета = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеДоходы) ТОГДА
	|			ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеРасходы)
	|		КОГДА ПорядокУчета.СчетУчета В (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВыручкаНеЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВыручкаРаздельныйНУ)) ТОГДА
	|			ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.Продажи_НДС)
	|		ИНАЧЕ
	|			ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)
	|	КОНЕЦ) КАК СчетУчета,
	|	ЛОЖЬ КАК ИспользоватьСубконто,
	|	НЕОПРЕДЕЛЕНО КАК ВидСубконто,
	|	НЕОПРЕДЕЛЕНО КАК Субконто
	|ИЗ РегистрСведений.ПорядокОтраженияНаСчетахУчета КАК ПорядокУчета
	|ГДЕ
	|	ПорядокУчета.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Доходы)
	|	И ПорядокУчета.СчетУчета В (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПрочиеДоходы), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВыручкаНеЕНВД), ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ВыручкаРаздельныйНУ))";
	
	УсловиеОтбораВидовСчетов = "ПорядокУчета.ВидСчета <> ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПустаяСсылка)";
	Если МассивВидовСчетов <> Неопределено Тогда
		ШаблонСтрокиВидаСчета = "ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.%1)";
		МассивСтрокВидовСчетов = Новый Массив;
		Для каждого ВидСчетаРегл Из МассивВидовСчетов Цикл
			МассивСтрокВидовСчетов.Добавить(СтрШаблон(ШаблонСтрокиВидаСчета, XMLСтрока(ВидСчетаРегл)));
		КонецЦикла;
		Разделитель = Символы.ПС + Символы.Таб + Символы.Таб;
		УсловиеОтбораВидовСчетов = "ПорядокУчета.ВидСчета В (" + СтрСоединить(МассивСтрокВидовСчетов, Разделитель) + ")";
	КонецЕсли;
	
	ТекстВозврата = СтрЗаменить(ТекстВозврата, "&УсловиеОтбораВидовСчетов", УсловиеОтбораВидовСчетов);
	
	Возврат ТекстВозврата;
	
КонецФункции

#КонецОбласти

#КонецОбласти

#Область ПрочиеПроцедурыИФункции

Функция ТипыОбъектовРасчетовСКлиентами() Экспорт
	Возврат Метаданные.РегистрыНакопления["РасчетыСКлиентамиПоДокументам"].Измерения.ЗаказКлиента.Тип;
КонецФункции

Функция ТипыОбъектовРасчетовСПоставщиками() Экспорт
	Возврат Метаданные.РегистрыНакопления["РасчетыСПоставщикамиПоДокументам"].Измерения.ЗаказПоставщику.Тип;
КонецФункции

Функция ДокументыИспользующиеВыручкуИСебестоимостьПродаж()
	
	МассивВозврата = Новый Массив;
	МассивВозврата.Добавить("ВыкупТоваровХранителем");
	//++ НЕ УТКА
	МассивВозврата.Добавить("ОтчетДавальцу2_5");
	МассивВозврата.Добавить("ОтчетДавальцуМеждуОрганизациями");
	//-- НЕ УТКА
	МассивВозврата.Добавить("КорректировкаРеализации");
	
	Возврат МассивВозврата;
	
КонецФункции

Функция ТипыДокументовДляХозСпособа()
 
	ТипыДокументовХозПособ = Новый Массив;
	ТипыДокументовХозПособ.Добавить(Тип("ДокументСсылка.СписаниеНедостачТоваров"));
	//++ НЕ УТКА
	ТипыДокументовХозПособ.Добавить(Тип("ДокументСсылка.ЭтапПроизводства2_2"));
	//-- НЕ УТКА
	ТипыДокументовХозПособ.Добавить(Тип("ДокументСсылка.РаспределениеПроизводственныхЗатрат"));
	ТипыДокументовХозПособ.Добавить(Тип("ДокументСсылка.ПроизводствоБезЗаказа"));
	
	Возврат ТипыДокументовХозПособ;
		
КонецФункции
	
Функция ТекстВТОтраженияДокумента(ДокументИмя)
	
	ТекстВТОтраженияДокумента = "";
	ТекстОшибки = "";
	
	ИмяОбщегоМодуляДляОтражения = ДокументыИОбщиеМодулиОписывающиеОтражениеВРеглУчете().Получить(ДокументИмя);
	Если ИмяОбщегоМодуляДляОтражения = Неопределено Тогда
		Попытка
			ТекстВТОтраженияДокумента = Документы[ДокументИмя].ТекстЗапросаВТОтраженияВРеглУчете();
		Исключение
			ТекстОшибки = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
				НСтр("ru = 'В модуле менеджера документа %1 отсутствует функция ТекстЗапросаВТОтраженияВРеглУчете()';
					|en = 'Function ТекстЗапросаВТОтраженияВРеглУчете() is missing in the manager module of document %1'"), ДокументИмя);
		КонецПопытки;
	ИначеЕсли ЗначениеЗаполнено(ИмяОбщегоМодуляДляОтражения) Тогда
		Попытка
			ТекстВТОтраженияДокумента = ОбщегоНазначения.ОбщийМодуль(ИмяОбщегоМодуляДляОтражения).ТекстЗапросаВТОтраженияВРеглУчете(ДокументИмя);
		Исключение
			ТекстОшибки = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
				НСтр("ru = 'Для документа %1 в общем модуле %2 отсутствует функция ТекстЗапросаВТОтраженияВРеглУчете()';
					|en = 'The QueryTextInReflectionInReglAccounting() function is missing in the common module%2 for the %1 document'"),
				ДокументИмя, ИмяОбщегоМодуляДляОтражения);
		КонецПопытки;
	КонецЕсли;
	
	Если ЗначениеЗаполнено(ТекстОшибки) Тогда
		ЗаписьЖурналаРегистрации(
			НСтр("ru = 'Отражение в регламентированном учете';
				|en = 'Record in local accounting'", ОбщегоНазначения.КодОсновногоЯзыка()), 
			УровеньЖурналаРегистрации.Ошибка, , , ТекстОшибки);
		ВызватьИсключение ТекстОшибки;
	КонецЕсли;

	Возврат ТекстВТОтраженияДокумента;
	
КонецФункции

Функция ТекстОтраженияДокумента(ДокументИмя)
	
	ТекстОтраженияВРеглУчете = "";
	ТекстОшибки = "";
	
	ИмяОбщегоМодуляДляОтражения = ДокументыИОбщиеМодулиОписывающиеОтражениеВРеглУчете().Получить(ДокументИмя);
	Если ИмяОбщегоМодуляДляОтражения = Неопределено Тогда
		Попытка
			ТекстОтраженияВРеглУчете = Документы[ДокументИмя].ТекстОтраженияВРеглУчете();
		Исключение
			КраткоеПредставлениеОшибки = КраткоеПредставлениеОшибки(ИнформацияОбОшибке());
			ТекстОшибки = НСтр("ru = 'Возникла ошибка при вызове функции ТекстОтраженияВРеглУчете() в документе ""%1"":
							   |%2';
							   |en = 'Error occurred when calling ТекстОтраженияВРеглУчете() function in document ""%1"":
							   |%2'");
			ТекстОшибки = СтрШаблон(ТекстОшибки, ДокументИмя, КраткоеПредставлениеОшибки);
		КонецПопытки;
	ИначеЕсли ЗначениеЗаполнено(ИмяОбщегоМодуляДляОтражения) Тогда
		Попытка
			ТекстОтраженияВРеглУчете = ОбщегоНазначения.ОбщийМодуль(ИмяОбщегоМодуляДляОтражения).ТекстОтраженияВРеглУчете(ДокументИмя);
		Исключение
			ТекстОшибки = ОписаниеОшибки();
		КонецПопытки;
	КонецЕсли;
	
	Если ЗначениеЗаполнено(ТекстОшибки) Тогда
		ЗаписьЖурналаРегистрации(
			НСтр("ru = 'Отражение в регламентированном учете';
				|en = 'Record in local accounting'", ОбщегоНазначения.КодОсновногоЯзыка()), 
			УровеньЖурналаРегистрации.Ошибка, , , ТекстОшибки);
		ВызватьИсключение ТекстОшибки;
	КонецЕсли;
	
	ТекстОтраженияВРеглУчете = СокрЛП(ТекстОтраженияВРеглУчете);
	
	Если ТекстОтраженияВРеглУчете = "" Тогда
		Возврат "";
	КонецЕсли;
	
	ШаблонЗапроса = 
	"ВЫБРАТЬ // Запрос данных документа
	|	ДанныеДокумента.Ссылка КАК Ссылка,
	|	ДанныеДокумента.Период КАК Период,
	|	ДанныеДокумента.Организация КАК Организация,
	|	ДанныеДокумента.ИдентификаторСтроки КАК ИдентификаторСтроки,
	|
	|	ДанныеДокумента.Сумма КАК Сумма,
	|	ДанныеДокумента.СуммаУУ КАК СуммаУУ,
	|
	|	ДанныеДокумента.ВидСчетаДт КАК ВидСчетаДт,
	|	ДанныеДокумента.АналитикаУчетаДт КАК АналитикаУчетаДт,
	|	ДанныеДокумента.МестоУчетаДт КАК МестоУчетаДт,
	|
	|	ДанныеДокумента.ВалютаДт КАК ВалютаДт,
	|	ДанныеДокумента.ПодразделениеДт КАК ПодразделениеДт,
	|	ДанныеДокумента.НаправлениеДеятельностиДт КАК НаправлениеДеятельностиДт,
	|	ДанныеДокумента.СчетДт КАК СчетДт,
	|	ДанныеДокумента.СубконтоДт1 КАК СубконтоДт1,
	|	ДанныеДокумента.СубконтоДт2 КАК СубконтоДт2,
	|	ДанныеДокумента.СубконтоДт3 КАК СубконтоДт3,
	|	
	|	ДанныеДокумента.ВалютнаяСуммаДт КАК ВалютнаяСуммаДт,
	|	ДанныеДокумента.КоличествоДт КАК КоличествоДт,
	|	ДанныеДокумента.СуммаНУДт КАК СуммаНУДт,
	|	ДанныеДокумента.СуммаПРДт КАК СуммаПРДт,
	|	ДанныеДокумента.СуммаВРДт КАК СуммаВРДт,
	|	
	|	ДанныеДокумента.ВидСчетаКт КАК ВидСчетаКт,
	|	ДанныеДокумента.АналитикаУчетаКт КАК АналитикаУчетаКт,
	|	ДанныеДокумента.МестоУчетаКт КАК МестоУчетаКт,
	|
	|	ДанныеДокумента.ВалютаКт КАК ВалютаКт,
	|	ДанныеДокумента.ПодразделениеКт КАК ПодразделениеКт,
	|	ДанныеДокумента.НаправлениеДеятельностиКт КАК НаправлениеДеятельностиКт,
	|	ДанныеДокумента.СчетКт КАК СчетКт,
	|	ДанныеДокумента.СубконтоКт1 КАК СубконтоКт1,
	|	ДанныеДокумента.СубконтоКт2 КАК СубконтоКт2,
	|	ДанныеДокумента.СубконтоКт3 КАК СубконтоКт3,
	|
	|	ДанныеДокумента.ВалютнаяСуммаКт КАК ВалютнаяСуммаКт,
	|	ДанныеДокумента.КоличествоКт КАК КоличествоКт,
	|	ДанныеДокумента.СуммаНУКт КАК СуммаНУКт,
	|	ДанныеДокумента.СуммаПРКт КАК СуммаПРКт,
	|	ДанныеДокумента.СуммаВРКт КАК СуммаВРКт,
	|	
	|	ДанныеДокумента.Содержание КАК Содержание,
	|	ЛОЖЬ КАК Сторно
	|ИЗ 
	|	(&ДанныеДокумента) КАК ДанныеДокумента";
	
	МассивТекстОтраженияВРеглУчете = Новый Массив;
	
	ТекстИнициализации = 
	"ВЫБРАТЬ
	|	НЕОПРЕДЕЛЕНО КАК Ссылка,
	|	ДАТАВРЕМЯ(1, 1, 1) КАК Период,
	|	ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка) КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	0 КАК Сумма,
	|	0 КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПустаяСсылка) КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка) КАК ПодразделениеДт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиДт,
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПустаяСсылка) КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка) КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	
	|	"""" КАК Содержание
	|ГДЕ ЛОЖЬ";
	МассивТекстОтраженияВРеглУчете.Добавить(ТекстИнициализации);
	МассивТекстОтраженияВРеглУчете.Добавить(ТекстОтраженияВРеглУчете);
	ТекстДанныеДокумента = СтрСоединить(МассивТекстОтраженияВРеглУчете, ОбщегоНазначенияУт.РазделительЗапросовВОбъединении());
	
	Возврат СтрЗаменить(ШаблонЗапроса, "&ДанныеДокумента", ТекстДанныеДокумента);
	
КонецФункции

Функция ВТЗапроса(ТекстЗапроса) Экспорт
	
	ВТЗапроса = Новый Массив;
	
	Если ТекстЗапроса = "" Тогда
		Возврат ВТЗапроса;
	КонецЕсли;
	
	СхемаЗапроса = Новый СхемаЗапроса;
	СхемаЗапроса.УстановитьТекстЗапроса(ТекстЗапроса);
	Для Каждого Пакет Из СхемаЗапроса.ПакетЗапросов Цикл
		Если ТипЗнч(Пакет) = Тип("ЗапросВыбораСхемыЗапроса") И ЗначениеЗаполнено(Пакет.ТаблицаДляПомещения) Тогда
			ВТЗапроса.Добавить(Пакет.ТаблицаДляПомещения);
		ИначеЕсли ТипЗнч(Пакет) = Тип("ЗапросУничтоженияТаблицыСхемыЗапроса") Тогда
			ИндексТаблицы = ВТЗапроса.Найти(Пакет.ИмяТаблицы);
			Если ИндексТаблицы <> Неопределено Тогда
				ВТЗапроса.Удалить(ИндексТаблицы);
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
	
	Возврат ВТЗапроса;
	
КонецФункции

Функция ШаблонКомментарияОшибок(КодОшибки) Экспорт
	Если КодОшибки = "СЧЕТ_ЗАПРЕЩЕН" Тогда
		Возврат НСтр(
			"ru = 'Для учета %ВидСчета% %Измерение%%МестоАналитика% указан запрещенный счет ""%Счет%"".';
			|en = 'The ""%Счет%"" banned account is specified for the ""%ВидСчета%"" %Измерение%%МестоАналитика% accounting.'", ОбщегоНазначения.КодОсновногоЯзыка());
	ИначеЕсли КодОшибки = "СЧЕТ_ЗАБАЛАНСОВЫЙ" Тогда
		Возврат НСтр(
			"ru = 'Для учета %ВидСчета% %Измерение%%МестоАналитика% указан забалансовый счет ""%Счет%"".';
			|en = 'The ""%Счет%"" off-balance account is specified for the ""%ВидСчета%"" %Измерение%%МестоАналитика% accounting.'", ОбщегоНазначения.КодОсновногоЯзыка());
	ИначеЕсли КодОшибки = "СЧЕТ_ПУСТОЙ" Тогда
		Возврат НСтр(
			"ru = 'Для учета %ВидСчета% %Измерение%%МестоАналитика% не указан счет.';
			|en = 'Account is not specified for the ""%ВидСчета%"" %Измерение%%МестоАналитика% accounting.'", ОбщегоНазначения.КодОсновногоЯзыка());
	Иначе
		Возврат НСтр("ru = 'Неизвестная ошибка формирования проводок!';
					|en = 'Unknown error occurred while generating postings.'", ОбщегоНазначения.КодОсновногоЯзыка());
	КонецЕсли
КонецФункции

Функция СтрокаМестоУчета(МестоУчета) Экспорт
	
	ПредставлениеМеста = "";
	Если ЗначениеЗаполнено(МестоУчета) Тогда
		СоответствиеТипаМестаПредставлению = Новый Соответствие;
		СоответствиеТипаМестаПредставлению.Вставить(Тип("СправочникСсылка.Склады"),
			НСтр("ru = 'на складе ""%МестоУчета%""';
				|en = 'in the ""%МестоУчета%"" warehouse'", ОбщегоНазначения.КодОсновногоЯзыка()));
		СоответствиеТипаМестаПредставлению.Вставить(Тип("СправочникСсылка.СтруктураПредприятия"),
			НСтр("ru = 'в подразделении ""%МестоУчета%""';
				|en = 'in the ""%МестоУчета%"" business unit'", ОбщегоНазначения.КодОсновногоЯзыка()));
		СоответствиеТипаМестаПредставлению.Вставить(Тип("СправочникСсылка.Партнеры"),
			НСтр("ru = 'по партнеру ""%МестоУчета%""';
				|en = 'by the ""%МестоУчета%"" partner'", ОбщегоНазначения.КодОсновногоЯзыка()));
		СоответствиеТипаМестаПредставлению.Вставить(Тип("ПеречислениеСсылка.ВидыЦенностей"),
			НСтр("ru = 'по виду ценности ""%МестоУчета%""';
				|en = 'by the ""%МестоУчета%"" asset kind '", ОбщегоНазначения.КодОсновногоЯзыка()));
		
		ПредставлениеАналитики = СоответствиеТипаМестаПредставлению.Получить(ТипЗнч(МестоУчета));
		Если ПредставлениеАналитики = Неопределено Тогда
			ПредставлениеАналитики = НСтр("ru = 'по месту учета ""%МестоУчета%""';
											|en = 'by the ""%МестоУчета%"" registration place '", ОбщегоНазначения.КодОсновногоЯзыка());
		КонецЕсли;
		
		ПредставлениеМеста = " " + СтрЗаменить(ПредставлениеМеста, "%МестоУчета%", Строка(МестоУчета));
		
	КонецЕсли;
	
	Возврат ПредставлениеМеста;
	
КонецФункции

Функция СтрокаАналитикаУчета(АналитикаУчета) Экспорт
	
	ПредставлениеАналитики = "";
	Если ЗначениеЗаполнено(АналитикаУчета) Тогда
		
		СоответствиеТипаАналитикиПредставлению = Новый Соответствие;
		СоответствиеТипаАналитикиПредставлению.Вставить(Тип("СправочникСсылка.ГруппыФинансовогоУчетаДоходовРасходов"),
			НСтр("ru = 'по группе фин. учета ""%АналитикаУчета%""';
				|en = 'by the ""%АналитикаУчета%"" fin. accounting group'", ОбщегоНазначения.КодОсновногоЯзыка()));
		СоответствиеТипаАналитикиПредставлению.Вставить(Тип("СправочникСсылка.ГруппыФинансовогоУчетаРасчетов"),
			НСтр("ru = 'по группе фин. учета ""%АналитикаУчета%""';
				|en = 'by the ""%АналитикаУчета%"" fin. accounting group'", ОбщегоНазначения.КодОсновногоЯзыка()));
		СоответствиеТипаАналитикиПредставлению.Вставить(Тип("СправочникСсылка.ГруппыФинансовогоУчетаНоменклатуры"),
			НСтр("ru = 'по группе фин. учета ""%АналитикаУчета%""';
				|en = 'by the ""%АналитикаУчета%"" fin. accounting group'", ОбщегоНазначения.КодОсновногоЯзыка()));
		СоответствиеТипаАналитикиПредставлению.Вставить(Тип("СправочникСсылка.ГруппыФинансовогоУчетаВнеоборотныхАктивов"),
			НСтр("ru = 'по группе фин. учета ""%АналитикаУчета%""';
				|en = 'by the ""%АналитикаУчета%"" fin. accounting group'", ОбщегоНазначения.КодОсновногоЯзыка()));
		СоответствиеТипаАналитикиПредставлению.Вставить(Тип("ПланВидовХарактеристикСсылка.СтатьиДоходов"),
			НСтр("ru = 'по статье ""%АналитикаУчета%""';
				|en = 'by the ""%АналитикаУчета%"" item'", ОбщегоНазначения.КодОсновногоЯзыка()));
		СоответствиеТипаАналитикиПредставлению.Вставить(Тип("ПланВидовХарактеристикСсылка.СтатьиРасходов"),
			НСтр("ru = 'по статье ""%АналитикаУчета%""';
				|en = 'by the ""%АналитикаУчета%"" item'", ОбщегоНазначения.КодОсновногоЯзыка()));
		СоответствиеТипаАналитикиПредставлению.Вставить(Тип("СправочникСсылка.КатегорииЭксплуатации"),
			НСтр("ru = 'для категории эксплуатации ""%АналитикаУчета%""';
				|en = 'for operation category ""%АналитикаУчета%""'", ОбщегоНазначения.КодОсновногоЯзыка()));
		СоответствиеТипаАналитикиПредставлению.Вставить(Тип("СправочникСсылка.ВидыПодарочныхСертификатов"),
			НСтр("ru = 'для вида подарочного сертификата ""%АналитикаУчета%""';
				|en = 'for gift certificate kind ""%АналитикаУчета%""'", ОбщегоНазначения.КодОсновногоЯзыка()));
		СоответствиеТипаАналитикиПредставлению.Вставить(Тип("СправочникСсылка.БанковскиеСчетаОрганизаций"),
			НСтр("ru = 'для банковского счета ""%АналитикаУчета%""';
				|en = 'for bank account ""%АналитикаУчета%""'", ОбщегоНазначения.КодОсновногоЯзыка()));
		СоответствиеТипаАналитикиПредставлению.Вставить(Тип("СправочникСсылка.Кассы"),
			НСтр("ru = 'для кассы ""%АналитикаУчета%""';
				|en = 'for cash account ""%АналитикаУчета%""'", ОбщегоНазначения.КодОсновногоЯзыка()));
		СоответствиеТипаАналитикиПредставлению.Вставить(Тип("ПеречислениеСсылка.ТипыНалогообложенияНДС"),
			НСтр("ru = 'для налогообложения ""%АналитикаУчета%""';
				|en = 'for the ""%АналитикаУчета%"" taxation'", ОбщегоНазначения.КодОсновногоЯзыка()));
		
		ПредставлениеАналитики = СоответствиеТипаАналитикиПредставлению.Получить(ТипЗнч(АналитикаУчета));
		Если ПредставлениеАналитики = Неопределено Тогда
			ПредставлениеАналитики = НСтр("ru = 'для аналитики учета ""%АналитикаУчета%""';
											|en = 'for the ""%АналитикаУчета%"" accounting dimension'", ОбщегоНазначения.КодОсновногоЯзыка());
		КонецЕсли;
		
		ПредставлениеАналитики = " " + СтрЗаменить(ПредставлениеАналитики, "%АналитикаУчета%", Строка(АналитикаУчета));
		
	КонецЕсли;
	
	Возврат ПредставлениеАналитики;
	
КонецФункции

Функция СтрокаИзмерениеНастройки(ВидСчета, ИдентификаторСтроки, Организация) Экспорт
	
	Результат = "";
	Если ВидСчета = Перечисления.ВидыСчетовРеглУчета.ПрочиеАктивыПассивы Тогда
		Если ЗначениеЗаполнено(ИдентификаторСтроки) Тогда
			Результат = НСтр("ru = 'в строке ""%ИдентификаторСтроки%"" документа';
							|en = 'in the ""%ИдентификаторСтроки%"" line of the document'", ОбщегоНазначения.КодОсновногоЯзыка());
			Результат = СтрЗаменить(Результат, "%ИдентификаторСтроки%", Строка(ИдентификаторСтроки));
		Иначе
			Результат = НСтр("ru = 'в документе';
							|en = 'in document'", ОбщегоНазначения.КодОсновногоЯзыка());
		КонецЕсли;
	Иначе
		Результат = НСтр("ru = 'в организации ""%Организация%""';
						|en = 'in the ""%Организация%"" company'", ОбщегоНазначения.КодОсновногоЯзыка());
		Результат = СтрЗаменить(Результат, "%Организация%", Строка(Организация));
	КонецЕсли;
	
	Возврат " " + Результат;
	
КонецФункции

Функция СтрокаВидСчета(ИмяВидаСчета, РазделУчета) Экспорт
	
	Если Не ЗначениеЗаполнено(ИмяВидаСчета) Тогда
		Возврат "";
	КонецЕсли;
	
	ПредставлениеВидаСчета = """" + Строка(Перечисления.ВидыСчетовРеглУчета[ИмяВидаСчета]) + """";
	Если РазделУчета = Неопределено Тогда
		Результат = ПредставлениеВидаСчета;
	ИначеЕсли РазделУчета = "РасчетыСПартнерами"
		И ИмяВидаСчета = "ПереносДолгосрочнойЗадолженности" Тогда
		Результат = НСтр("ru = 'переноса долгосрочной задолженности';
						|en = 'long-term debt transfer'", ОбщегоНазначения.КодОсновногоЯзыка());
	ИначеЕсли РазделУчета = "РасчетыСКомиссионерами" И ИмяВидаСчета = "РасчетыСКлиентами" Тогда
		Результат = НСтр("ru = 'Расчеты с комиссионерами по товарам';
						|en = 'Goods settlements with consignees '", ОбщегоНазначения.КодОсновногоЯзыка());
	ИначеЕсли РазделУчета = "РасчетыСКомиссионерами" И ИмяВидаСчета = "РасчетыСПоставщиками" Тогда
		Результат = НСтр("ru = 'Расчеты с комиссионерами по вознаграждению';
						|en = 'Remuneration settlements with consignees'", ОбщегоНазначения.КодОсновногоЯзыка());
	ИначеЕсли РазделУчета = "РасчетыСКомиссионерами" И ИмяВидаСчета = "АвансыПолученные" Тогда
		Результат = НСтр("ru = 'Авансы с комиссионерами по товарам';
						|en = 'Advances with consignees for goods'", ОбщегоНазначения.КодОсновногоЯзыка());
	ИначеЕсли РазделУчета = "РасчетыСКомиссионерами" И ИмяВидаСчета = "АвансыВыданные" Тогда
		Результат = НСтр("ru = 'Авансы с комиссионерами по вознаграждению';
						|en = 'Advances with consignees for remuneration'", ОбщегоНазначения.КодОсновногоЯзыка());
	ИначеЕсли РазделУчета = "РасчетыСКомитентами" И ИмяВидаСчета = "РасчетыСПоставщиками" Тогда
		Результат = НСтр("ru = 'Расчеты с комитентами по товарам';
						|en = 'Goods settlements with consignors'", ОбщегоНазначения.КодОсновногоЯзыка());
	ИначеЕсли РазделУчета = "РасчетыСКомитентами" И ИмяВидаСчета = "РасчетыСКлиентами" Тогда
		Результат = НСтр("ru = 'Расчеты с комитентами по вознаграждению';
						|en = 'Remuneration settlements with consignors '", ОбщегоНазначения.КодОсновногоЯзыка());
	ИначеЕсли РазделУчета = "РасчетыСКомитентами" И ИмяВидаСчета = "АвансыВыданные" Тогда
		Результат = НСтр("ru = 'Авансы с комитентами по товарам';
						|en = 'Advances with consignors for goods'", ОбщегоНазначения.КодОсновногоЯзыка());
	ИначеЕсли РазделУчета = "РасчетыСКомитентами" И ИмяВидаСчета = "АвансыПолученные" Тогда
		Результат = НСтр("ru = 'Авансы с комитентами по вознаграждению';
						|en = 'Advances with consignors for remuneration'", ОбщегоНазначения.КодОсновногоЯзыка());
	ИначеЕсли РазделУчета = "РасчетыСКомитентамиПоЗакупке" И ИмяВидаСчета = "РасчетыСКлиентами" Тогда
		Результат = НСтр("ru = 'Расчеты с комитентами по закупке товаров';
						|en = 'Goods purchase settlements with consignors'", ОбщегоНазначения.КодОсновногоЯзыка());
	ИначеЕсли РазделУчета = "РасчетыСКомитентамиПоЗакупке" И ИмяВидаСчета = "АвансыПолученные" Тогда
		Результат = НСтр("ru = 'Авансы с комитентами по закупке товаров';
						|en = 'Goods purchase advance payments to consignors'", ОбщегоНазначения.КодОсновногоЯзыка());
	ИначеЕсли РазделУчета = "РасчетыСПереработчиками" И ИмяВидаСчета = "РасчетыСКлиентами" Тогда
		Результат = НСтр("ru = 'Расчеты с переработчиками по выкупу';
						|en = 'AR/AP with subcontractors for buyback'", ОбщегоНазначения.КодОсновногоЯзыка());
	ИначеЕсли РазделУчета = "РасчетыСПереработчиками" И ИмяВидаСчета = "РасчетыСПоставщиками" Тогда
		Результат = НСтр("ru = 'Расчеты с переработчиками по оказанию услуг';
						|en = 'AR/AP with subcontractors for provision of services'", ОбщегоНазначения.КодОсновногоЯзыка());
	ИначеЕсли РазделУчета = "РасчетыСПереработчиками" И ИмяВидаСчета = "АвансыПолученные" Тогда
		Результат = НСтр("ru = 'Авансы с переработчиками по выкупу';
						|en = 'Prepayments with subcontractors for buyback'", ОбщегоНазначения.КодОсновногоЯзыка());
	ИначеЕсли РазделУчета = "РасчетыСПереработчиками" И ИмяВидаСчета = "АвансыВыданные" Тогда
		Результат = НСтр("ru = 'Авансы с переработчиками по оказанию услуг';
						|en = 'Prepayments with subcontractors for provision of services'", ОбщегоНазначения.КодОсновногоЯзыка());
	ИначеЕсли РазделУчета = "РасчетыСДавальцами" И ИмяВидаСчета = "РасчетыСКлиентами" Тогда
		Результат = НСтр("ru = 'Расчеты с давальцами по оказанию услуг';
						|en = 'AR/AP with providers for services'", ОбщегоНазначения.КодОсновногоЯзыка());
	ИначеЕсли РазделУчета = "РасчетыСДавальцами" И ИмяВидаСчета = "РасчетыСПоставщиками" Тогда
		Результат = НСтр("ru = 'Расчеты с давальцами по выкупу';
						|en = 'AR/AP with providers for redemption'", ОбщегоНазначения.КодОсновногоЯзыка());
	ИначеЕсли РазделУчета = "РасчетыСДавальцами" И ИмяВидаСчета = "АвансыПолученные" Тогда
		Результат = НСтр("ru = 'Авансы с давальцами по оказанию услуг';
						|en = 'Advance payments with providers for services'", ОбщегоНазначения.КодОсновногоЯзыка());
	ИначеЕсли РазделУчета = "РасчетыСДавальцами" И ИмяВидаСчета = "АвансыВыданные" Тогда
		Результат = НСтр("ru = 'Авансы с давальцами по выкупу';
						|en = 'Advance payments with providers for redemption'", ОбщегоНазначения.КодОсновногоЯзыка());
	ИначеЕсли РегистрыСведений.ПорядокОтраженияНаСчетахУчета.СписокСчетовУчетаПоРазделуУчета(РазделУчета) = 1 Тогда
		СписокРазделов = РегистрыСведений.ПорядокОтраженияНаСчетахУчета.СписокРазделовСчетовУчета();
		ПредставлениеРазделаУчета = СписокРазделов.НайтиПоЗначению(РазделУчета).Представление;
		Результат = ПредставлениеРазделаУчета;
	ИначеЕсли РазделУчета = ИмяВидаСчета Тогда
		СписокРазделов = РегистрыСведений.ПорядокОтраженияНаСчетахУчета.СписокРазделовСчетовУчета();
		ПредставлениеРазделаУчета = СписокРазделов.НайтиПоЗначению(РазделУчета).Представление;
		Результат = ПредставлениеРазделаУчета;
	ИначеЕсли СтрНачинаетсяС(ИмяВидаСчета, РазделУчета) Тогда
		Результат = ПредставлениеВидаСчета;
	Иначе
		СписокРазделов = РегистрыСведений.ПорядокОтраженияНаСчетахУчета.СписокРазделовСчетовУчета();
		ПредставлениеРазделаУчета = СписокРазделов.НайтиПоЗначению(РазделУчета).Представление;
		Результат = СтрШаблон(НСтр("ru = '%1 для вида счета %2';
									|en = '%1 for the account type %2'", ОбщегоНазначения.КодОсновногоЯзыка()), ПредставлениеРазделаУчета, ПредставлениеВидаСчета);
	КонецЕсли;
	
	Возврат Результат;
	
КонецФункции

Функция ПредставлениеРазделаУчетаПоВидуСчета(ВидСчета) Экспорт
	
	ИмяВидаСчета = XMLСтрока(ВидСчета);
	
	Для каждого РазделУчета Из РегистрыСведений.ПорядокОтраженияНаСчетахУчета.СписокРазделовСчетовУчета() Цикл
		Если РазделУчета.Пометка Тогда
			СписокСчетов = РегистрыСведений.ПорядокОтраженияНаСчетахУчета.СписокСчетовУчетаПоРазделуУчета(РазделУчета.Значение);
			Если СписокСчетов.НайтиПоЗначению(ИмяВидаСчета) <> Неопределено Тогда
				Если СписокСчетов.Количество() = 1 Или РазделУчета.Значение = ИмяВидаСчета Тогда
					Возврат РазделУчета.Представление;
				Иначе
					Если СтрНачинаетсяС(ИмяВидаСчета, РазделУчета.Значение) Тогда
						Возврат """" + Строка(ВидСчета) + """";
					Иначе
						Возврат СтрШаблон(НСтр("ru = '%1 для вида счета ""%2""';
												|en = '%1 for the account type ""%2""'", ОбщегоНазначения.КодОсновногоЯзыка()), РазделУчета.Представление, Строка(ВидСчета))
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
	
	Возврат """" + Строка(ВидСчета) + """";
	
КонецФункции

Функция РазделУчетаПоВидуСчета(ИмяВидаСчета) Экспорт
	
	Если ИмяВидаСчета = "ПереносДолгосрочнойЗадолженности" Тогда
		Возврат "РасчетыСПартнерами";
	КонецЕсли;
	
	Для каждого РазделУчета Из РегистрыСведений.ПорядокОтраженияНаСчетахУчета.СписокРазделовСчетовУчета() Цикл
		Если РазделУчета.Пометка Тогда
			СписокСчетов = РегистрыСведений.ПорядокОтраженияНаСчетахУчета.СписокСчетовУчетаПоРазделуУчета(РазделУчета.Значение);
			Если СписокСчетов.НайтиПоЗначению(ИмяВидаСчета) <> Неопределено Тогда
				Возврат РазделУчета.Значение;
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
	
	Возврат Неопределено;
	
КонецФункции

Функция ЭтоОбъектРасчетов(ДокументИмя) Экспорт
	ТипыСКлиентами = Метаданные.ОпределяемыеТипы.ОбъектРасчетовСКлиентами.Тип;
	ТипыСПоставщиками = Метаданные.ОпределяемыеТипы.ОбъектРасчетовСПоставщиками.Тип;
	ДокументТип = Тип("ДокументСсылка." + ДокументИмя);
	Возврат ТипыСКлиентами.СодержитТип(ДокументТип) ИЛИ ТипыСПоставщиками.СодержитТип(ДокументТип);
КонецФункции

Функция ЭтоРасчетныйДокумент(ДокументИмя) Экспорт
	ТипыСКлиентами = Метаданные.ОпределяемыеТипы.РасчетныйДокументСКлиентом.Тип;
	ТипыСПоставщиками = Метаданные.ОпределяемыеТипы.РасчетныйДокументСПоставщиком.Тип;
	ДокументТип = Тип("ДокументСсылка." + ДокументИмя);
	Возврат ТипыСКлиентами.СодержитТип(ДокументТип) ИЛИ ТипыСПоставщиками.СодержитТип(ДокументТип);
КонецФункции

Функция ИспользуемыеТаблицыДляОтраженияТипа(ИмяТипаДокумента) Экспорт

	ТаблицыТиповДокументов = Новый Соответствие;

	// ++РУЧНОЙ СБОР
	// АмортизацияНМА
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.СписаниеНМА");
	ТаблицыДокумента.Добавить("РегистрБухгалтерии.Хозрасчетный");
	ТаблицыДокумента.Добавить("РегистрСведений.ПорядокУчетаНМА");
	ТаблицыТиповДокументов.Вставить("АмортизацияНМА", ТаблицыДокумента);
	
	// АмортизацияОС
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.СписаниеОС");
	ТаблицыДокумента.Добавить("РегистрСведений.МестонахождениеОС");
	ТаблицыДокумента.Добавить("РегистрСведений.ПорядокУчетаОС");
	ТаблицыТиповДокументов.Вставить("АмортизацияОС", ТаблицыДокумента);
	
	// КорректировкаНалогообложенияНДСПартийТоваров
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.КорректировкаНалогообложенияНДСПартийТоваров");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПартииТоваровОрганизаций");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаПартий");
	ТаблицыТиповДокументов.Вставить("КорректировкаНалогообложенияНДСПартийТоваров", ТаблицыДокумента);
	
	// ОбесценениеВНА
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОбесценениеВНА");
	ТаблицыДокумента.Добавить("РегистрНакопления.ОбесценениеВНА");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьНМА");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияНМА");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияОС");
	ТаблицыТиповДокументов.Вставить("ОбесценениеВНА", ТаблицыДокумента);

	// ПеремещениеОС
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПеремещениеОС");
	ТаблицыДокумента.Добавить("Документ.СписаниеОС");
	ТаблицыДокумента.Добавить("РегистрСведений.МестонахождениеОС");
	ТаблицыДокумента.Добавить("РегистрСведений.ПорядокУчетаОС");
	ТаблицыТиповДокументов.Вставить("ПеремещениеОС", ТаблицыДокумента);
	
	// ПеремещениеОС2_4
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПеремещениеОС2_4");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияОС");
	ТаблицыТиповДокументов.Вставить("ПеремещениеОС2_4", ТаблицыДокумента);
	
	// ПеремещениеНМА2_4
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПеремещениеНМА2_4");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьНМА");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияНМА");
	ТаблицыТиповДокументов.Вставить("ПеремещениеНМА2_4", ТаблицыДокумента);
	
	// ПереоценкаНМА
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПереоценкаНМА");
	ТаблицыДокумента.Добавить("Документ.СписаниеНМА");
	ТаблицыДокумента.Добавить("РегистрБухгалтерии.Хозрасчетный");
	ТаблицыДокумента.Добавить("РегистрСведений.ПорядокУчетаНМА");
	ТаблицыТиповДокументов.Вставить("ПереоценкаНМА", ТаблицыДокумента);
	
	// ПереоценкаНМА2_4
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПереоценкаНМА2_4");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьНМА");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияНМА");
	ТаблицыТиповДокументов.Вставить("ПереоценкаНМА2_4", ТаблицыДокумента);
	
	// ПереоценкаОС
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПереоценкаОС");
	ТаблицыДокумента.Добавить("Документ.СписаниеОС");
	ТаблицыДокумента.Добавить("РегистрСведений.МестонахождениеОС");
	ТаблицыДокумента.Добавить("РегистрСведений.ПорядокУчетаОС");
	ТаблицыТиповДокументов.Вставить("ПереоценкаОС", ТаблицыДокумента);
	
	// ПереоценкаОС2_4
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПереоценкаОС2_4");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияОС");
	ТаблицыТиповДокументов.Вставить("ПереоценкаОС2_4", ТаблицыДокумента);
	
	// ПодготовкаКПередачеНМА
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПодготовкаКПередачеНМА");
	ТаблицыДокумента.Добавить("Документ.СписаниеНМА");
	ТаблицыДокумента.Добавить("РегистрБухгалтерии.Хозрасчетный");
	ТаблицыДокумента.Добавить("РегистрСведений.ПорядокУчетаНМА");
	ТаблицыТиповДокументов.Вставить("ПодготовкаКПередачеНМА", ТаблицыДокумента);
	
	// ПодготовкаКПередачеНМА2_4
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПодготовкаКПередачеНМА2_4");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьНМА");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияНМА");
	ТаблицыТиповДокументов.Вставить("ПодготовкаКПередачеНМА2_4", ТаблицыДокумента);
	
	// ПодготовкаКПередачеОС
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПодготовкаКПередачеОС");
	ТаблицыДокумента.Добавить("Документ.СписаниеОС");
	ТаблицыДокумента.Добавить("РегистрБухгалтерии.Хозрасчетный");
	ТаблицыДокумента.Добавить("РегистрСведений.МестонахождениеОС");
	ТаблицыДокумента.Добавить("РегистрСведений.ПорядокУчетаОС");
	ТаблицыТиповДокументов.Вставить("ПодготовкаКПередачеОС", ТаблицыДокумента);
	
	// ПодготовкаКПередачеОС2_4
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПодготовкаКПередачеОС2_4");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияОС");
	ТаблицыТиповДокументов.Вставить("ПодготовкаКПередачеОС2_4", ТаблицыДокумента);
	
	// ВозвратОСИзАренды2_4
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВозвратОСИзАренды2_4");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.ИнвестицииВАренду");
	ТаблицыТиповДокументов.Вставить("ВозвратОСИзАренды2_4", ТаблицыДокумента);
	
	// ВыкупАрендованныхОС
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВыкупАрендованныхОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыПоФинансовымИнструментам");
	ТаблицыТиповДокументов.Вставить("ВыкупАрендованныхОС", ТаблицыДокумента);
	
	// ПрекращениеДоговораАренды
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПрекращениеДоговораАренды");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыПоФинансовымИнструментам");
	ТаблицыТиповДокументов.Вставить("ПрекращениеДоговораАренды", ТаблицыДокумента);
	
	// ИзменениеУсловийДоговораАренды
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ИзменениеУсловийДоговораАренды");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыПоФинансовымИнструментам");
	ТаблицыТиповДокументов.Вставить("ИзменениеУсловийДоговораАренды", ТаблицыДокумента);
	
	// ИзменениеУсловийПередачиВАренду
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ИзменениеУсловийПередачиВАренду");
	ТаблицыДокумента.Добавить("РегистрНакопления.ИнвестицииВАренду");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПрочиеДоходы");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПрочиеРасходы");
	ТаблицыТиповДокументов.Вставить("ИзменениеУсловийПередачиВАренду", ТаблицыДокумента);
	
	// НачислениеПроцентовПоАренде
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.НачислениеПроцентовПоАренде");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыПоФинансовымИнструментам");
	ТаблицыДокумента.Добавить("РегистрНакопления.ИнвестицииВАренду");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПрочиеДоходы");
	ТаблицыТиповДокументов.Вставить("НачислениеПроцентовПоАренде", ТаблицыДокумента);
	// --РУЧНОЙ СБОР
	
	// АвансовыйОтчет
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.АвансовыйОтчет");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСПоставщиками");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("АвансовыйОтчет", ТаблицыДокумента);
	
	// АктВыполненныхВнутреннихРабот
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.АктВыполненныхВнутреннихРабот");
	ТаблицыТиповДокументов.Вставить("АктВыполненныхВнутреннихРабот", ТаблицыДокумента);
	
	// АмортизацияНМА2_4
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.АмортизацияНМА2_4");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияНМА");
	ТаблицыТиповДокументов.Вставить("АмортизацияНМА2_4", ТаблицыДокумента);
	
	// АмортизацияОС2_4
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.АмортизацияОС2_4");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияОС");
	ТаблицыТиповДокументов.Вставить("АмортизацияОС2_4", ТаблицыДокумента);
	
	// АктВыполненныхРабот
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.АктВыполненныхРабот");
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСЗаписиКнигиПродаж");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСКлиентами");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("АктВыполненныхРабот", ТаблицыДокумента);

	// АннулированиеПодарочныхСертификатов
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.АннулированиеПодарочныхСертификатов");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПодарочныеСертификаты");
	ТаблицыТиповДокументов.Вставить("АннулированиеПодарочныхСертификатов", ТаблицыДокумента);

	// ВводДанныхПоНалогуНаПрибыль
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВводДанныхПоНалогуНаПрибыль");
	ТаблицыТиповДокументов.Вставить("ВводДанныхПоНалогуНаПрибыль", ТаблицыДокумента);

	// ВводОстатков
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВводОстатков");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыТиповДокументов.Вставить("ВводОстатков", ТаблицыДокумента);

	// ВводОстатковВнеоборотныхАктивов
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВводОстатковВнеоборотныхАктивов");
	ТаблицыТиповДокументов.Вставить("ВводОстатковВнеоборотныхАктивов", ТаблицыДокумента);

	// ВводОстатковВзаиморасчетовПоАренде
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВводОстатковВзаиморасчетовПоАренде");
	ТаблицыТиповДокументов.Вставить("ВводОстатковВзаиморасчетовПоАренде", ТаблицыДокумента);

	// ВводОстатковВнеоборотныхАктивов2_4
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВводОстатковВнеоборотныхАктивов2_4");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьНМА");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияНМА");
	ТаблицыТиповДокументов.Вставить("ВводОстатковВнеоборотныхАктивов2_4", ТаблицыДокумента);
	
	// ВводОстатковИнвестицииВАренду
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВводОстатковИнвестицииВАренду");
	ТаблицыДокумента.Добавить("РегистрНакопления.ИнвестицииВАренду");
	ТаблицыТиповДокументов.Вставить("ВводОстатковИнвестицииВАренду", ТаблицыДокумента);
	
	// ВзаимозачетЗадолженности
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВзаимозачетЗадолженности");
	ТаблицыДокумента.Добавить("РегистрНакопления.ДвиженияКонтрагентКонтрагент");
	ТаблицыДокумента.Добавить("РегистрСведений.НастройкиСистемыНалогообложения");
	ТаблицыТиповДокументов.Вставить("ВзаимозачетЗадолженности", ТаблицыДокумента);

	// ВнутреннееПотребление
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВнутреннееПотребление");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыТиповДокументов.Вставить("ВнутреннееПотребление", ТаблицыДокумента);

	// ВозвратМатериаловИзПроизводства
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВозвратМатериаловИзПроизводства");
	ТаблицыТиповДокументов.Вставить("ВозвратМатериаловИзПроизводства", ТаблицыДокумента);

	// ВозвратОСИзАренды
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВозвратОСИзАренды");
	ТаблицыТиповДокументов.Вставить("ВозвратОСИзАренды", ТаблицыДокумента);

	// ВозвратОСИзАренды2_4
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВозвратОСИзАренды2_4");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияОС");
	ТаблицыТиповДокументов.Вставить("ВозвратОСИзАренды2_4", ТаблицыДокумента);
	
	// ВозвратПодарочныхСертификатов
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВозвратПодарочныхСертификатов");
	ТаблицыДокумента.Добавить("РегистрНакопления.ДвиженияДенежныеСредстваКонтрагент");
	ТаблицыТиповДокументов.Вставить("ВозвратПодарочныхСертификатов", ТаблицыДокумента);

	//++ НЕ УТКА
	
	//++ Устарело_Переработка24
	// ВозвратСырьяДавальцу
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВозвратСырьяДавальцу");
	ТаблицыТиповДокументов.Вставить("ВозвратСырьяДавальцу", ТаблицыДокумента);
	//-- Устарело_Переработка24
	
	//-- НЕ УТКА
	
	//++ Устарело_Переработка24
	
	// ВозвратСырьяОтПереработчика
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВозвратСырьяОтПереработчика");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ВозвратСырьяОтПереработчика", ТаблицыДокумента);
	//-- Устарело_Переработка24
	
	// ВозвратТоваровМеждуОрганизациями
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВозвратТоваровМеждуОрганизациями");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ВозвратТоваровМеждуОрганизациями", ТаблицыДокумента);

	// ВозвратТоваровОтКлиента
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВозвратТоваровОтКлиента");
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСЗаписиКнигиПокупок");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаПоПартнерам");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ВозвратТоваровОтКлиента", ТаблицыДокумента);

	// ВозвратТоваровПоставщику
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВозвратТоваровПоставщику");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСПоставщиками");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ВозвратТоваровПоставщику", ТаблицыДокумента);

	// ВыбытиеАрендованныхОС
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВыбытиеАрендованныхОС");
	ТаблицыТиповДокументов.Вставить("ВыбытиеАрендованныхОС", ТаблицыДокумента);

	// ВыбытиеДенежныхДокументов
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВыбытиеДенежныхДокументов");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСПоставщиками");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ВыбытиеДенежныхДокументов", ТаблицыДокумента);

	// ВыкупВозвратнойТарыКлиентом
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВыкупВозвратнойТарыКлиентом");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ВыкупВозвратнойТарыКлиентом", ТаблицыДокумента);

	// ВыкупВозвратнойТарыУПоставщика
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВыкупВозвратнойТарыУПоставщика");
	//++ НЕ УТКА

	//++ Устарело_Переработка24
	ТаблицыДокумента.Добавить("Документ.ВозвратСырьяДавальцу");
	//-- Устарело_Переработка24

	//-- НЕ УТКА
	ТаблицыТиповДокументов.Вставить("ВыкупВозвратнойТарыУПоставщика", ТаблицыДокумента);

	// ВыпускПродукции
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВыпускПродукции");
	ТаблицыТиповДокументов.Вставить("ВыпускПродукции", ТаблицыДокумента);

	// ДвижениеПродукцииИМатериалов
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ДвижениеПродукцииИМатериалов");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыТиповДокументов.Вставить("ДвижениеПродукцииИМатериалов", ТаблицыДокумента);

	// ДепонированиеЗарплаты
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ДепонированиеЗарплаты");
	ТаблицыТиповДокументов.Вставить("ДепонированиеЗарплаты", ТаблицыДокумента);

	// ЗаписьКнигиПокупок
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ЗаписьКнигиПокупок");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ЗаписьКнигиПокупок", ТаблицыДокумента);

	// ЗаписьКнигиПродаж
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ЗаписьКнигиПродаж");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ЗаписьКнигиПродаж", ТаблицыДокумента);

	// ЗаявлениеОВвозеТоваров
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ЗаявлениеОВвозеТоваров");
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСПредъявленный");
	ТаблицыТиповДокументов.Вставить("ЗаявлениеОВвозеТоваров", ТаблицыДокумента);

	// ИзменениеПараметровОС
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ИзменениеПараметровОС");
	ТаблицыТиповДокументов.Вставить("ИзменениеПараметровОС", ТаблицыДокумента);

	// ИзменениеПараметровНМА2_4
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ИзменениеПараметровНМА2_4");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияНМА");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьНМА");
	ТаблицыТиповДокументов.Вставить("ИзменениеПараметровНМА2_4", ТаблицыДокумента);
	
	// ИзменениеПараметровОС2_4
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ИзменениеПараметровОС2_4");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьОС");
	ТаблицыТиповДокументов.Вставить("ИзменениеПараметровОС2_4", ТаблицыДокумента);
	
	// ИнвентаризацияНаличныхДенежныхСредств
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ИнвентаризацияНаличныхДенежныхСредств");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ИнвентаризацияНаличныхДенежныхСредств", ТаблицыДокумента);

	// ИнойДокументПодтвержденияНДС
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСЗаписиКнигиПокупок");
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСЗаписиКнигиПродаж");
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСПредъявленный");
	ТаблицыТиповДокументов.Вставить("ИнойДокументПодтвержденияНДС", ТаблицыДокумента);
	
	// ИсправлениеРазвернутогоСальдоТоваровОрганизаций
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ИсправлениеРазвернутогоСальдоТоваровОрганизаций");
	ТаблицыДокумента.Добавить("РегистрНакопления.СебестоимостьТоваров");
	ТаблицыТиповДокументов.Вставить("ИсправлениеРазвернутогоСальдоТоваровОрганизаций", ТаблицыДокумента);
	
	// КорректировкаПриобретения
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ЗаказПоставщику");
	ТаблицыДокумента.Добавить("Документ.КорректировкаПриобретения");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСПоставщиками");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаПоПартнерам");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("КорректировкаПриобретения", ТаблицыДокумента);
	
	// КорректировкаРасчетовПоНалогам
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.КорректировкаРасчетовПоНалогам");
	ТаблицыТиповДокументов.Вставить("КорректировкаРасчетовПоНалогам", ТаблицыДокумента);

	// КорректировкаРеализации
	ТаблицыДокумента = Новый Массив;
	//++ НЕ УТКА
	ТаблицыДокумента.Добавить("Документ.ЗаказДавальца2_5");
	//-- НЕ УТКА
	ТаблицыДокумента.Добавить("Документ.ЗаказКлиента");
	ТаблицыДокумента.Добавить("Документ.ЗаявкаНаВозвратТоваровОтКлиента");
	ТаблицыДокумента.Добавить("Документ.КорректировкаРеализации");
	ТаблицыДокумента.Добавить("Документ.РеализацияТоваровУслуг");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСКлиентами");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаПоПартнерам");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("КорректировкаРеализации", ТаблицыДокумента);

	// МодернизацияОС
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.МодернизацияОС");
	ТаблицыТиповДокументов.Вставить("МодернизацияОС", ТаблицыДокумента);

	// МодернизацияОС2_4
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.МодернизацияОС2_4");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьОС");
	ТаблицыТиповДокументов.Вставить("МодернизацияОС2_4", ТаблицыДокумента);

	//++ НЕ УТКА

	// НачальныеОстаткиНЗППоПартиямПроизводства
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.НачальныеОстаткиНЗППоПартиямПроизводства");
	ТаблицыТиповДокументов.Вставить("НачальныеОстаткиНЗППоПартиямПроизводства", ТаблицыДокумента);
	//-- НЕ УТКА
	
	// НачислениеДивидендов
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.НачислениеДивидендов");
	ТаблицыТиповДокументов.Вставить("НачислениеДивидендов", ТаблицыДокумента);

	// НачислениеЕНП
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.НачислениеЕНП");
	ТаблицыТиповДокументов.Вставить("НачислениеЕНП", ТаблицыДокумента);

	// НачислениеОценочныхОбязательствПоОтпускам
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.НачислениеОценочныхОбязательствПоОтпускам");
	ТаблицыТиповДокументов.Вставить("НачислениеОценочныхОбязательствПоОтпускам", ТаблицыДокумента);

	// НачисленияКредитовИДепозитов
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.НачисленияКредитовИДепозитов");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("НачисленияКредитовИДепозитов", ТаблицыДокумента);
	
	// ОбесценениеВНА
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОбесценениеВНА");
	ТаблицыДокумента.Добавить("РегистрНакопления.ОбесценениеВНА");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПрочиеРасходы");
	ТаблицыТиповДокументов.Вставить("ОбесценениеВНА", ТаблицыДокумента);
	
	// ОперацияПоПлатежнойКарте
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОперацияПоПлатежнойКарте");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСКлиентами");
	ТаблицыТиповДокументов.Вставить("ОперацияПоПлатежнойКарте", ТаблицыДокумента);

	// ОприходованиеИзлишковТоваров
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОприходованиеИзлишковТоваров");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ОприходованиеИзлишковТоваров", ТаблицыДокумента);
	
	// ОприходованиеТМЦВЭксплуатации
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОприходованиеТМЦВЭксплуатации");
	ТаблицыТиповДокументов.Вставить("ОприходованиеТМЦВЭксплуатации", ТаблицыДокумента);

	// ОтражениеЗарплатыВФинансовомУчете
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОтражениеЗарплатыВФинансовомУчете");
	ТаблицыДокумента.Добавить("РегистрНакопления.ОтражениеЗарплатыВФинансовомУчете");
	ТаблицыТиповДокументов.Вставить("ОтражениеЗарплатыВФинансовомУчете", ТаблицыДокумента);

	// ОтражениеРасхожденийПриИнкассацииДенежныхСредств
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОтражениеРасхожденийПриИнкассацииДенежныхСредств");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ОтражениеРасхожденийПриИнкассацииДенежныхСредств", ТаблицыДокумента);

	// ОтчетБанкаПоОперациямЭквайринга
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОтчетБанкаПоОперациямЭквайринга");
	ТаблицыТиповДокументов.Вставить("ОтчетБанкаПоОперациямЭквайринга", ТаблицыДокумента);

	//++ НЕ УТКА
	
	//++ Устарело_Переработка24
	// ОтчетДавальцу
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОтчетДавальцу");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСКлиентами");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ОтчетДавальцу", ТаблицыДокумента);
	//-- Устарело_Переработка24
	
	// ОтчетДавальцу2_5
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОтчетДавальцу2_5");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСКлиентами");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ОтчетДавальцу2_5", ТаблицыДокумента);

	// ОтчетДавальцуМеждуОрганизациями
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОтчетДавальцуМеждуОрганизациями");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ОтчетДавальцуМеждуОрганизациями", ТаблицыДокумента);
	//-- НЕ УТКА

	// ОтчетКомиссионера
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОтчетКомиссионера");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСКлиентами");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ОтчетКомиссионера", ТаблицыДокумента);

	// ОтчетКомиссионераОСписании
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОтчетКомиссионераОСписании");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ОтчетКомиссионераОСписании", ТаблицыДокумента);

	// ОтчетКомитенту
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОтчетКомитенту");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСПоставщиками");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ОтчетКомитенту", ТаблицыДокумента);

	// ОтчетКомитентуОСписании
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОтчетКомитентуОСписании");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ОтчетКомитентуОСписании", ТаблицыДокумента);

	// ОтчетОператораСистемыПлатон
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОтчетОператораСистемыПлатон");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСПоставщиками");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ОтчетОператораСистемыПлатон", ТаблицыДокумента);

	// ОтчетОРозничныхПродажах
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОтчетОРозничныхПродажах");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ОтчетОРозничныхПродажах", ТаблицыДокумента);
	
	// ОтчетОРозничныхВозвратах
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОтчетОРозничныхВозвратах");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ОтчетОРозничныхВозвратах", ТаблицыДокумента);
	//++ Устарело_Переработка24
	
	// ОтчетПереработчика
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОтчетПереработчика");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСПоставщиками");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ОтчетПереработчика", ТаблицыДокумента);
	//-- Устарело_Переработка24
	
	// ОтчетПереработчика2_5
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОтчетПереработчика2_5");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСПоставщиками");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ОтчетПереработчика2_5", ТаблицыДокумента);

	// ОтчетПоКомиссииМеждуОрганизациями
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОтчетПоКомиссииМеждуОрганизациями");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСКлиентами");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСПоставщиками");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ОтчетПоКомиссииМеждуОрганизациями", ТаблицыДокумента);

	// ОтчетПоКомиссииМеждуОрганизациямиОСписании
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОтчетПоКомиссииМеждуОрганизациямиОСписании");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСКлиентами");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСПоставщиками");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ОтчетПоКомиссииМеждуОрганизациямиОСписании", ТаблицыДокумента);

	//++ НЕ УТКА
	
	//++ Устарело_Переработка24
	// ПередачаДавальцу
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПередачаДавальцу");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыТиповДокументов.Вставить("ПередачаДавальцу", ТаблицыДокумента);
	//-- Устарело_Переработка24
	
	//-- НЕ УТКА

	// ПередачаМатериаловВПроизводство
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПередачаМатериаловВПроизводство");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыТиповДокументов.Вставить("ПередачаМатериаловВПроизводство", ТаблицыДокумента);

	// ПередачаОСВАренду
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПередачаОСВАренду");
	ТаблицыТиповДокументов.Вставить("ПередачаОСВАренду", ТаблицыДокумента);

	// ПередачаОСВАренду2_4
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПередачаОСВАренду2_4");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПрочиеДоходы");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПрочиеРасходы");
	ТаблицыДокумента.Добавить("РегистрНакопления.ИнвестицииВАренду");
	ТаблицыТиповДокументов.Вставить("ПередачаОСВАренду2_4", ТаблицыДокумента);
	//++ Устарело_Переработка24
	
	// ПередачаСырьяПереработчику
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПередачаСырьяПереработчику");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыДокумента.Добавить("РегистрСведений.СтоимостьТоваров");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ПередачаСырьяПереработчику", ТаблицыДокумента);
	//-- Устарело_Переработка24
	
	// ПередачаТоваровМеждуОрганизациями
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПередачаТоваровМеждуОрганизациями");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ПередачаТоваровМеждуОрганизациями", ТаблицыДокумента);

	// ПеремещениеВЭксплуатации
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПеремещениеВЭксплуатации");
	ТаблицыТиповДокументов.Вставить("ПеремещениеВЭксплуатации", ТаблицыДокумента);

	// ПеремещениеМатериаловВПроизводстве
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПеремещениеМатериаловВПроизводстве");
	ТаблицыТиповДокументов.Вставить("ПеремещениеМатериаловВПроизводстве", ТаблицыДокумента);

	// ПеремещениеТоваров
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПеремещениеТоваров");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыТиповДокументов.Вставить("ПеремещениеТоваров", ТаблицыДокумента);

	// РасчетКурсовыхРазниц
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.РасчетКурсовыхРазниц");
	ТаблицыДокумента.Добавить("РегистрНакопления.ДенежныеДокументы");
	ТаблицыДокумента.Добавить("РегистрНакопления.ДенежныеСредстваБезналичные");
	ТаблицыДокумента.Добавить("РегистрНакопления.ДенежныеСредстваВПути");
	ТаблицыДокумента.Добавить("РегистрНакопления.ДенежныеСредстваНаличные");
	ТаблицыДокумента.Добавить("РегистрНакопления.ДенежныеСредстваУПодотчетныхЛиц");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыПоФинансовымИнструментам");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСКлиентамиПоДокументам");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСПоставщикамиПоДокументам");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСКлиентамиПоСрокам");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСПоставщикамиПоСрокам");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПроцентныеРасходыДисконтирования");
	ТаблицыТиповДокументов.Вставить("РасчетКурсовыхРазниц", ТаблицыДокумента);

	// РасчетПроцентныхРасходовДисконтирования
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.РасчетПроцентныхРасходовДисконтирования");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПроцентныеРасходыДисконтирования");
	ТаблицыТиповДокументов.Вставить("РасчетПроцентныхРасходовДисконтирования", ТаблицыДокумента);

	// ПересортицаТоваров
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПересортицаТоваров");
	ТаблицыДокумента.Добавить("РегистрНакопления.СебестоимостьТоваров");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыТиповДокументов.Вставить("ПересортицаТоваров", ТаблицыДокумента);
	
	// ПересортицаТоваровУХранителя
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПересортицаТоваровУХранителя");
	ТаблицыДокумента.Добавить("РегистрНакопления.СебестоимостьТоваров");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыТиповДокументов.Вставить("ПересортицаТоваровУХранителя", ТаблицыДокумента);

	// ПогашениеСтоимостиТМЦВЭксплуатации
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПогашениеСтоимостиТМЦВЭксплуатации");
	ТаблицыТиповДокументов.Вставить("ПогашениеСтоимостиТМЦВЭксплуатации", ТаблицыДокумента);
	
	// ПодтверждениеЗачисленияЗарплаты
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПодтверждениеЗачисленияЗарплаты");
	ТаблицыТиповДокументов.Вставить("ПодтверждениеЗачисленияЗарплаты", ТаблицыДокумента);

	// ПорчаТоваров
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПорчаТоваров");
	ТаблицыДокумента.Добавить("РегистрНакопления.СебестоимостьТоваров");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыТиповДокументов.Вставить("ПорчаТоваров", ТаблицыДокумента);

	// ПорчаТоваровУХранителя
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПорчаТоваровУХранителя");
	ТаблицыДокумента.Добавить("РегистрНакопления.СебестоимостьТоваров");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыТиповДокументов.Вставить("ПорчаТоваровУХранителя", ТаблицыДокумента);

	// ПоступлениеАрендованныхОС
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПоступлениеАрендованныхОС");
	ТаблицыТиповДокументов.Вставить("ПоступлениеАрендованныхОС", ТаблицыДокумента);

	// ПоступлениеБезналичныхДенежныхСредств
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПоступлениеБезналичныхДенежныхСредств");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПрочиеДоходы");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПрочиеРасходы");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСКлиентами");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ПоступлениеБезналичныхДенежныхСредств", ТаблицыДокумента);

	// ПоступлениеДенежныхДокументов
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПоступлениеДенежныхДокументов");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСПоставщиками");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ПоступлениеДенежныхДокументов", ТаблицыДокумента);
	//++ Устарело_Переработка24
	
	// ПоступлениеОтПереработчика
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПоступлениеОтПереработчика");
	ТаблицыТиповДокументов.Вставить("ПоступлениеОтПереработчика", ТаблицыДокумента);
	//-- Устарело_Переработка24
	
	// ЗаключениеДоговораАренды
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ЗаключениеДоговораАренды");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ЗаключениеДоговораАренды", ТаблицыДокумента);

	//++ НЕ УТКА
	
	//++ Устарело_Переработка24
	// ПоступлениеСырьяОтДавальца
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПоступлениеСырьяОтДавальца");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ПоступлениеСырьяОтДавальца", ТаблицыДокумента);
	//-- Устарело_Переработка24
	
	//-- НЕ УТКА

	// ПоступлениеТоваровНаСклад
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПоступлениеТоваровНаСклад");
	ТаблицыДокумента.Добавить("РегистрНакопления.СебестоимостьТоваров");
	ТаблицыТиповДокументов.Вставить("ПоступлениеТоваровНаСклад", ТаблицыДокумента);

	// ПриобретениеТоваровУслуг
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПриобретениеТоваровУслуг");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСПоставщиками");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ПриобретениеТоваровУслуг", ТаблицыДокумента);

	// ПоступлениеУслугПоАренде
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПоступлениеУслугПоАренде");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ПоступлениеУслугПоАренде", ТаблицыДокумента);

	// ПриобретениеУслугПрочихАктивов
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПриобретениеУслугПрочихАктивов");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСПоставщиками");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ПриобретениеУслугПрочихАктивов", ТаблицыДокумента);

	// ПринятиеКУчетуНМА
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПринятиеКУчетуНМА");
	ТаблицыТиповДокументов.Вставить("ПринятиеКУчетуНМА", ТаблицыДокумента);

	// ПринятиеКУчетуНМА2_4
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПринятиеКУчетуНМА2_4");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьНМА");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияНМА");
	ТаблицыТиповДокументов.Вставить("ПринятиеКУчетуНМА2_4", ТаблицыДокумента);

	// ПринятиеКУчетуОС
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПринятиеКУчетуОС");
	ТаблицыТиповДокументов.Вставить("ПринятиеКУчетуОС", ТаблицыДокумента);

	// ПринятиеКУчетуОС2_4
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПринятиеКУчетуОС2_4");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияОС");
	ТаблицыТиповДокументов.Вставить("ПринятиеКУчетуОС2_4", ТаблицыДокумента);

	// ПринятиеКУчетуУзловКомпонентовАмортизации
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПринятиеКУчетуУзловКомпонентовАмортизации");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияОС");
	ТаблицыТиповДокументов.Вставить("ПринятиеКУчетуУзловКомпонентовАмортизации", ТаблицыДокумента);

	// РазукомплектацияОС
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.РазукомплектацияОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияОС");
	ТаблицыТиповДокументов.Вставить("РазукомплектацияОС", ТаблицыДокумента);

	// ОбъединениеОС
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОбъединениеОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияОС");
	ТаблицыТиповДокументов.Вставить("ОбъединениеОС", ТаблицыДокумента);

	// КорректировкаСтоимостиИАмортизацииОС
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.КорректировкаСтоимостиИАмортизацииОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияОС");
	ТаблицыТиповДокументов.Вставить("КорректировкаСтоимостиИАмортизацииОС", ТаблицыДокумента);

	// КорректировкаСтоимостиИАмортизацииНМА
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.КорректировкаСтоимостиИАмортизацииНМА");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьНМА");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияНМА");
	ТаблицыТиповДокументов.Вставить("КорректировкаСтоимостиИАмортизацииНМА", ТаблицыДокумента);

	// ПриходныйКассовыйОрдер
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПриходныйКассовыйОрдер");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПрочиеДоходы");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПрочиеРасходы");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСКлиентами");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ПриходныйКассовыйОрдер", ТаблицыДокумента);

	// ПрочееОприходованиеТоваров
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПрочееОприходованиеТоваров");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ПрочееОприходованиеТоваров", ТаблицыДокумента);

	// ПрочиеДоходыРасходы
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПрочиеДоходыРасходы");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ПрочиеДоходыРасходы", ТаблицыДокумента);
	
	// РаспределениеДоходовПоНаправлениямДеятельности
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.РаспределениеДоходовПоНаправлениямДеятельности");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПрочиеРасходы");
	ТаблицыДокумента.Добавить("РегистрСведений.ПорядокОтраженияНаСчетахУчета");
	ТаблицыТиповДокументов.Вставить("РаспределениеДоходовПоНаправлениямДеятельности", ТаблицыДокумента);

	// РаспределениеНДС
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПринятиеКУчетуНМА");
	ТаблицыДокумента.Добавить("Документ.ПринятиеКУчетуОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСЗаписиКнигиПокупок");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПартииНДСКРаспределению");
	ТаблицыТиповДокументов.Вставить("РаспределениеНДС", ТаблицыДокумента);

	// РаспределениеПроизводственныхЗатрат
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.РаспределениеПроизводственныхЗатрат");
	ТаблицыТиповДокументов.Вставить("РаспределениеПроизводственныхЗатрат", ТаблицыДокумента);

	// РаспределениеПрочихЗатрат
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.РаспределениеПрочихЗатрат");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПрочиеРасходы");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПрочиеРасходыНезавершенногоПроизводства");
	ТаблицыТиповДокументов.Вставить("РаспределениеПрочихЗатрат", ТаблицыДокумента);

	// РаспределениеРасходовБудущихПериодов
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.РаспределениеРасходовБудущихПериодов");
	ТаблицыТиповДокументов.Вставить("РаспределениеРасходовБудущихПериодов", ТаблицыДокумента);

	// РасходныйКассовыйОрдер
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.РасходныйКассовыйОрдер");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСПоставщиками");
	ТаблицыДокумента.Добавить("РегистрСведений.ОплатаВедомостейНаВыплатуЗарплаты");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("РасходныйКассовыйОрдер", ТаблицыДокумента);

	// РасчетСебестоимостиТоваров
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.РасчетСебестоимостиТоваров");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПрочиеРасходы");
	ТаблицыДокумента.Добавить("РегистрНакопления.СебестоимостьТоваров");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыТиповДокументов.Вставить("РасчетСебестоимостиТоваров", ТаблицыДокумента);

	// РеализацияПодарочныхСертификатов
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.РеализацияПодарочныхСертификатов");
	ТаблицыДокумента.Добавить("РегистрНакопления.ДвиженияДенежныеСредстваКонтрагент");
	ТаблицыТиповДокументов.Вставить("РеализацияПодарочныхСертификатов", ТаблицыДокумента);

	// РеализацияТоваровУслуг
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.РеализацияТоваровУслуг");
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСЗаписиКнигиПродаж");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСКлиентами");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("РеализацияТоваровУслуг", ТаблицыДокумента);

	// РеализацияУслугПрочихАктивов
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.РеализацияУслугПрочихАктивов");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСКлиентами");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("РеализацияУслугПрочихАктивов", ТаблицыДокумента);

	// РегламентнаяОперация
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.РегламентнаяОперация");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПрочиеРасходы");
	ТаблицыДокумента.Добавить("РегистрСведений.ПорядокОтраженияНаСчетахУчета");
	ТаблицыТиповДокументов.Вставить("РегламентнаяОперация", ТаблицыДокумента);

	// РезервыПоОплатеТруда
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.РезервыПоОплатеТруда");
	ТаблицыТиповДокументов.Вставить("РезервыПоОплатеТруда", ТаблицыДокумента);

	// СборкаТоваров
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.СборкаТоваров");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыТиповДокументов.Вставить("СборкаТоваров", ТаблицыДокумента);

	// СписаниеБезналичныхДенежныхСредств
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.СписаниеБезналичныхДенежныхСредств");
	ТаблицыДокумента.Добавить("РегистрНакопления.ДенежныеСредстваБезналичные");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСПоставщиками");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("СписаниеБезналичныхДенежныхСредств", ТаблицыДокумента);

	// СписаниеЗадолженности
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.КорректировкаЗадолженности");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("КорректировкаЗадолженности", ТаблицыДокумента);

	// СписаниеИзЭксплуатации
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.СписаниеИзЭксплуатации");
	ТаблицыТиповДокументов.Вставить("СписаниеИзЭксплуатации", ТаблицыДокумента);

	// СписаниеНедостачТоваров
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.СписаниеНедостачТоваров");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыТиповДокументов.Вставить("СписаниеНедостачТоваров", ТаблицыДокумента);

	// СписаниеНМА
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.СписаниеНМА");
	ТаблицыТиповДокументов.Вставить("СписаниеНМА", ТаблицыДокумента);

	// СписаниеНМА2_4
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.СписаниеНМА2_4");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьНМА");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияНМА");
	ТаблицыТиповДокументов.Вставить("СписаниеНМА2_4", ТаблицыДокумента);

	// УлучшениеНМА
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.УлучшениеНМА");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьНМА");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияНМА");
	ТаблицыТиповДокументов.Вставить("УлучшениеНМА", ТаблицыДокумента);

	// СписаниеОС
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.СписаниеОС");
	ТаблицыТиповДокументов.Вставить("СписаниеОС", ТаблицыДокумента);

	// СписаниеОС2_4
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.СписаниеОС2_4");
	ТаблицыДокумента.Добавить("РегистрНакопления.СтоимостьОС");
	ТаблицыДокумента.Добавить("РегистрНакопления.АмортизацияОС");
	ТаблицыТиповДокументов.Вставить("СписаниеОС2_4", ТаблицыДокумента);

	// СчетФактураВыданный
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.СчетФактураВыданный");
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСЗаписиКнигиПокупок");
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСПредъявленный");
	ТаблицыТиповДокументов.Вставить("СчетФактураВыданный", ТаблицыДокумента);

	// СчетФактураВыданныйАванс
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.СчетФактураВыданныйАванс");
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСЗаписиКнигиПокупок");
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСЗаписиКнигиПродаж");
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСПредъявленный");
	ТаблицыТиповДокументов.Вставить("СчетФактураВыданныйАванс", ТаблицыДокумента);

	// СчетФактураНалоговыйАгент
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.СчетФактураНалоговыйАгент");
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСЗаписиКнигиПокупок");
	ТаблицыДокумента.Добавить("РегистрНакопления.СебестоимостьТоваров");
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСПредъявленный");
	ТаблицыТиповДокументов.Вставить("СчетФактураНалоговыйАгент", ТаблицыДокумента);

	// СчетФактураНаНеподтвержденнуюРеализацию0
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСЗаписиКнигиПродаж");
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСПредъявленный");
	ТаблицыТиповДокументов.Вставить("СчетФактураНаНеподтвержденнуюРеализацию0", ТаблицыДокумента);

	// СчетФактураПолученный
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСЗаписиКнигиПокупок");
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСЗаписиКнигиПродаж");
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСПредъявленный");
	ТаблицыТиповДокументов.Вставить("СчетФактураПолученный", ТаблицыДокумента);
	
	// СчетФактураПолученныйНалоговыйАгент
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСЗаписиКнигиПокупок");
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСЗаписиКнигиПродаж");
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСПредъявленный");
	ТаблицыТиповДокументов.Вставить("СчетФактураПолученныйНалоговыйАгент", ТаблицыДокумента);
	
	// СписаниеНДСНаРасходы
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.СписаниеНДСНаРасходы");
	ТаблицыТиповДокументов.Вставить("СписаниеНДСНаРасходы", ТаблицыДокумента);
	
	// СчетФактураПолученныйАванс
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.СчетФактураПолученныйАванс");
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСЗаписиКнигиПокупок");
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСЗаписиКнигиПродаж");
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСПредъявленный");
	ТаблицыТиповДокументов.Вставить("СчетФактураПолученныйАванс", ТаблицыДокумента);

	// ТаможеннаяДекларацияИмпорт
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ТаможеннаяДекларацияИмпорт");
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСПредъявленный");
	ТаблицыТиповДокументов.Вставить("ТаможеннаяДекларацияИмпорт", ТаблицыДокумента);
	
	// КорректировкаНазначенияТоваров
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.КорректировкаНазначенияТоваров");
	ТаблицыДокумента.Добавить("РегистрНакопления.СебестоимостьТоваров");
	ТаблицыТиповДокументов.Вставить("КорректировкаНазначенияТоваров", ТаблицыДокумента);
	
	// КорректировкаВидаДеятельностиНДС
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.КорректировкаВидаДеятельностиНДС");
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСПредъявленный");
	ТаблицыТиповДокументов.Вставить("КорректировкаВидаДеятельностиНДС", ТаблицыДокумента);
	
	// КорректировкаНазначенияТоваров
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.КорректировкаНазначенияТоваров");
	ТаблицыТиповДокументов.Вставить("КорректировкаНазначенияТоваров", ТаблицыДокумента);
	
	//++ НЕ УТКА

	// ЭтапПроизводства2_2
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ЭтапПроизводства2_2");
	ТаблицыТиповДокументов.Вставить("ЭтапПроизводства2_2", ТаблицыДокумента);
	//-- НЕ УТКА
	
	// ПроизводствоБезЗаказа
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПроизводствоБезЗаказа");
	ТаблицыТиповДокументов.Вставить("ПроизводствоБезЗаказа", ТаблицыДокумента);
	
	// ОперацииПоЯндексКассе
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОперацияПоЯндексКассе");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСКлиентами");
	ТаблицыТиповДокументов.Вставить("ОперацияПоЯндексКассе", ТаблицыДокумента);

	// МаркировкаТоваровГИСМ
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.МаркировкаТоваровГИСМ");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыТиповДокументов.Вставить("МаркировкаТоваровГИСМ", ТаблицыДокумента);

	// ПеремаркировкаТоваровГИСМ
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПеремаркировкаТоваровГИСМ");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыТиповДокументов.Вставить("ПеремаркировкаТоваровГИСМ", ТаблицыДокумента);
	
	// ВнесениеДенежныхСредствВКассуККМ
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВнесениеДенежныхСредствВКассуККМ");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ВнесениеДенежныхСредствВКассуККМ", ТаблицыДокумента);
	
	// ВыемкаДенежныхСредствИзКассыККМ
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВыемкаДенежныхСредствИзКассыККМ");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ВыемкаДенежныхСредствИзКассыККМ", ТаблицыДокумента);
	
	// ОперацияПоЯндексКассе
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОперацияПоЯндексКассе");
	ТаблицыДокумента.Добавить("РегистрСведений.ОтносительныеКурсыВалют");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСКлиентами");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСКлиентамиПоДокументам");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ОперацияПоЯндексКассе", ТаблицыДокумента);
	
	// РегистраторРасчетов
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.РегистраторРасчетов");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСКлиентамиПоСрокам");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСПоставщикамиПоСрокам");
	ТаблицыТиповДокументов.Вставить("РегистраторРасчетов", ТаблицыДокумента);
	
	// ПриемкаТоваровНаХранение
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПриемкаТоваровНаХранение");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ПриемкаТоваровНаХранение", ТаблицыДокумента);
	
	// ВыкупПринятыхНаХранениеТоваров
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВыкупПринятыхНаХранениеТоваров");
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСПредъявленный");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСПоставщиками");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ВыкупПринятыхНаХранениеТоваров", ТаблицыДокумента);

	// ОтчетОСписанииТоваровСХранения
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОтчетОСписанииТоваровСХранения");
	ТаблицыТиповДокументов.Вставить("ОтчетОСписанииТоваровСХранения", ТаблицыДокумента);
	
	// ОтгрузкаТоваровСХранения
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОтгрузкаТоваровСХранения");
	ТаблицыДокумента.Добавить("РегистрНакопления.СебестоимостьТоваров");
	ТаблицыТиповДокументов.Вставить("ОтгрузкаТоваровСХранения", ТаблицыДокумента);
	
	//++ НЕ УТ

	// НачислениеСписаниеРезервовПредстоящихРасходов
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.НачислениеСписаниеРезервовПредстоящихРасходов");
	ТаблицыДокумента.Добавить("РегистрНакопления.РезервыПредстоящихРасходов");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПрочиеРасходы");
	ТаблицыТиповДокументов.Вставить("НачислениеСписаниеРезервовПредстоящихРасходов", ТаблицыДокумента);
	
	// НачислениеСписаниеРезервовПоСомнительнымДолгам
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.НачислениеСписаниеРезервовПоСомнительнымДолгам");
	ТаблицыДокумента.Добавить("РегистрНакопления.РезервыПоСомнительнымДолгам");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПрочиеРасходы");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПрочиеДоходы");
	ТаблицыТиповДокументов.Вставить("НачислениеСписаниеРезервовПоСомнительнымДолгам", ТаблицыДокумента);
	//-- НЕ УТ
	
	// ПередачаТоваровХранителю
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПередачаТоваровХранителю");
	ТаблицыДокумента.Добавить("РегистрНакопления.СебестоимостьТоваров");
	ТаблицыТиповДокументов.Вставить("ПередачаТоваровХранителю", ТаблицыДокумента);
	
	// ПоступлениеТоваровОтХранителя
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПоступлениеТоваровОтХранителя");
	ТаблицыДокумента.Добавить("РегистрНакопления.СебестоимостьТоваров");
	ТаблицыТиповДокументов.Вставить("ПоступлениеТоваровОтХранителя", ТаблицыДокумента);
	
	// ВыкупТоваровХранителем
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВыкупТоваровХранителем");
	ТаблицыДокумента.Добавить("РегистрНакопления.СебестоимостьТоваров");
	ТаблицыДокумента.Добавить("РегистрНакопления.НДСЗаписиКнигиПродаж");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСКлиентами");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ВыкупТоваровХранителем", ТаблицыДокумента);
	
	// ОтчетОСписанииТоваровУХранителя
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОтчетОСписанииТоваровУХранителя");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыТиповДокументов.Вставить("ОтчетОСписанииТоваровУХранителя", ТаблицыДокумента);
	
	// ОприходованиеИзлишковТоваровУХранителя
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОприходованиеИзлишковТоваровУХранителя");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСКлиентами");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыТиповДокументов.Вставить("ОприходованиеИзлишковТоваровУХранителя", ТаблицыДокумента);
	
	//++ НЕ УТ	
	// РаспределениеВозвратныхОтходов
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.РаспределениеВозвратныхОтходов");
	ТаблицыДокумента.Добавить("РегистрНакопления.СебестоимостьТоваров");
	ТаблицыТиповДокументов.Вставить("РаспределениеВозвратныхОтходов", ТаблицыДокумента);
	//-- НЕ УТ
	
	// КорректировкаЗадолженностиПоФинансовымИнструментам
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.КорректировкаЗадолженностиПоФинансовымИнструментам");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыПоФинансовымИнструментам");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаПоПартнерам");
	ТаблицыДокумента.Добавить("ПланВидовХарактеристик.СтатьиРасходов");
	ТаблицыДокумента.Добавить("Справочник.ОбъектыСтроительства");
	ТаблицыТиповДокументов.Вставить("КорректировкаЗадолженностиПоФинансовымИнструментам", ТаблицыДокумента);

	// ВводОстатковВзаиморасчетов
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВводОстатковВзаиморасчетов");
	ТаблицыТиповДокументов.Вставить("ВводОстатковВзаиморасчетов", ТаблицыДокумента);
	
	// ВводОстатковДенежныхСредств
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВводОстатковДенежныхСредств");
	ТаблицыТиповДокументов.Вставить("ВводОстатковДенежныхСредств", ТаблицыДокумента);
	
	// ВводОстатковНДСПредъявленного
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВводОстатковНДСПредъявленного");
	ТаблицыТиповДокументов.Вставить("ВводОстатковНДСПредъявленного", ТаблицыДокумента);

	// ВводОстатковОПродажахЗаПрошлыеПериоды
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВводОстатковОПродажахЗаПрошлыеПериоды");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыТиповДокументов.Вставить("ВводОстатковОПродажахЗаПрошлыеПериоды", ТаблицыДокумента);

	// ВводОстатковПоФинансовымИнструментам
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВводОстатковПоФинансовымИнструментам");
	ТаблицыТиповДокументов.Вставить("ВводОстатковПоФинансовымИнструментам", ТаблицыДокумента);

	// ВводОстатковПрочиеРасходы
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВводОстатковПрочиеРасходы");
	ТаблицыТиповДокументов.Вставить("ВводОстатковПрочиеРасходы", ТаблицыДокумента);

	// ВводОстатковПрочихАктивовПассивов
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВводОстатковПрочихАктивовПассивов");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыТиповДокументов.Вставить("ВводОстатковПрочихАктивовПассивов", ТаблицыДокумента);

	//++ НЕ УТ

	// ВводОстатковРасходовПриУСН
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВводОстатковРасходовПриУСН");
	ТаблицыТиповДокументов.Вставить("ВводОстатковРасходовПриУСН", ТаблицыДокумента);
	//-- НЕ УТ
	
	// ВводОстатковРасчетовПоЭквайрингу
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВводОстатковРасчетовПоЭквайрингу");
	ТаблицыТиповДокументов.Вставить("ВводОстатковРасчетовПоЭквайрингу", ТаблицыДокумента);

	// ВводОстатковСПодотчетниками
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВводОстатковСПодотчетниками");
	ТаблицыТиповДокументов.Вставить("ВводОстатковСПодотчетниками", ТаблицыДокумента);

	// ВводОстатковТМЦВЭксплуатации
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВводОстатковТМЦВЭксплуатации");
	ТаблицыТиповДокументов.Вставить("ВводОстатковТМЦВЭксплуатации", ТаблицыДокумента);

	// ВводОстатковТоваров
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ВводОстатковТоваров");
	ТаблицыДокумента.Добавить("РегистрСведений.АналитикаУчетаНоменклатуры");
	ТаблицыТиповДокументов.Вставить("ВводОстатковТоваров", ТаблицыДокумента);
	
	// ОтчетКомитентуОЗакупках
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ОтчетКомитентуОЗакупках");
	ТаблицыДокумента.Добавить("РегистрСведений.СуммыДокументовВВалютахУчета");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСКлиентами");
	ТаблицыДокумента.Добавить("Справочник.Назначения");
	ТаблицыТиповДокументов.Вставить("ОтчетКомитентуОЗакупках", ТаблицыДокумента);
	
	//++ НЕ УТ

	// ПризнаниеРасходовПоИсследованиямИРазработкам
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПризнаниеРасходовПоИсследованиямИРазработкам");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПрочиеРасходы");
	ТаблицыТиповДокументов.Вставить("ПризнаниеРасходовПоИсследованиямИРазработкам", ТаблицыДокумента);
	//-- НЕ УТ
	
	// Сторно
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.Сторно");
	ТаблицыТиповДокументов.Вставить("Сторно", ТаблицыДокумента);
	
	// Бронирование
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.Бронирование");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСПоставщиками");
	ТаблицыДокумента.Добавить("РегистрНакопления.РасчетыСПоставщикамиПоСрокам");
	ТаблицыТиповДокументов.Вставить("Бронирование", ТаблицыДокумента);
	
	// РасчетРезервовПодОбесценениеЗапасов
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.РасчетРезервовПодОбесценениеЗапасов");
	ТаблицыДокумента.Добавить("РегистрНакопления.СебестоимостьТоваров");
	ТаблицыТиповДокументов.Вставить("РасчетРезервовПодОбесценениеЗапасов", ТаблицыДокумента);
	
	// ПерерасчетИмущественныхНалогов
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПерерасчетИмущественныхНалогов");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПрочиеРасходы");
	ТаблицыДокумента.Добавить("РегистрСведений.ПорядокОтраженияНаСчетахУчета");
	ТаблицыТиповДокументов.Вставить("ПерерасчетИмущественныхНалогов", ТаблицыДокумента);
	
	// ПоступлениеУслугВПодразделение
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.ПоступлениеУслугВПодразделение");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПрочиеРасходы");
	ТаблицыДокумента.Добавить("РегистрНакопления.СебестоимостьТоваров");
	ТаблицыТиповДокументов.Вставить("ПоступлениеУслугВПодразделение", ТаблицыДокумента);
	
	// СписаниеРасхожденийПоступлениеПриобретение
	ТаблицыДокумента = Новый Массив;
	ТаблицыДокумента.Добавить("Документ.СписаниеРасхожденийПоступлениеПриобретение");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПрочиеРасходы");
	ТаблицыДокумента.Добавить("РегистрНакопления.ПрочиеДоходы");
	ТаблицыДокумента.Добавить("РегистрНакопления.ДвиженияПоПрочимАктивамПассивам");
	ТаблицыДокумента.Добавить("РегистрНакопления.СебестоимостьТоваров");
	
	ТаблицыТиповДокументов.Вставить("СписаниеРасхожденийПоступлениеПриобретение", ТаблицыДокумента);

	МассивТипов = ТаблицыТиповДокументов[ИмяТипаДокумента];
	
	Если РеглУчетВыборкиСерверПовтИсп.ЭтоРасчетныйДокумент(ИмяТипаДокумента) Тогда
		Если ПолучитьФункциональнуюОпцию("НоваяАрхитектураВзаиморасчетов") Тогда
			МассивТипов.Добавить("РегистрНакопления.РасчетыСКлиентамиПоСрокам");
			МассивТипов.Добавить("РегистрНакопления.РасчетыСПоставщикамиПоСрокам");
		Иначе
			МассивТипов.Добавить("РегистрНакопления.РасчетыСКлиентамиПоДокументам");
			МассивТипов.Добавить("РегистрНакопления.РасчетыСПоставщикамиПоДокументам");
		КонецЕсли;
	КонецЕсли;
	
	Возврат МассивТипов;

КонецФункции

// Возвращает параметры расчета в суммы валюте управленческой финансовой отчетности
//
// Параметры:
// 	Период - Дата - Период операции.
// 	Организация - СправочникСсылка.Организации - Организация проводки
// 	
// Возвращаемое значение:
// 	Неопределено, Структура  - Ключи:
// 						* РесурсИсточник - Строка - Имя ресурса бухгалтерии, который является источником
// 						* Коэффициент - Число - Коэффициент пересчета.
//
Функция ПараметрыРасчетаСуммыФО(Период, Организация) Экспорт
	
	УчетВВалютеФО = ПолучитьФункциональнуюОпцию("ВестиУчетНаПланеСчетовХозрасчетныйВВалютеФинОтчетности");
	Если Не УчетВВалютеФО Тогда
		Возврат Неопределено;
	КонецЕсли;
	
	ВалютаРегламентированногоУчета = ЗначениеНастроекПовтИсп.ВалютаРегламентированногоУчетаОрганизации(Организация);
	
	ИсточникСуммыДляПересчета = Константы.ИсточникСуммыДляПересчетаВВалютуФинОтчетности.Получить();
	Если Не ЗначениеЗаполнено(ИсточникСуммыДляПересчета) Тогда
		ИсточникСуммыДляПересчета = Перечисления.ИсточникиСуммыДляПересчетаВВалютуФинОтчетности.БУ;
	КонецЕсли;
	ВалютаФинОтчетности = Константы.ВалютаФинОтчетности.Получить();
	Если ИсточникСуммыДляПересчета = Перечисления.ИсточникиСуммыДляПересчетаВВалютуФинОтчетности.БУ Тогда
		ВалютаИсточника = ВалютаРегламентированногоУчета;
		РесурсИсточник = "Сумма";
	Иначе
		ВалютаИсточника = Константы.ВалютаУправленческогоУчета.Получить();
		РесурсИсточник = "СуммаУУ";
	КонецЕсли;
	
	КоэффициентПересчета = РаботаСКурсамиВалютУТ.ПолучитьКоэффициентПересчетаИзВалютыВВалюту(
		ВалютаИсточника, ВалютаФинОтчетности, Период, ВалютаРегламентированногоУчета);
	
	Результат = Новый Структура;
	Результат.Вставить("РесурсИсточник", РесурсИсточник);
	Результат.Вставить("Коэффициент",    КоэффициентПересчета);
	
	Возврат Результат;
	
КонецФункции

// Возвращает параметры расчета в суммы УУ
//
// Параметры:
// 	Период - Дата - Период операции.
// 	Организация - СправочникСсылка.Организации - Организация
// 	
// Возвращаемое значение:
// 	Неопределено, Структура - Ключ:
// 						* РесурсИсточник - Строка - Имя ресурса бухгалтерии, который является источником
// 						* Коэффициент - Число - Коэффициент пересчета.
//
Функция ПараметрыРасчетаСуммыУУ(Период, Организация) Экспорт
	
	ВестиУУ = ПолучитьФункциональнуюОпцию("ВестиУУНаПланеСчетовХозрасчетный");
	Если Не ВестиУУ Тогда
		Возврат Неопределено;
	КонецЕсли;
	
	ВалютаУправленческогоУчета = Константы.ВалютаУправленческогоУчета.Получить();
	ВалютаРегламентированногоУчета = ЗначениеНастроекПовтИсп.ВалютаРегламентированногоУчетаОрганизации(Организация);
	
	КоэффициентПересчета = РаботаСКурсамиВалютУТ.ПолучитьКоэффициентПересчетаИзВалютыВВалюту(
		ВалютаРегламентированногоУчета, 
		ВалютаУправленческогоУчета, 
		Период,
		ВалютаРегламентированногоУчета);
	Результат = Новый Структура;
	Результат.Вставить("РесурсИсточник", "Сумма");
	Результат.Вставить("Коэффициент",   КоэффициентПересчета);
	
	Возврат Результат;
	
КонецФункции

// Возвращает параметры, используемые при выполнении запроса отражения документов в регл. учете,
//	как правило, это установка констант. Заполняются так же параметры, используемые в запросах
//	"ЗапросХозрасчетный" и "ЗапросСопоставлений" - для совместимости с внешними обработками.
//
// Параметры:
// 	ДетализацияПроводок - Булево - признак доп. детализации проводок по Кт 20 счета до типов затрат и номенклатуры.
// 		Значение по умолчанию: Ложь.
//	
//	Возвращаемое значение:
//		Структура - содержит параметры, необходимые при выполнении запроса отражения документов в регл. учете.
//
Функция ПараметрыОтраженияРеглУчетаПоУмолчанию(ДетализацияПроводок = Ложь) Экспорт
	
	НастройкиУчетаНДС = УчетНДСУП.НастройкиУчета();
	
	СтруктураПараметров = Новый Структура;
	СтруктураПараметров.Вставить("ДатаНачалаДействия150ФЗ", НастройкиУчетаНДС.ДатаРазделенияЭкспорта);
	СтруктураПараметров.Вставить("ВалютаУпрУчета",          Константы.ВалютаУправленческогоУчета.Получить());
	СтруктураПараметров.Вставить("ВалютаФинОтчетности",     Константы.ВалютаФинОтчетности.Получить());
	СтруктураПараметров.Вставить("ВалютаРеглУчета",         Константы.ВалютаРегламентированногоУчета.Получить());
	СтруктураПараметров.Вставить("ДатаПереходаНаПартионныйУчетВерсии22", Константы.ДатаПереходаНаПартионныйУчетВерсии22.Получить());
	СтруктураПараметров.Вставить("ИспользоватьВнеоборотныеАктивы2_2", Константы.ИспользоватьВнеоборотныеАктивы2_2.Получить());
	СтруктураПараметров.Вставить("ИспользоватьВнеоборотныеАктивы2_4", Константы.ИспользоватьВнеоборотныеАктивы2_4.Получить());
	СтруктураПараметров.Вставить("ДатаНачалаУчетаВнеоборотныхАктивов2_4", Константы.ДатаНачалаУчетаВнеоборотныхАктивов2_4.Получить());
	СтруктураПараметров.Вставить("ИсточникСуммыДляПересчетаВВалютуФО", Константы.ИсточникСуммыДляПересчетаВВалютуФинОтчетности.Получить());
	СтруктураПараметров.Вставить("ВалютаФинОтчетности", Константы.ВалютаФинОтчетности.Получить());
	СтруктураПараметров.Вставить("ПустаяСсылка",        ПланыСчетов.Хозрасчетный.ПустаяСсылка());
	СтруктураПараметров.Вставить("ВестиУУ",             Константы.ВестиУУНаПланеСчетовХозрасчетный.Получить());
	СтруктураПараметров.Вставить("ДатаНачалаВеденияУУ", Константы.ДатаНачалаУУНаПланеСчетовХозрасчетный.Получить());
	СтруктураПараметров.Вставить("ДатаНачалаУчетаНДСПоНаправлениямДеятельности", НастройкиУчетаНДС.ДатаНачалаУчетаНДСПоНаправлениямДеятельности);
	СтруктураПараметров.Вставить("ДатаОтраженияВозвратовКорректировочнымиСФ", УчетНДСРФ.ДатаОтраженияВозвратовКорректировочнымиСФ());
	СтруктураПараметров.Вставить("ДатаВозможностиВычетаПриОказанииУслугНеВРФ", НастройкиУчетаНДС.ДатаВозможностиВычетаПриОказанииУслугНеВРФ);
	СтруктураПараметров.Вставить("ДатаНачалаДействияФСБУ5", РеглУчетКлиентСервер.НачалоПримененияФСБУ5_2019());
	СтруктураПараметров.Вставить("ДатаВключенияСебестоимостиПоНазначениям", РасчетСебестоимостиПовтИсп.ДатаВключенияОбособленногоУчетаСебестоимостиПоНазначениям());
	СтруктураПараметров.Вставить("ДатаНачалаПрименения67ФЗ", РеглУчетКлиентСервер.ПериодУчетаКурсовыхРазницНУПо67ФЗ().Начало);
	СтруктураПараметров.Вставить("ДатаНачалаПрименения67ФЗРасходы", РегистрыСведений.НастройкиУчетаНалогаНаПрибыль.НачалоПрименения67ФЗПоРасходам());
	СтруктураПараметров.Вставить("ДатаНачалаДействия176ФЗ", НалоговыйУчет.ДатаНачалаДействия176ФЗ());
	
	СтруктураПараметров.Вставить("ЗабалансовыеРазделыУчета", Перечисления.РазделыУчетаСебестоимостиТоваров.ЗабалансовыеРазделыУчета());
	СтруктураПараметров.Вставить("ТипыНеОблагаемыеНДС",      УчетНДСУП.ВидыДеятельностиНДСУчитываетсяВСтоимости());
	СтруктураПараметров.Вставить("ТипыОблагаемыеНДС",        УчетНДСУП.ВидыДеятельностиНДСПринимаетсяКВозмещению());
	ТипыЗапасовВнешнийВладелец = Перечисления.ТипыЗапасов.ТипыЗапасовВнешнийВладелец();
	// Удалим ТоварНаХраненииСПравомПродажиПереданный и АгентскаяУслуга так как изначально в проводках не было их:
	МассивУдаляемыхТипов = Новый Массив;
	МассивУдаляемыхТипов.Добавить(Перечисления.ТипыЗапасов.ТоварНаХраненииСПравомПродажиПереданный);
	МассивУдаляемыхТипов.Добавить(Перечисления.ТипыЗапасов.АгентскаяУслуга);
	ОбщегоНазначенияУТКлиентСервер.УдалитьЗначенияИзМассива(ТипыЗапасовВнешнийВладелец, МассивУдаляемыхТипов);
	СтруктураПараметров.Вставить("ТипыЗапасовВнешнийВладелец", ТипыЗапасовВнешнийВладелец);
	СтруктураПараметров.Вставить("ТипыДокументовХозСпособа", ТипыДокументовДляХозСпособа());
	СтруктураПараметров.Вставить("ПустойТипНалогообложения", Перечисления.ТипыНалогообложенияНДС.ПустаяСсылка());
	
	СтруктураПараметров.Вставить("ДатаПрекращенияДействияЛьготПлатон", ВнеоборотныеАктивыЛокализация.ДатаПрекращенияДействияЛьготПлатон());
	
	СтруктураПараметров.Вставить("СписокТиповВводаОстатков", ТипыДокументовВводаНачальныхОстатков());
	СтруктураПараметров.Вставить("ДетализацияПроводок", ДетализацияПроводок);
	
	#Область ЗаполнениеНаправленияДеятельности
	
	Условия = УсловияЗаполненияНаправленийДеятельностиПоВидамСчетов();
	СтруктураПараметров.Вставить("УчетЗатрат",                Условия.УчетЗатрат);
	СтруктураПараметров.Вставить("УчетДоходов",               Условия.УчетДоходов);
	СтруктураПараметров.Вставить("УчетДенежныхСредств",       Условия.УчетДенежныхСредств);
	СтруктураПараметров.Вставить("УчетВнеоборотныхАктивов",   Условия.УчетВнеоборотныхАктивов);
	СтруктураПараметров.Вставить("УчетРасчетовСПоставщиками", Условия.УчетРасчетовСПоставщиками);
	СтруктураПараметров.Вставить("УчетРезервов",              Условия.УчетРезервов);
	СтруктураПараметров.Вставить("НикогдаНеЗаполнять",        Условия.НикогдаНеЗаполнять);
	СтруктураПараметров.Вставить("ЗаполнятьВсегда",           Условия.ЗаполнятьВсегда);
	
	#КонецОбласти
	
	#Область ПереопределениеАналитикИМестУчетаПоВидуСчета
	
	Для каждого РазделУчета Из НастройкаСчетовУчетаКлиентСервер.СписокРазделовСчетовУчета(Истина).ВыгрузитьЗначения() Цикл
		
		ВидыСчетовРеглУчета = НастройкаСчетовУчетаСервер.ВидыСчетовРеглУчетаПоРазделуУчета(РазделУчета, Ложь);
		НастройкаАналитики = НастройкаСчетовУчетаСервер.НастройкиАналитикиУчетаПоРазделуУчета(РазделУчета);
		НастройкаМестаУчета = НастройкаСчетовУчетаСервер.НастройкиМестаУчетаПоРазделуУчета(РазделУчета);
		ПустоеЗначениеАналитики = ?(НастройкаАналитики.ТипЗначения <> Неопределено, НастройкаАналитики.ТипЗначения.ПривестиЗначение(Неопределено), Неопределено);
		ПустоеЗначениеМестаУчета = ?(НастройкаМестаУчета.ТипЗначения <> Неопределено, НастройкаМестаУчета.ТипЗначения.ПривестиЗначение(Неопределено), Неопределено);
		
		СтруктураПараметров.Вставить("ВидыСчетов_" + РазделУчета, ВидыСчетовРеглУчета);
		СтруктураПараметров.Вставить("НеИспользуетсяАналитикаУчета_" + РазделУчета, Не НастройкаАналитики.Используется);
		СтруктураПараметров.Вставить("ПустоеЗначениеАналитикаУчета_" + РазделУчета, ПустоеЗначениеАналитики);
		СтруктураПараметров.Вставить("НеИспользуетсяМестоУчета_" + РазделУчета, Не НастройкаМестаУчета.Используется);
		СтруктураПараметров.Вставить("ПустоеЗначениеМестоУчета_" + РазделУчета, ПустоеЗначениеМестаУчета);
		
	КонецЦикла;
	
	#КонецОбласти
	
	#Область РеклассификацияЗадолженности
	
	МассивСчетовДляТранзитаДолгосрочнойЗадолженности = Новый Массив;
	МассивСчетовДляТранзитаДолгосрочнойЗадолженности.Добавить(Перечисления.ВидыСчетовРеглУчета.РасчетыСКлиентами);
	МассивСчетовДляТранзитаДолгосрочнойЗадолженности.Добавить(Перечисления.ВидыСчетовРеглУчета.РасчетыСПоставщиками);
	МассивСчетовДляТранзитаДолгосрочнойЗадолженности.Добавить(Перечисления.ВидыСчетовРеглУчета.ПроцентыПоДисконтированию);
	СтруктураПараметров.Вставить("СчетаДляТранзитаДолгосрочнойЗадолженности", МассивСчетовДляТранзитаДолгосрочнойЗадолженности);
	
	АктивныеСчетаПриРеклассификации = Новый Массив;
	АктивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.РасчетыСКлиентами);
	АктивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.АвансыВыданные);
	АктивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.РасчетыСКредиторамиКомиссия);
	АктивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.РасчетыСДебиторамиОсновнойДолг);
	АктивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.РасчетыСДебиторамиПроценты);
	АктивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.РасчетыСДебиторамиКомиссия);
	АктивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.ОбеспечительныйПлатеж);
	СтруктураПараметров.Вставить("АктивныеСчетаПриРеклассификации", АктивныеСчетаПриРеклассификации);
	
	ПассивныеСчетаПриРеклассификации = Новый Массив;
	ПассивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.АвансыПолученные);
	ПассивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.РасчетыСПоставщиками);
	ПассивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.РасчетыСКредиторамиОсновнойДолг);
	ПассивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.РасчетыСКредиторамиПроценты);
	ПассивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.ВыкупнаяСтоимость);
	ПассивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.АрендныеОбязательства);
	ПассивныеСчетаПриРеклассификации.Добавить(Перечисления.ВидыСчетовРеглУчета.УслугаПоАренде);
	СтруктураПараметров.Вставить("ПассивныеСчетаПриРеклассификации", ПассивныеСчетаПриРеклассификации);
	
	#КонецОбласти
	
	СтруктураДанных = РасчетСебестоимостиНДС.ИнициализироватьСтруктуруДанныхДетализацииПартийНДСДляРеглУчета();
	
	РасчетСебестоимостиНДС.ДополнитьСтруктуруПараметровДляДетализацииПартийНДС(СтруктураПараметров, СтруктураДанных);
	
	Возврат СтруктураПараметров;
	
КонецФункции

// Возвращает массив типов документов, которые формируют проводки при проведении.
//	ВозвращаемоеЗначение:
//		Массив - массив типов документов.
//
Функция ТипыДокументовОтражающиесяОперативно() Экспорт
	
	Результат = Новый Массив;
	
	// Документы учета ОС
	Результат.Добавить(Тип("ДокументСсылка.ВводОстатковВнеоборотныхАктивов"));
	Результат.Добавить(Тип("ДокументСсылка.ПринятиеКУчетуОС"));
	Результат.Добавить(Тип("ДокументСсылка.МодернизацияОС"));
	Результат.Добавить(Тип("ДокументСсылка.ПеремещениеОС"));
	Результат.Добавить(Тип("ДокументСсылка.ПодготовкаКПередачеОС"));
	Результат.Добавить(Тип("ДокументСсылка.СписаниеОС"));
	Результат.Добавить(Тип("ДокументСсылка.АмортизацияОС"));
	Результат.Добавить(Тип("ДокументСсылка.ИзменениеПараметровОС"));
	Результат.Добавить(Тип("ДокументСсылка.ПередачаОСВАренду"));
	Результат.Добавить(Тип("ДокументСсылка.ВозвратОСИзАренды"));
	Результат.Добавить(Тип("ДокументСсылка.ПоступлениеАрендованныхОС"));
	Результат.Добавить(Тип("ДокументСсылка.ВыбытиеАрендованныхОС"));
	Результат.Добавить(Тип("ДокументСсылка.ПереоценкаОС"));
	
	// Документы учета НМА
	Результат.Добавить(Тип("ДокументСсылка.ПринятиеКУчетуНМА"));
	Результат.Добавить(Тип("ДокументСсылка.СписаниеНМА"));
	Результат.Добавить(Тип("ДокументСсылка.АмортизацияНМА"));
	Результат.Добавить(Тип("ДокументСсылка.ПодготовкаКПередачеНМА"));
	Результат.Добавить(Тип("ДокументСсылка.ПереоценкаНМА"));
	
	Возврат Результат;
	
КонецФункции

// Возвращает массив типов документов, для которых не будет использоваться пакетное отражение.
//	ВозвращаемоеЗначение:
//		Массив - массив типов документов.
//
Функция ТипыДокументовКПоследовательномуОтражению() Экспорт
	
	Результат = ТипыДокументовОтражающиесяОперативно();
	
	// Регламентные документы не требуется отражать пакетно
	Результат.Добавить(Тип("ДокументСсылка.РаспределениеНДС"));
	Результат.Добавить(Тип("ДокументСсылка.РасчетСебестоимостиТоваров"));
	Результат.Добавить(Тип("ДокументСсылка.РаспределениеДоходовПоНаправлениямДеятельности"));
	Результат.Добавить(Тип("ДокументСсылка.РегламентнаяОперация"));
	
	Возврат Результат;
	
КонецФункции

Функция ТипыДокументовВводаНачальныхОстатков()
	
	Результат = Новый Массив;
	
	Результат.Добавить(Тип("ДокументСсылка.ВводОстатков"));
	Результат.Добавить(Тип("ДокументСсылка.ВводОстатковВзаиморасчетов"));
	Результат.Добавить(Тип("ДокументСсылка.ВводОстатковДенежныхСредств"));
	Результат.Добавить(Тип("ДокументСсылка.ВводОстатковНДСПредъявленного"));
	Результат.Добавить(Тип("ДокументСсылка.ВводОстатковОПродажахЗаПрошлыеПериоды"));
	Результат.Добавить(Тип("ДокументСсылка.ВводОстатковПоФинансовымИнструментам"));
	Результат.Добавить(Тип("ДокументСсылка.ВводОстатковПрочиеРасходы"));
	Результат.Добавить(Тип("ДокументСсылка.ВводОстатковПрочихАктивовПассивов"));
	Результат.Добавить(Тип("ДокументСсылка.ВводОстатковРасчетовПоЭквайрингу"));
	Результат.Добавить(Тип("ДокументСсылка.ВводОстатковСПодотчетниками"));
	Результат.Добавить(Тип("ДокументСсылка.ВводОстатковТМЦВЭксплуатации"));
	Результат.Добавить(Тип("ДокументСсылка.ВводОстатковТоваров"));
	Результат.Добавить(Тип("ДокументСсылка.ВводОстатковВзаиморасчетовПоАренде"));
	Результат.Добавить(Тип("ДокументСсылка.ВводОстатковВнеоборотныхАктивов2_4"));
	Результат.Добавить(Тип("ДокументСсылка.СчетФактураВыданныйАванс"));
	Результат.Добавить(Тип("ДокументСсылка.СчетФактураПолученныйАванс"));
	//++ НЕ УТКА
	Результат.Добавить(Тип("ДокументСсылка.НачальныеОстаткиНЗППоПартиямПроизводства"));
	//-- НЕ УТКА

	//++ НЕ УТ
	Результат.Добавить(Тип("ДокументСсылка.ВводОстатковРасходовПриУСН"));
	Результат.Добавить(Тип("ДокументСсылка.ВводДанныхПоНалогуНаПрибыль"));
	//-- НЕ УТ
	
	Возврат Результат;
	
КонецФункции

// Возвращает массив типов документов, для которых не используется ручная корректировка проводок.
//	ВозвращаемоеЗначение:
//		Массив - массив типов документов.
//
Функция ИсключенияИзРучнойКорректировкиПроводок() Экспорт
	
	Возврат ТипыДокументовОтражающиесяОперативно();
	
КонецФункции

// Возвращает массив типов документов, для которых не будет использоваться проверка при переотражении.
//	ВозвращаемоеЗначение:
//		Массив - массив типов документов.
//
Функция СписокТиповИсключенийДляПереотражения() Экспорт
	
	Результат = ТипыДокументовОтражающиесяОперативно();
	
	Результат.Добавить(Тип("ДокументСсылка.ОперацияБух"));
	Результат.Добавить(Тип("ДокументСсылка.КорректировкаНалогообложенияНДСПартийТоваров"));
	Результат.Добавить(Тип("ДокументСсылка.РегламентнаяОперация"));
	
	Возврат Результат;
	
КонецФункции

// Функция задает правила исключений при отражении документа в регл. учете:
//	Типичное поведение: обращение к модулю менеджера документа для получения текста запроса временных таблиц и отражения;
//	Альтернатива: можно назначить для каких-либо документов обращение к какому-то общему модулю вместо типичного поведения;
//	Нет текстов отражения: если документ отражается оперативно (операцияБух или корректировка регистров) можно назначить для него пустую строку.
//
//	Возвращаемое значение:
//		Соответствие - ключом выступают имена документов, которые могут отражаться в регл. учете, значением - имя общего модуля, для вызова,
//			если значение не задано - для документа не будет назначаться никакого текста отражения.
//
Функция ДокументыИОбщиеМодулиОписывающиеОтражениеВРеглУчете()
	
	СоответствиеИменДокументовИменамОбщихМодулей = Новый Соответствие;
	СоответствиеИменДокументовИменамОбщихМодулей.Вставить("ОперацияБух", "");
	СоответствиеИменДокументовИменамОбщихМодулей.Вставить("МаркировкаТоваровГИСМ", "МаркировкаТоваровГИСМУТ");
	СоответствиеИменДокументовИменамОбщихМодулей.Вставить("ПеремаркировкаТоваровГИСМ", "МаркировкаТоваровГИСМУТ");
	СоответствиеИменДокументовИменамОбщихМодулей.Вставить("РезервыПоОплатеТруда", "РезервыПоОплатеТрудаУП");
	
	Возврат СоответствиеИменДокументовИменамОбщихМодулей;
	
КонецФункции

Функция УсловияЗаполненияНаправленийДеятельностиПоВидамСчетов()
	
	УсловияЗаполнения = Новый Структура;
	УсловияЗаполнения.Вставить("УчетЗатрат",                Новый Массив);
	УсловияЗаполнения.Вставить("УчетДоходов",               Новый Массив);
	УсловияЗаполнения.Вставить("УчетДенежныхСредств",       Новый Массив);
	УсловияЗаполнения.Вставить("УчетВнеоборотныхАктивов",   Новый Массив);
	УсловияЗаполнения.Вставить("УчетРасчетовСПоставщиками", Новый Массив);
	УсловияЗаполнения.Вставить("УчетРезервов",              Новый Массив);
	УсловияЗаполнения.Вставить("НикогдаНеЗаполнять",        Новый Массив);
	УсловияЗаполнения.Вставить("ЗаполнятьВсегда",           Новый Массив);
	
	ВидыСчетовРегл = Новый Массив;
	Для каждого ЗначениеПеречисления Из Метаданные.Перечисления.ВидыСчетовРеглУчета.ЗначенияПеречисления Цикл
		Если СтрНачинаетсяС(ЗначениеПеречисления.Имя, "Удалить") Тогда
			Продолжить;
		КонецЕсли;
		ВидыСчетовРегл.Добавить(Перечисления.ВидыСчетовРеглУчета[ЗначениеПеречисления.Имя]);
	КонецЦикла;
	
	Для каждого ВидСчетовРегл Из ВидыСчетовРегл Цикл
		
		Если ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.Расходы  // УчетЗатрат
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.СписаниеРасходовОСНО
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.СписаниеРасходовЕНВД
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.НаСкладе
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.РеализацияБезПереходаПраваСобственности
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ТоварыПереданныеНаКомиссию
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ПередачаВПереработку
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ЗатратыНаПриобретениеТМЦ
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ТМЦНаСкладах
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ТМЦВПроизводстве
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ТМЦПотребленныеВПроизводстве
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ТМЦУХранителей
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ТМЦКСписанию
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработку
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуВПроизводстве
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.МатериалыПотребленныеВПроизводстве
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуУХранителей
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.МатериалыПринятыеВПереработкуКСписанию
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ТоварыНаСкладе
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.НДСпоПриобретеннымЦенностям
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.НДСПриЗакупке
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.Производство
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.РезервыПодОбесценениеТМЦ
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.РезервыПодОбесценениеПереданные
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.РезервыПодОбесценениеПроизводства
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.НоменклатураПереданная
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.РезервыПоСомнительнымДолгам Тогда
			
			УсловияЗаполнения.УчетЗатрат.Добавить(ВидСчетовРегл);
			
		ИначеЕсли ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.Доходы // УчетДоходов
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.СебестоимостьПродаж
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.СебестоимостьПродажЕНВД
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ВыручкаОтПродаж
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ВыручкаОтПродажЕНВД
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ВыручкаРаздельныйНУ
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.НДСПриПродаже
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.НДСПриДоходах
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.НДСПриОтгрузкеБезПереходаПраваСобственности
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.РасчетыСКлиентами
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.АвансыПолученные
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.РасчетыСКлиентамиТара
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.НДСАвансыПолученные Тогда
			
			УсловияЗаполнения.УчетДоходов.Добавить(ВидСчетовРегл);
			
		ИначеЕсли ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ДенежныеСредства // УчетДенежныхСредств
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ПродажиПоЭквайрингу Тогда
			
			УсловияЗаполнения.УчетДенежныхСредств.Добавить(ВидСчетовРегл);
			
		ИначеЕсли ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.СтоимостьВНА  // УчетВнеоборотныхАктивов
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.СтоимостьВНА_ЦФ
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.АмортизацияВНА
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.АмортизацияВНА_ЦФ
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ВыбытиеВНА
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.РезервДоОценкиВНА
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ЗабалансовыйУчетВНА
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ОбесценениеВНА
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.АрендныеПлатежи
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.НГЛС
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ПроцентныйДисконт Тогда
			
			УсловияЗаполнения.УчетВнеоборотныхАктивов.Добавить(ВидСчетовРегл);
			
		ИначеЕсли ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.РасчетыСПоставщиками // УчетРасчетовСПоставщиками
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.АвансыВыданные
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.РасчетыСПоставщикамиТара 
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.НеотфактурованныеПоставки 
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ПроцентыПоДисконтированию 
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоПродаже 
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.НДСАвансыВыданные Тогда
			
			УсловияЗаполнения.УчетРасчетовСПоставщиками.Добавить(ВидСчетовРегл);
			
		ИначеЕсли ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.Резервы // УчетРезервов
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ПроцентыПоДисконтированиюРезервов Тогда
			
			УсловияЗаполнения.УчетРезервов.Добавить(ВидСчетовРегл);
			
		ИначеЕсли ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.РасчетыСДебиторамиОсновнойДолг // ЗаполнятьВсегда
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.РасчетыСДебиторамиПроценты
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.РасчетыСДебиторамиКомиссия
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.РасчетыСКредиторамиОсновнойДолг
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.РасчетыСКредиторамиПроценты
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.РасчетыСКредиторамиКомиссия
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.УслугаПоАренде
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ОбеспечительныйПлатеж
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ВыкупнаяСтоимость
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.АрендныеОбязательства
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.НачислениеПроцентовПоАренде
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.НДСПриАренде
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ТМЦВЭксплуатации
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ТМЦВЭксплуатацииЗаБалансом
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.РасчетыПоПодарочнымСертификатам
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ПрочиеОперации
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ПрочиеАктивыПассивы 
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ТоварыКомитентовКОформлениюПоЗакупке
			Или ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.РасчетыПоБронированию Тогда
			
			УсловияЗаполнения.ЗаполнятьВсегда.Добавить(ВидСчетовРегл);
			
		ИначеЕсли ВидСчетовРегл = Перечисления.ВидыСчетовРеглУчета.ПереносДолгосрочнойЗадолженности Тогда // НикогдаНеЗаполнять
		
			УсловияЗаполнения.НикогдаНеЗаполнять.Добавить(ВидСчетовРегл);
			
		Иначе
			
			ШаблонСообщения = НСтр("ru = 'Для вида счетов %1 не задано условие заполнения направления деятельности.';
									|en = 'The condition for filling in the line of business is not specified for the account type %1.'", 
				ОбщегоНазначения.КодОсновногоЯзыка());
			СообщениеОбОшибке = СтрШаблон(ШаблонСообщения, ОбщегоНазначения.ИмяЗначенияПеречисления(ВидСчетовРегл));
			
			ВызватьИсключение СообщениеОбОшибке;
		
		КонецЕсли;
		
	КонецЦикла;
	
	Возврат УсловияЗаполнения;
	
КонецФункции

#КонецОбласти

#КонецОбласти
