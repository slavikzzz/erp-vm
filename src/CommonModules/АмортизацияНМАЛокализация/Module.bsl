////////////////////////////////////////////////////////////////////////////////
// Процедуры, используемые для локализации документа "Амортизация НМА".
// 
////////////////////////////////////////////////////////////////////////////////

#Область ПрограммныйИнтерфейс

#Область Проведение

// Описывает учетные механизмы используемые в документе для регистрации в механизме проведения.
//
// Параметры:
//  МеханизмыДокумента - Массив - список имен учетных механизмов, для которых будет выполнена
//              регистрация в механизме проведения.
//
Процедура ЗарегистрироватьУчетныеМеханизмы(МеханизмыДокумента) Экспорт
	
	//++ Локализация
	МеханизмыДокумента.Добавить("РегламентированныйУчет");
	//-- Локализация
	
КонецПроцедуры

#КонецОбласти

#КонецОбласти

#Область СлужебныйПрограммныйИнтерфейс

#Область ОбработчикиСобытий

// Вызывается из соответствующего обработчика документа
//
// Параметры:
//  Объект - ДокументОбъект.АмортизацияНМА2_4 - Обрабатываемый документ.
//  Отказ - Булево - Признак проведения документа.
//                   Если в теле процедуры-обработчика установить данному параметру значение Истина,
//                   то проведение документа выполнено не будет.
//  РежимПроведения - РежимПроведенияДокумента - В данный параметр передается текущий режим проведения.
//
Процедура ОбработкаПроведения(Объект, Отказ, РежимПроведения) Экспорт
	
КонецПроцедуры

// Вызывается из соответствующего обработчика документа
//
// Параметры:
//  Объект - ДокументОбъект.АмортизацияНМА2_4 - Обрабатываемый объект
//  Отказ - Булево - Если в теле процедуры-обработчика установить данному параметру значение Истина,
//                   то будет выполнен отказ от продолжения работы после выполнения проверки заполнения.
//  ПроверяемыеРеквизиты - Массив - Массив путей к реквизитам, для которых будет выполнена проверка заполнения.
//
Процедура ОбработкаПроверкиЗаполнения(Объект, Отказ, ПроверяемыеРеквизиты) Экспорт
	
	
КонецПроцедуры

// Вызывается из соответствующего обработчика документа
//
// Параметры:
//  Объект - ДокументОбъект.АмортизацияНМА2_4 - Обрабатываемый объект.
//  ДанныеЗаполнения - Произвольный - Значение, которое используется как основание для заполнения.
//  ТекстЗаполнения - Строка, Неопределено - Текст, используемый для заполнения документа. 
//  СтандартнаяОбработка - Булево - В данный параметр передается признак выполнения стандартной (системной) обработки события.
//
Процедура ОбработкаЗаполнения(Объект, ДанныеЗаполнения, ТекстЗаполнения, СтандартнаяОбработка) Экспорт
	
	
КонецПроцедуры

// Вызывается из соответствующего обработчика документа
//
// Параметры:
//  Объект - ДокументОбъект.АмортизацияНМА2_4 - Обрабатываемый объект
//  Отказ - Булево - Признак отказа от записи.
//                   Если в теле процедуры-обработчика установить данному параметру значение Истина,
//                   то запись выполнена не будет и будет вызвано исключение.
//
Процедура ОбработкаУдаленияПроведения(Объект, Отказ) Экспорт
	
	
КонецПроцедуры

// Вызывается из соответствующего обработчика документа
//
// Параметры:
//  Объект - ДокументОбъект.АмортизацияНМА2_4 - Обрабатываемый объект
//  Отказ - Булево - Признак отказа от записи.
//                   Если в теле процедуры-обработчика установить данному параметру значение Истина,
//                   то запись выполнена не будет и будет вызвано исключение.
//  РежимЗаписи - РежимЗаписиДокумента - В параметр передается текущий режим записи документа. Позволяет определить в теле процедуры режим записи.
//  РежимПроведения - РежимПроведенияДокумента - В данный параметр передается текущий режим проведения.
//
Процедура ПередЗаписью(Объект, Отказ, РежимЗаписи, РежимПроведения) Экспорт
	
	
КонецПроцедуры

// Вызывается из соответствующего обработчика документа
//
// Параметры:
//  Объект - ДокументОбъект.АмортизацияНМА2_4 - Обрабатываемый объект
//  Отказ - Булево - Признак отказа от записи.
//                   Если в теле процедуры-обработчика установить данному параметру значение Истина, то запись выполнена не будет и будет вызвано исключение.
//
Процедура ПриЗаписи(Объект, Отказ) Экспорт
	
	
КонецПроцедуры

// Вызывается из соответствующего обработчика документа
//
// Параметры:
//  Объект - ДокументОбъект.АмортизацияНМА2_4 - Обрабатываемый объект
//  ОбъектКопирования - ДокументОбъект.АмортизацияНМА2_4 - Исходный документ, который является источником копирования.
//
Процедура ПриКопировании(Объект, ОбъектКопирования) Экспорт
	
	
КонецПроцедуры

#КонецОбласти

#Область ПодключаемыеКоманды

// Определяет список команд создания на основании.
//
// Параметры:
//  КомандыСозданияНаОсновании - см. СозданиеНаОснованииПереопределяемый.ПередДобавлениемКомандСозданияНаОсновании.КомандыСозданияНаОсновании
//  Параметры - см. СозданиеНаОснованииПереопределяемый.ПередДобавлениемКомандСозданияНаОсновании.Параметры
//
Процедура ДобавитьКомандыСозданияНаОсновании(КомандыСозданияНаОсновании, Параметры) Экспорт
	
	
КонецПроцедуры

// Добавляет команду создания документа "Авансовый отчет".
//
// Параметры:
//  КомандыСозданияНаОсновании - см. СозданиеНаОснованииПереопределяемый.ПередДобавлениемКомандСозданияНаОсновании.КомандыСозданияНаОсновании
//
Процедура ДобавитьКомандуСоздатьНаОсновании(КомандыСозданияНаОсновании) Экспорт


КонецПроцедуры

// Определяет список команд отчетов.
//
// Параметры:
//   КомандыОтчетов - См. ВариантыОтчетовПереопределяемый.ПередДобавлениемКомандОтчетов.КомандыОтчетов
//   Параметры - См. ВариантыОтчетовПереопределяемый.ПередДобавлениемКомандОтчетов.Параметры
//
Процедура ДобавитьКомандыОтчетов(КомандыОтчетов, Параметры) Экспорт
	
	//++ Локализация
	Отчеты.СправкаРасчетАмортизацииНМА2_4.ДобавитьКомандуОтчетаПоДокументуАмортизацииНМА(КомандыОтчетов);
	//-- Локализация
	
КонецПроцедуры

// Добавляет команды печати.
// 
// Параметры:
// 	КомандыПечати - см. УправлениеПечатью.СоздатьКоллекциюКомандПечати
Процедура ДобавитьКомандыПечати(КомандыПечати) Экспорт
	
	
КонецПроцедуры

#КонецОбласти

#Область Печать

// Формирует печатные формы.
//
// Параметры:
//  МассивОбъектов  - Массив    - ссылки на объекты, которые нужно распечатать;
//  ПараметрыПечати - Структура - дополнительные настройки печати;
//  КоллекцияПечатныхФорм - ТаблицаЗначений - сформированные табличные документы (выходной параметр)
//  ОбъектыПечати         - СписокЗначений  - значение - ссылка на объект;
//                                            представление - имя области в которой был выведен объект (выходной параметр);
//  ПараметрыВывода       - Структура       - дополнительные параметры сформированных табличных документов (выходной параметр).
//
Процедура Печать(МассивОбъектов, ПараметрыПечати, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт
	
	
КонецПроцедуры

#КонецОбласти

#Область ПроводкиРегУчета

// Функция возвращает текст запроса для отражения документа в регламентированном учете.
//
// Возвращаемое значение:
//	Строка - Текст запроса
//
Функция ТекстОтраженияВРеглУчете() Экспорт
	
	ТекстЗапроса = "";

	//++ Локализация
	
	СписокЗапросов = Новый Массив;

	#Область НМА
	
	#Область Амортизация
	ТекстЗапроса =
	"////////////////////////////////////////////////////////////////////////////////////////////////////
	|// Амортизация (Дт СчетУчетаЗатрат :: Кт СчетНакопленияАмортизации)
	|ВЫБРАТЬ
	|	
	|	Строки.Регистратор КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|	
	|	Строки.АмортизацияРегл КАК Сумма,
	|	Строки.Амортизация КАК СуммаУУ,
	|	
	|	// Дт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаДт,
	|	Строки.КорСтатьяРасходов КАК АналитикаУчетаДт,
	|	Строки.КорПодразделение КАК МестоУчетаДт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.КорПодразделение КАК ПодразделениеДт,
	|	Строки.КорНаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	Строки.КорСтатьяРасходов КАК СубконтоДт1,
	|	Строки.КорАналитикаРасходов КАК СубконтоДт2,
	|	ВЫБОР КОГДА СтатьиСтроительства.Ссылка ЕСТЬ НЕ NULL ТОГДА
	|			ВЫБОР КОГДА ОбъектыСтроительства.СпособСтроительства <> ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.ПустаяСсылка) 
	|					ТОГДА ОбъектыСтроительства.СпособСтроительства
	|				ИНАЧЕ 
	|					ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.Хозспособ) 
	|			КОНЕЦ
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее)
	|	КОНЕЦ КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|
	|	ВЫБОР 
	|		КОГДА Строки.КорСтатьяРасходов.ПринятиеКНалоговомуУчету = ИСТИНА 
	|			ТОГДА Строки.АмортизацияНУ 
	|		ИНАЧЕ 0 
	|	КОНЕЦ КАК СуммаНУДт,
	|	ВЫБОР 
	|		КОГДА Строки.КорСтатьяРасходов.ПринятиеКНалоговомуУчету = ЛОЖЬ 
	|			ТОГДА Строки.АмортизацияНУ 
	|		ИНАЧЕ 0 
	|	КОНЕЦ + Строки.АмортизацияПР КАК СуммаПРДт,
	|	Строки.АмортизацияВР КАК СуммаВРДт,
	|	
	|	// Кт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АмортизацияВНА) КАК ВидСчетаКт,
	|	Строки.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	Строки.НематериальныйАктив КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	Строки.АмортизацияНУ КАК СуммаНУКт,
	|	Строки.АмортизацияПР КАК СуммаПРКт,
	|	Строки.АмортизацияВР КАК СуммаВРКт,
	|	
	|	/////////////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	""Начисление амортизации"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.АмортизацияНМА КАК Строки
	|	ПО Строки.Регистратор = ДокументыКОтражению.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиСтроительства
	|	ПО Строки.КорСтатьяРасходов = СтатьиСтроительства.Ссылка
	|		И СтатьиСтроительства.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиНаПрочиеАктивы
	|	ПО Строки.КорСтатьяРасходов = СтатьиНаПрочиеАктивы.Ссылка
	|		И СтатьиНаПрочиеАктивы.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы)
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ОбъектыСтроительства КАК ОбъектыСтроительства
	|	ПО ОбъектыСтроительства.Ссылка = Строки.КорАналитикаРасходов
	|
	|ГДЕ
	|	СтатьиНаПрочиеАктивы.Ссылка ЕСТЬ NULL
	|	И Строки.НастройкаХозяйственнойОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.АмортизацияНМА)
	|
	|	И (Строки.Амортизация <> 0
	|		ИЛИ Строки.АмортизацияРегл <> 0
	|		ИЛИ Строки.АмортизацияНУ <> 0
	|		ИЛИ Строки.АмортизацияПР <> 0
	|		ИЛИ Строки.АмортизацияВР <> 0)";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область Амортизация_ЦФ
	
	ТекстЗапроса =
	"////////////////////////////////////////////////////////////////////////////////////////////////////
	|// Амортизация (Дт СчетУчетаЗатрат :: Кт СчетНакопленияАмортизации)
	|ВЫБРАТЬ
	|	
	|	Строки.Регистратор КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|	
	|	Строки.АмортизацияЦФ КАК Сумма,
	|	0 КАК СуммаУУ,
	|	
	|	// Дт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаДт,
	|	Строки.КорСтатьяРасходов КАК АналитикаУчетаДт,
	|	Строки.Подразделение КАК МестоУчетаДт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.КорПодразделение КАК ПодразделениеДт,
	|	Строки.КорНаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	Строки.КорСтатьяРасходов КАК СубконтоДт1,
	|	Строки.КорАналитикаРасходов КАК СубконтоДт2,
	|	ВЫБОР КОГДА СтатьиСтроительства.Ссылка ЕСТЬ НЕ NULL ТОГДА
	|			ВЫБОР КОГДА ОбъектыСтроительства.СпособСтроительства <> ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.ПустаяСсылка) 
	|					ТОГДА ОбъектыСтроительства.СпособСтроительства
	|				ИНАЧЕ 
	|					ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.Хозспособ) 
	|			КОНЕЦ
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее)
	|	КОНЕЦ КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|
	|	ВЫБОР 
	|		КОГДА Строки.КорСтатьяРасходов.ПринятиеКНалоговомуУчету = ИСТИНА 
	|			ТОГДА Строки.АмортизацияНУЦФ 
	|		ИНАЧЕ 0 
	|	КОНЕЦ КАК СуммаНУДт,
	|	ВЫБОР 
	|		КОГДА Строки.КорСтатьяРасходов.ПринятиеКНалоговомуУчету = ЛОЖЬ 
	|			ТОГДА Строки.АмортизацияНУЦФ 
	|		ИНАЧЕ 0 
	|	КОНЕЦ + Строки.АмортизацияПРЦФ КАК СуммаПРДт,
	|	Строки.АмортизацияВРЦФ КАК СуммаВРДт,
	|	
	|	// Кт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АмортизацияВНА_ЦФ) КАК ВидСчетаКт,
	|	Строки.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)КАК СчетКт,
	|	Строки.НематериальныйАктив КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	Строки.АмортизацияНУЦФ КАК СуммаНУКт,
	|	Строки.АмортизацияПРЦФ КАК СуммаПРКт,
	|	Строки.АмортизацияВРЦФ КАК СуммаВРКт,
	|	
	|	/////////////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	""Начисление амортизации"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.АмортизацияНМА КАК Строки
	|	ПО Строки.Регистратор = ДокументыКОтражению.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиСтроительства
	|	ПО Строки.КорСтатьяРасходов = СтатьиСтроительства.Ссылка
	|		И СтатьиСтроительства.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиНаПрочиеАктивы
	|	ПО Строки.КорСтатьяРасходов = СтатьиНаПрочиеАктивы.Ссылка
	|		И СтатьиНаПрочиеАктивы.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы)
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ОбъектыСтроительства КАК ОбъектыСтроительства
	|	ПО ОбъектыСтроительства.Ссылка = Строки.КорАналитикаРасходов
	|
	|ГДЕ
	|	СтатьиНаПрочиеАктивы.Ссылка ЕСТЬ NULL
	|	И Строки.НастройкаХозяйственнойОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.АмортизацияНМА)
	|
	|	И (Строки.АмортизацияЦФ <> 0
	|		ИЛИ Строки.АмортизацияНУЦФ <> 0
	|		ИЛИ Строки.АмортизацияПРЦФ <> 0
	|		ИЛИ Строки.АмортизацияВРЦФ <> 0)";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область Амортизация_Отправитель
	
	ТекстЗапроса =
	"////////////////////////////////////////////////////////////////////////////////////////////////////
	|// Амортизация (Дт РасчетыПоТекущимОперациям :: Кт СчетНакопленияАмортизации)
	|ВЫБРАТЬ
	|	
	|	Строки.Регистратор КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|	
	|	Строки.АмортизацияРегл КАК Сумма,
	|	Строки.Амортизация КАК СуммаУУ,
	|	
	|	// Дт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоТекущимОперациям) КАК СчетДт,
	|	Строки.КорОрганизация КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|
	|	ВЫБОР 
	|		КОГДА Строки.КорСтатьяРасходов.ПринятиеКНалоговомуУчету = ИСТИНА 
	|			ТОГДА Строки.АмортизацияНУ 
	|		ИНАЧЕ 0 
	|	КОНЕЦ КАК СуммаНУДт,
	|	ВЫБОР 
	|		КОГДА Строки.КорСтатьяРасходов.ПринятиеКНалоговомуУчету = ЛОЖЬ 
	|			ТОГДА Строки.АмортизацияНУ 
	|		ИНАЧЕ 0 
	|	КОНЕЦ + Строки.АмортизацияПР КАК СуммаПРДт,
	|	Строки.АмортизацияВР КАК СуммаВРДт,
	|	
	|	// Кт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АмортизацияВНА) КАК ВидСчетаКт,
	|	Строки.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	Строки.НематериальныйАктив КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|
	|	Строки.АмортизацияНУ КАК СуммаНУКт,
	|	Строки.АмортизацияПР КАК СуммаПРКт,
	|	Строки.АмортизацияВР КАК СуммаВРКт,
	|	
	|	/////////////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	""Начисление амортизации"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.АмортизацияНМА КАК Строки
	|	ПО Строки.Регистратор = ДокументыКОтражению.Ссылка
	|	
	|ГДЕ
	|	Строки.НастройкаХозяйственнойОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.АмортизацияНМАвДругуюОрганизацию)
	|
	|	И (Строки.Амортизация <> 0
	|		ИЛИ Строки.АмортизацияРегл <> 0
	|		ИЛИ Строки.АмортизацияНУ <> 0
	|		ИЛИ Строки.АмортизацияПР <> 0
	|		ИЛИ Строки.АмортизацияВР <> 0)";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
	#КонецОбласти

	#Область Амортизация_Получатель
	
	ТекстЗапроса =
	"////////////////////////////////////////////////////////////////////////////////////////////////////
	|// Амортизация (Дт СчетУчетаЗатрат :: Кт РасчетыПоТекущимОперациям)
	|ВЫБРАТЬ
	|	
	|	Строки.Регистратор КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.КорОрганизация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|	
	|	Строки.АмортизацияРегл КАК Сумма,
	|	Строки.Амортизация КАК СуммаУУ,
	|	
	|	// Дт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаДт,
	|	Строки.КорСтатьяРасходов КАК АналитикаУчетаДт,
	|	Строки.КорПодразделение КАК МестоУчетаДт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.КорПодразделение КАК ПодразделениеДт,
	|	Строки.КорНаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	Строки.КорСтатьяРасходов КАК СубконтоДт1,
	|	Строки.КорАналитикаРасходов КАК СубконтоДт2,
	|	ВЫБОР КОГДА СтатьиСтроительства.Ссылка ЕСТЬ НЕ NULL ТОГДА
	|			ВЫБОР КОГДА ОбъектыСтроительства.СпособСтроительства <> ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.ПустаяСсылка) 
	|					ТОГДА ОбъектыСтроительства.СпособСтроительства
	|				ИНАЧЕ 
	|					ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.Хозспособ) 
	|			КОНЕЦ
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее)
	|	КОНЕЦ КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|
	|	ВЫБОР 
	|		КОГДА Строки.КорСтатьяРасходов.ПринятиеКНалоговомуУчету = ИСТИНА 
	|			ТОГДА Строки.АмортизацияНУ 
	|		ИНАЧЕ 0 
	|	КОНЕЦ КАК СуммаНУДт,
	|	ВЫБОР 
	|		КОГДА Строки.КорСтатьяРасходов.ПринятиеКНалоговомуУчету = ЛОЖЬ 
	|			ТОГДА Строки.АмортизацияНУ 
	|		ИНАЧЕ 0 
	|	КОНЕЦ + Строки.АмортизацияПР КАК СуммаПРДт,
	|	Строки.АмортизацияВР КАК СуммаВРДт,
	|	
	|	// Кт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоТекущимОперациям) КАК СчетКт,
	|	Строки.Организация КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|
	|	ВЫБОР 
	|		КОГДА Строки.КорСтатьяРасходов.ПринятиеКНалоговомуУчету = ИСТИНА 
	|			ТОГДА Строки.АмортизацияНУ 
	|		ИНАЧЕ 0 
	|	КОНЕЦ КАК СуммаНУКт,
	|	ВЫБОР 
	|		КОГДА Строки.КорСтатьяРасходов.ПринятиеКНалоговомуУчету = ЛОЖЬ 
	|			ТОГДА Строки.АмортизацияНУ 
	|		ИНАЧЕ 0 
	|	КОНЕЦ + Строки.АмортизацияПР КАК СуммаПРКт,
	|	Строки.АмортизацияВР КАК СуммаВРКт,
	|	
	|	/////////////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	""Начисление амортизации"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.АмортизацияНМА КАК Строки
	|	ПО Строки.Регистратор = ДокументыКОтражению.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиСтроительства
	|	ПО Строки.КорСтатьяРасходов = СтатьиСтроительства.Ссылка
	|		И СтатьиСтроительства.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиНаПрочиеАктивы
	|	ПО Строки.КорСтатьяРасходов = СтатьиНаПрочиеАктивы.Ссылка
	|		И СтатьиНаПрочиеАктивы.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы)
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ОбъектыСтроительства КАК ОбъектыСтроительства
	|	ПО ОбъектыСтроительства.Ссылка = Строки.КорАналитикаРасходов
	|
	|ГДЕ
	|	Строки.НастройкаХозяйственнойОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.АмортизацияНМАвДругуюОрганизацию)
	|	И СтатьиНаПрочиеАктивы.Ссылка ЕСТЬ NULL
	|
	|	И (Строки.Амортизация <> 0
	|		ИЛИ Строки.АмортизацияРегл <> 0
	|		ИЛИ Строки.АмортизацияНУ <> 0
	|		ИЛИ Строки.АмортизацияПР <> 0
	|		ИЛИ Строки.АмортизацияВР <> 0)";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
	#КонецОбласти

	#Область Амортизация_НаПрочиеОперации
	ТекстЗапроса =
	"////////////////////////////////////////////////////////////////////////////////////////////////////
	|// Амортизация (Дт СчетУчетаЗатрат :: Кт СчетНакопленияАмортизации)
	|ВЫБРАТЬ
	|	
	|	Строки.Регистратор КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|	
	|	Строки.АмортизацияРегл КАК Сумма,
	|	Строки.Амортизация КАК СуммаУУ,
	|	
	|	// Дт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеОперации) КАК ВидСчетаДт,
	|	Строки.КорСтатьяРасходов КАК АналитикаУчетаДт,
	|	Строки.КорПодразделение КАК МестоУчетаДт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.КорПодразделение КАК ПодразделениеДт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|
	|	ВЫБОР 
	|		КОГДА Строки.КорСтатьяРасходов.ПринятиеКНалоговомуУчету = ИСТИНА 
	|			ТОГДА Строки.АмортизацияНУ 
	|		ИНАЧЕ 0 
	|	КОНЕЦ КАК СуммаНУДт,
	|	ВЫБОР 
	|		КОГДА Строки.КорСтатьяРасходов.ПринятиеКНалоговомуУчету = ЛОЖЬ 
	|			ТОГДА Строки.АмортизацияНУ 
	|		ИНАЧЕ 0 
	|	КОНЕЦ + Строки.АмортизацияПР КАК СуммаПРДт,
	|	Строки.АмортизацияВР КАК СуммаВРДт,
	|	
	|	// Кт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АмортизацияВНА) КАК ВидСчетаКт,
	|	Строки.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка) КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	Строки.НематериальныйАктив КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	Строки.АмортизацияНУ КАК СуммаНУКт,
	|	Строки.АмортизацияПР КАК СуммаПРКт,
	|	Строки.АмортизацияВР КАК СуммаВРКт,
	|	
	|	/////////////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	""Начисление амортизации"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.АмортизацияНМА КАК Строки
	|	ПО Строки.Регистратор = ДокументыКОтражению.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиНаПрочиеАктивы
	|	ПО Строки.КорСтатьяРасходов = СтатьиНаПрочиеАктивы.Ссылка
	|		И СтатьиНаПрочиеАктивы.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы)
	|	
	|ГДЕ
	|	Строки.НастройкаХозяйственнойОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.АмортизацияНМА)
	|
	|	И (Строки.Амортизация <> 0
	|		ИЛИ Строки.АмортизацияРегл <> 0
	|		ИЛИ Строки.АмортизацияНУ <> 0
	|		ИЛИ Строки.АмортизацияПР <> 0
	|		ИЛИ Строки.АмортизацияВР <> 0)";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#КонецОбласти
	
	#Область РасходыНаНИОКР
	
	#Область СписаниеРасходовНаНИОКР
	ТекстЗапроса =
	"////////////////////////////////////////////////////////////////////////////////////////////////////
	|// Амортизация (Дт СчетУчетаЗатрат :: Кт СтоимостьВНА)
	|ВЫБРАТЬ
	|	
	|	Строки.Регистратор КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|	
	|	Строки.СтоимостьРегл КАК Сумма,
	|	Строки.Стоимость КАК СуммаУУ,
	|	
	|	// Дт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаДт,
	|	Строки.КорСтатьяРасходов КАК АналитикаУчетаДт,
	|	Строки.КорПодразделение КАК МестоУчетаДт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.КорПодразделение КАК ПодразделениеДт,
	|	Строки.КорНаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	Строки.КорСтатьяРасходов КАК СубконтоДт1,
	|	Строки.КорАналитикаРасходов КАК СубконтоДт2,
	|	ВЫБОР КОГДА СтатьиСтроительства.Ссылка ЕСТЬ НЕ NULL ТОГДА
	|			ВЫБОР КОГДА ОбъектыСтроительства.СпособСтроительства <> ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.ПустаяСсылка) 
	|					ТОГДА ОбъектыСтроительства.СпособСтроительства
	|				ИНАЧЕ 
	|					ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.Хозспособ) 
	|			КОНЕЦ
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее)
	|	КОНЕЦ КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|
	|	ВЫБОР 
	|		КОГДА Строки.КорСтатьяРасходов.ПринятиеКНалоговомуУчету = ИСТИНА 
	|			ТОГДА Строки.СтоимостьНУ 
	|		ИНАЧЕ 0 
	|	КОНЕЦ КАК СуммаНУДт,
	|	ВЫБОР 
	|		КОГДА Строки.КорСтатьяРасходов.ПринятиеКНалоговомуУчету = ЛОЖЬ 
	|			ТОГДА Строки.СтоимостьНУ 
	|		ИНАЧЕ 0 
	|	КОНЕЦ + Строки.СтоимостьПР КАК СуммаПРДт,
	|	Строки.СтоимостьВР КАК СуммаВРДт,
	|	
	|	// Кт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СтоимостьВНА) КАК ВидСчетаКт,
	|	Строки.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	Строки.НематериальныйАктив КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	Строки.СтоимостьНУ КАК СуммаНУКт,
	|	Строки.СтоимостьПР КАК СуммаПРКт,
	|	Строки.СтоимостьВР КАК СуммаВРКт,
	|	
	|	/////////////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	""Списание расходов на НИОКР"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.СтоимостьНМА КАК Строки
	|	ПО Строки.Регистратор = ДокументыКОтражению.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиСтроительства
	|	ПО Строки.КорСтатьяРасходов = СтатьиСтроительства.Ссылка
	|		И СтатьиСтроительства.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиНаПрочиеАктивы
	|	ПО Строки.КорСтатьяРасходов = СтатьиНаПрочиеАктивы.Ссылка
	|		И СтатьиНаПрочиеАктивы.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы)
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ОбъектыСтроительства КАК ОбъектыСтроительства
	|	ПО ОбъектыСтроительства.Ссылка = Строки.КорАналитикаРасходов
	|
	|ГДЕ
	|	СтатьиНаПрочиеАктивы.Ссылка ЕСТЬ NULL
	|	И Строки.НастройкаХозяйственнойОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СписаниеНаРасходыНИОКР)
	|
	|	И (Строки.Стоимость <> 0
	|		ИЛИ Строки.СтоимостьРегл <> 0
	|		ИЛИ Строки.СтоимостьНУ <> 0
	|		ИЛИ Строки.СтоимостьПР <> 0
	|		ИЛИ Строки.СтоимостьВР <> 0)";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область СписаниеРасходовНаНИОКР_ЦФ
	
	ТекстЗапроса =
	"////////////////////////////////////////////////////////////////////////////////////////////////////
	|// Амортизация (Дт СчетУчетаЗатрат :: Кт СчетНакопленияАмортизации_ЦФ)
	|ВЫБРАТЬ
	|	
	|	Строки.Регистратор КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|	
	|	Строки.СтоимостьЦФ КАК Сумма,
	|	0 КАК СуммаУУ,
	|	
	|	// Дт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаДт,
	|	Строки.КорСтатьяРасходов КАК АналитикаУчетаДт,
	|	Строки.Подразделение КАК МестоУчетаДт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.КорПодразделение КАК ПодразделениеДт,
	|	Строки.КорНаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	Строки.КорСтатьяРасходов КАК СубконтоДт1,
	|	Строки.КорАналитикаРасходов КАК СубконтоДт2,
	|	ВЫБОР КОГДА СтатьиСтроительства.Ссылка ЕСТЬ НЕ NULL ТОГДА
	|			ВЫБОР КОГДА ОбъектыСтроительства.СпособСтроительства <> ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.ПустаяСсылка) 
	|					ТОГДА ОбъектыСтроительства.СпособСтроительства
	|				ИНАЧЕ 
	|					ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.Хозспособ) 
	|			КОНЕЦ
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее)
	|	КОНЕЦ КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|
	|	ВЫБОР 
	|		КОГДА Строки.КорСтатьяРасходов.ПринятиеКНалоговомуУчету = ИСТИНА 
	|			ТОГДА Строки.СтоимостьНУЦФ 
	|		ИНАЧЕ 0 
	|	КОНЕЦ КАК СуммаНУДт,
	|	ВЫБОР 
	|		КОГДА Строки.КорСтатьяРасходов.ПринятиеКНалоговомуУчету = ЛОЖЬ 
	|			ТОГДА Строки.СтоимостьНУЦФ 
	|		ИНАЧЕ 0 
	|	КОНЕЦ + Строки.СтоимостьПРЦФ КАК СуммаПРДт,
	|	Строки.СтоимостьВРЦФ КАК СуммаВРДт,
	|	
	|	// Кт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СтоимостьВНА_ЦФ) КАК ВидСчетаКт,
	|	Строки.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)КАК СчетКт,
	|	Строки.НематериальныйАктив КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|
	|	Строки.СтоимостьНУЦФ КАК СуммаНУКт,
	|	Строки.СтоимостьПРЦФ КАК СуммаПРКт,
	|	Строки.СтоимостьВРЦФ КАК СуммаВРКт,
	|	
	|	/////////////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	""Начисление амортизации"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.СтоимостьНМА КАК Строки
	|	ПО Строки.Регистратор = ДокументыКОтражению.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиСтроительства
	|	ПО Строки.КорСтатьяРасходов = СтатьиСтроительства.Ссылка
	|		И СтатьиСтроительства.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиНаПрочиеАктивы
	|	ПО Строки.КорСтатьяРасходов = СтатьиНаПрочиеАктивы.Ссылка
	|		И СтатьиНаПрочиеАктивы.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы)
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ОбъектыСтроительства КАК ОбъектыСтроительства
	|	ПО ОбъектыСтроительства.Ссылка = Строки.КорАналитикаРасходов
	|
	|ГДЕ
	|	СтатьиНаПрочиеАктивы.Ссылка ЕСТЬ NULL
	|	И Строки.НастройкаХозяйственнойОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СписаниеНаРасходыНИОКР)
	|
	|	И (Строки.СтоимостьЦФ <> 0
	|		ИЛИ Строки.СтоимостьНУЦФ <> 0
	|		ИЛИ Строки.СтоимостьПРЦФ <> 0
	|		ИЛИ Строки.СтоимостьВРЦФ <> 0)";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область СписаниеРасходовНаНИОКР_Отправитель
	
	ТекстЗапроса =
	"////////////////////////////////////////////////////////////////////////////////////////////////////
	|// Амортизация (Дт РасчетыПоТекущимОперациям :: Кт СтоимостьВНА)
	|ВЫБРАТЬ
	|	
	|	Строки.Регистратор КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|	
	|	Строки.СтоимостьРегл КАК Сумма,
	|	Строки.Стоимость КАК СуммаУУ,
	|	
	|	// Дт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоТекущимОперациям) КАК СчетДт,
	|	Строки.КорОрганизация КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|
	|	ВЫБОР 
	|		КОГДА Строки.КорСтатьяРасходов.ПринятиеКНалоговомуУчету = ИСТИНА 
	|			ТОГДА Строки.СтоимостьНУ 
	|		ИНАЧЕ 0 
	|	КОНЕЦ КАК СуммаНУДт,
	|	ВЫБОР 
	|		КОГДА Строки.КорСтатьяРасходов.ПринятиеКНалоговомуУчету = ЛОЖЬ 
	|			ТОГДА Строки.СтоимостьНУ 
	|		ИНАЧЕ 0 
	|	КОНЕЦ + Строки.СтоимостьПР КАК СуммаПРДт,
	|	Строки.СтоимостьВР КАК СуммаВРДт,
	|	
	|	// Кт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СтоимостьВНА) КАК ВидСчетаКт,
	|	Строки.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	Строки.НематериальныйАктив КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|
	|	ВЫБОР 
	|		КОГДА Строки.КорСтатьяРасходов.ПринятиеКНалоговомуУчету = ИСТИНА 
	|			ТОГДА Строки.СтоимостьНУ 
	|		ИНАЧЕ 0 
	|	КОНЕЦ КАК СуммаНУКт,
	|	ВЫБОР 
	|		КОГДА Строки.КорСтатьяРасходов.ПринятиеКНалоговомуУчету = ЛОЖЬ 
	|			ТОГДА Строки.СтоимостьНУ 
	|		ИНАЧЕ 0 
	|	КОНЕЦ + Строки.СтоимостьПР КАК СуммаПРКт,
	|	Строки.СтоимостьВР КАК СуммаВРКт,
	|	
	|	/////////////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	""Списание расходов на НИОКР"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.СтоимостьНМА КАК Строки
	|	ПО Строки.Регистратор = ДокументыКОтражению.Ссылка
	|	
	|ГДЕ
	|	Строки.НастройкаХозяйственнойОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СписаниеНаРасходыНИОКРВДругуюОрганизацию)
	|
	|	И (Строки.Стоимость <> 0
	|		ИЛИ Строки.СтоимостьРегл <> 0
	|		ИЛИ Строки.СтоимостьНУ <> 0
	|		ИЛИ Строки.СтоимостьПР <> 0
	|		ИЛИ Строки.СтоимостьВР <> 0)";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область СписаниеРасходовНаНИОКР_Получатель
	
	ТекстЗапроса =
	"////////////////////////////////////////////////////////////////////////////////////////////////////
	|// Амортизация (Дт СчетУчетаЗатрат :: Кт РасчетыПоТекущимОперациям)
	|ВЫБРАТЬ
	|	
	|	Строки.Регистратор КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.КорОрганизация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|	
	|	Строки.СтоимостьРегл КАК Сумма,
	|	Строки.Стоимость КАК СуммаУУ,
	|	
	|	// Дт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаДт,
	|	Строки.КорСтатьяРасходов КАК АналитикаУчетаДт,
	|	Строки.КорПодразделение КАК МестоУчетаДт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.КорПодразделение КАК ПодразделениеДт,
	|	Строки.КорНаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	Строки.КорСтатьяРасходов КАК СубконтоДт1,
	|	Строки.КорАналитикаРасходов КАК СубконтоДт2,
	|	ВЫБОР КОГДА СтатьиСтроительства.Ссылка ЕСТЬ НЕ NULL ТОГДА
	|			ВЫБОР КОГДА ОбъектыСтроительства.СпособСтроительства <> ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.ПустаяСсылка) 
	|					ТОГДА ОбъектыСтроительства.СпособСтроительства
	|				ИНАЧЕ 
	|					ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.Хозспособ) 
	|			КОНЕЦ
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее)
	|	КОНЕЦ КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|
	|	ВЫБОР 
	|		КОГДА Строки.КорСтатьяРасходов.ПринятиеКНалоговомуУчету = ИСТИНА 
	|			ТОГДА Строки.СтоимостьНУ 
	|		ИНАЧЕ 0 
	|	КОНЕЦ КАК СуммаНУДт,
	|	ВЫБОР 
	|		КОГДА Строки.КорСтатьяРасходов.ПринятиеКНалоговомуУчету = ЛОЖЬ 
	|			ТОГДА Строки.СтоимостьНУ 
	|		ИНАЧЕ 0 
	|	КОНЕЦ + Строки.СтоимостьПР КАК СуммаПРДт,
	|	Строки.СтоимостьВР КАК СуммаВРДт,
	|	
	|	// Кт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоТекущимОперациям) КАК СчетКт,
	|	Строки.Организация КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|
	|	ВЫБОР 
	|		КОГДА Строки.КорСтатьяРасходов.ПринятиеКНалоговомуУчету = ИСТИНА 
	|			ТОГДА Строки.СтоимостьНУ 
	|		ИНАЧЕ 0 
	|	КОНЕЦ КАК СуммаНУКт,
	|	ВЫБОР 
	|		КОГДА Строки.КорСтатьяРасходов.ПринятиеКНалоговомуУчету = ЛОЖЬ 
	|			ТОГДА Строки.СтоимостьНУ 
	|		ИНАЧЕ 0 
	|	КОНЕЦ + Строки.СтоимостьПР КАК СуммаПРКт,
	|	Строки.СтоимостьВР КАК СуммаВРКт,
	|	
	|	""Списание расходов на НИОКР"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.СтоимостьНМА КАК Строки
	|	ПО Строки.Регистратор = ДокументыКОтражению.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиСтроительства
	|	ПО Строки.КорСтатьяРасходов = СтатьиСтроительства.Ссылка
	|		И СтатьиСтроительства.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиНаПрочиеАктивы
	|	ПО Строки.КорСтатьяРасходов = СтатьиНаПрочиеАктивы.Ссылка
	|		И СтатьиНаПрочиеАктивы.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы)
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ОбъектыСтроительства КАК ОбъектыСтроительства
	|	ПО ОбъектыСтроительства.Ссылка = Строки.КорАналитикаРасходов
	|
	|ГДЕ
	|	Строки.НастройкаХозяйственнойОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СписаниеНаРасходыНИОКРВДругуюОрганизацию)
	|	И СтатьиНаПрочиеАктивы.Ссылка ЕСТЬ NULL
	|
	|	И (Строки.Стоимость <> 0
	|		ИЛИ Строки.СтоимостьРегл <> 0
	|		ИЛИ Строки.СтоимостьНУ <> 0
	|		ИЛИ Строки.СтоимостьПР <> 0
	|		ИЛИ Строки.СтоимостьВР <> 0)";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
	#КонецОбласти
		
	#КонецОбласти
	
	#Область Обесценение
	
	#Область КорректировкаОбесцененияНМА // (Дт <ОбесценениеВНА> :: Кт <АмортизацияВНА>
	ТекстЗапроса =
	"////////////////////////////////////////////////////////////////////////////////////////////////////
	|// Корректировка обесценения НМА (Дт ОбесценениеВНА :: Кт АмортизацияВНА)
	|ВЫБРАТЬ
	|	
	|	Строки.Регистратор КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|	
	|	Строки.АмортизацияРегл КАК Сумма,
	|	Строки.Амортизация КАК СуммаУУ,
	|	
	|	// Дт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ОбесценениеВНА) КАК ВидСчетаДт,
	|	Строки.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	Строки.НематериальныйАктив КАК СубконтоДт1,
	|	Строки.Подразделение КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|
	|	Строки.АмортизацияНУ КАК СуммаНУДт,
	|	Строки.АмортизацияПР КАК СуммаПРДт,
	|	Строки.АмортизацияВР КАК СуммаВРДт,
	|	
	|	// Кт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АмортизацияВНА) КАК ВидСчетаКт,
	|	Строки.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	Строки.НематериальныйАктив КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|
	|	Строки.АмортизацияНУ КАК СуммаНУКт,
	|	Строки.АмортизацияПР КАК СуммаПРКт,
	|	Строки.АмортизацияВР КАК СуммаВРКт,
	|	
	|	""Корректировка обесценения"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.АмортизацияНМА КАК Строки
	|		ПО Строки.Регистратор = ДокументыКОтражению.Ссылка
	|
	|ГДЕ
	|	Строки.НастройкаХозяйственнойОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.КорректировкаОбесцененияНМА)
	|
	|	И (Строки.Амортизация <> 0
	|		ИЛИ Строки.АмортизацияРегл <> 0)";
	СписокЗапросов.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область КорректировкаОбесцененияНМА_ЦФ // (Дт <ОбесценениеВНА> :: Кт <АмортизацияВНА_ЦФ>
	ТекстЗапроса =
	"////////////////////////////////////////////////////////////////////////////////////////////////////
	|// Корректировка обесценения НМА (Дт ОбесценениеВНА :: Кт АмортизацияВНА_ЦФ)
	|ВЫБРАТЬ
	|	
	|	Строки.Регистратор КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|	
	|	Строки.АмортизацияЦФ КАК Сумма,
	|	0 КАК СуммаУУ,
	|	
	|	// Дт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ОбесценениеВНА) КАК ВидСчетаДт,
	|	Строки.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	Строки.НематериальныйАктив КАК СубконтоДт1,
	|	Строки.Подразделение КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|
	|	Строки.АмортизацияНУЦФ КАК СуммаНУДт,
	|	Строки.АмортизацияПРЦФ КАК СуммаПРДт,
	|	Строки.АмортизацияВРЦФ КАК СуммаВРДт,
	|	
	|	// Кт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АмортизацияВНА_ЦФ) КАК ВидСчетаКт,
	|	Строки.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	Строки.НематериальныйАктив КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|
	|	Строки.АмортизацияНУЦФ КАК СуммаНУКт,
	|	Строки.АмортизацияПРЦФ КАК СуммаПРКт,
	|	Строки.АмортизацияВРЦФ КАК СуммаВРКт,
	|	
	|	""Корректировка обесценения"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.АмортизацияНМА КАК Строки
	|		ПО Строки.Регистратор = ДокументыКОтражению.Ссылка
	|
	|ГДЕ
	|	Строки.НастройкаХозяйственнойОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.КорректировкаОбесцененияНМА)
	|	И Строки.АмортизацияЦФ <> 0";
	СписокЗапросов.Добавить(ТекстЗапроса);
	#КонецОбласти

	#Область КорректировкаОбесцененияРасходыНаНИОКР // (Дт <ОбесценениеВНА> :: Кт <СтоимостьВНА>
	ТекстЗапроса =
	"////////////////////////////////////////////////////////////////////////////////////////////////////
	|// Корректировка обесценения НМА (Дт ОбесценениеВНА :: Кт АмортизацияВНА)
	|ВЫБРАТЬ
	|	
	|	Строки.Регистратор КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|	
	|	Строки.СтоимостьРегл КАК Сумма,
	|	Строки.Стоимость КАК СуммаУУ,
	|	
	|	// Дт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ОбесценениеВНА) КАК ВидСчетаДт,
	|	Строки.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	Строки.НематериальныйАктив КАК СубконтоДт1,
	|	Строки.Подразделение КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|
	|	Строки.СтоимостьНУ КАК СуммаНУДт,
	|	Строки.СтоимостьПР КАК СуммаПРДт,
	|	Строки.СтоимостьВР КАК СуммаВРДт,
	|	
	|	// Кт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СтоимостьВНА) КАК ВидСчетаКт,
	|	Строки.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	Строки.НематериальныйАктив КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|
	|	Строки.СтоимостьНУ КАК СуммаНУКт,
	|	Строки.СтоимостьПР КАК СуммаПРКт,
	|	Строки.СтоимостьВР КАК СуммаВРКт,
	|	
	|	""Корректировка обесценения"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.СтоимостьНМА КАК Строки
	|		ПО Строки.Регистратор = ДокументыКОтражению.Ссылка
	|
	|ГДЕ
	|	Строки.НастройкаХозяйственнойОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.КорректировкаОбесцененияНМА)
	|
	|	И (Строки.Стоимость <> 0
	|		ИЛИ Строки.СтоимостьРегл <> 0)";
	СписокЗапросов.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область КорректировкаОбесцененияРасходыНаНИОКР_ЦФ // (Дт <ОбесценениеВНА> :: Кт <СтоимостьВНА_ЦФ>
	ТекстЗапроса =
	"////////////////////////////////////////////////////////////////////////////////////////////////////
	|// Корректировка обесценения НМА (Дт ОбесценениеВНА :: Кт АмортизацияВНА)
	|ВЫБРАТЬ
	|	
	|	Строки.Регистратор КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|	
	|	Строки.СтоимостьЦФ КАК Сумма,
	|	0 КАК СуммаУУ,
	|	
	|	// Дт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ОбесценениеВНА) КАК ВидСчетаДт,
	|	Строки.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	Строки.НематериальныйАктив КАК СубконтоДт1,
	|	Строки.Подразделение КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|
	|	Строки.СтоимостьНУЦФ КАК СуммаНУДт,
	|	Строки.СтоимостьПРЦФ КАК СуммаПРДт,
	|	Строки.СтоимостьВРЦФ КАК СуммаВРДт,
	|	
	|	// Кт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.СтоимостьВНА_ЦФ) КАК ВидСчетаКт,
	|	Строки.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	Строки.НематериальныйАктив КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|
	|	Строки.СтоимостьНУЦФ КАК СуммаНУКт,
	|	Строки.СтоимостьПРЦФ КАК СуммаПРКт,
	|	Строки.СтоимостьВРЦФ КАК СуммаВРКт,
	|	
	|	""Корректировка обесценения"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.СтоимостьНМА КАК Строки
	|		ПО Строки.Регистратор = ДокументыКОтражению.Ссылка
	|
	|ГДЕ
	|	Строки.НастройкаХозяйственнойОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.КорректировкаОбесцененияНМА)
	|	И Строки.СтоимостьЦФ <> 0";
	СписокЗапросов.Добавить(ТекстЗапроса);
	#КонецОбласти

	#Область СторноОбесценения // (Дт <Расходы> :: Кт <ОбесценениеВНА>
	ТекстЗапроса =
	"////////////////////////////////////////////////////////////////////////////////////////////////////
	|// Сторно обесценения (Дт Расходы :: Кт ОбесценениеВНА)
	|ВЫБРАТЬ
	|	
	|	СтрокиДт.Регистратор КАК Ссылка,
	|	СтрокиДт.Период КАК Период,
	|	СтрокиДт.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|	
	|	СтрокиДт.СуммаРегл КАК Сумма,
	|	СтрокиДт.Сумма КАК СуммаУУ,
	|	
	|	// Дт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаДт,
	|	СтрокиДт.СтатьяРасходов КАК АналитикаУчетаДт,
	|	СтрокиДт.Подразделение КАК МестоУчетаДт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	СтрокиДт.Подразделение КАК ПодразделениеДт,
	|	СтрокиДт.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	СтрокиДт.СтатьяРасходов КАК СубконтоДт1,
	|	СтрокиДт.АналитикаРасходов КАК СубконтоДт2,
	|	ВЫБОР КОГДА СтатьиСтроительства.Ссылка ЕСТЬ НЕ NULL ТОГДА
	|			ВЫБОР КОГДА ОбъектыСтроительства.СпособСтроительства <> ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.ПустаяСсылка) 
	|					ТОГДА ОбъектыСтроительства.СпособСтроительства
	|				ИНАЧЕ 
	|					ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.Хозспособ) 
	|			КОНЕЦ
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее)
	|	КОНЕЦ КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|
	|	ВЫБОР 
	|		КОГДА СтрокиДт.СтатьяРасходов.ПринятиеКНалоговомуУчету = ИСТИНА 
	|			ТОГДА СтрокиДт.СуммаРегл - СтрокиДт.ПостояннаяРазница - СтрокиДт.ВременнаяРазница 
	|		ИНАЧЕ 0 
	|	КОНЕЦ КАК СуммаНУДт,
	|	ВЫБОР 
	|		КОГДА СтрокиДт.СтатьяРасходов.ПринятиеКНалоговомуУчету = ЛОЖЬ 
	|			ТОГДА СтрокиДт.СуммаРегл - СтрокиДт.ПостояннаяРазница - СтрокиДт.ВременнаяРазница 
	|		ИНАЧЕ 0 
	|	КОНЕЦ + СтрокиДт.ПостояннаяРазница КАК СуммаПРДт,
	|	СтрокиДт.ВременнаяРазница КАК СуммаВРДт,
	|	
	|	// Кт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ОбесценениеВНА) КАК ВидСчетаКт,
	|	СтрокиКт.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	СтрокиКт.Подразделение КАК ПодразделениеКт,
	|	СтрокиКт.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	СтрокиКт.ВнеоборотныйАктив КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	СтрокиКт.ОбесценениеРегл КАК СуммаВРКт,
	|	
	|	""Сторно обесценения"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.ПрочиеРасходы КАК СтрокиДт
	|		ПО СтрокиДт.Регистратор = ДокументыКОтражению.Ссылка
	|
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.ОбесценениеВНА КАК СтрокиКт
	|		ПО СтрокиКт.Регистратор = СтрокиДт.Регистратор
	|			И СтрокиКт.НастройкаХозяйственнойОперации = СтрокиДт.НастройкаХозяйственнойОперации
	|			И СтрокиКт.ИдентификаторФинЗаписи = СтрокиДт.ИдентификаторФинЗаписи
	|	
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиСтроительства
	|		ПО СтрокиДт.СтатьяРасходов = СтатьиСтроительства.Ссылка
	|			И СтатьиСтроительства.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|	
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиНаПрочиеАктивы
	|		ПО СтрокиДт.СтатьяРасходов = СтатьиНаПрочиеАктивы.Ссылка
	|			И СтатьиНаПрочиеАктивы.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы)
	|	
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ОбъектыСтроительства КАК ОбъектыСтроительства
	|		ПО ОбъектыСтроительства.Ссылка = СтрокиДт.АналитикаРасходов
	|
	|ГДЕ
	|	СтрокиДт.НастройкаХозяйственнойОперации В (
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СторноОбесцененияНМА),
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СторноОбесцененияНИОКР))";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область СторноОбесцененияОтправитель // (Дт <РасчетыПоТекущимОперациям> :: Кт <ОбесценениеВНА>
	ТекстЗапроса =
	"////////////////////////////////////////////////////////////////////////////////////////////////////
	|// Сторно обесценения (Дт РасчетыПоТекущимОперациям :: Кт ОбесценениеВНА)
	|ВЫБРАТЬ
	|	
	|	Строки.Регистратор КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|	
	|	Строки.ОбесценениеРегл КАК Сумма,
	|	Строки.ОбесценениеУпр КАК СуммаУУ,
	|	
	|	// Дт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоТекущимОперациям) КАК СчетДт,
	|	СтрокиДт.Организация КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	Строки.ОбесценениеРегл КАК СуммаВРДт,
	|	
	|	// Кт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ОбесценениеВНА) КАК ВидСчетаКт,
	|	Строки.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	Строки.ВнеоборотныйАктив КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	Строки.ОбесценениеРегл КАК СуммаВРКт,
	|	
	|	""Сторно обесценения"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.ОбесценениеВНА КАК Строки
	|		ПО Строки.Регистратор = ДокументыКОтражению.Ссылка
	|
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.ПрочиеРасходы КАК СтрокиДт
	|		ПО СтрокиДт.Регистратор = Строки.Регистратор
	|			И СтрокиДт.НастройкаХозяйственнойОперации = Строки.НастройкаХозяйственнойОперации
	|			И СтрокиДт.ИдентификаторФинЗаписи = Строки.ИдентификаторФинЗаписи
	|
	|ГДЕ
	|	Строки.НастройкаХозяйственнойОперации В (
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СторноОбесцененияНМАВДругуюОрганизацию),
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СторноОбесцененияНИОКРВДругуюОрганизацию))";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область СторноОбесцененияПолучатель // (Дт <Расходы> :: Кт <РасчетыПоТекущимОперациям>
	ТекстЗапроса =
	"////////////////////////////////////////////////////////////////////////////////////////////////////
	|// Сторно обесценения (Дт Расходы :: Кт РасчетыПоТекущимОперациям)
	|ВЫБРАТЬ
	|	
	|	Строки.Регистратор КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|	
	|	Строки.СуммаРегл КАК Сумма,
	|	Строки.Сумма КАК СуммаУУ,
	|	
	|	// Дт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаДт,
	|	Строки.СтатьяРасходов КАК АналитикаУчетаДт,
	|	Строки.Подразделение КАК МестоУчетаДт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|	Строки.СтатьяРасходов КАК СубконтоДт1,
	|	Строки.АналитикаРасходов КАК СубконтоДт2,
	|	ВЫБОР КОГДА СтатьиСтроительства.Ссылка ЕСТЬ НЕ NULL ТОГДА
	|			ВЫБОР КОГДА ОбъектыСтроительства.СпособСтроительства <> ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.ПустаяСсылка) 
	|					ТОГДА ОбъектыСтроительства.СпособСтроительства
	|				ИНАЧЕ 
	|					ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.Хозспособ) 
	|			КОНЕЦ
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее)
	|	КОНЕЦ КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|
	|	ВЫБОР 
	|		КОГДА Строки.СтатьяРасходов.ПринятиеКНалоговомуУчету = ИСТИНА 
	|			ТОГДА Строки.СуммаРегл - Строки.ПостояннаяРазница - Строки.ВременнаяРазница 
	|		ИНАЧЕ 0 
	|	КОНЕЦ КАК СуммаНУДт,
	|	ВЫБОР 
	|		КОГДА Строки.СтатьяРасходов.ПринятиеКНалоговомуУчету = ЛОЖЬ 
	|			ТОГДА Строки.СуммаРегл - Строки.ПостояннаяРазница - Строки.ВременнаяРазница 
	|		ИНАЧЕ 0 
	|	КОНЕЦ + Строки.ПостояннаяРазница КАК СуммаПРДт,
	|	Строки.ВременнаяРазница КАК СуммаВРДт,
	|	
	|	// Кт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.Подразделение КАК ПодразделениеКт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.РасчетыПоТекущимОперациям) КАК СчетКт,
	|	СтрокиКт.Организация КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	СтрокиКт.ОбесценениеРегл КАК СуммаВРКт,
	|	
	|	""Сторно обесценения"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.ПрочиеРасходы КАК Строки
	|		ПО Строки.Регистратор = ДокументыКОтражению.Ссылка
	|
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.ОбесценениеВНА КАК СтрокиКт
	|		ПО СтрокиКт.Регистратор = Строки.Регистратор
	|			И СтрокиКт.НастройкаХозяйственнойОперации = Строки.НастройкаХозяйственнойОперации
	|			И СтрокиКт.ИдентификаторФинЗаписи = Строки.ИдентификаторФинЗаписи
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиСтроительства
	|		ПО Строки.СтатьяРасходов = СтатьиСтроительства.Ссылка
	|			И СтатьиСтроительства.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|	
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиНаПрочиеАктивы
	|		ПО Строки.СтатьяРасходов = СтатьиНаПрочиеАктивы.Ссылка
	|			И СтатьиНаПрочиеАктивы.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы)
	|	
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ОбъектыСтроительства КАК ОбъектыСтроительства
	|		ПО ОбъектыСтроительства.Ссылка = Строки.АналитикаРасходов
	|
	|ГДЕ
	|	Строки.НастройкаХозяйственнойОперации В (
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СторноОбесцененияНМАВДругуюОрганизацию),
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СторноОбесцененияНИОКРВДругуюОрганизацию))";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#КонецОбласти
	
	#Область ДоходыОтЦелевогоФинансирования
	
	#Область ДоходыОтЦелевогоФинансирования_НМА_Дт_98__Кт_91
	
	ТекстЗапроса =
	"////////////////////////////////////////////////////////////////////////////////////////////////////
	|// Признание доходов от целевого финансирования (Дт 98 :: Кт 91)
	|ВЫБРАТЬ
	|	
	|	Строки.Регистратор КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|	
	|	Строки.АмортизацияЦФ КАК Сумма,
	|	0 КАК СуммаУУ,
	|	
	|	// Дт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходыБудущихПериодовОтЦелевогоФинансированияНМА) КАК СчетДт,
	|	Строки.НематериальныйАктив КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|
	|	0 КАК СуммаНУДт,
	|	Строки.АмортизацияНУЦФ + Строки.АмортизацияПРЦФ + Строки.АмортизацияВРЦФ КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	// Кт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Доходы) КАК ВидСчетаКт,
	|	ПараметрыЦелевогоФинансированияНМА.СтатьяДоходов КАК АналитикаУчетаКт,
	|	Строки.КорПодразделение КАК МестоУчетаКт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.КорПодразделение КАК ПодразделениеКт,
	|	Строки.КорНаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	ПараметрыЦелевогоФинансированияНМА.СтатьяДоходов КАК СубконтоКт1,
	|	ПараметрыЦелевогоФинансированияНМА.АналитикаДоходов КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(СтатьиДоходов.ПринятиеКНалоговомуУчету, ИСТИНА)
	|			ТОГДА Строки.АмортизацияНУЦФ + Строки.АмортизацияПРЦФ + Строки.АмортизацияВРЦФ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаНУКт,
	|
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(СтатьиДоходов.ПринятиеКНалоговомуУчету, ИСТИНА)
	|			ТОГДА 0
	|		ИНАЧЕ Строки.АмортизацияНУЦФ + Строки.АмортизацияПРЦФ + Строки.АмортизацияВРЦФ
	|	КОНЕЦ КАК СуммаПРКт,
	|
	|	0 КАК СуммаВРКт,
	|	
	|	/////////////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	""Признание доходов от целевого финансирования"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.АмортизацияНМА КАК Строки
	|		ПО Строки.Регистратор = ДокументыКОтражению.Ссылка
	|	
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ втПараметрыЦелевогоФинансированияНМА КАК ПараметрыЦелевогоФинансированияНМА
	|		ПО Строки.Регистратор = ПараметрыЦелевогоФинансированияНМА.Ссылка
	|			И Строки.НематериальныйАктив = ПараметрыЦелевогоФинансированияНМА.НематериальныйАктив
	|			И Строки.Организация = ПараметрыЦелевогоФинансированияНМА.Организация
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиДоходов КАК СтатьиДоходов
	|		ПО СтатьиДоходов.Ссылка = ПараметрыЦелевогоФинансированияНМА.СтатьяДоходов
	|
	|ГДЕ
	|	(Строки.АмортизацияЦФ <> 0
	|		ИЛИ Строки.АмортизацияНУЦФ <> 0
	|		ИЛИ Строки.АмортизацияПРЦФ <> 0
	|		ИЛИ Строки.АмортизацияВРЦФ <> 0)";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область ДоходыОтЦелевогоФинансирования_НИОКР_Дт_98__Кт_91
	
	ТекстЗапроса =
	"////////////////////////////////////////////////////////////////////////////////////////////////////
	|// Признание доходов от целевого финансирования (Дт 98 :: Кт 91)
	|ВЫБРАТЬ
	|	
	|	Строки.Регистратор КАК Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|	
	|	Строки.СтоимостьЦФ КАК Сумма,
	|	0 КАК СуммаУУ,
	|	
	|	// Дт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаДт,
	|	Строки.Подразделение КАК ПодразделениеДт,
	|	Строки.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ДоходыБудущихПериодовОтЦелевогоФинансированияНМА) КАК СчетДт,
	|	Строки.НематериальныйАктив КАК СубконтоДт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|
	|	0 КАК СуммаНУДт,
	|	Строки.СтоимостьНУЦФ + Строки.СтоимостьПРЦФ + Строки.СтоимостьВРЦФ КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	// Кт ///////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Доходы) КАК ВидСчетаКт,
	|	ПараметрыЦелевогоФинансированияНМА.СтатьяДоходов КАК АналитикаУчетаКт,
	|	Строки.КорПодразделение КАК МестоУчетаКт,
	|	
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка) КАК ВалютаКт,
	|	Строки.КорПодразделение КАК ПодразделениеКт,
	|	Строки.КорНаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|	
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	ПараметрыЦелевогоФинансированияНМА.СтатьяДоходов КАК СубконтоКт1,
	|	ПараметрыЦелевогоФинансированияНМА.АналитикаДоходов КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(СтатьиДоходов.ПринятиеКНалоговомуУчету, ИСТИНА)
	|			ТОГДА Строки.СтоимостьНУЦФ + Строки.СтоимостьПРЦФ + Строки.СтоимостьВРЦФ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаНУКт,
	|
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(СтатьиДоходов.ПринятиеКНалоговомуУчету, ИСТИНА)
	|			ТОГДА 0
	|		ИНАЧЕ Строки.СтоимостьНУЦФ + Строки.СтоимостьПРЦФ + Строки.СтоимостьВРЦФ
	|	КОНЕЦ КАК СуммаПРКт,
	|
	|	0 КАК СуммаВРКт,
	|	
	|	/////////////////////////////////////////////////////////////////////////////////////////////////
	|	
	|	""Признание доходов от целевого финансирования"" КАК Содержание
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.СтоимостьНМА КАК Строки
	|		ПО Строки.Регистратор = ДокументыКОтражению.Ссылка
	|	
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ втПараметрыЦелевогоФинансированияНМА КАК ПараметрыЦелевогоФинансированияНМА
	|		ПО Строки.Регистратор = ПараметрыЦелевогоФинансированияНМА.Ссылка
	|			И Строки.НематериальныйАктив = ПараметрыЦелевогоФинансированияНМА.НематериальныйАктив
	|			И Строки.Организация = ПараметрыЦелевогоФинансированияНМА.Организация
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиДоходов КАК СтатьиДоходов
	|		ПО СтатьиДоходов.Ссылка = ПараметрыЦелевогоФинансированияНМА.СтатьяДоходов
	|
	|ГДЕ
	|	(Строки.СтоимостьЦФ <> 0
	|		ИЛИ Строки.СтоимостьНУЦФ <> 0
	|		ИЛИ Строки.СтоимостьПРЦФ <> 0
	|		ИЛИ Строки.СтоимостьВРЦФ <> 0)";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#КонецОбласти

	ТекстЗапроса = СтрСоединить(СписокЗапросов, ОбщегоНазначенияУТ.РазделительЗапросовВОбъединении());

	//-- Локализация
	
	Возврат ТекстЗапроса;
	
КонецФункции

// Функция возвращает текст запроса дополнительных временных таблиц,
// необходимых для отражения в регламентированном учете
//
// Возвращаемое значение:
//   Строка - сформированный текст запроса.
//
Функция ТекстЗапросаВТОтраженияВРеглУчете() Экспорт
	
	ТекстЗапроса = "";
	
	//++ Локализация

	СписокЗапросов = Новый Массив;
	
	#Область втПараметрыЦелевогоФинансированияНМА
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ДокументыКОтражению.Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	Строки.НематериальныйАктив КАК НематериальныйАктив
	|ПОМЕСТИТЬ втСписокНМА
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.АмортизацияНМА КАК Строки
	|		ПО (Строки.Регистратор = ДокументыКОтражению.Ссылка)
	|ГДЕ
	|	(Строки.АмортизацияЦФ <> 0
	|			ИЛИ Строки.АмортизацияНУЦФ <> 0
	|			ИЛИ Строки.АмортизацияПРЦФ <> 0
	|			ИЛИ Строки.АмортизацияВРЦФ <> 0)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ДокументыКОтражению.Ссылка,
	|	Строки.Период КАК Период,
	|	Строки.Организация КАК Организация,
	|	Строки.НематериальныйАктив КАК НематериальныйАктив
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.СтоимостьНМА КАК Строки
	|		ПО (Строки.Регистратор = ДокументыКОтражению.Ссылка)
	|ГДЕ
	|	(Строки.СтоимостьЦФ <> 0
	|			ИЛИ Строки.СтоимостьНУЦФ <> 0
	|			ИЛИ Строки.СтоимостьПРЦФ <> 0
	|			ИЛИ Строки.СтоимостьВРЦФ <> 0)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	НематериальныйАктив
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ПараметрыЦелевогоФинансированияНМА.Ссылка КАК Ссылка,
	|	ПараметрыЦелевогоФинансированияНМА.Организация КАК Организация,
	|	ПараметрыЦелевогоФинансированияНМА.НематериальныйАктив КАК НематериальныйАктив,
	|	ПараметрыЦелевогоФинансированияНМАПоследнее.СтатьяДоходов,
	|	ПараметрыЦелевогоФинансированияНМАПоследнее.АналитикаДоходов
	|ПОМЕСТИТЬ втПараметрыЦелевогоФинансированияНМА
	|ИЗ
	|	(ВЫБРАТЬ
	|		СписокНМА.Ссылка КАК Ссылка,
	|		СписокНМА.Организация КАК Организация,
	|		СписокНМА.НематериальныйАктив КАК НематериальныйАктив,
	|		МАКСИМУМ(ПараметрыЦелевогоФинансированияНМА.Период) КАК ПоследнийПериод
	|	ИЗ
	|		втСписокНМА КАК СписокНМА
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ПараметрыЦелевогоФинансированияНМА КАК ПараметрыЦелевогоФинансированияНМА
	|			ПО СписокНМА.НематериальныйАктив = ПараметрыЦелевогоФинансированияНМА.НематериальныйАктив
	|	
	|	СГРУППИРОВАТЬ ПО
	|		СписокНМА.Ссылка,
	|		СписокНМА.Организация,
	|		СписокНМА.НематериальныйАктив) КАК ПараметрыЦелевогоФинансированияНМА
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ПараметрыЦелевогоФинансированияНМА КАК ПараметрыЦелевогоФинансированияНМАПоследнее
	|		ПО ПараметрыЦелевогоФинансированияНМА.НематериальныйАктив = ПараметрыЦелевогоФинансированияНМАПоследнее.НематериальныйАктив
	|			И ПараметрыЦелевогоФинансированияНМА.ПоследнийПериод = ПараметрыЦелевогоФинансированияНМАПоследнее.Период
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка,
	|	Организация,
	|	НематериальныйАктив";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	СписокЗапросов.Добавить(Символы.ПС);
	
	ТекстЗапроса = СтрСоединить(СписокЗапросов, ОбщегоНазначения.РазделительПакетаЗапросов());

	//-- Локализация
	
	Возврат ТекстЗапроса;
	
КонецФункции

#КонецОбласти

#Область Проведение

// Процедура дополняет тексты запросов проведения документа.
//
// Параметры:
//  Запрос - Запрос - Общий запрос проведения документа.
//  ТекстыЗапроса - СписокЗначений - Список текстов запроса проведения.
//  Регистры - Строка, Структура - Список регистров проведения документа через запятую или в ключах структуры.
//
Процедура ДополнитьТекстыЗапросовПроведения(Запрос, ТекстыЗапроса, Регистры) Экспорт
	
	//++ Локализация
	
	ТекстЗапросаТаблицаПрочиеДоходы(Запрос, ТекстыЗапроса, Регистры);
	ВнеоборотныеАктивыЛокализация.ТекстЗапросаТаблицаОтражениеДокументовВРеглУчете_Амортизация(Запрос, ТекстыЗапроса, Регистры);
	
	//-- Локализация
	
КонецПроцедуры

#КонецОбласти

#Область ФормаДокумента

Процедура ПриСозданииНаСервере(Форма) Экспорт

	//++ Локализация
	
	Если НЕ ПолучитьФункциональнуюОпцию("УправлениеПредприятием") 
		//++ НЕ УТКА
		ИЛИ НЕ ПравоДоступа("Просмотр", Метаданные.РегистрыБухгалтерии.Международный) 
		//-- НЕ УТКА
		Тогда
		Форма.Элементы.ФормаПроводкиМеждУчета.Видимость = Ложь;
	КонецЕсли; 
	
	//-- Локализация
	
КонецПроцедуры

#КонецОбласти

#Область ФормаРасчетАмортизации

Процедура ДополнитьСлужебныеПараметрыФормыРасчетАмортизации(Знач СлужебныеПараметры) Экспорт

	//++ Локализация
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	АмортизацияНМА2_4.Ссылка КАК Ссылка,
	|	АмортизацияНМА2_4.Организация КАК Организация,
	|	АмортизацияНМА2_4.НомерПакета,
	|	АмортизацияНМА2_4.Дата КАК Дата
	|ИЗ
	|	Документ.АмортизацияНМА2_4 КАК АмортизацияНМА2_4
	|ГДЕ
	|	АмортизацияНМА2_4.Ссылка В(&СписокДокументов)
	|	И НЕ АмортизацияНМА2_4.ПометкаУдаления
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	АмортизацияНМА.Ссылка,
	|	АмортизацияНМА.Организация,
	|	0,
	|	АмортизацияНМА.Дата КАК Дата
	|ИЗ
	|	Документ.АмортизацияНМА КАК АмортизацияНМА
	|ГДЕ
	|	АмортизацияНМА.Ссылка В(&СписокДокументов)
	|	И НЕ АмортизацияНМА.ПометкаУдаления
	|
	|УПОРЯДОЧИТЬ ПО
	|	Дата,
	|	Организация";
	
	СлужебныеПараметры.Вставить("ТекстЗапроса", ТекстЗапроса);
	
	СлужебныеПараметры.СобытияЗаписи.Добавить("Запись_АмортизацияНМА");
	СлужебныеПараметры.ТипыДокументов.Добавить("ДокументСсылка.АмортизацияНМА");
	
	//-- Локализация
	
КонецПроцедуры

#КонецОбласти

#Область РасчетАмортизации

// 
// Параметры:
//  ПараметрыРасчета - см. РасчетАмортизацииНМА.ПараметрыВыполнения
//
Процедура ВыполнитьРасчетАмортизации(ПараметрыРасчета) Экспорт

	//++ Локализация
	
	ПараметрыРасчета.ИспользуемыеТаблицы = ПараметрыРасчета.ИспользуемыеТаблицы + ",РасчетАмортизации_БУ";
	
	ИспользуемыеТаблицы = ОбщегоНазначенияУТ.СписокВременныхТаблиц(ПараметрыРасчета.МенеджерВременныхТаблиц);
	Для Каждого ИмяТаблицы Из СтрРазделить(ПараметрыРасчета.ИспользуемыеТаблицы, ",") Цикл
		ИспользуемыеТаблицы.Добавить(ИмяТаблицы);
	КонецЦикла;
	
	ДоначислитьАмортизациюБУЗаПрошлыйМесяц(ПараметрыРасчета);
	РассчитатьАмортизациюБУЗаТекущийМесяц(ПараметрыРасчета);
	
	РассчитатьАмортизациюНУ(ПараметрыРасчета);

	ОбъединитьРасчетАмортизацииБУНУ(ПараметрыРасчета);

	ВернутьПараметрыРасчета(ПараметрыРасчета);
	
	ОбщегоНазначенияУТ.УничтожитьВременныеТаблицы(ПараметрыРасчета.МенеджерВременныхТаблиц,, ИспользуемыеТаблицы);
	
	//-- Локализация
	
КонецПроцедуры

#Область ФормированиеТекстаРасчетаАмортизации

// 
// Параметры:
//  СписокЗапросов - Массив из Строка - 
//  ПараметрыРасчета - см. РасчетАмортизацииНМА.ПараметрыВыполнения
Процедура ДополнитьТекстЗапросаСписокВсехНМА(СписокЗапросов, ПараметрыРасчета) Экспорт

	//++ Локализация
	
	#Область СписокОбъектовУчета_Доначисление_БУ
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	СтоимостьНМА.Организация КАК Организация,
	|	СтоимостьНМА.НематериальныйАктив КАК НематериальныйАктив,
	|	МИНИМУМ(СтоимостьНМА.Период) КАК Период
	|
	|ПОМЕСТИТЬ СписокОбъектовУчета_Доначисление_БУ
	|
	|ИЗ
	|	РегистрНакопления.СтоимостьНМА КАК СтоимостьНМА
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетнаяПолитикаБухУчета.СрезПоследних(&КонецПредыдущегоМесяца) КАК УчетнаяПолитикаБУ
	|		ПО УчетнаяПолитикаБУ.Организация = СтоимостьНМА.Организация.ГоловнаяОрганизация
	|ГДЕ
	|	СтоимостьНМА.Период МЕЖДУ &НачалоПредыдущегоМесяца И &КонецПредыдущегоМесяца
	|	И СтоимостьНМА.ОтражатьВРеглУчете
	|	И СтоимостьНМА.Активность
	|	И СтоимостьНМА.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|
	|	И СтоимостьНМА.НематериальныйАктив.ВидОбъектаУчета = ЗНАЧЕНИЕ(Перечисление.ВидыОбъектовУчетаНМА.НематериальныйАктив)
	|
	|	И ЕСТЬNULL(УчетнаяПолитикаБУ.ПорядокНачисленияАмортизацииНМА, ЗНАЧЕНИЕ(Перечисление.ПорядокНачисленияАмортизации.СДатыПринятияКУчету))
	|		= ЗНАЧЕНИЕ(Перечисление.ПорядокНачисленияАмортизации.СДатыПринятияКУчету)
	|
	|	И СтоимостьНМА.ХозяйственнаяОперация В (
	|			ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПринятиеКУчетуНМА), 
	|			ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.УлучшениеНМА))
	|
	|	И (СтоимостьНМА.Организация, СтоимостьНМА.НематериальныйАктив) В
	|				(ВЫБРАТЬ
	|					ВтДанныеКРасчету.Организация,
	|					ВтДанныеКРасчету.ОбъектУчета
	|				ИЗ
	|					ВтДанныеКРасчету КАК ВтДанныеКРасчету)
	|
	|	И НЕ ИСТИНА В (
	|		ВЫБРАТЬ ПЕРВЫЕ 1
	|			ИСТИНА 
	|		ИЗ 
	|			ОбъектыПоКоторымНеНужноНачислятьАмортизацию КАК ОбъектыПоКоторымНеНужноНачислятьАмортизацию
	|		ГДЕ
	|			ОбъектыПоКоторымНеНужноНачислятьАмортизацию.ОбъектУчета = СтоимостьНМА.НематериальныйАктив
	|			И ОбъектыПоКоторымНеНужноНачислятьАмортизацию.ОтражатьВРеглУчете)
	|
	|СГРУППИРОВАТЬ ПО
	|	СтоимостьНМА.Организация,
	|	СтоимостьНМА.НематериальныйАктив
	|
	|ИМЕЮЩИЕ
	|	СУММА(СтоимостьНМА.СтоимостьРегл - СтоимостьНМА.ПредварительнаяСтоимостьРегл) > 0
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	НематериальныйАктив,
	|	Организация";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область СписокОбъектовУчета_БУ
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	&КонецМесяца                        КАК ПериодНачисления,
	|	&НачалоМесяца                   	КАК НачалоМесяца,
	|	&КонецМесяца                    	КАК КонецМесяца,
	|	&КонецПредыдущегоМесяца         	КАК Период,
	|	&КонецПредыдущегоМесяца             КАК ПериодПараметров,
	|	ЛОЖЬ                                КАК ЭтоДоначисление,
	|	ПорядокУчетаНМА.Организация         КАК Организация,
	|	ПорядокУчетаНМА.Организация.ГоловнаяОрганизация КАК ГоловнаяОрганизация,
	|	ПорядокУчетаНМА.НематериальныйАктив КАК НематериальныйАктив,
	|	ПорядокУчетаНМА.НематериальныйАктив.ВидОбъектаУчета КАК ВидОбъектаУчета,
	|	ПорядокУчетаНМА.НематериальныйАктив.АмортизационнаяГруппа КАК АмортизационнаяГруппа,
	|
	|	ПорядокУчетаНМА.НачислятьАмортизациюБУ КАК НачислятьАмортизациюБУ,
	|	ПорядокУчетаНМА.НачислятьАмортизациюНУ КАК НачислятьАмортизациюНУ,
	|
	|	ПорядокУчетаНМА.СпособОтраженияРасходовБУ КАК СпособОтраженияРасходовБУ,
	|	ПорядокУчетаНМА.СпособОтраженияРасходовНУ КАК СпособОтраженияРасходовНУ,
	|
	|	ПорядокУчетаНМА.СтатьяРасходовБУ    КАК СтатьяРасходовБУ,
	|	ПорядокУчетаНМА.АналитикаРасходовБУ КАК АналитикаРасходовБУ,
	|	ПорядокУчетаНМА.СтатьяРасходовНУ    КАК СтатьяРасходовНУ,
	|	ПорядокУчетаНМА.АналитикаРасходовНУ КАК АналитикаРасходовНУ,
	|
	|	ПорядокУчетаНМА.ПередаватьРасходыВДругуюОрганизацию КАК ПередаватьРасходыВДругуюОрганизациюБУ,
	|	ПорядокУчетаНМА.ОрганизацияПолучательРасходов КАК ОрганизацияПолучательРасходовБУ,
	|
	|	ЕСТЬNULL(УчетнаяПолитикаУУ.ВариантПроводокПоОбесценениюВНА, ЗНАЧЕНИЕ(Перечисление.ВариантыПроводокПоОбесценениюВНА.ДоначислятьКорректировкуОбесценения)) КАК ВариантПроводокПоОбесценениюВНА,
	|
	|	ПорядокУчетаНМА.НематериальныйАктив.ВидОбъектаУчета = ЗНАЧЕНИЕ(Перечисление.ВидыОбъектовУчетаНМА.НематериальныйАктив)
	|		И ЕСТЬNULL(УчетнаяПолитикаБУ.ПрименяетсяФСБУ14, ИСТИНА) КАК АмортизацияНачисляетсяПоСтандартамМУ,
	|
	|	ПорядокУчетаНМА.НематериальныйАктив.ВидОбъектаУчета = ЗНАЧЕНИЕ(Перечисление.ВидыОбъектовУчетаНМА.НематериальныйАктив)
	|		И ЕСТЬNULL(УчетнаяПолитикаБУ.ПорядокНачисленияАмортизацииНМА, ЗНАЧЕНИЕ(Перечисление.ПорядокНачисленияАмортизации.СДатыПринятияКУчету)) = ЗНАЧЕНИЕ(Перечисление.ПорядокНачисленияАмортизации.СДатыПринятияКУчету) КАК АмортизацияНачисляетсяСДатыПринятияКУчету
	|
	|ПОМЕСТИТЬ СписокОбъектовУчета_БУ
	|
	|ИЗ
	|	РегистрСведений.ПорядокУчетаНМАБУ.СрезПоследних(
	|			&КонецПредыдущегоМесяца,
	|			(Организация, НематериальныйАктив) В
	|				(ВЫБРАТЬ
	|					ВтДанныеКРасчету.Организация,
	|					ВтДанныеКРасчету.ОбъектУчета
	|				ИЗ
	|					ВтДанныеКРасчету КАК ВтДанныеКРасчету)) КАК ПорядокУчетаНМА
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетнаяПолитикаБухУчета.СрезПоследних(&КонецМесяца) КАК УчетнаяПолитикаБУ
	|		ПО УчетнаяПолитикаБУ.Организация = ПорядокУчетаНМА.Организация.ГоловнаяОрганизация
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетнаяПолитикаФинансовогоУчета.СрезПоследних(&КонецМесяца) КАК УчетнаяПолитикаУУ
	|		ПО УчетнаяПолитикаУУ.Организация = ПорядокУчетаНМА.Организация.ГоловнаяОрганизация
	|
	|ГДЕ
	|	НЕ ИСТИНА В (
	|		ВЫБРАТЬ ПЕРВЫЕ 1
	|			ИСТИНА 
	|		ИЗ 
	|			ОбъектыПоКоторымНеНужноНачислятьАмортизацию КАК ОбъектыПоКоторымНеНужноНачислятьАмортизацию
	|		ГДЕ
	|			ОбъектыПоКоторымНеНужноНачислятьАмортизацию.ОбъектУчета = ПорядокУчетаНМА.НематериальныйАктив
	|			И ОбъектыПоКоторымНеНужноНачислятьАмортизацию.ОтражатьВРеглУчете)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	&КонецМесяца                        КАК ПериодНачисления,
	|	&НачалоПредыдущегоМесяца            КАК НачалоМесяца,
	|	&КонецПредыдущегоМесяца             КАК КонецМесяца,
	|	&КонецПредыдущегоМесяца         	КАК Период,
	|	&КонецПозапрошлогоМесяца            КАК ПериодПараметров,
	|	ИСТИНА                              КАК ЭтоДоначисление,
	|	ПорядокУчетаНМА.Организация         КАК Организация,
	|	ПорядокУчетаНМА.Организация.ГоловнаяОрганизация КАК ГоловнаяОрганизация,
	|	ПорядокУчетаНМА.НематериальныйАктив КАК НематериальныйАктив,
	|	ПорядокУчетаНМА.НематериальныйАктив.ВидОбъектаУчета КАК ВидОбъектаУчета,
	|	ПорядокУчетаНМА.НематериальныйАктив.АмортизационнаяГруппа КАК АмортизационнаяГруппа,
	|
	|	ПорядокУчетаНМА.НачислятьАмортизациюБУ КАК НачислятьАмортизациюБУ,
	|	ЛОЖЬ КАК НачислятьАмортизациюНУ,
	|
	|	ПорядокУчетаНМА.СпособОтраженияРасходовБУ КАК СпособОтраженияРасходовБУ,
	|	ПорядокУчетаНМА.СпособОтраженияРасходовНУ КАК СпособОтраженияРасходовНУ,
	|
	|	ПорядокУчетаНМА.СтатьяРасходовБУ    КАК СтатьяРасходовБУ,
	|	ПорядокУчетаНМА.АналитикаРасходовБУ КАК АналитикаРасходовБУ,
	|	ПорядокУчетаНМА.СтатьяРасходовНУ    КАК СтатьяРасходовНУ,
	|	ПорядокУчетаНМА.АналитикаРасходовНУ КАК АналитикаРасходовНУ,
	|
	|	ПорядокУчетаНМА.ПередаватьРасходыВДругуюОрганизацию КАК ПередаватьРасходыВДругуюОрганизациюБУ,
	|	ПорядокУчетаНМА.ОрганизацияПолучательРасходов КАК ОрганизацияПолучательРасходовБУ,
	|
	|	ЕСТЬNULL(УчетнаяПолитикаУУ.ВариантПроводокПоОбесценениюВНА, ЗНАЧЕНИЕ(Перечисление.ВариантыПроводокПоОбесценениюВНА.ДоначислятьКорректировкуОбесценения)) КАК ВариантПроводокПоОбесценениюВНА,
	|
	|	ПорядокУчетаНМА.НематериальныйАктив.ВидОбъектаУчета = ЗНАЧЕНИЕ(Перечисление.ВидыОбъектовУчетаНМА.НематериальныйАктив)
	|		И ЕСТЬNULL(УчетнаяПолитикаБУ.ПрименяетсяФСБУ14, ИСТИНА) КАК АмортизацияНачисляетсяПоСтандартамМУ,
	|
	|	ПорядокУчетаНМА.НематериальныйАктив.ВидОбъектаУчета = ЗНАЧЕНИЕ(Перечисление.ВидыОбъектовУчетаНМА.НематериальныйАктив)
	|		И ЕСТЬNULL(УчетнаяПолитикаБУ.ПорядокНачисленияАмортизацииНМА, ЗНАЧЕНИЕ(Перечисление.ПорядокНачисленияАмортизации.СДатыПринятияКУчету)) = ЗНАЧЕНИЕ(Перечисление.ПорядокНачисленияАмортизации.СДатыПринятияКУчету) КАК АмортизацияНачисляетсяСДатыПринятияКУчету
	|
	|ИЗ
	|	РегистрСведений.ПорядокУчетаНМАБУ.СрезПоследних(
	|			&КонецПозапрошлогоМесяца,
	|			(Организация, НематериальныйАктив) В
	|				(ВЫБРАТЬ
	|					СписокНМА.Организация,
	|					СписокНМА.НематериальныйАктив
	|				ИЗ
	|					СписокОбъектовУчета_Доначисление_БУ КАК СписокНМА)) КАК ПорядокУчетаНМА
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетнаяПолитикаБухУчета.СрезПоследних(&КонецМесяца) КАК УчетнаяПолитикаБУ
	|		ПО УчетнаяПолитикаБУ.Организация = ПорядокУчетаНМА.Организация.ГоловнаяОрганизация
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетнаяПолитикаФинансовогоУчета.СрезПоследних(&КонецМесяца) КАК УчетнаяПолитикаУУ
	|		ПО УчетнаяПолитикаУУ.Организация = ПорядокУчетаНМА.Организация.ГоловнаяОрганизация
	|
	|ГДЕ
	|	НЕ ИСТИНА В (
	|		ВЫБРАТЬ ПЕРВЫЕ 1
	|			ИСТИНА 
	|		ИЗ 
	|			ОбъектыПоКоторымНеНужноНачислятьАмортизацию КАК ОбъектыПоКоторымНеНужноНачислятьАмортизацию
	|		ГДЕ
	|			ОбъектыПоКоторымНеНужноНачислятьАмортизацию.ОбъектУчета = ПорядокУчетаНМА.НематериальныйАктив
	|			И ОбъектыПоКоторымНеНужноНачислятьАмортизацию.ОтражатьВРеглУчете)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	&КонецМесяца                    КАК ПериодНачисления,
	|	&НачалоМесяца                   КАК НачалоМесяца,
	|	&КонецМесяца                    КАК КонецМесяца,
	|	НАЧАЛОПЕРИОДА(ПорядокУчетаНМА.Период, ДЕНЬ) КАК Период,
	|	НАЧАЛОПЕРИОДА(ПорядокУчетаНМА.Период, ДЕНЬ) КАК ПериодПараметров,
	|	ЛОЖЬ                            КАК ЭтоДоначисление,
	|	ПорядокУчетаНМА.Организация         КАК Организация,
	|	ПорядокУчетаНМА.Организация.ГоловнаяОрганизация КАК ГоловнаяОрганизация,
	|	ПорядокУчетаНМА.НематериальныйАктив КАК НематериальныйАктив,
	|	ПорядокУчетаНМА.НематериальныйАктив.ВидОбъектаУчета КАК ВидОбъектаУчета,
	|	ПорядокУчетаНМА.НематериальныйАктив.АмортизационнаяГруппа КАК АмортизационнаяГруппа,
	|
	|	ПорядокУчетаНМА.НачислятьАмортизациюБУ КАК НачислятьАмортизациюБУ,
	|	ПорядокУчетаНМА.НачислятьАмортизациюНУ КАК НачислятьАмортизациюНУ,
	|
	|	ПорядокУчетаНМА.СпособОтраженияРасходовБУ КАК СпособОтраженияРасходовБУ,
	|	ПорядокУчетаНМА.СпособОтраженияРасходовНУ КАК СпособОтраженияРасходовНУ,
	|
	|	ПорядокУчетаНМА.СтатьяРасходовБУ    КАК СтатьяРасходовБУ,
	|	ПорядокУчетаНМА.АналитикаРасходовБУ КАК АналитикаРасходовБУ,
	|	ПорядокУчетаНМА.СтатьяРасходовНУ    КАК СтатьяРасходовНУ,
	|	ПорядокУчетаНМА.АналитикаРасходовНУ КАК АналитикаРасходовНУ,
	|
	|	ПорядокУчетаНМА.ПередаватьРасходыВДругуюОрганизацию КАК ПередаватьРасходыВДругуюОрганизациюБУ,
	|	ПорядокУчетаНМА.ОрганизацияПолучательРасходов КАК ОрганизацияПолучательРасходовБУ,
	|
	|	ЕСТЬNULL(УчетнаяПолитикаУУ.ВариантПроводокПоОбесценениюВНА, ЗНАЧЕНИЕ(Перечисление.ВариантыПроводокПоОбесценениюВНА.ДоначислятьКорректировкуОбесценения)) КАК ВариантПроводокПоОбесценениюВНА,
	|
	|	ИСТИНА КАК АмортизацияНачисляетсяПоСтандартамМУ,
	|	ИСТИНА КАК АмортизацияНачисляетсяСДатыПринятияКУчету
	|
	|ИЗ
	|	РегистрСведений.ПорядокУчетаНМАБУ КАК ПорядокУчетаНМА
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетнаяПолитикаБухУчета.СрезПоследних(&КонецМесяца) КАК УчетнаяПолитикаБУ
	|		ПО УчетнаяПолитикаБУ.Организация = ПорядокУчетаНМА.Организация.ГоловнаяОрганизация
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетнаяПолитикаФинансовогоУчета.СрезПоследних(&КонецМесяца) КАК УчетнаяПолитикаУУ
	|		ПО УчетнаяПолитикаУУ.Организация = ПорядокУчетаНМА.Организация.ГоловнаяОрганизация
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ПринятиеКУчетуНМА2_4 КАК ПринятиеКУчетуНМА
	|		ПО ПринятиеКУчетуНМА.Ссылка = ПорядокУчетаНМА.Регистратор
	|
	|ГДЕ
	|	ПорядокУчетаНМА.Период МЕЖДУ &НачалоМесяца И &КонецМесяца
	|	И ПорядокУчетаНМА.СостояниеБУ = ЗНАЧЕНИЕ(Перечисление.СостоянияНМА.ПринятКУчету)
	|
	|	И ПорядокУчетаНМА.НематериальныйАктив.ВидОбъектаУчета = ЗНАЧЕНИЕ(Перечисление.ВидыОбъектовУчетаНМА.НематериальныйАктив)
	|
	|	И ЕСТЬNULL(УчетнаяПолитикаБУ.ПрименяетсяФСБУ14, ИСТИНА)
	|	И ЕСТЬNULL(УчетнаяПолитикаБУ.ПорядокНачисленияАмортизацииНМА, ЗНАЧЕНИЕ(Перечисление.ПорядокНачисленияАмортизации.СДатыПринятияКУчету)) = ЗНАЧЕНИЕ(Перечисление.ПорядокНачисленияАмортизации.СДатыПринятияКУчету)
	|
	|	И ТИПЗНАЧЕНИЯ(ПорядокУчетаНМА.Регистратор) = ТИП(Документ.ПринятиеКУчетуНМА2_4)
	|	И ЕСТЬNULL(ПринятиеКУчетуНМА.ОтражатьВБУ, ЛОЖЬ)
	|
	|	И (ПорядокУчетаНМА.Организация, ПорядокУчетаНМА.НематериальныйАктив) В
	|				(ВЫБРАТЬ
	|					ВтДанныеКРасчету.Организация,
	|					ВтДанныеКРасчету.ОбъектУчета
	|				ИЗ
	|					ВтДанныеКРасчету КАК ВтДанныеКРасчету)
	|
	|	И НЕ ИСТИНА В (
	|		ВЫБРАТЬ ПЕРВЫЕ 1
	|			ИСТИНА 
	|		ИЗ 
	|			ОбъектыПоКоторымНеНужноНачислятьАмортизацию КАК ОбъектыПоКоторымНеНужноНачислятьАмортизацию
	|		ГДЕ
	|			ОбъектыПоКоторымНеНужноНачислятьАмортизацию.ОбъектУчета = ПорядокУчетаНМА.НематериальныйАктив
	|			И ОбъектыПоКоторымНеНужноНачислятьАмортизацию.ОтражатьВРеглУчете)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	&КонецМесяца                    КАК ПериодНачисления,
	|	&НачалоПредыдущегоМесяца        КАК НачалоМесяца,
	|	&КонецПредыдущегоМесяца         КАК КонецМесяца,
	|	НАЧАЛОПЕРИОДА(ПорядокУчетаНМА.Период, ДЕНЬ) КАК Период,
	|	НАЧАЛОПЕРИОДА(ПорядокУчетаНМА.Период, ДЕНЬ) КАК ПериодПараметров,
	|	ИСТИНА                          КАК ЭтоДоначисление,
	|	ПорядокУчетаНМА.Организация         КАК Организация,
	|	ПорядокУчетаНМА.Организация.ГоловнаяОрганизация КАК ГоловнаяОрганизация,
	|	ПорядокУчетаНМА.НематериальныйАктив КАК НематериальныйАктив,
	|	ПорядокУчетаНМА.НематериальныйАктив.ВидОбъектаУчета КАК ВидОбъектаУчета,
	|	ПорядокУчетаНМА.НематериальныйАктив.АмортизационнаяГруппа КАК АмортизационнаяГруппа,
	|
	|	ПорядокУчетаНМА.НачислятьАмортизациюБУ КАК НачислятьАмортизациюБУ,
	|	ПорядокУчетаНМА.НачислятьАмортизациюНУ КАК НачислятьАмортизациюНУ,
	|
	|	ПорядокУчетаНМА.СпособОтраженияРасходовБУ КАК СпособОтраженияРасходовБУ,
	|	ПорядокУчетаНМА.СпособОтраженияРасходовНУ КАК СпособОтраженияРасходовНУ,
	|
	|	ПорядокУчетаНМА.СтатьяРасходовБУ    КАК СтатьяРасходовБУ,
	|	ПорядокУчетаНМА.АналитикаРасходовБУ КАК АналитикаРасходовБУ,
	|	ПорядокУчетаНМА.СтатьяРасходовНУ    КАК СтатьяРасходовНУ,
	|	ПорядокУчетаНМА.АналитикаРасходовНУ КАК АналитикаРасходовНУ,
	|
	|	ПорядокУчетаНМА.ПередаватьРасходыВДругуюОрганизацию КАК ПередаватьРасходыВДругуюОрганизациюБУ,
	|	ПорядокУчетаНМА.ОрганизацияПолучательРасходов КАК ОрганизацияПолучательРасходовБУ,
	|
	|	ЕСТЬNULL(УчетнаяПолитикаУУ.ВариантПроводокПоОбесценениюВНА, ЗНАЧЕНИЕ(Перечисление.ВариантыПроводокПоОбесценениюВНА.ДоначислятьКорректировкуОбесценения)) КАК ВариантПроводокПоОбесценениюВНА,
	|
	|	ИСТИНА КАК АмортизацияНачисляетсяПоСтандартамМУ,
	|	ИСТИНА КАК АмортизацияНачисляетсяСДатыПринятияКУчету
	|
	|ИЗ
	|	РегистрСведений.ПорядокУчетаНМАБУ КАК ПорядокУчетаНМА
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетнаяПолитикаБухУчета.СрезПоследних(&КонецПредыдущегоМесяца) КАК УчетнаяПолитикаБУ
	|		ПО УчетнаяПолитикаБУ.Организация = ПорядокУчетаНМА.Организация.ГоловнаяОрганизация
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетнаяПолитикаФинансовогоУчета.СрезПоследних(&КонецПредыдущегоМесяца) КАК УчетнаяПолитикаУУ
	|		ПО УчетнаяПолитикаУУ.Организация = ПорядокУчетаНМА.Организация.ГоловнаяОрганизация
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ПринятиеКУчетуНМА2_4 КАК ПринятиеКУчетуНМА
	|		ПО ПринятиеКУчетуНМА.Ссылка = ПорядокУчетаНМА.Регистратор
	|
	|ГДЕ
	|	ПорядокУчетаНМА.Период МЕЖДУ &НачалоПредыдущегоМесяца И &КонецПредыдущегоМесяца
	|	И ПорядокУчетаНМА.СостояниеБУ = ЗНАЧЕНИЕ(Перечисление.СостоянияНМА.ПринятКУчету)
	|
	|	И ПорядокУчетаНМА.НематериальныйАктив.ВидОбъектаУчета = ЗНАЧЕНИЕ(Перечисление.ВидыОбъектовУчетаНМА.НематериальныйАктив)
	|
	|	И ЕСТЬNULL(УчетнаяПолитикаБУ.ПрименяетсяФСБУ14, ИСТИНА)
	|	И ЕСТЬNULL(УчетнаяПолитикаБУ.ПорядокНачисленияАмортизацииНМА, ЗНАЧЕНИЕ(Перечисление.ПорядокНачисленияАмортизации.СДатыПринятияКУчету)) = ЗНАЧЕНИЕ(Перечисление.ПорядокНачисленияАмортизации.СДатыПринятияКУчету)
	|
	|	И ТИПЗНАЧЕНИЯ(ПорядокУчетаНМА.Регистратор) = ТИП(Документ.ПринятиеКУчетуНМА2_4)
	|	И ЕСТЬNULL(ПринятиеКУчетуНМА.ОтражатьВБУ, ЛОЖЬ)
	|
	|	И (ПорядокУчетаНМА.Организация, ПорядокУчетаНМА.НематериальныйАктив) В
	|				(ВЫБРАТЬ
	|					СписокНМА.Организация,
	|					СписокНМА.НематериальныйАктив
	|				ИЗ
	|					СписокОбъектовУчета_Доначисление_БУ КАК СписокНМА)
	|
	|	И НЕ ИСТИНА В (
	|		ВЫБРАТЬ ПЕРВЫЕ 1
	|			ИСТИНА 
	|		ИЗ 
	|			ОбъектыПоКоторымНеНужноНачислятьАмортизацию КАК ОбъектыПоКоторымНеНужноНачислятьАмортизацию
	|		ГДЕ
	|			ОбъектыПоКоторымНеНужноНачислятьАмортизацию.ОбъектУчета = ПорядокУчетаНМА.НематериальныйАктив
	|			И ОбъектыПоКоторымНеНужноНачислятьАмортизацию.ОтражатьВРеглУчете)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	НематериальныйАктив,
	|	ГоловнаяОрганизация,
	|	Организация";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	//-- Локализация
	
КонецПроцедуры

// 
// Параметры:
//  ПараметрыРасчета - см. РасчетАмортизацииНМА.ПараметрыВыполнения
// 
// Возвращаемое значение:
//  Строка - Текст запроса
Функция ТекстЗапросаСписокОбъектовУчета(ПараметрыРасчета) Экспорт

	ТекстЗапроса = Неопределено;
	
	//++ Локализация
	
	ТекстЗапроса = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	СписокНМА.НачалоМесяца                        КАК НачалоМесяца,
	|	СписокНМА.КонецМесяца                         КАК КонецМесяца,
	|	СписокНМА.Организация                         КАК Организация,
	|	СписокНМА.НематериальныйАктив                 КАК НематериальныйАктив,
	|	СписокНМА.СпособОтраженияРасходов             КАК СпособОтраженияРасходов,
	|	ЕСТЬNULL(ПакетыАмортизацииНМА.НомерПакета, 0) КАК НомерПакета,
	|
	|	СписокНМА.АмортизацияНачисляетсяСДатыПринятияКУчету КАК АмортизацияНачисляетсяСДатыПринятияКУчету,
	|	СписокНМА.АмортизацияНачисляетсяПоСтандартамМУ КАК АмортизацияНачисляетсяПоСтандартамМУ
	|
	|ПОМЕСТИТЬ СписокОбъектовУчета
	|
	|ИЗ
	|	СписокОбъектовУчета_УУ КАК СписокНМА
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПакетыАмортизацииНМА КАК ПакетыАмортизацииНМА
	|		ПО ПакетыАмортизацииНМА.Организация = СписокНМА.Организация
	|			И ПакетыАмортизацииНМА.НематериальныйАктив = СписокНМА.НематериальныйАктив
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ
	|	&НачалоМесяца                                 КАК НачалоМесяца,
	|	&КонецМесяца                                  КАК КонецМесяца,
	|	СписокНМА.Организация                         КАК Организация,
	|	СписокНМА.НематериальныйАктив                 КАК НематериальныйАктив,
	|	СписокНМА.СпособОтраженияРасходовБУ           КАК СпособОтраженияРасходов,
	|	ЕСТЬNULL(ПакетыАмортизацииНМА.НомерПакета, 0) КАК НомерПакета,
	|
	|	ЛОЖЬ КАК АмортизацияНачисляетсяСДатыПринятияКУчету,
	|	ЛОЖЬ КАК АмортизацияНачисляетсяПоСтандартамМУ
	|
	|ИЗ
	|	СписокОбъектовУчета_БУ КАК СписокНМА
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПакетыАмортизацииНМА КАК ПакетыАмортизацииНМА
	|		ПО ПакетыАмортизацииНМА.Организация = СписокНМА.Организация
	|			И ПакетыАмортизацииНМА.НематериальныйАктив = СписокНМА.НематериальныйАктив
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ
	|	&НачалоМесяца                                 КАК НачалоМесяца,
	|	&КонецМесяца                                  КАК КонецМесяца,
	|	СписокНМА.Организация                         КАК Организация,
	|	СписокНМА.НематериальныйАктив                 КАК НематериальныйАктив,
	|	СписокНМА.СпособОтраженияРасходовНУ           КАК СпособОтраженияРасходов,
	|	ЕСТЬNULL(ПакетыАмортизацииНМА.НомерПакета, 0) КАК НомерПакета,
	|
	|	ЛОЖЬ КАК АмортизацияНачисляетсяСДатыПринятияКУчету,
	|	ЛОЖЬ КАК АмортизацияНачисляетсяПоСтандартамМУ
	|
	|ИЗ
	|	СписокОбъектовУчета_БУ КАК СписокНМА
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПакетыАмортизацииНМА КАК ПакетыАмортизацииНМА
	|		ПО ПакетыАмортизацииНМА.Организация = СписокНМА.Организация
	|			И ПакетыАмортизацииНМА.НематериальныйАктив = СписокНМА.НематериальныйАктив
	|
	|ГДЕ
	|	СписокНМА.СпособОтраженияРасходовНУ <> СписокНМА.СпособОтраженияРасходовБУ
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	НематериальныйАктив,
	|	Организация";

	//-- Локализация
	
	Возврат ТекстЗапроса;
	
КонецФункции

// 
// Параметры:
//  ПараметрыРасчета - см. РасчетАмортизацииНМА.ПараметрыВыполнения
// 
// Возвращаемое значение:
//  Строка - Текст запроса
Функция ТекстЗапросаЗарегистрироватьОшибкиРасчетаАмортизации(ПараметрыРасчета) Экспорт

	ТекстЗапроса = Неопределено;
	
	//++ Локализация
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ПроверкаПараметровРасчета.Организация КАК Организация,
	|	ПроверкаПараметровРасчета.ОбъектУчета КАК ОбъектУчета,
	|	ВЫРАЗИТЬ(ПроверкаПараметровРасчета.ОбъектУчета КАК Справочник.НематериальныеАктивы).Наименование КАК ОбъектУчетаПредставление,
	|	ВЫРАЗИТЬ(ПроверкаПараметровРасчета.ОбъектУчета КАК Справочник.НематериальныеАктивы).Код КАК Код,
	|	МАКСИМУМ(ПроверкаПараметровРасчета.НеУказанаАмортизационнаяГруппа) КАК НеУказанаАмортизационнаяГруппа,
	|	МАКСИМУМ(ПроверкаПараметровРасчета.НеУказанОбъемНаработки) КАК НеУказанОбъемНаработки
	|ИЗ
	|	(ВЫБРАТЬ
	|		ПроверкаПараметровРасчета.Организация КАК Организация,
	|		ПроверкаПараметровРасчета.ОбъектУчета КАК ОбъектУчета,
	|		ЛОЖЬ КАК НеУказанаАмортизационнаяГруппа,
	|		ПроверкаПараметровРасчета.НеУказанОбъемНаработки КАК НеУказанОбъемНаработки
	|	ИЗ
	|		ПроверкаПараметровРасчета_УУ КАК ПроверкаПараметровРасчета
	|	ГДЕ
	|		ПроверкаПараметровРасчета.Организация В(&СписокОрганизаций)
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ПроверкаПараметровРасчета.Организация,
	|		ПроверкаПараметровРасчета.ОбъектУчета,
	|		ЛОЖЬ,
	|		ПроверкаПараметровРасчета.НеУказанОбъемНаработки
	|	ИЗ
	|		ПроверкаПараметровРасчета_БУ КАК ПроверкаПараметровРасчета
	|	ГДЕ
	|		ПроверкаПараметровРасчета.Организация В(&СписокОрганизаций)
	|
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		ПроверкаПараметровРасчета.Организация,
	|		ПроверкаПараметровРасчета.ОбъектУчета,
	|		ПроверкаПараметровРасчета.НеУказанаАмортизационнаяГруппа,
	|		ЛОЖЬ
	|	ИЗ
	|		ПроверкаПараметровРасчета_НУ КАК ПроверкаПараметровРасчета
	|	ГДЕ
	|		ПроверкаПараметровРасчета.Организация В(&СписокОрганизаций)
	|
	|	) КАК ПроверкаПараметровРасчета
	|
	|СГРУППИРОВАТЬ ПО
	|	ПроверкаПараметровРасчета.ОбъектУчета,
	|	ПроверкаПараметровРасчета.Организация";
	
	//-- Локализация

	Возврат ТекстЗапроса;
	
КонецФункции

// 
// Параметры:
//  СписокЗапросов - Массив из Строка - 
//  ПараметрыРасчета - см. РасчетАмортизацииНМА.ПараметрыВыполнения
Процедура ДополнитьТекстПодзапросаНачисленнаяАмортизация(СписокЗапросов, ПараметрыРасчета) Экспорт

	//++ Локализация
	
	ТекстПодзапроса =  
	"ВЫБРАТЬ
	|		РасчетАмортизации.ВидОбъектаУчета КАК ВидОбъектаУчета,
	|		РасчетАмортизации.ПериодРасчета КАК ПериодРасчета,
	|		РасчетАмортизации.Организация КАК Организация,
	|		РасчетАмортизации.Подразделение КАК Подразделение,
	|		РасчетАмортизации.КорПодразделение КАК КорПодразделение,
	|		РасчетАмортизации.НематериальныйАктив КАК НематериальныйАктив,
	|		РасчетАмортизации.ЕГДС КАК ЕГДС,
	|		РасчетАмортизации.ГруппаФинансовогоУчета,
	|		РасчетАмортизации.НаправлениеДеятельности,
	|		РасчетАмортизации.КорНаправлениеДеятельности,
	|		РасчетАмортизации.СтатьяРасходов КАК СтатьяРасходов,
	|		РасчетАмортизации.АналитикаРасходов КАК АналитикаРасходов,
	|		РасчетАмортизации.ПередаватьРасходыВДругуюОрганизацию КАК ПередаватьРасходыВДругуюОрганизацию,
	|		РасчетАмортизации.ОрганизацияПолучательРасходов КАК ОрганизацияПолучательРасходов,
	|		0 КАК РесурсВыработанныйЗаПрошлыйПериод,
	|		0 КАК РесурсВыработанныйЗаТекущийПериод,
	|		РасчетАмортизации.РесурсВыработанныйЗаПрошлыйПериод КАК РесурсВыработанныйЗаПрошлыйПериодБУ,
	|		РасчетАмортизации.РесурсВыработанныйЗаТекущийПериод КАК РесурсВыработанныйЗаТекущийПериодБУ,
	|		0 КАК СтоимостьДляВычисленияАмортизации,
	|		РасчетАмортизации.СтоимостьДляВычисленияАмортизации КАК СтоимостьДляВычисленияАмортизацииРегл,
	|		РасчетАмортизации.ОстатокОбесцененияРегл КАК ОстатокОбесцененияРегл,
	|		0 КАК ОстатокОбесцененияУпр,
	|		ЛОЖЬ КАК ЭтоДоначисление,
	|		РасчетАмортизации.ЭтоДоначисление КАК ЭтоДоначислениеБУ,
	|
	|		НЕОПРЕДЕЛЕНО КАК ПорядокУчетаУУ,
	|		РасчетАмортизации.ПорядокУчетаВНА КАК ПорядокУчетаБУ,
	|
	|		НЕОПРЕДЕЛЕНО КАК ПорядокНачисленияАмортизацииУУ,
	|		РасчетАмортизации.ПорядокНачисленияАмортизацииБУ КАК ПорядокНачисленияАмортизацииБУ,
	|
	|		РасчетАмортизации.ВариантПроводокПоОбесценениюВНА КАК ВариантПроводокПоОбесценениюВНА,
	|
	|		0 КАК СуммаУУ,
	|		РасчетАмортизации.СуммаБУ КАК СуммаБУ,
	|		РасчетАмортизации.СуммаНУ КАК СуммаНУ,
	|
	|		РасчетАмортизации.СуммаПР 
	|		+ ВЫБОР 
	|			КОГДА (РасчетАмортизации.СуммаБУ
	|						- РасчетАмортизации.СуммаНУ 
	|						- РасчетАмортизации.СуммаПР) < &МинимальнаяСуммаВР
	|					И (РасчетАмортизации.СуммаБУ
	|						- РасчетАмортизации.СуммаНУ 
	|						- РасчетАмортизации.СуммаПР) > -&МинимальнаяСуммаВР
	|					И РасчетАмортизации.СуммаПР <> 0
	|				ТОГДА РасчетАмортизации.СуммаБУ
	|						- РасчетАмортизации.СуммаНУ 
	|						- РасчетАмортизации.СуммаПР
	|			ИНАЧЕ 0
	|		КОНЕЦ КАК СуммаПР,
	|
	|		ВЫБОР 
	|			КОГДА (РасчетАмортизации.СуммаБУ
	|						- РасчетАмортизации.СуммаНУ 
	|						- РасчетАмортизации.СуммаПР) < &МинимальнаяСуммаВР
	|					И (РасчетАмортизации.СуммаБУ
	|						- РасчетАмортизации.СуммаНУ 
	|						- РасчетАмортизации.СуммаПР) > -&МинимальнаяСуммаВР
	|					И РасчетАмортизации.СуммаПР <> 0
	|				ТОГДА 0
	|			ИНАЧЕ РасчетАмортизации.СуммаБУ
	|					- РасчетАмортизации.СуммаНУ 
	|					- РасчетАмортизации.СуммаПР
	|		КОНЕЦ КАК СуммаВР,
	|
	|		РасчетАмортизации.СуммаЦФ КАК СуммаЦФ,
	|		РасчетАмортизации.СуммаНУЦФ КАК СуммаНУЦФ,
	|
	|		РасчетАмортизации.СуммаПРЦФ
	|		+ ВЫБОР 
	|			КОГДА (РасчетАмортизации.СуммаЦФ
	|						- РасчетАмортизации.СуммаНУЦФ 
	|						- РасчетАмортизации.СуммаПРЦФ) < &МинимальнаяСуммаВР
	|					И (РасчетАмортизации.СуммаЦФ
	|						- РасчетАмортизации.СуммаНУЦФ 
	|						- РасчетАмортизации.СуммаПРЦФ) > -&МинимальнаяСуммаВР
	|					И РасчетАмортизации.СуммаПРЦФ <> 0
	|				ТОГДА РасчетАмортизации.СуммаЦФ
	|					- РасчетАмортизации.СуммаНУЦФ 
	|					- РасчетАмортизации.СуммаПРЦФ
	|			ИНАЧЕ 0
	|		КОНЕЦ КАК СуммаПРЦФ,
	|
	|		ВЫБОР 
	|			КОГДА (РасчетАмортизации.СуммаЦФ
	|						- РасчетАмортизации.СуммаНУЦФ 
	|						- РасчетАмортизации.СуммаПРЦФ) < &МинимальнаяСуммаВР
	|					И (РасчетАмортизации.СуммаЦФ
	|						- РасчетАмортизации.СуммаНУЦФ 
	|						- РасчетАмортизации.СуммаПРЦФ) > -&МинимальнаяСуммаВР
	|					И РасчетАмортизации.СуммаПРЦФ <> 0
	|				ТОГДА 0
	|			ИНАЧЕ РасчетАмортизации.СуммаЦФ
	|					- РасчетАмортизации.СуммаНУЦФ 
	|					- РасчетАмортизации.СуммаПРЦФ
	|		КОНЕЦ КАК СуммаВРЦФ,
	|
	|		0 КАК ОбесценениеУУ,
	|		РасчетАмортизации.ОбесценениеБУ КАК ОбесценениеБУ,
	|		РасчетАмортизации.ОбесценениеЦФ КАК ОбесценениеЦФ
	|
	|	ИЗ
	|		РасчетАмортизации_БУ КАК РасчетАмортизации";
	
	СписокЗапросов.Добавить(ТекстПодзапроса);
	
	//-- Локализация

КонецПроцедуры
 
// 
// Параметры: СписокЗапросов - Массив из Строка -
//  Выборка - ВыборкаИзРезультатаЗапроса -
//  ПараметрыРасчета - см. РасчетАмортизацииНМА.ПараметрыВыполнения
Процедура ЗарегистрироватьОшибкиРасчетаАмортизации(Выборка, ПараметрыРасчета) Экспорт
	
	//++ Локализация
	
	ШаблонАмортизационнаяГруппа  = НСтр("ru = 'Для объекта учета ""%1"" (код %2) не указана амортизационная группа.';
										|en = 'Depreciation group is not specified for the ""%1"" accounting object (code %2).'");
	
	Если Выборка.НеУказанаАмортизационнаяГруппа Тогда
		
		ТекстОшибки = СтрШаблон(ШаблонАмортизационнаяГруппа, Выборка.ОбъектУчетаПредставление, Выборка.Код);
		
		ВнеоборотныеАктивыСлужебный.ЗарегистрироватьПроблемуВыполненияРасчета(
			Перечисления.ОперацииЗакрытияМесяца.НачислениеАмортизацииНМА, 
			ПараметрыРасчета.Период,
			Выборка.Организация,
			ТекстОшибки,,
			Выборка.ОбъектУчета,
			ПараметрыРасчета.ЕстьОшибки);
		
	КонецЕсли;

	//-- Локализация
	
КонецПроцедуры

// 
// Параметры:
//  СписокЗапросов - Массив из Строка - 
//  ПараметрыРасчета - см. РасчетАмортизацииНМА.ПараметрыВыполнения
Процедура ДополнитьТекстЗапросаПараметрыРасчетаАмортизации(СписокЗапросов, ПараметрыРасчета) Экспорт

	//++ Локализация
	
	#Область ДатыПоследнегоИзменения
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ВложенныйЗапрос.НачалоМесяца КАК НачалоМесяца,
	|	ВложенныйЗапрос.Организация КАК Организация,
	|	ВложенныйЗапрос.НематериальныйАктив КАК НематериальныйАктив,
	|	
	|	МАКСИМУМ(ВложенныйЗапрос.Дата) КАК Дата,
	|	МАКСИМУМ(ВложенныйЗапрос.ДатаДокументаПринятияКУчетуБУ) КАК ДатаДокументаПринятияКУчетуБУ
	|
	|ПОМЕСТИТЬ ДатыПоследнегоИзмененияБУ
	|
	|ИЗ
	|	(ВЫБРАТЬ
	|		ПараметрыАмортизацииНМАБУ.НачалоМесяца КАК НачалоМесяца,
	|		ПараметрыАмортизацииНМАБУ.Организация КАК Организация,
	|		ПараметрыАмортизацииНМАБУ.НематериальныйАктив КАК НематериальныйАктив,
	|	
	|		ВЫБОР
	|			КОГДА ЕСТЬNULL(УчетнаяПолитикаБухУчета.ПорядокНачисленияАмортизацииНМА, ЗНАЧЕНИЕ(Перечисление.ПорядокНачисленияАмортизации.СДатыПринятияКУчету)) = ЗНАЧЕНИЕ(Перечисление.ПорядокНачисленияАмортизации.СДатыПринятияКУчету)
	|				ТОГДА ПараметрыАмортизацииНМАБУ.ДатаПоследнегоИзменения
	|
	|			ИНАЧЕ НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(ПараметрыАмортизацииНМАБУ.ДатаПоследнегоИзменения, МЕСЯЦ, 1), МЕСЯЦ)
	|
	|		КОНЕЦ КАК Дата,
	|
	|		ЕСТЬNULL(ПервоначальныеСведенияНМА.ДокументПринятияКУчетуБУ.Дата, ДАТАВРЕМЯ(1,1,1)) КАК ДатаДокументаПринятияКУчетуБУ
	|
	|	ИЗ
	|		ПараметрыАмортизацииНМАБУ КАК ПараметрыАмортизацииНМАБУ
	|
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПервоначальныеСведенияНМА КАК ПервоначальныеСведенияНМА
	|			ПО (ПервоначальныеСведенияНМА.Организация = ПараметрыАмортизацииНМАБУ.Организация)
	|				И (ПервоначальныеСведенияНМА.НематериальныйАктив = ПараметрыАмортизацииНМАБУ.НематериальныйАктив)
	|				И (ПервоначальныеСведенияНМА.НачалоМесяца = ПараметрыАмортизацииНМАБУ.НачалоМесяца)
	|
	|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетнаяПолитикаБухУчета.СрезПоследних(&НачалоМесяца) КАК УчетнаяПолитикаБухУчета
	|			ПО УчетнаяПолитикаБухУчета.Организация = ПараметрыАмортизацииНМАБУ.Организация.ГоловнаяОрганизация
	|
	|	) КАК ВложенныйЗапрос
	|
	|СГРУППИРОВАТЬ ПО
	|	ВложенныйЗапрос.НачалоМесяца,
	|	ВложенныйЗапрос.Организация,
	|	ВложенныйЗапрос.НематериальныйАктив
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	НачалоМесяца,
	|	Организация,
	|	НематериальныйАктив";
	СписокЗапросов.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область АмортизацияНМАПриПереходеКЛинейномуМетоду
	
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	НелинейныйМетод.Организация КАК Организация,
	|	ЕСТЬNULL(МИНИМУМ(ЛинейныйМетод.Период), ДАТАВРЕМЯ(2009, 1, 1)) КАК Дата
	|
	|ПОМЕСТИТЬ ДатыПереходаКЛинейномуМетоду
	|
	|ИЗ
	|	РегистрСведений.НастройкиУчетаНалогаНаПрибыль.СрезПоследних(
	|		&НачалоМесяца, 
	|		МетодНачисленияАмортизацииНУ = ЗНАЧЕНИЕ(Перечисление.МетодыНачисленияАмортизации.Нелинейный)) КАК НелинейныйМетод
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НастройкиУчетаНалогаНаПрибыль КАК ЛинейныйМетод
	|		ПО ЛинейныйМетод.Организация = НелинейныйМетод.Организация
	|			И ЛинейныйМетод.МетодНачисленияАмортизацииНУ = ЗНАЧЕНИЕ(Перечисление.МетодыНачисленияАмортизации.Линейный)
	|			И ЛинейныйМетод.Период МЕЖДУ ДАТАВРЕМЯ(2009, 1, 1) И &НачалоМесяца
	|			И ЛинейныйМетод.Период > НелинейныйМетод.Период
	| 
	|СГРУППИРОВАТЬ ПО
	|	НелинейныйМетод.Организация
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Организация
	|;
	|	
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	АмортизацияНМА.Организация КАК Организация,
	|	АмортизацияНМА.НематериальныйАктив КАК НематериальныйАктив,
	|	СУММА(ВЫБОР КОГДА АмортизацияНМА.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|		ТОГДА -АмортизацияНМА.АмортизацияНУ
	|		ИНАЧЕ АмортизацияНМА.АмортизацияНУ
	|	КОНЕЦ) КАК АмортизацияНУ
	|
	|ПОМЕСТИТЬ АмортизацияНМАПриПереходеКЛинейномуМетоду
	|
	|ИЗ
	|
	|	ДатыПереходаКЛинейномуМетоду КАК ДатыПереходаКЛинейномуМетоду
	|
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.АмортизацияНМА КАК АмортизацияНМА
	|		ПО АмортизацияНМА.Организация.ГоловнаяОрганизация = ДатыПереходаКЛинейномуМетоду.Организация
	|			И АмортизацияНМА.Период < ДатыПереходаКЛинейномуМетоду.Дата
	|			И АмортизацияНМА.Активность
	|
	|ГДЕ
	|	ДатыПереходаКЛинейномуМетоду.Дата > ДАТАВРЕМЯ(2009, 1, 1)
	|	И (АмортизацияНМА.Организация, АмортизацияНМА.НематериальныйАктив) В
	|			(ВЫБРАТЬ
	|				СписокНМА.Организация,
	|				СписокНМА.НематериальныйАктив
	|			ИЗ
	|				СписокОбъектовУчета_БУ КАК СписокНМА)
	|
	|СГРУППИРОВАТЬ ПО
	|	АмортизацияНМА.Организация,
	|	АмортизацияНМА.НематериальныйАктив
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	НематериальныйАктив,
	|	Организация";

	СписокЗапросов.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область СтоимостьНаНачалоГода
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	СписокНМА.Организация,
	|	СписокНМА.НематериальныйАктив
	|ПОМЕСТИТЬ втСписокНМАУменьшаемогоОстатка
	|ИЗ
	|	ПервоначальныеСведенияНМА КАК СписокНМА
	|ГДЕ
	|	СписокНМА.МетодНачисленияАмортизацииБУ = ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииНМА.УменьшаемогоОстатка)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Организация,
	|	НематериальныйАктив";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
	Если ПараметрыРасчета.ДатаНачалаУчета <= НачалоГода(ПараметрыРасчета.Период) Тогда
	
		ТекстЗапроса = 
		"ВЫБРАТЬ
		|	&НачалоМесяца                             КАК НачалоМесяца,
		|	СтоимостьНМА.НематериальныйАктив          КАК НематериальныйАктив,
		|	СтоимостьНМА.СтоимостьРеглОстаток         КАК СтоимостьРегл
		|ПОМЕСТИТЬ СтоимостьНМА_НаНачалоГода
		|ИЗ
		|	РегистрНакопления.СтоимостьНМА.Остатки(
		|			&НачалоГода,
		|			НематериальныйАктив В
		|				(ВЫБРАТЬ СписокНМА.НематериальныйАктив ИЗ втСписокНМАУменьшаемогоОстатка КАК СписокНМА)) КАК СтоимостьНМА
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	НематериальныйАктив";
		
		СписокЗапросов.Добавить(ТекстЗапроса);
		
	Иначе
		
		ТекстЗапроса = 
		"ВЫБРАТЬ
		|	СчетаУчета.СчетУчета КАК СчетУчета
		|ПОМЕСТИТЬ СчетаНачалоГода
		|ИЗ
		|	РегистрСведений.ПорядокУчетаНМА.СрезПоследних(
		|			&НачалоГода,
		|			(НематериальныйАктив, Организация) В
		|					(ВЫБРАТЬ
		|						СписокНМА.НематериальныйАктив,
		|						СписокНМА.Организация
		|					ИЗ
		|						втСписокНМАУменьшаемогоОстатка КАК СписокНМА)) КАК СчетаУчета
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ПараметрыЦелевогоФинансированияНМА.СчетУчета КАК СчетУчета
		|ИЗ
		|	РегистрСведений.ПараметрыЦелевогоФинансированияНМА.СрезПоследних(
		|			&НачалоГода,
		|			НематериальныйАктив В
		|				(ВЫБРАТЬ
		|					СписокНМА.НематериальныйАктив
		|				ИЗ
		|					втСписокНМАУменьшаемогоОстатка КАК СписокНМА)) КАК ПараметрыЦелевогоФинансированияНМА
		|ГДЕ
		|	ПараметрыЦелевогоФинансированияНМА.ПрименениеЦелевогоФинансирования
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	&НачалоМесяца                            КАК НачалоМесяца,
		|	СтоимостьНМА.Субконто1                    КАК НематериальныйАктив,
		|	СтоимостьНМА.СуммаОстатокДт               КАК СтоимостьРегл
		|ПОМЕСТИТЬ СтоимостьНМА_НаНачалоГода
		|ИЗ
		|	РегистрБухгалтерии.Хозрасчетный.Остатки(
		|			&НачалоГода,
		|			Счет В
		|				(ВЫБРАТЬ
		|					СчетаНачалоГода.СчетУчета
		|				ИЗ
		|					СчетаНачалоГода КАК СчетаНачалоГода),
		|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.НематериальныеАктивы),
		|			Субконто1 В
		|					(ВЫБРАТЬ
		|						СписокНМА.НематериальныйАктив
		|					ИЗ
		|						втСписокНМАУменьшаемогоОстатка КАК СписокНМА)) КАК СтоимостьНМА
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	НематериальныйАктив";
		
		СписокЗапросов.Добавить(ТекстЗапроса);
		
	КонецЕсли;
	
	#КонецОбласти
	
	#Область Изменения_БУ
	
	#Область ИзменениеПараметров
	ТекстЗапроса =
	// ПараметрыАмортизацииНМАБУ
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	&НачалоМесяца КАК НачалоМесяца,
	|	&КонецПредыдущегоМесяца КАК ПериодПараметров,
	|	ДанныеРегистра.Период КАК Период,
	|	ДанныеРегистра.МоментВремени КАК МоментВремени,
	|	ДанныеРегистра.Регистратор КАК Регистратор,
	|	ДанныеРегистра.НематериальныйАктив КАК НематериальныйАктив,
	|	ДанныеРегистра.Организация КАК Организация,
	|	ДанныеРегистра.ДатаПоследнегоИзменения КАК ДатаПоследнегоИзменения,
	|	ДанныеРегистра.СрокИспользованияДляВычисленияАмортизации КАК СрокИспользования,
	|	ДанныеРегистра.ОбъемПродукцииРаботДляВычисленияАмортизации КАК ОбъемНаработки,
	|	ДанныеРегистра.КоэффициентБУ КАК КоэффициентБУ,
	|	ДанныеРегистра.ЛиквидационнаяСтоимость
	|
	|ПОМЕСТИТЬ ПараметрыАмортизацииНМАБУ_Изменения
	|
	|ИЗ
	|	РегистрСведений.ПараметрыАмортизацииНМАБУ КАК ДанныеРегистра
	|ГДЕ
	|	ДанныеРегистра.Активность
	|	И ДанныеРегистра.Период МЕЖДУ &НачалоМесяца И &КонецМесяца
	|
	|	И НЕ ДанныеРегистра.Регистратор ССЫЛКА Документ.ПринятиеКУчетуНМА2_4
	|	И НЕ ДанныеРегистра.Регистратор ССЫЛКА Документ.ВводОстатковВнеоборотныхАктивов2_4
	|
	|
	|	И ДанныеРегистра.НематериальныйАктив В
	|			(ВЫБРАТЬ
	|				СписокНМА.НематериальныйАктив
	|			ИЗ
	|				СписокОбъектовУчета_БУ КАК СписокНМА
	|			ГДЕ
	|				СписокНМА.НачалоМесяца = &НачалоМесяца
	|				И СписокНМА.АмортизацияНачисляетсяСДатыПринятияКУчету)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	&НачалоПредыдущегоМесяца КАК НачалоМесяца,
	|	&КонецПозапрошлогоМесяца КАК ПериодПараметров,
	|	ДанныеРегистра.Период КАК Период,
	|	ДанныеРегистра.МоментВремени КАК МоментВремени,
	|	ДанныеРегистра.Регистратор КАК Регистратор,
	|	ДанныеРегистра.НематериальныйАктив КАК НематериальныйАктив,
	|	ДанныеРегистра.Организация КАК Организация,
	|	ДанныеРегистра.ДатаПоследнегоИзменения КАК ДатаПоследнегоИзменения,
	|	ДанныеРегистра.СрокИспользованияДляВычисленияАмортизации КАК СрокИспользования,
	|	ДанныеРегистра.ОбъемПродукцииРаботДляВычисленияАмортизации КАК ОбъемНаработки,
	|	ДанныеРегистра.КоэффициентБУ КАК КоэффициентБУ,
	|	ДанныеРегистра.ЛиквидационнаяСтоимость
	|ИЗ
	|	РегистрСведений.ПараметрыАмортизацииНМАБУ КАК ДанныеРегистра
	|
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ СписокОбъектовУчета_Доначисление_БУ КАК Доначисление
	|		ПО ДанныеРегистра.НематериальныйАктив = Доначисление.НематериальныйАктив
	|
	|ГДЕ
	|	ДанныеРегистра.Активность
	|	И ДанныеРегистра.Период МЕЖДУ &НачалоПредыдущегоМесяца И &КонецПредыдущегоМесяца
	|	И ДанныеРегистра.Период >= Доначисление.Период
	|
	|	И НЕ ДанныеРегистра.Регистратор ССЫЛКА Документ.ПринятиеКУчетуНМА2_4
	|	И НЕ ДанныеРегистра.Регистратор ССЫЛКА Документ.ВводОстатковВнеоборотныхАктивов2_4
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	// ПервоначальныеСведенияНМА
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	&НачалоМесяца КАК НачалоМесяца,
	|	&КонецПредыдущегоМесяца КАК ПериодПараметров,
	|	ДанныеРегистра.Период КАК Период,
	|	ДанныеРегистра.МоментВремени КАК МоментВремени,
	|	ДанныеРегистра.Регистратор КАК Регистратор,
	|	ДанныеРегистра.НематериальныйАктив КАК НематериальныйАктив,
	|	ДанныеРегистра.Организация КАК Организация,
	|	ДанныеРегистра.МетодНачисленияАмортизацииБУ КАК МетодНачисленияАмортизацииБУ
	|
	|ПОМЕСТИТЬ ПервоначальныеСведенияНМА_ИзмененияБУ
	|
	|ИЗ
	|	РегистрСведений.ПервоначальныеСведенияНМА КАК ДанныеРегистра
	|ГДЕ
	|	ДанныеРегистра.Активность
	|	И ДанныеРегистра.Период МЕЖДУ &НачалоМесяца И &КонецМесяца
	|
	|	И НЕ ДанныеРегистра.Регистратор ССЫЛКА Документ.ПринятиеКУчетуНМА2_4
	|	И НЕ ДанныеРегистра.Регистратор ССЫЛКА Документ.ВводОстатковВнеоборотныхАктивов2_4
	|
	|	И ДанныеРегистра.НематериальныйАктив В
	|			(ВЫБРАТЬ
	|				СписокНМА.НематериальныйАктив
	|			ИЗ
	|				СписокОбъектовУчета_БУ КАК СписокНМА
	|			ГДЕ
	|				СписокНМА.НачалоМесяца = &НачалоМесяца
	|				И СписокНМА.АмортизацияНачисляетсяСДатыПринятияКУчету)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	&НачалоПредыдущегоМесяца КАК НачалоМесяца,
	|	&КонецПозапрошлогоМесяца КАК ПериодПараметров,
	|	ДанныеРегистра.Период КАК Период,
	|	ДанныеРегистра.МоментВремени КАК МоментВремени,
	|	ДанныеРегистра.Регистратор КАК Регистратор,
	|	ДанныеРегистра.НематериальныйАктив КАК НематериальныйАктив,
	|	ДанныеРегистра.Организация КАК Организация,
	|	ДанныеРегистра.МетодНачисленияАмортизацииБУ КАК МетодНачисленияАмортизацииБУ
	|ИЗ
	|	РегистрСведений.ПервоначальныеСведенияНМА КАК ДанныеРегистра
	|
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ СписокОбъектовУчета_Доначисление_БУ КАК Доначисление
	|		ПО ДанныеРегистра.НематериальныйАктив = Доначисление.НематериальныйАктив
	|
	|ГДЕ
	|	ДанныеРегистра.Активность
	|	И ДанныеРегистра.Период МЕЖДУ &НачалоПредыдущегоМесяца И &КонецПредыдущегоМесяца
	|	И ДанныеРегистра.Период >= Доначисление.Период
	|	И НЕ ДанныеРегистра.Регистратор ССЫЛКА Документ.ПринятиеКУчетуНМА2_4
	|	И НЕ ДанныеРегистра.Регистратор ССЫЛКА Документ.ВводОстатковВнеоборотныхАктивов2_4
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	// ПорядокУчетаНМА
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	&НачалоМесяца КАК НачалоМесяца,
	|	&КонецПредыдущегоМесяца КАК ПериодПараметров,
	|	ДанныеРегистра.Период КАК Период,
	|	ДанныеРегистра.МоментВремени КАК МоментВремени,
	|	ДанныеРегистра.Регистратор КАК Регистратор,
	|	ДанныеРегистра.НематериальныйАктив КАК НематериальныйАктив,
	|	ДанныеРегистра.Организация КАК Организация,
	|	ДанныеРегистра.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	ДанныеРегистра.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ДанныеРегистра.ОбъемНаработки КАК ОбъемНаработки
	|
	|ПОМЕСТИТЬ ПорядокУчетаНМА_ИзмененияБУ
	|
	|ИЗ
	|	РегистрСведений.ПорядокУчетаНМА КАК ДанныеРегистра
	|
	|ГДЕ
	|	ДанныеРегистра.Активность
	|	И ДанныеРегистра.Период МЕЖДУ &НачалоМесяца И &КонецМесяца
	|
	|	И НЕ ДанныеРегистра.Регистратор ССЫЛКА Документ.ПринятиеКУчетуНМА2_4
	|	И НЕ ДанныеРегистра.Регистратор ССЫЛКА Документ.ВводОстатковВнеоборотныхАктивов2_4
	|
	|	И ДанныеРегистра.НематериальныйАктив В
	|			(ВЫБРАТЬ
	|				СписокНМА.НематериальныйАктив
	|			ИЗ
	|				СписокОбъектовУчета_БУ КАК СписокНМА
	|			ГДЕ
	|				СписокНМА.НачалоМесяца = &НачалоМесяца
	|				И СписокНМА.АмортизацияНачисляетсяСДатыПринятияКУчету)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	&НачалоПредыдущегоМесяца КАК НачалоМесяца,
	|	&КонецПозапрошлогоМесяца КАК ПериодПараметров,
	|	ДанныеРегистра.Период КАК Период,
	|	ДанныеРегистра.МоментВремени КАК МоментВремени,
	|	ДанныеРегистра.Регистратор КАК Регистратор,
	|	ДанныеРегистра.НематериальныйАктив КАК НематериальныйАктив,
	|	ДанныеРегистра.Организация КАК Организация,
	|	ДанныеРегистра.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	ДанныеРегистра.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ДанныеРегистра.ОбъемНаработки КАК ОбъемНаработки
	|ИЗ
	|	РегистрСведений.ПорядокУчетаНМА КАК ДанныеРегистра
	|
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ СписокОбъектовУчета_Доначисление_БУ КАК Доначисление
	|		ПО ДанныеРегистра.НематериальныйАктив = Доначисление.НематериальныйАктив
	|
	|ГДЕ
	|	ДанныеРегистра.Активность
	|	И ДанныеРегистра.Период МЕЖДУ &НачалоПредыдущегоМесяца И &КонецПредыдущегоМесяца
	|	И ДанныеРегистра.Период >= Доначисление.Период
	|
	|	И НЕ ДанныеРегистра.Регистратор ССЫЛКА Документ.ПринятиеКУчетуНМА2_4
	|	И НЕ ДанныеРегистра.Регистратор ССЫЛКА Документ.ВводОстатковВнеоборотныхАктивов2_4
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	// ПорядокУчетаНМАБУ
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	&НачалоМесяца КАК НачалоМесяца,
	|	&КонецПредыдущегоМесяца КАК ПериодПараметров,
	|	ДанныеРегистра.Период КАК Период,
	|	ДанныеРегистра.МоментВремени КАК МоментВремени,
	|	ДанныеРегистра.Регистратор КАК Регистратор,
	|	ДанныеРегистра.НематериальныйАктив КАК НематериальныйАктив,
	|	ДанныеРегистра.Организация КАК Организация,
	|	ДанныеРегистра.СостояниеБУ КАК СостояниеБУ,
	|	ДанныеРегистра.НачислятьАмортизациюБУ КАК НачислятьАмортизациюБУ,
	|	ДанныеРегистра.СпособОтраженияРасходовБУ КАК СпособОтраженияРасходовБУ,
	|	ДанныеРегистра.СтатьяРасходовБУ КАК СтатьяРасходовБУ,
	|	ДанныеРегистра.АналитикаРасходовБУ КАК АналитикаРасходовБУ,
	|	ДанныеРегистра.ПередаватьРасходыВДругуюОрганизацию КАК ПередаватьРасходыВДругуюОрганизацию,
	|	ДанныеРегистра.ОрганизацияПолучательРасходов КАК ОрганизацияПолучательРасходов
	|
	|ПОМЕСТИТЬ ПорядокУчетаНМАБУ_Изменения
	|
	|ИЗ
	|	РегистрСведений.ПорядокУчетаНМАБУ КАК ДанныеРегистра
	|
	|ГДЕ
	|	ДанныеРегистра.Активность
	|	И ДанныеРегистра.Период МЕЖДУ &НачалоМесяца И &КонецМесяца
	|
	|	И НЕ ДанныеРегистра.Регистратор ССЫЛКА Документ.ПринятиеКУчетуНМА2_4
	|	И НЕ ДанныеРегистра.Регистратор ССЫЛКА Документ.ВводОстатковВнеоборотныхАктивов2_4
	|
	|	И ДанныеРегистра.НематериальныйАктив В
	|			(ВЫБРАТЬ
	|				СписокНМА.НематериальныйАктив
	|			ИЗ
	|				СписокОбъектовУчета_БУ КАК СписокНМА
	|			ГДЕ
	|				СписокНМА.НачалоМесяца = &НачалоМесяца
	|				И СписокНМА.АмортизацияНачисляетсяСДатыПринятияКУчету)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	&НачалоПредыдущегоМесяца КАК НачалоМесяца,
	|	&КонецПозапрошлогоМесяца КАК ПериодПараметров,
	|	ДанныеРегистра.Период КАК Период,
	|	ДанныеРегистра.МоментВремени КАК МоментВремени,
	|	ДанныеРегистра.Регистратор КАК Регистратор,
	|	ДанныеРегистра.НематериальныйАктив КАК НематериальныйАктив,
	|	ДанныеРегистра.Организация КАК Организация,
	|	ДанныеРегистра.СостояниеБУ КАК СостояниеБУ,
	|	ДанныеРегистра.НачислятьАмортизациюБУ КАК НачислятьАмортизациюБУ,
	|	ДанныеРегистра.СпособОтраженияРасходовБУ КАК СпособОтраженияРасходовБУ,
	|	ДанныеРегистра.СтатьяРасходовБУ КАК СтатьяРасходовБУ,
	|	ДанныеРегистра.АналитикаРасходовБУ КАК АналитикаРасходовБУ,
	|	ДанныеРегистра.ПередаватьРасходыВДругуюОрганизацию КАК ПередаватьРасходыВДругуюОрганизацию,
	|	ДанныеРегистра.ОрганизацияПолучательРасходов КАК ОрганизацияПолучательРасходов
	|
	|ИЗ
	|	РегистрСведений.ПорядокУчетаНМАБУ КАК ДанныеРегистра
	|
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ СписокОбъектовУчета_Доначисление_БУ КАК Доначисление
	|		ПО ДанныеРегистра.НематериальныйАктив = Доначисление.НематериальныйАктив
	|
	|ГДЕ
	|	ДанныеРегистра.Активность
	|	И ДанныеРегистра.Период МЕЖДУ &НачалоПредыдущегоМесяца И &КонецПредыдущегоМесяца
	|	И ДанныеРегистра.Период >= Доначисление.Период
	|
	|	И НЕ ДанныеРегистра.Регистратор ССЫЛКА Документ.ПринятиеКУчетуНМА2_4
	|	И НЕ ДанныеРегистра.Регистратор ССЫЛКА Документ.ВводОстатковВнеоборотныхАктивов2_4
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	// МестоУчетаНМА
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	&НачалоМесяца КАК НачалоМесяца,
	|	&КонецПредыдущегоМесяца КАК ПериодПараметров,
	|	ДанныеРегистра.Период КАК Период,
	|	ДанныеРегистра.МоментВремени КАК МоментВремени,
	|	ДанныеРегистра.Регистратор КАК Регистратор,
	|	ДанныеРегистра.НематериальныйАктив КАК НематериальныйАктив,
	|	ДанныеРегистра.Организация КАК Организация,
	|	ДанныеРегистра.Подразделение КАК Подразделение
	|
	|ПОМЕСТИТЬ МестоУчетаНМА_ИзмененияБУ
	|
	|ИЗ
	|	РегистрСведений.МестоУчетаНМА КАК ДанныеРегистра
	|ГДЕ
	|	ДанныеРегистра.Активность
	|	И ДанныеРегистра.Период МЕЖДУ &НачалоМесяца И &КонецМесяца
	|
	|	И НЕ ДанныеРегистра.Регистратор ССЫЛКА Документ.ПринятиеКУчетуНМА2_4
	|	И НЕ ДанныеРегистра.Регистратор ССЫЛКА Документ.ВводОстатковВнеоборотныхАктивов2_4
	|
	|	И ДанныеРегистра.НематериальныйАктив В
	|			(ВЫБРАТЬ
	|				СписокНМА.НематериальныйАктив
	|			ИЗ
	|				СписокОбъектовУчета_БУ КАК СписокНМА
	|			ГДЕ
	|				СписокНМА.НачалоМесяца = &НачалоМесяца
	|				И СписокНМА.АмортизацияНачисляетсяСДатыПринятияКУчету)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	&НачалоПредыдущегоМесяца КАК НачалоМесяца,
	|	&КонецПозапрошлогоМесяца КАК ПериодПараметров,
	|	ДанныеРегистра.Период КАК Период,
	|	ДанныеРегистра.МоментВремени КАК МоментВремени,
	|	ДанныеРегистра.Регистратор КАК Регистратор,
	|	ДанныеРегистра.НематериальныйАктив КАК НематериальныйАктив,
	|	ДанныеРегистра.Организация КАК Организация,
	|	ДанныеРегистра.Подразделение КАК Подразделение
	|ИЗ
	|	РегистрСведений.МестоУчетаНМА КАК ДанныеРегистра
	|
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ СписокОбъектовУчета_Доначисление_БУ КАК Доначисление
	|		ПО ДанныеРегистра.НематериальныйАктив = Доначисление.НематериальныйАктив
	|
	|ГДЕ
	|	ДанныеРегистра.Активность
	|	И ДанныеРегистра.Период МЕЖДУ &НачалоПредыдущегоМесяца И &КонецПредыдущегоМесяца
	|	И ДанныеРегистра.Период >= Доначисление.Период
	|
	|	И НЕ ДанныеРегистра.Регистратор ССЫЛКА Документ.ПринятиеКУчетуНМА2_4
	|	И НЕ ДанныеРегистра.Регистратор ССЫЛКА Документ.ВводОстатковВнеоборотныхАктивов2_4";
	СписокЗапросов.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ИзменениеСтоимости
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	СтоимостьНМА.НачалоМесяца КАК НачалоМесяца,
	|	&КонецПредыдущегоМесяца КАК ПериодПараметров,
	|	СтоимостьНМА.Период КАК Период,
	|	СтоимостьНМА.Регистратор КАК Регистратор,
	|	СтоимостьНМА.НематериальныйАктив КАК НематериальныйАктив,
	|	СтоимостьНМА.Организация КАК Организация,
	|
	|	СУММА(СтоимостьНМА.СтоимостьРегл) КАК СтоимостьРегл,
	|	СУММА(СтоимостьНМА.СтоимостьПР) КАК СтоимостьПР
	|
	|ПОМЕСТИТЬ СтоимостьНМА_ИзмененияБУ
	|
	|ИЗ
	|	(ВЫБРАТЬ
	|		&НачалоМесяца КАК НачалоМесяца,
	|		СтоимостьНМА.Период КАК Период,
	|		СтоимостьНМА.Регистратор КАК Регистратор,
	|		СтоимостьНМА.НематериальныйАктив КАК НематериальныйАктив,
	|		СтоимостьНМА.Организация КАК Организация,
	|		СтоимостьНМА.ПредварительнаяСтоимостьРегл КАК СтоимостьРегл,
	|		0 КАК СтоимостьПР
	|	ИЗ
	|		РегистрНакопления.СтоимостьНМА КАК СтоимостьНМА
	|
	|	ГДЕ
	|		СтоимостьНМА.Активность
	|		И СтоимостьНМА.Период МЕЖДУ &НачалоМесяца И &КонецМесяца
	|		И СтоимостьНМА.ОтражатьВРеглУчете
	|		И СтоимостьНМА.Регистратор ССЫЛКА Документ.УлучшениеНМА
	|
	|		И СтоимостьНМА.НематериальныйАктив В
	|			(ВЫБРАТЬ
	|				СписокНМА.НематериальныйАктив
	|			ИЗ
	|				СписокОбъектовУчета_БУ КАК СписокНМА
	|			ГДЕ
	|				СписокНМА.НачалоМесяца = &НачалоМесяца
	|				И СписокНМА.АмортизацияНачисляетсяСДатыПринятияКУчету)
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		&НачалоМесяца,
	|		СписаниеНМА2_4.Дата,
	|		СписаниеНМА2_4.Ссылка,
	|		ТаблицаНМА.НематериальныйАктив,
	|		СписаниеНМА2_4.Организация,
	|		-ТаблицаНМА.СуммаСписанияБУ,
	|		-ТаблицаНМА.СуммаСписанияПР
	|	ИЗ
	|		Документ.СписаниеНМА2_4 КАК СписаниеНМА2_4
	|
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.СписаниеНМА2_4.НМА КАК ТаблицаНМА
	|			ПО (ТаблицаНМА.Ссылка = СписаниеНМА2_4.Ссылка)
	|	ГДЕ
	|		СписаниеНМА2_4.Проведен
	|		И СписаниеНМА2_4.Дата МЕЖДУ &НачалоМесяца И &КонецМесяца
	|		И СписаниеНМА2_4.ОтражатьВРеглУчете
	|		И СписаниеНМА2_4.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеНМАЧастичное)
	|		И ТаблицаНМА.СуммаСписанияБУ <> 0
	|
	|		И ТаблицаНМА.НематериальныйАктив В
	|			(ВЫБРАТЬ
	|				СписокНМА.НематериальныйАктив
	|			ИЗ
	|				СписокОбъектовУчета_БУ КАК СписокНМА
	|			ГДЕ
	|				СписокНМА.НачалоМесяца = &НачалоМесяца
	|				И СписокНМА.АмортизацияНачисляетсяСДатыПринятияКУчету)
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		&НачалоМесяца,
	|		ПереоценкаНМА.Дата,
	|		ПереоценкаНМА.Ссылка,
	|		ТаблицаНМА.НематериальныйАктив,
	|		ПереоценкаНМА.Организация,
	|		ТаблицаНМА.СтоимостьБУ,
	|		0
	|	ИЗ
	|		Документ.ПереоценкаНМА2_4 КАК ПереоценкаНМА
	|
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ПереоценкаНМА2_4.НМА КАК ТаблицаНМА
	|			ПО (ТаблицаНМА.Ссылка = ПереоценкаНМА.Ссылка)
	|	ГДЕ
	|		ПереоценкаНМА.Проведен
	|		И ПереоценкаНМА.Дата МЕЖДУ &НачалоМесяца И &КонецМесяца
	|		И ПереоценкаНМА.ОтражатьВРеглУчете
	|		И ТаблицаНМА.СтоимостьБУ <> 0
	|
	|		И ТаблицаНМА.НематериальныйАктив В
	|			(ВЫБРАТЬ
	|				СписокНМА.НематериальныйАктив
	|			ИЗ
	|				СписокОбъектовУчета_БУ КАК СписокНМА
	|			ГДЕ
	|				СписокНМА.НачалоМесяца = &НачалоМесяца
	|				И СписокНМА.АмортизацияНачисляетсяСДатыПринятияКУчету)
	|
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		&НачалоМесяца,
	|		Корректировка.Дата,
	|		Корректировка.Ссылка,
	|		ТаблицаНМА.НематериальныйАктив,
	|		Корректировка.Организация,
	|		ТаблицаНМА.СтоимостьБУ,
	|		ТаблицаНМА.СтоимостьПР
	|	ИЗ
	|		Документ.КорректировкаСтоимостиИАмортизацииНМА КАК Корректировка
	|
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаСтоимостиИАмортизацииНМА.НМА КАК ТаблицаНМА
	|			ПО (ТаблицаНМА.Ссылка = Корректировка.Ссылка)
	|	ГДЕ
	|		Корректировка.Проведен
	|		И Корректировка.Дата МЕЖДУ &НачалоМесяца И &КонецМесяца
	|		И Корректировка.ОтражатьВРеглУчете
	|		И ТаблицаНМА.СтоимостьБУ <> 0
	|
	|		И ТаблицаНМА.НематериальныйАктив В
	|			(ВЫБРАТЬ
	|				СписокНМА.НематериальныйАктив
	|			ИЗ
	|				СписокОбъектовУчета_БУ КАК СписокНМА
	|			ГДЕ
	|				СписокНМА.НачалоМесяца = &НачалоМесяца
	|				И СписокНМА.АмортизацияНачисляетсяСДатыПринятияКУчету)
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		&НачалоПредыдущегоМесяца,
	|		СтоимостьНМА.Период,
	|		СтоимостьНМА.Регистратор,
	|		СтоимостьНМА.НематериальныйАктив,
	|		СтоимостьНМА.Организация,
	|		СтоимостьНМА.СтоимостьРегл - СтоимостьНМА.ПредварительнаяСтоимостьРегл,
	|		СтоимостьНМА.СтоимостьПР
	|	ИЗ
	|		РегистрНакопления.СтоимостьНМА КАК СтоимостьНМА
	|
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ СписокОбъектовУчета_Доначисление_БУ КАК Доначисление
	|			ПО СтоимостьНМА.НематериальныйАктив = Доначисление.НематериальныйАктив
	|
	|	ГДЕ
	|		СтоимостьНМА.Активность
	|		И СтоимостьНМА.Период МЕЖДУ &НачалоПредыдущегоМесяца И &КонецПредыдущегоМесяца
	|		И СтоимостьНМА.ОтражатьВРеглУчете
	|		И СтоимостьНМА.Период >= Доначисление.Период
	|
	|		И СтоимостьНМА.Регистратор ССЫЛКА Документ.УлучшениеНМА
	|
	|		И СтоимостьНМА.НематериальныйАктив В
	|			(ВЫБРАТЬ
	|				СписокНМА.НематериальныйАктив
	|			ИЗ
	|				СписокОбъектовУчета_БУ КАК СписокНМА
	|			ГДЕ
	|				СписокНМА.НачалоМесяца = &НачалоПредыдущегоМесяца
	|				И СписокНМА.АмортизацияНачисляетсяСДатыПринятияКУчету)
	|
	|	) КАК СтоимостьНМА
	|
	|СГРУППИРОВАТЬ ПО
	|	СтоимостьНМА.НачалоМесяца,
	|	СтоимостьНМА.Период,
	|	СтоимостьНМА.Регистратор,
	|	СтоимостьНМА.НематериальныйАктив,
	|	СтоимостьНМА.Организация
	|
	|ИМЕЮЩИЕ
	|	СУММА(СтоимостьНМА.СтоимостьРегл) <> 0
	|";
	СписокЗапросов.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ИзменениеАмортизации
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	&НачалоМесяца КАК НачалоМесяца,
	|	&КонецПредыдущегоМесяца КАК ПериодПараметров,
	|	Корректировка.Дата КАК Период,
	|	Корректировка.Ссылка КАК Регистратор,
	|	ТаблицаНМА.НематериальныйАктив КАК НематериальныйАктив,
	|	Корректировка.Организация КАК Организация,
	|	ТаблицаНМА.АмортизацияБУ КАК АмортизацияРегл,
	|	ТаблицаНМА.АмортизацияПР КАК АмортизацияПР
	|
	|ПОМЕСТИТЬ АмортизацияНМА_ИзмененияБУ
	|
	|ИЗ
	|	Документ.КорректировкаСтоимостиИАмортизацииНМА КАК Корректировка
	|
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаСтоимостиИАмортизацииНМА.НМА КАК ТаблицаНМА
	|		ПО (ТаблицаНМА.Ссылка = Корректировка.Ссылка)
	|ГДЕ
	|	Корректировка.Проведен
	|	И Корректировка.Дата МЕЖДУ &НачалоМесяца И &КонецМесяца
	|	И Корректировка.ОтражатьВРеглУчете
	|	И ТаблицаНМА.АмортизацияБУ <> 0
	|
	|	И ТаблицаНМА.НематериальныйАктив В
	|		(ВЫБРАТЬ
	|			СписокНМА.НематериальныйАктив
	|		ИЗ
	|			СписокОбъектовУчета_БУ КАК СписокНМА
	|		ГДЕ
	|			СписокНМА.НачалоМесяца = &НачалоМесяца
	|			И СписокНМА.АмортизацияНачисляетсяСДатыПринятияКУчету)";
	СписокЗапросов.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область ОбъединениеВсехИзменений
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ТаблицаИзменений.НачалоМесяца КАК НачалоМесяца,
	|	ТаблицаИзменений.ПериодПараметров КАК ПериодПараметров,
	|	ТаблицаИзменений.Регистратор,
	|	МАКСИМУМ(ТаблицаИзменений.Период) КАК Период,
	|	МАКСИМУМ(НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(ТаблицаИзменений.Период, МЕСЯЦ, 1), МЕСЯЦ)) КАК НачалоСледующегоМесяца,
	|	ТаблицаИзменений.НематериальныйАктив КАК НематериальныйАктив,
	|	ТаблицаИзменений.Организация КАК Организация,
	|	МАКСИМУМ(ПервоначальныеСведенияНМАПоследнее.Период) КАК ПервоначальныеСведенияНМАПоследнееПериод,
	|	МАКСИМУМ(ПараметрыАмортизацииНМАБУПоследнее.Период) КАК ПараметрыАмортизацииНМАБУПоследнееПериод,
	|	МАКСИМУМ(ПорядокУчетаНМАИзмененияПоследнее.Период) КАК ПорядокУчетаНМАИзмененияПоследнееПериод,
	|	МАКСИМУМ(ПорядокУчетаНМАБУИзмененияПоследнее.Период) КАК ПорядокУчетаНМАБУИзмененияПоследнееПериод,
	|	МАКСИМУМ(МестоУчетаНМАИзмененияПоследнее.Период) КАК МестоУчетаНМАИзмененияПоследнееПериод
	|
	|ПОМЕСТИТЬ ТаблицаИзмененийБУ
	|
	|ИЗ
	|	(ВЫБРАТЬ
	|		ТаблицаИзменений.НачалоМесяца КАК НачалоМесяца,
	|		ТаблицаИзменений.ПериодПараметров КАК ПериодПараметров,
	|		ТаблицаИзменений.Регистратор КАК Регистратор,
	|		ТаблицаИзменений.Период КАК Период,
	|		ТаблицаИзменений.НематериальныйАктив КАК НематериальныйАктив,
	|		ТаблицаИзменений.Организация КАК Организация
	|	ИЗ
	|		ПараметрыАмортизацииНМАБУ_Изменения КАК ТаблицаИзменений
	|	
	|	ОБЪЕДИНИТЬ
	|	
	|	ВЫБРАТЬ
	|		ТаблицаИзменений.НачалоМесяца КАК НачалоМесяца,
	|		ТаблицаИзменений.ПериодПараметров КАК ПериодПараметров,
	|		ТаблицаИзменений.Регистратор КАК Регистратор,
	|		ТаблицаИзменений.Период КАК Период,
	|		ТаблицаИзменений.НематериальныйАктив КАК НематериальныйАктив,
	|		ТаблицаИзменений.Организация КАК Организация
	|	ИЗ
	|		ПервоначальныеСведенияНМА_ИзмененияБУ КАК ТаблицаИзменений
	|	
	|	ОБЪЕДИНИТЬ
	|
	|	ВЫБРАТЬ
	|		ТаблицаИзменений.НачалоМесяца,
	|		ТаблицаИзменений.ПериодПараметров КАК ПериодПараметров,
	|		ТаблицаИзменений.Регистратор,
	|		ТаблицаИзменений.Период,
	|		ТаблицаИзменений.НематериальныйАктив,
	|		ТаблицаИзменений.Организация
	|	ИЗ
	|		ПорядокУчетаНМА_ИзмененияБУ КАК ТаблицаИзменений
	|	
	|	ОБЪЕДИНИТЬ
	|	
	|	ВЫБРАТЬ
	|		ТаблицаИзменений.НачалоМесяца,
	|		ТаблицаИзменений.ПериодПараметров КАК ПериодПараметров,
	|		ТаблицаИзменений.Регистратор,
	|		ТаблицаИзменений.Период,
	|		ТаблицаИзменений.НематериальныйАктив,
	|		ТаблицаИзменений.Организация
	|	ИЗ
	|		ПорядокУчетаНМАБУ_Изменения КАК ТаблицаИзменений
	|	
	|	ОБЪЕДИНИТЬ
	|	
	|	ВЫБРАТЬ
	|		ТаблицаИзменений.НачалоМесяца,
	|		ТаблицаИзменений.ПериодПараметров КАК ПериодПараметров,
	|		ТаблицаИзменений.Регистратор,
	|		ТаблицаИзменений.Период,
	|		ТаблицаИзменений.НематериальныйАктив,
	|		ТаблицаИзменений.Организация
	|	ИЗ
	|		МестоУчетаНМА_ИзмененияБУ КАК ТаблицаИзменений
	|
	|	ОБЪЕДИНИТЬ
	|	
	|	ВЫБРАТЬ
	|		ТаблицаИзменений.НачалоМесяца,
	|		ТаблицаИзменений.ПериодПараметров КАК ПериодПараметров,
	|		ТаблицаИзменений.Регистратор,
	|		ТаблицаИзменений.Период,
	|		ТаблицаИзменений.НематериальныйАктив,
	|		ТаблицаИзменений.Организация
	|	ИЗ
	|		СтоимостьНМА_ИзмененияБУ КАК ТаблицаИзменений
	|
	|	ОБЪЕДИНИТЬ
	|	
	|	ВЫБРАТЬ
	|		ТаблицаИзменений.НачалоМесяца,
	|		ТаблицаИзменений.ПериодПараметров КАК ПериодПараметров,
	|		ТаблицаИзменений.Регистратор,
	|		ТаблицаИзменений.Период,
	|		ТаблицаИзменений.НематериальныйАктив,
	|		ТаблицаИзменений.Организация
	|	ИЗ
	|		АмортизацияНМА_ИзмененияБУ КАК ТаблицаИзменений
	|
	|	) КАК ТаблицаИзменений
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПервоначальныеСведенияНМА_ИзмененияБУ КАК ПервоначальныеСведенияНМАПоследнее
	|		ПО (ПервоначальныеСведенияНМАПоследнее.Организация = ТаблицаИзменений.Организация)
	|			И (ПервоначальныеСведенияНМАПоследнее.НематериальныйАктив = ТаблицаИзменений.НематериальныйАктив)
	|			И (ПервоначальныеСведенияНМАПоследнее.НачалоМесяца = ТаблицаИзменений.НачалоМесяца)
	|			И (ПервоначальныеСведенияНМАПоследнее.Период <= ТаблицаИзменений.Период)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПараметрыАмортизацииНМАБУ_Изменения КАК ПараметрыАмортизацииНМАБУПоследнее
	|		ПО (ПараметрыАмортизацииНМАБУПоследнее.Организация = ТаблицаИзменений.Организация)
	|			И (ПараметрыАмортизацииНМАБУПоследнее.НематериальныйАктив = ТаблицаИзменений.НематериальныйАктив)
	|			И (ПараметрыАмортизацииНМАБУПоследнее.НачалоМесяца = ТаблицаИзменений.НачалоМесяца)
	|			И (ПараметрыАмортизацииНМАБУПоследнее.Период <= ТаблицаИзменений.Период)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПорядокУчетаНМА_ИзмененияБУ КАК ПорядокУчетаНМАИзмененияПоследнее
	|		ПО (ПорядокУчетаНМАИзмененияПоследнее.НематериальныйАктив = ТаблицаИзменений.НематериальныйАктив)
	|			И (ПорядокУчетаНМАИзмененияПоследнее.НачалоМесяца = ТаблицаИзменений.НачалоМесяца)
	|			И (ПорядокУчетаНМАИзмененияПоследнее.Период <= ТаблицаИзменений.Период)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПорядокУчетаНМАБУ_Изменения КАК ПорядокУчетаНМАБУИзмененияПоследнее
	|		ПО (ПорядокУчетаНМАБУИзмененияПоследнее.Организация = ТаблицаИзменений.Организация)
	|			И (ПорядокУчетаНМАБУИзмененияПоследнее.НематериальныйАктив = ТаблицаИзменений.НематериальныйАктив)
	|			И (ПорядокУчетаНМАБУИзмененияПоследнее.НачалоМесяца = ТаблицаИзменений.НачалоМесяца)
	|			И (ПорядокУчетаНМАБУИзмененияПоследнее.Период <= ТаблицаИзменений.Период)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ МестоУчетаНМА_ИзмененияБУ КАК МестоУчетаНМАИзмененияПоследнее
	|		ПО (МестоУчетаНМАИзмененияПоследнее.Организация = ТаблицаИзменений.Организация)
	|			И (МестоУчетаНМАИзмененияПоследнее.НематериальныйАктив = ТаблицаИзменений.НематериальныйАктив)
	|			И (МестоУчетаНМАИзмененияПоследнее.НачалоМесяца = ТаблицаИзменений.НачалоМесяца)
	|			И (МестоУчетаНМАИзмененияПоследнее.Период <= ТаблицаИзменений.Период)
	|
	|ГДЕ
	|	ТаблицаИзменений.НематериальныйАктив В (
	|		ВЫБРАТЬ
	|			СписокНМА.НематериальныйАктив
	|		ИЗ
	|			СписокОбъектовУчета_БУ КАК СписокНМА)
	|
	|СГРУППИРОВАТЬ ПО
	|	ТаблицаИзменений.НачалоМесяца,
	|	ТаблицаИзменений.ПериодПараметров,
	|	ТаблицаИзменений.Регистратор,
	|	ТаблицаИзменений.Организация,
	|	ТаблицаИзменений.НематериальныйАктив
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ТаблицаИзменений.Организация,
	|	ТаблицаИзменений.НематериальныйАктив,
	|	ТаблицаИзменений.НачалоМесяца,
	|	ТаблицаИзменений.Регистратор,
	|	МИНИМУМ(ТаблицаИзмененийСледующее.Период) КАК ПериодСледующее
	|ПОМЕСТИТЬ ТаблицаИзмененийСледующееБУ
	|ИЗ
	|	ТаблицаИзмененийБУ КАК ТаблицаИзменений
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаИзмененийБУ КАК ТаблицаИзмененийСледующее
	|		ПО (ТаблицаИзмененийСледующее.Организация = ТаблицаИзменений.Организация)
	|			И (ТаблицаИзмененийСледующее.НематериальныйАктив = ТаблицаИзменений.НематериальныйАктив)
	|			И (ТаблицаИзмененийСледующее.НачалоМесяца = ТаблицаИзменений.НачалоМесяца)
	|			И (ТаблицаИзмененийСледующее.Период > ТаблицаИзменений.Период
	|				ИЛИ ТаблицаИзмененийСледующее.Период = ТаблицаИзменений.Период
	|						И ТаблицаИзмененийСледующее.Регистратор > ТаблицаИзменений.Регистратор)
	|
	|СГРУППИРОВАТЬ ПО
	|	ТаблицаИзменений.НачалоМесяца,
	|	ТаблицаИзменений.Регистратор,
	|	ТаблицаИзменений.Организация,
	|	ТаблицаИзменений.НематериальныйАктив
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ТаблицаИзменений.Организация,
	|	ТаблицаИзменений.НематериальныйАктив,
	|	МИНИМУМ(ТаблицаИзменений.Период) КАК ПериодСледующее
	|ПОМЕСТИТЬ ТаблицаИзмененийВЭтомМесяцеБУ
	|ИЗ
	|	ТаблицаИзмененийБУ КАК ТаблицаИзменений
	|ГДЕ
	|	(ТаблицаИзменений.НачалоМесяца = &НачалоМесяца)
	|
	|СГРУППИРОВАТЬ ПО
	|	ТаблицаИзменений.Организация,
	|	ТаблицаИзменений.НематериальныйАктив";
	СписокЗапросов.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#Область Изменения_БУ
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ТаблицаИзменений.НачалоМесяца КАК НачалоМесяца,
	|
	|	ВЫБОР
	|		КОГДА НАЧАЛОПЕРИОДА(ДатыПоследнегоИзменения.ДатаДокументаПринятияКУчетуБУ, МЕСЯЦ) = ТаблицаИзменений.НачалоМесяца
	|			ТОГДА НАЧАЛОПЕРИОДА(ДатыПоследнегоИзменения.ДатаДокументаПринятияКУчетуБУ, ДЕНЬ)
	|		ИНАЧЕ ТаблицаИзменений.ПериодПараметров 
	|	КОНЕЦ КАК ПериодПараметров,
	|
	|	КОНЕЦПЕРИОДА(ТаблицаИзменений.НачалоМесяца, МЕСЯЦ) КАК КонецМесяца,
	|	КОНЕЦПЕРИОДА(ТаблицаИзменений.Период, ДЕНЬ) КАК ДатаИзменений,
	|	ТаблицаИзменений.Регистратор КАК Регистратор,
	|	ТаблицаИзменений.НематериальныйАктив КАК НематериальныйАктив,
	|	ТаблицаИзменений.Организация КАК Организация,
	|
	|	ВЫБОР 
	|		КОГДА ТаблицаИзменений.НачалоМесяца = &НачалоПредыдущегоМесяца
	|				И НАЧАЛОПЕРИОДА(ЕСТЬNULL(ТаблицаИзмененийВЭтомМесяце.ПериодСледующее, &КонецМесяца), ДЕНЬ) = &НачалоМесяца
	|			ТОГДА &НачалоМесяца 
	|		КОГДА ТаблицаИзменений.НачалоМесяца = &НачалоПредыдущегоМесяца
	|			ТОГДА ЕСТЬNULL(ДОБАВИТЬКДАТЕ(ТаблицаИзмененийВЭтомМесяце.ПериодСледующее, ДЕНЬ, -1), &КонецМесяца) 
	|		ИНАЧЕ ЕСТЬNULL(ДОБАВИТЬКДАТЕ(ТаблицаИзмененийСледующее.ПериодСледующее, ДЕНЬ, -1), &КонецМесяца) 
	|	КОНЕЦ КАК Период,
	|
	|	РАЗНОСТЬДАТ(ТаблицаИзменений.Период, ЕСТЬNULL(ТаблицаИзмененийСледующее.ПериодСледующее, ТаблицаИзменений.НачалоСледующегоМесяца), ДЕНЬ) КАК СрокДействия,
	|	ЕСТЬNULL(СтоимостьНМАИзменения.СтоимостьРегл, 0) КАК СтоимостьРеглИзменение,
	|	ЕСТЬNULL(СтоимостьНМАИзменения.СтоимостьПР, 0) КАК СтоимостьПРИзменение,
	|	ЕСТЬNULL(АмортизацияНМАИзменения.АмортизацияРегл, 0) КАК АмортизацияРеглИзменение,
	|	ЕСТЬNULL(АмортизацияНМАИзменения.АмортизацияПР, 0) КАК АмортизацияПРИзменение,
	|
	|	ПараметрыАмортизацииНМАБУПоследнее.ДатаПоследнегоИзменения КАК ДатаПоследнегоИзменения,
	|	ПараметрыАмортизацииНМАБУПоследнее.СрокИспользования КАК СрокИспользования,
	|	ПараметрыАмортизацииНМАБУПоследнее.ОбъемНаработки КАК ОбъемНаработки,
	|	ПараметрыАмортизацииНМАБУПоследнее.КоэффициентБУ КАК КоэффициентБУ,
	|	ПараметрыАмортизацииНМАБУПоследнее.ЛиквидационнаяСтоимость КАК ЛиквидационнаяСтоимость,
	|
	|	ПервоначальныеСведенияНМАПоследнее.МетодНачисленияАмортизацииБУ КАК МетодНачисленияАмортизацииБУ,
	|
	|	ПорядокУчетаНМАИзмененияПоследнее.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	ПорядокУчетаНМАИзмененияПоследнее.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|
	|	ПорядокУчетаНМАБУИзмененияПоследнее.СостояниеБУ КАК СостояниеБУ,
	|	ПорядокУчетаНМАБУИзмененияПоследнее.НачислятьАмортизациюБУ КАК НачислятьАмортизациюБУ,
	|	ПорядокУчетаНМАБУИзмененияПоследнее.СпособОтраженияРасходовБУ КАК СпособОтраженияРасходовБУ,
	|	ПорядокУчетаНМАБУИзмененияПоследнее.СтатьяРасходовБУ КАК СтатьяРасходовБУ,
	|	ПорядокУчетаНМАБУИзмененияПоследнее.АналитикаРасходовБУ КАК АналитикаРасходовБУ,
	|	ПорядокУчетаНМАБУИзмененияПоследнее.ПередаватьРасходыВДругуюОрганизацию КАК ПередаватьРасходыВДругуюОрганизацию,
	|	ПорядокУчетаНМАБУИзмененияПоследнее.ОрганизацияПолучательРасходов КАК ОрганизацияПолучательРасходов,
	|
	|	МестоУчетаНМАИзмененияПоследнее.Подразделение КАК Подразделение
	|
	|ПОМЕСТИТЬ Изменения_БУ
	|
	|ИЗ
	|	ТаблицаИзмененийБУ КАК ТаблицаИзменений
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаИзмененийСледующееБУ КАК ТаблицаИзмененийСледующее
	|		ПО (ТаблицаИзмененийСледующее.Организация = ТаблицаИзменений.Организация)
	|			И (ТаблицаИзмененийСледующее.НематериальныйАктив = ТаблицаИзменений.НематериальныйАктив)
	|			И (ТаблицаИзмененийСледующее.НачалоМесяца = ТаблицаИзменений.НачалоМесяца)
	|			И (ТаблицаИзмененийСледующее.Регистратор = ТаблицаИзменений.Регистратор)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаИзмененийВЭтомМесяцеБУ КАК ТаблицаИзмененийВЭтомМесяце
	|		ПО (ТаблицаИзмененийВЭтомМесяце.Организация = ТаблицаИзменений.Организация)
	|			И (ТаблицаИзмененийВЭтомМесяце.НематериальныйАктив = ТаблицаИзменений.НематериальныйАктив)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ДатыПоследнегоИзмененияБУ КАК ДатыПоследнегоИзменения
	|		ПО (ДатыПоследнегоИзменения.Организация = ТаблицаИзменений.Организация)
	|			И (ДатыПоследнегоИзменения.НематериальныйАктив = ТаблицаИзменений.НематериальныйАктив)
	|			И (ДатыПоследнегоИзменения.НачалоМесяца = ТаблицаИзменений.НачалоМесяца)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПервоначальныеСведенияНМА_ИзмененияБУ КАК ПервоначальныеСведенияНМАПоследнее
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПервоначальныеСведенияНМА_ИзмененияБУ КАК ПервоначальныеСведенияНМАСледующее
	|			ПО (ПервоначальныеСведенияНМАСледующее.Организация = ПервоначальныеСведенияНМАПоследнее.Организация)
	|				И (ПервоначальныеСведенияНМАСледующее.НематериальныйАктив = ПервоначальныеСведенияНМАПоследнее.НематериальныйАктив)
	|				И (ПервоначальныеСведенияНМАСледующее.НачалоМесяца = ПервоначальныеСведенияНМАПоследнее.НачалоМесяца)
	|				И (ПервоначальныеСведенияНМАСледующее.Период = ПервоначальныеСведенияНМАПоследнее.Период)
	|				И (ПервоначальныеСведенияНМАСледующее.МоментВремени > ПервоначальныеСведенияНМАПоследнее.МоментВремени)
	|		ПО (ПервоначальныеСведенияНМАПоследнее.Организация = ТаблицаИзменений.Организация)
	|			И (ПервоначальныеСведенияНМАПоследнее.НематериальныйАктив = ТаблицаИзменений.НематериальныйАктив)
	|			И (ПервоначальныеСведенияНМАПоследнее.НачалоМесяца = ТаблицаИзменений.НачалоМесяца)
	|			И (ПервоначальныеСведенияНМАПоследнее.Период = ТаблицаИзменений.ПервоначальныеСведенияНМАПоследнееПериод)
	|			И (ПервоначальныеСведенияНМАСледующее.Регистратор ЕСТЬ NULL)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПараметрыАмортизацииНМАБУ_Изменения КАК ПараметрыАмортизацииНМАБУПоследнее
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПараметрыАмортизацииНМАБУ_Изменения КАК ПараметрыАмортизацииНМАБУСледующее
	|			ПО (ПараметрыАмортизацииНМАБУСледующее.Организация = ПараметрыАмортизацииНМАБУПоследнее.Организация)
	|				И (ПараметрыАмортизацииНМАБУСледующее.НематериальныйАктив = ПараметрыАмортизацииНМАБУПоследнее.НематериальныйАктив)
	|				И (ПараметрыАмортизацииНМАБУСледующее.НачалоМесяца = ПараметрыАмортизацииНМАБУПоследнее.НачалоМесяца)
	|				И (ПараметрыАмортизацииНМАБУСледующее.Период = ПараметрыАмортизацииНМАБУПоследнее.Период)
	|				И (ПараметрыАмортизацииНМАБУСледующее.МоментВремени > ПараметрыАмортизацииНМАБУПоследнее.МоментВремени)
	|		ПО (ПараметрыАмортизацииНМАБУПоследнее.Организация = ТаблицаИзменений.Организация)
	|			И (ПараметрыАмортизацииНМАБУПоследнее.НематериальныйАктив = ТаблицаИзменений.НематериальныйАктив)
	|			И (ПараметрыАмортизацииНМАБУПоследнее.НачалоМесяца = ТаблицаИзменений.НачалоМесяца)
	|			И (ПараметрыАмортизацииНМАБУПоследнее.Период = ТаблицаИзменений.ПараметрыАмортизацииНМАБУПоследнееПериод)
	|			И (ПараметрыАмортизацииНМАБУСледующее.Регистратор ЕСТЬ NULL)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПорядокУчетаНМА_ИзмененияБУ КАК ПорядокУчетаНМАИзмененияПоследнее
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПорядокУчетаНМА_ИзмененияБУ КАК ПорядокУчетаНМАИзмененияСледующее
	|			ПО (ПорядокУчетаНМАИзмененияСледующее.Организация = ПорядокУчетаНМАИзмененияПоследнее.Организация)
	|				И (ПорядокУчетаНМАИзмененияСледующее.НематериальныйАктив = ПорядокУчетаНМАИзмененияПоследнее.НематериальныйАктив)
	|				И (ПорядокУчетаНМАИзмененияСледующее.НачалоМесяца = ПорядокУчетаНМАИзмененияПоследнее.НачалоМесяца)
	|				И (ПорядокУчетаНМАИзмененияСледующее.Период = ПорядокУчетаНМАИзмененияПоследнее.Период)
	|				И (ПорядокУчетаНМАИзмененияСледующее.МоментВремени > ПорядокУчетаНМАИзмененияПоследнее.МоментВремени)
	|		ПО (ПорядокУчетаНМАИзмененияПоследнее.НематериальныйАктив = ТаблицаИзменений.НематериальныйАктив)
	|			И (ПорядокУчетаНМАИзмененияПоследнее.НачалоМесяца = ТаблицаИзменений.НачалоМесяца)
	|			И (ПорядокУчетаНМАИзмененияПоследнее.Период = ТаблицаИзменений.ПорядокУчетаНМАИзмененияПоследнееПериод)
	|			И (ПорядокУчетаНМАИзмененияСледующее.Регистратор ЕСТЬ NULL)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПорядокУчетаНМАБУ_Изменения КАК ПорядокУчетаНМАБУИзмененияПоследнее
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПорядокУчетаНМАБУ_Изменения КАК ПорядокУчетаНМАБУИзмененияСледующее
	|			ПО (ПорядокУчетаНМАБУИзмененияСледующее.Организация = ПорядокУчетаНМАБУИзмененияПоследнее.Организация)
	|				И (ПорядокУчетаНМАБУИзмененияСледующее.НематериальныйАктив = ПорядокУчетаНМАБУИзмененияПоследнее.НематериальныйАктив)
	|				И (ПорядокУчетаНМАБУИзмененияСледующее.НачалоМесяца = ПорядокУчетаНМАБУИзмененияПоследнее.НачалоМесяца)
	|				И (ПорядокУчетаНМАБУИзмененияСледующее.Период = ПорядокУчетаНМАБУИзмененияПоследнее.Период)
	|				И (ПорядокУчетаНМАБУИзмененияСледующее.МоментВремени > ПорядокУчетаНМАБУИзмененияПоследнее.МоментВремени)
	|		ПО (ПорядокУчетаНМАБУИзмененияПоследнее.Организация = ТаблицаИзменений.Организация)
	|			И (ПорядокУчетаНМАБУИзмененияПоследнее.НематериальныйАктив = ТаблицаИзменений.НематериальныйАктив)
	|			И (ПорядокУчетаНМАБУИзмененияПоследнее.НачалоМесяца = ТаблицаИзменений.НачалоМесяца)
	|			И (ПорядокУчетаНМАБУИзмененияПоследнее.Период = ТаблицаИзменений.ПорядокУчетаНМАБУИзмененияПоследнееПериод)
	|			И (ПорядокУчетаНМАБУИзмененияСледующее.Регистратор ЕСТЬ NULL)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ МестоУчетаНМА_ИзмененияБУ КАК МестоУчетаНМАИзмененияПоследнее
	|			ЛЕВОЕ СОЕДИНЕНИЕ МестоУчетаНМА_ИзмененияБУ КАК МестоУчетаНМАИзмененияСледующее
	|			ПО (МестоУчетаНМАИзмененияСледующее.Организация = МестоУчетаНМАИзмененияПоследнее.Организация)
	|				И (МестоУчетаНМАИзмененияСледующее.НематериальныйАктив = МестоУчетаНМАИзмененияПоследнее.НематериальныйАктив)
	|				И (МестоУчетаНМАИзмененияСледующее.НачалоМесяца = МестоУчетаНМАИзмененияПоследнее.НачалоМесяца)
	|				И (МестоУчетаНМАИзмененияСледующее.Период = МестоУчетаНМАИзмененияПоследнее.Период)
	|				И (МестоУчетаНМАИзмененияСледующее.МоментВремени > МестоУчетаНМАИзмененияПоследнее.МоментВремени)
	|		ПО (МестоУчетаНМАИзмененияПоследнее.Организация = ТаблицаИзменений.Организация)
	|			И (МестоУчетаНМАИзмененияПоследнее.НематериальныйАктив = ТаблицаИзменений.НематериальныйАктив)
	|			И (МестоУчетаНМАИзмененияПоследнее.НачалоМесяца = ТаблицаИзменений.НачалоМесяца)
	|			И (МестоУчетаНМАИзмененияПоследнее.Период = ТаблицаИзменений.МестоУчетаНМАИзмененияПоследнееПериод)
	|			И (МестоУчетаНМАИзмененияСледующее.Регистратор ЕСТЬ NULL)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ СтоимостьНМА_ИзмененияБУ КАК СтоимостьНМАИзменения
	|		ПО (СтоимостьНМАИзменения.Организация = ТаблицаИзменений.Организация)
	|			И (СтоимостьНМАИзменения.НематериальныйАктив = ТаблицаИзменений.НематериальныйАктив)
	|			И (СтоимостьНМАИзменения.НачалоМесяца = ТаблицаИзменений.НачалоМесяца)
	|			И (СтоимостьНМАИзменения.Регистратор = ТаблицаИзменений.Регистратор)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ АмортизацияНМА_ИзмененияБУ КАК АмортизацияНМАИзменения
	|		ПО (АмортизацияНМАИзменения.Организация = ТаблицаИзменений.Организация)
	|			И (АмортизацияНМАИзменения.НематериальныйАктив = ТаблицаИзменений.НематериальныйАктив)
	|			И (АмортизацияНМАИзменения.НачалоМесяца = ТаблицаИзменений.НачалоМесяца)
	|			И (АмортизацияНМАИзменения.Регистратор = ТаблицаИзменений.Регистратор)
	|";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	#КонецОбласти
	
	#Область ПериодИзменения_БУ
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	Изменения_БУ.НачалоМесяца           КАК НачалоМесяца,
	|	Изменения_БУ.НематериальныйАктив    КАК НематериальныйАктив,
	|	Изменения_БУ.Организация            КАК Организация,
	|	МИНИМУМ(Изменения_БУ.ДатаИзменений) КАК Период
	|
	|ПОМЕСТИТЬ ПериодИзменения_БУ
	|
	|ИЗ
	|	Изменения_БУ КАК Изменения_БУ
	|
	|СГРУППИРОВАТЬ ПО
	|	Изменения_БУ.НачалоМесяца,
	|	Изменения_БУ.НематериальныйАктив,
	|	Изменения_БУ.Организация";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область СписокНМАСПараметрами_БУ
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	ВЫБОР 
	|		КОГДА ПериодИзмененияВТекущемМесяце.Период ЕСТЬ NULL
	|			ТОГДА СписокНМА.ПериодНачисления
	|		КОГДА НАЧАЛОПЕРИОДА(ПериодИзмененияВТекущемМесяце.Период, ДЕНЬ) = НАЧАЛОПЕРИОДА(ПериодИзмененияВТекущемМесяце.Период, МЕСЯЦ)
	|			ТОГДА ПериодИзмененияВТекущемМесяце.Период
	|		ИНАЧЕ ДОБАВИТЬКДАТЕ(ПериодИзмененияВТекущемМесяце.Период, ДЕНЬ, -1)
	|	КОНЕЦ КАК Период,
	|
	|	СписокНМА.ЭтоДоначисление,
	|	СписокНМА.НематериальныйАктив КАК НематериальныйАктив,
	|	СписокНМА.ВидОбъектаУчета КАК ВидОбъектаУчета,
	|	СписокНМА.Организация КАК Организация,
	|
	|	ПорядокУчетаНМА.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	ПорядокУчетаНМА.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ПорядокУчетаНМА.ОбъемНаработки КАК ОбъемНаработки,
	|
	|	ПараметрыАмортизацииНМАБУ.ЛиквидационнаяСтоимость КАК ЛиквидационнаяСтоимость,
	|
	|	СписокНМА.АмортизацияНачисляетсяПоСтандартамМУ КАК АмортизацияНачисляетсяПоСтандартамМУ,
	|	СписокНМА.ВариантПроводокПоОбесценениюВНА КАК ВариантПроводокПоОбесценениюВНА,
	|
	|	ВЫБОР
	|		КОГДА СписокНМА.АмортизацияНачисляетсяСДатыПринятияКУчету
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ПорядокНачисленияАмортизации.СДатыПринятияКУчету)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ПорядокНачисленияАмортизации.СоСледующегоМесяца)
	|	КОНЕЦ КАК ПорядокНачисленияАмортизацииБУ,
	|
	|	СписокНМА.НачислятьАмортизациюБУ КАК НачислятьАмортизациюБУ,
	|	СписокНМА.НачислятьАмортизациюНУ КАК НачислятьАмортизациюНУ,
	|
	|	СписокНМА.СтатьяРасходовБУ КАК СтатьяРасходов,
	|	СписокНМА.АналитикаРасходовБУ КАК АналитикаРасходов,
	|	СписокНМА.СпособОтраженияРасходовБУ КАК СпособОтраженияРасходов,
	|	СписокНМА.ПередаватьРасходыВДругуюОрганизациюБУ КАК ПередаватьРасходыВДругуюОрганизацию,
	|	СписокНМА.ОрганизацияПолучательРасходовБУ КАК ОрганизацияПолучательРасходов,
	|
	|	&ФактическийСрокИспользования КАК ФактическийСрокИспользования,
	|
	|	ЕСТЬNULL(СтоимостьНМА.Стоимость, 0)     КАК Стоимость,
	|
	|	ВЫБОР 
	|		КОГДА ТИПЗНАЧЕНИЯ(ПараметрыАмортизацииНМАБУ.Регистратор) <> ТИП(Документ.ВводОстатковВнеоборотныхАктивов2_4)
	|				И СписокНМА.АмортизацияНачисляетсяСДатыПринятияКУчету
	|				И НАЧАЛОПЕРИОДА(ДатыПоследнегоИзменения.Дата, МЕСЯЦ) = СписокНМА.НачалоМесяца
	|
	|			ТОГДА ЕСТЬNULL(ПредварительнаяСтоимостьНМА.СтоимостьРегл, 0)
	|
	|		ИНАЧЕ ЕСТЬNULL(СтоимостьНМА.СтоимостьРегл, 0)
	|
	|	КОНЕЦ КАК СтоимостьРегл,
	|
	|	ЕСТЬNULL(СтоимостьНМА.СтоимостьНУ, 0)   КАК СтоимостьНУ,
	|	ЕСТЬNULL(СтоимостьНМА.СтоимостьПР, 0)   КАК СтоимостьПР,
	|	ЕСТЬNULL(СтоимостьНМА.СтоимостьВР, 0)   КАК СтоимостьВР,
	|	ЕСТЬNULL(СтоимостьНМА.СтоимостьЦФ, 0)   КАК СтоимостьЦФ,
	|	ЕСТЬNULL(СтоимостьНМА.СтоимостьНУЦФ, 0) КАК СтоимостьНУЦФ,
	|	ЕСТЬNULL(СтоимостьНМА.СтоимостьПРЦФ, 0) КАК СтоимостьПРЦФ,
	|	ЕСТЬNULL(СтоимостьНМА.СтоимостьВРЦФ, 0) КАК СтоимостьВРЦФ,
	|	ЕСТЬNULL(СтоимостьНМАНаНачалоГода.СтоимостьРегл, 0) КАК СтоимостьНаНачалоГода,
	|
	|	ЕСТЬNULL(СтоимостьНМА.СтоимостьНУ, 0)
	|		+ ЕСТЬNULL(СтоимостьНМА.СтоимостьНУЦФ, 0) КАК СтоимостьНУНачальныйОстаток,
	|
	|	ЕСТЬNULL(АмортизацияНМА.Амортизация, 0) КАК Амортизация,
	|	ЕСТЬNULL(АмортизацияНМА.АмортизацияРегл, 0) КАК АмортизацияРегл,
	|	ЕСТЬNULL(АмортизацияНМА.АмортизацияНУ, 0) КАК АмортизацияНУ,
	|	ЕСТЬNULL(АмортизацияНМА.АмортизацияПР, 0) КАК АмортизацияПР,
	|	ЕСТЬNULL(АмортизацияНМА.АмортизацияВР, 0) КАК АмортизацияВР,
	|	ЕСТЬNULL(АмортизацияНМА.АмортизацияЦФ, 0) КАК АмортизацияЦФ,
	|	ЕСТЬNULL(АмортизацияНМА.АмортизацияНУЦФ, 0) КАК АмортизацияНУЦФ,
	|	ЕСТЬNULL(АмортизацияНМА.АмортизацияПРЦФ, 0) КАК АмортизацияПРЦФ,
	|	ЕСТЬNULL(АмортизацияНМА.АмортизацияВРЦФ, 0) КАК АмортизацияВРЦФ,
	|
	|	ЕСТЬNULL(АмортизацияНМА.АмортизацияНУ, 0)
	|		+ ЕСТЬNULL(АмортизацияНМА.АмортизацияНУЦФ, 0) КАК АмортизацияНУНачальныйОстаток,
	|
	|	ЕСТЬNULL(ОбесценениеНаНачалоМесяца.ОстатокОбесцененияРегл, 0) КАК ОстатокОбесцененияРегл,
	|
	|	МестоУчетаНМА.Подразделение,
	|
	|	ЕСТЬNULL(ВыработкаНМА.ОбъемВыработки, 0) КАК ОбъемВыработки,
	|
	|	ПервоначальныеСведенияНМА.МетодНачисленияАмортизацииБУ,
	|
	// МетодНачисленияАмортизацииНУ
	|	ВЫБОР
	|		КОГДА СписокНМА.ВидОбъектаУчета = ЗНАЧЕНИЕ(Перечисление.ВидыОбъектовУчетаНМА.РасходыНаНИОКР)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.МетодыНачисленияАмортизации.Линейный)
	|		ИНАЧЕ ВЫБОР
	|				КОГДА СписокНМА.АмортизационнаяГруппа В (
	|								ЗНАЧЕНИЕ(Перечисление.АмортизационныеГруппы.ВосьмаяГруппа), 
	|								ЗНАЧЕНИЕ(Перечисление.АмортизационныеГруппы.ДевятаяГруппа), 
	|								ЗНАЧЕНИЕ(Перечисление.АмортизационныеГруппы.ДесятаяГруппа), 
	|								ЗНАЧЕНИЕ(Перечисление.АмортизационныеГруппы.ОтдельнаяГруппа))
	|					ТОГДА ЗНАЧЕНИЕ(Перечисление.МетодыНачисленияАмортизации.Линейный)
	|				ИНАЧЕ ЕСТЬNULL(РегУчетнаяПолитика.МетодНачисленияАмортизацииНУ, ЗНАЧЕНИЕ(Перечисление.МетодыНачисленияАмортизации.Линейный))
	|			КОНЕЦ
	|	КОНЕЦ КАК МетодНачисленияАмортизацииНУ,
	|
	|	ПервоначальныеСведенияНМА.ПервоначальнаяСтоимостьБУ,
	|
	|	ПараметрыАмортизацииНМАБУ.СрокПолезногоИспользованияБУ,
	|	ПараметрыАмортизацииНМАБУ.СрокПолезногоИспользованияНУ,
	|	ПараметрыАмортизацииНМАБУ.КоэффициентБУ,
	|
	|	&НормаАмортизации КАК НормаАмортизации,
	|
	// РесурсНазначенный
	|	ВЫБОР 
	|		КОГДА ПервоначальныеСведенияНМА.МетодНачисленияАмортизацииБУ = ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииНМА.ПропорциональноОбъемуПродукции)
	|			ТОГДА ЕСТЬNULL(ПараметрыАмортизацииНМАБУ.ОбъемПродукцииРаботДляВычисленияАмортизации, 0)
	|		ИНАЧЕ ЕСТЬNULL(ПараметрыАмортизацииНМАБУ.СрокИспользованияДляВычисленияАмортизации, 0)
	|	КОНЕЦ КАК РесурсНазначенный,
	|
	// РесурсВыработанныйЗаТекущийПериод
	|	ВЫБОР 
	|		КОГДА ДатыПоследнегоИзменения.Дата = НАЧАЛОПЕРИОДА(ПериодИзменения_БУ.Период, ДЕНЬ)
	|			ТОГДА 0
	|
	|		КОГДА ПервоначальныеСведенияНМА.МетодНачисленияАмортизацииБУ = ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииНМА.ПропорциональноОбъемуПродукции)
	|			ТОГДА ВЫРАЗИТЬ(ВЫБОР 
	|					КОГДА НЕ ПериодИзменения_БУ.Период ЕСТЬ NULL
	|						ТОГДА ВЫБОР 
	|								КОГДА НАЧАЛОПЕРИОДА(ДатыПоследнегоИзменения.Дата, МЕСЯЦ) = СписокНМА.НачалоМесяца
	|									ТОГДА (РАЗНОСТЬДАТ(ДатыПоследнегоИзменения.Дата, ЕСТЬNULL(ДОБАВИТЬКДАТЕ(ПериодИзменения_БУ.Период, ДЕНЬ, -1), СписокНМА.КонецМесяца), ДЕНЬ) + 1)
	|									ИНАЧЕ (РАЗНОСТЬДАТ(СписокНМА.НачалоМесяца, ЕСТЬNULL(ДОБАВИТЬКДАТЕ(ПериодИзменения_БУ.Период, ДЕНЬ, -1), СписокНМА.КонецМесяца), ДЕНЬ) + 1)
	|							КОНЕЦ / ДЕНЬ(СписокНМА.КонецМесяца)
	|					ИНАЧЕ 1
	|				КОНЕЦ * ВЫБОР
	|							КОГДА СписокНМА.ЭтоДоначисление
	|								ТОГДА ЕСТЬNULL(ВыработкаНМА.ОбъемВыработкиЗаПрошлыйМесяц, 0)
	|							КОГДА НЕ СписокНМА.АмортизацияНачисляетсяСДатыПринятияКУчету
	|									И НАЧАЛОПЕРИОДА(ПервоначальныеСведенияНМА.ДатаПринятияКУчетуБУ, МЕСЯЦ) = &НачалоПредыдущегоМесяца
	|								ТОГДА ЕСТЬNULL(ВыработкаНМА.ОбъемВыработки, 0) + ЕСТЬNULL(ВыработкаНМА.ОбъемВыработкиЗаПрошлыйМесяц, 0)
	|							ИНАЧЕ ЕСТЬNULL(ВыработкаНМА.ОбъемВыработки, 0)
	|						КОНЕЦ КАК ЧИСЛО(20,8))
	|	
			// Если расчет выполняется в месяце принятия к учету то ДеньПринятия/ВсегоДнейВМесяце
	|		КОГДА НАЧАЛОПЕРИОДА(ДатыПоследнегоИзменения.Дата, МЕСЯЦ) = СписокНМА.НачалоМесяца
	|			ТОГДА ВЫРАЗИТЬ((РАЗНОСТЬДАТ(ДатыПоследнегоИзменения.Дата, ЕСТЬNULL(ДОБАВИТЬКДАТЕ(ПериодИзменения_БУ.Период, ДЕНЬ, -1), СписокНМА.КонецМесяца), ДЕНЬ) + 1)
	|					/ ДЕНЬ(СписокНМА.КонецМесяца) КАК ЧИСЛО(20,8))
	|	
			// В остальных случаях КоличествоДнейДоПервогоИзмененияПараметров/ВсегоДнейВМесяце
	|		ИНАЧЕ ВЫРАЗИТЬ((РАЗНОСТЬДАТ(СписокНМА.НачалоМесяца, ЕСТЬNULL(ДОБАВИТЬКДАТЕ(ПериодИзменения_БУ.Период, ДЕНЬ, -1), СписокНМА.КонецМесяца), ДЕНЬ) + 1)
	|					/ ДЕНЬ(СписокНМА.КонецМесяца) КАК ЧИСЛО(20,8))
	|
	|	КОНЕЦ КАК РесурсВыработанныйЗаТекущийПериод,
	|
	// РесурсВыработанныйЗаПрошлыйПериод
	|	ВЫБОР 
	|		КОГДА НАЧАЛОПЕРИОДА(ДатыПоследнегоИзменения.Дата, МЕСЯЦ) = СписокНМА.НачалоМесяца
	|				ИЛИ ДатыПоследнегоИзменения.Дата ЕСТЬ NULL
	|
	|			ТОГДА ВЫРАЗИТЬ(0 КАК ЧИСЛО(20,8))
	|
	|		КОГДА ПервоначальныеСведенияНМА.МетодНачисленияАмортизацииБУ = ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииНМА.ПропорциональноОбъемуПродукции)
	|
	|			ТОГДА ВЫБОР
	|					КОГДА СписокНМА.ЭтоДоначисление
	|						ТОГДА ВЫРАЗИТЬ(ЕСТЬNULL(ВыработкаНМА.ОбъемВыработкиНаНачалоПредыдущегоМесяца, 0) КАК ЧИСЛО(20,8))
	|					КОГДА НЕ СписокНМА.АмортизацияНачисляетсяСДатыПринятияКУчету
	|							И НАЧАЛОПЕРИОДА(ПервоначальныеСведенияНМА.ДатаПринятияКУчетуБУ, МЕСЯЦ) = &НачалоПредыдущегоМесяца
	|						ТОГДА 0
	|					ИНАЧЕ ВЫРАЗИТЬ(ЕСТЬNULL(ВыработкаНМА.ОбъемВыработкиНаНачалоМесяца, 0)
	|									- ЕСТЬNULL(ВыработкаНМА_НаДатуПоследнегоИзменения.ОбъемВыработкиБУ, 0) КАК ЧИСЛО(20,8))
	|				КОНЕЦ
	|
			// В следующем месяце после принятия к учету: [кол-во отработанных дней в мес принятия] / [всего дней в мес принятия]
	|		КОГДА КОНЕЦПЕРИОДА(ДатыПоследнегоИзменения.Дата, МЕСЯЦ) = КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(СписокНМА.НачалоМесяца, МЕСЯЦ, -1), МЕСЯЦ)
	|
	|			ТОГДА ВЫРАЗИТЬ((РАЗНОСТЬДАТ(ДатыПоследнегоИзменения.Дата, КОНЕЦПЕРИОДА(ДатыПоследнегоИзменения.Дата, МЕСЯЦ), ДЕНЬ) + 1) 
	|					/ ДЕНЬ(КОНЕЦПЕРИОДА(ДатыПоследнегоИзменения.Дата, МЕСЯЦ)) КАК ЧИСЛО(20,8))
	
			// В более поздних месяцах: [кол-во отработанных дней в мес принятия] / [всего дней в мес принятия] + [кол-во месяцев после принятия до начала месяца]
	|		ИНАЧЕ
	|			ВЫРАЗИТЬ((РАЗНОСТЬДАТ(ДатыПоследнегоИзменения.Дата, КОНЕЦПЕРИОДА(ДатыПоследнегоИзменения.Дата, МЕСЯЦ), ДЕНЬ) + 1) 
	|				/ ДЕНЬ(КОНЕЦПЕРИОДА(ДатыПоследнегоИзменения.Дата, МЕСЯЦ))
	|				+ РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(ДатыПоследнегоИзменения.Дата, МЕСЯЦ, 1), МЕСЯЦ), СписокНМА.КонецМесяца, МЕСЯЦ) КАК ЧИСЛО(20,8))
	|
	|	КОНЕЦ КАК РесурсВыработанныйЗаПрошлыйПериод,
	|
	// ОтработанныхМесяцевПолныхЛет
	|	ВЫБОР
	|		КОГДА ГОД(ДатыПоследнегоИзменения.Дата) <> ГОД(СписокНМА.НачалоМесяца) ТОГДА
	|			13 - МЕСЯЦ(ДатыПоследнегоИзменения.Дата)
	|				+ 12 * (ГОД(СписокНМА.НачалоМесяца) - Год(ДатыПоследнегоИзменения.Дата) - 1)
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ОтработанныхМесяцевПолныхЛет,
	|
	// СпециальныйКоэффициентНУ
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ПараметрыАмортизацииНМАБУ.СпециальныйКоэффициент, 1) <> 0
	|			ТОГДА ЕСТЬNULL(ПараметрыАмортизацииНМАБУ.СпециальныйКоэффициент, 1)
	|		ИНАЧЕ 1
	|	КОНЕЦ КАК СпециальныйКоэффициентНУ,
	|
	// СтоимостьДляВычисленияАмортизации
	|	ВЫБОР 
	|		КОГДА СписокНМА.АмортизацияНачисляетсяСДатыПринятияКУчету
	|				И НАЧАЛОПЕРИОДА(ДатыПоследнегоИзменения.Дата, МЕСЯЦ) = СписокНМА.НачалоМесяца
	|				И ТИПЗНАЧЕНИЯ(ПараметрыАмортизацииНМАБУ.Регистратор) <> ТИП(Документ.ВводОстатковВнеоборотныхАктивов2_4)
	|
	|			ТОГДА ЕСТЬNULL(ПредварительнаяСтоимостьНМА.СтоимостьРегл, 0)
	|
	|		ИНАЧЕ ЕСТЬNULL(СтоимостьНМА.СтоимостьРегл, 0) 
	|				+ ЕСТЬNULL(СтоимостьНМА.СтоимостьЦФ, 0)
	|				- ЕСТЬNULL(АмортизацияНМА.АмортизацияРегл, 0)
	|				- ЕСТЬNULL(АмортизацияНМА.АмортизацияЦФ, 0)
	|
	|	КОНЕЦ КАК СтоимостьДляВычисленияАмортизации,
	|
	// СтоимостьДляВычисленияАмортизацииНУ
	|	ВЫБОР 
	|		КОГДА СписокНМА.ВидОбъектаУчета = ЗНАЧЕНИЕ(Перечисление.ВидыОбъектовУчетаНМА.РасходыНаНИОКР)
	|			ТОГДА ПервоначальныеСведенияНМА.ПервоначальнаяСтоимостьНУ 
	|		ИНАЧЕ ЕСТЬNULL(СтоимостьНМА.СтоимостьНУ, 0)
	|	КОНЕЦ КАК СтоимостьДляВычисленияАмортизацииНУ,
	|
	// АмортизацияПриПереходеКЛинейномуМетоду
	|	ВЫБОР
	|		КОГДА ГОД(ЕСТЬNULL(ДатыПереходаКЛинейномуМетоду.Дата, ДАТАВРЕМЯ(2009,1,1))) = 2009
	|			ТОГДА ЕСТЬNULL(ПервоначальныеСведенияНМА.АмортизацияДо2009, 0)
	|		ИНАЧЕ ЕСТЬNULL(АмортизацияНМАПриПереходеКЛинейномуМетоду.АмортизацияНУ, 0)
	|	КОНЕЦ КАК АмортизацияПриПереходеКЛинейномуМетоду,
	|
	// ОстаточнаяСтоимостьРегл
	|	ВЫБОР 
	|		КОГДА СписокНМА.АмортизацияНачисляетсяСДатыПринятияКУчету
	|				И НАЧАЛОПЕРИОДА(ДатыПоследнегоИзменения.Дата, МЕСЯЦ) = СписокНМА.НачалоМесяца
	|				И ТИПЗНАЧЕНИЯ(ПараметрыАмортизацииНМАБУ.Регистратор) <> ТИП(Документ.ВводОстатковВнеоборотныхАктивов2_4)
	|
	|			ТОГДА ЕСТЬNULL(ПредварительнаяСтоимостьНМА.СтоимостьРегл, 0)
	|
	|		ИНАЧЕ ЕСТЬNULL(СтоимостьНМА.СтоимостьРегл, 0) 
	|				+ ЕСТЬNULL(СтоимостьНМА.СтоимостьЦФ, 0)
	|				- ЕСТЬNULL(АмортизацияНМА.АмортизацияРегл, 0)
	|				- ЕСТЬNULL(АмортизацияНМА.АмортизацияЦФ, 0)
	|
	|	КОНЕЦ КАК ОстаточнаяСтоимостьРегл,
	|
	// ОстаточнаяСтоимостьПР
	|	ВЫБОР 
	|		КОГДА СписокНМА.АмортизацияНачисляетсяСДатыПринятияКУчету
	|				И НАЧАЛОПЕРИОДА(ДатыПоследнегоИзменения.Дата, МЕСЯЦ) = СписокНМА.НачалоМесяца
	|				И ТИПЗНАЧЕНИЯ(ПараметрыАмортизацииНМАБУ.Регистратор) <> ТИП(Документ.ВводОстатковВнеоборотныхАктивов2_4)
	|
	|			ТОГДА 0
	|
	|		ИНАЧЕ ЕСТЬNULL(СтоимостьНМА.СтоимостьПР, 0) - ЕСТЬNULL(АмортизацияНМА.АмортизацияПР, 0)
	|
	|	КОНЕЦ КАК ОстаточнаяСтоимостьПР,
	|
	// ОстаточнаяСтоимостьЦФ
	|	ВЫБОР
	|		КОГДА СписокНМА.АмортизацияНачисляетсяПоСтандартамМУ
	|				И СписокНМА.АмортизацияНачисляетсяСДатыПринятияКУчету
	|				И НАЧАЛОПЕРИОДА(ДатыПоследнегоИзменения.Дата, МЕСЯЦ) = СписокНМА.НачалоМесяца
	|				И ТИПЗНАЧЕНИЯ(ПараметрыАмортизацииНМАБУ.Регистратор) <> ТИП(Документ.ВводОстатковВнеоборотныхАктивов2_4)
	|				И ТИПЗНАЧЕНИЯ(ПараметрыАмортизацииНМАБУ.Регистратор) <> ТИП(Документ.МодернизацияОС2_4)
	|
	|			ТОГДА ЕСТЬNULL(ПредварительнаяСтоимостьНМА.СтоимостьРегл, 0) * ЕСТЬNULL(ПредварительнаяСтоимостьНМА.ДоляЦФ, 0)
	|
	|		ИНАЧЕ ЕСТЬNULL(СтоимостьНМА.СтоимостьЦФ, 0) - ЕСТЬNULL(АмортизацияНМА.АмортизацияЦФ, 0)
	| 
	|	КОНЕЦ КАК ОстаточнаяСтоимостьЦФ,
	|
	|	ЕСТЬNULL(СтоимостьНМА.СтоимостьНУЦФ, 0) - ЕСТЬNULL(АмортизацияНМА.АмортизацияНУЦФ, 0) КАК ОстаточнаяСтоимостьНУЦФ,
	|
	// ОстаточнаяСтоимостьПРЦФ
	|	ВЫБОР
	|		КОГДА СписокНМА.АмортизацияНачисляетсяПоСтандартамМУ
	|				И СписокНМА.АмортизацияНачисляетсяСДатыПринятияКУчету
	|				И НАЧАЛОПЕРИОДА(ДатыПоследнегоИзменения.Дата, МЕСЯЦ) = СписокНМА.НачалоМесяца
	|				И ТИПЗНАЧЕНИЯ(ПараметрыАмортизацииНМАБУ.Регистратор) <> ТИП(Документ.ВводОстатковВнеоборотныхАктивов2_4)
	|				И ТИПЗНАЧЕНИЯ(ПараметрыАмортизацииНМАБУ.Регистратор) <> ТИП(Документ.УлучшениеНМА)
	|
	|			ТОГДА ЕСТЬNULL(ПредварительнаяСтоимостьНМА.СтоимостьРегл, 0) * ЕСТЬNULL(ПредварительнаяСтоимостьНМА.ДоляЦФ, 0)
	|
	|		ИНАЧЕ ЕСТЬNULL(СтоимостьНМА.СтоимостьПРЦФ, 0) - ЕСТЬNULL(АмортизацияНМА.АмортизацияПРЦФ, 0)
	| 
	|	КОНЕЦ КАК ОстаточнаяСтоимостьПРЦФ,
	|
	// КоэффициентЦФБУ
	|	ВЫБОР 
	|		КОГДА ТИПЗНАЧЕНИЯ(ПараметрыАмортизацииНМАБУ.Регистратор) <> ТИП(Документ.ВводОстатковВнеоборотныхАктивов2_4)
	|				И ТИПЗНАЧЕНИЯ(ПараметрыАмортизацииНМАБУ.Регистратор) <> ТИП(Документ.МодернизацияОС2_4)
	|				И (СписокНМА.АмортизацияНачисляетсяПоСтандартамМУ
	|						И СписокНМА.АмортизацияНачисляетсяСДатыПринятияКУчету
	|						И НАЧАЛОПЕРИОДА(ДатыПоследнегоИзменения.Дата, МЕСЯЦ) = СписокНМА.НачалоМесяца)
	|
	|			ТОГДА ЕСТЬNULL(ПредварительнаяСтоимостьНМА.ДоляЦФ, 0)
	|
	|		КОГДА ЕСТЬNULL(СтоимостьНМА.СтоимостьЦФ, 0) = 0
	|			ИЛИ (ЕСТЬNULL(СтоимостьНМА.СтоимостьЦФ, 0) - ЕСТЬNULL(АмортизацияНМА.АмортизацияЦФ, 0)) <= 0
	|
	|			ТОГДА 0
	|
	|		КОГДА (ЕСТЬNULL(СтоимостьНМА.СтоимостьРегл, 0) - ЕСТЬNULL(АмортизацияНМА.АмортизацияРегл, 0)) <= 0
	|
	|			ТОГДА 1
	|
	|		КОГДА (ЕСТЬNULL(СтоимостьНМА.СтоимостьРегл, 0) + ЕСТЬNULL(СтоимостьНМА.СтоимостьЦФ, 0)) <> 0
	|
	|			ТОГДА ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьНМА.СтоимостьЦФ, 0) 
	|							/ (ЕСТЬNULL(СтоимостьНМА.СтоимостьРегл, 0) + ЕСТЬNULL(СтоимостьНМА.СтоимостьЦФ, 0)) КАК ЧИСЛО (23, 10))
	|
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК КоэффициентЦФБУ,
	|
	// КоэффициентЦФНУ
	|	ВЫБОР 
	|		КОГДА ЕСТЬNULL(СтоимостьНМА.СтоимостьНУЦФ, 0) = 0
	|			ИЛИ (ЕСТЬNULL(СтоимостьНМА.СтоимостьНУЦФ, 0) - ЕСТЬNULL(АмортизацияНМА.АмортизацияНУЦФ, 0)) <= 0
	|
	|			ТОГДА 0
	|
	|		КОГДА (ЕСТЬNULL(СтоимостьНМА.СтоимостьНУ, 0) - ЕСТЬNULL(АмортизацияНМА.АмортизацияНУ, 0)) <= 0
	|
	|			ТОГДА 1
	|
	|		КОГДА (ЕСТЬNULL(СтоимостьНМА.СтоимостьНУ, 0) + ЕСТЬNULL(СтоимостьНМА.СтоимостьНУЦФ, 0)) <> 0
	|
	|			ТОГДА ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьНМА.СтоимостьНУЦФ, 0) 
	|							/ (ЕСТЬNULL(СтоимостьНМА.СтоимостьНУ, 0) + ЕСТЬNULL(СтоимостьНМА.СтоимостьНУЦФ, 0)) КАК ЧИСЛО (23, 10))
	|
	|		ИНАЧЕ 0
	|
	|	КОНЕЦ КАК КоэффициентЦФНУ,
	|
	// КоэффициентЦФПР
	|	ВЫБОР 
	|		КОГДА ТИПЗНАЧЕНИЯ(ПараметрыАмортизацииНМАБУ.Регистратор) <> ТИП(Документ.ВводОстатковВнеоборотныхАктивов2_4)
	|				И ТИПЗНАЧЕНИЯ(ПараметрыАмортизацииНМАБУ.Регистратор) <> ТИП(Документ.УлучшениеНМА)
	|				И (СписокНМА.АмортизацияНачисляетсяПоСтандартамМУ
	|						И СписокНМА.АмортизацияНачисляетсяСДатыПринятияКУчету
	|						И НАЧАЛОПЕРИОДА(ДатыПоследнегоИзменения.Дата, МЕСЯЦ) = СписокНМА.НачалоМесяца)
	|				И ЕСТЬNULL(ПредварительнаяСтоимостьНМА.ДоляЦФ, 0) <> 0
	|
	|			ТОГДА 1
	|
	|		КОГДА ЕСТЬNULL(СтоимостьНМА.СтоимостьПРЦФ, 0) = 0
	|			ИЛИ (ЕСТЬNULL(СтоимостьНМА.СтоимостьПРЦФ, 0) - ЕСТЬNULL(АмортизацияНМА.АмортизацияПРЦФ, 0)) <= 0
	|
	|			ТОГДА 0
	|
	|		КОГДА (ЕСТЬNULL(СтоимостьНМА.СтоимостьПР, 0) - ЕСТЬNULL(АмортизацияНМА.АмортизацияПР, 0)) <= 0
	|
	|			ТОГДА 1
	|
	|		КОГДА (ЕСТЬNULL(СтоимостьНМА.СтоимостьПР, 0) + ЕСТЬNULL(СтоимостьНМА.СтоимостьПРЦФ, 0)) <> 0
	|
	|			ТОГДА ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьНМА.СтоимостьПРЦФ, 0) 
	|							/ (ЕСТЬNULL(СтоимостьНМА.СтоимостьПР, 0) + ЕСТЬNULL(СтоимостьНМА.СтоимостьПРЦФ, 0)) КАК ЧИСЛО (23, 10))
	|
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК КоэффициентЦФПР
	|
	|ПОМЕСТИТЬ СписокНМАСПараметрами_БУ
	|
	|ИЗ
	|	СписокОбъектовУчета_БУ КАК СписокНМА
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПериодИзменения_БУ КАК ПериодИзменения_БУ
	|		ПО (ПериодИзменения_БУ.Организация = СписокНМА.Организация)
	|			И (ПериодИзменения_БУ.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|			И (ПериодИзменения_БУ.НачалоМесяца = СписокНМА.НачалоМесяца)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПериодИзменения_БУ КАК ПериодИзмененияВТекущемМесяце
	|		ПО (ПериодИзмененияВТекущемМесяце.Организация = СписокНМА.Организация)
	|			И (ПериодИзмененияВТекущемМесяце.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|			И (ПериодИзмененияВТекущемМесяце.НачалоМесяца = &НачалоМесяца)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПорядокУчетаНМА КАК ПорядокУчетаНМА
	|		ПО (ПорядокУчетаНМА.Организация = СписокНМА.Организация)
	|			И (ПорядокУчетаНМА.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|			И (ПорядокУчетаНМА.НачалоМесяца = СписокНМА.НачалоМесяца)
	|			И (ПорядокУчетаНМА.ПериодПараметров = СписокНМА.ПериодПараметров)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ СтоимостьНМА_НаНачалоМесяца КАК СтоимостьНМА
	|		ПО (СтоимостьНМА.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|			И (СтоимостьНМА.НачалоМесяца = СписокНМА.НачалоМесяца)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ СтоимостьНМА_НаНачалоГода КАК СтоимостьНМАНаНачалоГода
	|		ПО (СтоимостьНМАНаНачалоГода.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПредварительнаяСтоимостьНМА КАК ПредварительнаяСтоимостьНМА
	|		ПО (ПредварительнаяСтоимостьНМА.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|			И (ПредварительнаяСтоимостьНМА.НачалоМесяца = СписокНМА.НачалоМесяца)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ АмортизацияНМА_НаНачалоМесяца КАК АмортизацияНМА
	|		ПО (АмортизацияНМА.Организация = СписокНМА.Организация)
	|			И (АмортизацияНМА.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|			И (АмортизацияНМА.НачалоМесяца = СписокНМА.НачалоМесяца)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ АмортизацияНМАПриПереходеКЛинейномуМетоду КАК АмортизацияНМАПриПереходеКЛинейномуМетоду
	|		ПО (АмортизацияНМАПриПереходеКЛинейномуМетоду.Организация = СписокНМА.Организация)
	|			И (АмортизацияНМАПриПереходеКЛинейномуМетоду.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ОбесценениеВНА КАК ОбесценениеНаНачалоМесяца
	|		ПО (ОбесценениеНаНачалоМесяца.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|			И (ОбесценениеНаНачалоМесяца.НачалоМесяца = СписокНМА.НачалоМесяца)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ МестоУчетаНМА КАК МестоУчетаНМА
	|		ПО (МестоУчетаНМА.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|			И (МестоУчетаНМА.НачалоМесяца = СписокНМА.НачалоМесяца)
	|			И (МестоУчетаНМА.ПериодПараметров = СписокНМА.ПериодПараметров)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПервоначальныеСведенияНМА КАК ПервоначальныеСведенияНМА
	|		ПО (ПервоначальныеСведенияНМА.Организация = СписокНМА.Организация)
	|			И (ПервоначальныеСведенияНМА.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|			И (ПервоначальныеСведенияНМА.НачалоМесяца = СписокНМА.НачалоМесяца)
	|			И (ПервоначальныеСведенияНМА.ПериодПараметров = СписокНМА.ПериодПараметров)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПараметрыАмортизацииНМАБУ КАК ПараметрыАмортизацииНМАБУ
	|		ПО (ПараметрыАмортизацииНМАБУ.Организация = СписокНМА.Организация)
	|			И (ПараметрыАмортизацииНМАБУ.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|			И (ПараметрыАмортизацииНМАБУ.ПериодПараметров = СписокНМА.ПериодПараметров)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВыработкаНМА КАК ВыработкаНМА
	|		ПО (ВыработкаНМА.НематериальныйАктив = ПорядокУчетаНМА.НематериальныйАктив)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВыработкаНМА_НаДатуПоследнегоИзменения КАК ВыработкаНМА_НаДатуПоследнегоИзменения
	|		ПО (ВыработкаНМА_НаДатуПоследнегоИзменения.НематериальныйАктив = ПорядокУчетаНМА.НематериальныйАктив)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ДатыПереходаКЛинейномуМетоду КАК ДатыПереходаКЛинейномуМетоду
	|		ПО (ДатыПереходаКЛинейномуМетоду.Организация = СписокНМА.Организация)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ДатыПоследнегоИзмененияБУ КАК ДатыПоследнегоИзменения
	|		ПО (ДатыПоследнегоИзменения.Организация = СписокНМА.Организация)
	|			И (ДатыПоследнегоИзменения.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|			И (ДатыПоследнегоИзменения.НачалоМесяца = СписокНМА.НачалоМесяца)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НастройкиУчетаНалогаНаПрибыль.СрезПоследних(&КонецМесяца) КАК РегУчетнаяПолитика
	|		ПО РегУчетнаяПолитика.Организация = СписокНМА.ГоловнаяОрганизация
	|
	|ГДЕ
	|	СписокНМА.НачислятьАмортизациюБУ
	|	И (НЕ СписокНМА.ЭтоДоначисление
	|		ИЛИ СписокНМА.НачалоМесяца = НАЧАЛОПЕРИОДА(ПервоначальныеСведенияНМА.ДатаПринятияКУчетуБУ, МЕСЯЦ))
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	НематериальныйАктив,
	|	Организация";

	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ФактическийСрокИспользования", 
		ВнеоборотныеАктивыСлужебный.ТекстПоляФактическийСрокИспользования("ПервоначальныеСведенияНМА.ДатаПринятияКУчетуБУ"));
		
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&НормаАмортизации", 
		РасчетАмортизацииНМАЛокализация.ТекстПоляНормаАмортизации("СписокНМА.АмортизационнаяГруппа"));
	
	СписокЗапросов.Добавить(ТекстЗапроса);
		
	#КонецОбласти
	
	#Область СписокНМАСИзмененнымиПараметрами_БУ
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	Изменения_БУ.Период КАК Период,
	|	Изменения_БУ.Регистратор КАК Регистратор,
	|	Изменения_БУ.НематериальныйАктив КАК НематериальныйАктив,
	|	Изменения_БУ.Организация КАК Организация,
	|	(Изменения_БУ.НачалоМесяца = &НачалоПредыдущегоМесяца) КАК ЭтоДоначисление,
	|	Изменения_БУ.НематериальныйАктив.ВидОбъектаУчета КАК ВидОбъектаУчета,
	|
	|	ЕСТЬNULL(Изменения_БУ.ГруппаФинансовогоУчета, ПорядокУчетаНМА.ГруппаФинансовогоУчета) КАК ГруппаФинансовогоУчета,
	|	ЕСТЬNULL(Изменения_БУ.НаправлениеДеятельности, ПорядокУчетаНМА.НаправлениеДеятельности) КАК НаправлениеДеятельности,
	|	ЕСТЬNULL(Изменения_БУ.ОбъемНаработки, ЕСТЬNULL(ПорядокУчетаНМА.ОбъемНаработки, 0)) КАК ОбъемНаработки,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ПорядокНачисленияАмортизации.СДатыПринятияКУчету) КАК ПорядокНачисленияАмортизацииБУ,
	|
	|	СписокНМА.ВариантПроводокПоОбесценениюВНА КАК ВариантПроводокПоОбесценениюВНА,
	|
	|	ЕСТЬNULL(Изменения_БУ.НачислятьАмортизациюБУ, ЕСТЬNULL(СписокНМА.НачислятьАмортизациюБУ, ЛОЖЬ)) КАК НачислятьАмортизациюБУ,
	|
	|	ЕСТЬNULL(Изменения_БУ.СтатьяРасходовБУ, СписокНМА.СтатьяРасходовБУ) КАК СтатьяРасходов,
	|	ЕСТЬNULL(Изменения_БУ.АналитикаРасходовБУ, СписокНМА.АналитикаРасходовБУ) КАК АналитикаРасходов,
	|	ЕСТЬNULL(Изменения_БУ.СпособОтраженияРасходовБУ, СписокНМА.СпособОтраженияРасходовБУ) КАК СпособОтраженияРасходов,
	|	ЕСТЬNULL(Изменения_БУ.ПередаватьРасходыВДругуюОрганизацию, СписокНМА.ПередаватьРасходыВДругуюОрганизациюБУ) КАК ПередаватьРасходыВДругуюОрганизацию,
	|	ЕСТЬNULL(Изменения_БУ.ОрганизацияПолучательРасходов, СписокНМА.ОрганизацияПолучательРасходовБУ) КАК ОрганизацияПолучательРасходов,
	|
	|	ЕСТЬNULL(Изменения_БУ.ЛиквидационнаяСтоимость, ЕСТЬNULL(ПараметрыАмортизацииНМАБУ.ЛиквидационнаяСтоимость, 0)) КАК ЛиквидационнаяСтоимость,
	|
	|	ЕСТЬNULL(ОбесценениеНаНачалоМесяца.ОстатокОбесцененияРегл, 0) КАК ОстатокОбесцененияРегл,
	|
	|	ЕСТЬNULL(Изменения_БУ.Подразделение, МестоУчетаНМА.Подразделение) КАК Подразделение,
	|	ЕСТЬNULL(Изменения_БУ.ОбъемНаработки, ЕСТЬNULL(ВыработкаНМА.ОбъемВыработки, 0)) КАК ОбъемВыработки,
	|	ЕСТЬNULL(Изменения_БУ.МетодНачисленияАмортизацииБУ, ПервоначальныеСведенияНМА.МетодНачисленияАмортизацииБУ) КАК МетодНачисленияАмортизацииБУ,
	|	ЕСТЬNULL(Изменения_БУ.КоэффициентБУ, ЕСТЬNULL(ПараметрыАмортизацииНМАБУ.КоэффициентБУ, 0)) КАК КоэффициентБУ,
	|
	// РесурсНазначенный
	|	ВЫБОР 
	|		КОГДА ЕСТЬNULL(Изменения_БУ.МетодНачисленияАмортизацииБУ, ПервоначальныеСведенияНМА.МетодНачисленияАмортизацииБУ) = ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииНМА.ПропорциональноОбъемуПродукции)
	|			ТОГДА ЕСТЬNULL(Изменения_БУ.ОбъемНаработки, ЕСТЬNULL(ПорядокУчетаНМА.ОбъемНаработки, 0))
	|		ИНАЧЕ ЕСТЬNULL(Изменения_БУ.СрокИспользования, ЕСТЬNULL(ПараметрыАмортизацииНМАБУ.СрокИспользованияДляВычисленияАмортизации, 0))
	|	КОНЕЦ КАК РесурсНазначенный,
	|
	// РесурсВыработанныйЗаТекущийПериод
	|	ВЫРАЗИТЬ(ВЫБОР 
	|		КОГДА ЕСТЬNULL(Изменения_БУ.МетодНачисленияАмортизацииБУ, ПервоначальныеСведенияНМА.МетодНачисленияАмортизацииБУ) = ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииНМА.ПропорциональноОбъемуПродукции)
	|			ТОГДА ВЫБОР
	|					КОГДА Изменения_БУ.НачалоМесяца = &НачалоПредыдущегоМесяца
	|						ТОГДА ЕСТЬNULL(ВыработкаНМА.ОбъемВыработкиЗаПрошлыйМесяц, 0)
	|					КОГДА НЕ СписокНМА.АмортизацияНачисляетсяПоСтандартамМУ
	|							И НАЧАЛОПЕРИОДА(ПервоначальныеСведенияНМА.ДатаПринятияКУчетуБУ, МЕСЯЦ) = &НачалоПредыдущегоМесяца
	|						ТОГДА ЕСТЬNULL(ВыработкаНМА.ОбъемВыработки, 0) + ЕСТЬNULL(ВыработкаНМА.ОбъемВыработкиЗаПрошлыйМесяц, 0)
	|					ИНАЧЕ ЕСТЬNULL(ВыработкаНМА.ОбъемВыработки, 0)
	|				КОНЕЦ
	|		ИНАЧЕ 1
	|	КОНЕЦ * Изменения_БУ.СрокДействия / ДЕНЬ(Изменения_БУ.КонецМесяца) КАК ЧИСЛО(20,8)) КАК РесурсВыработанныйЗаТекущийПериод,
	|	  
	// РесурсВыработанныйЗаПрошлыйПериод
	|	ВЫБОР 
	|		КОГДА НАЧАЛОПЕРИОДА(ЕСТЬNULL(Изменения_БУ.ДатаПоследнегоИзменения, ПараметрыАмортизацииНМАБУ.ДатаПоследнегоИзменения), МЕСЯЦ) = Изменения_БУ.НачалоМесяца
	|			ТОГДА ВЫРАЗИТЬ(0 КАК ЧИСЛО(20,8))
	|
	|		КОГДА ЕСТЬNULL(Изменения_БУ.ДатаПоследнегоИзменения, ПараметрыАмортизацииНМАБУ.ДатаПоследнегоИзменения) ЕСТЬ NULL
	|			ТОГДА ВЫРАЗИТЬ(0 КАК ЧИСЛО(20,8))
	|	
	|		КОГДА ЕСТЬNULL(Изменения_БУ.МетодНачисленияАмортизацииБУ, ПервоначальныеСведенияНМА.МетодНачисленияАмортизацииБУ) = ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииНМА.ПропорциональноОбъемуПродукции)
	|			ТОГДА ВЫБОР
	|					КОГДА Изменения_БУ.НачалоМесяца = &НачалоПредыдущегоМесяца
	|						ТОГДА ВЫРАЗИТЬ(ЕСТЬNULL(ВыработкаНМА.ОбъемВыработкиНаНачалоПредыдущегоМесяца, 0) КАК ЧИСЛО(20,8))
	|					ИНАЧЕ ВЫРАЗИТЬ(ЕСТЬNULL(ВыработкаНМА.ОбъемВыработкиНаНачалоМесяца, 0) 
	|									- ЕСТЬNULL(ВыработкаНМА_НаДатуПоследнегоИзменения.ОбъемВыработкиБУ, 0) КАК ЧИСЛО(20,8))
	|				КОНЕЦ
	|
	|		ИНАЧЕ
	|			ВЫРАЗИТЬ((РАЗНОСТЬДАТ(ЕСТЬNULL(Изменения_БУ.ДатаПоследнегоИзменения, ПараметрыАмортизацииНМАБУ.ДатаПоследнегоИзменения), КОНЕЦПЕРИОДА(ЕСТЬNULL(Изменения_БУ.ДатаПоследнегоИзменения, ПараметрыАмортизацииНМАБУ.ДатаПоследнегоИзменения), МЕСЯЦ), ДЕНЬ) + 1) / ДЕНЬ(КОНЕЦПЕРИОДА(ЕСТЬNULL(Изменения_БУ.ДатаПоследнегоИзменения, ПараметрыАмортизацииНМАБУ.ДатаПоследнегоИзменения), МЕСЯЦ))
	|			+ РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(ЕСТЬNULL(Изменения_БУ.ДатаПоследнегоИзменения, ПараметрыАмортизацииНМАБУ.ДатаПоследнегоИзменения), МЕСЯЦ, 1), МЕСЯЦ), Изменения_БУ.КонецМесяца, МЕСЯЦ) КАК ЧИСЛО(20,8))
	|	КОНЕЦ КАК РесурсВыработанныйЗаПрошлыйПериод,
	|
	// ОтработанныхМесяцевПолныхЛет
	|	ВЫБОР
	|		КОГДА ГОД(ЕСТЬNULL(Изменения_БУ.ДатаПоследнегоИзменения, ПараметрыАмортизацииНМАБУ.ДатаПоследнегоИзменения)) <> ГОД(Изменения_БУ.НачалоМесяца) ТОГДА
	|			13 - МЕСЯЦ(ЕСТЬNULL(Изменения_БУ.ДатаПоследнегоИзменения, ПараметрыАмортизацииНМАБУ.ДатаПоследнегоИзменения))
	|				+ 12 * (ГОД(Изменения_БУ.НачалоМесяца) - Год(ЕСТЬNULL(Изменения_БУ.ДатаПоследнегоИзменения, ПараметрыАмортизацииНМАБУ.ДатаПоследнегоИзменения)) - 1)
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ОтработанныхМесяцевПолныхЛет,
	|
	|	ЕСТЬNULL(ПервоначальныеСведенияНМА.ПервоначальнаяСтоимостьБУ, 0) КАК ПервоначальнаяСтоимостьБУ,
	|
	|	ЕСТЬNULL(СтоимостьНМА.СтоимостьРегл, 0) КАК СтоимостьРегл,
	|	ЕСТЬNULL(СтоимостьНМА.СтоимостьПР, 0) КАК СтоимостьПР,
	|	ЕСТЬNULL(СтоимостьНМА.СтоимостьЦФ, 0) КАК СтоимостьЦФ,
	|	ЕСТЬNULL(СтоимостьНМА.СтоимостьПРЦФ, 0) КАК СтоимостьПРЦФ,
	|	ЕСТЬNULL(АмортизацияНМА.АмортизацияРегл, 0) КАК АмортизацияРегл,
	|	ЕСТЬNULL(АмортизацияНМА.АмортизацияПР, 0) КАК АмортизацияПР,
	|
	|	Изменения_БУ.СтоимостьРеглИзменение КАК СтоимостьРеглИзменение,
	|	Изменения_БУ.СтоимостьПРИзменение КАК СтоимостьПРИзменение,
	|	Изменения_БУ.АмортизацияРеглИзменение КАК АмортизацияРеглИзменение,
	|	Изменения_БУ.АмортизацияПРИзменение КАК АмортизацияПРИзменение,
	|
	// ОстаточнаяСтоимостьРегл
	|	ЕСТЬNULL(СтоимостьНМА.СтоимостьРегл, 0) 
	|		+ ЕСТЬNULL(СтоимостьНМА.СтоимостьЦФ, 0)
	|		- ЕСТЬNULL(АмортизацияНМА.АмортизацияРегл, 0)
	|		- ЕСТЬNULL(АмортизацияНМА.АмортизацияЦФ, 0) КАК ОстаточнаяСтоимостьРегл,
	|
	|	ЕСТЬNULL(СтоимостьНМА.СтоимостьЦФ, 0) - ЕСТЬNULL(АмортизацияНМА.АмортизацияЦФ, 0) КАК ОстаточнаяСтоимостьЦФ,
	|
	|	ЕСТЬNULL(СтоимостьНМА.СтоимостьПР, 0) - ЕСТЬNULL(АмортизацияНМА.АмортизацияПР, 0) КАК ОстаточнаяСтоимостьПР,
	|	ЕСТЬNULL(СтоимостьНМА.СтоимостьПРЦФ, 0) - ЕСТЬNULL(АмортизацияНМА.АмортизацияПРЦФ, 0) КАК ОстаточнаяСтоимостьПРЦФ,
	|
	// КоэффициентЦФБУ
	|	ВЫБОР 
	|		КОГДА ЕСТЬNULL(СтоимостьНМА.СтоимостьЦФ, 0) = 0
	|				И ЕСТЬNULL(СтоимостьНМА.СтоимостьНУЦФ, 0) = 0
	|				И ЕСТЬNULL(СтоимостьНМА.СтоимостьПРЦФ, 0) = 0
	|				И ЕСТЬNULL(СтоимостьНМА.СтоимостьВРЦФ, 0) = 0
	|
	|			ТОГДА 0
	|
	|		КОГДА (ЕСТЬNULL(СтоимостьНМА.СтоимостьЦФ, 0) - ЕСТЬNULL(АмортизацияНМА.АмортизацияЦФ, 0)) <= 0
	|
	|			ТОГДА 0
	|
	|		КОГДА (ЕСТЬNULL(СтоимостьНМА.СтоимостьРегл, 0) - ЕСТЬNULL(АмортизацияНМА.АмортизацияРегл, 0)) <= 0
	|
	|			ТОГДА 1
	|
	|		КОГДА (ЕСТЬNULL(СтоимостьНМА.СтоимостьРегл, 0) + ЕСТЬNULL(СтоимостьНМА.СтоимостьЦФ, 0)) <> 0
	|			ТОГДА ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьНМА.СтоимостьЦФ, 0) / (ЕСТЬNULL(СтоимостьНМА.СтоимостьРегл, 0) + ЕСТЬNULL(СтоимостьНМА.СтоимостьЦФ, 0)) КАК ЧИСЛО (23, 10))
	|
	|		ИНАЧЕ 0
	|
	|	КОНЕЦ КАК КоэффициентЦФБУ,
	|
	// КоэффициентЦФНУ
	|	ВЫБОР 
	|		КОГДА ЕСТЬNULL(СтоимостьНМА.СтоимостьЦФ, 0) = 0
	|				И ЕСТЬNULL(СтоимостьНМА.СтоимостьНУЦФ, 0) = 0
	|				И ЕСТЬNULL(СтоимостьНМА.СтоимостьПРЦФ, 0) = 0
	|				И ЕСТЬNULL(СтоимостьНМА.СтоимостьВРЦФ, 0) = 0
	|
	|			ТОГДА 0
	|
	|		КОГДА (ЕСТЬNULL(СтоимостьНМА.СтоимостьНУЦФ, 0) - ЕСТЬNULL(АмортизацияНМА.АмортизацияНУЦФ, 0)) <= 0
	|
	|			ТОГДА 0
	|
	|		КОГДА (ЕСТЬNULL(СтоимостьНМА.СтоимостьНУ, 0) - ЕСТЬNULL(АмортизацияНМА.АмортизацияНУ, 0)) <= 0
	|
	|			ТОГДА 1
	|
	|		КОГДА (ЕСТЬNULL(СтоимостьНМА.СтоимостьНУ, 0) + ЕСТЬNULL(СтоимостьНМА.СтоимостьНУЦФ, 0)) <> 0
	|
	|			ТОГДА ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьНМА.СтоимостьНУЦФ, 0) 
	|							/ (ЕСТЬNULL(СтоимостьНМА.СтоимостьНУ, 0) 
	|								+ ЕСТЬNULL(СтоимостьНМА.СтоимостьНУЦФ, 0)) КАК ЧИСЛО (23, 10))
	|
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК КоэффициентЦФНУ,
	|
	// КоэффициентЦФПР
	|	ВЫБОР 
	|		КОГДА ЕСТЬNULL(СтоимостьНМА.СтоимостьЦФ, 0) = 0
	|				И ЕСТЬNULL(СтоимостьНМА.СтоимостьНУЦФ, 0) = 0
	|				И ЕСТЬNULL(СтоимостьНМА.СтоимостьПРЦФ, 0) = 0
	|				И ЕСТЬNULL(СтоимостьНМА.СтоимостьВРЦФ, 0) = 0
	|
	|			ТОГДА 0
	|
	|		КОГДА (ЕСТЬNULL(СтоимостьНМА.СтоимостьПРЦФ, 0) - ЕСТЬNULL(АмортизацияНМА.АмортизацияПРЦФ, 0)) <= 0
	|
	|			ТОГДА 0
	|
	|		КОГДА (ЕСТЬNULL(СтоимостьНМА.СтоимостьПР, 0) - ЕСТЬNULL(АмортизацияНМА.АмортизацияПР, 0)) <= 0
	|
	|			ТОГДА 1
	|
	|		КОГДА (ЕСТЬNULL(СтоимостьНМА.СтоимостьПР, 0) + ЕСТЬNULL(СтоимостьНМА.СтоимостьПРЦФ, 0)) <> 0
	|
	|			ТОГДА ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьНМА.СтоимостьПРЦФ, 0) 
	|							/ (ЕСТЬNULL(СтоимостьНМА.СтоимостьПР, 0) 
	|								+ ЕСТЬNULL(СтоимостьНМА.СтоимостьПРЦФ, 0)) КАК ЧИСЛО (23, 10))
	|
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК КоэффициентЦФПР
	|
	|ПОМЕСТИТЬ СписокНМАСИзмененнымиПараметрами_БУ
	|
	|ИЗ
	|	Изменения_БУ КАК Изменения_БУ
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ СписокОбъектовУчета_БУ КАК СписокНМА
	|		ПО (СписокНМА.Организация = Изменения_БУ.Организация)
	|			И (СписокНМА.НематериальныйАктив = Изменения_БУ.НематериальныйАктив)
	|			И (СписокНМА.НачалоМесяца = Изменения_БУ.НачалоМесяца)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПериодИзменения_БУ КАК ПериодИзменения_БУ
	|		ПО (ПериодИзменения_БУ.Организация = СписокНМА.Организация)
	|			И (ПериодИзменения_БУ.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|			И (ПериодИзменения_БУ.НачалоМесяца = СписокНМА.НачалоМесяца)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПериодИзменения_БУ КАК ПериодИзмененияВТекущемМесяце
	|		ПО (ПериодИзмененияВТекущемМесяце.Организация = СписокНМА.Организация)
	|			И (ПериодИзмененияВТекущемМесяце.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|			И (ПериодИзмененияВТекущемМесяце.НачалоМесяца = &НачалоМесяца)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПорядокУчетаНМА КАК ПорядокУчетаНМА
	|		ПО (ПорядокУчетаНМА.Организация = Изменения_БУ.Организация)
	|			И (ПорядокУчетаНМА.НематериальныйАктив = Изменения_БУ.НематериальныйАктив)
	|			И (ПорядокУчетаНМА.НачалоМесяца = Изменения_БУ.НачалоМесяца)
	|			И (ПорядокУчетаНМА.ПериодПараметров = Изменения_БУ.ПериодПараметров)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ СтоимостьНМА_НаНачалоМесяца КАК СтоимостьНМА
	|		ПО (СтоимостьНМА.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|			И (СтоимостьНМА.НачалоМесяца = СписокНМА.НачалоМесяца)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ СтоимостьНМА_НаНачалоГода КАК СтоимостьНМАНаНачалоГода
	|		ПО (СтоимостьНМАНаНачалоГода.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ АмортизацияНМА_НаНачалоМесяца КАК АмортизацияНМА
	|		ПО (АмортизацияНМА.Организация = СписокНМА.Организация)
	|			И (АмортизацияНМА.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|			И (АмортизацияНМА.НачалоМесяца = СписокНМА.НачалоМесяца)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ОбесценениеВНА КАК ОбесценениеНаНачалоМесяца
	|		ПО (ОбесценениеНаНачалоМесяца.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|			И (ОбесценениеНаНачалоМесяца.НачалоМесяца = СписокНМА.НачалоМесяца)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ МестоУчетаНМА КАК МестоУчетаНМА
	|		ПО (МестоУчетаНМА.НематериальныйАктив = Изменения_БУ.НематериальныйАктив)
	|			И (МестоУчетаНМА.НачалоМесяца = Изменения_БУ.НачалоМесяца)
	|			И (МестоУчетаНМА.ПериодПараметров = Изменения_БУ.ПериодПараметров)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПервоначальныеСведенияНМА КАК ПервоначальныеСведенияНМА
	|		ПО (ПервоначальныеСведенияНМА.Организация = Изменения_БУ.Организация)
	|			И (ПервоначальныеСведенияНМА.НематериальныйАктив = Изменения_БУ.НематериальныйАктив)
	|			И (ПервоначальныеСведенияНМА.НачалоМесяца = Изменения_БУ.НачалоМесяца)
	|			И (ПервоначальныеСведенияНМА.ПериодПараметров = Изменения_БУ.ПериодПараметров)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПараметрыАмортизацииНМАБУ КАК ПараметрыАмортизацииНМАБУ
	|		ПО (ПараметрыАмортизацииНМАБУ.Организация = Изменения_БУ.Организация)
	|			И (ПараметрыАмортизацииНМАБУ.НематериальныйАктив = Изменения_БУ.НематериальныйАктив)
	|			И (ПараметрыАмортизацииНМАБУ.НачалоМесяца = Изменения_БУ.НачалоМесяца)
	|			И (ПараметрыАмортизацииНМАБУ.ПериодПараметров = Изменения_БУ.ПериодПараметров)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВыработкаНМА КАК ВыработкаНМА
	|		ПО (ВыработкаНМА.НематериальныйАктив = ПорядокУчетаНМА.НематериальныйАктив)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВыработкаНМА_НаДатуПоследнегоИзменения КАК ВыработкаНМА_НаДатуПоследнегоИзменения
	|		ПО (ВыработкаНМА_НаДатуПоследнегоИзменения.НематериальныйАктив = ПорядокУчетаНМА.НематериальныйАктив)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ДатыПоследнегоИзмененияБУ КАК ДатыПоследнегоИзменения
	|		ПО (ДатыПоследнегоИзменения.Организация = СписокНМА.Организация)
	|			И (ДатыПоследнегоИзменения.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|			И (ДатыПоследнегоИзменения.НачалоМесяца = СписокНМА.НачалоМесяца)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	НематериальныйАктив,
	|	Организация";

	СписокЗапросов.Добавить(ТекстЗапроса);
		
	#КонецОбласти
	
	#Область СписокНМАСПараметрами_НУ
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	СписокНМА.НематериальныйАктив КАК НематериальныйАктив,
	|	СписокНМА.ВидОбъектаУчета КАК ВидОбъектаУчета,
	|	СписокНМА.Организация КАК Организация,
	|
	|	МестоУчетаНМА.Подразделение,
	|
	|	ПорядокУчетаНМА.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	ПорядокУчетаНМА.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ПорядокУчетаНМА.ОбъемНаработки КАК ОбъемНаработки,
	|
	|	СписокНМА.ВариантПроводокПоОбесценениюВНА КАК ВариантПроводокПоОбесценениюВНА,
	|
	|	СписокНМА.НачислятьАмортизациюНУ КАК НачислятьАмортизациюНУ,
	|
	|	СписокНМА.СтатьяРасходовНУ КАК СтатьяРасходов,
	|	СписокНМА.АналитикаРасходовНУ КАК АналитикаРасходов,
	|	СписокНМА.СпособОтраженияРасходовНУ КАК СпособОтраженияРасходов,
	|	СписокНМА.ПередаватьРасходыВДругуюОрганизациюБУ КАК ПередаватьРасходыВДругуюОрганизацию,
	|	СписокНМА.ОрганизацияПолучательРасходовБУ КАК ОрганизацияПолучательРасходов,
	|
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ПараметрыАмортизацииНМАБУ.СпециальныйКоэффициент, 1) <> 0
	|			ТОГДА ЕСТЬNULL(ПараметрыАмортизацииНМАБУ.СпециальныйКоэффициент, 1)
	|		ИНАЧЕ 1
	|	КОНЕЦ КАК СпециальныйКоэффициентНУ,
	|
	|	СписокНМА.АмортизационнаяГруппа КАК АмортизационнаяГруппа,
	|
	|	&НормаАмортизации КАК НормаАмортизации,
	|
	|	ВЫБОР
	|		КОГДА ГОД(ЕСТЬNULL(ДатыПереходаКЛинейномуМетоду.Дата, ДАТАВРЕМЯ(2009,1,1))) = 2009
	|			ТОГДА ЕСТЬNULL(ПервоначальныеСведенияНМА.ФактическийСрокИспользованияДо2009, 0)
	|		КОГДА ЕСТЬNULL(ДатыПереходаКЛинейномуМетоду.Дата, ДАТАВРЕМЯ(2009,1,1)) <= ЕСТЬNULL(ПервоначальныеСведенияНМА.ДатаПринятияКУчетуБУ, ДАТАВРЕМЯ(1,1,1))
	|			ТОГДА 0
	|		ИНАЧЕ (ГОД(ЕСТЬNULL(ДатыПереходаКЛинейномуМетоду.Дата, ДАТАВРЕМЯ(2009,1,1))) 
	|					- ГОД(ПервоначальныеСведенияНМА.ДатаПринятияКУчетуБУ)) * 12 
	|				+ (МЕСЯЦ(ЕСТЬNULL(ДатыПереходаКЛинейномуМетоду.Дата, ДАТАВРЕМЯ(2009,1,1))) - МЕСЯЦ(ПервоначальныеСведенияНМА.ДатаПринятияКУчетуБУ)) - 1
	|	КОНЕЦ КАК ФактическийСрокПриПереходеКЛинейномуМетоду,
	|
	|	ВЫБОР
	|		КОГДА ГОД(ЕСТЬNULL(ДатыПереходаКЛинейномуМетоду.Дата, ДАТАВРЕМЯ(2009,1,1))) = 2009
	|			ТОГДА ЕСТЬNULL(ПервоначальныеСведенияНМА.АмортизацияДо2009, 0)
	|		КОГДА ЕСТЬNULL(ДатыПереходаКЛинейномуМетоду.Дата, ДАТАВРЕМЯ(2009,1,1)) <= ЕСТЬNULL(ПервоначальныеСведенияНМА.ДатаПринятияКУчетуБУ, ДАТАВРЕМЯ(1,1,1))
	|			ТОГДА 0
	|		ИНАЧЕ ЕСТЬNULL(АмортизацияНМАПриПереходеКЛинейномуМетоду.АмортизацияНУ, 0)
	|	КОНЕЦ КАК АмортизацияПриПереходеКЛинейномуМетоду,
	|
	|	ЕСТЬNULL(СтоимостьНМА.СтоимостьНУ, 0) КАК СтоимостьНУ,
	|	ЕСТЬNULL(СтоимостьНМА.СтоимостьНУЦФ, 0) КАК СтоимостьНУЦФ,
	|
	|	ЕСТЬNULL(СтоимостьНМА.СтоимостьНУ, 0)
	|		+ ЕСТЬNULL(СтоимостьНМА.СтоимостьНУЦФ, 0) КАК СтоимостьНУНачальныйОстаток,
	|
	|	ЕСТЬNULL(АмортизацияНМА.АмортизацияНУ, 0) КАК АмортизацияНУ,
	|	ЕСТЬNULL(АмортизацияНМА.АмортизацияНУЦФ, 0) КАК АмортизацияНУЦФ,
	|
	|	ЕСТЬNULL(АмортизацияНМА.АмортизацияНУ, 0)
	|		+ ЕСТЬNULL(АмортизацияНМА.АмортизацияНУЦФ, 0) КАК АмортизацияНУНачальныйОстаток,
	|
	|	ЕСТЬNULL(СтоимостьНМА.СтоимостьНУ, 0) 
	|		+ ЕСТЬNULL(СтоимостьНМА.СтоимостьНУЦФ, 0)
	|		- ЕСТЬNULL(АмортизацияНМА.АмортизацияНУ, 0)
	|		- ЕСТЬNULL(АмортизацияНМА.АмортизацияНУЦФ, 0) КАК ОстаточнаяСтоимостьНУ,
	|
	// МетодНачисленияАмортизацииНУ
	|	ВЫБОР
	|		КОГДА СписокНМА.ВидОбъектаУчета = ЗНАЧЕНИЕ(Перечисление.ВидыОбъектовУчетаНМА.РасходыНаНИОКР)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.МетодыНачисленияАмортизации.Линейный)
	|		ИНАЧЕ ВЫБОР
	|				КОГДА СписокНМА.АмортизационнаяГруппа В (
	|								ЗНАЧЕНИЕ(Перечисление.АмортизационныеГруппы.ВосьмаяГруппа), 
	|								ЗНАЧЕНИЕ(Перечисление.АмортизационныеГруппы.ДевятаяГруппа), 
	|								ЗНАЧЕНИЕ(Перечисление.АмортизационныеГруппы.ДесятаяГруппа), 
	|								ЗНАЧЕНИЕ(Перечисление.АмортизационныеГруппы.ОтдельнаяГруппа))
	|					ТОГДА ЗНАЧЕНИЕ(Перечисление.МетодыНачисленияАмортизации.Линейный)
	|				ИНАЧЕ ЕСТЬNULL(РегУчетнаяПолитика.МетодНачисленияАмортизацииНУ, ЗНАЧЕНИЕ(Перечисление.МетодыНачисленияАмортизации.Линейный))
	|			КОНЕЦ
	|	КОНЕЦ КАК МетодНачисленияАмортизацииНУ,
	|
	|	ПервоначальныеСведенияНМА.ПервоначальнаяСтоимостьБУ КАК ПервоначальнаяСтоимостьБУ,
	|
	|	ВЫБОР 
	|		КОГДА СписокНМА.ВидОбъектаУчета = ЗНАЧЕНИЕ(Перечисление.ВидыОбъектовУчетаНМА.РасходыНаНИОКР)
	|			ТОГДА ПервоначальныеСведенияНМА.ПервоначальнаяСтоимостьНУ 
	|		ИНАЧЕ ЕСТЬNULL(СтоимостьНМА.СтоимостьНУ, 0)
	|	КОНЕЦ КАК СтоимостьДляВычисленияАмортизацииНУ,
	|
	|	ПараметрыАмортизацииНМАБУ.СрокПолезногоИспользованияНУ,
	|
	|	ВЫБОР 
	|		КОГДА ЕСТЬNULL(СтоимостьНМА.СтоимостьЦФ, 0) = 0
	|				И ЕСТЬNULL(СтоимостьНМА.СтоимостьНУЦФ, 0) = 0
	|				И ЕСТЬNULL(СтоимостьНМА.СтоимостьПРЦФ, 0) = 0
	|				И ЕСТЬNULL(СтоимостьНМА.СтоимостьВРЦФ, 0) = 0
	|			ТОГДА 0
	|		КОГДА ЕСТЬNULL(СтоимостьНМА.СтоимостьРегл, 0) = 0
	|			ТОГДА 1
	|		КОГДА (ЕСТЬNULL(СтоимостьНМА.СтоимостьРегл, 0) + ЕСТЬNULL(СтоимостьНМА.СтоимостьЦФ, 0)) <> 0
	|			ТОГДА ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьНМА.СтоимостьЦФ, 0) / (ЕСТЬNULL(СтоимостьНМА.СтоимостьРегл, 0) + ЕСТЬNULL(СтоимостьНМА.СтоимостьЦФ, 0)) КАК ЧИСЛО (23, 10))
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК КоэффициентЦФБУ,
	|
	|	ВЫБОР 
	|		КОГДА ЕСТЬNULL(СтоимостьНМА.СтоимостьЦФ, 0) = 0
	|				И ЕСТЬNULL(СтоимостьНМА.СтоимостьНУЦФ, 0) = 0
	|				И ЕСТЬNULL(СтоимостьНМА.СтоимостьПРЦФ, 0) = 0
	|				И ЕСТЬNULL(СтоимостьНМА.СтоимостьВРЦФ, 0) = 0
	|			ТОГДА 0
	|		КОГДА ЕСТЬNULL(СтоимостьНМА.СтоимостьНУ, 0) = 0
	|			ТОГДА 1
	|		КОГДА (ЕСТЬNULL(СтоимостьНМА.СтоимостьНУ, 0) + ЕСТЬNULL(СтоимостьНМА.СтоимостьНУЦФ, 0)) <> 0
	|			ТОГДА ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьНМА.СтоимостьНУЦФ, 0) / (ЕСТЬNULL(СтоимостьНМА.СтоимостьНУ, 0) + ЕСТЬNULL(СтоимостьНМА.СтоимостьНУЦФ, 0)) КАК ЧИСЛО (23, 10))
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК КоэффициентЦФНУ,
	|
	|	ВЫБОР 
	|		КОГДА ЕСТЬNULL(СтоимостьНМА.СтоимостьЦФ, 0) = 0
	|				И ЕСТЬNULL(СтоимостьНМА.СтоимостьНУЦФ, 0) = 0
	|				И ЕСТЬNULL(СтоимостьНМА.СтоимостьПРЦФ, 0) = 0
	|				И ЕСТЬNULL(СтоимостьНМА.СтоимостьВРЦФ, 0) = 0
	|			ТОГДА 0
	|		КОГДА ЕСТЬNULL(СтоимостьНМА.СтоимостьПР, 0) = 0
	|			ТОГДА 1
	|		КОГДА (ЕСТЬNULL(СтоимостьНМА.СтоимостьПР, 0) + ЕСТЬNULL(СтоимостьНМА.СтоимостьПРЦФ, 0)) <> 0
	|			ТОГДА ВЫРАЗИТЬ(ЕСТЬNULL(СтоимостьНМА.СтоимостьПРЦФ, 0) / (ЕСТЬNULL(СтоимостьНМА.СтоимостьПР, 0) + ЕСТЬNULL(СтоимостьНМА.СтоимостьПРЦФ, 0)) КАК ЧИСЛО (23, 10))
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК КоэффициентЦФПР
	|
	|ПОМЕСТИТЬ СписокНМАСПараметрами_НУ
	|
	|ИЗ
	|	СписокОбъектовУчета_БУ КАК СписокНМА
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПорядокУчетаНМА КАК ПорядокУчетаНМА
	|		ПО (ПорядокУчетаНМА.Организация = СписокНМА.Организация)
	|			И (ПорядокУчетаНМА.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|			И (ПорядокУчетаНМА.НачалоМесяца = СписокНМА.НачалоМесяца)
	|			И (ПорядокУчетаНМА.ПериодПараметров = СписокНМА.ПериодПараметров)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ СтоимостьНМА_НаНачалоМесяца КАК СтоимостьНМА
	|		ПО (СтоимостьНМА.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|			И (СтоимостьНМА.НачалоМесяца = СписокНМА.НачалоМесяца)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ СтоимостьНМА_НаНачалоГода КАК СтоимостьНМАНаНачалоГода
	|		ПО (СтоимостьНМАНаНачалоГода.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ АмортизацияНМА_НаНачалоМесяца КАК АмортизацияНМА
	|		ПО (АмортизацияНМА.Организация = СписокНМА.Организация)
	|			И (АмортизацияНМА.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|			И (АмортизацияНМА.НачалоМесяца = СписокНМА.НачалоМесяца)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ АмортизацияНМАПриПереходеКЛинейномуМетоду КАК АмортизацияНМАПриПереходеКЛинейномуМетоду
	|		ПО (АмортизацияНМАПриПереходеКЛинейномуМетоду.Организация = СписокНМА.Организация)
	|			И (АмортизацияНМАПриПереходеКЛинейномуМетоду.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ОбесценениеВНА КАК ОбесценениеНаНачалоМесяца
	|		ПО (ОбесценениеНаНачалоМесяца.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|			И (ОбесценениеНаНачалоМесяца.НачалоМесяца = СписокНМА.НачалоМесяца)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ МестоУчетаНМА КАК МестоУчетаНМА
	|		ПО (МестоУчетаНМА.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|			И (МестоУчетаНМА.НачалоМесяца = СписокНМА.НачалоМесяца)
	|			И (МестоУчетаНМА.ПериодПараметров = СписокНМА.ПериодПараметров)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПервоначальныеСведенияНМА КАК ПервоначальныеСведенияНМА
	|		ПО (ПервоначальныеСведенияНМА.Организация = СписокНМА.Организация)
	|			И (ПервоначальныеСведенияНМА.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|			И (ПервоначальныеСведенияНМА.НачалоМесяца = СписокНМА.НачалоМесяца)
	|			И (ПервоначальныеСведенияНМА.ПериодПараметров = СписокНМА.ПериодПараметров)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПараметрыАмортизацииНМАБУ КАК ПараметрыАмортизацииНМАБУ
	|		ПО (ПараметрыАмортизацииНМАБУ.Организация = СписокНМА.Организация)
	|			И (ПараметрыАмортизацииНМАБУ.НематериальныйАктив = СписокНМА.НематериальныйАктив)
	|			И (ПараметрыАмортизацииНМАБУ.ПериодПараметров = СписокНМА.ПериодПараметров)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ДатыПереходаКЛинейномуМетоду КАК ДатыПереходаКЛинейномуМетоду
	|		ПО (ДатыПереходаКЛинейномуМетоду.Организация = СписокНМА.Организация)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НастройкиУчетаНалогаНаПрибыль.СрезПоследних(&КонецМесяца) КАК РегУчетнаяПолитика
	|		ПО РегУчетнаяПолитика.Организация = СписокНМА.ГоловнаяОрганизация
	|
	|ГДЕ
	|	СписокНМА.НачислятьАмортизациюНУ
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	НематериальныйАктив,
	|	Организация";

	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&НормаАмортизации", 
		РасчетАмортизацииНМАЛокализация.ТекстПоляНормаАмортизации("СписокНМА.АмортизационнаяГруппа"));
		
	СписокЗапросов.Добавить(ТекстЗапроса);
		
	#КонецОбласти
	
	//-- Локализация
	
КонецПроцедуры
 
// 
// Параметры:
//  СписокЗапросов - Массив из Строка - 
//  ПараметрыРасчета - см. РасчетАмортизацииНМА.ПараметрыВыполнения
Процедура ДополнитьТекстЗапросаПроверкаПараметровРасчета(СписокЗапросов, ПараметрыРасчета) Экспорт

	//++ Локализация
	
	#Область ПроверкаПараметровРасчета_БУ
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	СписокНМА.Организация КАК Организация,
	|	СписокНМА.НематериальныйАктив КАК ОбъектУчета,
	|
	// НеУказанОбъемНаработки
	|	СписокНМА.НачислятьАмортизациюБУ
	|		И СписокНМА.МетодНачисленияАмортизацииБУ = ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииНМА.ПропорциональноОбъемуПродукции)
	|		И СписокНМА.ОбъемНаработки = 0 КАК НеУказанОбъемНаработки
	|
	|ПОМЕСТИТЬ ПроверкаПараметровРасчета_БУ
	|ИЗ
	|	СписокНМАСПараметрами_БУ КАК СписокНМА
	|ГДЕ
	|	СписокНМА.НачислятьАмортизациюБУ
	|	И СписокНМА.МетодНачисленияАмортизацииБУ = ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииНМА.ПропорциональноОбъемуПродукции)
	|	И СписокНМА.ОбъемНаработки = 0
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ОбъектУчета";
	СписокЗапросов.Добавить(ТекстЗапроса);
	#КонецОбласти

	#Область ПроверкаПараметровРасчетаИзменения_БУ
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	СписокНМА.Организация КАК Организация,
	|	СписокНМА.ОбъектУчета КАК ОбъектУчета,
	|	СписокНМА.НеУказанСрокИспользованияБУ КАК НеУказанСрокИспользованияБУ,
	|	СписокНМА.НеУказанОбъемНаработки КАК НеУказанОбъемНаработки,
	|	СписокНМА.НеУказанРесурсВыработанный КАК НеУказанРесурсВыработанный
	|
	|ПОМЕСТИТЬ ПроверкаПараметровРасчетаИзменения_БУ
	|
	|ИЗ
	|	(ВЫБРАТЬ
	|		СписокНМА.Организация КАК Организация,
	|		СписокНМА.НематериальныйАктив КАК ОбъектУчета,
	|
			// НеУказанСрокИспользованияБУ
	|		СписокНМА.МетодНачисленияАмортизацииБУ = ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииНМА.Линейный)
	|			И ЕСТЬNULL(СписокНМА.РесурсНазначенный, 0) = 0 КАК НеУказанСрокИспользованияБУ,
	|
			// НеУказанОбъемНаработки
	|		СписокНМА.МетодНачисленияАмортизацииБУ = ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииНМА.ПропорциональноОбъемуПродукции)
	|			И ЕСТЬNULL(СписокНМА.РесурсНазначенный, 0) = 0 КАК НеУказанОбъемНаработки,
	|
			// НеУказанРесурсВыработанный
	|		СписокНМА.РесурсВыработанныйЗаТекущийПериод ЕСТЬ NULL
	|			ИЛИ СписокНМА.РесурсВыработанныйЗаПрошлыйПериод ЕСТЬ NULL КАК НеУказанРесурсВыработанный
	|
	|	ИЗ
	|		СписокНМАСИзмененнымиПараметрами_БУ КАК СписокНМА
	|	ГДЕ
	|		СписокНМА.НачислятьАмортизациюБУ
	|		И СписокНМА.ОстаточнаяСтоимостьРегл > 0
	|
	|	) КАК СписокНМА
	|
	|ГДЕ
	|	(СписокНМА.НеУказанСрокИспользованияБУ
	|		ИЛИ СписокНМА.НеУказанОбъемНаработки
	|		ИЛИ СписокНМА.НеУказанРесурсВыработанный)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ОбъектУчета";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область ПроверкаПараметровРасчета_НУ
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	СписокНМА.Организация КАК Организация,
	|	СписокНМА.НематериальныйАктив КАК ОбъектУчета,
	|
	// НеУказанаАмортизационнаяГруппа
	|	СписокНМА.НачислятьАмортизациюНУ
	|		И СписокНМА.МетодНачисленияАмортизацииНУ = ЗНАЧЕНИЕ(Перечисление.МетодыНачисленияАмортизации.Нелинейный)
	|		И СписокНМА.АмортизационнаяГруппа = ЗНАЧЕНИЕ(Перечисление.АмортизационныеГруппы.ПустаяСсылка) КАК НеУказанаАмортизационнаяГруппа
	|
	|ПОМЕСТИТЬ ПроверкаПараметровРасчета_НУ
	|ИЗ
	|	СписокНМАСПараметрами_НУ КАК СписокНМА
	|ГДЕ
	|	СписокНМА.НачислятьАмортизациюНУ
	|		И СписокНМА.МетодНачисленияАмортизацииНУ = ЗНАЧЕНИЕ(Перечисление.МетодыНачисленияАмортизации.Нелинейный)
	|		И СписокНМА.АмортизационнаяГруппа = ЗНАЧЕНИЕ(Перечисление.АмортизационныеГруппы.ПустаяСсылка)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ОбъектУчета";
	СписокЗапросов.Добавить(ТекстЗапроса);
	#КонецОбласти
	
	//-- Локализация
	
КонецПроцедуры

// 
// Параметры:
//  ПараметрыРасчета - см. РасчетАмортизацииНМА.ПараметрыВыполнения
// 
// Возвращаемое значение:
//  Строка - Текст запроса
Функция ТекстЗапросаКоличествоОбработанныхДанных(ПараметрыРасчета) Экспорт

	ТекстЗапроса = Неопределено;
	
	//++ Локализация
	
	ТекстЗапроса =  
	"ВЫБРАТЬ
	|	ЕСТЬNULL(КОЛИЧЕСТВО(РасчетАмортизации.НематериальныйАктив), 0) КАК КоличествоДанных
	|ИЗ
	|	(ВЫБРАТЬ
	|		РасчетАмортизации.НематериальныйАктив КАК НематериальныйАктив
	|	ИЗ
	|		РасчетАмортизации_БУ КАК РасчетАмортизации
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		РасчетАмортизации.НематериальныйАктив
	|	ИЗ
	|		РасчетАмортизации_УУ КАК РасчетАмортизации) КАК РасчетАмортизации";
	
	//-- Локализация

	Возврат ТекстЗапроса;
	
КонецФункции

// 
// Возвращаемое значение:
//  Строка - Текст запроса
Функция ТекстЗапросаСписокОбъектовУчетаДоначислениеВсе() Экспорт
	
	ТекстЗапроса = Неопределено;
	
	//++ Локализация
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	СписокОбъектовУчета.Организация      КАК Организация,
	|	СписокОбъектовУчета.НематериальныйАктив КАК НематериальныйАктив,
	|	СписокОбъектовУчета.Период           КАК Период
	|
	|ПОМЕСТИТЬ СписокОбъектовУчета_Доначисление_Все
	|ИЗ
	|	СписокОбъектовУчета_Доначисление_УУ КАК СписокОбъектовУчета
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	НематериальныйАктив,
	|	Организация";
	//-- Локализация
	
	Возврат ТекстЗапроса;
	
КонецФункции

// 
// Возвращаемое значение:
//  Строка - Текст запроса
Функция ТекстЗапросаВтНачисленнаяАмортизация() Экспорт

	ТекстЗапроса = Неопределено;
	
	//++ Локализация
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ВЫБОР 
	|		КОГДА НачисленнаяАмортизация.ВидОбъектаУчета = ЗНАЧЕНИЕ(Перечисление.ВидыОбъектовУчетаНМА.РасходыНаНИОКР)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыВнеоборотныхАктивов.НИОКР)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыВнеоборотныхАктивов.НМА)
	|	КОНЕЦ КАК ВидВНА,
	|	НачисленнаяАмортизация.ПериодРасчета КАК ПериодРасчета,
	|	НачисленнаяАмортизация.ВидОбъектаУчета КАК ВидОбъектаУчета,
	|	НачисленнаяАмортизация.Организация КАК Организация,
	|	ЕСТЬNULL(ПакетыАмортизацииНМА.НомерПакета, 0) КАК НомерПакета,
	|	НачисленнаяАмортизация.Подразделение КАК Подразделение,
	|	НачисленнаяАмортизация.КорПодразделение КАК КорПодразделение,
	|	НачисленнаяАмортизация.НематериальныйАктив КАК НематериальныйАктив,
	|	НачисленнаяАмортизация.ЕГДС КАК ЕГДС,
	|	НачисленнаяАмортизация.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	НачисленнаяАмортизация.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	НачисленнаяАмортизация.КорНаправлениеДеятельности КАК КорНаправлениеДеятельности,
	|	НачисленнаяАмортизация.СтатьяРасходов КАК СтатьяРасходов,
	|	НачисленнаяАмортизация.АналитикаРасходов КАК АналитикаРасходов,
	|	ЛОЖЬ КАК ПередаватьРасходыВДругуюОрганизацию,
	|	ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка) КАК ОрганизацияПолучательРасходов,
	|	НачисленнаяАмортизация.ЭтоДоначисление КАК ЭтоДоначисление,
	|	НачисленнаяАмортизация.ЭтоДоначислениеБУ КАК ЭтоДоначислениеБУ,
	|	МАКСИМУМ(НачисленнаяАмортизация.РесурсВыработанныйЗаПрошлыйПериод) КАК РесурсВыработанныйЗаПрошлыйПериод,
	|	МАКСИМУМ(НачисленнаяАмортизация.РесурсВыработанныйЗаТекущийПериод) КАК РесурсВыработанныйЗаТекущийПериод,
	|	МАКСИМУМ(НачисленнаяАмортизация.РесурсВыработанныйЗаПрошлыйПериодБУ) КАК РесурсВыработанныйЗаПрошлыйПериодБУ,
	|	МАКСИМУМ(НачисленнаяАмортизация.РесурсВыработанныйЗаТекущийПериодБУ) КАК РесурсВыработанныйЗаТекущийПериодБУ,
	|	МАКСИМУМ(НачисленнаяАмортизация.СтоимостьДляВычисленияАмортизации) КАК СтоимостьДляВычисленияАмортизации,
	|	МАКСИМУМ(НачисленнаяАмортизация.СтоимостьДляВычисленияАмортизацииРегл) КАК СтоимостьДляВычисленияАмортизацииРегл,
	|	МАКСИМУМ(НачисленнаяАмортизация.ОстатокОбесцененияРегл) КАК ОстатокОбесцененияРегл,
	|	МАКСИМУМ(НачисленнаяАмортизация.ОстатокОбесцененияУпр) КАК ОстатокОбесцененияУпр,
	|	МАКСИМУМ(НачисленнаяАмортизация.ПорядокУчетаУУ) КАК ПорядокУчетаУУ,
	|	МАКСИМУМ(НачисленнаяАмортизация.ПорядокУчетаБУ) КАК ПорядокУчетаБУ,
	|	МАКСИМУМ(НачисленнаяАмортизация.ПорядокНачисленияАмортизацииУУ) КАК ПорядокНачисленияАмортизацииУУ,
	|	МАКСИМУМ(НачисленнаяАмортизация.ПорядокНачисленияАмортизацииБУ) КАК ПорядокНачисленияАмортизацииБУ,
	|	МАКСИМУМ(НачисленнаяАмортизация.ВариантПроводокПоОбесценениюВНА) КАК ВариантПроводокПоОбесценениюВНА,
	|
	|	ЛОЖЬ КАК НачислятьИзнос,
	|
	|	&ИдентификаторСтрокиТаблицы КАК ИдентификаторСтроки,
	|
	|	СУММА(НачисленнаяАмортизация.СуммаУУ) КАК СуммаУУ,
	|	СУММА(НачисленнаяАмортизация.СуммаБУ) КАК СуммаБУ,
	|	СУММА(НачисленнаяАмортизация.СуммаНУ) КАК СуммаНУ,
	|	СУММА(НачисленнаяАмортизация.СуммаПР) КАК СуммаПР,
	|	СУММА(НачисленнаяАмортизация.СуммаВР) КАК СуммаВР,
	|	СУММА(НачисленнаяАмортизация.СуммаЦФ) КАК СуммаЦФ,
	|	СУММА(НачисленнаяАмортизация.СуммаНУЦФ) КАК СуммаНУЦФ,
	|	СУММА(НачисленнаяАмортизация.СуммаПРЦФ) КАК СуммаПРЦФ,
	|	СУММА(НачисленнаяАмортизация.СуммаВРЦФ) КАК СуммаВРЦФ,
	|
	|	СУММА(НачисленнаяАмортизация.ОбесценениеУУ) КАК ОбесценениеУУ,
	|	СУММА(НачисленнаяАмортизация.ОбесценениеБУ) КАК ОбесценениеБУ,
	|	СУММА(НачисленнаяАмортизация.ОбесценениеЦФ) КАК ОбесценениеЦФ
	|
	|ПОМЕСТИТЬ НачисленнаяАмортизация
	|
	|ИЗ
	|	&ТекстПодзапроса КАК НачисленнаяАмортизация
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПакетыАмортизацииНМА КАК ПакетыАмортизацииНМА
	|		ПО ПакетыАмортизацииНМА.Организация = НачисленнаяАмортизация.Организация
	|			И ПакетыАмортизацииНМА.НематериальныйАктив = НачисленнаяАмортизация.НематериальныйАктив
	|
	|СГРУППИРОВАТЬ ПО
	|	ВЫБОР 
	|		КОГДА НачисленнаяАмортизация.ВидОбъектаУчета = ЗНАЧЕНИЕ(Перечисление.ВидыОбъектовУчетаНМА.РасходыНаНИОКР)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыВнеоборотныхАктивов.НИОКР)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыВнеоборотныхАктивов.НМА)
	|	КОНЕЦ,
	|	НачисленнаяАмортизация.ПериодРасчета,
	|	НачисленнаяАмортизация.ВидОбъектаУчета,
	|	НачисленнаяАмортизация.Организация,
	|	НачисленнаяАмортизация.ЕГДС,
	|	ЕСТЬNULL(ПакетыАмортизацииНМА.НомерПакета, 0),
	|	НачисленнаяАмортизация.Подразделение,
	|	НачисленнаяАмортизация.КорПодразделение,
	|	НачисленнаяАмортизация.ГруппаФинансовогоУчета,
	|	НачисленнаяАмортизация.НаправлениеДеятельности,
	|	НачисленнаяАмортизация.КорНаправлениеДеятельности,
	|	НачисленнаяАмортизация.НематериальныйАктив,
	|	НачисленнаяАмортизация.СтатьяРасходов,
	|	НачисленнаяАмортизация.АналитикаРасходов,
	|	НачисленнаяАмортизация.ЭтоДоначисление,
	|	НачисленнаяАмортизация.ЭтоДоначислениеБУ,
	|	&ГруппировкаИдентификатора";
	//-- Локализация
	
	Возврат ТекстЗапроса;
	
КонецФункции

#КонецОбласти

#КонецОбласти

#КонецОбласти

//++ Локализация

#Область СлужебныеПроцедурыИФункции

#Область Проведение

Процедура ТекстЗапросаТаблицаПрочиеДоходы(Запрос, ТекстыЗапроса, Регистры)
	
	ИмяРегистра = "ПрочиеДоходы";
	
	Если НЕ ПроведениеДокументов.ТребуетсяТаблицаДляДвижений(ИмяРегистра, Регистры) Тогда
		Возврат;
	КонецЕсли;
	
	ТекстЗапросаТаблицаВтПараметрыЦелевогоФинансированияНМА(ТекстыЗапроса);
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) КАК ВидДвижения,
	|	НачисленнаяАмортизация.ПериодРасчета КАК Период,
	|	&Ссылка КАК Регистратор,
	|	
	|	НачисленнаяАмортизация.Организация КАК Организация,
	|
	|	НачисленнаяАмортизация.КорПодразделение КАК Подразделение,
	|	НачисленнаяАмортизация.КорНаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ПараметрыЦФ.СтатьяДоходов КАК СтатьяДоходов,
	|	ПараметрыЦФ.АналитикаДоходов КАК АналитикаДоходов,
	|	
	|	НачисленнаяАмортизация.СуммаЦФ КАК СуммаРегл,
	|
	|	ЛОЖЬ КАК РасчетСебестоимости
	|
	|ИЗ
	|	НачисленнаяАмортизация КАК НачисленнаяАмортизация
	|
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ДанныеДокументаРеквизиты КАК ДанныеДокумента
	|		ПО ДанныеДокумента.Организация = НачисленнаяАмортизация.Организация
	|			И ДанныеДокумента.НомерПакета = НачисленнаяАмортизация.НомерПакета
	|
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ втПараметрыЦелевогоФинансированияНМА КАК ПараметрыЦФ
	|		ПО ПараметрыЦФ.НематериальныйАктив = НачисленнаяАмортизация.НематериальныйАктив
	|
	|ГДЕ
	|	НачисленнаяАмортизация.СуммаЦФ <> 0
	|	И &ИспользоватьУчетПрочихДоходовРасходов
	|";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса, ИмяРегистра);
	
КонецПроцедуры

Процедура ТекстЗапросаТаблицаВтПараметрыЦелевогоФинансированияНМА(ТекстыЗапроса)
	
	ИмяТаблицы = "втПараметрыЦелевогоФинансированияНМА";
	
	Если ПроведениеДокументов.ЕстьТаблицаЗапроса(ИмяТаблицы, ТекстыЗапроса) Тогда
		Возврат;
	КонецЕсли;
	
	ТекстЗапросаТаблицавтСписокНМА(ТекстыЗапроса);
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	ПараметрыЦелевогоФинансированияНМА.НематериальныйАктив КАК НематериальныйАктив,
	|	ПараметрыЦелевогоФинансированияНМА.СтатьяДоходов КАК СтатьяДоходов,
	|	ПараметрыЦелевогоФинансированияНМА.АналитикаДоходов КАК АналитикаДоходов
	|
	|ПОМЕСТИТЬ втПараметрыЦелевогоФинансированияНМА
	|
	|ИЗ
	|	РегистрСведений.ПараметрыЦелевогоФинансированияНМА.СрезПоследних(
	|			&Период,
	|			НематериальныйАктив В
	|				(ВЫБРАТЬ
	|					втСписокНМА.НематериальныйАктив
	|				ИЗ
	|					втСписокНМА КАК втСписокНМА)) КАК ПараметрыЦелевогоФинансированияНМА
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	НематериальныйАктив
	|";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса, ИмяТаблицы);
	
КонецПроцедуры

Процедура ТекстЗапросаТаблицавтСписокНМА(ТекстыЗапроса)
	
	ИмяТаблицы = "втСписокНМА";
	
	Если ПроведениеДокументов.ЕстьТаблицаЗапроса(ИмяТаблицы, ТекстыЗапроса) Тогда
		Возврат;
	КонецЕсли;
	
	ТекстЗапроса = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	НачисленнаяАмортизация.Организация КАК Организация,
	|	НачисленнаяАмортизация.НематериальныйАктив КАК НематериальныйАктив
	|
	|ПОМЕСТИТЬ втСписокНМА
	|
	|ИЗ
	|	НачисленнаяАмортизация КАК НачисленнаяАмортизация
	|
	|ГДЕ
	|	НачисленнаяАмортизация.СуммаЦФ <> 0
	|
	|	И ИСТИНА В (
	|		ВЫБРАТЬ ПЕРВЫЕ 1
	|			ИСТИНА
	|		ИЗ
	|			ДанныеДокументаРеквизиты КАК ДанныеДокумента
	|		ГДЕ
	|			ДанныеДокумента.Организация = НачисленнаяАмортизация.Организация
	|			И ДанныеДокумента.НомерПакета = НачисленнаяАмортизация.НомерПакета)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	НематериальныйАктив,
	|	Организация
	|";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса, ИмяТаблицы);
	
КонецПроцедуры

#КонецОбласти

#Область РасчетАмортизации

#Область ФормированиеТекстаРасчетаАмортизации

Процедура ДоначислитьАмортизациюБУЗаПрошлыйМесяц(ПараметрыРасчета)
	
	Запрос = Новый Запрос;
	Запрос.МенеджерВременныхТаблиц = ПараметрыРасчета.МенеджерВременныхТаблиц;
	РасчетАмортизацииНМА.УстановитьПараметрыЗапросаДляРасчетаАмортизации(Запрос, ПараметрыРасчета);

	// Расчет за прошлый месяц до изменения параметров.
	// И получение данных для расчета с учетом изменения параметров.
	СписокЗапросов = Новый Массив;
	
	ТекстЗапросаДоначислениеАмортизацииБезИзмененийБУ(СписокЗапросов, ПараметрыРасчета);
	ТекстЗапросаДоначислениеАмортизацииВыборкаИзмененийБУ(СписокЗапросов, ПараметрыРасчета);
	
	Запрос.Текст = СтрСоединить(СписокЗапросов, ОбщегоНазначения.РазделительПакетаЗапросов());
	РезультатЗапроса = Запрос.Выполнить();
	
	АмортизацияИзменений = Документы.АмортизацияНМА2_4.РассчитатьАмортизациюПриИзмененииПараметров(РезультатЗапроса);
	
	// Объединение всех расчетов
	СписокЗапросов = Новый Массив;
	
	ТекстЗапросаДоначислениеАмортизацииБУ(СписокЗапросов, ПараметрыРасчета);
	ТекстЗапросаДоначислениеАмортизацииБУ_Сгруппированная(СписокЗапросов, ПараметрыРасчета);
	
	Запрос.Текст = СтрСоединить(СписокЗапросов, ОбщегоНазначения.РазделительПакетаЗапросов());
	Запрос.УстановитьПараметр("АмортизацияИзменений_БУ", АмортизацияИзменений);
	РезультатЗапроса = Запрос.ВыполнитьПакет();
	
КонецПроцедуры

Процедура РассчитатьАмортизациюБУЗаТекущийМесяц(ПараметрыРасчета)
	
	Запрос = Новый Запрос;
	Запрос.МенеджерВременныхТаблиц = ПараметрыРасчета.МенеджерВременныхТаблиц;
	РасчетАмортизацииНМА.УстановитьПараметрыЗапросаДляРасчетаАмортизации(Запрос, ПараметрыРасчета);

	// Расчет за текущий месяц до изменения параметров
	// И получение данных для расчета с учетом изменения параметров
	СписокЗапросов = Новый Массив;
	
	ТекстЗапросаРасчетАмортизацииБезИзмененийБУ(СписокЗапросов, ПараметрыРасчета);
	ТекстЗапросаРасчетАмортизацииВыборкаИзмененийБУ(СписокЗапросов, ПараметрыРасчета);
	
	Запрос.Текст = СтрСоединить(СписокЗапросов, ОбщегоНазначения.РазделительПакетаЗапросов());
	РезультатЗапроса = Запрос.Выполнить();
	
	АмортизацияИзменений = Документы.АмортизацияНМА2_4.РассчитатьАмортизациюПриИзмененииПараметров(РезультатЗапроса);
	
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	СписокНМА.Период КАК ПериодРасчета,
	|	СписокНМА.Организация КАК Организация,
	|	СписокНМА.Подразделение КАК Подразделение,
	|	СписокНМА.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	СписокНМА.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	СписокНМА.НематериальныйАктив КАК НематериальныйАктив,
	|	СписокНМА.ВидОбъектаУчета КАК ВидОбъектаУчета,
	|	СписокНМА.СтатьяРасходов КАК СтатьяРасходов,
	|	СписокНМА.АналитикаРасходов КАК АналитикаРасходов,
	|	СписокНМА.СпособОтраженияРасходов КАК СпособОтраженияРасходов,
	|	СписокНМА.СуммаБУ КАК СуммаБУ,
	|	СписокНМА.СуммаПР КАК СуммаПР,
	|	СписокНМА.ОбесценениеБУ КАК ОбесценениеБУ,
	|	СписокНМА.ПередаватьРасходыВДругуюОрганизацию КАК ПередаватьРасходыВДругуюОрганизацию,
	|	СписокНМА.ОрганизацияПолучательРасходов КАК ОрганизацияПолучательРасходов,
	|	СписокНМА.РесурсВыработанныйЗаПрошлыйПериод КАК РесурсВыработанныйЗаПрошлыйПериод,
	|	СписокНМА.РесурсВыработанныйЗаТекущийПериод КАК РесурсВыработанныйЗаТекущийПериод,
	|	СписокНМА.РесурсНазначенный КАК РесурсНазначенный,
	|	СписокНМА.СтоимостьДляВычисленияАмортизацииРегл КАК СтоимостьДляВычисленияАмортизации,
	|
	|	СписокНМА.СтоимостьДляВычисленияАмортизацииРегл КАК ОстаточнаяСтоимостьРегл,
	|	СписокНМА.СтоимостьДляВычисленияАмортизацииРегл * СписокНМА.КоэффициентЦФБУ КАК ОстаточнаяСтоимостьЦФ,
	|
	|	СписокНМА.ОстаточнаяСтоимостьПР КАК ОстаточнаяСтоимостьПР,
	|	СписокНМА.ОстаточнаяСтоимостьПРЦФ КАК ОстаточнаяСтоимостьПРЦФ, 
	|                       
	|	СписокНМА.ОстатокОбесцененияРегл КАК ОстатокОбесцененияРегл,
	|
	|	СписокНМА.КоэффициентЦФБУ КАК КоэффициентЦФБУ,
	|	СписокНМА.КоэффициентЦФНУ КАК КоэффициентЦФНУ,
	|	СписокНМА.КоэффициентЦФПР КАК КоэффициентЦФПР,
	|	СписокНМА.ПервоначальнаяСтоимостьБУ КАК ПервоначальнаяСтоимостьБУ,
	|	СписокНМА.СтоимостьРегл КАК СтоимостьРегл,
	|	СписокНМА.СтоимостьЦФ КАК СтоимостьЦФ,
	|	СписокНМА.СтоимостьПР КАК СтоимостьПР,
	|	СписокНМА.СтоимостьПРЦФ КАК СтоимостьПРЦФ
	|
	|ПОМЕСТИТЬ РасчетАмортизацииСУчетомИзмененийБУ
	|
	|ИЗ
	|	&АмортизацияИзменений_БУ КАК СписокНМА
	|
	|ГДЕ
	|	СписокНМА.ЭтоИзменения";

	Запрос.УстановитьПараметр("АмортизацияИзменений_БУ", АмортизацияИзменений);
	Запрос.Выполнить();
	
КонецПроцедуры

Процедура ТекстЗапросаДоначислениеАмортизацииБезИзмененийБУ(СписокЗапросов, ПараметрыРасчета)
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	СписокНМА.Период КАК Период,
	|	СписокНМА.Организация КАК Организация,
	|	СписокНМА.Подразделение КАК Подразделение,
	|	СписокНМА.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	СписокНМА.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	СписокНМА.НематериальныйАктив КАК НематериальныйАктив,
	|	СписокНМА.ВидОбъектаУчета КАК ВидОбъектаУчета,
	|	СписокНМА.СтатьяРасходов КАК СтатьяРасходов,
	|	СписокНМА.АналитикаРасходов КАК АналитикаРасходов,
	|	СписокНМА.СпособОтраженияРасходов КАК СпособОтраженияРасходов,
	|	СписокНМА.ПередаватьРасходыВДругуюОрганизацию КАК ПередаватьРасходыВДругуюОрганизацию,
	|	СписокНМА.ОрганизацияПолучательРасходов КАК ОрганизацияПолучательРасходов,
	|	СписокНМА.РесурсВыработанныйЗаПрошлыйПериод КАК РесурсВыработанныйЗаПрошлыйПериод,
	|	СписокНМА.РесурсВыработанныйЗаТекущийПериод КАК РесурсВыработанныйЗаТекущийПериод,
	|	СписокНМА.СтоимостьДляВычисленияАмортизации КАК СтоимостьДляВычисленияАмортизации,
	|	СписокНМА.ВариантПроводокПоОбесценениюВНА КАК ВариантПроводокПоОбесценениюВНА,
	|	СписокНМА.ОстаточнаяСтоимостьРегл КАК ОстаточнаяСтоимостьРегл,
	|	СписокНМА.ОстаточнаяСтоимостьЦФ КАК ОстаточнаяСтоимостьЦФ,
	|	СписокНМА.ОстаточнаяСтоимостьПР КАК ОстаточнаяСтоимостьПР,
	|	СписокНМА.ОстаточнаяСтоимостьПРЦФ КАК ОстаточнаяСтоимостьПРЦФ, 
	|	СписокНМА.РесурсНазначенный КАК РесурсНазначенный,
	|	СписокНМА.МетодНачисленияАмортизацииБУ КАК МетодНачисленияАмортизацииБУ,
	|	СписокНМА.ЛиквидационнаяСтоимость КАК ЛиквидационнаяСтоимость,
	|	СписокНМА.КоэффициентБУ КАК КоэффициентБУ,
	|	СписокНМА.ОтработанныхМесяцевПолныхЛет КАК ОтработанныхМесяцевПолныхЛет,
	|	СписокНМА.НачислятьАмортизациюБУ КАК НачислятьАмортизациюБУ,
	|	СписокНМА.КоэффициентЦФБУ КАК КоэффициентЦФБУ,
	|	СписокНМА.КоэффициентЦФНУ КАК КоэффициентЦФНУ,
	|	СписокНМА.КоэффициентЦФПР КАК КоэффициентЦФПР,
	|	СписокНМА.ПервоначальнаяСтоимостьБУ КАК ПервоначальнаяСтоимостьБУ,
	|	СписокНМА.СтоимостьРегл КАК СтоимостьРегл,
	|	СписокНМА.СтоимостьЦФ КАК СтоимостьЦФ,
	|	СписокНМА.СтоимостьПР КАК СтоимостьПР,
	|	СписокНМА.СтоимостьПРЦФ КАК СтоимостьПРЦФ,
	|
	|	СписокНМА.СуммаБУ КАК СуммаБУ,
	|
	|	ВЫБОР
	|		КОГДА СписокНМА.ОстаточнаяСтоимостьПР = 0
	|				ИЛИ СписокНМА.ОстаточнаяСтоимостьРегл = 0
	|				ИЛИ СписокНМА.СуммаБУ = 0
	| 
	|			ТОГДА 0
	|
	|		КОГДА СписокНМА.СуммаБУ = СписокНМА.ОстаточнаяСтоимостьРегл
	| 
	|			ТОГДА СписокНМА.ОстаточнаяСтоимостьПР
	|
	|		ИНАЧЕ ВЫРАЗИТЬ(СписокНМА.ОстаточнаяСтоимостьПР
	|				* (ВЫРАЗИТЬ(СписокНМА.СуммаБУ КАК ЧИСЛО (25, 12)) / ВЫРАЗИТЬ(СписокНМА.ОстаточнаяСтоимостьРегл КАК ЧИСЛО (25, 12))) КАК ЧИСЛО (31, 2))
	|
	|	КОНЕЦ КАК СуммаПР
	|
	|ПОМЕСТИТЬ ДоначислениеАмортизацииБезИзмененийБУ
	|
	|ИЗ
	|	(ВЫБРАТЬ
	|		СписокНМА.Период КАК Период,
	|		СписокНМА.Организация КАК Организация,
	|		СписокНМА.Подразделение КАК Подразделение,
	|		СписокНМА.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|		СписокНМА.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|		СписокНМА.НематериальныйАктив КАК НематериальныйАктив,
	|		СписокНМА.ВидОбъектаУчета КАК ВидОбъектаУчета,
	|		СписокНМА.СтатьяРасходов КАК СтатьяРасходов,
	|		СписокНМА.АналитикаРасходов КАК АналитикаРасходов,
	|		СписокНМА.СпособОтраженияРасходов КАК СпособОтраженияРасходов,
	|		СписокНМА.ПередаватьРасходыВДругуюОрганизацию КАК ПередаватьРасходыВДругуюОрганизацию,
	|		СписокНМА.ОрганизацияПолучательРасходов КАК ОрганизацияПолучательРасходов,
	|		СписокНМА.РесурсВыработанныйЗаПрошлыйПериод КАК РесурсВыработанныйЗаПрошлыйПериод,
	|		СписокНМА.РесурсВыработанныйЗаТекущийПериод КАК РесурсВыработанныйЗаТекущийПериод,
	|		СписокНМА.СтоимостьДляВычисленияАмортизации КАК СтоимостьДляВычисленияАмортизации,
	|		СписокНМА.ВариантПроводокПоОбесценениюВНА КАК ВариантПроводокПоОбесценениюВНА,
	|		СписокНМА.ОстаточнаяСтоимостьРегл КАК ОстаточнаяСтоимостьРегл,
	|		СписокНМА.ОстаточнаяСтоимостьЦФ КАК ОстаточнаяСтоимостьЦФ,
	|		СписокНМА.ОстаточнаяСтоимостьПР КАК ОстаточнаяСтоимостьПР,
	|		СписокНМА.ОстаточнаяСтоимостьПРЦФ КАК ОстаточнаяСтоимостьПРЦФ, 
	|		СписокНМА.РесурсНазначенный КАК РесурсНазначенный,
	|		СписокНМА.МетодНачисленияАмортизацииБУ КАК МетодНачисленияАмортизацииБУ,
	|		СписокНМА.ЛиквидационнаяСтоимость КАК ЛиквидационнаяСтоимость,
	|		СписокНМА.КоэффициентБУ КАК КоэффициентБУ,
	|		СписокНМА.ОтработанныхМесяцевПолныхЛет КАК ОтработанныхМесяцевПолныхЛет,
	|		СписокНМА.НачислятьАмортизациюБУ КАК НачислятьАмортизациюБУ,
	|		СписокНМА.КоэффициентЦФБУ КАК КоэффициентЦФБУ,
	|		СписокНМА.КоэффициентЦФНУ КАК КоэффициентЦФНУ,
	|		СписокНМА.КоэффициентЦФПР КАК КоэффициентЦФПР,
	|		СписокНМА.ПервоначальнаяСтоимостьБУ КАК ПервоначальнаяСтоимостьБУ,
	|		СписокНМА.СтоимостьРегл КАК СтоимостьРегл,
	|		СписокНМА.СтоимостьЦФ КАК СтоимостьЦФ,
	|		СписокНМА.СтоимостьПР КАК СтоимостьПР,
	|		СписокНМА.СтоимостьПРЦФ КАК СтоимостьПРЦФ,
	|
	|		&СуммаАмортизацииБУ КАК СуммаБУ
	|
	|	ИЗ
	|		СписокНМАСПараметрами_БУ КАК СписокНМА
	|
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПроверкаПараметровРасчета_БУ КАК ПроверкаПараметровРасчета
	|			ПО ПроверкаПараметровРасчета.ОбъектУчета = СписокНМА.НематериальныйАктив
	|				И ПроверкаПараметровРасчета.Организация = СписокНМА.Организация
	|	ГДЕ
	|		СписокНМА.ЭтоДоначисление
	|		И ПроверкаПараметровРасчета.ОбъектУчета ЕСТЬ NULL
	|
	|	) КАК СписокНМА
	|";
	
	ПараметрыТекстаЗапроса = ПараметрыТекстаЗапросаСуммаАмортизацииБУ();
	ПараметрыТекстаЗапроса.ТекстСтоимостьДляВычисленияАмортизации = "СписокНМА.СтоимостьДляВычисленияАмортизации";
	ПараметрыТекстаЗапроса.ТекстОстаточнаяСтоимость = "СписокНМА.ОстаточнаяСтоимостьРегл";
	ПараметрыТекстаЗапроса.ТекстЛиквидационнаяСтоимость = "0";
	ПараметрыТекстаЗапроса.ТекстОбесценение = "0";
	ПараметрыТекстаЗапроса.ТекстСуммаДоначисления = "0";
	ТекстСуммаАмортизацииБУ = ТекстЗапросаСуммаАмортизацииБУ(ПараметрыТекстаЗапроса);
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&СуммаАмортизацииБУ", ТекстСуммаАмортизацииБУ);
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
КонецПроцедуры

Процедура ТекстЗапросаДоначислениеАмортизацииВыборкаИзмененийБУ(СписокЗапросов, ПараметрыРасчета)
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	1 КАК Приоритет,
	|	&НачалоМесяца КАК Период,
	|	НЕОПРЕДЕЛЕНО КАК Регистратор,
	|	СписокНМА.Организация КАК Организация,
	|	СписокНМА.Подразделение КАК Подразделение,
	|	СписокНМА.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	СписокНМА.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	СписокНМА.НематериальныйАктив КАК НематериальныйАктив,
	|	СписокНМА.ВидОбъектаУчета КАК ВидОбъектаУчета,
	|	СписокНМА.СтатьяРасходов КАК СтатьяРасходов,
	|	СписокНМА.АналитикаРасходов КАК АналитикаРасходов,
	|	СписокНМА.СпособОтраженияРасходов КАК СпособОтраженияРасходов,
	|	СписокНМА.СуммаБУ КАК СуммаБУ,
	|	СписокНМА.СуммаПР КАК СуммаПР,
	|	0 КАК СуммаУУ,
	|	0 КАК ОбесценениеУУ,
	|	0 КАК ОбесценениеБУ,
	|	1 КАК Коэффициент,
	|	СписокНМА.ПередаватьРасходыВДругуюОрганизацию КАК ПередаватьРасходыВДругуюОрганизацию,
	|	СписокНМА.ОрганизацияПолучательРасходов КАК ОрганизацияПолучательРасходов,
	|	СписокНМА.РесурсВыработанныйЗаПрошлыйПериод КАК РесурсВыработанныйЗаПрошлыйПериод,
	|	СписокНМА.РесурсВыработанныйЗаТекущийПериод КАК РесурсВыработанныйЗаТекущийПериод,
	|	СписокНМА.РесурсНазначенный КАК РесурсНазначенный,
	|	СписокНМА.МетодНачисленияАмортизацииБУ КАК МетодНачисленияАмортизации,
	|
	|	0 КАК ЛиквидационнаяСтоимость,
	|	СписокНМА.ЛиквидационнаяСтоимость КАК ЛиквидационнаяСтоимостьРегл,
	|
	|	СписокНМА.ОстаточнаяСтоимостьРегл КАК ОстаточнаяСтоимостьРегл,
	|	СписокНМА.ОстаточнаяСтоимостьЦФ КАК ОстаточнаяСтоимостьЦФ,
	|	СписокНМА.ОстаточнаяСтоимостьПР КАК ОстаточнаяСтоимостьПР,
	|	СписокНМА.ОстаточнаяСтоимостьПРЦФ КАК ОстаточнаяСтоимостьПРЦФ, 
	|	0 КАК ОстатокОбесцененияРегл,
	|	0 КАК ОстатокОбесцененияУпр,
	|
	|	СписокНМА.КоэффициентБУ КАК КоэффициентУскорения,
	|	СписокНМА.ОтработанныхМесяцевПолныхЛет КАК ОтработанныхМесяцевПолныхЛет,
	|	СписокНМА.НачислятьАмортизациюБУ КАК НачислятьАмортизацию,
	|
	|	0 КАК ПервоначальнаяСтоимостьБУ,
	|	0 КАК Стоимость,
	|	0 КАК СтоимостьРегл,
	|	0 КАК СтоимостьЦФ,
	|	0 КАК СтоимостьПР,
	|	0 КАК СтоимостьПРЦФ,
	|
	|	0 КАК СтоимостьИзменение,
	|	0 КАК СтоимостьРеглИзменение,
	|	0 КАК СтоимостьПРИзменение,
	|
	|	0 КАК АмортизацияИзменение,
	|	0 КАК АмортизацияРеглИзменение,
	|	0 КАК АмортизацияПРИзменение,
	|
	|	0 КАК Амортизация,
	|	0 КАК АмортизацияРегл,
	|	0 КАК АмортизацияПР,
	|
	|	0 КАК СтоимостьДляВычисленияАмортизации,
	|	0 КАК СтоимостьДляВычисленияАмортизацииРегл,
	|
	|	СписокНМА.КоэффициентЦФБУ КАК КоэффициентЦФБУ,
	|	СписокНМА.КоэффициентЦФНУ КАК КоэффициентЦФНУ,
	|	СписокНМА.КоэффициентЦФПР КАК КоэффициентЦФПР,
	|
	|	ЛОЖЬ КАК КорректировкаСтоимостиУУ,
	|	ЛОЖЬ КАК КорректировкаСтоимостиБУ,
	|	ЛОЖЬ КАК КорректировкаАмортизацииУУ,
	|	ЛОЖЬ КАК КорректировкаАмортизацииБУ,
	|
	|	СписокНМА.ВариантПроводокПоОбесценениюВНА КАК ВариантПроводокПоОбесценениюВНА,
	|	ЛОЖЬ КАК ЭтоИзменения
	|
	|ИЗ
	|	ДоначислениеАмортизацииБезИзмененийБУ КАК СписокНМА
	|
	|ГДЕ
	|	СписокНМА.НематериальныйАктив В
	|		(ВЫБРАТЬ
	|			СписокНМА.НематериальныйАктив
	|		ИЗ
	|			СписокНМАСИзмененнымиПараметрами_БУ КАК СписокНМА)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	1 КАК Приоритет,
	|	СписокНМА.Период КАК Период,
	|	СписокНМА.Регистратор КАК Регистратор,
	|	СписокНМА.Организация КАК Организация,
	|	СписокНМА.Подразделение КАК Подразделение,
	|	СписокНМА.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	СписокНМА.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	СписокНМА.НематериальныйАктив КАК НематериальныйАктив,
	|	СписокНМА.ВидОбъектаУчета КАК ВидОбъектаУчета,
	|	СписокНМА.СтатьяРасходов КАК СтатьяРасходов,
	|	СписокНМА.АналитикаРасходов КАК АналитикаРасходов,
	|	СписокНМА.СпособОтраженияРасходов КАК СпособОтраженияРасходов,
	|	0 КАК СуммаБУ,
	|	0 КАК СуммаПР,
	|	0 КАК СуммаУУ,
	|	0 КАК ОбесценениеУУ,
	|	0 КАК ОбесценениеБУ,
	|	1 КАК Коэффициент,
	|	СписокНМА.ПередаватьРасходыВДругуюОрганизацию КАК ПередаватьРасходыВДругуюОрганизацию,
	|	СписокНМА.ОрганизацияПолучательРасходов КАК ОрганизацияПолучательРасходов,
	|	СписокНМА.РесурсВыработанныйЗаПрошлыйПериод КАК РесурсВыработанныйЗаПрошлыйПериод,
	|	СписокНМА.РесурсВыработанныйЗаТекущийПериод КАК РесурсВыработанныйЗаТекущийПериод,
	|	СписокНМА.РесурсНазначенный КАК РесурсНазначенный,
	|	СписокНМА.МетодНачисленияАмортизацииБУ КАК МетодНачисленияАмортизации,
	|
	|	0 КАК ЛиквидационнаяСтоимость,
	|	СписокНМА.ЛиквидационнаяСтоимость КАК ЛиквидационнаяСтоимостьРегл,
	|
	|	СписокНМА.ОстаточнаяСтоимостьРегл КАК ОстаточнаяСтоимостьРегл,
	|	СписокНМА.ОстаточнаяСтоимостьЦФ КАК ОстаточнаяСтоимостьЦФ,
	|	СписокНМА.ОстаточнаяСтоимостьПР КАК ОстаточнаяСтоимостьПР,
	|	СписокНМА.ОстаточнаяСтоимостьПРЦФ КАК ОстаточнаяСтоимостьПРЦФ, 
	|	0 КАК ОстатокОбесцененияРегл,
	|	0 КАК ОстатокОбесцененияУпр,
	|
	|	СписокНМА.КоэффициентБУ КАК КоэффициентУскорения,
	|	СписокНМА.ОтработанныхМесяцевПолныхЛет КАК ОтработанныхМесяцевПолныхЛет,
	|	СписокНМА.НачислятьАмортизациюБУ КАК НачислятьАмортизацию,
	|
	|	СписокНМА.ПервоначальнаяСтоимостьБУ КАК ПервоначальнаяСтоимостьБУ,
	|
	|	0 КАК Стоимость,
	|	СписокНМА.СтоимостьРегл КАК СтоимостьРегл,
	|	СписокНМА.СтоимостьЦФ КАК СтоимостьЦФ,
	|	СписокНМА.СтоимостьПР КАК СтоимостьПР,
	|	СписокНМА.СтоимостьПРЦФ КАК СтоимостьПРЦФ,
	|
	|	0 КАК СтоимостьИзменение,
	|	СписокНМА.СтоимостьРеглИзменение КАК СтоимостьРеглИзменение,
	|	СписокНМА.СтоимостьПРИзменение КАК СтоимостьПРИзменение,
	|
	|	0 КАК АмортизацияИзменение,
	|	СписокНМА.АмортизацияРеглИзменение КАК АмортизацияРеглИзменение,
	|	СписокНМА.АмортизацияПРИзменение КАК АмортизацияПРИзменение,
	|
	|	0 КАК Амортизация,
	|	СписокНМА.АмортизацияРегл КАК АмортизацияРегл,
	|	СписокНМА.АмортизацияПР КАК АмортизацияПР,
	|
	|	0 КАК СтоимостьДляВычисленияАмортизации,
	|	0 КАК СтоимостьДляВычисленияАмортизацииРегл,
	|
	|	СписокНМА.КоэффициентЦФБУ КАК КоэффициентЦФБУ,
	|	СписокНМА.КоэффициентЦФНУ КАК КоэффициентЦФНУ,
	|	СписокНМА.КоэффициентЦФПР КАК КоэффициентЦФПР,
	|
	|	ЕСТЬNULL(Корректировка.КорректировкаСтоимости, ЛОЖЬ)
	|		И ЕСТЬNULL(Корректировка.ОтражатьВУпрУчете, ЛОЖЬ) КАК КорректировкаСтоимостиУУ,
	|
	|	ЕСТЬNULL(Корректировка.КорректировкаСтоимости, ЛОЖЬ)
	|		И ЕСТЬNULL(Корректировка.ОтражатьВРеглУчете, ЛОЖЬ) КАК КорректировкаСтоимостиБУ,
	|
	|	ЕСТЬNULL(Корректировка.КорректировкаАмортизации, ЛОЖЬ)
	|		И ЕСТЬNULL(Корректировка.ОтражатьВУпрУчете, ЛОЖЬ) КАК КорректировкаАмортизацииУУ,
	|
	|	ЕСТЬNULL(Корректировка.КорректировкаАмортизации, ЛОЖЬ)
	|		И ЕСТЬNULL(Корректировка.ОтражатьВРеглУчете, ЛОЖЬ) КАК КорректировкаАмортизацииБУ,
	|
	|	СписокНМА.ВариантПроводокПоОбесценениюВНА КАК ВариантПроводокПоОбесценениюВНА,
	|	ИСТИНА КАК ЭтоИзменения
	|
	|ИЗ
	|	СписокНМАСИзмененнымиПараметрами_БУ КАК СписокНМА
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.КорректировкаСтоимостиИАмортизацииНМА КАК Корректировка
	|		ПО Корректировка.Ссылка = СписокНМА.Регистратор
	|
	|ГДЕ
	|	СписокНМА.ЭтоДоначисление";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
КонецПроцедуры

Процедура ТекстЗапросаДоначислениеАмортизацииБУ(СписокЗапросов, ПараметрыРасчета)
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	СписокНМА.Период КАК Период,
	|	СписокНМА.Организация КАК Организация,
	|	СписокНМА.Подразделение КАК Подразделение,
	|	СписокНМА.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	СписокНМА.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	СписокНМА.НематериальныйАктив КАК НематериальныйАктив,
	|	СписокНМА.ВидОбъектаУчета КАК ВидОбъектаУчета,
	|	СписокНМА.СтатьяРасходов КАК СтатьяРасходов,
	|	СписокНМА.АналитикаРасходов КАК АналитикаРасходов,
	|	СписокНМА.СпособОтраженияРасходов КАК СпособОтраженияРасходов,
	|	СписокНМА.СуммаБУ КАК СуммаБУ,
	|	СписокНМА.СуммаПР КАК СуммаПР,
	|	СписокНМА.ПередаватьРасходыВДругуюОрганизацию КАК ПередаватьРасходыВДругуюОрганизацию,
	|	СписокНМА.ОрганизацияПолучательРасходов КАК ОрганизацияПолучательРасходов,
	|	СписокНМА.РесурсВыработанныйЗаПрошлыйПериод КАК РесурсВыработанныйЗаПрошлыйПериод,
	|	СписокНМА.РесурсВыработанныйЗаТекущийПериод КАК РесурсВыработанныйЗаТекущийПериод,
	|	СписокНМА.РесурсНазначенный КАК РесурсНазначенный,
	|	СписокНМА.СтоимостьДляВычисленияАмортизацииРегл КАК СтоимостьДляВычисленияАмортизации,
	|	СписокНМА.ОстаточнаяСтоимостьРегл КАК ОстаточнаяСтоимостьРегл,
	|	СписокНМА.ОстаточнаяСтоимостьЦФ КАК ОстаточнаяСтоимостьЦФ,
	|	СписокНМА.ОстаточнаяСтоимостьПР КАК ОстаточнаяСтоимостьПР,
	|	СписокНМА.ОстаточнаяСтоимостьПРЦФ КАК ОстаточнаяСтоимостьПРЦФ, 
	|	СписокНМА.КоэффициентЦФБУ КАК КоэффициентЦФБУ,
	|	СписокНМА.КоэффициентЦФНУ КАК КоэффициентЦФНУ,
	|	СписокНМА.КоэффициентЦФПР КАК КоэффициентЦФПР,
	|	СписокНМА.ПервоначальнаяСтоимостьБУ КАК ПервоначальнаяСтоимостьБУ,
	|	СписокНМА.СтоимостьРегл КАК СтоимостьРегл,
	|	СписокНМА.СтоимостьЦФ КАК СтоимостьЦФ,
	|	СписокНМА.СтоимостьПР КАК СтоимостьПР,
	|	СписокНМА.СтоимостьПРЦФ КАК СтоимостьПРЦФ
	|
	|ПОМЕСТИТЬ ДоначислениеАмортизацииСУчетомИзмененийБУ
	|
	|ИЗ
	|	&АмортизацияИзменений_БУ КАК СписокНМА
	|ГДЕ
	|	СписокНМА.ЭтоИзменения
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СписокНМА.Период КАК ПериодРасчета,
	|	СписокНМА.Организация КАК Организация,
	|	СписокНМА.Подразделение КАК Подразделение,
	|	СписокНМА.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	СписокНМА.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	СписокНМА.НематериальныйАктив КАК НематериальныйАктив,
	|	СписокНМА.ВидОбъектаУчета КАК ВидОбъектаУчета,
	|	СписокНМА.СтатьяРасходов КАК СтатьяРасходов,
	|	СписокНМА.АналитикаРасходов КАК АналитикаРасходов,
	|	СписокНМА.СпособОтраженияРасходов КАК СпособОтраженияРасходов,
	|	СписокНМА.СуммаБУ КАК СуммаБУ,
	|	СписокНМА.СуммаПР КАК СуммаПР,
	|	СписокНМА.ПередаватьРасходыВДругуюОрганизацию КАК ПередаватьРасходыВДругуюОрганизацию,
	|	СписокНМА.ОрганизацияПолучательРасходов КАК ОрганизацияПолучательРасходов,
	|	СписокНМА.РесурсВыработанныйЗаПрошлыйПериод КАК РесурсВыработанныйЗаПрошлыйПериод,
	|	СписокНМА.РесурсВыработанныйЗаТекущийПериод КАК РесурсВыработанныйЗаТекущийПериод,
	|	СписокНМА.СтоимостьДляВычисленияАмортизации КАК СтоимостьДляВычисленияАмортизации,
	|	СписокНМА.ОстаточнаяСтоимостьРегл КАК ОстаточнаяСтоимостьРегл,
	|	СписокНМА.ОстаточнаяСтоимостьЦФ КАК ОстаточнаяСтоимостьЦФ,
	|	СписокНМА.ОстаточнаяСтоимостьПР КАК ОстаточнаяСтоимостьПР,
	|	СписокНМА.ОстаточнаяСтоимостьПРЦФ КАК ОстаточнаяСтоимостьПРЦФ, 
	|	СписокНМА.КоэффициентЦФБУ КАК КоэффициентЦФБУ,
	|	СписокНМА.КоэффициентЦФНУ КАК КоэффициентЦФНУ,
	|	СписокНМА.КоэффициентЦФПР КАК КоэффициентЦФПР,
	|	СписокНМА.ПервоначальнаяСтоимостьБУ КАК ПервоначальнаяСтоимостьБУ,
	|	СписокНМА.СтоимостьРегл КАК СтоимостьРегл,
	|	СписокНМА.СтоимостьЦФ КАК СтоимостьЦФ,
	|	СписокНМА.СтоимостьПР КАК СтоимостьПР,
	|	СписокНМА.СтоимостьПРЦФ КАК СтоимостьПРЦФ
	|
	|ПОМЕСТИТЬ ДоначислениеАмортизацииБУ
	|
	|ИЗ
	|	ДоначислениеАмортизацииБезИзмененийБУ КАК СписокНМА
	|	
	|ОБЪЕДИНИТЬ ВСЕ
	|	
	|ВЫБРАТЬ
	|	СписокНМА.Период,
	|	СписокНМА.Организация,
	|	СписокНМА.Подразделение,
	|	СписокНМА.ГруппаФинансовогоУчета,
	|	СписокНМА.НаправлениеДеятельности,
	|	СписокНМА.НематериальныйАктив,
	|	СписокНМА.ВидОбъектаУчета КАК ВидОбъектаУчета,
	|	СписокНМА.СтатьяРасходов,
	|	СписокНМА.АналитикаРасходов,
	|	СписокНМА.СпособОтраженияРасходов,
	|	СписокНМА.СуммаБУ,
	|	СписокНМА.СуммаПР,
	|	СписокНМА.ПередаватьРасходыВДругуюОрганизацию,
	|	СписокНМА.ОрганизацияПолучательРасходов,
	|	СписокНМА.РесурсВыработанныйЗаПрошлыйПериод,
	|	СписокНМА.РесурсВыработанныйЗаТекущийПериод,
	|	СписокНМА.СтоимостьДляВычисленияАмортизации,
	|	СписокНМА.ОстаточнаяСтоимостьРегл КАК ОстаточнаяСтоимостьРегл,
	|	СписокНМА.ОстаточнаяСтоимостьЦФ КАК ОстаточнаяСтоимостьЦФ,
	|	СписокНМА.ОстаточнаяСтоимостьПР КАК ОстаточнаяСтоимостьПР,
	|	СписокНМА.ОстаточнаяСтоимостьПРЦФ КАК ОстаточнаяСтоимостьПРЦФ, 
	|	СписокНМА.КоэффициентЦФБУ КАК КоэффициентЦФБУ,
	|	СписокНМА.КоэффициентЦФНУ КАК КоэффициентЦФНУ,
	|	СписокНМА.КоэффициентЦФПР КАК КоэффициентЦФПР,
	|	СписокНМА.ПервоначальнаяСтоимостьБУ КАК ПервоначальнаяСтоимостьБУ,
	|	СписокНМА.СтоимостьРегл КАК СтоимостьРегл,
	|	СписокНМА.СтоимостьЦФ КАК СтоимостьЦФ,
	|	СписокНМА.СтоимостьПР КАК СтоимостьПР,
	|	СписокНМА.СтоимостьПРЦФ КАК СтоимостьПРЦФ
	|ИЗ
	|	ДоначислениеАмортизацииСУчетомИзмененийБУ КАК СписокНМА
	|";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
КонецПроцедуры

Процедура ТекстЗапросаДоначислениеАмортизацииБУ_Сгруппированная(СписокЗапросов, ПараметрыРасчета)
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	СписокНМА.НематериальныйАктив КАК НематериальныйАктив,
	|	СУММА(СписокНМА.СуммаБУ) КАК СуммаБУ,
	|	СУММА(СписокНМА.СуммаПР) КАК СуммаПР
	|ПОМЕСТИТЬ ДоначислениеАмортизацииБУ_Сгруппированная
	|ИЗ
	|	ДоначислениеАмортизацииБУ КАК СписокНМА
	|
	|СГРУППИРОВАТЬ ПО
	|	СписокНМА.НематериальныйАктив
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	НематериальныйАктив";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
КонецПроцедуры

Процедура ТекстЗапросаРасчетАмортизацииБезИзмененийБУ(СписокЗапросов, ПараметрыРасчета)
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	СписокНМА.ВидОбъектаУчета КАК ВидОбъектаУчета,
	|	СписокНМА.ПериодРасчета КАК ПериодРасчета,
	|	СписокНМА.Организация КАК Организация,
	|	СписокНМА.Подразделение КАК Подразделение,
	|	СписокНМА.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	СписокНМА.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	СписокНМА.НематериальныйАктив КАК НематериальныйАктив,
	|	СписокНМА.СтатьяРасходов КАК СтатьяРасходов,
	|	СписокНМА.АналитикаРасходов КАК АналитикаРасходов,
	|	СписокНМА.СпособОтраженияРасходов КАК СпособОтраженияРасходов,
	|	СписокНМА.ПередаватьРасходыВДругуюОрганизацию КАК ПередаватьРасходыВДругуюОрганизацию,
	|	СписокНМА.ОрганизацияПолучательРасходов КАК ОрганизацияПолучательРасходов,
	|	СписокНМА.РесурсВыработанныйЗаПрошлыйПериод КАК РесурсВыработанныйЗаПрошлыйПериод,
	|	СписокНМА.РесурсВыработанныйЗаТекущийПериод КАК РесурсВыработанныйЗаТекущийПериод,
	|	СписокНМА.РесурсНазначенный КАК РесурсНазначенный,
	|	СписокНМА.СтоимостьДляВычисленияАмортизации КАК СтоимостьДляВычисленияАмортизации,
	|	СписокНМА.МетодНачисленияАмортизацииБУ КАК МетодНачисленияАмортизацииБУ,
	|	СписокНМА.СтоимостьРегл КАК СтоимостьРегл,
	|	СписокНМА.СтоимостьПР КАК СтоимостьПР,
	|	СписокНМА.СтоимостьЦФ КАК СтоимостьЦФ,
	|	СписокНМА.СтоимостьПРЦФ КАК СтоимостьПРЦФ,
	|	СписокНМА.АмортизацияРегл КАК АмортизацияРегл,
	|	СписокНМА.АмортизацияПР КАК АмортизацияПР,
	|	СписокНМА.АмортизацияПРЦФ КАК АмортизацияПРЦФ,
	|	СписокНМА.АмортизацияЦФ КАК АмортизацияЦФ,
	|	СписокНМА.ОстаточнаяСтоимостьРегл КАК ОстаточнаяСтоимостьРегл,
	|	СписокНМА.ОстаточнаяСтоимостьЦФ КАК ОстаточнаяСтоимостьЦФ,
	|	СписокНМА.ОстаточнаяСтоимостьПР КАК ОстаточнаяСтоимостьПР,
	|	СписокНМА.ОстаточнаяСтоимостьПРЦФ КАК ОстаточнаяСтоимостьПРЦФ, 
	|	СписокНМА.ОстатокОбесцененияРегл КАК ОстатокОбесцененияРегл,
	|	СписокНМА.ПервоначальнаяСтоимостьБУ КАК ПервоначальнаяСтоимостьБУ,
	|	СписокНМА.НачислятьАмортизациюБУ КАК НачислятьАмортизациюБУ,
	|	СписокНМА.ПорядокНачисленияАмортизацииБУ КАК ПорядокНачисленияАмортизацииБУ,
	|	СписокНМА.КоэффициентЦФБУ КАК КоэффициентЦФБУ,
	|	СписокНМА.КоэффициентЦФНУ КАК КоэффициентЦФНУ,
	|	СписокНМА.КоэффициентЦФПР КАК КоэффициентЦФПР,
	|	СписокНМА.ВариантПроводокПоОбесценениюВНА КАК ВариантПроводокПоОбесценениюВНА,
	|	СписокНМА.АмортизацияНачисляетсяПоСтандартамМУ КАК АмортизацияНачисляетсяПоСтандартамМУ,
	|
	|	СписокНМА.ОбесценениеБУ КАК ОбесценениеБУ,
	|
	|	СписокНМА.СуммаБУ КАК СуммаБУ,
	|
	|	ВЫБОР
	|		КОГДА СписокНМА.ОстаточнаяСтоимостьПР = 0
	|				ИЛИ СписокНМА.ОстаточнаяСтоимостьРегл = 0
	|				ИЛИ СписокНМА.СуммаБУ = 0
	| 
	|			ТОГДА 0
	|
	|		КОГДА СписокНМА.СуммаБУ = СписокНМА.ОстаточнаяСтоимостьРегл
	| 
	|			ТОГДА СписокНМА.ОстаточнаяСтоимостьПР
	|
	|		КОГДА СписокНМА.ВариантПроводокПоОбесценениюВНА = &ДоначислятьКорректировкуОбесценения
	|
	|			ТОГДА ВЫРАЗИТЬ(СписокНМА.ОстаточнаяСтоимостьПР
	|				* (ВЫРАЗИТЬ(СписокНМА.СуммаБУ + СписокНМА.ОбесценениеБУ КАК ЧИСЛО (25, 12)) / ВЫРАЗИТЬ(СписокНМА.ОстаточнаяСтоимостьРегл КАК ЧИСЛО (25, 12))) КАК ЧИСЛО (31, 2))
	|
	|		ИНАЧЕ ВЫРАЗИТЬ(СписокНМА.ОстаточнаяСтоимостьПР
	|				* (ВЫРАЗИТЬ(СписокНМА.СуммаБУ КАК ЧИСЛО (25, 12)) / ВЫРАЗИТЬ(СписокНМА.ОстаточнаяСтоимостьРегл КАК ЧИСЛО (25, 12))) КАК ЧИСЛО (31, 2))
	|
	|	КОНЕЦ КАК СуммаПР
	|
	|ПОМЕСТИТЬ РасчетАмортизацииБезИзмененийБУ
	|
	|ИЗ
	|	(ВЫБРАТЬ
	|		СписокНМА.ВидОбъектаУчета КАК ВидОбъектаУчета,
	|		СписокНМА.ПериодРасчета КАК ПериодРасчета,
	|		СписокНМА.Организация КАК Организация,
	|		СписокНМА.Подразделение КАК Подразделение,
	|		СписокНМА.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|		СписокНМА.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|		СписокНМА.НематериальныйАктив КАК НематериальныйАктив,
	|		СписокНМА.СтатьяРасходов КАК СтатьяРасходов,
	|		СписокНМА.АналитикаРасходов КАК АналитикаРасходов,
	|		СписокНМА.СпособОтраженияРасходов КАК СпособОтраженияРасходов,
	|		СписокНМА.ПередаватьРасходыВДругуюОрганизацию КАК ПередаватьРасходыВДругуюОрганизацию,
	|		СписокНМА.ОрганизацияПолучательРасходов КАК ОрганизацияПолучательРасходов,
	|		СписокНМА.РесурсВыработанныйЗаПрошлыйПериод КАК РесурсВыработанныйЗаПрошлыйПериод,
	|		СписокНМА.РесурсВыработанныйЗаТекущийПериод КАК РесурсВыработанныйЗаТекущийПериод,
	|		СписокНМА.РесурсНазначенный КАК РесурсНазначенный,
	|		СписокНМА.СтоимостьДляВычисленияАмортизации КАК СтоимостьДляВычисленияАмортизации,
	|		СписокНМА.МетодНачисленияАмортизацииБУ КАК МетодНачисленияАмортизацииБУ,
	|		СписокНМА.СтоимостьРегл КАК СтоимостьРегл,
	|		СписокНМА.СтоимостьПР КАК СтоимостьПР,
	|		СписокНМА.СтоимостьЦФ КАК СтоимостьЦФ,
	|		СписокНМА.СтоимостьПРЦФ КАК СтоимостьПРЦФ,
	|		СписокНМА.АмортизацияРегл КАК АмортизацияРегл,
	|		СписокНМА.АмортизацияПР КАК АмортизацияПР,
	|		СписокНМА.АмортизацияПРЦФ КАК АмортизацияПРЦФ,
	|		СписокНМА.АмортизацияЦФ КАК АмортизацияЦФ,
	|		СписокНМА.ОстаточнаяСтоимостьРегл КАК ОстаточнаяСтоимостьРегл,
	|		СписокНМА.ОстаточнаяСтоимостьЦФ КАК ОстаточнаяСтоимостьЦФ,
	|		СписокНМА.ОстаточнаяСтоимостьПР КАК ОстаточнаяСтоимостьПР,
	|		СписокНМА.ОстаточнаяСтоимостьПРЦФ КАК ОстаточнаяСтоимостьПРЦФ, 
	|		СписокНМА.ОстатокОбесцененияРегл КАК ОстатокОбесцененияРегл,
	|		СписокНМА.ПервоначальнаяСтоимостьБУ КАК ПервоначальнаяСтоимостьБУ,
	|		СписокНМА.НачислятьАмортизациюБУ КАК НачислятьАмортизациюБУ,
	|		СписокНМА.ПорядокНачисленияАмортизацииБУ КАК ПорядокНачисленияАмортизацииБУ,
	|		СписокНМА.КоэффициентЦФБУ КАК КоэффициентЦФБУ,
	|		СписокНМА.КоэффициентЦФНУ КАК КоэффициентЦФНУ,
	|		СписокНМА.КоэффициентЦФПР КАК КоэффициентЦФПР,
	|		СписокНМА.ВариантПроводокПоОбесценениюВНА КАК ВариантПроводокПоОбесценениюВНА,
	|		СписокНМА.АмортизацияНачисляетсяПоСтандартамМУ КАК АмортизацияНачисляетсяПоСтандартамМУ,
	|
	|		ВЫБОР 
	|			КОГДА (СписокНМА.ОстатокОбесцененияРегл - СписокНМА.ОбесценениеБУ) < &МинимальнаяОстаточнаяСтоимостьРегл
	|					И СписокНМА.ОбесценениеБУ > 0
	|				ТОГДА СписокНМА.ОстатокОбесцененияРегл
	|			ИНАЧЕ СписокНМА.ОбесценениеБУ
	|		КОНЕЦ КАК ОбесценениеБУ,
	|
	|		ВЫБОР 
	|			КОГДА (СписокНМА.ОстаточнаяСтоимостьРегл - СписокНМА.СуммаБУ) < &МинимальнаяОстаточнаяСтоимостьРегл
	|						И СписокНМА.СуммаБУ > 0
	|						И СписокНМА.ВариантПроводокПоОбесценениюВНА <> &ДоначислятьКорректировкуОбесценения
	|					ИЛИ (СписокНМА.ОстаточнаяСтоимостьРегл - СписокНМА.СуммаБУ - СписокНМА.ОбесценениеБУ) < &МинимальнаяОстаточнаяСтоимостьРегл
	|						И СписокНМА.СуммаБУ > 0
	|						И СписокНМА.ВариантПроводокПоОбесценениюВНА = &ДоначислятьКорректировкуОбесценения
	|				ТОГДА СписокНМА.ОстаточнаяСтоимостьРегл
	|			ИНАЧЕ СписокНМА.СуммаБУ
	|		КОНЕЦ КАК СуммаБУ
	|
	|	ИЗ
	|		(ВЫБРАТЬ
	|			СписокНМА.ВидОбъектаУчета КАК ВидОбъектаУчета,
	|			СписокНМА.Период КАК ПериодРасчета,
	|			СписокНМА.Организация КАК Организация,
	|			СписокНМА.Подразделение КАК Подразделение,
	|			СписокНМА.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|			СписокНМА.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|			СписокНМА.НематериальныйАктив КАК НематериальныйАктив,
	|			СписокНМА.СтатьяРасходов КАК СтатьяРасходов,
	|			СписокНМА.АналитикаРасходов КАК АналитикаРасходов,
	|			СписокНМА.СпособОтраженияРасходов КАК СпособОтраженияРасходов,
	|			СписокНМА.ПередаватьРасходыВДругуюОрганизацию КАК ПередаватьРасходыВДругуюОрганизацию,
	|			СписокНМА.ОрганизацияПолучательРасходов КАК ОрганизацияПолучательРасходов,
	|			СписокНМА.РесурсВыработанныйЗаПрошлыйПериод КАК РесурсВыработанныйЗаПрошлыйПериод,
	|			СписокНМА.РесурсВыработанныйЗаТекущийПериод КАК РесурсВыработанныйЗаТекущийПериод,
	|			СписокНМА.РесурсНазначенный КАК РесурсНазначенный,
	|
	|			ВЫБОР
	|				КОГДА СписокНМА.АмортизацияНачисляетсяПоСтандартамМУ
	|					ТОГДА СписокНМА.ОстаточнаяСтоимостьРегл - ЕСТЬNULL(Доначисление.СуммаБУ, 0)
	|				ИНАЧЕ СписокНМА.СтоимостьДляВычисленияАмортизации
	|			КОНЕЦ КАК СтоимостьДляВычисленияАмортизации,
	|
	|			СписокНМА.МетодНачисленияАмортизацииБУ КАК МетодНачисленияАмортизацииБУ,
	|			СписокНМА.СтоимостьРегл КАК СтоимостьРегл,
	|			СписокНМА.СтоимостьПР КАК СтоимостьПР,
	|			СписокНМА.СтоимостьЦФ КАК СтоимостьЦФ,
	|			СписокНМА.СтоимостьПРЦФ КАК СтоимостьПРЦФ,
	|			СписокНМА.АмортизацияРегл КАК АмортизацияРегл,
	|			СписокНМА.АмортизацияПР КАК АмортизацияПР,
	|			СписокНМА.АмортизацияПРЦФ КАК АмортизацияПРЦФ,
	|			СписокНМА.АмортизацияЦФ КАК АмортизацияЦФ,
	|			СписокНМА.ОстаточнаяСтоимостьРегл КАК ОстаточнаяСтоимостьРегл,
	|			СписокНМА.ОстаточнаяСтоимостьЦФ КАК ОстаточнаяСтоимостьЦФ,
	|			СписокНМА.ОстаточнаяСтоимостьПР КАК ОстаточнаяСтоимостьПР,
	|			СписокНМА.ОстаточнаяСтоимостьПРЦФ КАК ОстаточнаяСтоимостьПРЦФ, 
	|			СписокНМА.ОстатокОбесцененияРегл КАК ОстатокОбесцененияРегл,
	|			СписокНМА.ПервоначальнаяСтоимостьБУ КАК ПервоначальнаяСтоимостьБУ,
	|			СписокНМА.НачислятьАмортизациюБУ КАК НачислятьАмортизациюБУ,
	|			СписокНМА.ПорядокНачисленияАмортизацииБУ КАК ПорядокНачисленияАмортизацииБУ,
	|			СписокНМА.КоэффициентЦФБУ КАК КоэффициентЦФБУ,
	|			СписокНМА.КоэффициентЦФНУ КАК КоэффициентЦФНУ,
	|			СписокНМА.КоэффициентЦФПР КАК КоэффициентЦФПР,
	|			СписокНМА.ВариантПроводокПоОбесценениюВНА КАК ВариантПроводокПоОбесценениюВНА,
	|			СписокНМА.АмортизацияНачисляетсяПоСтандартамМУ КАК АмортизацияНачисляетсяПоСтандартамМУ,
	|
	|			ВЫБОР
	|				КОГДА &ОбесценениеБУ > СписокНМА.ОстатокОбесцененияРегл
	|					ТОГДА СписокНМА.ОстатокОбесцененияРегл
	|				ИНАЧЕ &ОбесценениеБУ
	|			КОНЕЦ КАК ОбесценениеБУ,
	|
	|			ВЫБОР 
	|				КОГДА (СписокНМА.ОстаточнаяСтоимостьРегл - СписокНМА.ОстатокОбесцененияРегл - ЕСТЬNULL(Доначисление.СуммаБУ, 0) - (&СуммаАмортизацииБУ)) > 0
	|					ТОГДА &СуммаАмортизацииБУ
	|				КОГДА СписокНМА.ОстаточнаяСтоимостьРегл - СписокНМА.ОстатокОбесцененияРегл - ЕСТЬNULL(Доначисление.СуммаБУ, 0) > 0
	|					ТОГДА СписокНМА.ОстаточнаяСтоимостьРегл - СписокНМА.ОстатокОбесцененияРегл - ЕСТЬNULL(Доначисление.СуммаБУ, 0)
	|				ИНАЧЕ 0
	|			КОНЕЦ КАК СуммаБУ
	|		ИЗ
	|			СписокНМАСПараметрами_БУ КАК СписокНМА
	|
	|				ЛЕВОЕ СОЕДИНЕНИЕ ДоначислениеАмортизацииБУ_Сгруппированная КАК Доначисление
	|				ПО Доначисление.НематериальныйАктив = СписокНМА.НематериальныйАктив
	|
	|				ЛЕВОЕ СОЕДИНЕНИЕ ПроверкаПараметровРасчета_БУ КАК ПроверкаПараметровРасчета
	|				ПО ПроверкаПараметровРасчета.ОбъектУчета = СписокНМА.НематериальныйАктив
	|					И ПроверкаПараметровРасчета.Организация = СписокНМА.Организация
	|
	|		ГДЕ
	|			НЕ СписокНМА.ЭтоДоначисление
	|			И ПроверкаПараметровРасчета.ОбъектУчета ЕСТЬ NULL
	|
	|		) КАК СписокНМА
	|
	|	) КАК СписокНМА
	|";
	
	ПараметрыТекстаЗапроса = ПараметрыТекстаЗапросаСуммаАмортизацииБУ();
	ПараметрыТекстаЗапроса.ТекстСтоимостьДляВычисленияАмортизации = "СписокНМА.СтоимостьДляВычисленияАмортизации";
	ПараметрыТекстаЗапроса.ТекстОстаточнаяСтоимость = "СписокНМА.ОстаточнаяСтоимостьРегл";
	ПараметрыТекстаЗапроса.ТекстЛиквидационнаяСтоимость = "СписокНМА.ЛиквидационнаяСтоимость";
	ПараметрыТекстаЗапроса.ТекстОбесценение = "СписокНМА.ОстатокОбесцененияРегл";
	ПараметрыТекстаЗапроса.ТекстСуммаДоначисления = "ЕСТЬNULL(Доначисление.СуммаБУ, 0)";
	
	ТекстСуммаАмортизацииБУ = ТекстЗапросаСуммаАмортизацииБУ(ПараметрыТекстаЗапроса);
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&СуммаАмортизацииБУ", ТекстСуммаАмортизацииБУ);
	
	//
	ТекстОбесценениеБУ = ТекстЗапросаСуммаОбесценения();
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ОбесценениеБУ", ТекстОбесценениеБУ);
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
КонецПроцедуры

Процедура ТекстЗапросаРасчетАмортизацииВыборкаИзмененийБУ(СписокЗапросов, ПараметрыРасчета)
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	1 КАК Приоритет,
	|	&НачалоМесяца КАК Период,
	|	НЕОПРЕДЕЛЕНО КАК Регистратор,
	|	СписокНМА.Организация КАК Организация,
	|	СписокНМА.Подразделение КАК Подразделение,
	|	СписокНМА.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	СписокНМА.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	СписокНМА.НематериальныйАктив КАК НематериальныйАктив,
	|	СписокНМА.ВидОбъектаУчета КАК ВидОбъектаУчета,
	|	СписокНМА.СтатьяРасходов КАК СтатьяРасходов,
	|	СписокНМА.АналитикаРасходов КАК АналитикаРасходов,
	|	СписокНМА.СпособОтраженияРасходов КАК СпособОтраженияРасходов,
	|	СписокНМА.СуммаБУ КАК СуммаБУ,
	|	СписокНМА.СуммаПР КАК СуммаПР,
	|	0 КАК СуммаУУ,
	|	0 КАК ОбесценениеУУ,
	|	СписокНМА.ОбесценениеБУ КАК ОбесценениеБУ,
	|	1 КАК Коэффициент,
	|	СписокНМА.ПередаватьРасходыВДругуюОрганизацию КАК ПередаватьРасходыВДругуюОрганизацию,
	|	СписокНМА.ОрганизацияПолучательРасходов КАК ОрганизацияПолучательРасходов,
	|	СписокНМА.РесурсВыработанныйЗаПрошлыйПериод КАК РесурсВыработанныйЗаПрошлыйПериод,
	|	СписокНМА.РесурсВыработанныйЗаТекущийПериод КАК РесурсВыработанныйЗаТекущийПериод,
	|	СписокНМА.РесурсНазначенный КАК РесурсНазначенный,
	|	СписокНМА.МетодНачисленияАмортизацииБУ КАК МетодНачисленияАмортизации,
	|
	|	0 КАК ЛиквидационнаяСтоимость,
	|	0 КАК ЛиквидационнаяСтоимостьРегл,
	|
	|	СписокНМА.ОстаточнаяСтоимостьРегл КАК ОстаточнаяСтоимостьРегл,
	|	СписокНМА.ОстаточнаяСтоимостьЦФ КАК ОстаточнаяСтоимостьЦФ,
	|	СписокНМА.ОстаточнаяСтоимостьПР КАК ОстаточнаяСтоимостьПР,
	|	СписокНМА.ОстаточнаяСтоимостьПРЦФ КАК ОстаточнаяСтоимостьПРЦФ, 
	|	СписокНМА.ОстатокОбесцененияРегл КАК ОстатокОбесцененияРегл,
	|	0 КАК ОстатокОбесцененияУпр,
	|
	|	0 КАК КоэффициентУскорения,
	|	0 КАК ОтработанныхМесяцевПолныхЛет,
	|	ЛОЖЬ КАК НачислятьАмортизацию,
	|
	|	0 КАК ПервоначальнаяСтоимостьБУ,
	|	0 КАК Стоимость,
	|	СписокНМА.СтоимостьРегл КАК СтоимостьРегл,
	|	0 КАК СтоимостьЦФ,
	|	0 КАК СтоимостьПР,
	|	0 КАК СтоимостьПРЦФ,
	|
	|	0 КАК Амортизация,
	|
	|	ВЫБОР
	|		КОГДА НАЧАЛОПЕРИОДА(СписокНМА.ПериодРасчета, МЕСЯЦ) = &НачалоМесяца
	|			ТОГДА СписокНМА.АмортизацияРегл + ЕСТЬNULL(Доначисление.СуммаБУ, 0)
	|		ИНАЧЕ СписокНМА.АмортизацияРегл
	|	КОНЕЦ КАК АмортизацияРегл,
	|
	|	ВЫБОР
	|		КОГДА НАЧАЛОПЕРИОДА(СписокНМА.ПериодРасчета, МЕСЯЦ) = &НачалоМесяца
	|			ТОГДА СписокНМА.АмортизацияПР + ЕСТЬNULL(Доначисление.СуммаПР, 0)
	|		ИНАЧЕ СписокНМА.АмортизацияПР
	|	КОНЕЦ КАК АмортизацияПР,
	|
	|	0 КАК СтоимостьИзменение,
	|	0 КАК СтоимостьРеглИзменение,
	|	0 КАК СтоимостьПРИзменение,
	|
	|	0 КАК АмортизацияИзменение,
	|	0 КАК АмортизацияРеглИзменение,
	|	0 КАК АмортизацияПРИзменение,
	|
	|	0 КАК СтоимостьДляВычисленияАмортизации,
	|	СписокНМА.СтоимостьРегл - СписокНМА.АмортизацияРегл КАК СтоимостьДляВычисленияАмортизацииРегл,
	|
	|	СписокНМА.КоэффициентЦФБУ КАК КоэффициентЦФБУ,
	|	СписокНМА.КоэффициентЦФНУ КАК КоэффициентЦФНУ,
	|	СписокНМА.КоэффициентЦФПР КАК КоэффициентЦФПР,
	|	СписокНМА.ВариантПроводокПоОбесценениюВНА КАК ВариантПроводокПоОбесценениюВНА,
	|	ЛОЖЬ КАК КорректировкаСтоимостиУУ,
	|	ЛОЖЬ КАК КорректировкаСтоимостиБУ,
	|	ЛОЖЬ КАК КорректировкаАмортизацииУУ,
	|	ЛОЖЬ КАК КорректировкаАмортизацииБУ,
	|	ЛОЖЬ КАК ЭтоИзменения
	|ИЗ
	|	РасчетАмортизацииБезИзмененийБУ КАК СписокНМА
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ДоначислениеАмортизацииБУ_Сгруппированная КАК Доначисление
	|		ПО Доначисление.НематериальныйАктив = СписокНМА.НематериальныйАктив
	|ГДЕ
	|	СписокНМА.НематериальныйАктив В
	|		(ВЫБРАТЬ
	|			СписокНМА.НематериальныйАктив
	|		ИЗ
	|			СписокНМАСИзмененнымиПараметрами_БУ КАК СписокНМА)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	1 КАК Приоритет,
	|	СписокНМА.Период КАК Период,
	|	СписокНМА.Регистратор КАК Регистратор,
	|	СписокНМА.Организация КАК Организация,
	|	СписокНМА.Подразделение КАК Подразделение,
	|	СписокНМА.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	СписокНМА.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	СписокНМА.НематериальныйАктив КАК НематериальныйАктив,
	|	СписокНМА.ВидОбъектаУчета КАК ВидОбъектаУчета,
	|	СписокНМА.СтатьяРасходов КАК СтатьяРасходов,
	|	СписокНМА.АналитикаРасходов КАК АналитикаРасходов,
	|	СписокНМА.СпособОтраженияРасходов КАК СпособОтраженияРасходов,
	|	0 КАК СуммаБУ,
	|	0 КАК СуммаПР,
	|	0 КАК СуммаУУ,
	|	0 КАК ОбесценениеУУ,
	|	0 КАК ОбесценениеБУ,
	|	1 КАК Коэффициент,
	|	СписокНМА.ПередаватьРасходыВДругуюОрганизацию КАК ПередаватьРасходыВДругуюОрганизацию,
	|	СписокНМА.ОрганизацияПолучательРасходов КАК ОрганизацияПолучательРасходов,
	|	СписокНМА.РесурсВыработанныйЗаПрошлыйПериод КАК РесурсВыработанныйЗаПрошлыйПериод,
	|	СписокНМА.РесурсВыработанныйЗаТекущийПериод КАК РесурсВыработанныйЗаТекущийПериод,
	|	СписокНМА.РесурсНазначенный КАК РесурсНазначенный,
	|	СписокНМА.МетодНачисленияАмортизацииБУ КАК МетодНачисленияАмортизации,
	|
	|	0 КАК ЛиквидационнаяСтоимость,
	|	СписокНМА.ЛиквидационнаяСтоимость КАК ЛиквидационнаяСтоимостьРегл,
	|
	|	СписокНМА.ОстаточнаяСтоимостьРегл КАК ОстаточнаяСтоимостьРегл,
	|	СписокНМА.ОстаточнаяСтоимостьЦФ КАК ОстаточнаяСтоимостьЦФ,
	|	СписокНМА.ОстаточнаяСтоимостьПР КАК ОстаточнаяСтоимостьПР,
	|	СписокНМА.ОстаточнаяСтоимостьПРЦФ КАК ОстаточнаяСтоимостьПРЦФ, 
	|	СписокНМА.ОстатокОбесцененияРегл КАК ОстатокОбесцененияРегл,
	|	0 КАК ОстатокОбесцененияУпр,
	|
	|	СписокНМА.КоэффициентБУ КАК КоэффициентУскорения,
	|	СписокНМА.ОтработанныхМесяцевПолныхЛет КАК ОтработанныхМесяцевПолныхЛет,
	|	СписокНМА.НачислятьАмортизациюБУ КАК НачислятьАмортизацию,
	|
	|	СписокНМА.ПервоначальнаяСтоимостьБУ КАК ПервоначальнаяСтоимостьБУ,
	|
	|	0 КАК Стоимость,
	|	СписокНМА.СтоимостьРегл КАК СтоимостьРегл,
	|	СписокНМА.СтоимостьЦФ КАК СтоимостьЦФ,
	|	СписокНМА.СтоимостьПР КАК СтоимостьПР,
	|	СписокНМА.СтоимостьПРЦФ КАК СтоимостьПРЦФ,
	|
	|	0 КАК Амортизация,
	|	ВЫБОР
	|		КОГДА НАЧАЛОПЕРИОДА(СписокНМА.Период, МЕСЯЦ) = &НачалоМесяца
	|			ТОГДА СписокНМА.АмортизацияРегл + ЕСТЬNULL(Доначисление.СуммаБУ, 0)
	|		ИНАЧЕ СписокНМА.АмортизацияРегл
	|	КОНЕЦ КАК АмортизацияРегл,
	|
	|	ВЫБОР
	|		КОГДА НАЧАЛОПЕРИОДА(СписокНМА.Период, МЕСЯЦ) = &НачалоМесяца
	|			ТОГДА СписокНМА.АмортизацияПР + ЕСТЬNULL(Доначисление.СуммаПР, 0)
	|		ИНАЧЕ СписокНМА.АмортизацияПР
	|	КОНЕЦ КАК АмортизацияПР,
	|
	|	0 КАК СтоимостьИзменение,
	|	СписокНМА.СтоимостьРеглИзменение КАК СтоимостьРеглИзменение,
	|	СписокНМА.СтоимостьПРИзменение КАК СтоимостьПРИзменение,
	|
	|	0 КАК АмортизацияИзменение,
	|	СписокНМА.АмортизацияРеглИзменение КАК АмортизацияРеглИзменение,
	|	СписокНМА.АмортизацияПРИзменение КАК АмортизацияПРИзменение,
	|
	|	0 КАК СтоимостьДляВычисленияАмортизации,
	|	СписокНМА.СтоимостьРегл - СписокНМА.АмортизацияРегл КАК СтоимостьДляВычисленияАмортизацииРегл,
	|
	|	СписокНМА.КоэффициентЦФБУ КАК КоэффициентЦФБУ,
	|	СписокНМА.КоэффициентЦФНУ КАК КоэффициентЦФНУ,
	|	СписокНМА.КоэффициентЦФПР КАК КоэффициентЦФПР,
	|	СписокНМА.ВариантПроводокПоОбесценениюВНА КАК ВариантПроводокПоОбесценениюВНА,
	|
	|	ЕСТЬNULL(Корректировка.КорректировкаСтоимости, ЛОЖЬ)
	|		И ЕСТЬNULL(Корректировка.ОтражатьВУпрУчете, ЛОЖЬ) КАК КорректировкаСтоимостиУУ,
	|
	|	ЕСТЬNULL(Корректировка.КорректировкаСтоимости, ЛОЖЬ)
	|		И ЕСТЬNULL(Корректировка.ОтражатьВРеглУчете, ЛОЖЬ) КАК КорректировкаСтоимостиБУ,
	|
	|	ЕСТЬNULL(Корректировка.КорректировкаАмортизации, ЛОЖЬ)
	|		И ЕСТЬNULL(Корректировка.ОтражатьВУпрУчете, ЛОЖЬ) КАК КорректировкаАмортизацииУУ,
	|
	|	ЕСТЬNULL(Корректировка.КорректировкаАмортизации, ЛОЖЬ)
	|		И ЕСТЬNULL(Корректировка.ОтражатьВРеглУчете, ЛОЖЬ) КАК КорректировкаАмортизацииБУ,
	|
	|	ИСТИНА КАК ЭтоИзменения
	|
	|ИЗ
	|	СписокНМАСИзмененнымиПараметрами_БУ КАК СписокНМА
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ДоначислениеАмортизацииБУ_Сгруппированная КАК Доначисление
	|		ПО Доначисление.НематериальныйАктив = СписокНМА.НематериальныйАктив
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПроверкаПараметровРасчетаИзменения_БУ КАК ПроверкаПараметровРасчета
	|		ПО ПроверкаПараметровРасчета.ОбъектУчета = СписокНМА.НематериальныйАктив
	|		И ПроверкаПараметровРасчета.Организация = СписокНМА.Организация
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.КорректировкаСтоимостиИАмортизацииНМА КАК Корректировка
	|		ПО Корректировка.Ссылка = СписокНМА.Регистратор
	|
	|ГДЕ
	|	НЕ СписокНМА.ЭтоДоначисление
	|	И ПроверкаПараметровРасчета.ОбъектУчета ЕСТЬ NULL";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
КонецПроцедуры

Процедура РассчитатьАмортизациюНУ(ПараметрыРасчета)

	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	&КонецМесяца                           КАК ПериодРасчета,
	|	СписокНМА.ВидОбъектаУчета              КАК ВидОбъектаУчета,
	|	СписокНМА.Организация                  КАК Организация,
	|	СписокНМА.НематериальныйАктив          КАК НематериальныйАктив,
	|	СписокНМА.Подразделение                КАК Подразделение,
	|	СписокНМА.ГруппаФинансовогоУчета       КАК ГруппаФинансовогоУчета,
	|	СписокНМА.НаправлениеДеятельности      КАК НаправлениеДеятельности,
	|	СписокНМА.СтатьяРасходов               КАК СтатьяРасходов,
	|	СписокНМА.АналитикаРасходов            КАК АналитикаРасходов,
	|	СписокНМА.СпособОтраженияРасходов      КАК СпособОтраженияРасходов,
	|	СписокНМА.ОстаточнаяСтоимостьНУ        КАК ОстаточнаяСтоимостьНУ,
	|	СписокНМА.ПередаватьРасходыВДругуюОрганизацию КАК ПередаватьРасходыВДругуюОрганизацию,
	|	СписокНМА.ОрганизацияПолучательРасходов КАК ОрганизацияПолучательРасходов,
	|	СписокНМА.КоэффициентЦФБУ              КАК КоэффициентЦФБУ,
	|	СписокНМА.КоэффициентЦФНУ              КАК КоэффициентЦФНУ,
	|	СписокНМА.КоэффициентЦФПР              КАК КоэффициентЦФПР,
	|
	|	ВЫБОР 
	|		КОГДА СписокНМА.ОстаточнаяСтоимостьНУ <= 0
	|			ТОГДА 0
	|		КОГДА (СписокНМА.СуммаНУ > СписокНМА.ОстаточнаяСтоимостьНУ
	|					ИЛИ СписокНМА.ОстаточнаяСтоимостьНУ - СписокНМА.СуммаНУ < &МинимальнаяОстаточнаяСтоимостьРегл)
	|			ТОГДА СписокНМА.ОстаточнаяСтоимостьНУ
	|		ИНАЧЕ СписокНМА.СуммаНУ
	|	КОНЕЦ КАК СуммаНУ
	|
	|ПОМЕСТИТЬ РасчетАмортизацииНУ
	|
	|ИЗ
	|	(ВЫБРАТЬ
	|		СписокНМА.ВидОбъектаУчета              КАК ВидОбъектаУчета,
	|		СписокНМА.Организация                  КАК Организация,
	|		СписокНМА.НематериальныйАктив          КАК НематериальныйАктив,
	|		СписокНМА.Подразделение                КАК Подразделение,
	|		СписокНМА.ГруппаФинансовогоУчета       КАК ГруппаФинансовогоУчета,
	|		СписокНМА.НаправлениеДеятельности      КАК НаправлениеДеятельности,
	|		СписокНМА.СтатьяРасходов               КАК СтатьяРасходов,
	|		СписокНМА.АналитикаРасходов            КАК АналитикаРасходов,
	|		СписокНМА.СпособОтраженияРасходов      КАК СпособОтраженияРасходов,
	|		СписокНМА.ОстаточнаяСтоимостьНУ        КАК ОстаточнаяСтоимостьНУ,
	|		СписокНМА.ПередаватьРасходыВДругуюОрганизацию КАК ПередаватьРасходыВДругуюОрганизацию,
	|		СписокНМА.ОрганизацияПолучательРасходов КАК ОрганизацияПолучательРасходов,
	|		СписокНМА.КоэффициентЦФБУ              КАК КоэффициентЦФБУ,
	|		СписокНМА.КоэффициентЦФНУ              КАК КоэффициентЦФНУ,
	|		СписокНМА.КоэффициентЦФПР              КАК КоэффициентЦФПР,
	|
	|		&СуммаАмортизацииНУ КАК СуммаНУ
	|	ИЗ
	|		СписокНМАСПараметрами_НУ КАК СписокНМА
	|
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПроверкаПараметровРасчета_НУ КАК ПроверкаПараметровРасчета
	|			ПО ПроверкаПараметровРасчета.ОбъектУчета = СписокНМА.НематериальныйАктив
	|				И ПроверкаПараметровРасчета.Организация = СписокНМА.Организация
	|
	|	ГДЕ
	|		СписокНМА.НачислятьАмортизациюНУ
	|		И ПроверкаПараметровРасчета.ОбъектУчета ЕСТЬ NULL
	|
	|	) КАК СписокНМА
	|
	|ГДЕ
	|	СписокНМА.СуммаНУ <> 0";
	
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&СуммаАмортизацииНУ", ТекстЗапросаСуммаАмортизацииНУ());
	
	Запрос = Новый Запрос(ТекстЗапроса);
	Запрос.МенеджерВременныхТаблиц = ПараметрыРасчета.МенеджерВременныхТаблиц;
	РасчетАмортизацииНМА.УстановитьПараметрыЗапросаДляРасчетаАмортизации(Запрос, ПараметрыРасчета);
	
	Запрос.Выполнить();
	
КонецПроцедуры

Процедура ОбъединитьРасчетАмортизацииБУНУ(ПараметрыРасчета)
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	Амортизация.ВидОбъектаУчета КАК ВидОбъектаУчета,
	|	Амортизация.ПериодРасчета КАК ПериодРасчета,
	|	Амортизация.Организация КАК Организация,
	|	Амортизация.Подразделение КАК Подразделение,
	|	Амортизация.НематериальныйАктив КАК НематериальныйАктив,
	|	ОбесценениеВНА.ЕГДС КАК ЕГДС,
	|	Амортизация.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	Амортизация.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|
	|	ЕСТЬNULL(СпособыОтраженияРасходов.НаправлениеДеятельности, Амортизация.НаправлениеДеятельности) КАК КорНаправлениеДеятельности,
	|
	|	ВЫБОР 
	|		КОГДА ЕСТЬNULL(СпособыОтраженияРасходов.Подразделение, Амортизация.Подразделение) = ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)
	|			ТОГДА Амортизация.Подразделение
	|		ИНАЧЕ ЕСТЬNULL(СпособыОтраженияРасходов.Подразделение, Амортизация.Подразделение) 
	|	КОНЕЦ КАК КорПодразделение,
	|
	|	ВЫБОР
	|		КОГДА НЕ СпособыОтраженияРасходов.СтатьяРасходов ЕСТЬ NULL
	|				И СпособыОтраженияРасходов.СтатьяРасходов <> ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
	|				И СпособыОтраженияРасходов.СтатьяРасходов <> НЕОПРЕДЕЛЕНО
	|			ТОГДА СпособыОтраженияРасходов.СтатьяРасходов
	|		ИНАЧЕ Амортизация.СтатьяРасходов
	|	КОНЕЦ КАК СтатьяРасходов,
	|
	|	ВЫБОР
	|		КОГДА НЕ СпособыОтраженияРасходов.СтатьяРасходов ЕСТЬ NULL
	|				И СпособыОтраженияРасходов.СтатьяРасходов <> ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
	|				И СпособыОтраженияРасходов.СтатьяРасходов <> НЕОПРЕДЕЛЕНО
	|			ТОГДА СпособыОтраженияРасходов.АналитикаРасходов
	|		ИНАЧЕ Амортизация.АналитикаРасходов
	|	КОНЕЦ КАК АналитикаРасходов,
	|
	|	ВЫБОР 
	|		КОГДА НЕ Амортизация.СпособОтраженияРасходов В (&ПустыеСпособыОтраженияРасходов) 
	|				И НЕ СпособыОтраженияРасходов.СпособОтраженияРасходов ЕСТЬ NULL
	|			ТОГДА &ОбесценениеБУ
	|		ИНАЧЕ Амортизация.ОбесценениеБУ
	|	КОНЕЦ КАК ОбесценениеБУ,
	|
	|	ВЫБОР 
	|		КОГДА НЕ Амортизация.СпособОтраженияРасходов В (&ПустыеСпособыОтраженияРасходов) 
	|				И НЕ СпособыОтраженияРасходов.СпособОтраженияРасходов ЕСТЬ NULL
	|			ТОГДА &ОбесценениеЦФ
	|		ИНАЧЕ Амортизация.ОбесценениеЦФ
	|	КОНЕЦ КАК ОбесценениеЦФ,
	|
	|	ВЫБОР
	|		КОГДА НЕ Амортизация.СпособОтраженияРасходов В (&ПустыеСпособыОтраженияРасходов) 
	|				И НЕ СпособыОтраженияРасходов.СпособОтраженияРасходов ЕСТЬ NULL
	|			ТОГДА &СуммаБУ
	|		КОГДА Амортизация.СуммаБУ > (Амортизация.ОстаточнаяСтоимостьРегл - Амортизация.ОстаточнаяСтоимостьЦФ)
	|				И (Амортизация.ОстаточнаяСтоимостьРегл - Амортизация.ОстаточнаяСтоимостьЦФ) > 0
	|			ТОГДА (Амортизация.ОстаточнаяСтоимостьРегл - Амортизация.ОстаточнаяСтоимостьЦФ)
	|		КОГДА Амортизация.СуммаБУ > (Амортизация.ОстаточнаяСтоимостьРегл - Амортизация.ОстаточнаяСтоимостьЦФ)
	|				И (Амортизация.ОстаточнаяСтоимостьРегл - Амортизация.ОстаточнаяСтоимостьЦФ) <= 0
	|			ТОГДА 0
	|		ИНАЧЕ Амортизация.СуммаБУ
	|	КОНЕЦ КАК СуммаБУ,
	|
	|	ВЫБОР 
	|		КОГДА НЕ Амортизация.СпособОтраженияРасходов В (&ПустыеСпособыОтраженияРасходов) 
	|				И НЕ СпособыОтраженияРасходов.СпособОтраженияРасходов ЕСТЬ NULL
	|			ТОГДА &СуммаНУ_регл
	|		ИНАЧЕ Амортизация.СуммаНУ
	|	КОНЕЦ КАК СуммаНУ,
	|
	|	ВЫБОР 
	|		КОГДА НЕ Амортизация.СпособОтраженияРасходов В (&ПустыеСпособыОтраженияРасходов) 
	|				И НЕ СпособыОтраженияРасходов.СпособОтраженияРасходов ЕСТЬ NULL
	|			ТОГДА &СуммаПР_регл
	|		КОГДА Амортизация.СуммаПР > Амортизация.ОстаточнаяСтоимостьПР
	|				И Амортизация.ОстаточнаяСтоимостьПР > 0
	|			ТОГДА Амортизация.ОстаточнаяСтоимостьПР
	|		КОГДА Амортизация.СуммаПР > Амортизация.ОстаточнаяСтоимостьПР
	|				И Амортизация.ОстаточнаяСтоимостьПР <= 0
	|			ТОГДА 0
	|		ИНАЧЕ Амортизация.СуммаПР
	|	КОНЕЦ КАК СуммаПР,
	|
	|	ВЫБОР 
	|		КОГДА НЕ Амортизация.СпособОтраженияРасходов В (&ПустыеСпособыОтраженияРасходов) 
	|				И НЕ СпособыОтраженияРасходов.СпособОтраженияРасходов ЕСТЬ NULL
	|			ТОГДА &СуммаЦФ
	|		ИНАЧЕ Амортизация.СуммаЦФ
	|	КОНЕЦ КАК СуммаЦФ,
	|
	|	ВЫБОР 
	|		КОГДА НЕ Амортизация.СпособОтраженияРасходов В (&ПустыеСпособыОтраженияРасходов) 
	|				И НЕ СпособыОтраженияРасходов.СпособОтраженияРасходов ЕСТЬ NULL
	|			ТОГДА &СуммаНУЦФ_регл
	|		ИНАЧЕ Амортизация.СуммаНУЦФ
	|	КОНЕЦ КАК СуммаНУЦФ,
	|
	|	ВЫБОР 
	|		КОГДА НЕ Амортизация.СпособОтраженияРасходов В (&ПустыеСпособыОтраженияРасходов) 
	|				И НЕ СпособыОтраженияРасходов.СпособОтраженияРасходов ЕСТЬ NULL
	|			ТОГДА &СуммаПРЦФ_регл
	|		КОГДА Амортизация.СуммаПРЦФ > Амортизация.ОстаточнаяСтоимостьПРЦФ
	|				И Амортизация.ОстаточнаяСтоимостьПРЦФ > 0
	|			ТОГДА Амортизация.ОстаточнаяСтоимостьПРЦФ
	|		КОГДА Амортизация.СуммаПРЦФ > Амортизация.ОстаточнаяСтоимостьПРЦФ
	|				И Амортизация.ОстаточнаяСтоимостьПРЦФ <= 0
	|			ТОГДА 0
	|		ИНАЧЕ Амортизация.СуммаПРЦФ
	|	КОНЕЦ КАК СуммаПРЦФ,
	|
	|	ВЫБОР
	|		КОГДА НЕ СпособыОтраженияРасходов.ОрганизацияПолучательРасходов ЕСТЬ NULL
	|				И СпособыОтраженияРасходов.ПередаватьРасходыВДругуюОрганизацию
	|				И СпособыОтраженияРасходов.ОрганизацияПолучательРасходов <> Амортизация.Организация
	|			ТОГДА ИСТИНА
	|		ИНАЧЕ Амортизация.ПередаватьРасходыВДругуюОрганизацию
	|	КОНЕЦ КАК ПередаватьРасходыВДругуюОрганизацию,
	|
	|	ЕСТЬNULL(СпособыОтраженияРасходов.ОрганизацияПолучательРасходов, Амортизация.ОрганизацияПолучательРасходов) КАК ОрганизацияПолучательРасходов,
	|
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(УчетнаяПолитикаБУ.ПрименяетсяФСБУ14, ЛОЖЬ)
	|				И Амортизация.ВидОбъектаУчета = ЗНАЧЕНИЕ(Перечисление.ВидыОбъектовУчетаНМА.НематериальныйАктив)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ПорядокУчетаВНА.ПоСтандартамМУ)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ПорядокУчетаВНА.ПоСтандартамРегл)
	|	КОНЕЦ КАК ПорядокУчетаВНА,
	|
	|	ЕСТЬNULL(УчетнаяПолитикаУУ.ВариантПроводокПоОбесценениюВНА, ЗНАЧЕНИЕ(Перечисление.ВариантыПроводокПоОбесценениюВНА.ДоначислятьКорректировкуОбесценения)) КАК ВариантПроводокПоОбесценениюВНА,
	|
	|	Амортизация.РесурсВыработанныйЗаПрошлыйПериод КАК РесурсВыработанныйЗаПрошлыйПериод,
	|	Амортизация.РесурсВыработанныйЗаТекущийПериод КАК РесурсВыработанныйЗаТекущийПериод,
	|	Амортизация.СтоимостьДляВычисленияАмортизации КАК СтоимостьДляВычисленияАмортизации,
	|	Амортизация.ОстатокОбесцененияРегл КАК ОстатокОбесцененияРегл,
	|	Амортизация.ПорядокНачисленияАмортизацииБУ КАК ПорядокНачисленияАмортизацииБУ,
	|	Амортизация.ЭтоДоначисление КАК ЭтоДоначисление
	|
	|ПОМЕСТИТЬ РасчетАмортизации_БУ
	|
	|ИЗ
	|	(ВЫБРАТЬ
	|		СписокНМА.ВидОбъектаУчета            КАК ВидОбъектаУчета,
	|		СписокНМА.ПериодРасчета              КАК ПериодРасчета,
	|		СписокНМА.Организация                КАК Организация,
	|		ВЫРАЗИТЬ(СписокНМА.Организация КАК Справочник.Организации).ГоловнаяОрганизация КАК ГоловнаяОрганизация,
	|		СписокНМА.Подразделение              КАК Подразделение,
	|		СписокНМА.НематериальныйАктив        КАК НематериальныйАктив,
	|		СписокНМА.ГруппаФинансовогоУчета     КАК ГруппаФинансовогоУчета,
	|		СписокНМА.НаправлениеДеятельности    КАК НаправлениеДеятельности,
	|		СписокНМА.СтатьяРасходов             КАК СтатьяРасходов,
	|		СписокНМА.АналитикаРасходов          КАК АналитикаРасходов,
	|		СписокНМА.СпособОтраженияРасходов    КАК СпособОтраженияРасходов,
	|
	|		СУММА(СписокНМА.СуммаБУ - ВЫРАЗИТЬ(СписокНМА.СуммаБУ * ЕСТЬNULL(СписокНМА.КоэффициентЦФБУ, 0) КАК ЧИСЛО(31,2))) КАК СуммаБУ,
	|
	|		СУММА(СписокНМА.СуммаНУ - ВЫРАЗИТЬ(СписокНМА.СуммаНУ * ЕСТЬNULL(СписокНМА.КоэффициентЦФНУ, 0) КАК ЧИСЛО(31,2))) КАК СуммаНУ,
	|
	|		ВЫБОР
	|			КОГДА СУММА(СписокНМА.СуммаБУ - ВЫРАЗИТЬ(СписокНМА.СуммаБУ * ЕСТЬNULL(СписокНМА.КоэффициентЦФБУ, 0) КАК ЧИСЛО(31,2))) = 0
	|				ТОГДА 0
	|			ИНАЧЕ СУММА(СписокНМА.СуммаПР)
	|		КОНЕЦ КАК СуммаПР,
	|
	|		СУММА(ВЫРАЗИТЬ(СписокНМА.СуммаБУ * ЕСТЬNULL(СписокНМА.КоэффициентЦФБУ, 0) КАК ЧИСЛО(31,2))) КАК СуммаЦФ,
	|
	|		СУММА(ВЫРАЗИТЬ(СписокНМА.СуммаНУ * ЕСТЬNULL(СписокНМА.КоэффициентЦФНУ, 0) КАК ЧИСЛО(31,2))) КАК СуммаНУЦФ,
	|
	|		СУММА(ВЫРАЗИТЬ(СписокНМА.СуммаПР * ЕСТЬNULL(СписокНМА.КоэффициентЦФПР, 0) КАК ЧИСЛО(31,2))) КАК СуммаПРЦФ,
	|
	|		СписокНМА.ПередаватьРасходыВДругуюОрганизацию  КАК ПередаватьРасходыВДругуюОрганизацию,
	|		СписокНМА.ОрганизацияПолучательРасходов        КАК ОрганизацияПолучательРасходов,
	|
	|		СУММА(СписокНМА.ОбесценениеБУ - ВЫРАЗИТЬ(СписокНМА.ОбесценениеБУ * ЕСТЬNULL(СписокНМА.КоэффициентЦФБУ, 0) КАК ЧИСЛО(31,2))) КАК ОбесценениеБУ,
	|		СУММА(ВЫРАЗИТЬ(СписокНМА.ОбесценениеБУ * ЕСТЬNULL(СписокНМА.КоэффициентЦФБУ, 0) КАК ЧИСЛО(31,2))) КАК ОбесценениеЦФ,
	|
	|		МАКСИМУМ(СписокНМА.РесурсВыработанныйЗаПрошлыйПериод) КАК РесурсВыработанныйЗаПрошлыйПериод,
	|		МАКСИМУМ(СписокНМА.РесурсВыработанныйЗаТекущийПериод) КАК РесурсВыработанныйЗаТекущийПериод,
	|		МАКСИМУМ(СписокНМА.СтоимостьДляВычисленияАмортизации) КАК СтоимостьДляВычисленияАмортизации,
	|		МАКСИМУМ(СписокНМА.ОстаточнаяСтоимостьРегл) КАК ОстаточнаяСтоимостьРегл,
	|		МАКСИМУМ(СписокНМА.ОстаточнаяСтоимостьЦФ) КАК ОстаточнаяСтоимостьЦФ,
	|		МАКСИМУМ(СписокНМА.ОстаточнаяСтоимостьПР) КАК ОстаточнаяСтоимостьПР,
	|		МАКСИМУМ(СписокНМА.ОстаточнаяСтоимостьПРЦФ) КАК ОстаточнаяСтоимостьПРЦФ,
	|		МАКСИМУМ(СписокНМА.ОстатокОбесцененияРегл) КАК ОстатокОбесцененияРегл,
	|		МАКСИМУМ(СписокНМА.ПорядокНачисленияАмортизацииБУ) КАК ПорядокНачисленияАмортизацииБУ,
	|		СписокНМА.ЭтоДоначисление КАК ЭтоДоначисление
	|	ИЗ
	|		(ВЫБРАТЬ
	|			РасчетАмортизации.ВидОбъектаУчета              КАК ВидОбъектаУчета,
	|			РасчетАмортизации.ПериодРасчета                КАК ПериодРасчета,
	|			РасчетАмортизации.Организация                  КАК Организация,
	|			РасчетАмортизации.Подразделение                КАК Подразделение,
	|			РасчетАмортизации.НематериальныйАктив          КАК НематериальныйАктив,
	|			РасчетАмортизации.ГруппаФинансовогоУчета       КАК ГруппаФинансовогоУчета,
	|			РасчетАмортизации.НаправлениеДеятельности      КАК НаправлениеДеятельности,
	|			РасчетАмортизации.СтатьяРасходов               КАК СтатьяРасходов,
	|			РасчетАмортизации.АналитикаРасходов            КАК АналитикаРасходов,
	|			РасчетАмортизации.СпособОтраженияРасходов      КАК СпособОтраженияРасходов,
	|
	|			РасчетАмортизации.РесурсВыработанныйЗаПрошлыйПериод КАК РесурсВыработанныйЗаПрошлыйПериод,
	|			РасчетАмортизации.РесурсВыработанныйЗаТекущийПериод КАК РесурсВыработанныйЗаТекущийПериод,
	|			РасчетАмортизации.СтоимостьДляВычисленияАмортизации КАК СтоимостьДляВычисленияАмортизации,
	|
	|			РасчетАмортизации.ОстаточнаяСтоимостьРегл      КАК ОстаточнаяСтоимостьРегл,
	|			РасчетАмортизации.ОстаточнаяСтоимостьЦФ        КАК ОстаточнаяСтоимостьЦФ,
	|			РасчетАмортизации.ОстаточнаяСтоимостьПР        КАК ОстаточнаяСтоимостьПР,
	|			РасчетАмортизации.ОстаточнаяСтоимостьПРЦФ      КАК ОстаточнаяСтоимостьПРЦФ,
	|			РасчетАмортизации.ОстатокОбесцененияРегл       КАК ОстатокОбесцененияРегл,
	|
	|			РасчетАмортизации.ОбесценениеБУ КАК ОбесценениеБУ,
	|
	|			РасчетАмортизации.СуммаБУ КАК СуммаБУ,
	|
	|			ВЫБОР
	|				КОГДА РасчетАмортизации.АмортизацияНачисляетсяПоСтандартамМУ
	|
	|					ТОГДА РасчетАмортизации.СуммаПР
	|
	|				КОГДА РасчетАмортизации.ВидОбъектаУчета = ЗНАЧЕНИЕ(Перечисление.ВидыОбъектовУчетаНМА.РасходыНаНИОКР)
	|						И (РасчетАмортизации.СтоимостьРегл + РасчетАмортизации.СтоимостьЦФ) <> 0
	|
	|					ТОГДА ВЫРАЗИТЬ(ВЫРАЗИТЬ(РасчетАмортизации.СуммаБУ КАК ЧИСЛО(20,8))
	|									* (ВЫРАЗИТЬ(РасчетАмортизации.СтоимостьПР + РасчетАмортизации.СтоимостьПРЦФ КАК ЧИСЛО(20,8))
	|										/ ВЫРАЗИТЬ(РасчетАмортизации.СтоимостьРегл + РасчетАмортизации.СтоимостьЦФ КАК ЧИСЛО(20,8))) КАК ЧИСЛО(31,2))
	|
	|				КОГДА РасчетАмортизации.ВидОбъектаУчета = ЗНАЧЕНИЕ(Перечисление.ВидыОбъектовУчетаНМА.НематериальныйАктив)
	|						И РасчетАмортизации.ПервоначальнаяСтоимостьБУ <> 0
	|
	|					ТОГДА ВЫРАЗИТЬ(ВЫРАЗИТЬ(РасчетАмортизации.СуммаБУ КАК ЧИСЛО(20,8))
	|									* (ВЫРАЗИТЬ(РасчетАмортизации.СтоимостьПР + РасчетАмортизации.СтоимостьПРЦФ КАК ЧИСЛО(20,8))
	|										/ ВЫРАЗИТЬ(РасчетАмортизации.ПервоначальнаяСтоимостьБУ КАК ЧИСЛО(20,8))) КАК ЧИСЛО(31,2))
	|
	|				ИНАЧЕ 0
	|			КОНЕЦ КАК СуммаПР,
	|
	|			0 КАК СуммаНУ,
	|			
	|			РасчетАмортизации.КоэффициентЦФБУ КАК КоэффициентЦФБУ,
	|			РасчетАмортизации.КоэффициентЦФНУ КАК КоэффициентЦФНУ,
	|			РасчетАмортизации.КоэффициентЦФПР КАК КоэффициентЦФПР,
	|
	|			РасчетАмортизации.ПередаватьРасходыВДругуюОрганизацию КАК ПередаватьРасходыВДругуюОрганизацию,
	|			РасчетАмортизации.ОрганизацияПолучательРасходов КАК ОрганизацияПолучательРасходов,
	|			РасчетАмортизации.ПорядокНачисленияАмортизацииБУ КАК ПорядокНачисленияАмортизацииБУ,
	|			ЛОЖЬ КАК ЭтоДоначисление
	|		ИЗ
	|			РасчетАмортизацииБезИзмененийБУ КАК РасчетАмортизации
	|
	|		ОБЪЕДИНИТЬ ВСЕ
	|
	|		ВЫБРАТЬ
	|			РасчетАмортизации.ВидОбъектаУчета              КАК ВидОбъектаУчета,
	|			РасчетАмортизации.ПериодРасчета                КАК ПериодРасчета,
	|			РасчетАмортизации.Организация                  КАК Организация,
	|			РасчетАмортизации.Подразделение                КАК Подразделение,
	|			РасчетАмортизации.НематериальныйАктив          КАК НематериальныйАктив,
	|			РасчетАмортизации.ГруппаФинансовогоУчета       КАК ГруппаФинансовогоУчета,
	|			РасчетАмортизации.НаправлениеДеятельности      КАК НаправлениеДеятельности,
	|			РасчетАмортизации.СтатьяРасходов               КАК СтатьяРасходов,
	|			РасчетАмортизации.АналитикаРасходов            КАК АналитикаРасходов,
	|			РасчетАмортизации.СпособОтраженияРасходов      КАК СпособОтраженияРасходов,
	|
	|			РасчетАмортизации.РесурсВыработанныйЗаПрошлыйПериод КАК РесурсВыработанныйЗаПрошлыйПериод,
	|			РасчетАмортизации.РесурсВыработанныйЗаТекущийПериод КАК РесурсВыработанныйЗаТекущийПериод,
	|			РасчетАмортизации.СтоимостьДляВычисленияАмортизации КАК СтоимостьДляВычисленияАмортизации,
	|
	|			РасчетАмортизации.ОстаточнаяСтоимостьРегл      КАК ОстаточнаяСтоимостьРегл,
	|			РасчетАмортизации.ОстаточнаяСтоимостьЦФ        КАК ОстаточнаяСтоимостьЦФ,
	|			РасчетАмортизации.ОстаточнаяСтоимостьПР        КАК ОстаточнаяСтоимостьПР,
	|			РасчетАмортизации.ОстаточнаяСтоимостьПРЦФ      КАК ОстаточнаяСтоимостьПРЦФ,
	|			0                                              КАК ОстатокОбесцененияРегл,
	|
	|			РасчетАмортизации.ОбесценениеБУ КАК ОбесценениеБУ,
	|
	|			РасчетАмортизации.СуммаБУ КАК СуммаБУ,
	|			РасчетАмортизации.СуммаПР КАК СуммаПР,
	|
	|			0 КАК СуммаНУ,
	|			
	|			РасчетАмортизации.КоэффициентЦФБУ КАК КоэффициентЦФБУ,
	|			РасчетАмортизации.КоэффициентЦФНУ КАК КоэффициентЦФНУ,
	|			РасчетАмортизации.КоэффициентЦФПР КАК КоэффициентЦФПР,
	|
	|			РасчетАмортизации.ПередаватьРасходыВДругуюОрганизацию КАК ПередаватьРасходыВДругуюОрганизацию,
	|			РасчетАмортизации.ОрганизацияПолучательРасходов КАК ОрганизацияПолучательРасходов,
	|			ЗНАЧЕНИЕ(Перечисление.ПорядокНачисленияАмортизации.СДатыПринятияКУчету) КАК ПорядокНачисленияАмортизацииБУ,
	|			ЛОЖЬ КАК ЭтоДоначисление
	|		ИЗ
	|			РасчетАмортизацииСУчетомИзмененийБУ КАК РасчетАмортизации
	|
	|		ОБЪЕДИНИТЬ ВСЕ
	|
	|		ВЫБРАТЬ
	|			РасчетАмортизации.ВидОбъектаУчета              КАК ВидОбъектаУчета,
	|			РасчетАмортизации.ПериодРасчета                КАК ПериодРасчета,
	|			РасчетАмортизации.Организация                  КАК Организация,
	|			РасчетАмортизации.Подразделение                КАК Подразделение,
	|			РасчетАмортизации.НематериальныйАктив          КАК НематериальныйАктив,
	|			РасчетАмортизации.ГруппаФинансовогоУчета       КАК ГруппаФинансовогоУчета,
	|			РасчетАмортизации.НаправлениеДеятельности      КАК НаправлениеДеятельности,
	|			РасчетАмортизации.СтатьяРасходов               КАК СтатьяРасходов,
	|			РасчетАмортизации.АналитикаРасходов            КАК АналитикаРасходов,
	|			РасчетАмортизации.СпособОтраженияРасходов      КАК СпособОтраженияРасходов,
	|
	|			РасчетАмортизации.РесурсВыработанныйЗаПрошлыйПериод КАК РесурсВыработанныйЗаПрошлыйПериод,
	|			РасчетАмортизации.РесурсВыработанныйЗаТекущийПериод КАК РесурсВыработанныйЗаТекущийПериод,
	|			РасчетАмортизации.СтоимостьДляВычисленияАмортизации КАК СтоимостьДляВычисленияАмортизации,
	|
	|			РасчетАмортизации.ОстаточнаяСтоимостьРегл      КАК ОстаточнаяСтоимостьРегл,
	|			РасчетАмортизации.ОстаточнаяСтоимостьЦФ        КАК ОстаточнаяСтоимостьЦФ,
	|			РасчетАмортизации.ОстаточнаяСтоимостьПР        КАК ОстаточнаяСтоимостьПР,
	|			РасчетАмортизации.ОстаточнаяСтоимостьПРЦФ      КАК ОстаточнаяСтоимостьПРЦФ,
	|			0                                              КАК ОстатокОбесцененияРегл,
	|
	|			0 КАК ОбесценениеБУ,
	|
	|			РасчетАмортизации.СуммаБУ КАК СуммаБУ,
	|			РасчетАмортизации.СуммаПР КАК СуммаПР,
	|
	|			0 КАК СуммаНУ,
	|			
	|			РасчетАмортизации.КоэффициентЦФБУ КАК КоэффициентЦФБУ,
	|			РасчетАмортизации.КоэффициентЦФНУ КАК КоэффициентЦФНУ,
	|			РасчетАмортизации.КоэффициентЦФПР КАК КоэффициентЦФПР,
	|
	|			РасчетАмортизации.ПередаватьРасходыВДругуюОрганизацию КАК ПередаватьРасходыВДругуюОрганизацию,
	|			РасчетАмортизации.ОрганизацияПолучательРасходов КАК ОрганизацияПолучательРасходов,
	|			ЗНАЧЕНИЕ(Перечисление.ПорядокНачисленияАмортизации.СДатыПринятияКУчету) КАК ПорядокНачисленияАмортизацииБУ,
	|			ИСТИНА КАК ЭтоДоначисление
	|		ИЗ
	|			ДоначислениеАмортизацииБУ КАК РасчетАмортизации
	|
	|		ОБЪЕДИНИТЬ ВСЕ
	|
	|		ВЫБРАТЬ
	|			РасчетАмортизации.ВидОбъектаУчета              КАК ВидОбъектаУчета,
	|			РасчетАмортизации.ПериодРасчета                КАК ПериодРасчета,
	|			РасчетАмортизации.Организация                  КАК Организация,
	|			РасчетАмортизации.Подразделение                КАК Подразделение,
	|			РасчетАмортизации.НематериальныйАктив          КАК НематериальныйАктив,
	|			РасчетАмортизации.ГруппаФинансовогоУчета       КАК ГруппаФинансовогоУчета,
	|			РасчетАмортизации.НаправлениеДеятельности      КАК НаправлениеДеятельности,
	|			РасчетАмортизации.СтатьяРасходов               КАК СтатьяРасходов,
	|			РасчетАмортизации.АналитикаРасходов            КАК АналитикаРасходов,
	|			РасчетАмортизации.СпособОтраженияРасходов      КАК СпособОтраженияРасходов,
	|
	|			0 КАК РесурсВыработанныйЗаПрошлыйПериод,
	|			0 КАК РесурсВыработанныйЗаТекущийПериод,
	|			0 КАК СтоимостьДляВычисленияАмортизации,
	|
	|			0 КАК ОстаточнаяСтоимостьРегл,
	|			0 КАК ОстаточнаяСтоимостьЦФ,
	|			0 КАК ОстаточнаяСтоимостьПР,
	|			0 КАК ОстаточнаяСтоимостьПРЦФ,
	|			0 КАК ОстатокОбесцененияРегл,
	|
	|			0 КАК ОбесценениеБУ,
	|			0 КАК СуммаБУ,
	|			0 КАК СуммаПР,
	|
	|			РасчетАмортизации.СуммаНУ КАК СуммаНУ,
	|			
	|			РасчетАмортизации.КоэффициентЦФБУ КАК КоэффициентЦФБУ,
	|			РасчетАмортизации.КоэффициентЦФНУ КАК КоэффициентЦФНУ,
	|			РасчетАмортизации.КоэффициентЦФПР КАК КоэффициентЦФПР,
	|
	|			РасчетАмортизации.ПередаватьРасходыВДругуюОрганизацию КАК ПередаватьРасходыВДругуюОрганизацию,
	|			РасчетАмортизации.ОрганизацияПолучательРасходов КАК ОрганизацияПолучательРасходов,
	|			НЕОПРЕДЕЛЕНО КАК ПорядокНачисленияАмортизацииБУ,
	|			ЛОЖЬ КАК ЭтоДоначисление
	|		ИЗ
	|			РасчетАмортизацииНУ КАК РасчетАмортизации
	|
	|		) КАК СписокНМА
	|	
	|	СГРУППИРОВАТЬ ПО
	|		СписокНМА.ВидОбъектаУчета,
	|		СписокНМА.ПериодРасчета,
	|		СписокНМА.Организация,
	|		ВЫРАЗИТЬ(СписокНМА.Организация КАК Справочник.Организации).ГоловнаяОрганизация,
	|		СписокНМА.Подразделение,
	|		СписокНМА.НематериальныйАктив,
	|		СписокНМА.ГруппаФинансовогоУчета,
	|		СписокНМА.НаправлениеДеятельности,
	|		СписокНМА.СтатьяРасходов,
	|		СписокНМА.АналитикаРасходов,
	|		СписокНМА.СпособОтраженияРасходов,
	|		СписокНМА.ПередаватьРасходыВДругуюОрганизацию,
	|		СписокНМА.ОрганизацияПолучательРасходов,
	|		СписокНМА.ЭтоДоначисление
	|
	|	) КАК Амортизация
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ СпособыОтраженияРасходов КАК СпособыОтраженияРасходов
	|		ПО (СпособыОтраженияРасходов.СпособОтраженияРасходов = Амортизация.СпособОтраженияРасходов)
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетнаяПолитикаБухУчета.СрезПоследних(&КонецМесяца) КАК УчетнаяПолитикаБУ
	|		ПО УчетнаяПолитикаБУ.Организация = Амортизация.ГоловнаяОрганизация
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетнаяПолитикаФинансовогоУчета.СрезПоследних(&КонецМесяца) КАК УчетнаяПолитикаУУ
	|		ПО УчетнаяПолитикаУУ.Организация = Амортизация.ГоловнаяОрганизация
	|
	|		ЛЕВОЕ СОЕДИНЕНИЕ ОбесценениеВНА КАК ОбесценениеВНА
	|		ПО ОбесценениеВНА.НематериальныйАктив = Амортизация.НематериальныйАктив
	|";
	
	ПолеСумма = 
	"ВЫБОР
	|	КОГДА Амортизация.СуммаБУ > (Амортизация.ОстаточнаяСтоимостьРегл - Амортизация.ОстаточнаяСтоимостьЦФ)
	|				И (Амортизация.ОстаточнаяСтоимостьРегл - Амортизация.ОстаточнаяСтоимостьЦФ) > 0
	|			ТОГДА (Амортизация.ОстаточнаяСтоимостьРегл - Амортизация.ОстаточнаяСтоимостьЦФ)
	|	КОГДА Амортизация.СуммаБУ > (Амортизация.ОстаточнаяСтоимостьРегл - Амортизация.ОстаточнаяСтоимостьЦФ)
	|				И (Амортизация.ОстаточнаяСтоимостьРегл - Амортизация.ОстаточнаяСтоимостьЦФ) <= 0
	|			ТОГДА 0
	|	ИНАЧЕ Амортизация.СуммаБУ
	|КОНЕЦ";
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&СуммаБУ", ОбщегоНазначенияУТ.ТекстРаспределенияСуммы(ПолеСумма));
	
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&СуммаНУ_регл", ОбщегоНазначенияУТ.ТекстРаспределенияСуммы("Амортизация.СуммаНУ"));
	
	ПолеСумма = 
	"ВЫБОР
	|	КОГДА Амортизация.СуммаПР > Амортизация.ОстаточнаяСтоимостьПР
	|				И Амортизация.ОстаточнаяСтоимостьПР > 0
	|			ТОГДА Амортизация.ОстаточнаяСтоимостьПР
	|	КОГДА Амортизация.СуммаПР > Амортизация.ОстаточнаяСтоимостьПР
	|				И Амортизация.ОстаточнаяСтоимостьПР <= 0
	|			ТОГДА 0
	|	ИНАЧЕ Амортизация.СуммаПР
	|КОНЕЦ";
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&СуммаПР_регл", ОбщегоНазначенияУТ.ТекстРаспределенияСуммы(ПолеСумма));
	
	ПолеСумма = 
	"ВЫБОР
	|	КОГДА Амортизация.СуммаЦФ > Амортизация.ОстаточнаяСтоимостьЦФ
	|				И Амортизация.ОстаточнаяСтоимостьЦФ > 0
	|			ТОГДА Амортизация.ОстаточнаяСтоимостьЦФ
	|	КОГДА Амортизация.СуммаЦФ > Амортизация.ОстаточнаяСтоимостьЦФ
	|				И Амортизация.ОстаточнаяСтоимостьЦФ <= 0
	|			ТОГДА 0
	|	ИНАЧЕ Амортизация.СуммаЦФ
	|КОНЕЦ";
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&СуммаЦФ", ОбщегоНазначенияУТ.ТекстРаспределенияСуммы(ПолеСумма));
	
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&СуммаНУЦФ_регл", ОбщегоНазначенияУТ.ТекстРаспределенияСуммы("Амортизация.СуммаНУЦФ"));
	
	ПолеСумма = 
	"ВЫБОР
	|	КОГДА Амортизация.СуммаПРЦФ > Амортизация.ОстаточнаяСтоимостьПРЦФ
	|				И Амортизация.ОстаточнаяСтоимостьПРЦФ > 0
	|			ТОГДА Амортизация.ОстаточнаяСтоимостьПРЦФ
	|	КОГДА Амортизация.СуммаПРЦФ > Амортизация.ОстаточнаяСтоимостьПРЦФ
	|				И Амортизация.ОстаточнаяСтоимостьПРЦФ <= 0
	|			ТОГДА 0
	|	ИНАЧЕ Амортизация.СуммаПРЦФ
	|КОНЕЦ";
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&СуммаПРЦФ_регл", ОбщегоНазначенияУТ.ТекстРаспределенияСуммы(ПолеСумма));
	
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ОбесценениеБУ",  ОбщегоНазначенияУТ.ТекстРаспределенияСуммы("Амортизация.ОбесценениеБУ"));
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ОбесценениеЦФ",  ОбщегоНазначенияУТ.ТекстРаспределенияСуммы("Амортизация.ОбесценениеЦФ"));

	Запрос = Новый Запрос(ТекстЗапроса);
	Запрос.МенеджерВременныхТаблиц = ПараметрыРасчета.МенеджерВременныхТаблиц;
	РасчетАмортизацииНМА.УстановитьПараметрыЗапросаДляРасчетаАмортизации(Запрос, ПараметрыРасчета);
	
	Запрос.Выполнить();
	
КонецПроцедуры

Функция ТекстЗапросаСуммаАмортизацииБУ(ПараметрыТекстаЗапроса)
	
	ТекстЗапроса =
	"ВЫБОР 
	|	КОГДА НЕ СписокНМА.НачислятьАмортизациюБУ
	| 
	|		ТОГДА 0
	|
	|	КОГДА СписокНМА.АмортизацияНачисляетсяПоСтандартамМУ
	|			И (СписокНМА.ОстаточнаяСтоимостьРегл - &СуммаДоначисления - &ЛиквидационнаяСтоимость - &ОстатокОбесценения) <= 0 
	|
	|		ТОГДА 0
	|
	|	КОГДА СписокНМА.АмортизацияНачисляетсяПоСтандартамМУ
	|				И (СписокНМА.РесурсВыработанныйЗаПрошлыйПериод + СписокНМА.РесурсВыработанныйЗаТекущийПериод) >= СписокНМА.РесурсНазначенный
	|			ИЛИ (СписокНМА.ОстаточнаяСтоимостьРегл - &СуммаДоначисления - &ЛиквидационнаяСтоимость - &ОстатокОбесценения) < &МинимальнаяОстаточнаяСтоимостьРегл
	|				И (СписокНМА.ОстаточнаяСтоимостьРегл - &СуммаДоначисления - &ОстатокОбесценения) >= 0
	|
	|		ТОГДА СписокНМА.ОстаточнаяСтоимостьРегл - &СуммаДоначисления - &ЛиквидационнаяСтоимость - &ОстатокОбесценения
	|
	|	КОГДА НЕ СписокНМА.АмортизацияНачисляетсяПоСтандартамМУ
	|			И СписокНМА.ОстаточнаяСтоимостьРегл <= 0 
	|
	|		ТОГДА 0
	|
		// Линейный, ПропорциональноОбъемуПродукции
	|	КОГДА СписокНМА.АмортизацияНачисляетсяПоСтандартамМУ
	|			И СписокНМА.МетодНачисленияАмортизацииБУ В (
	|					ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииНМА.Линейный),
	|					ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииНМА.ПропорциональноОбъемуПродукции)) 
	|
	|		ТОГДА ВЫБОР 
	|			КОГДА СписокНМА.ЭтоДоначисление
	|				ТОГДА ВЫРАЗИТЬ(ВЫРАЗИТЬ(&ОстаточнаяСтоимость - &СуммаДоначисления КАК ЧИСЛО(20,8))
	|								* ВЫРАЗИТЬ(СписокНМА.РесурсВыработанныйЗаТекущийПериод КАК ЧИСЛО(20,8))
	|								/ ВЫРАЗИТЬ(СписокНМА.РесурсНазначенный - СписокНМА.РесурсВыработанныйЗаПрошлыйПериод КАК ЧИСЛО(20,8)) КАК ЧИСЛО(31,2))
	| 
	|			ИНАЧЕ ВЫРАЗИТЬ(ВЫРАЗИТЬ(&ОстаточнаяСтоимость - &СуммаДоначисления - &ЛиквидационнаяСтоимость - &ОстатокОбесценения КАК ЧИСЛО(20,8)) 
	|								* ВЫРАЗИТЬ(СписокНМА.РесурсВыработанныйЗаТекущийПериод КАК ЧИСЛО(20,8))
	|								/ ВЫРАЗИТЬ(СписокНМА.РесурсНазначенный - СписокНМА.РесурсВыработанныйЗаПрошлыйПериод КАК ЧИСЛО(20,8)) КАК ЧИСЛО(31,2))
	|		КОНЕЦ
	|
		// УменьшаемогоОстатка (последний год)
	|	КОГДА СписокНМА.АмортизацияНачисляетсяПоСтандартамМУ
	|			И СписокНМА.МетодНачисленияАмортизацииБУ = ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииНМА.УменьшаемогоОстатка)
	|			И (СписокНМА.РесурсНазначенный - СписокНМА.РесурсВыработанныйЗаПрошлыйПериод - СписокНМА.РесурсВыработанныйЗаТекущийПериод) <= 12 
	|
	|		ТОГДА ВЫБОР 
	|			КОГДА СписокНМА.ЭтоДоначисление
	|				ТОГДА ВЫРАЗИТЬ(ВЫРАЗИТЬ(СписокНМА.СтоимостьДляВычисленияАмортизации - &СуммаДоначисления КАК ЧИСЛО(20,8))
	|								* ВЫРАЗИТЬ(СписокНМА.РесурсВыработанныйЗаТекущийПериод КАК ЧИСЛО(20,8)) 
	|								/ ВЫРАЗИТЬ(СписокНМА.РесурсНазначенный - СписокНМА.РесурсВыработанныйЗаПрошлыйПериод КАК ЧИСЛО(20,8)) КАК ЧИСЛО(31,2))
	|
	|			ИНАЧЕ ВЫРАЗИТЬ(ВЫРАЗИТЬ(СписокНМА.СтоимостьДляВычисленияАмортизации - &СуммаДоначисления - &ЛиквидационнаяСтоимость КАК ЧИСЛО(20,8)) 
	|								* ВЫРАЗИТЬ(СписокНМА.РесурсВыработанныйЗаТекущийПериод КАК ЧИСЛО(20,8))
	|								/ ВЫРАЗИТЬ(СписокНМА.РесурсНазначенный - СписокНМА.РесурсВыработанныйЗаПрошлыйПериод КАК ЧИСЛО(20,8)) КАК ЧИСЛО(31,2))
	|		КОНЕЦ
	|
		// УменьшаемогоОстатка (до последнего года)
	|	КОГДА СписокНМА.АмортизацияНачисляетсяПоСтандартамМУ
	|			И СписокНМА.МетодНачисленияАмортизацииБУ = ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииНМА.УменьшаемогоОстатка) 
	|   
	|		ТОГДА ВЫРАЗИТЬ(ВЫРАЗИТЬ(СписокНМА.СтоимостьДляВычисленияАмортизации - &СуммаДоначисления КАК ЧИСЛО(20,8))
	|					* ВЫРАЗИТЬ(СписокНМА.КоэффициентБУ КАК ЧИСЛО(20,8))
	|					* ВЫРАЗИТЬ(СписокНМА.РесурсВыработанныйЗаТекущийПериод КАК ЧИСЛО(20,8))
	|					/ ВЫРАЗИТЬ(СписокНМА.РесурсНазначенный 
	|						- СписокНМА.КоэффициентБУ 
	|							* (СписокНМА.РесурсВыработанныйЗаПрошлыйПериод - СписокНМА.ОтработанныхМесяцевПолныхЛет) КАК ЧИСЛО(20,8)) КАК ЧИСЛО(31,2))
	|
		// Линейный
	|	КОГДА НЕ СписокНМА.АмортизацияНачисляетсяПоСтандартамМУ
	|			И СписокНМА.МетодНачисленияАмортизацииБУ = ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииНМА.Линейный)
	|
	|		ТОГДА ВЫРАЗИТЬ(ВЫРАЗИТЬ(СписокНМА.ПервоначальнаяСтоимостьБУ - &ОстатокОбесценения КАК ЧИСЛО(20,8)) 
	|						/ ВЫРАЗИТЬ(СписокНМА.СрокПолезногоИспользованияБУ КАК ЧИСЛО(20,8)) КАК ЧИСЛО(31,2))
	|   
		// ПропорциональноОбъемуПродукции
	|	КОГДА НЕ СписокНМА.АмортизацияНачисляетсяПоСтандартамМУ
	|			И СписокНМА.МетодНачисленияАмортизацииБУ = ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииНМА.ПропорциональноОбъемуПродукции)
	|
	|		ТОГДА ВЫБОР 
	|				КОГДА СписокНМА.ОбъемНаработки <> 0 ТОГДА
	|					ВЫРАЗИТЬ(ВЫРАЗИТЬ(СписокНМА.ПервоначальнаяСтоимостьБУ - &ОстатокОбесценения КАК ЧИСЛО(20,8)) 
	|							* ВЫРАЗИТЬ(СписокНМА.ОбъемВыработки КАК ЧИСЛО(20,8))
	|							/ ВЫРАЗИТЬ(СписокНМА.ОбъемНаработки КАК ЧИСЛО(20,8)) КАК ЧИСЛО(31,2))
	|				ИНАЧЕ 0
	|			КОНЕЦ
	|
		// УменьшаемогоОстатка
	|	КОГДА НЕ СписокНМА.АмортизацияНачисляетсяПоСтандартамМУ
	|			И СписокНМА.МетодНачисленияАмортизацииБУ = ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииНМА.УменьшаемогоОстатка)
	|
	|		ТОГДА ВЫБОР 
	|				КОГДА (СписокНМА.СрокПолезногоИспользованияБУ - СписокНМА.ФактическийСрокИспользования + 1) > 0 ТОГДА
	|					ВЫРАЗИТЬ(ВЫРАЗИТЬ(СписокНМА.СтоимостьРегл + СписокНМА.СтоимостьЦФ - СписокНМА.АмортизацияРегл - СписокНМА.АмортизацияЦФ КАК ЧИСЛО(20,8)) 
	|							* ВЫРАЗИТЬ(СписокНМА.КоэффициентБУ КАК ЧИСЛО(20,8))
	|							/ ВЫРАЗИТЬ(СписокНМА.СрокПолезногоИспользованияБУ - СписокНМА.ФактическийСрокИспользования + 1 КАК ЧИСЛО(20,8)) КАК ЧИСЛО(31,2))
	|				ИНАЧЕ 0
	|				
	|			КОНЕЦ
	|
	|КОНЕЦ";				
	
	ТекстОбесценение = "(ВЫБОР КОГДА СписокНМА.ВариантПроводокПоОбесценениюВНА = &ДоначислятьКорректировкуОбесценения ТОГДА СписокНМА.ОстатокОбесцененияРегл ИНАЧЕ 0 КОНЕЦ)";			
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ОстатокОбесценения", ТекстОбесценение);
	
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&СтоимостьДляВычисленияАмортизации", ПараметрыТекстаЗапроса.ТекстСтоимостьДляВычисленияАмортизации);
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ОстаточнаяСтоимость", ПараметрыТекстаЗапроса.ТекстОстаточнаяСтоимость);
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&ЛиквидационнаяСтоимость", ПараметрыТекстаЗапроса.ТекстЛиквидационнаяСтоимость);
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&СуммаДоначисления", ПараметрыТекстаЗапроса.ТекстСуммаДоначисления);

	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстЗапросаСуммаАмортизацииНУ()

	ТекстЗапроса =
	"ВЫБОР 
	|	КОГДА НЕ СписокНМА.НачислятьАмортизациюНУ
	|		ТОГДА 0
	|
	|	КОГДА СписокНМА.МетодНачисленияАмортизацииНУ = ЗНАЧЕНИЕ(Перечисление.МетодыНачисленияАмортизации.Линейный)
	|
	|		ТОГДА ВЫБОР 
	|			КОГДА (СписокНМА.СрокПолезногоИспользованияНУ - СписокНМА.ФактическийСрокПриПереходеКЛинейномуМетоду) > 0
	|				ТОГДА ВЫРАЗИТЬ(ВЫРАЗИТЬ(СписокНМА.СтоимостьДляВычисленияАмортизацииНУ - СписокНМА.АмортизацияПриПереходеКЛинейномуМетоду КАК ЧИСЛО(20,8))
	|					 			/ ВЫРАЗИТЬ(СписокНМА.СрокПолезногоИспользованияНУ - СписокНМА.ФактическийСрокПриПереходеКЛинейномуМетоду КАК ЧИСЛО(20,8)) 
	|								* ВЫРАЗИТЬ(СписокНМА.СпециальныйКоэффициентНУ КАК ЧИСЛО(20,8)) КАК ЧИСЛО(31,2))
	|			ИНАЧЕ
	|				0
	|		КОНЕЦ
	|
	|	КОГДА СписокНМА.МетодНачисленияАмортизацииНУ = ЗНАЧЕНИЕ(Перечисление.МетодыНачисленияАмортизации.Нелинейный)
	|
	|		ТОГДА ВЫРАЗИТЬ(ВЫРАЗИТЬ(СписокНМА.СтоимостьНУНачальныйОстаток - СписокНМА.АмортизацияНУНачальныйОстаток КАК ЧИСЛО(20,8))
	|					* ВЫРАЗИТЬ(СписокНМА.НормаАмортизации / 100 КАК ЧИСЛО(20,8))
	|					* ВЫРАЗИТЬ(СписокНМА.СпециальныйКоэффициентНУ КАК ЧИСЛО(20,8)) КАК ЧИСЛО(31,2))
	|КОНЕЦ";				
	
	Возврат ТекстЗапроса;

КонецФункции

Функция ТекстЗапросаСуммаОбесценения()
	
	ТекстЗапроса = 
	"ВЫБОР 
	|	КОГДА НЕ СписокНМА.НачислятьАмортизациюБУ 
	|		ИЛИ СписокНМА.ОстатокОбесцененияРегл <= 0
	|
	|		ТОГДА 0
	|
	|	КОГДА СписокНМА.АмортизацияНачисляетсяПоСтандартамМУ
	|			И СписокНМА.МетодНачисленияАмортизацииБУ В (
	|					ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииНМА.Линейный),
	|					ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииНМА.ПропорциональноОбъемуПродукции)) 
	|
	|		ТОГДА ВЫРАЗИТЬ(СписокНМА.ОстатокОбесцененияРегл 
	|							* (ВЫРАЗИТЬ(СписокНМА.РесурсВыработанныйЗаТекущийПериод КАК ЧИСЛО(20,8))
	|							/ ВЫРАЗИТЬ(СписокНМА.РесурсНазначенный - СписокНМА.РесурсВыработанныйЗаПрошлыйПериод КАК ЧИСЛО(20,8))) КАК ЧИСЛО(31,2))
	|
	// Линейный
	|	КОГДА НЕ СписокНМА.АмортизацияНачисляетсяПоСтандартамМУ
	|			И СписокНМА.МетодНачисленияАмортизацииБУ = ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииНМА.Линейный)
	| 
	|		ТОГДА ВЫРАЗИТЬ(СписокНМА.ОстатокОбесцененияРегл / СписокНМА.СрокПолезногоИспользованияБУ КАК ЧИСЛО(31,2))
	|   
	// ПропорциональноОбъемуПродукции
	|	КОГДА НЕ СписокНМА.АмортизацияНачисляетсяПоСтандартамМУ
	|			И СписокНМА.МетодНачисленияАмортизацииБУ = ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииНМА.ПропорциональноОбъемуПродукции)
	| 
	|		ТОГДА ВЫБОР 
	|			КОГДА СписокНМА.ОбъемНаработки <> 0 ТОГДА
	|				ВЫРАЗИТЬ(СписокНМА.ОстатокОбесцененияРегл * СписокНМА.ОбъемВыработки / СписокНМА.ОбъемНаработки КАК ЧИСЛО(31,2))
	|			ИНАЧЕ 0
	|		КОНЕЦ
	|
	|	ИНАЧЕ 0
	|
	|КОНЕЦ";
	
	Возврат ТекстЗапроса;
	
КонецФункции

// Параметры текста запроса сумма амортизации БУ.
// 
// Возвращаемое значение:
//  Структура - свойства:
// 		* ТекстСтоимостьДляВычисленияАмортизации - Строка - 
//		* ТекстОстаточнаяСтоимость - Строка -
// 		* ТекстЛиквидационнаяСтоимость - Строка -
// 		* ТекстСуммаДоначисления - Строка -
// 		* ТекстОбесценение - Строка -
Функция ПараметрыТекстаЗапросаСуммаАмортизацииБУ()

	ПараметрыТекстаЗапроса = Новый Структура;
	ПараметрыТекстаЗапроса.Вставить("ТекстСтоимостьДляВычисленияАмортизации", "0");
	ПараметрыТекстаЗапроса.Вставить("ТекстОстаточнаяСтоимость", "0");
	ПараметрыТекстаЗапроса.Вставить("ТекстЛиквидационнаяСтоимость", "0");
	ПараметрыТекстаЗапроса.Вставить("ТекстСуммаДоначисления", "0");
	ПараметрыТекстаЗапроса.Вставить("ТекстОбесценение", "0");
	
	Возврат ПараметрыТекстаЗапроса;
	
КонецФункции

#КонецОбласти

#Область Прочее

Процедура ВернутьПараметрыРасчета(ПараметрыРасчета)

	Если НЕ ПараметрыРасчета.ВернутьПараметрыРасчета Тогда
		Возврат;
	КонецЕсли;

	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	&КонецМесяца                                                      КАК Дата,
	|	ПараметрыАмортизации.Организация                                  КАК Организация,
	|	ПараметрыАмортизации.НематериальныйАктив                          КАК ВнеоборотныйАктив,
	
	// БУ
	|	ВЫБОР 
	|		КОГДА ПараметрыАмортизации.НачислятьАмортизациюБУ 
	|			ТОГДА ПараметрыАмортизации.МетодНачисленияАмортизацииБУ
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК МетодНачисленияБУ,
	|	ВЫБОР 
	|		КОГДА ПараметрыАмортизации.НачислятьАмортизациюБУ 
	|			ТОГДА ПараметрыАмортизации.СрокПолезногоИспользованияБУ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СрокИспользованияБУ,
	|	ВЫБОР
	|		КОГДА ПараметрыАмортизации.МетодНачисленияАмортизацииБУ = ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииНМА.УменьшаемогоОстатка) 
	|			ТОГДА ПараметрыАмортизации.СтоимостьРегл
	|		ИНАЧЕ ПараметрыАмортизации.ПервоначальнаяСтоимостьБУ                    
	|	КОНЕЦ                                                             КАК СтоимостьБУ,
	|	ПараметрыАмортизации.ОбъемВыработки                               КАК ВыработкаЗаМесяцБУ,
	|	ПараметрыАмортизации.ОбъемНаработки                               КАК ОбъемПродукцииБУ,
	|	ПараметрыАмортизации.КоэффициентБУ                                КАК КоэффициентАмортизацииБУ,
	|
	|	ПараметрыАмортизации.СрокПолезногоИспользованияБУ
	|		- ПараметрыАмортизации.ФактическийСрокИспользования           КАК ОставшийсяСрокИспользования,
	|
	|	ПараметрыАмортизации.ФактическийСрокИспользования                 КАК ФактическийСрокИспользования
	|
	|ИЗ
	|	СписокНМАСПараметрами_БУ КАК ПараметрыАмортизации
	|
	|ГДЕ
	|	ПараметрыАмортизации.НачислятьАмортизациюБУ
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	&КонецМесяца                                                      КАК Дата,
	|	ПараметрыАмортизации.Организация                                  КАК Организация,
	|	ПараметрыАмортизации.НематериальныйАктив                          КАК ВнеоборотныйАктив,
	|
	// НУ
	|	ВЫБОР 
	|		КОГДА ПараметрыАмортизации.НачислятьАмортизациюНУ 
	|			ТОГДА ПараметрыАмортизации.МетодНачисленияАмортизацииНУ
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ КАК МетодНачисленияНУ,
	|
	|	ВЫБОР 
	|		КОГДА ПараметрыАмортизации.НачислятьАмортизациюНУ 
	|			ТОГДА ПараметрыАмортизации.СрокПолезногоИспользованияНУ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СрокИспользованияНУ,
	|
	|	ВЫБОР
	|		КОГДА НЕ ПараметрыАмортизации.НачислятьАмортизациюНУ 
	|			ТОГДА 0
	|		КОГДА ПараметрыАмортизации.МетодНачисленияАмортизацииНУ = ЗНАЧЕНИЕ(Перечисление.МетодыНачисленияАмортизации.Нелинейный) 
	|			ТОГДА ПараметрыАмортизации.СтоимостьНУНачальныйОстаток - ПараметрыАмортизации.АмортизацияНУНачальныйОстаток
	|		ИНАЧЕ ПараметрыАмортизации.СтоимостьДляВычисленияАмортизацииНУ - ПараметрыАмортизации.АмортизацияПриПереходеКЛинейномуМетоду                    
	|	КОНЕЦ КАК СтоимостьНУ,
	|
	|	ВЫБОР 
	|		КОГДА ПараметрыАмортизации.НачислятьАмортизациюНУ 
	|			ТОГДА ПараметрыАмортизации.СпециальныйКоэффициентНУ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК КоэффициентНУ,
	|
	|	ВЫБОР 
	|		КОГДА ПараметрыАмортизации.НачислятьАмортизациюНУ 
	|			ТОГДА ПараметрыАмортизации.НормаАмортизации
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК НормаАмортизацииНУ
	|
	|ИЗ
	|	СписокНМАСПараметрами_НУ КАК ПараметрыАмортизации
	|
	|ГДЕ
	|	ПараметрыАмортизации.НачислятьАмортизациюНУ
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	&КонецМесяца                                                      КАК Дата,
	|	ПараметрыАмортизации.Организация                                  КАК Организация,
	|	ПараметрыАмортизации.НематериальныйАктив                          КАК ВнеоборотныйАктив,
	
	// УУ
	|	ПараметрыАмортизации.МетодНачисленияАмортизации                   КАК МетодНачисленияУУ,
	|	ПараметрыАмортизации.ОстаточнаяСтоимость                          КАК СтоимостьУУ,
	|	ПараметрыАмортизации.ЛиквидационнаяСтоимость                      КАК ЛиквидационнаяСтоимость,
	|	ПараметрыАмортизации.РесурсНазначенный                            КАК СрокИспользованияУУ,
	|	ПараметрыАмортизации.РесурсВыработанныйЗаТекущийПериод            КАК РесурсВыработанныйЗаТекущийПериод,
	|	ПараметрыАмортизации.РесурсВыработанныйЗаПрошлыйПериод            КАК РесурсВыработанныйЗаПрошлыйПериод,
	|	ПараметрыАмортизации.ОтработанныхМесяцевПолныхЛет                 КАК ОтработанныхМесяцевПолныхЛет,
	|	ПараметрыАмортизации.КоэффициентУскорения                         КАК КоэффициентУскоренияУУ
	|ИЗ
	|	СписокНМАСПараметрами_УУ КАК ПараметрыАмортизации
	|ГДЕ
	|	ПараметрыАмортизации.НачислятьАмортизацию";
	
	Запрос = Новый Запрос(ТекстЗапроса);
	Запрос.МенеджерВременныхТаблиц = ПараметрыРасчета.МенеджерВременныхТаблиц;
	Запрос.УстановитьПараметр("КонецМесяца", КонецМесяца(ПараметрыРасчета.Период));
	
	Результат = Запрос.ВыполнитьПакет();
	
	ПараметрыАмортизации_БУ = Результат[0].Выгрузить();
	ПараметрыАмортизации_НУ = Результат[1].Выгрузить();
	ПараметрыАмортизации_УУ = Результат[2].Выгрузить();

	СписокПараметровАмортизации = ПолучитьИзВременногоХранилища(ПараметрыРасчета.АдресПараметровРасчета);
	
	Если СписокПараметровАмортизации = Неопределено Тогда
		СписокПараметровАмортизации = Новый Структура;
		СписокПараметровАмортизации.Вставить("ПараметрыАмортизации_БУ", ПараметрыАмортизации_БУ);
		СписокПараметровАмортизации.Вставить("ПараметрыАмортизации_НУ", ПараметрыАмортизации_НУ);
		СписокПараметровАмортизации.Вставить("ПараметрыАмортизации_УУ", ПараметрыАмортизации_УУ);
	Иначе
		ОбщегоНазначенияУТКлиентСервер.ДополнитьТаблицу(СписокПараметровАмортизации.ПараметрыАмортизации_БУ, ПараметрыАмортизации_БУ);
		ОбщегоНазначенияУТКлиентСервер.ДополнитьТаблицу(СписокПараметровАмортизации.ПараметрыАмортизации_НУ, ПараметрыАмортизации_НУ);
		ОбщегоНазначенияУТКлиентСервер.ДополнитьТаблицу(СписокПараметровАмортизации.ПараметрыАмортизации_УУ, ПараметрыАмортизации_УУ);
	КонецЕсли; 
	
	ПоместитьВоВременноеХранилище(СписокПараметровАмортизации, ПараметрыРасчета.АдресПараметровРасчета);
	
КонецПроцедуры

#КонецОбласти

#КонецОбласти

#КонецОбласти

//-- Локализация
