////////////////////////////////////////////////////////////////////////////////
// Подсистема "Статистика персонала".
// Процедуры и функции, предназначенные для форм статистической отчетности.
////////////////////////////////////////////////////////////////////////////////

#Область ПрограммныйИнтерфейс

// Заполняет переданную таблицу значений сведениями о численности сотрудников
//
// Параметры:
//  СведенияОЧисленности                - см. СведенияОЧисленности()
//  ПараметрыДляСведенийОЧисленности    - см. ПараметрыДляСведенийОЧисленности()
//
Процедура ЗаполнитьСведенияОЧисленности(СведенияОЧисленности, Знач ПараметрыДляСведенийОЧисленности) Экспорт
	СтатистикаПерсоналаВнутренний.ЗаполнитьСведенияОЧисленности(СведенияОЧисленности, ПараметрыДляСведенийОЧисленности);
КонецПроцедуры

// См. СтатистикаПерсоналаВнутренний.ПараметрыДляСведенийОЧисленности.
Функция ПараметрыДляСведенийОЧисленности() Экспорт
	Возврат СтатистикаПерсоналаВнутренний.ПараметрыДляСведенийОЧисленности();
КонецФункции

// См. СтатистикаПерсоналаВнутренний.СведенияОЧисленности.
Функция СведенияОЧисленности(РазрядностьПоказателей = 2) Экспорт
	Возврат СтатистикаПерсоналаВнутренний.СведенияОЧисленности(РазрядностьПоказателей);
КонецФункции

// Возвращает объект для хранения данных о численности
// Возвращаемое значение:
//   Структура:
//   * СреднесписочнаяЧисленностьРаботников - Число
//   * СреднесписочнаяЧисленностьЖенщин - Число
//   * СреднесписочнаяЧисленностьИнвалидов - Число
//   * ЧисленностьРаботников - Число
//   * ЧисленностьЖенщин - Число
//   * ЧисленностьИнвалидов - Число
//
Функция ДанныеОЧисленности() Экспорт
	
	ДанныеОЧисленности = Новый Структура;
	
	ДанныеОЧисленности.Вставить("СредняяЧисленность", 0);
	ДанныеОЧисленности.Вставить("СреднесписочнаяЧисленностьРаботников", 0);
	ДанныеОЧисленности.Вставить("СреднесписочнаяЧисленностьЖенщин", 0);
	ДанныеОЧисленности.Вставить("СреднесписочнаяЧисленностьИнвалидов", 0);
	ДанныеОЧисленности.Вставить("СредняяЧисленностьДоговорников", 0);
	ДанныеОЧисленности.Вставить("СреднесписочнаяЧисленностьВнешнихСовместителей", 0);
	ДанныеОЧисленности.Вставить("Численность", 0);
	ДанныеОЧисленности.Вставить("ЧисленностьРаботников", 0);
	ДанныеОЧисленности.Вставить("ЧисленностьЖенщин", 0);
	ДанныеОЧисленности.Вставить("ЧисленностьИнвалидов", 0);
	ДанныеОЧисленности.Вставить("ЧисленностьДоговорников", 0);
	ДанныеОЧисленности.Вставить("ЧисленностьВнешнихСовместителей", 0);
	
	Возврат ДанныеОЧисленности;
	
КонецФункции

#КонецОбласти


#Область СлужебныйПрограммныйИнтерфейс

// Рассчитывает численность всех работников, женщин и инвалидов.
// При этом за переданный период считается среднесписочная численность, 
// а на конец заданного периода - списочная численность.
//
// Параметры:
//		Организация				- СправочникСсылка.Организации
//		НачалоПериода			- Дата
//		КонецПериода			- Дата
//		ПоГоловнойОрганизации	- Булево - если Истина, то отбор по головной организации, иначе по текущей организации
//
// Возвращаемое значение:
//		Структура - см. СтатистикаПерсонала.ДанныеОЧисленности 
//	
Функция СреднесписочнаяЧисленностьРаботающих(Организация, НачалоПериода, КонецПериода, ПоГоловнойОрганизации = Ложь, Точность = 0) Экспорт 
	
	ПараметрыЧисленности = ПараметрыДляСведенийОЧисленности();
	
	ПараметрыЧисленности.Организация = Организация;
	ПараметрыЧисленности.ДатаНачала = НачалоПериода;
	ПараметрыЧисленности.ДатаОкончания = КонецПериода;
	ПараметрыЧисленности.ПоГоловнойОрганизации = ПоГоловнойОрганизации;
	
	СведенияОЧисленностиДоОкругления = СведенияОЧисленности(Точность + 2);
	ЗаполнитьСведенияОЧисленности(СведенияОЧисленностиДоОкругления, ПараметрыЧисленности);
	
	СведенияОЧисленности = СведенияОЧисленности(Точность);
	Для Каждого СтрокаСведений Из СведенияОЧисленностиДоОкругления Цикл
		НоваяСтрока = СведенияОЧисленности.Добавить();
		ЗаполнитьЗначенияСвойств(НоваяСтрока, СтрокаСведений);
	КонецЦикла;
	
	ДанныеЧисленности = ДанныеОЧисленности();
	
	Для Каждого СтрокаЧисленности Из СведенияОЧисленности Цикл
		
		ДанныеЧисленности.СреднесписочнаяЧисленностьРаботников = ДанныеЧисленности.СреднесписочнаяЧисленностьРаботников
			+ СтрокаЧисленности.СреднесписочнаяЧисленностьСотрудников;
		ДанныеЧисленности.СреднесписочнаяЧисленностьЖенщин = ДанныеЧисленности.СреднесписочнаяЧисленностьЖенщин
			+ СтрокаЧисленности.СреднесписочнаяЧисленностьЖенщин;
		ДанныеЧисленности.СреднесписочнаяЧисленностьИнвалидов = ДанныеЧисленности.СреднесписочнаяЧисленностьИнвалидов
			+ СтрокаЧисленности.СреднесписочнаяЧисленностьИнвалидов;
		ДанныеЧисленности.СредняяЧисленностьДоговорников = ДанныеЧисленности.СредняяЧисленностьДоговорников
			+ СтрокаЧисленности.СредняяЧисленностьДоговорников;
		ДанныеЧисленности.СреднесписочнаяЧисленностьВнешнихСовместителей = ДанныеЧисленности.СреднесписочнаяЧисленностьВнешнихСовместителей
			+ СтрокаЧисленности.СреднесписочнаяЧисленностьВнешнихСовместителей;
		ДанныеЧисленности.СредняяЧисленность = ДанныеЧисленности.СредняяЧисленность
			+ СтрокаЧисленности.СреднесписочнаяЧисленностьСотрудников 
			+ СтрокаЧисленности.СредняяЧисленностьДоговорников
			+ СтрокаЧисленности.СреднесписочнаяЧисленностьВнешнихСовместителей;
		ДанныеЧисленности.ЧисленностьРаботников = ДанныеЧисленности.ЧисленностьРаботников
			+ СтрокаЧисленности.ЧисленностьСотрудников;
		ДанныеЧисленности.ЧисленностьЖенщин = ДанныеЧисленности.ЧисленностьЖенщин
			+ СтрокаЧисленности.ЧисленностьЖенщин;
		ДанныеЧисленности.ЧисленностьИнвалидов = ДанныеЧисленности.ЧисленностьИнвалидов
			+ СтрокаЧисленности.ЧисленностьИнвалидов;
		ДанныеЧисленности.ЧисленностьДоговорников = ДанныеЧисленности.ЧисленностьДоговорников
			+ СтрокаЧисленности.ЧисленностьДоговорников;
		ДанныеЧисленности.ЧисленностьВнешнихСовместителей = ДанныеЧисленности.ЧисленностьВнешнихСовместителей
			+ СтрокаЧисленности.ЧисленностьВнешнихСовместителей;
		ДанныеЧисленности.Численность = ДанныеЧисленности.Численность
			+ СтрокаЧисленности.ЧисленностьСотрудников
			+ СтрокаЧисленности.ЧисленностьДоговорников
			+ СтрокаЧисленности.ЧисленностьВнешнихСовместителей;
			
	КонецЦикла;
		
	Возврат ДанныеЧисленности;

КонецФункции

#Область РегламентированнаяОтчетность

// См. РегламентированнаяОтчетностьПереопределяемый.ПолучитьСведенияОПоказателяхОтчета.
Процедура ПриПолученииСведенийОПоказателяхОтчета(ПоказателиОтчета, ИДОтчета, ИДРедакцииОтчета, ПараметрыОтчета) Экспорт
	
	Если ИДОтчета = "РегламентированныйОтчетСтатистикаФормаП4" Тогда
		Если ИДРедакцииОтчета >= "ФормаОтчета2025Кв1" Тогда
			ДобавитьПоказателиФормыП4_2025Кв1(ПоказателиОтчета);
		ИначеЕсли ИДРедакцииОтчета >= "ФормаОтчета2013Кв1" Тогда
			ДобавитьПоказателиФормыП4_2013Кв1(ПоказателиОтчета);
		КонецЕсли;
	ИначеЕсли ИДОтчета = "РегламентированныйОтчетСтатистикаФормаП4НЗ" Тогда
		Если ИДРедакцииОтчета >= "ФормаОтчета2022Кв1" Тогда
			ДобавитьПоказателиФормыП4НЗ_2022Кв1(ПоказателиОтчета);
		ИначеЕсли ИДРедакцииОтчета >= "ФормаОтчета2021Кв1" Тогда
			ДобавитьПоказателиФормыП4НЗ_2021Кв1(ПоказателиОтчета);
		ИначеЕсли ИДРедакцииОтчета >= "ФормаОтчета2015Кв1" Тогда
			ДобавитьПоказателиФормыП4НЗ_2015Кв1(ПоказателиОтчета);
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры

// См. РегламентированнаяОтчетностьПереопределяемый.ЗаполнитьОтчет.
Процедура ПриЗаполненииРегламентированногоОтчета(ИДОтчета, ИДРедакцииОтчета, ПараметрыОтчета, Контейнер) Экспорт
	
	Если ИДОтчета = "РегламентированныйОтчетСтатистикаФормаП4" Тогда
		Если ИДРедакцииОтчета >= "ФормаОтчета2025Кв1" Тогда
			ЗаполнитьПоказателиФормыП4_2025Кв1(ПараметрыОтчета, Контейнер);
		ИначеЕсли ИДРедакцииОтчета >= "ФормаОтчета2023Кв1" Тогда
			ЗаполнитьПоказателиФормыП4_2023Кв1(ПараметрыОтчета, Контейнер);
		ИначеЕсли ИДРедакцииОтчета >= "ФормаОтчета2022Кв1" Тогда
			ЗаполнитьПоказателиФормыП4_2022Кв1(ПараметрыОтчета, Контейнер);
		ИначеЕсли ИДРедакцииОтчета >= "ФормаОтчета2017Кв1" Тогда
			ЗаполнитьПоказателиФормыП4_2017Кв1(ПараметрыОтчета, Контейнер);
		ИначеЕсли ИДРедакцииОтчета >= "ФормаОтчета2013Кв1" Тогда
			ЗаполнитьПоказателиФормыП4_2013Кв1(ПараметрыОтчета, Контейнер);
		КонецЕсли;
	ИначеЕсли ИДОтчета = "РегламентированныйОтчетСтатистикаФормаП4НЗ" Тогда  
		Если ИДРедакцииОтчета >= "ФормаОтчета2023Кв1" Тогда
			ЗаполнитьПоказателиФормыП4НЗ_2023Кв1(ПараметрыОтчета, Контейнер);
		ИначеЕсли ИДРедакцииОтчета >= "ФормаОтчета2022Кв1" Тогда
			ЗаполнитьПоказателиФормыП4НЗ_2022Кв1(ПараметрыОтчета, Контейнер);
		ИначеЕсли ИДРедакцииОтчета >= "ФормаОтчета2021Кв1" Тогда
			ЗаполнитьПоказателиФормыП4НЗ_2021Кв1(ПараметрыОтчета, Контейнер);
		ИначеЕсли ИДРедакцииОтчета >= "ФормаОтчета2015Кв1" Тогда
			ЗаполнитьПоказателиФормыП4НЗ_2015Кв1(ПараметрыОтчета, Контейнер);
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#КонецОбласти


#Область СлужебныеПроцедурыИФункции

#Область БазовыйКонтракт

// П-4

// Получает показатели, которые могут быть заполнены при заполнении отчета.
// 
// Параметры:
//  ПоказателиОтчета - структура
//
Процедура ДобавитьПоказателиФормыП4_2013Кв1(ПоказателиОтчета)
	
	СтатистикаПерсоналаВнутренний.ДобавитьПоказателиФормыП4_2013Кв1(ПоказателиОтчета);
	
КонецПроцедуры

// Получает показатели, которые могут быть заполнены при заполнении отчета.
// 
// Параметры:
//  ПоказателиОтчета - структура
//
Процедура ДобавитьПоказателиФормыП4_2025Кв1(ПоказателиОтчета)
	
	СтатистикаПерсоналаВнутренний.ДобавитьПоказателиФормыП4_2025Кв1(ПоказателиОтчета);
	
КонецПроцедуры

// Заполняет показатели отчета.
// 
// Параметры:
//  ПараметрыОтчета - структура.
//  Контейнер - структура - содержит все показатели отчета и их значения.
//
Процедура ЗаполнитьПоказателиФормыП4_2013Кв1(ПараметрыОтчета, Контейнер)
	
	СтатистикаПерсоналаВнутренний.ЗаполнитьПоказателиФормыП4_2013Кв1(ПараметрыОтчета, Контейнер);
	
КонецПроцедуры

// Заполняет показатели отчета.
// 
// Параметры:
//  ПараметрыОтчета - структура.
//  Контейнер - структура - содержит все показатели отчета и их значения.
//
Процедура ЗаполнитьПоказателиФормыП4_2017Кв1(ПараметрыОтчета, Контейнер)
	
	СтатистикаПерсоналаВнутренний.ЗаполнитьПоказателиФормыП4_2017Кв1(ПараметрыОтчета, Контейнер);
	
КонецПроцедуры

// Заполняет показатели отчета.
// 
// Параметры:
//  ПараметрыОтчета - структура.
//  Контейнер - структура - содержит все показатели отчета и их значения.
//
Процедура ЗаполнитьПоказателиФормыП4_2022Кв1(ПараметрыОтчета, Контейнер)
	
	СтатистикаПерсоналаВнутренний.ЗаполнитьПоказателиФормыП4_2022Кв1(ПараметрыОтчета, Контейнер);
	
КонецПроцедуры

// Заполняет показатели отчета.
// 
// Параметры:
//  ПараметрыОтчета - структура.
//  Контейнер - структура - содержит все показатели отчета и их значения.
//
Процедура ЗаполнитьПоказателиФормыП4_2023Кв1(ПараметрыОтчета, Контейнер)
	
	СтатистикаПерсоналаВнутренний.ЗаполнитьПоказателиФормыП4_2023Кв1(ПараметрыОтчета, Контейнер);
	
КонецПроцедуры

// Заполняет показатели отчета.
// 
// Параметры:
//  ПараметрыОтчета - структура.
//  Контейнер - структура - содержит все показатели отчета и их значения.
//
Процедура ЗаполнитьПоказателиФормыП4_2025Кв1(ПараметрыОтчета, Контейнер)
	
	СтатистикаПерсоналаВнутренний.ЗаполнитьПоказателиФормыП4_2025Кв1(ПараметрыОтчета, Контейнер);
	
КонецПроцедуры

// П-4 (НЗ)

// Получает показатели, которые могут быть заполнены при заполнении отчета.
// 
// Параметры:
//  ПоказателиОтчета - структура
//
Процедура ДобавитьПоказателиФормыП4НЗ_2015Кв1(ПоказателиОтчета)
	
	СтатистикаПерсоналаВнутренний.ДобавитьПоказателиФормыП4НЗ_2015Кв1(ПоказателиОтчета);
	
КонецПроцедуры

// Заполняет показатели отчета.
// 
// Параметры:
//  ПараметрыОтчета - структура.
//  Контейнер - структура - содержит все показатели отчета и их значения.
//
Процедура ЗаполнитьПоказателиФормыП4НЗ_2015Кв1(ПараметрыОтчета, Контейнер)
	
	СтатистикаПерсоналаВнутренний.ЗаполнитьПоказателиФормыП4НЗ_2015Кв1(ПараметрыОтчета, Контейнер);
	
КонецПроцедуры

// Получает показатели, которые могут быть заполнены при заполнении отчета.
// 
// Параметры:
//  ПоказателиОтчета - структура
//
Процедура ДобавитьПоказателиФормыП4НЗ_2021Кв1(ПоказателиОтчета)
	
	СтатистикаПерсоналаВнутренний.ДобавитьПоказателиФормыП4НЗ_2021Кв1(ПоказателиОтчета);
	
КонецПроцедуры

// Заполняет показатели отчета.
// 
// Параметры:
//  ПараметрыОтчета - структура.
//  Контейнер - структура - содержит все показатели отчета и их значения.
//
Процедура ЗаполнитьПоказателиФормыП4НЗ_2021Кв1(ПараметрыОтчета, Контейнер)
	
	СтатистикаПерсоналаВнутренний.ЗаполнитьПоказателиФормыП4НЗ_2021Кв1(ПараметрыОтчета, Контейнер);
	
КонецПроцедуры

// Получает показатели, которые могут быть заполнены при заполнении отчета.
// 
// Параметры:
//  ПоказателиОтчета - структура
//
Процедура ДобавитьПоказателиФормыП4НЗ_2022Кв1(ПоказателиОтчета)
	
	СтатистикаПерсоналаВнутренний.ДобавитьПоказателиФормыП4НЗ_2022Кв1(ПоказателиОтчета);
	
КонецПроцедуры

// Заполняет показатели отчета.
// 
// Параметры:
//  ПараметрыОтчета - структура.
//  Контейнер - структура - содержит все показатели отчета и их значения.
//
Процедура ЗаполнитьПоказателиФормыП4НЗ_2022Кв1(ПараметрыОтчета, Контейнер)
	
	СтатистикаПерсоналаВнутренний.ЗаполнитьПоказателиФормыП4НЗ_2022Кв1(ПараметрыОтчета, Контейнер);
	
КонецПроцедуры

// Заполняет показатели отчета.
// 
// Параметры:
//  ПараметрыОтчета - структура.
//  Контейнер - структура - содержит все показатели отчета и их значения.
//
Процедура ЗаполнитьПоказателиФормыП4НЗ_2023Кв1(ПараметрыОтчета, Контейнер)
	
	СтатистикаПерсоналаВнутренний.ЗаполнитьПоказателиФормыП4НЗ_2023Кв1(ПараметрыОтчета, Контейнер);
	
КонецПроцедуры

#КонецОбласти

#КонецОбласти
