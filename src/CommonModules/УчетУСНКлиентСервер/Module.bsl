////////////////////////////////////////////////////////////////////////////////
// УчетУСНКлиентСервер: процедуры и функции для отражения документов в учете УСН,
// которые могут вызываться как на клиенте в формах документов, так и на сервере
//
////////////////////////////////////////////////////////////////////////////////

#Область ПрограммныйИнтерфейс

// Возвращает сведения о применении на указанную дату коэффициента-дефлятора
// для индексации базового лимита доходов, ограничивающих право применения УСН.
//
// Параметры:
//  Период - Дата - Дата, на которую получаем сведения об использовании дефлятора.
//
// Возвращаемое значение:
//  Булево - если Истина, то коэффициент-дефлятор применяется.
//
Функция ИспользуетсяКоэффициентДефлятор(Период) Экспорт
	
	Возврат Год(Период) < 2017 Или КоэффициентДефлятор(Период) <> 1;
	
КонецФункции

// Возвращает размер коэффициента ежегодной индексации величины дохода УСН.
//
// Параметры:
//  Период - Дата - Дата, на которую необходимо получить коэффициент.
//
// Возвращаемое значение:
//  Число
//
Функция КоэффициентДефлятор(Период) Экспорт
	
	КоэффициентДефлятор = 1;
	
	Если Год(Период) >= 2025 Тогда
		КоэффициентДефлятор = 1; // Федеральный закон от 12.07.2024 № 176-ФЗ
	ИначеЕсли Год(Период) = 2024 Тогда
		КоэффициентДефлятор = 1.329; // Приказ Минэкономразвития России от 23 октября 2023 г. N 730
	ИначеЕсли Год(Период) = 2023 Тогда
		КоэффициентДефлятор = 1.257; // Приказ Минэкономразвития России от 19 октября 2022 г. N 573
	ИначеЕсли Год(Период) = 2022 Тогда
		КоэффициентДефлятор = 1.096; // Приказ Минэкономразвития России от 28 октября 2021 г. N 654
	ИначеЕсли Год(Период) = 2021 Тогда
		// Приказ Минэкономразвития России от 30.10.2020 № 720.
		// В 2021 году в связи с появлением новых лимитов, коэффициент-дефлятор не используется
		// и начинает влиять на лимиты УСН только с 2022 года.
		// см. Письмо Минфина от 27 января 2021 г. N 03-11-06/2/4855
		КоэффициентДефлятор = 1;
	ИначеЕсли Год(Период) >= 2017 Тогда
		КоэффициентДефлятор = 1;     // Федеральный закон от 03.07.2016 N 243-ФЗ
	ИначеЕсли Год(Период) = 2016 Тогда
		КоэффициентДефлятор = 1.329; // Приказ Минэкономразвития России от 20.10.2015 № 772
	ИначеЕсли Год(Период) = 2015 Тогда
		КоэффициентДефлятор = 1.147; // приказ Минэкономразвития России от 29.10.2014 № 685
	ИначеЕсли Год(Период) = 2014 Тогда
		КоэффициентДефлятор = 1.067; // приказ Минэкономразвития России от 07.11.2013 № 652
	КонецЕсли;
	
	Возврат КоэффициентДефлятор;
	
КонецФункции

// Возвращает точность округления показателей УСН при расчете налога.
//
// Параметры:
//  ДатаРасчета - Дата - дата, на которую необходимо определить точность округления.
//
// Возвращаемое значение:
//  Число - точность округления
//
Функция РазрядностьОкругленияПоказателей(ДатаРасчета) Экспорт

	// С 1 квартала 2015 года расчет налога при выполнении "Закрытия месяца" производится в соответствии с
	// порядком заполнения деларации по УСН, опубликованным 17 декабря 2014 г. (приказ ФНС РФ № ММВ-7-3/352@):
	// промежуточные показатели, влияющие на налог и на авансовые платежи, перед расчетом округляются до целых рублей.
	//
	// Алгоритм расчета, применявшийся в регламентной операции до конца 2014 г., не изменяется.
	
	Возврат ?(ДатаРасчета >= '20150101', 0, 2);

КонецФункции

// Возвращает ставки налога УСН, указанные в НК РФ.
// Ставка УСН доходы - п. 1 ст. 346.20 НК РФ.
// Ставка УСН доходы минус расходы - п. 2 ст. 346.20 НК РФ.
// Ставка минимального налога УСН доходы минус расходы - п. 6 ст. 346.18 НК РФ.
// Повышенная ставка УСН доходы - п. 1.1 ст. 346.20 НК РФ.
// Повышенная ставка УСН доходы минус расходы - п. 2.1 ст. 346.20 НК РФ.
//
// Возвращаемое значение:
//  Структура - ставки налогов.
//    * СтавкаУСНДоходы - Число.
//    * СтавкаУСНДоходыМинусРасходы - Число.
//    * СтавкаМинимальногоНалогаУСНДоходыМинусРасходы - Число.
//    * СтавкаУСНДоходыПовышенная - Число
//    * СтавкаУСНДоходыМинусРасходыПовышенная - Число
//
Функция НалоговыеСтавкиПоУмолчанию(Период = Неопределено) Экспорт
	
	Результат = Новый Структура;
	Результат.Вставить("СтавкаУСНДоходы", 6);
	Результат.Вставить("СтавкаУСНДоходыМинусРасходы", 15);
	Результат.Вставить("СтавкаМинимальногоНалогаУСНДоходыМинусРасходы", 1);
	Если Период = Неопределено Или ДатаНачалаПрогрессивнойШкалы() <= Период Тогда
		Результат.Вставить("СтавкаУСНДоходыПовышенная", 8);
		Результат.Вставить("СтавкаУСНДоходыМинусРасходыПовышенная", 20);
	Иначе
		Результат.Вставить("СтавкаУСНДоходыПовышенная", Неопределено);
		Результат.Вставить("СтавкаУСНДоходыМинусРасходыПовышенная", Неопределено);
	КонецЕсли;
	
	Возврат Результат;
	
КонецФункции

///////////////////////////////////////////////////////////////////////////////
// Формирование Книги учета доходов и расходов

Функция ДатаНачалаФормирования4РазделаКУДиР() Экспорт
	
	Возврат Дата(2013, 1, 1);
	
КонецФункции    

// Дата, с которой отменяется формирование раздела IV "Уменьшение налога" Книги учета доходов и расходов.
// Приказ ФНС России от 07.11.2023 № ЕА-7-3/816@
// "Об утверждении форм книги учета доходов и расходов организаций
// и индивидуальных предпринимателей, применяющих упрощенную систему налогообложения,
// книги учета доходов индивидуальных предпринимателей, применяющих патентную систему
// налогообложения, и порядков их заполнения"
// 
// Возвращаемое значение:
//  Дата - 01 января 2024 года
//
Функция ДатаОтменыФормирования4РазделаКУДиР() Экспорт
	
	// Приказ ФНС России от 07.11.2023 № ЕА-7-3/816@
	Возврат Дата(2024, 1, 1);
	
КонецФункции

// Возвращает дату начала действия формы книги учета доходов по патенту
// по приказу ФНС от 07.11.2023 г. № ЕА-7-3/816@
//
// Возвращаемое значение:
//   Дата - 1 янаваря 2024 года
//
Функция ДатаНачалаДействияФормыКнигиДоходовПоПриказу_ЕА_7_3_816() Экспорт
	
	Возврат Дата(2024, 1, 1);
	
КонецФункции

// Дата начала формирования V раздела КУДиР.
// 
// Возвращаемое значение:
//  Дата - Дата начала формирования V раздела КУДиР
Функция ДатаНачалаФормирования5РазделаКУДиР() Экспорт
	
	// Приказ Минфина РФ от 07.12.2016 N 227н.
	Возврат Дата(2018, 1, 1);
	
КонецФункции

// Возвращает дату начала действия прогрессивной шкалы УСН 
// 
// Возвращаемое значение:
//  Дата 
//
Функция ДатаНачалаПрогрессивнойШкалы() Экспорт
	
	// Федеральный закон от 31.07.2020 № 266-ФЗ
	Возврат Дата(2021, 1, 1);
	
КонецФункции

#КонецОбласти
