#Область СлужебныеПроцедурыИФункции

Процедура ПодразделенияОтбораОбработкаВыбора(Форма, Элемент, ВыбранноеЗначение, СтандартнаяОбработка) Экспорт

	СтандартнаяОбработка = Ложь;

	Если ТипЗнч(ВыбранноеЗначение) = Тип("СправочникСсылка.ПодразделенияОрганизаций")
		Или ТипЗнч(ВыбранноеЗначение) = Тип("СправочникСсылка.СтруктураПредприятия") Тогда
		Массив = ОбщегоНазначенияКлиентСервер.ЗначениеВМассиве(ВыбранноеЗначение);
	ИначеЕсли ТипЗнч(ВыбранноеЗначение) = Тип("Массив") Тогда
		Если ВыбранноеЗначение.Количество() = 0 Тогда
			Возврат;
		КонецЕсли;
		Массив = ВыбранноеЗначение;
	Иначе
		Возврат;
	КонецЕсли;

	Для Каждого ЭлементМассива Из Массив Цикл
		Если ТипЗнч(ЭлементМассива) = Тип("СправочникСсылка.ПодразделенияОрганизаций") Тогда
			ЭлементСправочникаСтруктураПредприятия = 
				РегулярнаяОтправкаСотрудниковФормыВызовСервераРасширенный.ЭлементСправочникаСтруктураПредприятияПоПодразделению(ЭлементМассива);
		Иначе
			ЭлементСправочникаСтруктураПредприятия = ЭлементМассива;
		КонецЕсли;
		Если Форма.ПодразделенияОтбора.НайтиПоЗначению(ЭлементСправочникаСтруктураПредприятия) <> Неопределено Тогда
			Продолжить;
		КонецЕсли;
		Форма.ПодразделенияОтбора.Добавить(ЭлементСправочникаСтруктураПредприятия);
	КонецЦикла;

КонецПроцедуры

#КонецОбласти