#Область ПрограммныйИнтерфейс

#Область Проведение

// Описывает учетные механизмы используемые в документе для регистрации в механизме проведения.
//
// Параметры:
//  МеханизмыДокумента - Массив - список имен учетных механизмов, для которых будет выполнена
//              регистрация в механизме проведения.
//
Процедура ЗарегистрироватьУчетныеМеханизмы(МеханизмыДокумента) Экспорт
	
	//++ Локализация

	//++ НЕ УТ
	МеханизмыДокумента.Добавить("РегламентированныйУчет");
	МеханизмыДокумента.Добавить("УчетУСНПСН");
	//-- НЕ УТ

	//-- Локализация
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиСобытий

// Вызывается из соответствующего обработчика документа
//
// Параметры:
//  Объект - ДокументОбъект - Обрабатываемый документ.
//  Отказ - Булево - Признак проведения документа.
//                   Если в теле процедуры-обработчика установить данному параметру значение Истина,
//                   то проведение документа выполнено не будет.
//  РежимПроведения - РежимПроведенияДокумента - В данный параметр передается текущий режим проведения.
//
Процедура ОбработкаПроведения(Объект, Отказ, РежимПроведения) Экспорт
	
	
КонецПроцедуры

// Вызывается из соответствующего обработчика документа
//
// Параметры:
//  Объект - ДокументОбъект - Обрабатываемый объект
//  Отказ - Булево - Если в теле процедуры-обработчика установить данному параметру значение Истина,
//                   то будет выполнен отказ от продолжения работы после выполнения проверки заполнения.
//  ПроверяемыеРеквизиты - Массив - Массив путей к реквизитам, для которых будет выполнена проверка заполнения.
//
Процедура ОбработкаПроверкиЗаполнения(Объект, Отказ, ПроверяемыеРеквизиты) Экспорт
	
	
КонецПроцедуры

// Вызывается из соответствующего обработчика документа
//
// Параметры:
//  Объект - ДокументОбъект - Обрабатываемый объект.
//  ДанныеЗаполнения - Произвольный - Значение, которое используется как основание для заполнения.
//  СтандартнаяОбработка - Булево - В данный параметр передается признак выполнения стандартной (системной) обработки события.
//
Процедура ОбработкаЗаполнения(Объект, ДанныеЗаполнения, СтандартнаяОбработка) Экспорт
	
	
КонецПроцедуры

// Вызывается из соответствующего обработчика документа
//
// Параметры:
//  Объект - ДокументОбъект - Обрабатываемый объект
//  Отказ - Булево - Признак отказа от записи.
//                   Если в теле процедуры-обработчика установить данному параметру значение Истина,
//                   то запись выполнена не будет и будет вызвано исключение.
//
Процедура ОбработкаУдаленияПроведения(Объект, Отказ) Экспорт
	
	
КонецПроцедуры

// Вызывается из соответствующего обработчика документа
//
// Параметры:
//  Объект - ДокументОбъект - Обрабатываемый объект
//  Отказ - Булево - Признак отказа от записи.
//                   Если в теле процедуры-обработчика установить данному параметру значение Истина,
//                   то запись выполнена не будет и будет вызвано исключение.
//  РежимЗаписи - РежимЗаписиДокумента - В параметр передается текущий режим записи документа. Позволяет определить в теле процедуры режим записи.
//  РежимПроведения - РежимПроведенияДокумента - В данный параметр передается текущий режим проведения.
//
Процедура ПередЗаписью(Объект, Отказ, РежимЗаписи, РежимПроведения) Экспорт
	
	
КонецПроцедуры

// Вызывается из соответствующего обработчика документа
//
// Параметры:
//  Объект - ДокументОбъект - Обрабатываемый объект
//  Отказ - Булево - Признак отказа от записи.
//                   Если в теле процедуры-обработчика установить данному параметру значение Истина, то запись выполнена не будет и будет вызвано исключение.
//
Процедура ПриЗаписи(Объект, Отказ) Экспорт
	
	
КонецПроцедуры

// Вызывается из соответствующего обработчика документа
//
// Параметры:
//  Объект - ДокументОбъект - Обрабатываемый объект
//  ОбъектКопирования - ДокументОбъект.КорректировкаЗадолженности - Исходный документ, который является источником копирования.
//
Процедура ПриКопировании(Объект, ОбъектКопирования) Экспорт
	
	
КонецПроцедуры

#КонецОбласти

#Область ПодключаемыеКоманды

// Определяет список команд создания на основании.
//
// Параметры:
//  КомандыСозданияНаОсновании - см. СозданиеНаОснованииПереопределяемый.ПередДобавлениемКомандСозданияНаОсновании.КомандыСозданияНаОсновании
//  Параметры - см. СозданиеНаОснованииПереопределяемый.ПередДобавлениемКомандСозданияНаОсновании.Параметры
//
Процедура ДобавитьКомандыСозданияНаОсновании(КомандыСозданияНаОсновании, Параметры) Экспорт
	
	//++ Локализация
	Документы.СчетФактураНалоговыйАгент.ДобавитьКомандуСоздатьНаОсновании(КомандыСозданияНаОсновании);
	//-- Локализация
	
КонецПроцедуры

// Добавляет команду создания документа "Авансовый отчет".
//
// Параметры:
//  КомандыСозданияНаОсновании - см. СозданиеНаОснованииПереопределяемый.ПередДобавлениемКомандСозданияНаОсновании.КомандыСозданияНаОсновании
//
Процедура ДобавитьКомандуСоздатьНаОсновании(КомандыСозданияНаОсновании) Экспорт


КонецПроцедуры

// Определяет список команд отчетов.
//
// Параметры:
//   КомандыОтчетов - См. ВариантыОтчетовПереопределяемый.ПередДобавлениемКомандОтчетов.КомандыОтчетов
//   Параметры - См. ВариантыОтчетовПереопределяемый.ПередДобавлениемКомандОтчетов.Параметры
//
Процедура ДобавитьКомандыОтчетов(КомандыОтчетов, Параметры) Экспорт
	
	
КонецПроцедуры

// Заполняет список команд печати.
//
// Параметры:
//   КомандыПечати - см. УправлениеПечатью.СоздатьКоллекциюКомандПечати
//
Процедура ДобавитьКомандыПечати(КомандыПечати) Экспорт
	
	
КонецПроцедуры

#КонецОбласти

#Область Печать

// Формирует печатные формы.
//
// Параметры:
//  МассивОбъектов  - Массив    - ссылки на объекты, которые нужно распечатать;
//  ПараметрыПечати - Структура - дополнительные настройки печати;
//  КоллекцияПечатныхФорм - ТаблицаЗначений - сформированные табличные документы (выходной параметр)
//  ОбъектыПечати         - СписокЗначений  - значение - ссылка на объект;
//                                            представление - имя области в которой был выведен объект (выходной параметр);
//  ПараметрыВывода       - Структура       - дополнительные параметры сформированных табличных документов (выходной параметр).
//
Процедура Печать(МассивОбъектов, ПараметрыПечати, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт
	
	
КонецПроцедуры

#КонецОбласти

//++ НЕ УТ
#Область ПроводкиРегУчета

// Функция возвращает текст запроса для отражения документа в регламентированном учете.
//
// Возвращаемое значение:
//	Строка - Текст запроса
//
Функция ТекстОтраженияВРеглУчете() Экспорт

	ТекстыОтражения = Новый Массив;
	//++ Локализация

#Область ТекстРезервыПоСомнительнымДолгамСКлиентом
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Списание задолженности покупателя за счет резервов (Дт <63> :: Кт <62.1>)
	|
	|	Операция.Ссылка КАК Ссылка,
	|	Операция.Дата КАК Период,
	|	Операция.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Резервы.СуммаРегл КАК Сумма,
	|	Резервы.СуммаУпр КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПоСомнительнымДолгам) КАК ВидСчетаДт,
	|	Резервы.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	Резервы.Подразделение КАК МестоУчетаДт,
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВалютаДт,
	|	Резервы.Подразделение КАК ПодразделениеДт,
	|	Резервы.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	Расчеты.Контрагент КАК СубконтоДт1,
	|	Расчеты.Договор КАК СубконтоДт2,
	|	Резервы.РасчетныйДокумент КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	Резервы.СуммаРегл - Резервы.ПостояннаяРазница - Резервы.ВременнаяРазница КАК СуммаНУДт,
	|	Резервы.ПостояннаяРазница КАК СуммаПРДт,
	|	Резервы.ВременнаяРазница КАК СуммаВРДт,
	|
	|	ВЫБОР КОГДА Расчеты.ДолгРегл <> 0 ТОГДА
	|		ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами)
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыПолученные)
	|	КОНЕЦ КАК ВидСчетаКт,
	|
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	Расчеты.Валюта КАК ВалютаКт,
	|	Расчеты.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Расчеты.Контрагент КАК СубконтоКт1,
	|	Расчеты.Договор КАК СубконтоКт2,
	|
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	// Валютная сумма целиком отражается в первой проводке резерва.
	|	
	|	ВЫБОР КОГДА РезервыПервые.Ссылка ЕСТЬ NULL ТОГДА 0 ИНАЧЕ Расчеты.Предоплата + Расчеты.Долг КОНЕЦ КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Списание задолженности покупателя за счет резервов по сомнительным долгам"" КАК Содержание
	|
	|ИЗ 
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.КорректировкаЗадолженности КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСКлиентамиПоДокументам КАК Расчеты
	|	ПО
	|		Операция.Ссылка = Расчеты.Ссылка
	|		И Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл <> 0
	|		И Расчеты.СтарыйАлгоритм
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РезервыПоСомнительнымДолгам_ПоАналитике КАК Резервы
	|	ПО
	|		Расчеты.Ссылка = Резервы.Ссылка
	|		И Расчеты.ОбъектРасчетов = Резервы.ОбъектРасчетов
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		РезервыПоСомнительнымДолгам_ПоОбъектамРасчета КАК РезервыПервые
	|	ПО
	|		Резервы.Ссылка = РезервыПервые.Ссылка
	|		И Резервы.НомерСтроки = РезервыПервые.НомерСтроки
	|ГДЕ
	|	Операция.ХозяйственнаяОперация В (
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеДебиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеБезнадежнойЗадолженностиЗаСчетРезервовПоСомнительнымДолгам))
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ //// Списание задолженности покупателя за счет резервов (Дт <63> :: Кт <62.1>)
	|
	|	Операция.Ссылка КАК Ссылка,
	|	Операция.Дата КАК Период,
	|	Операция.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Резервы.СуммаРегл КАК Сумма,
	|	Резервы.СуммаУпр КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПоСомнительнымДолгам) КАК ВидСчетаДт,
	|	ЕСТЬNULL(Резервы.ОбъектРасчетов.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка)) КАК АналитикаУчетаДт,
	|	Резервы.ОбъектРасчетов.Подразделение КАК МестоУчетаДт,
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВалютаДт,
	|	Резервы.ОбъектРасчетов.Подразделение КАК ПодразделениеДт,
	|	Резервы.ОбъектРасчетов.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	Расчеты.Контрагент КАК СубконтоДт1,
	|	Расчеты.Договор КАК СубконтоДт2,
	|	Резервы.РасчетныйДокумент КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	Резервы.СуммаРегл - Резервы.ПостояннаяРазница - Резервы.ВременнаяРазница КАК СуммаНУДт,
	|	Резервы.ПостояннаяРазница КАК СуммаПРДт,
	|	Резервы.ВременнаяРазница КАК СуммаВРДт,
	|
	|	Расчеты.ВидСчета КАК ВидСчетаКт,
	|
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	Расчеты.Валюта КАК ВалютаКт,
	|	Расчеты.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Расчеты.Контрагент КАК СубконтоКт1,
	|	Расчеты.Договор КАК СубконтоКт2,
	|
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	// Валютная сумма целиком отражается в первой проводке резерва.
	|	
	|	Расчеты.Сумма КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Списание задолженности покупателя за счет резервов по сомнительным долгам"" КАК Содержание
	|
	|ИЗ 
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.КорректировкаЗадолженности КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСКлиентамиНоваяАрхитектураДетально КАК Расчеты
	|	ПО
	|		Операция.Ссылка = Расчеты.Ссылка
	|		И Расчеты.СуммаРегл <> 0
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.РезервыПоСомнительнымДолгам КАК Резервы
	|	ПО
	|		Резервы.Регистратор = Расчеты.Ссылка
	|		И Резервы.РасчетныйДокумент = Расчеты.РасчетныйДокумент
	|		И Резервы.ИдентификаторФинЗаписи = Расчеты.ИдентификаторФинЗаписи
	|	
	|ГДЕ
	|	Операция.ХозяйственнаяОперация В (
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеДебиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеБезнадежнойЗадолженностиЗаСчетРезервовПоСомнительнымДолгам))
	|";
	ТекстыОтражения.Добавить(ТекстЗапроса);
#КонецОбласти

#Область ТекстСписаниеДебиторскойЗадолженностиРасчетыСКлиентомСтарое
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Списание задолженности покупателя на расходы, прочие активы Дт <91.2, Прочие счета> :: Кт <62.1>)
	|
	|	Операция.Ссылка КАК Ссылка,
	|	Операция.Дата КАК Период,
	|	Операция.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл - ЕСТЬNULL(Резервы.СуммаРегл, 0) КАК Сумма,
	|	Расчеты.ПредоплатаУпр + Расчеты.ДолгУпр - ЕСТЬNULL(Резервы.СуммаУпр, 0) КАК СуммаУУ,
	|
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеОперации)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы)
	|	КОНЕЦ КАК ВидСчетаДт,
	|	ДоходыРасходы.Статья КАК АналитикаУчетаДт,
	|	ДоходыРасходы.Подразделение КАК МестоУчетаДт,
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВалютаДт,
	|	ДоходыРасходы.Подразделение КАК ПодразделениеДт,
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы)
	|		ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|		ИНАЧЕ Расчеты.НаправлениеДеятельности
	|	КОНЕЦ КАК НаправлениеДеятельностиДт,
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы)
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ДоходыРасходы.Статья
	|	КОНЕЦ КАК СубконтоДт1,
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы)
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ДоходыРасходы.АналитикаРасходов 
	|	КОНЕЦ КАК СубконтоДт2,
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы)
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		КОГДА СтатьиРасходов.ВариантРаспределенияРасходовРегл <> ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее)
	|		КОГДА ОбъектыСтроительства.СпособСтроительства <> ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.ПустаяСсылка)
	|		ТОГДА ОбъектыСтроительства.СпособСтроительства
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.Подрядный)
	|	КОНЕЦ КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл - ЕСТЬNULL(Резервы.СуммаРегл, 0) + ЕСТЬNULL(Резервы.ПостояннаяРазница, 0) + ЕСТЬNULL(Резервы.ВременнаяРазница, 0) КАК СуммаНУДт,
	|	-ЕСТЬNULL(Резервы.ПостояннаяРазница, 0) КАК СуммаПРДт,
	|	-ЕСТЬNULL(Резервы.ВременнаяРазница, 0) КАК СуммаВРДт,
	|
	|	ВЫБОР КОГДА Расчеты.ДолгРегл <> 0 ТОГДА
	|		ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами)
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыПолученные)
	|	КОНЕЦ КАК ВидСчетаКт,
	|
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	Расчеты.Валюта КАК ВалютаКт,
	|	Расчеты.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Расчеты.Контрагент КАК СубконтоКт1,
	|	Расчеты.Договор КАК СубконтоКт2,
	|
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	ВЫБОР КОГДА Резервы.Ссылка ЕСТЬ NULL ТОГДА Расчеты.Предоплата + Расчеты.Долг ИНАЧЕ 0 КОНЕЦ КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы)
	|		ТОГДА ""Списание задолженности покупателя на прочие активы""
	|		ИНАЧЕ ""Списание задолженности покупателя на расходы""
	|	КОНЕЦ КАК Содержание
	|
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.КорректировкаЗадолженности КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		Документ.КорректировкаЗадолженности.ДоходыРасходыАктивыПассивы КАК ДоходыРасходы
	|	ПО 
	|		ДокументыКОтражению.Ссылка = ДоходыРасходы.Ссылка 
	|		И ДоходыРасходы.НомерСтроки = 1
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиРасходов
	|	ПО
	|		ДоходыРасходы.Статья = СтатьиРасходов.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСКлиентамиПоДокументам КАК Расчеты
	|	ПО
	|		Операция.Ссылка = Расчеты.Ссылка
	|		И Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл <> 0
	|		И Расчеты.СтарыйАлгоритм
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		РезервыПоСомнительнымДолгам_ПоОбъектамРасчета КАК Резервы
	|	ПО
	|		Расчеты.Ссылка = Резервы.Ссылка
	|		И Расчеты.ОбъектРасчетов = Резервы.ОбъектРасчетов
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		Справочник.ОбъектыСтроительства КАК ОбъектыСтроительства
	|	ПО
	|		ОбъектыСтроительства.Ссылка = ДоходыРасходы.АналитикаРасходов
	|		И СтатьиРасходов.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|ГДЕ
	|	Операция.ХозяйственнаяОперация В (
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеДебиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеБезнадежнойЗадолженностиЗаСчетРезервовПоСомнительнымДолгам))
	|";
	ТекстыОтражения.Добавить(ТекстЗапроса);
#КонецОбласти

#Область ТекстСписаниеДебиторскойЗадолженностиРасчетыСКлиентомНаСтатьиАктивовПассивовСтарое
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Списание задолженности покупателя на прочие активы пассивы ( :: Кт <62.1>)
	|
	|	Операция.Ссылка КАК Ссылка,
	|	Операция.Дата КАК Период,
	|	Операция.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл - ЕСТЬNULL(Резервы.СуммаРегл, 0) КАК Сумма,
	|	Расчеты.ПредоплатаУпр + Расчеты.ДолгУпр - ЕСТЬNULL(Резервы.СуммаУпр, 0) КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеАктивыПассивы) КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|	
	|	Расчеты.Валюта КАК ВалютаДт,
	|	ДоходыРасходы.Подразделение КАК ПодразделениеДт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	НастройкиСчетовУчета.СчетУчета КАК СчетДт,
	|
	|	НастройкиСчетовУчета.Субконто1 КАК СубконтоДт1,
	|	НастройкиСчетовУчета.Субконто2 КАК СубконтоДт2,
	|	НастройкиСчетовУчета.Субконто3 КАК СубконтоДт3,
	|
	|	ВЫБОР КОГДА Резервы.Ссылка ЕСТЬ NULL ТОГДА Расчеты.Предоплата + Расчеты.Долг ИНАЧЕ 0 КОНЕЦ КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл - ЕСТЬNULL(Резервы.СуммаРегл, 0) + ЕСТЬNULL(Резервы.ПостояннаяРазница, 0) + ЕСТЬNULL(Резервы.ВременнаяРазница, 0) КАК СуммаНУДт,
	|	-ЕСТЬNULL(Резервы.ПостояннаяРазница, 0) КАК СуммаПРДт,
	|	-ЕСТЬNULL(Резервы.ВременнаяРазница, 0) КАК СуммаВРДт,
	|
	|	ВЫБОР КОГДА Расчеты.ДолгРегл <> 0 ТОГДА
	|		ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами)
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыПолученные)
	|	КОНЕЦ КАК ВидСчетаКт,
	|
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	Расчеты.Валюта КАК ВалютаКт,
	|	Расчеты.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Расчеты.Контрагент КАК СубконтоКт1,
	|	Расчеты.Договор КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	ВЫБОР КОГДА Резервы.Ссылка ЕСТЬ NULL ТОГДА Расчеты.Предоплата + Расчеты.Долг ИНАЧЕ 0 КОНЕЦ КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Списание задолженности покупателя на активы\пассивы"" КАК Содержание
	|
	|ИЗ 
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.КорректировкаЗадолженности КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		Документ.КорректировкаЗадолженности.ДоходыРасходыАктивыПассивы КАК ДоходыРасходы
	|	ПО 
	|		ДокументыКОтражению.Ссылка = ДоходыРасходы.Ссылка 
	|		И ДоходыРасходы.НомерСтроки = 1
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ПланВидовХарактеристик.СтатьиАктивовПассивов КАК СтатьиАктивовПассивов
	|	ПО
	|		ДоходыРасходы.Статья = СтатьиАктивовПассивов.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		Справочник.НастройкиСчетовУчетаПрочихОпераций КАК НастройкиСчетовУчета
	|	ПО
	|		ДоходыРасходы.НастройкаСчетовУчета = НастройкиСчетовУчета.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСКлиентамиПоДокументам КАК Расчеты
	|	ПО
	|		Операция.Ссылка = Расчеты.Ссылка
	|		И Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл <> 0
	|		И Расчеты.СтарыйАлгоритм
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		РезервыПоСомнительнымДолгам_ПоОбъектамРасчета КАК Резервы
	|	ПО
	|		Расчеты.Ссылка = Резервы.Ссылка
	|		И Расчеты.ОбъектРасчетов = Резервы.ОбъектРасчетов
	|	
	|ГДЕ
	|	Операция.ХозяйственнаяОперация В (
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеДебиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеБезнадежнойЗадолженностиЗаСчетРезервовПоСомнительнымДолгам))
	|";
	ТекстыОтражения.Добавить(ТекстЗапроса);
#КонецОбласти

#Область ТекстРезервыПоСомнительнымДолгамСПоставщиком
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Списание задолженности поставщика за счет резервов (Дт <63> :: Кт <60.2>)
	|
	|	Операция.Ссылка КАК Ссылка,
	|	Операция.Дата КАК Период,
	|	Операция.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Резервы.СуммаРегл КАК Сумма,
	|	Резервы.СуммаУпр КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПоСомнительнымДолгам) КАК ВидСчетаДт,
	|	Резервы.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	Резервы.Подразделение КАК МестоУчетаДт,
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВалютаДт,
	|	Резервы.Подразделение КАК ПодразделениеДт,
	|	Резервы.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	Расчеты.Контрагент КАК СубконтоДт1,
	|	Расчеты.Договор КАК СубконтоДт2,
	|	Резервы.РасчетныйДокумент КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	Резервы.СуммаРегл - Резервы.ПостояннаяРазница - Резервы.ВременнаяРазница КАК СуммаНУДт,
	|	Резервы.ПостояннаяРазница КАК СуммаПРДт,
	|	Резервы.ВременнаяРазница КАК СуммаВРДт,
	|
	|
	|	ВЫБОР КОГДА Расчеты.ДолгРегл <> 0 ТОГДА
	|		ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками)
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыВыданные)
	|	КОНЕЦ КАК ВидСчетаКт,
	|
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	Расчеты.Валюта КАК ВалютаКт,
	|	Расчеты.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Расчеты.Контрагент КАК СубконтоКт1,
	|	Расчеты.Договор КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	ВЫБОР КОГДА Резервы.Ссылка ЕСТЬ NULL ТОГДА Расчеты.Предоплата + Расчеты.Долг ИНАЧЕ 0 КОНЕЦ КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Списание задолженности поставщика за счет резервов по сомнительным долгам"" КАК Содержание
	|
	|ИЗ 
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.КорректировкаЗадолженности КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСПоставщикамиПоДокументам КАК Расчеты
	|	ПО
	|		Операция.Ссылка = Расчеты.Ссылка
	|		И Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл <> 0
	|		И Расчеты.СтарыйАлгоритм
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РезервыПоСомнительнымДолгам_ПоАналитике КАК Резервы
	|	ПО
	|		Расчеты.Ссылка = Резервы.Ссылка
	|		И Расчеты.ОбъектРасчетов = Резервы.ОбъектРасчетов
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		РезервыПоСомнительнымДолгам_ПоОбъектамРасчета КАК РезервыПервые
	|	ПО
	|		Резервы.Ссылка = РезервыПервые.Ссылка
	|		И Резервы.НомерСтроки = РезервыПервые.НомерСтроки
	|ГДЕ
	|	Операция.ХозяйственнаяОперация В (
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеДебиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеБезнадежнойЗадолженностиЗаСчетРезервовПоСомнительнымДолгам))
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ //// Списание задолженности поставщика за счет резервов (Дт <63> :: Кт <60.2>)
	|
	|	Операция.Ссылка КАК Ссылка,
	|	Операция.Дата КАК Период,
	|	Операция.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Резервы.СуммаРегл КАК Сумма,
	|	Резервы.СуммаУпр КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РезервыПоСомнительнымДолгам) КАК ВидСчетаДт,
	|	ЕСТЬNULL(Резервы.ОбъектРасчетов.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка)) КАК АналитикаУчетаДт,
	|	Резервы.ОбъектРасчетов.Подразделение КАК МестоУчетаДт,
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВалютаДт,
	|	Резервы.ОбъектРасчетов.Подразделение КАК ПодразделениеДт,
	|	Резервы.ОбъектРасчетов.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	Расчеты.Контрагент КАК СубконтоДт1,
	|	Расчеты.Договор КАК СубконтоДт2,
	|	Резервы.РасчетныйДокумент КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	Резервы.СуммаРегл - Резервы.ПостояннаяРазница - Резервы.ВременнаяРазница КАК СуммаНУДт,
	|	Резервы.ПостояннаяРазница КАК СуммаПРДт,
	|	Резервы.ВременнаяРазница КАК СуммаВРДт,
	|
	|
	|	Расчеты.ВидСчета КАК ВидСчетаКт,
	|
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	Расчеты.Валюта КАК ВалютаКт,
	|	Расчеты.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Расчеты.Контрагент КАК СубконтоКт1,
	|	Расчеты.Договор КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	Расчеты.Сумма КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Списание задолженности поставщика за счет резервов по сомнительным долгам"" КАК Содержание
	|
	|ИЗ 
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.КорректировкаЗадолженности КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСПоставщикамиНоваяАрхитектураДетально КАК Расчеты
	|	ПО
	|		Операция.Ссылка = Расчеты.Ссылка
	|		И Расчеты.СуммаРегл <> 0
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.РезервыПоСомнительнымДолгам КАК Резервы
	|	ПО
	|		Резервы.Регистратор = Расчеты.Ссылка
	|		И Резервы.ИдентификаторФинЗаписи = Расчеты.ИдентификаторФинЗаписи
	|	
	|ГДЕ
	|	Операция.ХозяйственнаяОперация В (
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеДебиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеБезнадежнойЗадолженностиЗаСчетРезервовПоСомнительнымДолгам))
	|";
	ТекстыОтражения.Добавить(ТекстЗапроса);
#КонецОбласти

#Область ТекстСписаниеДебиторскойЗадолженностиРасчетыСПоставщикомСтарое
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Списание задолженности поставщика на расходы (Дт <91.2, Прочие счета> :: Кт <60.2>)
	|
	|	Операция.Ссылка КАК Ссылка,
	|	Операция.Дата КАК Период,
	|	Операция.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл - ЕСТЬNULL(Резервы.СуммаРегл, 0) КАК Сумма,
	|	Расчеты.ПредоплатаУпр + Расчеты.ДолгУпр - ЕСТЬNULL(Резервы.СуммаУпр, 0) КАК СуммаУУ,
	|
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеОперации)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы)
	|	КОНЕЦ КАК ВидСчетаДт,
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы)
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ДоходыРасходы.Статья
	|	КОНЕЦ КАК АналитикаУчетаДт,
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы)
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ДоходыРасходы.Подразделение
	|	КОНЕЦ КАК МестоУчетаДт,
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВалютаДт,
	|	ДоходыРасходы.Подразделение КАК ПодразделениеДт,
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы)
	|		ТОГДА ЗНАЧЕНИЕ(Справочник.НаправленияДеятельности.ПустаяСсылка)
	|		ИНАЧЕ Расчеты.НаправлениеДеятельности
	|	КОНЕЦ КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетДт,
	|
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы)
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ДоходыРасходы.Статья
	|	КОНЕЦ КАК СубконтоДт1,
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы)
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ДоходыРасходы.АналитикаРасходов
	|	КОНЕЦ КАК СубконтоДт2,
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы)
	|		ТОГДА НЕОПРЕДЕЛЕНО
	|		КОГДА СтатьиРасходов.ВариантРаспределенияРасходовРегл <> ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее)
	|		КОГДА ОбъектыСтроительства.СпособСтроительства <> ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.ПустаяСсылка)
	|		ТОГДА ОбъектыСтроительства.СпособСтроительства
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.Подрядный)
	|	КОНЕЦ КАК СубконтоДт3,
	|
	|	0 КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл - ЕСТЬNULL(Резервы.СуммаРегл, 0) + ЕСТЬNULL(Резервы.ПостояннаяРазница, 0) + ЕСТЬNULL(Резервы.ВременнаяРазница, 0) КАК СуммаНУДт,
	|	-ЕСТЬNULL(Резервы.ПостояннаяРазница, 0) КАК СуммаПРДт,
	|	-ЕСТЬNULL(Резервы.ВременнаяРазница, 0) КАК СуммаВРДт,
	|
	|
	|	ВЫБОР
	|		КОГДА Расчеты.ДолгРегл <> 0
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками)
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыВыданные)
	|	КОНЕЦ КАК ВидСчетаКт,
	|
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	Расчеты.Валюта КАК ВалютаКт,
	|	Расчеты.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Расчеты.Контрагент КАК СубконтоКт1,
	|	Расчеты.Договор КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	ВЫБОР КОГДА Резервы.Ссылка ЕСТЬ NULL ТОГДА Расчеты.Предоплата + Расчеты.Долг ИНАЧЕ 0 КОНЕЦ КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы)
	|		ТОГДА ""Списание задолженности поставщика на прочие активы""
	|		ИНАЧЕ ""Списание задолженности поставщика на расходы""
	|	КОНЕЦ КАК Содержание
	|
	|ИЗ 
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.КорректировкаЗадолженности КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		Документ.КорректировкаЗадолженности.ДоходыРасходыАктивыПассивы КАК ДоходыРасходы
	|	ПО 
	|		ДокументыКОтражению.Ссылка = ДоходыРасходы.Ссылка 
	|		И ДоходыРасходы.НомерСтроки = 1
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиРасходов
	|	ПО
	|		ДоходыРасходы.Статья = СтатьиРасходов.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСПоставщикамиПоДокументам КАК Расчеты
	|	ПО
	|		Операция.Ссылка = Расчеты.Ссылка
	|		И Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл <> 0
	|		И Расчеты.СтарыйАлгоритм
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		РезервыПоСомнительнымДолгам_ПоОбъектамРасчета КАК Резервы
	|	ПО
	|		Расчеты.Ссылка = Резервы.Ссылка
	|		И Расчеты.ОбъектРасчетов = Резервы.ОбъектРасчетов
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		Справочник.ОбъектыСтроительства КАК ОбъектыСтроительства
	|	ПО
	|		ОбъектыСтроительства.Ссылка = ДоходыРасходы.АналитикаРасходов
	|		И СтатьиРасходов.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|ГДЕ
	|	Операция.ХозяйственнаяОперация В (
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеДебиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеБезнадежнойЗадолженностиЗаСчетРезервовПоСомнительнымДолгам))
	|";
	ТекстыОтражения.Добавить(ТекстЗапроса);
#КонецОбласти

#Область ТекстСписаниеДебиторскойЗадолженностиРасчетыСПоставщикомНаСтатьиАктивовПассивовСтарое
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Списание задолженности поставщика на прочие активы пассивы (:: Кт <60.2>)
	|
	|	Операция.Ссылка КАК Ссылка,
	|	Операция.Дата КАК Период,
	|	Операция.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл - ЕСТЬNULL(Резервы.СуммаРегл, 0) КАК Сумма,
	|	Расчеты.ПредоплатаУпр + Расчеты.ДолгУпр - ЕСТЬNULL(Резервы.СуммаУпр, 0) КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеАктивыПассивы) КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|	
	|	Расчеты.Валюта КАК ВалютаДт,
	|	ДоходыРасходы.Подразделение КАК ПодразделениеДт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	НастройкиСчетовУчета.СчетУчета КАК СчетДт,
	|
	|	НастройкиСчетовУчета.Субконто1 КАК СубконтоДт1,
	|	НастройкиСчетовУчета.Субконто2 КАК СубконтоДт2,
	|	НастройкиСчетовУчета.Субконто3 КАК СубконтоДт3,
	|
	|	ВЫБОР КОГДА Резервы.Ссылка ЕСТЬ NULL ТОГДА Расчеты.Предоплата + Расчеты.Долг ИНАЧЕ 0 КОНЕЦ КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл - ЕСТЬNULL(Резервы.СуммаРегл, 0) + ЕСТЬNULL(Резервы.ПостояннаяРазница, 0) + ЕСТЬNULL(Резервы.ВременнаяРазница, 0) КАК СуммаНУДт,
	|	-ЕСТЬNULL(Резервы.ПостояннаяРазница, 0) КАК СуммаПРДт,
	|	-ЕСТЬNULL(Резервы.ВременнаяРазница, 0) КАК СуммаВРДт,
	|
	|
	|	ВЫБОР КОГДА Расчеты.ДолгРегл <> 0 ТОГДА
	|		ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками)
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыВыданные)
	|	КОНЕЦ КАК ВидСчетаКт,
	|
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	Расчеты.Валюта КАК ВалютаКт,
	|	Расчеты.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Расчеты.Контрагент КАК СубконтоКт1,
	|	Расчеты.Договор КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	ВЫБОР КОГДА Резервы.Ссылка ЕСТЬ NULL ТОГДА Расчеты.Предоплата + Расчеты.Долг ИНАЧЕ 0 КОНЕЦ КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Списание задолженности поставщика на активы\пассивы"" КАК Содержание
	|
	|ИЗ 
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.КорректировкаЗадолженности КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		Документ.КорректировкаЗадолженности.ДоходыРасходыАктивыПассивы КАК ДоходыРасходы
	|	ПО 
	|		ДокументыКОтражению.Ссылка = ДоходыРасходы.Ссылка 
	|		И ДоходыРасходы.НомерСтроки = 1
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ПланВидовХарактеристик.СтатьиАктивовПассивов КАК СтатьиАктивовПассивов
	|	ПО
	|		ДоходыРасходы.Статья = СтатьиАктивовПассивов.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		Справочник.НастройкиСчетовУчетаПрочихОпераций КАК НастройкиСчетовУчета
	|	ПО
	|		ДоходыРасходы.НастройкаСчетовУчета = НастройкиСчетовУчета.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСПоставщикамиПоДокументам КАК Расчеты
	|	ПО
	|		Операция.Ссылка = Расчеты.Ссылка
	|		И Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл <> 0
	|		И Расчеты.СтарыйАлгоритм
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		РезервыПоСомнительнымДолгам_ПоОбъектамРасчета КАК Резервы
	|	ПО
	|		Расчеты.Ссылка = Резервы.Ссылка
	|		И Расчеты.ОбъектРасчетов = Резервы.ОбъектРасчетов
	|
	|ГДЕ 
	|	Операция.ХозяйственнаяОперация В (
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеДебиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеБезнадежнойЗадолженностиЗаСчетРезервовПоСомнительнымДолгам))
	|";
	ТекстыОтражения.Добавить(ТекстЗапроса);
#КонецОбласти

#Область ТекстСписаниеКредиторскойЗадолженностиРасчетыСКлиентомСтарое
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Списание задолженности перед покупателем в доходы (Дт <62.2> :: Кт <91.1>)
	|
	|	Операция.Ссылка КАК Ссылка,
	|	Операция.Дата КАК Период,
	|	Операция.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл КАК Сумма,
	|	Расчеты.ПредоплатаУпр + Расчеты.ДолгУпр КАК СуммаУУ,
	|
	|	ВЫБОР КОГДА Расчеты.ДолгРегл <> 0 ТОГДА
	|		ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами)
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыПолученные)
	|	КОНЕЦ КАК ВидСчетаДт,
	|
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	Расчеты.Валюта КАК ВалютаДт,
	|	Расчеты.Подразделение КАК ПодразделениеДт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	Расчеты.Контрагент КАК СубконтоДт1,
	|	Расчеты.Договор КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	Расчеты.Предоплата + Расчеты.Долг КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Доходы) КАК ВидСчетаКт,
	|	ДоходыРасходы.Статья КАК АналитикаУчетаКт,
	|	ДоходыРасходы.Подразделение КАК МестоУчетаКт,
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВалютаКт,
	|	ДоходыРасходы.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	ДоходыРасходы.Статья КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Списание задолженности перед покупателем в доходы"" КАК Содержание
	|
	|ИЗ 
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.КорректировкаЗадолженности КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		Документ.КорректировкаЗадолженности.ДоходыРасходыАктивыПассивы КАК ДоходыРасходы
	|	ПО 
	|		ДокументыКОтражению.Ссылка = ДоходыРасходы.Ссылка 
	|		И ДоходыРасходы.НомерСтроки = 1
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСКлиентамиПоДокументам КАК Расчеты
	|	ПО
	|		Операция.Ссылка = Расчеты.Ссылка
	|		И Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл <> 0
	|		И Расчеты.СтарыйАлгоритм
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ПланВидовХарактеристик.СтатьиДоходов КАК СтатьиДоходов
	|	ПО
	|		ДоходыРасходы.Статья = СтатьиДоходов.Ссылка
	|
	|ГДЕ
	|	Операция.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеКредиторскойЗадолженности)
	|";
	ТекстыОтражения.Добавить(ТекстЗапроса);
#КонецОбласти

#Область ТекстСписаниеКредиторскойЗадолженностиРасчетыСКлиентомНаСтатьиАктивовПассивовСтарое
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Списание задолженности перед покупателем в прочие активы пассивы (Дт <62.2> :: )
	|
	|	Операция.Ссылка КАК Ссылка,
	|	Операция.Дата КАК Период,
	|	Операция.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл КАК Сумма,
	|	Расчеты.ПредоплатаУпр + Расчеты.ДолгУпр КАК СуммаУУ,
	|
	|	ВЫБОР КОГДА Расчеты.ДолгРегл <> 0 ТОГДА
	|		ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами)
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыПолученные)
	|	КОНЕЦ КАК ВидСчетаДт,
	|
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	Расчеты.Валюта КАК ВалютаДт,
	|	Расчеты.Подразделение КАК ПодразделениеДт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	Расчеты.Контрагент КАК СубконтоДт1,
	|	Расчеты.Договор КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	Расчеты.Предоплата + Расчеты.Долг КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеАктивыПассивы) КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	Расчеты.Валюта КАК ВалютаКт,
	|	ДоходыРасходы.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	НастройкиСчетовУчета.СчетУчета КАК СчетКт,
	|
	|	НастройкиСчетовУчета.Субконто1 КАК СубконтоКт1,
	|	НастройкиСчетовУчета.Субконто2 КАК СубконтоКт2,
	|	НастройкиСчетовУчета.Субконто3 КАК СубконтоКт3,
	|
	|	Расчеты.Предоплата + Расчеты.Долг КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Списание задолженности перед покупателем в активы/пассивы"" КАК Содержание
	|
	|ИЗ 
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.КорректировкаЗадолженности КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		Документ.КорректировкаЗадолженности.ДоходыРасходыАктивыПассивы КАК ДоходыРасходы
	|	ПО 
	|		ДокументыКОтражению.Ссылка = ДоходыРасходы.Ссылка 
	|		И ДоходыРасходы.НомерСтроки = 1
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ПланВидовХарактеристик.СтатьиАктивовПассивов КАК СтатьиАктивовПассивов
	|	ПО
	|		ДоходыРасходы.Статья = СтатьиАктивовПассивов.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		Справочник.НастройкиСчетовУчетаПрочихОпераций КАК НастройкиСчетовУчета
	|	ПО
	|		ДоходыРасходы.НастройкаСчетовУчета = НастройкиСчетовУчета.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСКлиентамиПоДокументам КАК Расчеты
	|	ПО
	|		Операция.Ссылка = Расчеты.Ссылка
	|		И Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл <> 0
	|		И Расчеты.СтарыйАлгоритм
	|
	|ГДЕ
	|	Операция.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеКредиторскойЗадолженности)
	|";
	ТекстыОтражения.Добавить(ТекстЗапроса);
#КонецОбласти

#Область ТекстСписаниеКредиторскойЗадолженностиРасчетыСПоставщикомСтарое
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Списание задолженности перед поставщиком в доходы (Дт <60.1> :: Кт <91.1>)
	|
	|	Операция.Ссылка КАК Ссылка,
	|	Операция.Дата КАК Период,
	|	Операция.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл КАК Сумма,
	|	Расчеты.ПредоплатаУпр + Расчеты.ДолгУпр КАК СуммаУУ,
	|
	|	ВЫБОР КОГДА Расчеты.ДолгРегл <> 0 ТОГДА
	|		ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками)
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыВыданные)
	|	КОНЕЦ КАК ВидСчетаДт,
	|
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	Расчеты.Валюта КАК ВалютаДт,
	|	Расчеты.Подразделение КАК ПодразделениеДт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	Расчеты.Контрагент КАК СубконтоДт1,
	|	Расчеты.Договор КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	Расчеты.Предоплата + Расчеты.Долг КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Доходы) КАК ВидСчетаКт,
	|	ДоходыРасходы.Статья КАК АналитикаУчетаКт,
	|	ДоходыРасходы.Подразделение КАК МестоУчетаКт,
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВалютаКт,
	|	ДоходыРасходы.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	ДоходыРасходы.Статья КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Списание задолженности перед поставщиком в доходы"" КАК Содержание
	|
	|ИЗ 
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.КорректировкаЗадолженности КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		Документ.КорректировкаЗадолженности.ДоходыРасходыАктивыПассивы КАК ДоходыРасходы
	|	ПО 
	|		ДокументыКОтражению.Ссылка = ДоходыРасходы.Ссылка 
	|		И ДоходыРасходы.НомерСтроки = 1
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РасчетыСПоставщикамиПоДокументам КАК Расчеты
	|	ПО
	|		Операция.Ссылка = Расчеты.Ссылка
	|		И Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл <> 0
	|		И Расчеты.СтарыйАлгоритм
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ПланВидовХарактеристик.СтатьиДоходов КАК СтатьиДоходов
	|	ПО
	|		ДоходыРасходы.Статья = СтатьиДоходов.Ссылка
	|	
	|ГДЕ 
	|	Операция.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеКредиторскойЗадолженности)
	|";
	ТекстыОтражения.Добавить(ТекстЗапроса);
#КонецОбласти

#Область ТекстСписаниеКредиторскойЗадолженностиРасчетыСПоставщикомНаСтатьиАктивовПассивовСтарое
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Списание задолженности перед поставщиком в прочие активы пассивы (Дт <60.1> :: )
	|
	|	Операция.Ссылка КАК Ссылка,
	|	Операция.Дата КАК Период,
	|	Операция.Организация КАК Организация,
	|	"""" КАК ИдентификаторСтроки,
	|
	|	Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл КАК Сумма,
	|	Расчеты.ПредоплатаУпр + Расчеты.ДолгУпр КАК СуммаУУ,
	|
	|	ВЫБОР КОГДА Расчеты.ДолгРегл <> 0 ТОГДА
	|		ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками)
	|	ИНАЧЕ
	|		ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.АвансыВыданные)
	|	КОНЕЦ КАК ВидСчетаДт,
	|
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	Расчеты.Валюта КАК ВалютаДт,
	|	Расчеты.Подразделение КАК ПодразделениеДт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	Расчеты.Контрагент КАК СубконтоДт1,
	|	Расчеты.Договор КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	Расчеты.Предоплата + Расчеты.Долг КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеАктивыПассивы) КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|	
	|	Расчеты.Валюта КАК ВалютаКт,
	|	ДоходыРасходы.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	НастройкиСчетовУчета.СчетУчета КАК СчетКт,
	|
	|	НастройкиСчетовУчета.Субконто1 КАК СубконтоКт1,
	|	НастройкиСчетовУчета.Субконто2 КАК СубконтоКт2,
	|	НастройкиСчетовУчета.Субконто3 КАК СубконтоКт3,
	|
	|	Расчеты.Предоплата + Расчеты.Долг КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Списание задолженности перед поставщиком в активы/пассивы"" КАК Содержание
	|
	|ИЗ 
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.КорректировкаЗадолженности КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		Документ.КорректировкаЗадолженности.ДоходыРасходыАктивыПассивы КАК ДоходыРасходы
	|	ПО 
	|		ДокументыКОтражению.Ссылка = ДоходыРасходы.Ссылка 
	|		И ДоходыРасходы.НомерСтроки = 1
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ 
	|		РасчетыСПоставщикамиПоДокументам КАК Расчеты
	|	ПО
	|		Операция.Ссылка = Расчеты.Ссылка
	|		И Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл <> 0
	|		И Расчеты.СтарыйАлгоритм
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ПланВидовХарактеристик.СтатьиАктивовПассивов КАК СтатьиАктивовПассивов
	|	ПО
	|		ДоходыРасходы.Статья = СтатьиАктивовПассивов.Ссылка
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		Справочник.НастройкиСчетовУчетаПрочихОпераций КАК НастройкиСчетовУчета
	|	ПО
	|		ДоходыРасходы.НастройкаСчетовУчета = НастройкиСчетовУчета.Ссылка
	|	
	|ГДЕ 
	|	Операция.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеКредиторскойЗадолженности)
	|";
	ТекстыОтражения.Добавить(ТекстЗапроса);
#КонецОбласти

#Область ТекстСписаниеВУбытокЗадолженностиЗабалансСКлиентом
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Списание в убыток задолженности неплатежеспособных дебиторов клиентов (Дт <007>)
	|
	|	Операция.Ссылка КАК Ссылка,
	|	Операция.Дата КАК Период,
	|	Операция.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл КАК Сумма,
	|	Расчеты.ПредоплатаУпр + Расчеты.ДолгУпр КАК СуммаУУ,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	Расчеты.Валюта КАК ВалютаДт,
	|	Расчеты.Подразделение КАК ПодразделениеДт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СписаннаяВУбытокЗадолженностьДебиторов) КАК СчетДт,
	|
	|	Расчеты.Контрагент КАК СубконтоДт1,
	|	Расчеты.Договор КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|
	|	Расчеты.Предоплата + Расчеты.Долг КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВалютаКт,
	|	НЕОПРЕДЕЛЕНО КАК ПодразделениеКт,
	|	НЕОПРЕДЕЛЕНО КАК НаправлениеДеятельностиКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Списание в убыток задолженности неплатежеспособных дебиторов"" КАК Содержание
	|
	|ИЗ 
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.КорректировкаЗадолженности КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСКлиентамиПоДокументам КАК Расчеты
	|	ПО
	|		Операция.Ссылка = Расчеты.Ссылка
	|		И Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл <> 0
	|ГДЕ
	|	Операция.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеБезнадежнойЗадолженностиЗаСчетРезервовПоСомнительнымДолгам)
	|";
	ТекстыОтражения.Добавить(ТекстЗапроса);
#КонецОбласти

#Область ТекстСписаниеВУбытокЗадолженностиЗабалансСПоставщиком
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Списание в убыток задолженности неплатежеспособных дебиторов поставщиков (Дт <007>)
	|
	|	Операция.Ссылка КАК Ссылка,
	|	Операция.Дата КАК Период,
	|	Операция.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл КАК Сумма,
	|	Расчеты.ПредоплатаУпр + Расчеты.ДолгУпр КАК СуммаУУ,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	Расчеты.Валюта КАК ВалютаДт,
	|	Расчеты.Подразделение КАК ПодразделениеДт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СписаннаяВУбытокЗадолженностьДебиторов) КАК СчетДт,
	|
	|	Расчеты.Контрагент КАК СубконтоДт1,
	|	Расчеты.Договор КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|
	|	Расчеты.Предоплата + Расчеты.Долг КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВидСчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК ВалютаКт,
	|	НЕОПРЕДЕЛЕНО КАК ПодразделениеКт,
	|	НЕОПРЕДЕЛЕНО КАК НаправлениеДеятельностиКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт1,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Списание в убыток задолженности неплатежеспособных дебиторов"" КАК Содержание
	|
	|ИЗ 
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		Документ.КорректировкаЗадолженности КАК Операция
	|	ПО
	|		ДокументыКОтражению.Ссылка = Операция.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСПоставщикамиПоДокументам КАК Расчеты
	|	ПО
	|		Операция.Ссылка = Расчеты.Ссылка
	|		И Расчеты.ПредоплатаРегл + Расчеты.ДолгРегл <> 0
	|ГДЕ
	|	Операция.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеБезнадежнойЗадолженностиЗаСчетРезервовПоСомнительнымДолгам)
	|";
	ТекстыОтражения.Добавить(ТекстЗапроса);
#КонецОбласти


#Область ТекстДебиторскаяЗадолженностьРасчетыСПоставщикомРасходы
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Начисление/Списание задолженности поставщика на расходы (Дт <91.2> :: Кт <60.2>)
	|
	|	Расчеты.Ссылка КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	Расчеты.ОрганизацияАналитики КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА РегистрПрочиеРасходы.СуммаРегл
	|		КОГДА Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеДебиторскойЗадолженности)
	|		ТОГДА -Расчеты.СуммаРегл
	|		ИНАЧЕ Расчеты.СуммаРегл
	|	КОНЕЦ - ЕСТЬNULL(Резервы.СуммаРегл, 0) КАК Сумма,
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА РегистрПрочиеРасходы.СуммаУпр
	|		КОГДА Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеДебиторскойЗадолженности)
	|		ТОГДА -Расчеты.СуммаУпр
	|		ИНАЧЕ Расчеты.СуммаУпр
	|	КОНЕЦ - ЕСТЬNULL(Резервы.СуммаУпр, 0) КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаДт,
	|	РегистрПрочиеРасходы.СтатьяРасходов КАК АналитикаУчетаДт,
	|	РегистрПрочиеРасходы.Подразделение КАК МестоУчетаДт,
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВалютаДт,
	|	РегистрПрочиеРасходы.Подразделение КАК ПодразделениеДт,
	|	РегистрПрочиеРасходы.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	РегистрПрочиеРасходы.СтатьяРасходов КАК СубконтоДт1,
	|	РегистрПрочиеРасходы.АналитикаРасходов КАК СубконтоДт2,
	|	РегистрПрочиеРасходы.ТипЗатрат КАК СубконтоДт3,
	|
	|	ВЫБОР
	|		КОГДА НЕ Резервы.Ссылка ЕСТЬ NULL
	|		ТОГДА 0
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА РегистрПрочиеРасходы.Сумма
	|		КОГДА Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеДебиторскойЗадолженности)
	|		ТОГДА -Расчеты.Сумма
	|		ИНАЧЕ Расчеты.Сумма
	|	КОНЕЦ КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	ВЫБОР
	|		КОГДА НЕ РегистрПрочиеРасходы.ПринятиеКНалоговомуУчету
	|		ТОГДА 0
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА РегистрПрочиеРасходы.СуммаРегл - ЕСТЬNULL(Резервы.СуммаРегл, 0) + ЕСТЬNULL(Резервы.ПостояннаяРазница, 0) + ЕСТЬNULL(Резервы.ВременнаяРазница, 0)
	|		КОГДА Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеДебиторскойЗадолженности)
	|		ТОГДА -Расчеты.СуммаРегл - ЕСТЬNULL(Резервы.СуммаРегл, 0) + ЕСТЬNULL(Резервы.ПостояннаяРазница, 0) + ЕСТЬNULL(Резервы.ВременнаяРазница, 0)
	|		ИНАЧЕ Расчеты.СуммаРегл - ЕСТЬNULL(Резервы.СуммаРегл, 0) + ЕСТЬNULL(Резервы.ПостояннаяРазница, 0) + ЕСТЬNULL(Резервы.ВременнаяРазница, 0)
	|	КОНЕЦ КАК СуммаНУДт,
	|	ВЫБОР
	|		КОГДА РегистрПрочиеРасходы.ПринятиеКНалоговомуУчету
	|		ТОГДА -ЕСТЬNULL(Резервы.ПостояннаяРазница, 0)
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА РегистрПрочиеРасходы.СуммаРегл - ЕСТЬNULL(Резервы.СуммаРегл, 0) + ЕСТЬNULL(Резервы.ВременнаяРазница, 0)
	|		КОГДА Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеДебиторскойЗадолженности)
	|		ТОГДА -Расчеты.СуммаРегл - ЕСТЬNULL(Резервы.СуммаРегл, 0) + ЕСТЬNULL(Резервы.ВременнаяРазница, 0)
	|		ИНАЧЕ Расчеты.СуммаРегл - ЕСТЬNULL(Резервы.СуммаРегл, 0) + ЕСТЬNULL(Резервы.ВременнаяРазница, 0)
	|	КОНЕЦ КАК СуммаПРДт,
	|	-ЕСТЬNULL(Резервы.ВременнаяРазница, 0) КАК СуммаВРДт,
	|
	|
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками)
	|		ИНАЧЕ Расчеты.ВидСчета
	|	КОНЕЦ КАК ВидСчетаКт,
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	Расчеты.Валюта КАК ВалютаКт,
	|	Расчеты.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Расчеты.Контрагент КАК СубконтоКт1,
	|	Расчеты.Договор КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	ВЫБОР
	|		КОГДА Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеДебиторскойЗадолженности)
	|		ТОГДА -1
	|		ИНАЧЕ 1
	|	КОНЕЦ * ВЫБОР
	|		КОГДА НЕ Резервы.Ссылка ЕСТЬ NULL ИЛИ НовыеРасчеты.НесколькоСтатей И РегистрПрочиеРасходы.НомерСтроки <> 1
	|		ТОГДА 0
	|		ИНАЧЕ Расчеты.Сумма + ВЫБОР КОГДА Расчеты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками)
	|			ТОГДА ЕСТЬNULL(РасчетыСДругимВидомСчета.Сумма, 0) ИНАЧЕ 0 КОНЕЦ
	|	КОНЕЦ КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеДебиторскойЗадолженности)
	|			И Расчеты.ДокументОбъектаРасчетов ССЫЛКА Справочник.Претензии
	|		ТОГДА ""Выставлена претензия поставщику""
	|		КОГДА Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеДебиторскойЗадолженности)
	|		ТОГДА ""Начислена дебиторская задолженность""
	|		КОГДА Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеКредиторскойЗадолженности)
	|		ТОГДА ""Начислена кредиторская задолженность""
	|		ИНАЧЕ ""Списание задолженности поставщика на расходы""
	|	КОНЕЦ КАК Содержание
	|
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСПоставщикамиНоваяАрхитектура КАК Расчеты
	|	ПО
	|		ДокументыКОтражению.Ссылка = Расчеты.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСПоставщикамиПоДокументам КАК НовыеРасчеты
	|	ПО
	|		Расчеты.Ссылка = НовыеРасчеты.Ссылка
	|		И Расчеты.ОбъектРасчетов = НовыеРасчеты.ОбъектРасчетов
	|		И НЕ НовыеРасчеты.СтарыйАлгоритм
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ВТДанныеПрочиеРасходы КАК РегистрПрочиеРасходы
	|	ПО
	|		Расчеты.Ссылка = РегистрПрочиеРасходы.Регистратор
	|		И РегистрПрочиеРасходы.ИдентификаторФинЗаписи = Расчеты.ИдентификаторФинЗаписи
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		РезервыПоСомнительнымДолгам_ПоОбъектамРасчета КАК Резервы
	|	ПО
	|		Расчеты.Ссылка = Резервы.Ссылка
	|		И Расчеты.ОбъектРасчетов = Резервы.ОбъектРасчетов
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ РасчетыСПоставщикамиНоваяАрхитектура КАК РасчетыСДругимВидомСчета
	|	ПО ДокументыКОтражению.Ссылка = РасчетыСДругимВидомСчета.Ссылка
	|		И НовыеРасчеты.НесколькоСтатей
	|		И РасчетыСДругимВидомСчета.ВидСчета <> Расчеты.ВидСчета
	|
	|ГДЕ
	|	(Расчеты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками) ИЛИ РасчетыСДругимВидомСчета.Ссылка ЕСТЬ NULL ИЛИ НЕ НовыеРасчеты.НесколькоСтатей)
	|	И Расчеты.НастройкаХозОперации В (
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеДебиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеКредиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СписаниеДебиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СписаниеБезнадежнойЗадолженностиЗаСчетРезервовПоСомнительнымДолгам))";
	ТекстыОтражения.Добавить(ТекстЗапроса);
#КонецОбласти

#Область ТекстДебиторскаяЗадолженностьРасчетыСПоставщикомПрочиеАктивыПассивы
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Начисление/Списание задолженности поставщика на прочие активы/пассивы (Дт <Прочие счета> :: Кт <60.2>)
	|
	|	Расчеты.Ссылка КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	Расчеты.ОрганизацияАналитики КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА ПрочиеАктивыПассивы.СуммаРегл
	|		ИНАЧЕ Расчеты.СуммаРегл
	|	КОНЕЦ - ЕСТЬNULL(Резервы.СуммаРегл, 0) КАК Сумма,
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА ПрочиеАктивыПассивы.СуммаУпр
	|		ИНАЧЕ Расчеты.СуммаУпр
	|	КОНЕЦ - ЕСТЬNULL(Резервы.СуммаУпр, 0) КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеАктивыПассивы) КАК ВидСчетаДт,
	|	ПрочиеАктивыПассивы.Статья КАК АналитикаУчетаДт,
	|	ПрочиеАктивыПассивы.Подразделение КАК МестоУчетаДт,
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВалютаДт,
	|	ПрочиеАктивыПассивы.Подразделение КАК ПодразделениеДт,
	|	ПрочиеАктивыПассивы.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	ПрочиеАктивыПассивы.СчетУчета КАК СчетДт,
	|
	|	ПрочиеАктивыПассивы.Субконто1 КАК СубконтоДт1,
	|	ПрочиеАктивыПассивы.Субконто2 КАК СубконтоДт2,
	|	ПрочиеАктивыПассивы.Субконто3 КАК СубконтоДт3,
	|
	|	ВЫБОР
	|		КОГДА НЕ Резервы.Ссылка ЕСТЬ NULL
	|		ТОГДА 0
	|		ИНАЧЕ 1
	|	КОНЕЦ * ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА ПрочиеАктивыПассивы.СуммаСНДС
	|		ИНАЧЕ Расчеты.Сумма
	|	КОНЕЦ КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА ПрочиеАктивыПассивы.СуммаРегл
	|		ИНАЧЕ Расчеты.СуммаРегл
	|	КОНЕЦ - ЕСТЬNULL(Резервы.СуммаРегл, 0) + ЕСТЬNULL(Резервы.ПостояннаяРазница, 0) + ЕСТЬNULL(Резервы.ВременнаяРазница, 0) КАК СуммаНУДт,
	|	-ЕСТЬNULL(Резервы.ПостояннаяРазница, 0) КАК СуммаПРДт,
	|	-ЕСТЬNULL(Резервы.ВременнаяРазница, 0) КАК СуммаВРДт,
	|
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		И НЕ РасчетыСДругимВидомСчета.Ссылка ЕСТЬ NULL
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками)
	|		ИНАЧЕ Расчеты.ВидСчета
	|	КОНЕЦ КАК ВидСчетаКт,
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	Расчеты.Валюта КАК ВалютаКт,
	|	Расчеты.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Расчеты.Контрагент КАК СубконтоКт1,
	|	Расчеты.Договор КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	ВЫБОР
	|		КОГДА НЕ Резервы.Ссылка ЕСТЬ NULL ИЛИ НЕ ПрочиеАктивыПассивы.ТолькоАктивыПассивы
	|			ИЛИ НовыеРасчеты.НесколькоСтатей И ПрочиеАктивыПассивы.НомерСтроки <> 1
	|		ТОГДА 0
	|		ИНАЧЕ 1
	|	КОНЕЦ * (Расчеты.Сумма + ВЫБОР КОГДА Расчеты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками)
	|			ТОГДА ЕСТЬNULL(РасчетыСДругимВидомСчета.Сумма, 0) ИНАЧЕ 0 КОНЕЦ) КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеКредиторскойЗадолженности)
	|		ТОГДА ""Начислена кредиторская задолженность""
	|		ИНАЧЕ ""Списание задолженности поставщика на активы\пассивы""
	|	КОНЕЦ КАК Содержание
	|
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСПоставщикамиНоваяАрхитектура КАК Расчеты
	|	ПО
	|		ДокументыКОтражению.Ссылка = Расчеты.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСПоставщикамиПоДокументам КАК НовыеРасчеты
	|	ПО
	|		Расчеты.Ссылка = НовыеРасчеты.Ссылка
	|		И Расчеты.ОбъектРасчетов = НовыеРасчеты.ОбъектРасчетов
	|		И НЕ НовыеРасчеты.СтарыйАлгоритм
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ВТДанныеПрочиеАктивыПассивы КАК ПрочиеАктивыПассивы
	|	ПО
	|		Расчеты.Ссылка = ПрочиеАктивыПассивы.Регистратор
	|		И ПрочиеАктивыПассивы.ИдентификаторФинЗаписи = Расчеты.ИдентификаторФинЗаписи
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		РезервыПоСомнительнымДолгам_ПоОбъектамРасчета КАК Резервы
	|	ПО
	|		Расчеты.Ссылка = Резервы.Ссылка
	|		И Расчеты.ОбъектРасчетов = Резервы.ОбъектРасчетов
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ РасчетыСПоставщикамиНоваяАрхитектура КАК РасчетыСДругимВидомСчета
	|	ПО ДокументыКОтражению.Ссылка = РасчетыСДругимВидомСчета.Ссылка
	|		И НовыеРасчеты.НесколькоСтатей
	|		И РасчетыСДругимВидомСчета.ВидСчета <> Расчеты.ВидСчета
	|
	|ГДЕ
	|	(Расчеты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками) ИЛИ РасчетыСДругимВидомСчета.Ссылка ЕСТЬ NULL ИЛИ НЕ НовыеРасчеты.НесколькоСтатей)
	|	И Расчеты.НастройкаХозОперации В (
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СписаниеДебиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеКредиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СписаниеБезнадежнойЗадолженностиЗаСчетРезервовПоСомнительнымДолгам))";
	ТекстыОтражения.Добавить(ТекстЗапроса);
#КонецОбласти

#Область ТекстЗадолженностьРасчетыСПоставщикомДоходы
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Отражение задолженности перед поставщиком в доходы (Дт <60.1> :: Кт <91.1>)
	|
	|	Расчеты.Ссылка КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	Расчеты.ОрганизацияАналитики КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА РегистрПрочиеДоходы.СуммаРегл
	|		ИНАЧЕ Расчеты.СуммаРегл
	|	КОНЕЦ КАК Сумма,
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА РегистрПрочиеДоходы.СуммаУпр
	|		ИНАЧЕ Расчеты.СуммаУпр
	|	КОНЕЦ КАК СуммаУУ,
	|
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками)
	|		ИНАЧЕ Расчеты.ВидСчета
	|	КОНЕЦ КАК ВидСчетаДт,
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	Расчеты.Валюта КАК ВалютаДт,
	|	Расчеты.Подразделение КАК ПодразделениеДт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	Расчеты.Контрагент КАК СубконтоДт1,
	|	Расчеты.Договор КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей И РегистрПрочиеДоходы.НомерСтроки <> 1
	|		ТОГДА 0
	|		ИНАЧЕ 1
	|	КОНЕЦ * (Расчеты.Сумма + ВЫБОР КОГДА Расчеты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками)
	|			ТОГДА ЕСТЬNULL(РасчетыСДругимВидомСчета.Сумма, 0) ИНАЧЕ 0 КОНЕЦ) КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Доходы) КАК ВидСчетаКт,
	|	РегистрПрочиеДоходы.СтатьяДоходов КАК АналитикаУчетаКт,
	|	РегистрПрочиеДоходы.Подразделение КАК МестоУчетаКт,
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВалютаКт,
	|	РегистрПрочиеДоходы.Подразделение КАК ПодразделениеКт,
	|	РегистрПрочиеДоходы.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	РегистрПрочиеДоходы.СтатьяДоходов КАК СубконтоКт1,
	|	РегистрПрочиеДоходы.АналитикаДоходов КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	ВЫБОР
	|		КОГДА НЕ РегистрПрочиеДоходы.ПринятиеКНалоговомуУчету
	|		ТОГДА 0
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА РегистрПрочиеДоходы.СуммаРегл
	|		ИНАЧЕ Расчеты.СуммаРегл
	|	КОНЕЦ КАК СуммаНУКт,
	|	ВЫБОР
	|		КОГДА РегистрПрочиеДоходы.ПринятиеКНалоговомуУчету
	|		ТОГДА 0
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА РегистрПрочиеДоходы.СуммаРегл
	|		ИНАЧЕ Расчеты.СуммаРегл
	|	КОНЕЦ КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СписаниеКредиторскойЗадолженности)
	|		ТОГДА ""Списание задолженности перед поставщиком в доходы""
	|		КОГДА Расчеты.ДокументОбъектаРасчетов ССЫЛКА Справочник.Претензии
	|		ТОГДА ""Выставлена претензия поставщику""
	|		ИНАЧЕ ""Начислена дебиторская задолженность""
	|	КОНЕЦ КАК Содержание
	|
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСПоставщикамиНоваяАрхитектура КАК Расчеты
	|	ПО
	|		ДокументыКОтражению.Ссылка = Расчеты.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСПоставщикамиПоДокументам КАК НовыеРасчеты
	|	ПО
	|		Расчеты.Ссылка = НовыеРасчеты.Ссылка
	|		И Расчеты.ОбъектРасчетов = НовыеРасчеты.ОбъектРасчетов
	|		И НЕ НовыеРасчеты.СтарыйАлгоритм
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ВТДанныеПрочиеДоходы КАК РегистрПрочиеДоходы
	|	ПО
	|		Расчеты.Ссылка = РегистрПрочиеДоходы.Регистратор
	|		И РегистрПрочиеДоходы.ИдентификаторФинЗаписи = Расчеты.ИдентификаторФинЗаписи
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ РасчетыСПоставщикамиНоваяАрхитектура КАК РасчетыСДругимВидомСчета
	|	ПО ДокументыКОтражению.Ссылка = РасчетыСДругимВидомСчета.Ссылка
	|		И НовыеРасчеты.НесколькоСтатей
	|		И РасчетыСДругимВидомСчета.ВидСчета <> Расчеты.ВидСчета
	|
	|ГДЕ
	|	(Расчеты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками) ИЛИ РасчетыСДругимВидомСчета.Ссылка ЕСТЬ NULL ИЛИ НЕ НовыеРасчеты.НесколькоСтатей)
	|	И Расчеты.НастройкаХозОперации В (
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеДебиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СписаниеКредиторскойЗадолженности))";
	ТекстыОтражения.Добавить(ТекстЗапроса);
#КонецОбласти

#Область ТекстЗадолженностьРасчетыСПоставщикомПрочиеАктивыПассивы
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Отражение задолженности перед поставщиком в прочие активы/пассивы (Дт <60.1> :: Кт <Прочие счета>)
	|
	|	Расчеты.Ссылка КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	Расчеты.ОрганизацияАналитики КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА ПрочиеАктивыПассивы.СуммаРегл
	|		ИНАЧЕ Расчеты.СуммаРегл
	|	КОНЕЦ КАК Сумма,
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА ПрочиеАктивыПассивы.СуммаУпр
	|		ИНАЧЕ Расчеты.СуммаУпр
	|	КОНЕЦ КАК СуммаУУ,
	|
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками)
	|		ИНАЧЕ Расчеты.ВидСчета
	|	КОНЕЦ КАК ВидСчетаДт,
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	Расчеты.Валюта КАК ВалютаДт,
	|	Расчеты.Подразделение КАК ПодразделениеДт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	Расчеты.Контрагент КАК СубконтоДт1,
	|	Расчеты.Договор КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей И ПрочиеАктивыПассивы.НомерСтроки <> 1 ИЛИ НЕ ПрочиеАктивыПассивы.ТолькоАктивыПассивы
	|		ТОГДА 0
	|		ИНАЧЕ 1
	|	КОНЕЦ * (Расчеты.Сумма + ВЫБОР КОГДА Расчеты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками)
	|			ТОГДА ЕСТЬNULL(РасчетыСДругимВидомСчета.Сумма, 0) ИНАЧЕ 0 КОНЕЦ) КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеАктивыПассивы) КАК ВидСчетаКт,
	|	ПрочиеАктивыПассивы.Статья КАК АналитикаУчетаКт,
	|	ПрочиеАктивыПассивы.Подразделение КАК МестоУчетаКт,
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВалютаКт,
	|	ПрочиеАктивыПассивы.Подразделение КАК ПодразделениеКт,
	|	ПрочиеАктивыПассивы.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	ПрочиеАктивыПассивы.СчетУчета КАК СчетКт,
	|
	|	ПрочиеАктивыПассивы.Субконто1 КАК СубконтоКт1,
	|	ПрочиеАктивыПассивы.Субконто2 КАК СубконтоКт2,
	|	ПрочиеАктивыПассивы.Субконто3 КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СписаниеКредиторскойЗадолженности)
	|		ТОГДА ""Списание задолженности перед поставщиком в активы/пассивы""
	|		КОГДА Расчеты.ДокументОбъектаРасчетов ССЫЛКА Справочник.Претензии
	|		ТОГДА ""Выставлена претензия поставщику""
	|		ИНАЧЕ ""Начислена дебиторская задолженность""
	|	КОНЕЦ КАК Содержание
	|
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСПоставщикамиНоваяАрхитектура КАК Расчеты
	|	ПО
	|		ДокументыКОтражению.Ссылка = Расчеты.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСПоставщикамиПоДокументам КАК НовыеРасчеты
	|	ПО
	|		Расчеты.Ссылка = НовыеРасчеты.Ссылка
	|		И Расчеты.ОбъектРасчетов = НовыеРасчеты.ОбъектРасчетов
	|		И НЕ НовыеРасчеты.СтарыйАлгоритм
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ВТДанныеПрочиеАктивыПассивы КАК ПрочиеАктивыПассивы
	|	ПО
	|		Расчеты.Ссылка = ПрочиеАктивыПассивы.Регистратор
	|		И ПрочиеАктивыПассивы.ИдентификаторФинЗаписи = Расчеты.ИдентификаторФинЗаписи
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ РасчетыСПоставщикамиНоваяАрхитектура КАК РасчетыСДругимВидомСчета
	|	ПО ДокументыКОтражению.Ссылка = РасчетыСДругимВидомСчета.Ссылка
	|		И НовыеРасчеты.НесколькоСтатей
	|		И РасчетыСДругимВидомСчета.ВидСчета <> Расчеты.ВидСчета
	|
	|ГДЕ
	|	(Расчеты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками) ИЛИ РасчетыСДругимВидомСчета.Ссылка ЕСТЬ NULL ИЛИ НЕ НовыеРасчеты.НесколькоСтатей)
	|	И Расчеты.НастройкаХозОперации В (
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеДебиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СписаниеКредиторскойЗадолженности))";
	ТекстыОтражения.Добавить(ТекстЗапроса);
#КонецОбласти

#Область ТекстЗадолженностьРасчетыСКлиентомРасходы
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Начисление/Списание задолженности покупателя на расходы (Дт <91.2> :: Кт <62>)
	|
	|	Расчеты.Ссылка КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	Расчеты.ОрганизацияАналитики КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА РегистрПрочиеРасходы.СуммаРегл
	|		КОГДА Расчеты.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.НачислениеДебиторскойЗадолженности)
	|		ТОГДА -Расчеты.СуммаРегл
	|		ИНАЧЕ Расчеты.СуммаРегл
	|	КОНЕЦ - ЕСТЬNULL(Резервы.СуммаРегл, 0) КАК Сумма,
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА РегистрПрочиеРасходы.СуммаУпр
	|		КОГДА Расчеты.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.НачислениеДебиторскойЗадолженности)
	|		ТОГДА -Расчеты.СуммаУпр
	|		ИНАЧЕ Расчеты.СуммаУпр
	|	КОНЕЦ - ЕСТЬNULL(Резервы.СуммаУпр, 0) КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Расходы) КАК ВидСчетаДт,
	|	РегистрПрочиеРасходы.СтатьяРасходов КАК АналитикаУчетаДт,
	|	РегистрПрочиеРасходы.Подразделение КАК МестоУчетаДт,
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВалютаДт,
	|	РегистрПрочиеРасходы.Подразделение КАК ПодразделениеДт,
	|	РегистрПрочиеРасходы.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	РегистрПрочиеРасходы.СтатьяРасходов КАК СубконтоДт1,
	|	РегистрПрочиеРасходы.АналитикаРасходов КАК СубконтоДт2,
	|	РегистрПрочиеРасходы.ТипЗатрат КАК СубконтоДт3,
	|
	|	ВЫБОР
	|		КОГДА НЕ Резервы.Ссылка ЕСТЬ NULL
	|		ТОГДА 0
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА РегистрПрочиеРасходы.Сумма
	|		КОГДА Расчеты.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.НачислениеДебиторскойЗадолженности)
	|		ТОГДА -Расчеты.Сумма
	|		ИНАЧЕ Расчеты.Сумма
	|	КОНЕЦ КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	ВЫБОР
	|		КОГДА НЕ РегистрПрочиеРасходы.ПринятиеКНалоговомуУчету
	|		ТОГДА 0
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА РегистрПрочиеРасходы.СуммаРегл - ЕСТЬNULL(Резервы.СуммаРегл, 0) + ЕСТЬNULL(Резервы.ПостояннаяРазница, 0) + ЕСТЬNULL(Резервы.ВременнаяРазница, 0)
	|		КОГДА Расчеты.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.НачислениеДебиторскойЗадолженности)
	|		ТОГДА -Расчеты.СуммаРегл - ЕСТЬNULL(Резервы.СуммаРегл, 0) + ЕСТЬNULL(Резервы.ПостояннаяРазница, 0) + ЕСТЬNULL(Резервы.ВременнаяРазница, 0)
	|		ИНАЧЕ Расчеты.СуммаРегл - ЕСТЬNULL(Резервы.СуммаРегл, 0) + ЕСТЬNULL(Резервы.ПостояннаяРазница, 0) + ЕСТЬNULL(Резервы.ВременнаяРазница, 0)
	|	КОНЕЦ КАК СуммаНУДт,
	|	ВЫБОР
	|		КОГДА РегистрПрочиеРасходы.ПринятиеКНалоговомуУчету
	|		ТОГДА -ЕСТЬNULL(Резервы.ПостояннаяРазница, 0)
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА РегистрПрочиеРасходы.СуммаРегл - ЕСТЬNULL(Резервы.СуммаРегл, 0) + ЕСТЬNULL(Резервы.ВременнаяРазница, 0)
	|		КОГДА Расчеты.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.НачислениеДебиторскойЗадолженности)
	|		ТОГДА -Расчеты.СуммаРегл - ЕСТЬNULL(Резервы.СуммаРегл, 0) + ЕСТЬNULL(Резервы.ВременнаяРазница, 0)
	|		ИНАЧЕ Расчеты.СуммаРегл - ЕСТЬNULL(Резервы.СуммаРегл, 0) + ЕСТЬNULL(Резервы.ВременнаяРазница, 0)
	|	КОНЕЦ КАК СуммаПРДт,
	|	-ЕСТЬNULL(Резервы.ВременнаяРазница, 0) КАК СуммаВРДт,
	|
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами)
	|		ИНАЧЕ Расчеты.ВидСчета
	|	КОНЕЦ КАК ВидСчетаКт,
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	Расчеты.Валюта КАК ВалютаКт,
	|	Расчеты.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Расчеты.Контрагент КАК СубконтоКт1,
	|	Расчеты.Договор КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	ВЫБОР
	|		КОГДА Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеДебиторскойЗадолженности)
	|		ТОГДА -1
	|		ИНАЧЕ 1
	|	КОНЕЦ * ВЫБОР
	|		КОГДА НЕ Резервы.Ссылка ЕСТЬ NULL ИЛИ НовыеРасчеты.НесколькоСтатей И РегистрПрочиеРасходы.НомерСтроки <> 1
	|		ТОГДА 0
	|		ИНАЧЕ Расчеты.Сумма + ВЫБОР КОГДА Расчеты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами)
	|			ТОГДА ЕСТЬNULL(РасчетыСДругимВидомСчета.Сумма, 0) ИНАЧЕ 0 КОНЕЦ
	|	КОНЕЦ КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеКредиторскойЗадолженности) И Расчеты.ДокументОбъектаРасчетов ССЫЛКА Справочник.Претензии
	|		ТОГДА ""Получена претензия от клиента""
	|		КОГДА Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеКредиторскойЗадолженности)
	|		ТОГДА ""Начислена кредиторская задолженность""
	|		КОГДА Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеДебиторскойЗадолженности)
	|		ТОГДА ""Начислена дебиторская задолженность""
	|		ИНАЧЕ ""Списание задолженности покупателя на расходы""
	|	КОНЕЦ КАК Содержание
	|
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСКлиентамиНоваяАрхитектура КАК Расчеты
	|	ПО
	|		ДокументыКОтражению.Ссылка = Расчеты.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСКлиентамиПоДокументам КАК НовыеРасчеты
	|	ПО
	|		Расчеты.Ссылка = НовыеРасчеты.Ссылка
	|		И Расчеты.ОбъектРасчетов = НовыеРасчеты.ОбъектРасчетов
	|		И НЕ НовыеРасчеты.СтарыйАлгоритм
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ВТДанныеПрочиеРасходы КАК РегистрПрочиеРасходы
	|	ПО
	|		Расчеты.Ссылка = РегистрПрочиеРасходы.Регистратор
	|		И РегистрПрочиеРасходы.ИдентификаторФинЗаписи = Расчеты.ИдентификаторФинЗаписи
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		РезервыПоСомнительнымДолгам_ПоОбъектамРасчета КАК Резервы
	|	ПО
	|		Расчеты.Ссылка = Резервы.Ссылка
	|		И Расчеты.ОбъектРасчетов = Резервы.ОбъектРасчетов
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ РасчетыСКлиентамиНоваяАрхитектура КАК РасчетыСДругимВидомСчета
	|	ПО ДокументыКОтражению.Ссылка = РасчетыСДругимВидомСчета.Ссылка
	|		И НовыеРасчеты.НесколькоСтатей
	|		И РасчетыСДругимВидомСчета.ВидСчета <> Расчеты.ВидСчета
	|
	|ГДЕ
	|	(Расчеты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами) ИЛИ РасчетыСДругимВидомСчета.Ссылка ЕСТЬ NULL ИЛИ НЕ НовыеРасчеты.НесколькоСтатей)
	|	И Расчеты.НастройкаХозОперации В (
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеДебиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеКредиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СписаниеДебиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СписаниеБезнадежнойЗадолженностиЗаСчетРезервовПоСомнительнымДолгам))";
	ТекстыОтражения.Добавить(ТекстЗапроса);
#КонецОбласти

#Область ТекстЗадолженностьРасчетыСКлиентомПрочиеАктивыПассивы
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Начисление/Списание задолженности покупателя на активы/пассивы (Дт <Прочие счета> :: Кт <62>)
	|
	|	Расчеты.Ссылка КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	Расчеты.ОрганизацияАналитики КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА ПрочиеАктивыПассивы.СуммаРегл
	|		ИНАЧЕ Расчеты.СуммаРегл
	|	КОНЕЦ - ЕСТЬNULL(Резервы.СуммаРегл, 0) КАК Сумма,
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА ПрочиеАктивыПассивы.СуммаУпр
	|		ИНАЧЕ Расчеты.СуммаУпр
	|	КОНЕЦ - ЕСТЬNULL(Резервы.СуммаУпр, 0) КАК СуммаУУ,
	|
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеАктивыПассивы) КАК ВидСчетаДт,
	|	ПрочиеАктивыПассивы.Статья КАК АналитикаУчетаДт,
	|	ПрочиеАктивыПассивы.Подразделение КАК МестоУчетаДт,
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВалютаДт,
	|	ПрочиеАктивыПассивы.Подразделение КАК ПодразделениеДт,
	|	ПрочиеАктивыПассивы.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	ПрочиеАктивыПассивы.СчетУчета КАК СчетДт,
	|
	|	ПрочиеАктивыПассивы.Субконто1 КАК СубконтоДт1,
	|	ПрочиеАктивыПассивы.Субконто2 КАК СубконтоДт2,
	|	ПрочиеАктивыПассивы.Субконто3 КАК СубконтоДт3,
	|
	|	ВЫБОР
	|		КОГДА Резервы.Ссылка ЕСТЬ NULL
	|		ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА ПрочиеАктивыПассивы.СуммаСНДС
	|		ИНАЧЕ Расчеты.Сумма
	|	КОНЕЦ КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА ПрочиеАктивыПассивы.СуммаРегл
	|		ИНАЧЕ Расчеты.СуммаРегл
	|	КОНЕЦ - ЕСТЬNULL(Резервы.СуммаРегл, 0) + ЕСТЬNULL(Резервы.ПостояннаяРазница, 0) + ЕСТЬNULL(Резервы.ВременнаяРазница, 0) КАК СуммаНУДт,
	|	-ЕСТЬNULL(Резервы.ПостояннаяРазница, 0) КАК СуммаПРДт,
	|	-ЕСТЬNULL(Резервы.ВременнаяРазница, 0) КАК СуммаВРДт,
	|
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами)
	|		ИНАЧЕ Расчеты.ВидСчета
	|	КОНЕЦ КАК ВидСчетаКт,
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	Расчеты.Валюта КАК ВалютаКт,
	|	Расчеты.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	Расчеты.Контрагент КАК СубконтоКт1,
	|	Расчеты.Договор КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|	
	|	ВЫБОР
	|		КОГДА НЕ Резервы.Ссылка ЕСТЬ NULL ИЛИ НЕ ПрочиеАктивыПассивы.ТолькоАктивыПассивы
	|			ИЛИ НовыеРасчеты.НесколькоСтатей И ПрочиеАктивыПассивы.НомерСтроки <> 1
	|		ТОГДА 0
	|		ИНАЧЕ 1
	|	КОНЕЦ * (Расчеты.Сумма + ВЫБОР КОГДА Расчеты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами)
	|			ТОГДА ЕСТЬNULL(РасчетыСДругимВидомСчета.Сумма, 0) ИНАЧЕ 0 КОНЕЦ) КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеКредиторскойЗадолженности) И Расчеты.ДокументОбъектаРасчетов ССЫЛКА Справочник.Претензии
	|		ТОГДА ""Получена претензия от клиента""
	|		КОГДА Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеКредиторскойЗадолженности)
	|		ТОГДА ""Начислена кредиторская задолженность""
	|		ИНАЧЕ ""Списание задолженности покупателя на активы\пассивы""
	|	КОНЕЦ КАК Содержание
	|
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСКлиентамиНоваяАрхитектура КАК Расчеты
	|	ПО
	|		ДокументыКОтражению.Ссылка = Расчеты.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСКлиентамиПоДокументам КАК НовыеРасчеты
	|	ПО
	|		Расчеты.Ссылка = НовыеРасчеты.Ссылка
	|		И Расчеты.ОбъектРасчетов = НовыеРасчеты.ОбъектРасчетов
	|		И НЕ НовыеРасчеты.СтарыйАлгоритм
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ВТДанныеПрочиеАктивыПассивы КАК ПрочиеАктивыПассивы
	|	ПО
	|		Расчеты.Ссылка = ПрочиеАктивыПассивы.Регистратор
	|		И ПрочиеАктивыПассивы.ИдентификаторФинЗаписи = Расчеты.ИдентификаторФинЗаписи
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ
	|		РезервыПоСомнительнымДолгам_ПоОбъектамРасчета КАК Резервы
	|	ПО
	|		Расчеты.Ссылка = Резервы.Ссылка
	|		И Расчеты.ОбъектРасчетов = Резервы.ОбъектРасчетов
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ РасчетыСКлиентамиНоваяАрхитектура КАК РасчетыСДругимВидомСчета
	|	ПО ДокументыКОтражению.Ссылка = РасчетыСДругимВидомСчета.Ссылка
	|		И НовыеРасчеты.НесколькоСтатей
	|		И РасчетыСДругимВидомСчета.ВидСчета <> Расчеты.ВидСчета
	|
	|ГДЕ
	|	(Расчеты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами) ИЛИ РасчетыСДругимВидомСчета.Ссылка ЕСТЬ NULL ИЛИ НЕ НовыеРасчеты.НесколькоСтатей)
	|	И Расчеты.НастройкаХозОперации В (
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеКредиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СписаниеДебиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СписаниеБезнадежнойЗадолженностиЗаСчетРезервовПоСомнительнымДолгам))";
	ТекстыОтражения.Добавить(ТекстЗапроса);
#КонецОбласти

#Область ТекстСписаниеКредиторскойЗадолженностиРасчетыСКлиентомДоходы
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Отражение задолженности покупателя в доходы (Дт <62> :: Кт <91.1>)
	|
	|	Расчеты.Ссылка КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	Расчеты.ОрганизацияАналитики КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА РегистрПрочиеДоходы.СуммаРегл
	|		ИНАЧЕ Расчеты.СуммаРегл
	|	КОНЕЦ КАК Сумма,
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА РегистрПрочиеДоходы.СуммаУпр
	|		ИНАЧЕ Расчеты.СуммаУпр
	|	КОНЕЦ КАК СуммаУУ,
	|
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами)
	|		ИНАЧЕ Расчеты.ВидСчета
	|	КОНЕЦ КАК ВидСчетаДт,
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	Расчеты.Валюта КАК ВалютаДт,
	|	Расчеты.Подразделение КАК ПодразделениеДт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	Расчеты.Контрагент КАК СубконтоДт1,
	|	Расчеты.Договор КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей И РегистрПрочиеДоходы.НомерСтроки <> 1
	|		ТОГДА 0
	|		ИНАЧЕ 1
	|	КОНЕЦ * (Расчеты.Сумма + ВЫБОР КОГДА Расчеты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами)
	|			ТОГДА ЕСТЬNULL(РасчетыСДругимВидомСчета.Сумма, 0) ИНАЧЕ 0 КОНЕЦ) КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.Доходы) КАК ВидСчетаКт,
	|	РегистрПрочиеДоходы.СтатьяДоходов КАК АналитикаУчетаКт,
	|	РегистрПрочиеДоходы.Подразделение КАК МестоУчетаКт,
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВалютаКт,
	|	РегистрПрочиеДоходы.Подразделение КАК ПодразделениеКт,
	|	РегистрПрочиеДоходы.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетКт,
	|
	|	РегистрПрочиеДоходы.СтатьяДоходов КАК СубконтоКт1,
	|	РегистрПрочиеДоходы.АналитикаДоходов КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	ВЫБОР
	|		КОГДА НЕ РегистрПрочиеДоходы.ПринятиеКНалоговомуУчету
	|		ТОГДА 0
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА РегистрПрочиеДоходы.СуммаРегл
	|		ИНАЧЕ Расчеты.СуммаРегл
	|	КОНЕЦ КАК СуммаНУКт,
	|	ВЫБОР
	|		КОГДА РегистрПрочиеДоходы.ПринятиеКНалоговомуУчету
	|		ТОГДА 0
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА РегистрПрочиеДоходы.СуммаРегл
	|		ИНАЧЕ Расчеты.СуммаРегл
	|	КОНЕЦ КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеДебиторскойЗадолженности)
	|		ТОГДА ""Начислена дебиторская задолженность""
	|		ИНАЧЕ ""Списание задолженности перед покупателем в доходы""
	|	КОНЕЦ КАК Содержание
	|
	|ИЗ 
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСКлиентамиНоваяАрхитектура КАК Расчеты
	|	ПО
	|		ДокументыКОтражению.Ссылка = Расчеты.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСКлиентамиПоДокументам КАК НовыеРасчеты
	|	ПО
	|		Расчеты.Ссылка = НовыеРасчеты.Ссылка
	|		И Расчеты.ОбъектРасчетов = НовыеРасчеты.ОбъектРасчетов
	|		И НЕ НовыеРасчеты.СтарыйАлгоритм
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ВТДанныеПрочиеДоходы КАК РегистрПрочиеДоходы
	|	ПО
	|		Расчеты.Ссылка = РегистрПрочиеДоходы.Регистратор
	|		И РегистрПрочиеДоходы.ИдентификаторФинЗаписи = Расчеты.ИдентификаторФинЗаписи
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ РасчетыСКлиентамиНоваяАрхитектура КАК РасчетыСДругимВидомСчета
	|	ПО ДокументыКОтражению.Ссылка = РасчетыСДругимВидомСчета.Ссылка
	|		И НовыеРасчеты.НесколькоСтатей
	|		И РасчетыСДругимВидомСчета.ВидСчета <> Расчеты.ВидСчета
	|
	|ГДЕ
	|	(Расчеты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами) ИЛИ РасчетыСДругимВидомСчета.Ссылка ЕСТЬ NULL ИЛИ НЕ НовыеРасчеты.НесколькоСтатей)
	|	И Расчеты.НастройкаХозОперации В (
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СписаниеКредиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеДебиторскойЗадолженности))
	|";
	ТекстыОтражения.Добавить(ТекстЗапроса);
#КонецОбласти

#Область ТекстСписаниеКредиторскойЗадолженностиРасчетыСКлиентомПрочиеАктивыПассивы
	ТекстЗапроса = "
	|ВЫБРАТЬ //// Отражение задолженности покупателя в прочие активы/пассивы (Дт <62> :: Кт <Прочие счета>)
	|
	|	Расчеты.Ссылка КАК Ссылка,
	|	Расчеты.Период КАК Период,
	|	Расчеты.ОрганизацияАналитики КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА ПрочиеАктивыПассивы.СуммаРегл
	|		ИНАЧЕ Расчеты.СуммаРегл
	|	КОНЕЦ КАК Сумма,
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА ПрочиеАктивыПассивы.СуммаУпр
	|		ИНАЧЕ Расчеты.СуммаУпр
	|	КОНЕЦ КАК СуммаУУ,
	|
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами)
	|		ИНАЧЕ Расчеты.ВидСчета
	|	КОНЕЦ КАК ВидСчетаДт,
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	Расчеты.Валюта КАК ВалютаДт,
	|	Расчеты.Подразделение КАК ПодразделениеДт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|
	|	Расчеты.Контрагент КАК СубконтоДт1,
	|	Расчеты.Договор КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	ВЫБОР
	|		КОГДА НовыеРасчеты.НесколькоСтатей И ПрочиеАктивыПассивы.НомерСтроки <> 1 ИЛИ НЕ ПрочиеАктивыПассивы.ТолькоАктивыПассивы
	|		ТОГДА 0
	|		ИНАЧЕ 1
	|	КОНЕЦ * (Расчеты.Сумма + ВЫБОР КОГДА Расчеты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами)
	|			ТОГДА ЕСТЬNULL(РасчетыСДругимВидомСчета.Сумма, 0) ИНАЧЕ 0 КОНЕЦ) КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.ПрочиеАктивыПассивы) КАК ВидСчетаКт,
	|	ПрочиеАктивыПассивы.Статья КАК АналитикаУчетаКт,
	|	ПрочиеАктивыПассивы.Подразделение КАК МестоУчетаКт,
	|	
	|	НЕОПРЕДЕЛЕНО КАК ВалютаКт,
	|	ПрочиеАктивыПассивы.Подразделение КАК ПодразделениеКт,
	|	ПрочиеАктивыПассивы.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	ПрочиеАктивыПассивы.СчетУчета КАК СчетКт,
	|
	|	ПрочиеАктивыПассивы.Субконто1 КАК СубконтоКт1,
	|	ПрочиеАктивыПассивы.Субконто2 КАК СубконтоКт2,
	|	ПрочиеАктивыПассивы.Субконто3 КАК СубконтоКт3,
	|
	|	0 КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	ВЫБОР
	|		КОГДА Расчеты.НастройкаХозОперации = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеДебиторскойЗадолженности)
	|		ТОГДА ""Начислена дебиторская задолженность""
	|		ИНАЧЕ ""Списание задолженности перед покупателем в активы/пассивы""
	|	КОНЕЦ КАК Содержание
	|
	|ИЗ 
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСКлиентамиНоваяАрхитектура КАК Расчеты
	|	ПО
	|		ДокументыКОтражению.Ссылка = Расчеты.Ссылка
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСКлиентамиПоДокументам КАК НовыеРасчеты
	|	ПО
	|		Расчеты.Ссылка = НовыеРасчеты.Ссылка
	|		И Расчеты.ОбъектРасчетов = НовыеРасчеты.ОбъектРасчетов
	|		И НЕ НовыеРасчеты.СтарыйАлгоритм
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		ВТДанныеПрочиеАктивыПассивы КАК ПрочиеАктивыПассивы
	|	ПО
	|		Расчеты.Ссылка = ПрочиеАктивыПассивы.Регистратор
	|		И ПрочиеАктивыПассивы.ИдентификаторФинЗаписи = Расчеты.ИдентификаторФинЗаписи
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ РасчетыСКлиентамиНоваяАрхитектура КАК РасчетыСДругимВидомСчета
	|	ПО ДокументыКОтражению.Ссылка = РасчетыСДругимВидомСчета.Ссылка
	|		И НовыеРасчеты.НесколькоСтатей
	|		И РасчетыСДругимВидомСчета.ВидСчета <> Расчеты.ВидСчета
	|
	|ГДЕ
	|	(Расчеты.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами) ИЛИ РасчетыСДругимВидомСчета.Ссылка ЕСТЬ NULL ИЛИ НЕ НовыеРасчеты.НесколькоСтатей)
	|	И Расчеты.НастройкаХозОперации В (
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СписаниеКредиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеДебиторскойЗадолженности))
	|";
	ТекстыОтражения.Добавить(ТекстЗапроса);
#КонецОбласти

	ТекстыОтражения.Добавить(ТекстПереносАвансаСДолгаРасходыПоставщики()); // Перенос аванса (Дт <60.2> :: Кт <60.1>)
	ТекстыОтражения.Добавить(ТекстПереносАвансаСДолгаДоходыПоставщики()); // Перенос аванса (Дт <60.1> :: Кт <60.2>)
	ТекстыОтражения.Добавить(ТекстПереносАвансаСДолгаДоходыКлиенты()); // Перенос аванса (Дт <62.2> :: Кт <62.1>)
	ТекстыОтражения.Добавить(ТекстПереносАвансаСДолгаРасходыКлиенты()); // Перенос аванса (Дт <62.1> :: Кт <62.2>)
	
	//-- Локализация
	Возврат СтрСоединить(ТекстыОтражения, ОбщегоНазначенияУТ.РазделительЗапросовВОбъединении());
	
КонецФункции

// Функция возвращает текст запроса дополнительных временных таблиц,
// необходимых для отражения в регламентированном учете
//
// Возвращаемое значение:
//   Строка - сформированный текст запроса.
//
Функция ТекстЗапросаВТОтраженияВРеглУчете() Экспорт
	
	//++ Локализация
	
	ТекстыЗапроса = Новый Массив;
	
	#Область ВТДоходыРасходы
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	Операция.Ссылка КАК Ссылка,
	|	Операция.СтарыйВариантПроводок КАК СтарыйАлгоритм,
	|	МАКСИМУМ(ДоходыРасходы.НомерСтроки <> 1) КАК НесколькоСтрок
	|ПОМЕСТИТЬ ВТДоходыРасходы
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаЗадолженности КАК Операция
	|	ПО ДокументыКОтражению.Ссылка = Операция.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаЗадолженности.ДоходыРасходыАктивыПассивы КАК ДоходыРасходы
	|	ПО Операция.Ссылка = ДоходыРасходы.Ссылка
	|
	|СГРУППИРОВАТЬ ПО
	|	Операция.Ссылка
	|	
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область РасчетыСКлиентамиПоДокументам
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	Расчеты.Регистратор КАК Ссылка,
	|	ОбъектыРасчетов.Контрагент КАК Контрагент,
	|	ОбъектыРасчетов.Договор КАК Договор,
	|	ОбъектыРасчетов.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	Расчеты.ЗаказКлиента КАК ОбъектРасчетов,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	ОбъектыРасчетов.Подразделение КАК Подразделение,
	|	Расчеты.Валюта КАК Валюта,
	|	ИСТИНА КАК СтарыйАлгоритм,
	|	ЛОЖЬ КАК НесколькоСтатей,
	|	СУММА(ВЫБОР
	|		КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) И Расчеты.Предоплата < 0
	|		ТОГДА -Расчеты.Предоплата ИНАЧЕ Расчеты.Предоплата КОНЕЦ) КАК Предоплата,
	|	СУММА(ВЫБОР
	|		КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) И Расчеты.ПредоплатаУпр < 0
	|		ТОГДА -Расчеты.ПредоплатаУпр ИНАЧЕ Расчеты.ПредоплатаУпр КОНЕЦ) КАК ПредоплатаУпр,
	|	СУММА(ВЫБОР
	|		КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) И Расчеты.ПредоплатаРегл < 0
	|		ТОГДА -Расчеты.ПредоплатаРегл ИНАЧЕ Расчеты.ПредоплатаРегл КОНЕЦ) КАК ПредоплатаРегл,
	|	СУММА(ВЫБОР
	|		КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) И Расчеты.Долг < 0
	|		ТОГДА -Расчеты.Долг ИНАЧЕ Расчеты.Долг КОНЕЦ) КАК Долг,
	|	СУММА(ВЫБОР
	|		КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) И Расчеты.ДолгУпр < 0
	|		ТОГДА -Расчеты.ДолгУпр ИНАЧЕ Расчеты.ДолгУпр КОНЕЦ) КАК ДолгУпр,
	|	СУММА(ВЫБОР
	|		КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) И Расчеты.ДолгРегл < 0
	|		ТОГДА -Расчеты.ДолгРегл ИНАЧЕ Расчеты.ДолгРегл КОНЕЦ) КАК ДолгРегл,
	|	СУММА(ВЫБОР
	|		КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) И Расчеты.ЗалогЗаТару < 0
	|		ТОГДА -Расчеты.ЗалогЗаТару ИНАЧЕ Расчеты.ЗалогЗаТару КОНЕЦ) КАК ЗалогЗаТару,
	|	СУММА(ВЫБОР
	|		КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) И Расчеты.ЗалогЗаТаруРегл < 0
	|		ТОГДА -Расчеты.ЗалогЗаТаруРегл ИНАЧЕ Расчеты.ЗалогЗаТаруРегл КОНЕЦ) КАК ЗалогЗаТаруРегл
	|ПОМЕСТИТЬ РасчетыСКлиентамиПоДокументам
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.РасчетыСКлиентамиПоДокументам КАК Расчеты
	|	ПО
	|		ДокументыКОтражению.Ссылка = Расчеты.Регистратор
	|		И НЕ &НоваяАрхитектураВзаиморасчетов
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ОбъектыРасчетов КАК ОбъектыРасчетов
	|	ПО (Расчеты.ЗаказКлиента = ОбъектыРасчетов.Ссылка)
	|
	|СГРУППИРОВАТЬ ПО
	|	Расчеты.Регистратор,
	|	ОбъектыРасчетов.Контрагент,
	|	ОбъектыРасчетов.Договор,
	|	ОбъектыРасчетов.НаправлениеДеятельности,
	|	Расчеты.ЗаказКлиента,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета,
	|	ОбъектыРасчетов.Подразделение,
	|	Расчеты.Валюта,
	|	Расчеты.Долг <> 0
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Расчеты.Ссылка КАК Ссылка,
	|	Расчеты.Контрагент КАК Контрагент,
	|	Расчеты.Договор КАК Договор,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	Расчеты.ОбъектРасчетов КАК ОбъектРасчетов,
	|	Расчеты.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	Расчеты.Подразделение КАК Подразделение,
	|	Расчеты.Валюта КАК Валюта,
	|	Расчеты.ИдентификаторФинЗаписи = """" ИЛИ ДоходыРасходы.СтарыйАлгоритм КАК СтарыйАлгоритм,
	|	ДоходыРасходы.НесколькоСтрок КАК НесколькоСтатей,
	|	ВЫБОР КОГДА СУММА(Расчеты.Предоплата) < 0 ТОГДА -СУММА(Расчеты.Предоплата) ИНАЧЕ СУММА(Расчеты.Предоплата) КОНЕЦ КАК Предоплата,
	|	ВЫБОР КОГДА СУММА(Расчеты.ПредоплатаУпр) < 0 ТОГДА -СУММА(Расчеты.ПредоплатаУпр) ИНАЧЕ СУММА(Расчеты.ПредоплатаУпр) КОНЕЦ КАК ПредоплатаУпр,
	|	ВЫБОР КОГДА СУММА(Расчеты.ПредоплатаРегл) < 0 ТОГДА -СУММА(Расчеты.ПредоплатаРегл) ИНАЧЕ СУММА(Расчеты.ПредоплатаРегл) КОНЕЦ КАК ПредоплатаРегл,
	|	ВЫБОР КОГДА СУММА(Расчеты.Долг) < 0 ТОГДА -СУММА(Расчеты.Долг) ИНАЧЕ СУММА(Расчеты.Долг) КОНЕЦ КАК Долг,
	|	ВЫБОР КОГДА СУММА(Расчеты.ДолгУпр) < 0 ТОГДА -СУММА(Расчеты.ДолгУпр) ИНАЧЕ СУММА(Расчеты.ДолгУпр) КОНЕЦ КАК ДолгУпр,
	|	ВЫБОР КОГДА СУММА(Расчеты.ДолгРегл) < 0 ТОГДА -СУММА(Расчеты.ДолгРегл) ИНАЧЕ СУММА(Расчеты.ДолгРегл) КОНЕЦ КАК ДолгРегл,
	|	ВЫБОР КОГДА СУММА(Расчеты.ЗалогЗаТару) < 0 ТОГДА -СУММА(Расчеты.ЗалогЗаТару) ИНАЧЕ СУММА(Расчеты.ЗалогЗаТару) КОНЕЦ КАК ЗалогЗаТару,
	|	ВЫБОР КОГДА СУММА(Расчеты.ЗалогЗаТаруРегл) < 0 ТОГДА -СУММА(Расчеты.ЗалогЗаТаруРегл) ИНАЧЕ СУММА(Расчеты.ЗалогЗаТаруРегл) КОНЕЦ КАК ЗалогЗаТаруРегл
	|ИЗ
	|	РасчетыСКлиентамиНоваяАрхитектура КАК Расчеты
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДоходыРасходы КАК ДоходыРасходы
	|	ПО Расчеты.Ссылка = ДоходыРасходы.Ссылка
	|
	|СГРУППИРОВАТЬ ПО
	|	Расчеты.Ссылка,
	|	Расчеты.Контрагент,
	|	Расчеты.Договор,
	|	Расчеты.НаправлениеДеятельности,
	|	Расчеты.ОбъектРасчетов,
	|	Расчеты.ГруппаФинансовогоУчета,
	|	Расчеты.Подразделение,
	|	Расчеты.Валюта,
	|	Расчеты.ИдентификаторФинЗаписи = """" ИЛИ ДоходыРасходы.СтарыйАлгоритм,
	|	ДоходыРасходы.НесколькоСтрок,
	|	ВЫБОР КОГДА Расчеты.ИдентификаторФинЗаписи = """" ИЛИ ДоходыРасходы.СтарыйАлгоритм ТОГДА Расчеты.Долг <> 0 ИНАЧЕ ЛОЖЬ КОНЕЦ
	|	
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область РасчетыСПоставщикамиПоДокументам
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	Расчеты.Регистратор КАК Ссылка,
	|	ОбъектыРасчетов.Контрагент КАК Контрагент,
	|	ОбъектыРасчетов.Договор КАК Договор,
	|	ОбъектыРасчетов.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	ОбъектыРасчетов.Подразделение КАК Подразделение,
	|	Расчеты.ЗаказПоставщику КАК ОбъектРасчетов,
	|	Расчеты.Валюта КАК Валюта,
	|	ИСТИНА КАК СтарыйАлгоритм,
	|	ЛОЖЬ КАК НесколькоСтатей,
	|	СУММА(ВЫБОР
	|		КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) И Расчеты.Предоплата < 0
	|		ТОГДА -Расчеты.Предоплата ИНАЧЕ Расчеты.Предоплата КОНЕЦ) КАК Предоплата,
	|	СУММА(ВЫБОР
	|		КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) И Расчеты.ПредоплатаУпр < 0
	|		ТОГДА -Расчеты.ПредоплатаУпр ИНАЧЕ Расчеты.ПредоплатаУпр КОНЕЦ) КАК ПредоплатаУпр,
	|	СУММА(ВЫБОР
	|		КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) И Расчеты.ПредоплатаРегл < 0
	|		ТОГДА -Расчеты.ПредоплатаРегл ИНАЧЕ Расчеты.ПредоплатаРегл КОНЕЦ) КАК ПредоплатаРегл,
	|	СУММА(ВЫБОР
	|		КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) И Расчеты.Долг < 0
	|		ТОГДА -Расчеты.Долг ИНАЧЕ Расчеты.Долг КОНЕЦ) КАК Долг,
	|	СУММА(ВЫБОР
	|		КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) И Расчеты.ДолгУпр < 0
	|		ТОГДА -Расчеты.ДолгУпр ИНАЧЕ Расчеты.ДолгУпр КОНЕЦ) КАК ДолгУпр,
	|	СУММА(ВЫБОР
	|		КОГДА Расчеты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) И Расчеты.ДолгРегл < 0
	|		ТОГДА -Расчеты.ДолгРегл ИНАЧЕ Расчеты.ДолгРегл КОНЕЦ) КАК ДолгРегл
	|ПОМЕСТИТЬ РасчетыСПоставщикамиПоДокументам
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РегистрНакопления.РасчетыСПоставщикамиПоДокументам КАК Расчеты
	|	ПО
	|		ДокументыКОтражению.Ссылка = Расчеты.Регистратор
	|		И НЕ &НоваяАрхитектураВзаиморасчетов
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ОбъектыРасчетов КАК ОбъектыРасчетов
	|	ПО (Расчеты.ЗаказПоставщику = ОбъектыРасчетов.Ссылка)
	|	
	|СГРУППИРОВАТЬ ПО
	|	Расчеты.Регистратор,
	|	ОбъектыРасчетов.Контрагент,
	|	ОбъектыРасчетов.Договор,
	|	ОбъектыРасчетов.НаправлениеДеятельности,
	|	ОбъектыРасчетов.ГруппаФинансовогоУчета,
	|	ОбъектыРасчетов.Подразделение,
	|	Расчеты.ЗаказПоставщику,
	|	Расчеты.Валюта,
	|	Расчеты.Долг <> 0
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Расчеты.Ссылка КАК Ссылка,
	|	Расчеты.Контрагент КАК Контрагент,
	|	Расчеты.Договор КАК Договор,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	Расчеты.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	Расчеты.Подразделение КАК Подразделение,
	|	Расчеты.ОбъектРасчетов,
	|	Расчеты.Валюта КАК Валюта,
	|	Расчеты.ИдентификаторФинЗаписи = """" ИЛИ ДоходыРасходы.СтарыйАлгоритм КАК СтарыйАлгоритм,
	|	ДоходыРасходы.НесколькоСтрок КАК НесколькоСтатей,
	|	ВЫБОР КОГДА СУММА(Расчеты.Предоплата) < 0 ТОГДА -СУММА(Расчеты.Предоплата) ИНАЧЕ СУММА(Расчеты.Предоплата) КОНЕЦ КАК Предоплата,
	|	ВЫБОР КОГДА СУММА(Расчеты.ПредоплатаУпр) < 0 ТОГДА -СУММА(Расчеты.ПредоплатаУпр) ИНАЧЕ СУММА(Расчеты.ПредоплатаУпр) КОНЕЦ КАК ПредоплатаУпр,
	|	ВЫБОР КОГДА СУММА(Расчеты.ПредоплатаРегл) < 0 ТОГДА -СУММА(Расчеты.ПредоплатаРегл) ИНАЧЕ СУММА(Расчеты.ПредоплатаРегл) КОНЕЦ КАК ПредоплатаРегл,
	|	ВЫБОР КОГДА СУММА(Расчеты.Долг) < 0 ТОГДА -СУММА(Расчеты.Долг) ИНАЧЕ СУММА(Расчеты.Долг) КОНЕЦ КАК Долг,
	|	ВЫБОР КОГДА СУММА(Расчеты.ДолгУпр) < 0 ТОГДА -СУММА(Расчеты.ДолгУпр) ИНАЧЕ СУММА(Расчеты.ДолгУпр) КОНЕЦ КАК ДолгУпр,
	|	ВЫБОР КОГДА СУММА(Расчеты.ДолгРегл) < 0 ТОГДА -СУММА(Расчеты.ДолгРегл) ИНАЧЕ СУММА(Расчеты.ДолгРегл) КОНЕЦ КАК ДолгРегл
	|ИЗ
	|	РасчетыСПоставщикамиНоваяАрхитектура КАК Расчеты
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДоходыРасходы КАК ДоходыРасходы
	|	ПО Расчеты.Ссылка = ДоходыРасходы.Ссылка
	|
	|СГРУППИРОВАТЬ ПО
	|	Расчеты.Ссылка,
	|	Расчеты.Контрагент,
	|	Расчеты.Договор,
	|	Расчеты.НаправлениеДеятельности,
	|	Расчеты.ГруппаФинансовогоУчета,
	|	Расчеты.Подразделение,
	|	Расчеты.ОбъектРасчетов,
	|	Расчеты.Валюта,
	|	Расчеты.ИдентификаторФинЗаписи = """" ИЛИ ДоходыРасходы.СтарыйАлгоритм,
	|	ДоходыРасходы.НесколькоСтрок,
	|	ВЫБОР КОГДА Расчеты.ИдентификаторФинЗаписи = """" ИЛИ ДоходыРасходы.СтарыйАлгоритм ТОГДА Расчеты.Долг <> 0 ИНАЧЕ ЛОЖЬ КОНЕЦ
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область РезервыПоСомнительнымДолгам
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	Резервы.Регистратор КАК Ссылка,
	|	Резервы.ОбъектРасчетов КАК ОбъектРасчетов,
	|	Резервы.РасчетныйДокумент КАК РасчетныйДокумент,
	|	Резервы.ОбъектРасчетов.Подразделение КАК Подразделение,
	|	Резервы.ОбъектРасчетов.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ЕСТЬNULL(Резервы.ОбъектРасчетов.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка)) КАК ГруппаФинансовогоУчета,
	|	МИНИМУМ(Резервы.НомерСтроки) КАК НомерСтроки,
	|	СУММА(Резервы.СуммаРегл) КАК СуммаРегл,
	|	СУММА(Резервы.ПостояннаяРазница) КАК ПостояннаяРазница,
	|	СУММА(Резервы.ВременнаяРазница) КАК ВременнаяРазница,
	|	СУММА(Резервы.СуммаУпр) КАК СуммаУпр
	|ПОМЕСТИТЬ РезервыПоСомнительнымДолгам_ПоАналитике
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.РезервыПоСомнительнымДолгам КАК Резервы
	|		ПО ДокументыКОтражению.Ссылка = Резервы.Регистратор
	|		И НЕ Резервы.Сторно
	|СГРУППИРОВАТЬ ПО
	|	Резервы.Регистратор,
	|	Резервы.АналитикаУчетаПоПартнерам,
	|	Резервы.ОбъектРасчетов,
	|	Резервы.РасчетныйДокумент,
	|	ЕСТЬNULL(Резервы.ОбъектРасчетов.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаРасчетов.ПустаяСсылка))
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка
	|;
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Резервы.Ссылка,
	|	Резервы.ОбъектРасчетов,
	|	МИНИМУМ(Резервы.НомерСтроки) КАК НомерСтроки,
	|	СУММА(Резервы.СуммаРегл) КАК СуммаРегл,
	|	СУММА(Резервы.ПостояннаяРазница) КАК ПостояннаяРазница,
	|	СУММА(Резервы.ВременнаяРазница) КАК ВременнаяРазница,
	|	СУММА(Резервы.СуммаУпр) КАК СуммаУпр
	|ПОМЕСТИТЬ РезервыПоСомнительнымДолгам_ПоОбъектамРасчета
	|ИЗ
	|	РезервыПоСомнительнымДолгам_ПоАналитике КАК Резервы
	|СГРУППИРОВАТЬ ПО
	|	Резервы.Ссылка,
	|	Резервы.ОбъектРасчетов
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область ВТДанныеПрочиеРасходы
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ДанныеРегистра.Регистратор КАК Регистратор,
	|	ДанныеРегистра.Период КАК Период,
	|	ДанныеРегистра.Организация КАК Организация,
	|	ДанныеРегистра.СтатьяРасходов КАК СтатьяРасходов,
	|	ДанныеРегистра.Подразделение КАК Подразделение,
	|	ДанныеРегистра.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ДанныеРегистра.АналитикаРасходов КАК АналитикаРасходов,
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.ВариантРаспределенияРасходовРегл <> ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее)
	|		КОГДА ОбъектыСтроительства.СпособСтроительства <> ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.ПустаяСсылка)
	|		ТОГДА ОбъектыСтроительства.СпособСтроительства
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.Подрядный)
	|	КОНЕЦ КАК ТипЗатрат,
	|	СтатьиРасходов.ПринятиеКНалоговомуУчету КАК ПринятиеКНалоговомуУчету,
	|	ДанныеРегистра.ИдентификаторФинЗаписи КАК ИдентификаторФинЗаписи,
	|	ДанныеРегистра.НастройкаХозяйственнойОперации КАК НастройкаХозяйственнойОперации,
	|	СУММА(ДанныеРегистра.СуммаРегл) КАК СуммаРегл,
	|	СУММА(ДанныеРегистра.СуммаУпр) КАК СуммаУпр,
	|	СУММА(ДанныеРегистра.Сумма) КАК Сумма
	|ПОМЕСТИТЬ ВТДанныеПрочиеРасходыСводно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.ПрочиеРасходы КАК ДанныеРегистра
	|	ПО ДокументыКОтражению.Ссылка = ДанныеРегистра.Регистратор
	|		И НЕ ДанныеРегистра.Сторно
	|		И ДанныеРегистра.Активность
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиРасходов КАК СтатьиРасходов
	|	ПО ДанныеРегистра.СтатьяРасходов = СтатьиРасходов.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ОбъектыСтроительства КАК ОбъектыСтроительства
	|	ПО ОбъектыСтроительства.Ссылка = ДанныеРегистра.АналитикаРасходов
	|		И СтатьиРасходов.ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|
	|СГРУППИРОВАТЬ ПО
	|	ДанныеРегистра.Регистратор,
	|	ДанныеРегистра.Период,
	|	ДанныеРегистра.Организация,
	|	ДанныеРегистра.СтатьяРасходов,
	|	ДанныеРегистра.Подразделение,
	|	ДанныеРегистра.НаправлениеДеятельности,
	|	ДанныеРегистра.АналитикаРасходов,
	|	ВЫБОР
	|		КОГДА СтатьиРасходов.ВариантРаспределенияРасходовРегл <> ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаВнеоборотныеАктивы)
	|		ТОГДА ЗНАЧЕНИЕ(Перечисление.ТипыЗатратРегл.Прочее)
	|		КОГДА ОбъектыСтроительства.СпособСтроительства <> ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.ПустаяСсылка)
	|		ТОГДА ОбъектыСтроительства.СпособСтроительства
	|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.СпособыСтроительства.Подрядный)
	|	КОНЕЦ,
	|	СтатьиРасходов.ПринятиеКНалоговомуУчету,
	|	ДанныеРегистра.ИдентификаторФинЗаписи,
	|	ДанныеРегистра.НастройкаХозяйственнойОперации";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса);
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	АВТОНОМЕРЗАПИСИ() КАК НомерСтроки,
	|	ДанныеРегистра.Регистратор,
	|	ДанныеРегистра.Период,
	|	ДанныеРегистра.Организация,
	|	ДанныеРегистра.СтатьяРасходов,
	|	ДанныеРегистра.Подразделение,
	|	ДанныеРегистра.НаправлениеДеятельности,
	|	ДанныеРегистра.АналитикаРасходов,
	|	ДанныеРегистра.ТипЗатрат,
	|	ДанныеРегистра.ПринятиеКНалоговомуУчету КАК ПринятиеКНалоговомуУчету,
	|	ДанныеРегистра.ИдентификаторФинЗаписи КАК ИдентификаторФинЗаписи,
	|	ДанныеРегистра.НастройкаХозяйственнойОперации КАК НастройкаХозяйственнойОперации,
	|	ДанныеРегистра.СуммаРегл,
	|	ДанныеРегистра.СуммаУпр,
	|	ДанныеРегистра.Сумма
	|ПОМЕСТИТЬ ВТДанныеПрочиеРасходы
	|ИЗ
	|	ВТДанныеПрочиеРасходыСводно КАК ДанныеРегистра
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Регистратор,
	|	ИдентификаторФинЗаписи";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область ВТДанныеПрочиеДоходы
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ДанныеРегистра.Регистратор КАК Регистратор,
	|	ДанныеРегистра.Период КАК Период,
	|	ДанныеРегистра.Организация КАК Организация,
	|	ДанныеРегистра.СтатьяДоходов КАК СтатьяДоходов,
	|	ДанныеРегистра.Подразделение КАК Подразделение,
	|	ДанныеРегистра.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ДанныеРегистра.АналитикаДоходов,
	|	ЕСТЬNULL(ДанныеРегистра.СтатьяДоходов.ПринятиеКНалоговомуУчету, ЛОЖЬ) КАК ПринятиеКНалоговомуУчету,
	|	ДанныеРегистра.ИдентификаторФинЗаписи КАК ИдентификаторФинЗаписи,
	|	ДанныеРегистра.НастройкаХозяйственнойОперации КАК НастройкаХозяйственнойОперации,
	|	СУММА(ДанныеРегистра.СуммаРегл) КАК СуммаРегл,
	|	СУММА(ДанныеРегистра.СуммаУпр) КАК СуммаУпр,
	|	СУММА(ДанныеРегистра.Сумма) КАК Сумма
	|ПОМЕСТИТЬ ВТДанныеПрочиеДоходыСводно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.ПрочиеДоходы КАК ДанныеРегистра
	|	ПО ДокументыКОтражению.Ссылка = ДанныеРегистра.Регистратор
	|		И НЕ ДанныеРегистра.Сторно
	|		И ДанныеРегистра.Активность
	|
	|СГРУППИРОВАТЬ ПО
	|	ДанныеРегистра.Регистратор,
	|	ДанныеРегистра.Период,
	|	ДанныеРегистра.Организация,
	|	ДанныеРегистра.СтатьяДоходов,
	|	ДанныеРегистра.Подразделение,
	|	ДанныеРегистра.НаправлениеДеятельности,
	|	ДанныеРегистра.АналитикаДоходов,
	|	ЕСТЬNULL(ДанныеРегистра.СтатьяДоходов.ПринятиеКНалоговомуУчету, ЛОЖЬ),
	|	ДанныеРегистра.ИдентификаторФинЗаписи,
	|	ДанныеРегистра.НастройкаХозяйственнойОперации";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса);
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	АВТОНОМЕРЗАПИСИ() КАК НомерСтроки,
	|	ДанныеРегистра.Регистратор,
	|	ДанныеРегистра.Период,
	|	ДанныеРегистра.Организация,
	|	ДанныеРегистра.СтатьяДоходов,
	|	ДанныеРегистра.Подразделение,
	|	ДанныеРегистра.НаправлениеДеятельности,
	|	ДанныеРегистра.АналитикаДоходов,
	|	ДанныеРегистра.ПринятиеКНалоговомуУчету КАК ПринятиеКНалоговомуУчету,
	|	ДанныеРегистра.ИдентификаторФинЗаписи КАК ИдентификаторФинЗаписи,
	|	ДанныеРегистра.НастройкаХозяйственнойОперации КАК НастройкаХозяйственнойОперации,
	|	ДанныеРегистра.СуммаРегл,
	|	ДанныеРегистра.СуммаУпр,
	|	ДанныеРегистра.Сумма
	|ПОМЕСТИТЬ ВТДанныеПрочиеДоходы
	|ИЗ
	|	ВТДанныеПрочиеДоходыСводно КАК ДанныеРегистра
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Регистратор,
	|	ИдентификаторФинЗаписи";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	#Область ВТДанныеПрочиеАктивыПассивы
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ДанныеРегистра.Регистратор КАК Регистратор,
	|	ДанныеРегистра.Период КАК Период,
	|	ДанныеРегистра.Организация КАК Организация,
	|	ДанныеРегистра.Статья КАК Статья,
	|	ДанныеРегистра.Подразделение КАК Подразделение,
	|	ДанныеРегистра.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ЕСТЬNULL(НастройкиСчетовУчета.СчетУчета, НЕОПРЕДЕЛЕНО) КАК СчетУчета,
	|	ЕСТЬNULL(НастройкиСчетовУчета.Субконто1, НЕОПРЕДЕЛЕНО) КАК Субконто1,
	|	ЕСТЬNULL(НастройкиСчетовУчета.Субконто2, НЕОПРЕДЕЛЕНО) КАК Субконто2,
	|	ЕСТЬNULL(НастройкиСчетовУчета.Субконто3, НЕОПРЕДЕЛЕНО) КАК Субконто3,
	|	ДанныеРегистра.ИдентификаторФинЗаписи КАК ИдентификаторФинЗаписи,
	|	ДанныеРегистра.НастройкаХозяйственнойОперации КАК НастройкаХозяйственнойОперации,
	|	СУММА(ДанныеРегистра.СуммаРегл) КАК СуммаРегл,
	|	СУММА(ДанныеРегистра.СуммаУпр) КАК СуммаУпр,
	|	СУММА(ДанныеРегистра.СуммаСНДС) КАК СуммаСНДС,
	|	МИНИМУМ(ДанныеПоПрочимДоходамРасходам.Регистратор ЕСТЬ NULL) КАК ТолькоАктивыПассивы
	|ПОМЕСТИТЬ ВТДанныеПрочиеАктивыПассивыСводно
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.ДвиженияПоПрочимАктивамПассивам КАК ДанныеРегистра
	|	ПО ДокументыКОтражению.Ссылка = ДанныеРегистра.Регистратор
	|		И НЕ ДанныеРегистра.Сторно
	|		И ДанныеРегистра.Активность
	|	ЛЕВОЕ СОЕДИНЕНИЕ (
	|		ВЫБРАТЬ ПЕРВЫЕ 1 Т.Регистратор ИЗ ВТДанныеПрочиеРасходы КАК Т
	|		ОБЪЕДИНИТЬ ВСЕ
	|		ВЫБРАТЬ ПЕРВЫЕ 1 Т.Регистратор ИЗ ВТДанныеПрочиеДоходы КАК Т
	|	) КАК ДанныеПоПрочимДоходамРасходам
	|	ПО ДокументыКОтражению.Ссылка = ДанныеПоПрочимДоходамРасходам.Регистратор
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.НастройкиСчетовУчетаПрочихОпераций КАК НастройкиСчетовУчета
	|	ПО ДанныеРегистра.НастройкаСчетовУчета = НастройкиСчетовУчета.Ссылка
	|
	|СГРУППИРОВАТЬ ПО
	|	ДанныеРегистра.Регистратор,
	|	ДанныеРегистра.Период,
	|	ДанныеРегистра.Организация,
	|	ДанныеРегистра.Статья,
	|	ДанныеРегистра.Подразделение,
	|	ДанныеРегистра.НаправлениеДеятельности,
	|	ЕСТЬNULL(НастройкиСчетовУчета.СчетУчета, НЕОПРЕДЕЛЕНО),
	|	ЕСТЬNULL(НастройкиСчетовУчета.Субконто1, НЕОПРЕДЕЛЕНО),
	|	ЕСТЬNULL(НастройкиСчетовУчета.Субконто2, НЕОПРЕДЕЛЕНО),
	|	ЕСТЬNULL(НастройкиСчетовУчета.Субконто3, НЕОПРЕДЕЛЕНО),
	|	ДанныеРегистра.ИдентификаторФинЗаписи,
	|	ДанныеРегистра.НастройкаХозяйственнойОперации";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса);
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	АВТОНОМЕРЗАПИСИ() КАК НомерСтроки,
	|	ДанныеРегистра.Регистратор,
	|	ДанныеРегистра.Период,
	|	ДанныеРегистра.Организация,
	|	ДанныеРегистра.Статья,
	|	ДанныеРегистра.Подразделение,
	|	ДанныеРегистра.НаправлениеДеятельности,
	|	ДанныеРегистра.СчетУчета,
	|	ДанныеРегистра.Субконто1,
	|	ДанныеРегистра.Субконто2,
	|	ДанныеРегистра.Субконто3,
	|	ДанныеРегистра.ИдентификаторФинЗаписи КАК ИдентификаторФинЗаписи,
	|	ДанныеРегистра.НастройкаХозяйственнойОперации КАК НастройкаХозяйственнойОперации,
	|	ДанныеРегистра.СуммаРегл,
	|	ДанныеРегистра.СуммаУпр,
	|	ДанныеРегистра.СуммаСНДС,
	|	ДанныеРегистра.ТолькоАктивыПассивы
	|ПОМЕСТИТЬ ВТДанныеПрочиеАктивыПассивы
	|ИЗ
	|	ВТДанныеПрочиеАктивыПассивыСводно КАК ДанныеРегистра
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Регистратор,
	|	ИдентификаторФинЗаписи";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса);
	
	#КонецОбласти
	
	ТекстЗапроса = СтрСоединить(ТекстыЗапроса, ОбщегоНазначения.РазделительПакетаЗапросов());
	ТекстЗапроса = ТекстЗапроса + ОбщегоНазначения.РазделительПакетаЗапросов();
	Возврат ТекстЗапроса;
	
	//-- Локализация
	Возврат "";
	
КонецФункции

#КонецОбласти
//-- НЕ УТ

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

#Область Проведение

// Процедура дополняет тексты запросов проведения документа.
//
// Параметры:
//  Запрос - Запрос - Общий запрос проведения документа.
//  ТекстыЗапроса - СписокЗначений - Список текстов запроса проведения.
//  Регистры - Строка, Структура - Список регистров проведения документа через запятую или в ключах структуры.
//
Процедура ДополнитьТекстыЗапросовПроведения(Запрос, ТекстыЗапроса, Регистры) Экспорт
	
	//++ Локализация

	//++ НЕ УТ
	ТекстЗапросаТаблицаПорядокОтраженияПрочихОпераций(Запрос, ТекстыЗапроса, Регистры);
	ТекстЗапросаТаблицаКУДиР(Запрос, ТекстыЗапроса, Регистры);
	ТекстЗапросаТаблицаОтражениеДокументовВРеглУчете(Запрос, ТекстыЗапроса, Регистры);
	//-- НЕ УТ

	//-- Локализация
	
КонецПроцедуры

//++ Локализация

//++ НЕ УТ

Функция ТекстЗапросаТаблицаПорядокОтраженияПрочихОпераций(Запрос, ТекстыЗапроса, Регистры)
	
	ИмяРегистра = "ПорядокОтраженияПрочихОпераций";
	
	Если Не ПроведениеДокументов.ТребуетсяТаблицаДляДвижений(ИмяРегистра, Регистры) Тогда
		Возврат "";
	КонецЕсли;
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	&Ссылка              КАК Документ,
	|	""""                 КАК ИдентификаторСтроки,
	|	&Период              КАК Дата,
	|	&Организация         КАК Организация,
	|	""""                 КАК СчетУчета,
	|	""""                 КАК Субконто1,
	|	""""                 КАК Субконто2,
	|	""""                 КАК Субконто3
	|ГДЕ
	|	&ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеДебиторскойЗадолженности)
	|	И &ВариантРаспределенияРасходовРегл = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаПрочиеАктивы)
	|	И &ВидЦенностиНДСРасходов = ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.ПрочиеРаботыИУслуги)";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса, ИмяРегистра);
	
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстЗапросаТаблицаКУДиР(Запрос, ТекстыЗапроса, Регистры)
	
	ИмяРегистра = "КнигаУчетаДоходовИРасходов";
	
	Если НЕ ПроведениеДокументов.ТребуетсяТаблицаДляДвижений(ИмяРегистра, Регистры) Тогда
		Возврат "";
	КонецЕсли;
	
	Если Не ПроведениеДокументов.ЕстьТаблицаЗапроса("ТаблицаЗадолженность", ТекстыЗапроса) Тогда
		Документы.КорректировкаЗадолженности.ТекстЗапросаВременнаяТаблицаЗадолженность(Запрос, ТекстыЗапроса);
	КонецЕсли;
	
	ПрименяетсяПСН = УчетнаяПолитика.ПрименяетсяПСН(Запрос.Параметры.Организация, Запрос.Параметры.Период);
	Запрос.УстановитьПараметр("ИспользуетсяПСН", ПрименяетсяПСН);
	
	Если НЕ ПроведениеДокументов.ЕстьТаблицаЗапроса("ТаблицаДействующихПатентов", ТекстыЗапроса) Тогда
		УчетУСНПСНСервер.ТекстЗапросаТаблицаДействующихПатентовПодразделениям(Запрос, ТекстыЗапроса);
	КонецЕсли;
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	&Период КАК Период,
	|	&Ссылка КАК Регистратор,
	|	&Организация КАК Организация,
	|	&Ссылка КАК ДокументВозникновенияДоходовРасходов,
	|	СУММА(Задолженность.СуммаРегл) КАК Графа4,
	|	СУММА(ВЫБОР
	|			КОГДА НЕ Задолженность.НалогообложениеНДС В (ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяЕНВД),
	|											ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаПоПатенту))
	|				И ЕСТЬNULL(СтатьиДоходов.ВидДеятельностиДляНалоговогоУчетаЗатрат, НЕОПРЕДЕЛЕНО) =
	|					ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсновнаяСистемаНалогообложения)
	|				ТОГДА Задолженность.СуммаРегл ИНАЧЕ 0 КОНЕЦ) КАК Графа5,
	|	0 Как Графа6,
	|	0 Как Графа7,
	|	0 Как НДС,
	|	СУММА(ВЫБОР
	|			КОГДА Задолженность.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяЕНВД)
	|				И ЕСТЬNULL(СтатьиДоходов.ВидДеятельностиДляНалоговогоУчетаЗатрат, НЕОПРЕДЕЛЕНО) =
	|					ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|				ТОГДА Задолженность.СуммаРегл ИНАЧЕ 0 КОНЕЦ) КАК ДоходЕНВД,
	|	СУММА(ВЫБОР
	|			КОГДА Задолженность.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаПоПатенту)
	|				И ЕСТЬNULL(СтатьиДоходов.ВидДеятельностиДляНалоговогоУчетаЗатрат, НЕОПРЕДЕЛЕНО) =
	|					ЗНАЧЕНИЕ(Перечисление.ВидыДеятельностиДляНалоговогоУчетаЗатрат.ОсобыйПорядокНалогообложения)
	|				ТОГДА Задолженность.СуммаРегл ИНАЧЕ 0 КОНЕЦ) КАК ДоходПатент,
	|	ЕСТЬNULL(ТаблицаДействующихПатентов.Патент, ЗНАЧЕНИЕ(Справочник.Патенты.ПустаяСсылка)) КАК Патент,
	|	&Номер КАК Номер,
	|	&Период КАК Дата,
	|	&ХозяйственнаяОперация КАК ХозяйственнаяОперация,
	|	&Контрагент КАК Контрагент,
	|	ЕстьNULL(СтатьиДоходов.Ссылка, Задолженность.СтатьяАктивовПассивов) КАК Статья
	|	
	|ИЗ
	|	ТаблицаЗадолженность КАК Задолженность
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовХарактеристик.СтатьиДоходов КАК СтатьиДоходов
	|		ПО Задолженность.СтатьяДоходов = СтатьиДоходов.Ссылка
	|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаДействующихПатентов КАК ТаблицаДействующихПатентов
	|		ПО Задолженность.Подразделение = ТаблицаДействующихПатентов.Подразделение
	|			И Задолженность.НалогообложениеНДС = ЗНАЧЕНИЕ(Перечисление.ТипыНалогообложенияНДС.ПродажаПоПатенту)
	|	
	|ГДЕ
	|	&ХозяйственнаяОперация В (
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.НачислениеДебиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеКредиторскойЗадолженности))
	|	И НЕ (&ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.СписаниеКредиторскойЗадолженности) 
	|          И Задолженность.ТипРасчетов = ЗНАЧЕНИЕ(Перечисление.ТипыРасчетовСПартнерами.РасчетыСКлиентом))	
	|	И &КорреспонденцияСДоходами
	|
	|СГРУППИРОВАТЬ ПО
	|	СтатьиДоходов.Ссылка,
	|	ЕСТЬNULL(ТаблицаДействующихПатентов.Патент, ЗНАЧЕНИЕ(Справочник.Патенты.ПустаяСсылка)),
	|	ЕстьNULL(СтатьиДоходов.Ссылка, Задолженность.СтатьяАктивовПассивов)";
	
	ТекстыЗапроса.Добавить(ТекстЗапроса, ИмяРегистра);
	
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстЗапросаТаблицаОтражениеДокументовВРеглУчете(Запрос, ТекстыЗапроса, Регистры)
	
	ИмяРегистра = "ОтражениеДокументовВРеглУчете";
	
	Если Не ПроведениеДокументов.ТребуетсяТаблицаДляДвижений(ИмяРегистра, Регистры) Тогда
		Возврат "";
	КонецЕсли; 
	
	Если Не ПроведениеДокументов.ЕстьТаблицаЗапроса("ВтПрочиеРасходы", ТекстыЗапроса) Тогда
		Документы.КорректировкаЗадолженности.ТекстЗапросаТаблицаВтПрочиеРасходы(Запрос, ТекстыЗапроса);
	КонецЕсли;
	
	ТекстЗапроса = "
	|ВЫБРАТЬ
	|	&Период                      КАК Период,
	|	&Организация                 КАК Организация,
	|	НАЧАЛОПЕРИОДА(&Период, ДЕНЬ) КАК ДатаОтражения
	|";
	ТекстЗапроса = ТекстЗапроса + "ОБЪЕДИНИТЬ ВСЕ"
		+ ДоходыИРасходыСервер.ДополнитьТекстЗапросаТаблицаОтражениеДокументовВРеглУчете(Ложь);
	
	ТекстыЗапроса.Добавить(ТекстЗапроса, ИмяРегистра);
	
	Возврат ТекстЗапроса;
	
КонецФункции
//-- НЕ УТ

//-- Локализация

#КонецОбласти

//++ Локализация

//++ НЕ УТ

#Область ФрагментыПроводокРеглУчета

Функция ТекстПереносАвансаСДолгаРасходыПоставщики()
	
	Возврат "
	|ВЫБРАТЬ РАЗЛИЧНЫЕ // Перенос аванса (Дт <60.1> :: Кт <60.2>)
	|
	|	РасчетыПоПретензиям.Ссылка КАК Ссылка,
	|	РасчетыПоПретензиям.Период КАК Период,
	|	РасчетыПоПретензиям.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Расчеты.СуммаРегл КАК Сумма,
	|	Расчеты.СуммаУпр КАК СуммаУУ,
	|
	|	РасчетыПоПретензиям.ВидСчета КАК ВидСчетаДт,
	|	РасчетыПоПретензиям.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	РасчетыПоПретензиям.Валюта КАК ВалютаДт,
	|	РасчетыПоПретензиям.Подразделение КАК ПодразделениеДт,
	|	РасчетыПоПретензиям.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|	РасчетыПоПретензиям.Контрагент КАК СубконтоДт1,
	|	РасчетыПоПретензиям.Договор КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	Расчеты.Сумма КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	Расчеты.ВидСчета КАК ВидСчетаКт,
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	Расчеты.Валюта КАК ВалютаКт,
	|	Расчеты.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	Расчеты.Контрагент КАК СубконтоКт1,
	|	Расчеты.Договор КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	Расчеты.Сумма КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Перенос аванса"" КАК Содержание
	|
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСПоставщикамиНоваяАрхитектура КАК РасчетыПоПретензиям
	|	ПО
	|		ДокументыКОтражению.Ссылка = РасчетыПоПретензиям.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСПоставщикамиНоваяАрхитектура КАК Расчеты
	|	ПО
	|		РасчетыПоПретензиям.Ссылка = Расчеты.Ссылка
	|		И РасчетыПоПретензиям.ИдентификаторФинЗаписи = Расчеты.ИдентификаторФинЗаписи
	|		И РасчетыПоПретензиям.НастройкаХозОперации = Расчеты.НастройкаХозОперации
	|		И РасчетыПоПретензиям.ВидСчета <> Расчеты.ВидСчета
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСПоставщикамиПоДокументам КАК НовыеРасчеты
	|	ПО
	|		Расчеты.Ссылка = НовыеРасчеты.Ссылка
	|		И Расчеты.ОбъектРасчетов = НовыеРасчеты.ОбъектРасчетов
	|		И НЕ НовыеРасчеты.СтарыйАлгоритм
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ РасчетыСПоставщикамиНоваяАрхитектура КАК РасчетыПоДолгу
	|	ПО ДокументыКОтражению.Ссылка = РасчетыПоДолгу.Ссылка
	|		И НовыеРасчеты.НесколькоСтатей
	|		И РасчетыПоДолгу.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками)
	|
	|ГДЕ
	|	НовыеРасчеты.НесколькоСтатей
	|	И (РасчетыПоПретензиям.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками) ИЛИ РасчетыПоДолгу.Ссылка ЕСТЬ NULL)
	|	И РасчетыПоПретензиям.НастройкаХозОперации В (
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеКредиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СписаниеДебиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СписаниеБезнадежнойЗадолженностиЗаСчетРезервовПоСомнительнымДолгам))
	|";
	
КонецФункции

Функция ТекстПереносАвансаСДолгаДоходыПоставщики()
	
	Возврат "
	|ВЫБРАТЬ РАЗЛИЧНЫЕ // Перенос аванса (Дт <60.2> :: Кт <60.1>)
	|
	|	РасчетыПоПретензиям.Ссылка КАК Ссылка,
	|	РасчетыПоПретензиям.Период КАК Период,
	|	РасчетыПоПретензиям.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Расчеты.СуммаРегл КАК Сумма,
	|	Расчеты.СуммаУпр КАК СуммаУУ,
	|
	|	Расчеты.ВидСчета КАК ВидСчетаДт,
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	Расчеты.Валюта КАК ВалютаДт,
	|	Расчеты.Подразделение КАК ПодразделениеДт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|	Расчеты.Контрагент КАК СубконтоДт1,
	|	Расчеты.Договор КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	Расчеты.Сумма КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	РасчетыПоПретензиям.ВидСчета КАК ВидСчетаКт,
	|	РасчетыПоПретензиям.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	РасчетыПоПретензиям.Валюта КАК ВалютаКт,
	|	РасчетыПоПретензиям.Подразделение КАК ПодразделениеКт,
	|	РасчетыПоПретензиям.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	РасчетыПоПретензиям.Контрагент КАК СубконтоКт1,
	|	РасчетыПоПретензиям.Договор КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	Расчеты.Сумма КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Перенос аванса"" КАК Содержание
	|
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|	СОЕДИНЕНИЕ
	|		РасчетыСПоставщикамиНоваяАрхитектура КАК РасчетыПоПретензиям
	|	ПО
	|		ДокументыКОтражению.Ссылка = РасчетыПоПретензиям.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСПоставщикамиНоваяАрхитектура КАК Расчеты
	|	ПО
	|		РасчетыПоПретензиям.Ссылка = Расчеты.Ссылка
	|		И РасчетыПоПретензиям.ИдентификаторФинЗаписи = Расчеты.ИдентификаторФинЗаписи
	|		И РасчетыПоПретензиям.НастройкаХозОперации = Расчеты.НастройкаХозОперации
	|		И РасчетыПоПретензиям.ВидСчета <> Расчеты.ВидСчета
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСПоставщикамиПоДокументам КАК НовыеРасчеты
	|	ПО
	|		Расчеты.Ссылка = НовыеРасчеты.Ссылка
	|		И Расчеты.ОбъектРасчетов = НовыеРасчеты.ОбъектРасчетов
	|		И НЕ НовыеРасчеты.СтарыйАлгоритм
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ РасчетыСПоставщикамиНоваяАрхитектура КАК РасчетыПоДолгу
	|	ПО ДокументыКОтражению.Ссылка = РасчетыПоДолгу.Ссылка
	|		И НовыеРасчеты.НесколькоСтатей
	|		И РасчетыПоДолгу.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками)
	|
	|ГДЕ
	|	НовыеРасчеты.НесколькоСтатей
	|	И (РасчетыПоПретензиям.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСПоставщиками) ИЛИ РасчетыПоДолгу.Ссылка ЕСТЬ NULL)
	|	И РасчетыПоПретензиям.НастройкаХозОперации В (
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеДебиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СписаниеКредиторскойЗадолженности))
	|";
	
КонецФункции

Функция ТекстПереносАвансаСДолгаДоходыКлиенты()
	
	Возврат "
	|ВЫБРАТЬ РАЗЛИЧНЫЕ // Перенос аванса (Дт <62.2> :: Кт <62.1>)
	|
	|	РасчетыПоПретензиям.Ссылка КАК Ссылка,
	|	РасчетыПоПретензиям.Период КАК Период,
	|	РасчетыПоПретензиям.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Расчеты.СуммаРегл КАК Сумма,
	|	Расчеты.СуммаУпр КАК СуммаУУ,
	|
	|	Расчеты.ВидСчета КАК ВидСчетаДт,
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	Расчеты.Валюта КАК ВалютаДт,
	|	Расчеты.Подразделение КАК ПодразделениеДт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|	Расчеты.Контрагент КАК СубконтоДт1,
	|	Расчеты.Договор КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	Расчеты.Сумма КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	РасчетыПоПретензиям.ВидСчета КАК ВидСчетаКт,
	|	РасчетыПоПретензиям.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	РасчетыПоПретензиям.Валюта КАК ВалютаКт,
	|	РасчетыПоПретензиям.Подразделение КАК ПодразделениеКт,
	|	РасчетыПоПретензиям.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	РасчетыПоПретензиям.Контрагент КАК СубконтоКт1,
	|	РасчетыПоПретензиям.Договор КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	Расчеты.Сумма КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Перенос аванса"" КАК Содержание
	|
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСКлиентамиНоваяАрхитектура КАК РасчетыПоПретензиям
	|	ПО
	|		ДокументыКОтражению.Ссылка = РасчетыПоПретензиям.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСКлиентамиНоваяАрхитектура КАК Расчеты
	|	ПО
	|		РасчетыПоПретензиям.Ссылка = Расчеты.Ссылка
	|		И РасчетыПоПретензиям.ИдентификаторФинЗаписи = Расчеты.ИдентификаторФинЗаписи
	|		И РасчетыПоПретензиям.НастройкаХозОперации = Расчеты.НастройкаХозОперации
	|		И РасчетыПоПретензиям.ВидСчета <> Расчеты.ВидСчета
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСКлиентамиПоДокументам КАК НовыеРасчеты
	|	ПО
	|		Расчеты.Ссылка = НовыеРасчеты.Ссылка
	|		И Расчеты.ОбъектРасчетов = НовыеРасчеты.ОбъектРасчетов
	|		И НЕ НовыеРасчеты.СтарыйАлгоритм
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ РасчетыСКлиентамиНоваяАрхитектура КАК РасчетыПоДолгу
	|	ПО ДокументыКОтражению.Ссылка = РасчетыПоДолгу.Ссылка
	|		И НовыеРасчеты.НесколькоСтатей
	|		И РасчетыПоДолгу.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами)
	|
	|ГДЕ
	|	НовыеРасчеты.НесколькоСтатей
	|	И (РасчетыПоПретензиям.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами) ИЛИ РасчетыПоДолгу.Ссылка ЕСТЬ NULL)
	|	И РасчетыПоПретензиям.НастройкаХозОперации В (
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СписаниеКредиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеДебиторскойЗадолженности))
	|";
	
КонецФункции

Функция ТекстПереносАвансаСДолгаРасходыКлиенты()
	
	Возврат "
	|ВЫБРАТЬ РАЗЛИЧНЫЕ // Перенос аванса (Дт <62.1> :: Кт <62.2>)
	|
	|	РасчетыПоПретензиям.Ссылка КАК Ссылка,
	|	РасчетыПоПретензиям.Период КАК Период,
	|	РасчетыПоПретензиям.Организация КАК Организация,
	|	НЕОПРЕДЕЛЕНО КАК ИдентификаторСтроки,
	|
	|	Расчеты.СуммаРегл КАК Сумма,
	|	Расчеты.СуммаУпр КАК СуммаУУ,
	|
	|	РасчетыПоПретензиям.ВидСчета КАК ВидСчетаДт,
	|	РасчетыПоПретензиям.ГруппаФинансовогоУчета КАК АналитикаУчетаДт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаДт,
	|
	|	РасчетыПоПретензиям.Валюта КАК ВалютаДт,
	|	РасчетыПоПретензиям.Подразделение КАК ПодразделениеДт,
	|	РасчетыПоПретензиям.НаправлениеДеятельности КАК НаправлениеДеятельностиДт,
	|
	|	НЕОПРЕДЕЛЕНО КАК СчетДт,
	|	РасчетыПоПретензиям.Контрагент КАК СубконтоДт1,
	|	РасчетыПоПретензиям.Договор КАК СубконтоДт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоДт3,
	|	
	|	Расчеты.Сумма КАК ВалютнаяСуммаДт,
	|	0 КАК КоличествоДт,
	|	0 КАК СуммаНУДт,
	|	0 КАК СуммаПРДт,
	|	0 КАК СуммаВРДт,
	|	
	|	Расчеты.ВидСчета КАК ВидСчетаКт,
	|	Расчеты.ГруппаФинансовогоУчета КАК АналитикаУчетаКт,
	|	НЕОПРЕДЕЛЕНО КАК МестоУчетаКт,
	|
	|	Расчеты.Валюта КАК ВалютаКт,
	|	Расчеты.Подразделение КАК ПодразделениеКт,
	|	Расчеты.НаправлениеДеятельности КАК НаправлениеДеятельностиКт,
	|
	|	ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка) КАК СчетКт,
	|	Расчеты.Контрагент КАК СубконтоКт1,
	|	Расчеты.Договор КАК СубконтоКт2,
	|	НЕОПРЕДЕЛЕНО КАК СубконтоКт3,
	|
	|	Расчеты.Сумма КАК ВалютнаяСуммаКт,
	|	0 КАК КоличествоКт,
	|	0 КАК СуммаНУКт,
	|	0 КАК СуммаПРКт,
	|	0 КАК СуммаВРКт,
	|	""Перенос аванса"" КАК Содержание
	|
	|ИЗ
	|	ДокументыКОтражению КАК ДокументыКОтражению
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСКлиентамиНоваяАрхитектура КАК РасчетыПоПретензиям
	|	ПО
	|		ДокументыКОтражению.Ссылка = РасчетыПоПретензиям.Ссылка
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСКлиентамиНоваяАрхитектура КАК Расчеты
	|	ПО
	|		РасчетыПоПретензиям.Ссылка = Расчеты.Ссылка
	|		И РасчетыПоПретензиям.ИдентификаторФинЗаписи = Расчеты.ИдентификаторФинЗаписи
	|		И РасчетыПоПретензиям.НастройкаХозОперации = Расчеты.НастройкаХозОперации
	|		И РасчетыПоПретензиям.ВидСчета <> Расчеты.ВидСчета
	|	
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ
	|		РасчетыСКлиентамиПоДокументам КАК НовыеРасчеты
	|	ПО
	|		Расчеты.Ссылка = НовыеРасчеты.Ссылка
	|		И Расчеты.ОбъектРасчетов = НовыеРасчеты.ОбъектРасчетов
	|		И НЕ НовыеРасчеты.СтарыйАлгоритм
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ РасчетыСКлиентамиНоваяАрхитектура КАК РасчетыПоДолгу
	|	ПО ДокументыКОтражению.Ссылка = РасчетыПоДолгу.Ссылка
	|		И НовыеРасчеты.НесколькоСтатей
	|		И РасчетыПоДолгу.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами)
	|
	|ГДЕ
	|	НовыеРасчеты.НесколькоСтатей
	|	И (РасчетыПоПретензиям.ВидСчета = ЗНАЧЕНИЕ(Перечисление.ВидыСчетовРеглУчета.РасчетыСКлиентами) ИЛИ РасчетыПоДолгу.Ссылка ЕСТЬ NULL)
	|	И РасчетыПоПретензиям.НастройкаХозОперации В (
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.НачислениеКредиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СписаниеДебиторскойЗадолженности),
	|		ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.СписаниеБезнадежнойЗадолженностиЗаСчетРезервовПоСомнительнымДолгам))
	|";
	
КонецФункции

#КонецОбласти

//-- НЕ УТ

//-- Локализация

#КонецОбласти
