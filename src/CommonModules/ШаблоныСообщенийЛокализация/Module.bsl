
#Область ПрограммныйИнтерфейс

// Вызывается при подготовке шаблонов сообщений и позволяет переопределить список реквизитов и вложений.
//
// см. ШаблоныСообщенийПереопределяемый.ПриПодготовкеШаблонаСообщения
//
Процедура ПриПодготовкеШаблонаСообщения(Реквизиты, Вложения, НазначениеШаблона, ДополнительныеПараметры) Экспорт
	
	//++ Локализация
	МассивНазначенийШаблона = Новый Массив;
	Для Каждого ЗначениеПеречисления ИЗ Перечисления.ТипыСобытийОповещений.ИзменениеСостоянияЗаказа.Метаданные().ЗначенияПеречисления Цикл
		Если НЕ Перечисления.ТипыСобытийОповещений.ДанныеДляОбработкиОчередиОповещений(Перечисления.ТипыСобытийОповещений[ЗначениеПеречисления.Имя]).ДоступноДляИспользования Тогда
			Продолжить;
		КонецЕсли;
		МассивНазначенийШаблона.Добавить(ЗначениеПеречисления.Имя);
	КонецЦикла;
	
	НазначениеШаблонаЭтоОповещение = Ложь;
	Если МассивНазначенийШаблона.Найти(НазначениеШаблона) <> Неопределено Тогда
		НазначениеШаблонаЭтоОповещение = Истина;
		ИмяМакета = СтрЗаменить(НазначениеШаблона, "Перечисление.ТипыСобытийОповещений.", "");
	КонецЕсли;
	
	// ЭлектронноеВзаимодействие.ИнтеграцияСЯндексКассой
	
	Если ОбщегоНазначения.ПодсистемаСуществует("ИнтернетПоддержкаПользователей.ОнлайнОплаты") Тогда 
		ОбщийМодульОнлайнОплаты = ОбщегоНазначения.ОбщийМодуль("ОнлайнОплаты");
		Если Не ОбщийМодульОнлайнОплаты = Неопределено Тогда 
			ОбщийМодульОнлайнОплаты.ПриПодготовкеШаблонаСообщения(
				Реквизиты,
				Вложения,
				?(НазначениеШаблонаЭтоОповещение, "Перечисление.ТипыСобытийОповещений." + ИмяМакета, НазначениеШаблона),
				ДополнительныеПараметры);
		КонецЕсли;
	КонецЕсли;
	
	// Конец ЭлектронноеВзаимодействие.ИнтеграцияСЯндексКассой
	
	//++ НЕ УТ
	ЗарплатаКадры.ПриПодготовкеШаблонаСообщения(Реквизиты, Вложения, НазначениеШаблона, ДополнительныеПараметры);
	//-- НЕ УТ

	//-- Локализация
	
КонецПроцедуры

// Вызывается в момент создания сообщений по шаблону для заполнения значений реквизитов и вложений.
//
// см. ШаблоныСообщенийПереопределяемый.ПриФормированииСообщения
//
Процедура ПриФормированииСообщения(Сообщение, НазначениеШаблона, ПредметСообщения, ПараметрыШаблона) Экспорт
	
	//++ Локализация
	
	// ЭлектронноеВзаимодействие.ИнтеграцияСЯндексКассой
	
	Если ОбщегоНазначения.ПодсистемаСуществует("ИнтернетПоддержкаПользователей.ОнлайнОплаты") Тогда 
		ОбщийМодульОнлайнОплаты = ОбщегоНазначения.ОбщийМодуль("ОнлайнОплаты");
		Если Не ОбщийМодульОнлайнОплаты = Неопределено Тогда 
			ОбщийМодульОнлайнОплаты.ПриФормированииСообщения(Сообщение, НазначениеШаблона, ПредметСообщения, ПараметрыШаблона);
		КонецЕсли;
	КонецЕсли;
	
	// Конец ЭлектронноеВзаимодействие.ИнтеграцияСЯндексКассой
	
	МассивНазначенийШаблона = Новый Массив;
	Для Каждого ЗначениеПеречисления ИЗ Перечисления.ТипыСобытийОповещений.ИзменениеСостоянияЗаказа.Метаданные().ЗначенияПеречисления Цикл
		Если НЕ Перечисления.ТипыСобытийОповещений.ДанныеДляОбработкиОчередиОповещений(Перечисления.ТипыСобытийОповещений[ЗначениеПеречисления.Имя]).ДоступноДляИспользования Тогда
			Продолжить;
		КонецЕсли;
		МассивНазначенийШаблона.Добавить(ЗначениеПеречисления.Имя);
	КонецЦикла;
	
	//++ НЕ УТ
	ЗарплатаКадры.ПриФормированииСообщения(Сообщение, НазначениеШаблона, ПредметСообщения, ПараметрыШаблона);
	//-- НЕ УТ

	//-- Локализация
	
КонецПроцедуры

// Заполняет список получателей SMS при отправке сообщения сформированного по шаблону.
// 
// см. ШаблоныСообщенийПереопределяемый.ПриЗаполненииТелефоновПолучателейВСообщении
Процедура ПриЗаполненииТелефоновПолучателейВСообщении(ПолучателиSMS, НазначениеШаблона, ПредметСообщения) Экспорт
	
	//++ Локализация

	//++ НЕ УТ
	ЗарплатаКадры.ПриЗаполненииТелефоновПолучателейВСообщении(ПолучателиSMS, НазначениеШаблона, ПредметСообщения);
	//-- НЕ УТ

	//-- Локализация
	
КонецПроцедуры

// Заполняет список получателей почты при отправки сообщения сформированного по шаблону.
//
// см. ШаблоныСообщенийПереопределяемый.ПриЗаполненииПочтыПолучателейВСообщении
//
Процедура ПриЗаполненииПочтыПолучателейВСообщении(ПолучателиПисьма, НазначениеШаблона, ПредметСообщения) Экспорт
	
	//++ Локализация

	//++ НЕ УТ
	ЗарплатаКадры.ПриЗаполненииПочтыПолучателейВСообщении(ПолучателиПисьма, НазначениеШаблона, ПредметСообщения);
	//-- НЕ УТ

	//-- Локализация
	
КонецПроцедуры

#КонецОбласти