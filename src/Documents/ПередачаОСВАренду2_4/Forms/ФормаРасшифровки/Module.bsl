
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Если Параметры.Свойство("АвтоТест") Тогда // Возврат при получении формы для анализа.
		Возврат;
	КонецЕсли;
	
	ОписаниеРасчета = ПолучитьРасчет(Параметры.РасшифровкаРасчета, Параметры.ТипРасшифровки);
	ТабличныйДокумент.Вывести(ОписаниеРасчета);
	
КонецПроцедуры

&НаСервереБезКонтекста
Функция ПолучитьРасчет(РасшифровкаРасчета, ТипРасшифровки)
	
	МакетРасчета = Документы.ПередачаОСВАренду2_4.ПолучитьМакет("РасшифровкаРасчета");
	ОписаниеРасчета = МакетРасчета.ПолучитьОбласть(ТипРасшифровки);
	ОписаниеРасчета.Параметры.Заполнить(РасшифровкаРасчета);
	
	Если РасшифровкаРасчета.Свойство("ПереоценкаДоходы") Тогда
		Переоценка = МакетРасчета.ПолучитьОбласть("ПереоценкаДоходы");
	ИначеЕсли РасшифровкаРасчета.Свойство("ПереоценкаРасходы") Тогда
		Переоценка = МакетРасчета.ПолучитьОбласть("ПереоценкаРасходы");
	Иначе
		Возврат ОписаниеРасчета;
	КонецЕсли;
	
	Переоценка.Параметры.Заполнить(РасшифровкаРасчета);
	ОписаниеРасчета.Присоединить(Переоценка);
	
	Возврат ОписаниеРасчета;
	
КонецФункции
