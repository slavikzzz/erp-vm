#Область ОбработчикиСобытий

&НаКлиенте
Процедура ОбработкаКоманды(Согласие, Параметры)
	ПараметрыЖурналаРегистрации = ПараметрыЖурналаРегистрации(Согласие);
	ОткрытьФорму("Обработка.ЖурналРегистрации.Форма", ПараметрыЖурналаРегистрации);
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаСервере
Функция ПараметрыЖурналаРегистрации(Согласие)
	ЗначенияРеквизитов = ОбщегоНазначения.ЗначенияРеквизитовОбъекта(Согласие, "ДатаСоздания, Дата");
	Результат = Новый Структура("ДатаНачала, ДатаОкончания, Данные");
	Результат.Данные = Согласие;
	Если ЗначениеЗаполнено(ЗначенияРеквизитов.ДатаСоздания) Тогда
		Результат.ДатаНачала = ЗначенияРеквизитов.ДатаСоздания - 60;
	Иначе
		Результат.ДатаНачала = ЗначенияРеквизитов.Дата;
	КонецЕсли;
	Результат.ДатаОкончания = ТекущаяДата(); // АПК:143 Для фильтрации событий в журнале регистрации требуется дата сервера.
	Возврат Результат;
КонецФункции

#КонецОбласти
